[0m06:03:06.008204 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:06.009186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.009603 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.009990 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251119060305984631'
      
      
      order by ordinal_position

  
[0m06:03:06.012735 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.017942 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.018360 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:06.021191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.028429 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.028857 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:06.031460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.033031 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.033429 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:06.034110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.049220 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:06.049881 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.050280 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251119060305984631"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251119060305984631"
    )
  
[0m06:03:06.115440 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.117464 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:06.117919 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.118372 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:06.124483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.125419 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:06.126102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cde5f77f-5dfe-4b46-88d6-4f8cebaaf83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd64e594fe0>]}
[0m06:03:06.126764 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m06:03:06.127451 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:06.129001 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:06.129385 [debug] [MainThread]: On master: BEGIN
[0m06:03:06.129710 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:06.130449 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:06.130803 [debug] [MainThread]: On master: COMMIT
[0m06:03:06.131159 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:06.131471 [debug] [MainThread]: On master: COMMIT
[0m06:03:06.132067 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:06.132435 [debug] [MainThread]: On master: Close
[0m06:03:06.132881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:06.133205 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:06.133559 [info ] [MainThread]: 
[0m06:03:06.133999 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.66 seconds (9.66s).
[0m06:03:06.134829 [debug] [MainThread]: Command end result
[0m06:03:06.160214 [info ] [MainThread]: 
[0m06:03:06.160780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:06.161227 [info ] [MainThread]: 
[0m06:03:06.161596 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:06.162523 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.577324, "process_user_time": 4.874011, "process_kernel_time": 0.274831, "process_mem_max_rss": "327440", "process_in_blocks": "1200", "process_out_blocks": "107304"}
[0m06:03:06.163095 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:06.162998 after 11.58 seconds
[0m06:03:06.163503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd698135fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd698c1a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd648384c80>]}
[0m06:03:06.163908 [debug] [MainThread]: Flushing usage events
[0m06:03:07.861631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947eba2f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947fc083e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947fc0a930>]}


============================== 06:03:07.864866 | 021a097e-f851-4104-b01a-c27421e29f19 ==============================
[0m06:03:07.864866 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:07.865483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:03:07.965958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '021a097e-f851-4104-b01a-c27421e29f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947e0d2750>]}
[0m06:03:07.980671 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16507837, "process_user_time": 1.220228, "process_kernel_time": 0.074952, "process_mem_max_rss": "99364", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:03:07.981252 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:07.981160 after 0.17 seconds
[0m06:03:07.981632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94826d3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947df60c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947e4c0530>]}
[0m06:03:07.982029 [debug] [MainThread]: Flushing usage events
[0m14:06:02.650225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5672555430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5671efc2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5671efdca0>]}


============================== 14:06:02.665396 | 48da9350-70f4-4b6c-86b0-8d9b40083dce ==============================
[0m14:06:02.665396 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:02.666059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:02.847865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48da9350-70f4-4b6c-86b0-8d9b40083dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56722443e0>]}
[0m14:06:02.863425 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kmzgbmsj'
[0m14:06:02.863927 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:02.989852 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:02.991656 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:03.038294 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:03.043539 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:03.155624 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:03.156243 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:06:03.156803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '48da9350-70f4-4b6c-86b0-8d9b40083dce', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5672f63bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56731945f0>]}
[0m14:06:03.157294 [info ] [MainThread]: 
[0m14:06:03.157797 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:03.177816 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5785703, "process_user_time": 1.670071, "process_kernel_time": 0.149469, "process_mem_max_rss": "101120", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m14:06:03.178525 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:03.178385 after 0.58 seconds
[0m14:06:03.179079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5671e984d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56722443e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5672f63bf0>]}
[0m14:06:03.179638 [debug] [MainThread]: Flushing usage events
[0m14:06:04.763805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36ebd3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37023dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36efe6570>]}


============================== 14:06:04.766961 | a879ce7d-82e6-4cb8-83be-fcc809017ca1 ==============================
[0m14:06:04.766961 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:04.767641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:05.001229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36f2fce60>]}
[0m14:06:05.062310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36e0a0a40>]}
[0m14:06:05.064153 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:06:05.089401 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:05.090136 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:05.090664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa370af72f0>]}
[0m14:06:06.463942 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:06.464633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36600eb40>]}
[0m14:06:06.709894 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:06.715483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3661b7050>]}
[0m14:06:06.844227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa366850c80>]}
[0m14:06:06.844862 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:06:06.845373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36de2b0b0>]}
[0m14:06:06.847286 [info ] [MainThread]: 
[0m14:06:06.848016 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:06.852953 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:06.889930 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:06.890392 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:06.890804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:07.317231 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.319033 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:07.319954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:07.320533 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:07.328224 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:07.328662 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:07.329033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:07.330006 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.331292 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:07.331694 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:07.332307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.332709 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:07.333069 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:07.333701 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.334614 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:07.334995 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:07.335348 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:07.335928 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.336312 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:07.337606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:07.343549 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:07.343945 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:07.344303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:07.344969 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.345355 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:07.345771 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:07.356998 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.358450 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:07.359750 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:07.360158 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:07.362213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36602ad80>]}
[0m14:06:07.362751 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:07.363132 [debug] [MainThread]: On master: BEGIN
[0m14:06:07.363484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:07.364145 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:07.364562 [debug] [MainThread]: On master: COMMIT
[0m14:06:07.364936 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:07.365301 [debug] [MainThread]: On master: COMMIT
[0m14:06:07.365892 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:07.366279 [debug] [MainThread]: On master: Close
[0m14:06:07.366778 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:07.367248 [info ] [MainThread]: 
[0m14:06:07.388810 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:07.389608 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:07.390296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:07.390772 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:07.418017 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:07.418866 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:07.454283 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:07.455053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:15.646519 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.647083 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:15.647770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.648213 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.648666 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:15.649635 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.650994 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.651438 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:15.652493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.659274 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.659764 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:15.660830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.665051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.665514 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:15.666271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.683240 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:15.683724 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.684138 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:15.686113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.691915 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.692373 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:15.693638 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.696105 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:15.697621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3661b6720>]}
[0m14:06:15.698298 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.31s]
[0m14:06:15.699072 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:15.700220 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:15.700805 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:15.701402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:15.701931 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:15.706985 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:15.707659 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:15.743896 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.744396 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251119140615737863"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:15.744877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:15.751940 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.759490 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.759962 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:15.760621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.761051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.761475 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251119140615737863'
      
      
      order by ordinal_position

  
[0m14:06:15.763981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.769176 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.769646 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:15.772071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.779682 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.780141 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:15.782578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.784262 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.784726 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:06:15.785443 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.802588 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:15.803314 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.803783 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251119140615737863"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251119140615737863"
    )
  
[0m14:06:15.864829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.867154 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:15.867626 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.868035 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:15.874235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.875287 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:15.876086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3661dc2f0>]}
[0m14:06:15.876835 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:06:15.877604 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:15.879305 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:15.879751 [debug] [MainThread]: On master: BEGIN
[0m14:06:15.880129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:15.880907 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:15.881309 [debug] [MainThread]: On master: COMMIT
[0m14:06:15.881721 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:15.882084 [debug] [MainThread]: On master: COMMIT
[0m14:06:15.882682 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:15.883076 [debug] [MainThread]: On master: Close
[0m14:06:15.883574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:15.883944 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:15.884352 [info ] [MainThread]: 
[0m14:06:15.884882 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.04 seconds (9.04s).
[0m14:06:15.885876 [debug] [MainThread]: Command end result
[0m14:06:15.914456 [info ] [MainThread]: 
[0m14:06:15.915089 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:15.915607 [info ] [MainThread]: 
[0m14:06:15.916108 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:15.917219 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.204388, "process_user_time": 5.671275, "process_kernel_time": 0.284364, "process_mem_max_rss": "369444", "process_in_blocks": "1200", "process_out_blocks": "107288"}
[0m14:06:15.917839 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:15.917727 after 11.21 seconds
[0m14:06:15.918289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37023dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa344f67f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36e51bd40>]}
[0m14:06:15.918765 [debug] [MainThread]: Flushing usage events
[0m14:06:17.667653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56374d74a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5637e39d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563755be00>]}


============================== 14:06:17.670832 | e7a7d9a0-fad7-4c9e-afdc-84c8928b5281 ==============================
[0m14:06:17.670832 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:17.671561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:17.786458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7a7d9a0-fad7-4c9e-afdc-84c8928b5281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563755b0b0>]}
[0m14:06:17.805109 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18851323, "process_user_time": 1.334391, "process_kernel_time": 0.115947, "process_mem_max_rss": "99404", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:17.805802 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:17.805691 after 0.19 seconds
[0m14:06:17.806233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5637fd5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563755b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5637534200>]}
[0m14:06:17.806684 [debug] [MainThread]: Flushing usage events
[0m22:06:45.110829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949f7da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949a74b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9495a0050>]}


============================== 22:06:45.125425 | cc9f9267-01c5-435a-8161-1a81059cdac9 ==============================
[0m22:06:45.125425 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:45.126052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:45.272366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc9f9267-01c5-435a-8161-1a81059cdac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9495a0260>]}
[0m22:06:45.287454 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-g212j8i7'
[0m22:06:45.287919 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:45.381560 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:45.383031 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:45.417060 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:45.421677 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:45.512836 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:45.513382 [info ] [MainThread]: Updated version available: 1.3.2
[0m22:06:45.513878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cc9f9267-01c5-435a-8161-1a81059cdac9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949732f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94a605370>]}
[0m22:06:45.514349 [info ] [MainThread]: 
[0m22:06:45.514802 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:45.524056 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46460143, "process_user_time": 1.635375, "process_kernel_time": 0.130392, "process_mem_max_rss": "100928", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m22:06:45.524632 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:45.524528 after 0.47 seconds
[0m22:06:45.525058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949f7da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949a01a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94a7c2600>]}
[0m22:06:45.525499 [debug] [MainThread]: Flushing usage events
[0m22:06:47.110660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1037e8bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035f78dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035f7a180>]}


============================== 22:06:47.113819 | d717296a-b81a-4e0f-afb2-e4ce2efc7e02 ==============================
[0m22:06:47.113819 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:47.114473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:47.348083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035523440>]}
[0m22:06:47.409495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10359b68a0>]}
[0m22:06:47.411285 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:47.432269 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:47.432993 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:47.433562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10355c28a0>]}
[0m22:06:48.821772 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:48.822428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102dd06930>]}
[0m22:06:49.060347 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:49.065610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102d59eea0>]}
[0m22:06:49.159490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102dd445f0>]}
[0m22:06:49.160023 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:49.160566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035597500>]}
[0m22:06:49.162391 [info ] [MainThread]: 
[0m22:06:49.163069 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:49.167895 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:49.203694 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:49.204126 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:49.204536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:49.633325 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.635573 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:49.636727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:49.637563 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:49.647434 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.648045 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:49.648588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:49.649718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.651007 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.651421 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:49.651979 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.652382 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.652744 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:49.653410 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.654336 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:49.654730 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.655093 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:49.655696 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.656081 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:49.657286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:49.663035 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:49.663467 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:49.663825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:49.664487 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.664870 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:49.665272 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:49.676092 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.677566 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:49.678831 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:49.679253 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:49.681471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10372ddcd0>]}
[0m22:06:49.681976 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.682407 [debug] [MainThread]: On master: BEGIN
[0m22:06:49.682776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:49.683421 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.683814 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.684200 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.684564 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.685135 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.685548 [debug] [MainThread]: On master: Close
[0m22:06:49.686032 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:49.686526 [info ] [MainThread]: 
[0m22:06:49.696601 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:49.697218 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:49.697788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:49.698250 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:49.725626 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:49.726446 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:49.762086 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:49.762894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:58.836721 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.837316 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:58.838016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.838479 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.838905 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:58.839882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.841258 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.841699 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:58.843019 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.850012 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.850537 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:58.851499 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.856078 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.856554 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:58.857392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.874071 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:58.874566 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.874980 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:58.876657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.882514 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.882969 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:58.884456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.886920 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:58.888439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102c138c50>]}
[0m22:06:58.889114 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.19s]
[0m22:06:58.889955 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:58.890880 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:58.891540 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:58.892110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:58.892577 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:58.897594 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:58.898271 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:58.937547 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.938427 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251119220658928571"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:58.939120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:58.947850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.958006 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.958692 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:58.959542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.960111 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.960789 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251119220658928571'
      
      
      order by ordinal_position

  
[0m22:06:58.964373 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.970654 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.971347 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:58.974334 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.982275 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.982739 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:58.986049 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.988155 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.988775 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:06:58.989757 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:59.009042 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:59.009779 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:59.010268 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251119220658928571"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251119220658928571"
    )
  
[0m22:06:59.069130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:59.071128 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:59.071591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:59.072007 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:59.089851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:59.090810 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:59.091519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fe56e7c50>]}
[0m22:06:59.092208 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.20s]
[0m22:06:59.093104 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:59.094963 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:59.095417 [debug] [MainThread]: On master: BEGIN
[0m22:06:59.095802 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:59.096528 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:59.096931 [debug] [MainThread]: On master: COMMIT
[0m22:06:59.097378 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:59.097749 [debug] [MainThread]: On master: COMMIT
[0m22:06:59.098343 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:59.098744 [debug] [MainThread]: On master: Close
[0m22:06:59.099241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:59.099614 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:59.100008 [info ] [MainThread]: 
[0m22:06:59.100551 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.94 seconds (9.94s).
[0m22:06:59.101562 [debug] [MainThread]: Command end result
[0m22:06:59.128030 [info ] [MainThread]: 
[0m22:06:59.128639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:59.129118 [info ] [MainThread]: 
[0m22:06:59.129635 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:59.130588 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.071445, "process_user_time": 5.633693, "process_kernel_time": 0.315758, "process_mem_max_rss": "331856", "process_in_blocks": "1200", "process_out_blocks": "107328"}
[0m22:06:59.131139 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:59.131034 after 12.07 seconds
[0m22:06:59.131629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10356f8e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10359b47a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fe56cb350>]}
[0m22:06:59.132050 [debug] [MainThread]: Flushing usage events
[0m22:07:00.849516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa59b354f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa59527ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa594cd0a0>]}


============================== 22:07:00.852642 | aaa10c2d-7541-432c-ad5e-9376a450c0ac ==============================
[0m22:07:00.852642 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:00.853337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:00.969422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aaa10c2d-7541-432c-ad5e-9376a450c0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa58f57020>]}
[0m22:07:00.987844 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18902452, "process_user_time": 1.354442, "process_kernel_time": 0.104956, "process_mem_max_rss": "99392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:00.988415 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:00.988308 after 0.19 seconds
[0m22:07:00.988845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa5d6d3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa590a5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa58f6fbc0>]}
[0m22:07:00.989296 [debug] [MainThread]: Flushing usage events
[0m06:02:52.963025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b551fd4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b56a597f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b55fc3440>]}


============================== 06:02:52.975427 | b6315041-664c-4beb-8f51-7b44686fdedb ==============================
[0m06:02:52.975427 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:52.976097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:53.128221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6315041-664c-4beb-8f51-7b44686fdedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b54e3ade0>]}
[0m06:02:53.143838 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-t41c24x8'
[0m06:02:53.144323 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:53.180813 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:53.182591 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:53.215908 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:53.221315 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:53.473828 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:53.474417 [info ] [MainThread]: Updated version available: 1.3.2
[0m06:02:53.474966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b6315041-664c-4beb-8f51-7b44686fdedb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b54f50140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b55e011f0>]}
[0m06:02:53.475421 [info ] [MainThread]: 
[0m06:02:53.475925 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:53.486319 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.57421726, "process_user_time": 1.714649, "process_kernel_time": 0.150319, "process_mem_max_rss": "100944", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m06:02:53.486897 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:53.486790 after 0.57 seconds
[0m06:02:53.487326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b55fc3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b54c30c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b54c30830>]}
[0m06:02:53.487795 [debug] [MainThread]: Flushing usage events
[0m06:02:55.357852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c8635e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c7376000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c706ed80>]}


============================== 06:02:55.361149 | 129e2fa3-d541-4795-b67d-8cefb79b40f2 ==============================
[0m06:02:55.361149 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:55.361821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:55.601432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c6483ce0>]}
[0m06:02:55.664995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c82739e0>]}
[0m06:02:55.666945 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:02:55.688814 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:55.689585 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:55.690122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c6300800>]}
[0m06:02:57.101808 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:57.102480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c625f1d0>]}
[0m06:02:57.358216 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:57.364114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c76b2930>]}
[0m06:02:57.465772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bec29f10>]}
[0m06:02:57.466392 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:02:57.466962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38be5d4d40>]}
[0m06:02:57.468993 [info ] [MainThread]: 
[0m06:02:57.469759 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:57.474880 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:57.512954 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:57.513470 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:57.513898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:58.003362 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.005360 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:58.006362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:58.007061 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:58.016530 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:58.017127 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:58.017513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:58.019224 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.020686 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:58.021082 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:58.021693 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.022077 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:58.022435 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:58.023101 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.024051 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:58.024449 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:58.024840 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:58.025411 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.025840 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:58.027201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:58.033550 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:58.034016 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:58.034379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:58.035282 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.035705 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:58.036093 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:58.047512 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.049235 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:58.050554 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:58.050994 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:58.053290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38be41be60>]}
[0m06:02:58.053855 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:58.054249 [debug] [MainThread]: On master: BEGIN
[0m06:02:58.054616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:58.055397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:58.055837 [debug] [MainThread]: On master: COMMIT
[0m06:02:58.056220 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:58.056581 [debug] [MainThread]: On master: COMMIT
[0m06:02:58.057206 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:58.057605 [debug] [MainThread]: On master: Close
[0m06:02:58.058162 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:58.058701 [info ] [MainThread]: 
[0m06:02:58.078882 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:58.079582 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:58.080315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:58.080779 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:58.108863 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:58.109832 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:58.146876 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:58.147807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:08.287993 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.288570 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:08.289357 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.289831 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.290248 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:08.291337 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.292832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.293290 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:08.294419 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.301604 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.302130 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:08.303102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.307867 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.308351 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:08.309253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.326886 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:08.327452 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.327914 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:08.329698 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.337237 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.338053 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:08.341010 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.343718 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:08.345340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bd178e60>]}
[0m06:03:08.346096 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.26s]
[0m06:03:08.346992 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:08.348103 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:08.348707 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:08.349381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:08.349850 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:08.357126 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:08.358145 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:08.404398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.405007 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251120060308397904"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:08.405471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:08.412778 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.424442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.425221 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:08.426594 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.427072 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.427528 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251120060308397904'
      
      
      order by ordinal_position

  
[0m06:03:08.430592 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.436607 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.437132 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:08.439966 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.448468 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.449037 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:08.451964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.453851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.454310 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:08.455137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.476808 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:08.477619 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.478126 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251120060308397904"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251120060308397904"
    )
  
[0m06:03:08.543630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.545725 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:08.546221 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.546670 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:08.652440 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.653671 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:08.654510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3875d9a240>]}
[0m06:03:08.655279 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m06:03:08.656096 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:08.658097 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:08.658528 [debug] [MainThread]: On master: BEGIN
[0m06:03:08.658962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:08.659813 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:08.660241 [debug] [MainThread]: On master: COMMIT
[0m06:03:08.660632 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:08.661064 [debug] [MainThread]: On master: COMMIT
[0m06:03:08.661707 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:08.662121 [debug] [MainThread]: On master: Close
[0m06:03:08.662609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:08.663011 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:08.663416 [info ] [MainThread]: 
[0m06:03:08.663969 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.19 seconds (11.19s).
[0m06:03:08.664984 [debug] [MainThread]: Command end result
[0m06:03:08.692976 [info ] [MainThread]: 
[0m06:03:08.693661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:08.694200 [info ] [MainThread]: 
[0m06:03:08.694737 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:08.695766 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.390484, "process_user_time": 5.963643, "process_kernel_time": 0.314611, "process_mem_max_rss": "334412", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m06:03:08.696304 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:08.696201 after 13.39 seconds
[0m06:03:08.696787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38cabbb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c691b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c6940200>]}
[0m06:03:08.697251 [debug] [MainThread]: Flushing usage events
[0m06:03:10.830883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb169a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb26c2cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb26c2180>]}


============================== 06:03:10.834291 | 15d8f03c-c736-4b71-81f9-827f3ee84702 ==============================
[0m06:03:10.834291 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:10.834994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:10.966984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15d8f03c-c736-4b71-81f9-827f3ee84702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb1f7fc80>]}
[0m06:03:10.986505 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20906797, "process_user_time": 1.459182, "process_kernel_time": 0.107939, "process_mem_max_rss": "99560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:03:10.987108 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:10.986999 after 0.21 seconds
[0m06:03:10.987555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb1b423c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb1354380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb133d550>]}
[0m06:03:10.988038 [debug] [MainThread]: Flushing usage events
[0m14:05:53.179557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a58c7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a62117f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a5abe600>]}


============================== 14:05:53.191610 | 5a672e3c-23f6-4110-bc27-b90d7988f7aa ==============================
[0m14:05:53.191610 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:53.192305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:53.358203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a672e3c-23f6-4110-bc27-b90d7988f7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a56d7d70>]}
[0m14:05:53.373640 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-k_qvy3k2'
[0m14:05:53.374135 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:53.485516 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:53.486960 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:53.521317 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:53.525868 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:53.596609 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:53.597239 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:05:53.597813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5a672e3c-23f6-4110-bc27-b90d7988f7aa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a68d42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a543de80>]}
[0m14:05:53.598270 [info ] [MainThread]: 
[0m14:05:53.598792 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:53.607982 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4789139, "process_user_time": 1.630166, "process_kernel_time": 0.145461, "process_mem_max_rss": "100920", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m14:05:53.608518 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:53.608417 after 0.48 seconds
[0m14:05:53.608958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a5d89970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a68d42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a56d7d70>]}
[0m14:05:53.609364 [debug] [MainThread]: Flushing usage events
[0m14:05:55.230135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06390955b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06383d54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063839dee0>]}


============================== 14:05:55.233197 | d8802396-d66b-4a81-a57e-17063e595344 ==============================
[0m14:05:55.233197 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:55.233852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:55.464047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06382ad310>]}
[0m14:05:55.525264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06385a4ce0>]}
[0m14:05:55.526935 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:05:55.567943 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:55.568651 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:55.569182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06380ef2f0>]}
[0m14:05:56.991250 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:56.991891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06303d6a20>]}
[0m14:05:57.238909 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:57.246488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063876a930>]}
[0m14:05:57.383057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0630a96b40>]}
[0m14:05:57.383651 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:05:57.384226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06381e0260>]}
[0m14:05:57.386195 [info ] [MainThread]: 
[0m14:05:57.386979 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:57.391932 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:57.428666 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:57.429139 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:57.429529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:57.886792 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.888403 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:57.889298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:57.889886 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:57.897451 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:57.897890 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:57.898327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:57.899326 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.900649 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:57.901061 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:57.901645 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.902047 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:57.902410 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:57.903050 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.903979 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:57.904371 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:57.904755 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:57.905339 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.905758 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:57.907052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:57.913119 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:57.913515 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:57.913900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:57.914596 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.915014 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:57.915384 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:57.927360 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.928875 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:57.930122 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:57.930521 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:57.932595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0630a38bf0>]}
[0m14:05:57.933159 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:57.933539 [debug] [MainThread]: On master: BEGIN
[0m14:05:57.933932 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:57.934611 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:57.935045 [debug] [MainThread]: On master: COMMIT
[0m14:05:57.935418 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:57.935816 [debug] [MainThread]: On master: COMMIT
[0m14:05:57.936451 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:57.936878 [debug] [MainThread]: On master: Close
[0m14:05:57.937365 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:57.937848 [info ] [MainThread]: 
[0m14:05:57.956891 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:57.957476 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:57.958057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:57.958494 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:57.985553 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:57.986370 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:58.021870 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:58.022637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:05.384534 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.385116 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:05.385837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.386275 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.386714 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:05.387679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.389046 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.389483 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:05.390463 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.397278 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.397752 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:05.398481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.402677 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.403142 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:05.403862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.420336 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:05.420825 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.421329 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:05.423679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.429416 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.429888 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:05.431315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.433753 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:05.435261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062afaf620>]}
[0m14:06:05.435971 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.48s]
[0m14:06:05.436763 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:05.437774 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:05.438326 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:05.438938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:05.439367 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:05.444388 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:05.445054 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:05.481184 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.481674 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251120140605475122"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:05.482145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:05.489088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.496643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.497116 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:05.497775 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.498204 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.498613 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251120140605475122'
      
      
      order by ordinal_position

  
[0m14:06:05.501036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.506129 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.506585 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:05.508920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.516500 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.516987 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:05.519275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.520940 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.521379 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:06:05.522096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.539162 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:05.539869 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.540324 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251120140605475122"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251120140605475122"
    )
  
[0m14:06:05.601256 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.603275 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:05.603729 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.604140 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:05.609893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.610797 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:05.611479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06280cc5f0>]}
[0m14:06:05.612166 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:06:05.612912 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:05.614658 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:05.615094 [debug] [MainThread]: On master: BEGIN
[0m14:06:05.615461 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:05.616186 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:05.616582 [debug] [MainThread]: On master: COMMIT
[0m14:06:05.617012 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:05.617381 [debug] [MainThread]: On master: COMMIT
[0m14:06:05.617967 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:05.618356 [debug] [MainThread]: On master: Close
[0m14:06:05.618833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:05.619208 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:05.619602 [info ] [MainThread]: 
[0m14:06:05.620106 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.23 seconds (8.23s).
[0m14:06:05.621110 [debug] [MainThread]: Command end result
[0m14:06:05.647878 [info ] [MainThread]: 
[0m14:06:05.648476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:05.649003 [info ] [MainThread]: 
[0m14:06:05.649520 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:05.650514 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.470858, "process_user_time": 5.215342, "process_kernel_time": 0.274859, "process_mem_max_rss": "323848", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m14:06:05.651082 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:05.650977 after 10.47 seconds
[0m14:06:05.651510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063c8d3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063af6c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05e82976b0>]}
[0m14:06:05.651954 [debug] [MainThread]: Flushing usage events
[0m14:06:07.361218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28613bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff284665eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28384cd70>]}


============================== 14:06:07.364281 | c8511478-8494-47d2-bea8-498865bb57db ==============================
[0m14:06:07.364281 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:07.364951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:07.480396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8511478-8494-47d2-bea8-498865bb57db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff283e81f70>]}
[0m14:06:07.498954 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18795969, "process_user_time": 1.33182, "process_kernel_time": 0.106905, "process_mem_max_rss": "99312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:07.499502 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:07.499395 after 0.19 seconds
[0m14:06:07.499972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff287dbb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2838d36e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28364d4c0>]}
[0m14:06:07.500402 [debug] [MainThread]: Flushing usage events
[0m22:06:45.606555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e99e92a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e996a7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9a7ee480>]}


============================== 22:06:45.619893 | 09023abc-f759-4565-a56f-a3a6750e70cb ==============================
[0m22:06:45.619893 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:45.620598 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:45.771352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09023abc-f759-4565-a56f-a3a6750e70cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9952c860>]}
[0m22:06:45.787325 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rb0y47vk'
[0m22:06:45.787810 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:45.945205 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:45.946746 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:45.992172 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:45.996847 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:46.090783 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:46.091433 [info ] [MainThread]: Updated version available: 1.3.2
[0m22:06:46.091971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '09023abc-f759-4565-a56f-a3a6750e70cb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9a50c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9a50c200>]}
[0m22:06:46.092452 [info ] [MainThread]: 
[0m22:06:46.092926 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:46.103317 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.54911476, "process_user_time": 1.702694, "process_kernel_time": 0.134767, "process_mem_max_rss": "101200", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m22:06:46.103867 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:46.103763 after 0.55 seconds
[0m22:06:46.104340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9998a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e99254050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e99fef5c0>]}
[0m22:06:46.104772 [debug] [MainThread]: Flushing usage events
[0m22:06:47.709338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28ae5d7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28af87a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28ae5d7c50>]}


============================== 22:06:47.712881 | 857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186 ==============================
[0m22:06:47.712881 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:47.713594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:47.952091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28aecfcfb0>]}
[0m22:06:48.013942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28adb1a450>]}
[0m22:06:48.015821 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:48.065031 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:48.065771 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:48.066332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28adb033b0>]}
[0m22:06:49.458166 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:49.458877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28a6476f00>]}
[0m22:06:49.704552 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:49.710470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28a5b8e840>]}
[0m22:06:49.809147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28a63621b0>]}
[0m22:06:49.809744 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:49.810332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28a6340230>]}
[0m22:06:49.812260 [info ] [MainThread]: 
[0m22:06:49.813018 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:49.818014 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:49.854671 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:49.855165 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:49.855574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:50.247908 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.249612 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:50.250513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:50.251110 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:50.258764 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:50.259217 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:50.259604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:50.260636 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.261983 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:50.262401 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:50.263006 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.263394 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:50.263755 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:50.264378 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.265304 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:50.265698 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:50.266088 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:50.266652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.267063 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:50.268279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:50.274227 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:50.274627 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:50.275005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:50.275689 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.276101 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:50.276475 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:50.287098 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.288558 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:50.289807 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:50.290231 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:50.292433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28a5ba36e0>]}
[0m22:06:50.292935 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:50.293375 [debug] [MainThread]: On master: BEGIN
[0m22:06:50.293743 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:50.294429 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:50.294856 [debug] [MainThread]: On master: COMMIT
[0m22:06:50.295257 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:50.295619 [debug] [MainThread]: On master: COMMIT
[0m22:06:50.296248 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:50.296655 [debug] [MainThread]: On master: Close
[0m22:06:50.297170 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:50.297668 [info ] [MainThread]: 
[0m22:06:50.333258 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:50.333855 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:50.334508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:50.334948 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:50.361835 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:50.362583 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:50.397694 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:50.398468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:58.397737 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.398308 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:58.399031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.399479 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.399907 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:58.400877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.402240 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.402688 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:58.403709 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.411518 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.411978 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:58.412737 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.415697 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.416169 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:58.416929 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.433574 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:58.434056 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.434487 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:58.436512 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.442274 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.442735 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:58.444185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.446586 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:58.448109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28af87aa80>]}
[0m22:06:58.448805 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.11s]
[0m22:06:58.449587 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:58.450591 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:58.451172 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:58.451745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:58.452210 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:58.457169 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:58.457800 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:58.493906 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.494434 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251120220658487815"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:58.494890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:58.501908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.509436 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.509906 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:58.510627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.511089 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.511517 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251120220658487815'
      
      
      order by ordinal_position

  
[0m22:06:58.514311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.520008 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.520511 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:58.523181 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.531217 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.531691 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:58.534146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.535848 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.536321 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:06:58.537047 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.555807 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:58.556653 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.557164 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251120220658487815"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251120220658487815"
    )
  
[0m22:06:58.615171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.617209 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:58.617673 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.618099 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:58.624375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.625300 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:58.625970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f285dcff920>]}
[0m22:06:58.626691 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:06:58.627452 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:58.629275 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:58.629689 [debug] [MainThread]: On master: BEGIN
[0m22:06:58.630107 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:58.630841 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:58.631273 [debug] [MainThread]: On master: COMMIT
[0m22:06:58.631644 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:58.632027 [debug] [MainThread]: On master: COMMIT
[0m22:06:58.632618 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:58.633048 [debug] [MainThread]: On master: Close
[0m22:06:58.633524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:58.633881 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:58.634309 [info ] [MainThread]: 
[0m22:06:58.634760 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.82 seconds (8.82s).
[0m22:06:58.635701 [debug] [MainThread]: Command end result
[0m22:06:58.661802 [info ] [MainThread]: 
[0m22:06:58.662413 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:58.662874 [info ] [MainThread]: 
[0m22:06:58.663361 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:58.664311 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.008272, "process_user_time": 5.259007, "process_kernel_time": 0.277528, "process_mem_max_rss": "351268", "process_in_blocks": "1200", "process_out_blocks": "107336"}
[0m22:06:58.664849 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:58.664746 after 11.01 seconds
[0m22:06:58.665317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28af87a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28a636b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f285dc82f90>]}
[0m22:06:58.665747 [debug] [MainThread]: Flushing usage events
[0m22:07:00.419837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18d504620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18caf17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18d299c40>]}


============================== 22:07:00.423078 | 93ea60b9-8717-46f3-85c7-0305b8fc10d1 ==============================
[0m22:07:00.423078 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:00.423771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:07:00.537786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93ea60b9-8717-46f3-85c7-0305b8fc10d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18e53fe60>]}
[0m22:07:00.556260 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1879157, "process_user_time": 1.327799, "process_kernel_time": 0.112897, "process_mem_max_rss": "99448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:00.556818 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:00.556712 after 0.19 seconds
[0m22:07:00.557269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd190dbb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18e53fe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18d9972f0>]}
[0m22:07:00.557698 [debug] [MainThread]: Flushing usage events
[0m06:02:55.195014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f79f3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f7c9c560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f7e88200>]}


============================== 06:02:55.203822 | 0c1ad6c8-aef9-4da0-8a74-36d6c9ec5b31 ==============================
[0m06:02:55.203822 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:55.204459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:55.367564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c1ad6c8-aef9-4da0-8a74-36d6c9ec5b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f77cea80>]}
[0m06:02:55.383061 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lrbn4gex'
[0m06:02:55.383530 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:55.475968 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:55.477622 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:55.511404 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:55.516067 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:55.744004 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:55.744607 [info ] [MainThread]: Updated version available: 1.3.2
[0m06:02:55.745208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0c1ad6c8-aef9-4da0-8a74-36d6c9ec5b31', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f8a05c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f8a053a0>]}
[0m06:02:55.745703 [info ] [MainThread]: 
[0m06:02:55.746188 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:55.748104 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.60558575, "process_user_time": 1.693584, "process_kernel_time": 0.133651, "process_mem_max_rss": "100784", "process_in_blocks": "8760", "process_out_blocks": "5176"}
[0m06:02:55.748661 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:55.748556 after 0.61 seconds
[0m06:02:55.749131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f7a3a930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f7e126c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f7a3c890>]}
[0m06:02:55.749548 [debug] [MainThread]: Flushing usage events
[0m06:02:57.704051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38cfc54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38d0e3680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38d0e3740>]}


============================== 06:02:57.707419 | 0c398430-b643-419c-81bc-6df873ee76ee ==============================
[0m06:02:57.707419 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:57.708141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:57.954026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38c9a17f0>]}
[0m06:02:58.018819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38cad6420>]}
[0m06:02:58.020641 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:02:58.059786 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:58.060510 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:58.061053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38cc77110>]}
[0m06:02:59.461006 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:59.461701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe384c52240>]}
[0m06:02:59.714786 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:59.720357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe384d6a150>]}
[0m06:02:59.822014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe385489940>]}
[0m06:02:59.822600 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:02:59.823116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3854e7d70>]}
[0m06:02:59.825014 [info ] [MainThread]: 
[0m06:02:59.825738 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:59.831001 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:59.869212 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:59.869721 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:59.870139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:00.224249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.226331 [debug] [ThreadPool]: On list_petro: Close
[0m06:03:00.227387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:03:00.227987 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:03:00.237114 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.237728 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:03:00.238289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:00.239974 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.241427 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.241861 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:03:00.242779 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.243171 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.243533 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:03:00.244182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.245105 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:00.245493 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.245903 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:00.246491 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.246907 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:03:00.248168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:03:00.254159 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:00.254578 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:03:00.254978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:00.255938 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.256332 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:00.256729 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:03:00.267418 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.268944 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:03:00.270222 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:03:00.270621 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:03:00.272835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3854e5fd0>]}
[0m06:03:00.273341 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:00.273752 [debug] [MainThread]: On master: BEGIN
[0m06:03:00.274119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:00.274789 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:00.275184 [debug] [MainThread]: On master: COMMIT
[0m06:03:00.275554 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:00.275952 [debug] [MainThread]: On master: COMMIT
[0m06:03:00.276527 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:00.276969 [debug] [MainThread]: On master: Close
[0m06:03:00.277467 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:03:00.277958 [info ] [MainThread]: 
[0m06:03:00.288338 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:03:00.288956 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:03:00.289596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:03:00.290056 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:03:00.317696 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:03:00.318503 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:03:00.355577 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:03:00.356383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:12.536913 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.537477 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:12.538184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.538630 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.539083 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:12.540080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.541411 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.541873 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:12.542876 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.549775 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.550247 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:12.550999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.555189 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.555636 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:12.556372 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.573707 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:12.574190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.574618 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:12.576342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.582120 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.582586 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:12.584051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.586463 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:12.588006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38ea6ab40>]}
[0m06:03:12.588726 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.30s]
[0m06:03:12.589549 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:12.590471 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:12.591068 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:12.591755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:12.592209 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:12.597308 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:12.598096 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:12.635083 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.635615 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251121060312628691"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:12.636102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:12.643374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.651246 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.651728 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:12.652403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.652865 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.653341 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251121060312628691'
      
      
      order by ordinal_position

  
[0m06:03:12.655903 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.661365 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.661875 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:12.664304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.671964 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.672428 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:12.675113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.676779 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.677220 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:12.677933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.695722 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:12.696421 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.696941 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251121060312628691"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251121060312628691"
    )
  
[0m06:03:12.755271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.757302 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:12.757763 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.758198 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:12.764490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.765405 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:12.766116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33c3c14c0>]}
[0m06:03:12.766800 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:03:12.767605 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:12.769605 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:12.770046 [debug] [MainThread]: On master: BEGIN
[0m06:03:12.770420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:12.771155 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:12.771547 [debug] [MainThread]: On master: COMMIT
[0m06:03:12.771973 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:12.772329 [debug] [MainThread]: On master: COMMIT
[0m06:03:12.772915 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:12.773305 [debug] [MainThread]: On master: Close
[0m06:03:12.773785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:12.774146 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:12.774544 [info ] [MainThread]: 
[0m06:03:12.775101 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.95 seconds (12.95s).
[0m06:03:12.776108 [debug] [MainThread]: Command end result
[0m06:03:12.803024 [info ] [MainThread]: 
[0m06:03:12.803646 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:12.804187 [info ] [MainThread]: 
[0m06:03:12.804726 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:12.805754 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.156757, "process_user_time": 5.662956, "process_kernel_time": 0.302676, "process_mem_max_rss": "332584", "process_in_blocks": "1200", "process_out_blocks": "107304"}
[0m06:03:12.806291 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:12.806189 after 15.16 seconds
[0m06:03:12.806737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38f8d5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36c57bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38d0e3a70>]}
[0m06:03:12.807160 [debug] [MainThread]: Flushing usage events
[0m06:03:14.790682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37469da930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37473b3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37458fc530>]}


============================== 06:03:14.793956 | 16ed70cf-4058-4fd0-ae12-acc6d1da4ac9 ==============================
[0m06:03:14.793956 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:14.794660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:03:14.915430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16ed70cf-4058-4fd0-ae12-acc6d1da4ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374483a2a0>]}
[0m06:03:14.933811 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19744481, "process_user_time": 1.408084, "process_kernel_time": 0.097005, "process_mem_max_rss": "99400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:03:14.934358 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:14.934254 after 0.20 seconds
[0m06:03:14.934809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374679c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3744aaf110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3744aafc80>]}
[0m06:03:14.935232 [debug] [MainThread]: Flushing usage events
[0m14:06:00.761642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9fb977a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9fbb5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9fb97890>]}


============================== 14:06:00.773998 | 6c79b183-917f-40d4-8d7c-a8894befcfb6 ==============================
[0m14:06:00.773998 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:00.774692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:00.917702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c79b183-917f-40d4-8d7c-a8894befcfb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9f7fd370>]}
[0m14:06:00.934006 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-m1rb07yp'
[0m14:06:00.934505 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:01.029900 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:01.031653 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:01.077072 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:01.082036 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:01.186461 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:01.187106 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:06:01.187651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6c79b183-917f-40d4-8d7c-a8894befcfb6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9f7ff410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9f7446e0>]}
[0m14:06:01.188136 [info ] [MainThread]: 
[0m14:06:01.188611 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:01.199111 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48842794, "process_user_time": 1.635622, "process_kernel_time": 0.148874, "process_mem_max_rss": "101156", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m14:06:01.199670 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:01.199566 after 0.49 seconds
[0m14:06:01.200136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca36cb530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9fa1c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9fb67200>]}
[0m14:06:01.200557 [debug] [MainThread]: Flushing usage events
[0m14:06:02.885372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3df9ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3e8ed5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3d58f110>]}


============================== 14:06:02.888460 | 86d98b8a-820d-47a5-946c-3bd1245117f2 ==============================
[0m14:06:02.888460 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:02.889142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:03.121687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3ef6d730>]}
[0m14:06:03.183217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3d21dc70>]}
[0m14:06:03.184889 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:06:03.204832 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:03.205526 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:03.206081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3d312450>]}
[0m14:06:04.592444 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:04.593084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf35c5af30>]}
[0m14:06:04.825033 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:04.830278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3557cf80>]}
[0m14:06:04.922975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3d313440>]}
[0m14:06:04.923477 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:06:04.923988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf35c88d10>]}
[0m14:06:04.925837 [info ] [MainThread]: 
[0m14:06:04.926503 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:04.931405 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:04.966955 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:04.967380 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:04.967762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:05.317665 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.319289 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:05.320216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:05.320754 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:05.328256 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:05.328665 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:05.329074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:05.330001 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.331279 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:05.331659 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:05.332254 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.332628 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:05.333004 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:05.333605 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.334506 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:05.334900 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:05.335249 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:05.335822 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.336208 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:05.337380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:05.343069 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:05.343462 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:05.343836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:05.344506 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.344921 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:05.345285 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:05.356621 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.358070 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:05.359327 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:05.359722 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:05.361761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf35447fe0>]}
[0m14:06:05.362295 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:05.362676 [debug] [MainThread]: On master: BEGIN
[0m14:06:05.363073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:05.363699 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:05.364112 [debug] [MainThread]: On master: COMMIT
[0m14:06:05.364484 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:05.364862 [debug] [MainThread]: On master: COMMIT
[0m14:06:05.365447 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:05.365868 [debug] [MainThread]: On master: Close
[0m14:06:05.366358 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:05.366835 [info ] [MainThread]: 
[0m14:06:05.384076 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:05.384672 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:05.385259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:05.385693 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:05.412447 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:05.413205 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:05.448754 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:05.449512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:13.165625 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.166198 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:13.166878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.167319 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.167737 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:13.168729 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.170102 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.170543 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:13.171645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.178431 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.178910 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:13.179648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.183823 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.184266 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:13.185231 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.201949 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:13.202408 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.202844 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:13.204804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.210533 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.211006 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:13.212144 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.214547 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:13.216058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf2ff00500>]}
[0m14:06:13.216732 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.83s]
[0m14:06:13.217606 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:13.218611 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:13.219213 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:13.219862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:13.220301 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:13.225265 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:13.225938 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:13.262529 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.263055 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251121140613256398"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:13.263510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:13.270740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.278443 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.278934 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:13.279622 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.280081 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.280502 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251121140613256398'
      
      
      order by ordinal_position

  
[0m14:06:13.282956 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.288152 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.288610 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:13.290983 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.298645 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.299123 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:13.301493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.303182 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.303625 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:06:13.304347 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.321471 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:13.322175 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.322619 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251121140613256398"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251121140613256398"
    )
  
[0m14:06:13.379572 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.381584 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:13.382052 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.382465 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:13.388512 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.389453 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:13.390170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf06776180>]}
[0m14:06:13.390857 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:06:13.391669 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:13.393795 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:13.394212 [debug] [MainThread]: On master: BEGIN
[0m14:06:13.394582 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:13.395324 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:13.395721 [debug] [MainThread]: On master: COMMIT
[0m14:06:13.396151 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:13.396518 [debug] [MainThread]: On master: COMMIT
[0m14:06:13.397180 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:13.397626 [debug] [MainThread]: On master: Close
[0m14:06:13.398209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:13.398611 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:13.399054 [info ] [MainThread]: 
[0m14:06:13.399566 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.47 seconds (8.47s).
[0m14:06:13.400589 [debug] [MainThread]: Command end result
[0m14:06:13.427561 [info ] [MainThread]: 
[0m14:06:13.428222 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:13.428744 [info ] [MainThread]: 
[0m14:06:13.429295 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:13.430307 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.596053, "process_user_time": 5.524964, "process_kernel_time": 0.305053, "process_mem_max_rss": "360356", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m14:06:13.430895 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:13.430749 after 10.60 seconds
[0m14:06:13.431342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3de375f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf41ad3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeed42b560>]}
[0m14:06:13.431773 [debug] [MainThread]: Flushing usage events
[0m14:06:15.125884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f3098bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f30de9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2f4e7f20>]}


============================== 14:06:15.129013 | a71fc38f-db05-499c-a718-5f5beee240c3 ==============================
[0m14:06:15.129013 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:15.129645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:06:15.243507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a71fc38f-db05-499c-a718-5f5beee240c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2e0674d0>]}
[0m14:06:15.262975 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18801713, "process_user_time": 1.31611, "process_kernel_time": 0.104929, "process_mem_max_rss": "99292", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:15.263521 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:15.263418 after 0.19 seconds
[0m14:06:15.263996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f30b4b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2e0674d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2e67d460>]}
[0m14:06:15.264420 [debug] [MainThread]: Flushing usage events
[0m22:06:35.301394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9195993cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9193b9fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9193b9d7c0>]}


============================== 22:06:35.313919 | 6fb50e86-466a-4cfd-8bfb-414755d307f0 ==============================
[0m22:06:35.313919 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:35.314602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:35.476126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fb50e86-466a-4cfd-8bfb-414755d307f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9194a22510>]}
[0m22:06:35.491999 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1e3ohzqt'
[0m22:06:35.492495 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:35.558752 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:35.560277 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:35.591213 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:35.595876 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:35.823899 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:35.824524 [info ] [MainThread]: Updated version available: 1.3.2
[0m22:06:35.825073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6fb50e86-466a-4cfd-8bfb-414755d307f0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9193111e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9193d15c10>]}
[0m22:06:35.825553 [info ] [MainThread]: 
[0m22:06:35.826021 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:35.838769 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.58808714, "process_user_time": 1.635583, "process_kernel_time": 0.14062, "process_mem_max_rss": "100832", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m22:06:35.839324 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:35.839219 after 0.59 seconds
[0m22:06:35.839790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9195993cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9192b17650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9192b14050>]}
[0m22:06:35.840213 [debug] [MainThread]: Flushing usage events
[0m22:06:37.453388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ccb836e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12cd395e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12cc948500>]}


============================== 22:06:37.456542 | 25ec4911-ff44-4326-ab0d-9a2d19f03f0a ==============================
[0m22:06:37.456542 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:37.457243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:37.692443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ce6980e0>]}
[0m22:06:37.754340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12cc69ed80>]}
[0m22:06:37.756151 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:37.776321 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:37.777065 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:37.777602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12cc91ac60>]}
[0m22:06:39.169532 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:39.170180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12c49be930>]}
[0m22:06:39.414373 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:39.419813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12c49f43e0>]}
[0m22:06:39.524013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12c5034860>]}
[0m22:06:39.524585 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:39.525090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12c50ef0e0>]}
[0m22:06:39.527009 [info ] [MainThread]: 
[0m22:06:39.527757 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:39.532704 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:39.568983 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:39.569426 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:39.569835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:39.917108 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.918835 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:39.919803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:39.920592 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:39.929077 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.929531 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:39.929928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:39.931284 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.932668 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.933059 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:39.933698 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.934078 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.934437 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:39.935074 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.936022 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:39.936412 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.936796 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:39.937369 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.937784 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:39.939029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:39.945095 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:39.945520 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:39.945886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:39.946578 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.946966 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:39.947334 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:39.958377 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.959918 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:39.961198 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:39.961620 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:39.963765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ce6ca0f0>]}
[0m22:06:39.964271 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:39.964689 [debug] [MainThread]: On master: BEGIN
[0m22:06:39.965047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:39.965712 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:39.966105 [debug] [MainThread]: On master: COMMIT
[0m22:06:39.966494 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:39.966856 [debug] [MainThread]: On master: COMMIT
[0m22:06:39.967438 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:39.967863 [debug] [MainThread]: On master: Close
[0m22:06:39.968358 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:39.968849 [info ] [MainThread]: 
[0m22:06:39.986695 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:39.987370 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:39.988091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:39.988567 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:40.016476 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:40.017354 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:40.053263 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:40.054148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:48.272647 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.273206 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:48.273955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.274383 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.274820 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:48.275762 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.277124 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.277598 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:48.278658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.285558 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.286023 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:48.286782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.291034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.291498 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:48.292287 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.308974 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:48.309470 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.309896 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:48.311176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.316903 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.317357 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:48.318610 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.321064 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:48.322601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ce663170>]}
[0m22:06:48.323293 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.33s]
[0m22:06:48.324131 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:48.324981 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:48.325758 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:48.326365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:48.326844 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:48.331895 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:48.332576 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:48.368582 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.369095 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251121220648362528"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:48.369560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:48.376933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.384760 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.385211 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:48.386112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.386571 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.386992 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251121220648362528'
      
      
      order by ordinal_position

  
[0m22:06:48.389568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.394841 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.395290 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:48.397790 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.405545 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.405996 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:48.408739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.410407 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.410867 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:06:48.411573 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.428890 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:48.429623 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.430131 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251121220648362528"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251121220648362528"
    )
  
[0m22:06:48.491154 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.493182 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:48.493639 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.494055 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:48.500179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.501115 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:48.501804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12c513c560>]}
[0m22:06:48.502479 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m22:06:48.503202 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:48.504741 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:48.505153 [debug] [MainThread]: On master: BEGIN
[0m22:06:48.505567 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:48.506308 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:48.506754 [debug] [MainThread]: On master: COMMIT
[0m22:06:48.507126 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:48.507518 [debug] [MainThread]: On master: COMMIT
[0m22:06:48.508100 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:48.508513 [debug] [MainThread]: On master: Close
[0m22:06:48.508981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:48.509338 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:48.509758 [info ] [MainThread]: 
[0m22:06:48.510267 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.98 seconds (8.98s).
[0m22:06:48.511248 [debug] [MainThread]: Command end result
[0m22:06:48.538312 [info ] [MainThread]: 
[0m22:06:48.538978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:48.539507 [info ] [MainThread]: 
[0m22:06:48.540028 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:48.541031 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.139096, "process_user_time": 5.544868, "process_kernel_time": 0.332591, "process_mem_max_rss": "368528", "process_in_blocks": "1200", "process_out_blocks": "107328"}
[0m22:06:48.541586 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:48.541481 after 11.14 seconds
[0m22:06:48.542032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12cc948500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ccd0c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f127c67c530>]}
[0m22:06:48.542468 [debug] [MainThread]: Flushing usage events
[0m22:06:50.318555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f76e1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8fa24de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f76833b0>]}


============================== 22:06:50.321888 | 5640dcc7-29f8-4cd9-83b5-a3b6483a443b ==============================
[0m22:06:50.321888 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:50.322573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:50.436562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5640dcc7-29f8-4cd9-83b5-a3b6483a443b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f77de810>]}
[0m22:06:50.454565 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18738385, "process_user_time": 1.304815, "process_kernel_time": 0.13498, "process_mem_max_rss": "99492", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:50.455099 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:50.454998 after 0.19 seconds
[0m22:06:50.455655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f87a6630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f7beffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f7befce0>]}
[0m22:06:50.456072 [debug] [MainThread]: Flushing usage events
[0m06:02:48.916693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0024e518b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00230df0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0023a154c0>]}


============================== 06:02:48.930614 | 38d0ec57-b996-4362-aacb-e501405e3dbd ==============================
[0m06:02:48.930614 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:48.931384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:49.095123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38d0ec57-b996-4362-aacb-e501405e3dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0023d6bc50>]}
[0m06:02:49.112651 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-n9h8vowr'
[0m06:02:49.113237 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:49.249581 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:49.251870 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:49.299410 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:49.305136 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:49.401163 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:49.401746 [info ] [MainThread]: Updated version available: 1.3.2
[0m06:02:49.402300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '38d0ec57-b996-4362-aacb-e501405e3dbd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0022c6e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0022c9fdd0>]}
[0m06:02:49.402753 [info ] [MainThread]: 
[0m06:02:49.403232 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:49.413181 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5499759, "process_user_time": 1.764816, "process_kernel_time": 0.161983, "process_mem_max_rss": "100908", "process_in_blocks": "8760", "process_out_blocks": "5176"}
[0m06:02:49.413868 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:49.413759 after 0.55 seconds
[0m06:02:49.414348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0023a154c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0023d6bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0022c6e450>]}
[0m06:02:49.414776 [debug] [MainThread]: Flushing usage events
[0m06:02:51.258389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026d395e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20261ad4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026036d80>]}


============================== 06:02:51.261733 | 7ee08eb3-63ff-4302-9bd3-de88075a2d61 ==============================
[0m06:02:51.261733 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:51.262467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:51.505707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201db7d3d0>]}
[0m06:02:51.569299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2024fb63f0>]}
[0m06:02:51.571243 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:02:51.593338 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:51.594194 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:51.594744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2024f3eff0>]}
[0m06:02:53.028540 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:53.029278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201dab7ec0>]}
[0m06:02:53.303433 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:53.309658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201d1e90d0>]}
[0m06:02:53.412315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201daf4080>]}
[0m06:02:53.412934 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:02:53.413472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201db7de20>]}
[0m06:02:53.415599 [info ] [MainThread]: 
[0m06:02:53.416391 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:53.421768 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:53.460491 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:53.461021 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:53.461444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:53.836174 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.838396 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:53.839529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:53.840120 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:53.847989 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:53.848533 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:53.848915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:53.850286 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.851753 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:53.852166 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:53.852772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.853180 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:53.853547 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:53.854249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.855259 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:53.855648 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:53.856005 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:53.856605 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.857011 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:53.858452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:53.865277 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:53.865799 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:53.866192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:53.867135 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.867527 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:53.867898 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:53.879227 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.881073 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:53.882481 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:53.882919 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:53.885172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201d194470>]}
[0m06:02:53.885727 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:53.886151 [debug] [MainThread]: On master: BEGIN
[0m06:02:53.886519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:53.887458 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:53.887870 [debug] [MainThread]: On master: COMMIT
[0m06:02:53.888289 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:53.888658 [debug] [MainThread]: On master: COMMIT
[0m06:02:53.889303 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:53.889706 [debug] [MainThread]: On master: Close
[0m06:02:53.890288 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:53.890801 [info ] [MainThread]: 
[0m06:02:53.909338 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:53.910063 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:53.910783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:53.911258 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:53.940078 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:53.941021 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:53.979189 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:53.980172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:02.256289 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.256903 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:02.257825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.258307 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.258734 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:02.259891 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.261472 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.261928 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:02.263172 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.270753 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.271368 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:02.272540 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.277609 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.278171 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:02.279378 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.297491 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:02.298118 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.298565 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:02.301087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.307875 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.308495 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:02.310182 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.312934 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:02.314653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026e7aa80>]}
[0m06:03:02.315432 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.40s]
[0m06:03:02.316318 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:02.317273 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:02.317862 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:02.318645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:02.319128 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:02.324942 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:02.325786 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:02.364332 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.365089 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251122060302357804"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:02.365635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:02.373289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.382038 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.382642 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:02.383548 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.383998 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.384467 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251122060302357804'
      
      
      order by ordinal_position

  
[0m06:03:02.387316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.393473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.394078 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:02.397177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.405963 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.406566 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:02.409649 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.411633 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.412132 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:02.413034 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.431468 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:02.432390 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.432874 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251122060302357804"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251122060302357804"
    )
  
[0m06:03:02.493211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.495420 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:02.495961 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.496461 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:02.502645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.503874 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:02.504761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd521be90>]}
[0m06:03:02.505560 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.19s]
[0m06:03:02.506405 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:02.508699 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:02.509173 [debug] [MainThread]: On master: BEGIN
[0m06:03:02.509562 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:02.510505 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:02.510925 [debug] [MainThread]: On master: COMMIT
[0m06:03:02.511351 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:02.511728 [debug] [MainThread]: On master: COMMIT
[0m06:03:02.512386 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:02.512810 [debug] [MainThread]: On master: Close
[0m06:03:02.513382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:02.513753 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:02.514223 [info ] [MainThread]: 
[0m06:03:02.514728 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.10 seconds (9.10s).
[0m06:03:02.515721 [debug] [MainThread]: Command end result
[0m06:03:02.545468 [info ] [MainThread]: 
[0m06:03:02.546184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:02.546669 [info ] [MainThread]: 
[0m06:03:02.547168 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:02.548193 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.34226, "process_user_time": 5.854422, "process_kernel_time": 0.335425, "process_mem_max_rss": "323960", "process_in_blocks": "1200", "process_out_blocks": "107304"}
[0m06:03:02.548754 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:02.548646 after 11.34 seconds
[0m06:03:02.549239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026d395e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2025587a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd58727b0>]}
[0m06:03:02.549732 [debug] [MainThread]: Flushing usage events
[0m06:03:04.541158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e4385a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e50b6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e50b6090>]}


============================== 06:03:04.544612 | d1f7c138-0a74-4ce9-985a-6e31500253a9 ==============================
[0m06:03:04.544612 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:04.545404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:04.670008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1f7c138-0a74-4ce9-985a-6e31500253a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e3eda4e0>]}
[0m06:03:04.689329 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20137587, "process_user_time": 1.452365, "process_kernel_time": 0.114949, "process_mem_max_rss": "99896", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:03:04.689922 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:04.689812 after 0.20 seconds
[0m06:03:04.690406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e3eff8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e43842c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e4385a30>]}
[0m06:03:04.690851 [debug] [MainThread]: Flushing usage events
[0m14:05:17.532598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f2ec350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58fddd280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f2ecad0>]}


============================== 14:05:17.545804 | 5b300d89-c1de-4653-a304-ecf78c784803 ==============================
[0m14:05:17.545804 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:17.546446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:17.725768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b300d89-c1de-4653-a304-ecf78c784803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f6cd190>]}
[0m14:05:17.741617 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tw29ox31'
[0m14:05:17.742109 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:17.941084 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:17.942534 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:17.973389 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:17.977968 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:18.132288 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:18.132887 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:05:18.133414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5b300d89-c1de-4653-a304-ecf78c784803', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f50cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f37a630>]}
[0m14:05:18.133906 [info ] [MainThread]: 
[0m14:05:18.134374 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:18.168528 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6872557, "process_user_time": 1.68707, "process_kernel_time": 0.142005, "process_mem_max_rss": "100796", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m14:05:18.169118 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:18.169014 after 0.69 seconds
[0m14:05:18.169575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff593ad3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f28c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f6cd190>]}
[0m14:05:18.170060 [debug] [MainThread]: Flushing usage events
[0m14:05:19.813796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ca79a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c7ef38c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c7c33410>]}


============================== 14:05:19.817036 | 7c64aa58-f025-4453-b2c6-eac7fd04dea1 ==============================
[0m14:05:19.817036 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:19.817751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:20.048555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c8de8f50>]}
[0m14:05:20.110322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c7a3ebd0>]}
[0m14:05:20.112120 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:05:20.145387 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:20.146156 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:20.146702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c0620cb0>]}
[0m14:05:21.556127 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:21.556831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c00cd880>]}
[0m14:05:21.806862 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:21.812320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b3b7a960>]}
[0m14:05:21.908322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c0169df0>]}
[0m14:05:21.908929 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:05:21.909416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c015fce0>]}
[0m14:05:21.911265 [info ] [MainThread]: 
[0m14:05:21.911987 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:21.916873 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:21.952716 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:21.953172 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:21.953557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:22.281582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.283944 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:22.285160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:22.286024 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:22.294244 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.294678 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:22.295061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:22.296024 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.297320 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.297722 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:22.298300 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.298697 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.299061 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:22.299676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.300562 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:22.300972 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.301338 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:22.301913 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.302304 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:22.303488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:22.309277 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:22.309697 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:22.310065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:22.310726 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.311114 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:22.311488 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:22.322197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.323621 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:22.324903 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:22.325304 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:22.327514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c9981a60>]}
[0m14:05:22.328081 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.328462 [debug] [MainThread]: On master: BEGIN
[0m14:05:22.328864 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:22.329504 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.329926 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.330295 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.330650 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.331262 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.331678 [debug] [MainThread]: On master: Close
[0m14:05:22.332191 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:22.332709 [info ] [MainThread]: 
[0m14:05:22.353761 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:22.354358 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:22.355014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:22.355451 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:22.383235 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:22.384228 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:22.422380 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:22.423382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:30.550761 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.551310 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:30.551995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.552436 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.552906 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:05:30.553953 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.555314 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.555780 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:05:30.557001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.565031 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.565483 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:30.566242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.569264 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.569727 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:30.570442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.587071 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.587519 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.587952 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.589756 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.595514 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.595992 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:05:30.597192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.599588 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:30.601142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c0095070>]}
[0m14:05:30.601841 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.25s]
[0m14:05:30.602597 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:30.603585 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:30.604165 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:30.604746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:30.605179 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:30.610178 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:30.610857 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:30.647604 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.648148 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251122140530641497"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:30.648613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:30.655726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.663375 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.663847 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:30.664497 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.664952 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.665369 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251122140530641497'
      
      
      order by ordinal_position

  
[0m14:05:30.668738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.673985 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.674441 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.676956 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.684719 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.685177 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.687551 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.689238 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.689695 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:05:30.690447 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.708967 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:30.709652 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.710124 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251122140530641497"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251122140530641497"
    )
  
[0m14:05:30.769721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.771834 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.772328 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.772760 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.778840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.779795 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:30.780504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88737cd250>]}
[0m14:05:30.781209 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m14:05:30.781956 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:30.783928 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:30.784356 [debug] [MainThread]: On master: BEGIN
[0m14:05:30.784765 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:30.785501 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:30.785945 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.786319 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:30.786712 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.787276 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:30.787698 [debug] [MainThread]: On master: Close
[0m14:05:30.788167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:30.788526 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:30.788963 [info ] [MainThread]: 
[0m14:05:30.789468 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.88 seconds (8.88s).
[0m14:05:30.790474 [debug] [MainThread]: Command end result
[0m14:05:30.816228 [info ] [MainThread]: 
[0m14:05:30.816871 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:30.817385 [info ] [MainThread]: 
[0m14:05:30.817936 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:30.818973 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.05933, "process_user_time": 5.609932, "process_kernel_time": 0.311885, "process_mem_max_rss": "333580", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m14:05:30.819519 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:30.819417 after 11.06 seconds
[0m14:05:30.819987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ca79a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c7b7e180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c7a58e60>]}
[0m14:05:30.820412 [debug] [MainThread]: Flushing usage events
[0m14:05:32.657548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9157c832f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9157c45ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915982d370>]}


============================== 14:05:32.660763 | f841a433-fcc0-42a3-ace7-28b29ff29a74 ==============================
[0m14:05:32.660763 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:32.661458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:32.780924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f841a433-fcc0-42a3-ace7-28b29ff29a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9157bce5a0>]}
[0m14:05:32.799510 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19348136, "process_user_time": 1.402522, "process_kernel_time": 0.118959, "process_mem_max_rss": "99664", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:32.800100 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:32.799995 after 0.19 seconds
[0m14:05:32.800526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9158daa060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9157a38380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91582714c0>]}
[0m14:05:32.800994 [debug] [MainThread]: Flushing usage events
[0m22:06:16.465473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f58df7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f58df9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f58de420>]}


============================== 22:06:16.524213 | 4e586fd0-f9d2-4d15-928b-9af52a86b6f6 ==============================
[0m22:06:16.524213 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:16.524917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:16.760473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e586fd0-f9d2-4d15-928b-9af52a86b6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f4ffcdd0>]}
[0m22:06:16.776774 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8d4rxxv5'
[0m22:06:16.777321 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:16.892143 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:16.894082 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:16.942232 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:16.947626 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:17.043860 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:17.044543 [info ] [MainThread]: Updated version available: 1.3.2
[0m22:06:17.045142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4e586fd0-f9d2-4d15-928b-9af52a86b6f6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f5261100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f4c703e0>]}
[0m22:06:17.045613 [info ] [MainThread]: 
[0m22:06:17.046103 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:17.077754 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.66445327, "process_user_time": 1.766131, "process_kernel_time": 0.138323, "process_mem_max_rss": "100676", "process_in_blocks": "8760", "process_out_blocks": "5176"}
[0m22:06:17.078520 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:17.078398 after 0.67 seconds
[0m22:06:17.079046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f52912e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f4df7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f4b67e90>]}
[0m22:06:17.079527 [debug] [MainThread]: Flushing usage events
[0m22:06:18.859054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62851ed4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62856bd760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62856bdd00>]}


============================== 22:06:18.862429 | fa1f70ea-5297-45bd-a081-efe2e989a355 ==============================
[0m22:06:18.862429 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:18.863136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:19.109175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6285de8fe0>]}
[0m22:06:19.173187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62875849e0>]}
[0m22:06:19.175187 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:19.209759 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:19.210620 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:19.211185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62849de210>]}
[0m22:06:20.654751 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:20.655492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627d596d80>]}
[0m22:06:20.928511 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:20.934527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6284c8f410>]}
[0m22:06:21.037158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627d460bc0>]}
[0m22:06:21.037759 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:21.038278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62856ecce0>]}
[0m22:06:21.040317 [info ] [MainThread]: 
[0m22:06:21.041079 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:21.046198 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:21.085269 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:21.085850 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:21.086292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:21.571730 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.573582 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:21.574825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:21.575578 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:21.585703 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:21.586286 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:21.586718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:21.588266 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.589988 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:21.590431 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:21.591157 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.591611 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:21.592074 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:21.592813 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.593785 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:21.594205 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:21.594590 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:21.595202 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.595613 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:21.597009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:21.603506 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:21.604175 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:21.604585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:21.605783 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.606228 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:21.606602 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:21.619039 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.620885 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:21.622289 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:21.622715 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:21.624915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62849de060>]}
[0m22:06:21.625455 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:21.625869 [debug] [MainThread]: On master: BEGIN
[0m22:06:21.626239 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:21.627215 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:21.627669 [debug] [MainThread]: On master: COMMIT
[0m22:06:21.628081 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:21.628472 [debug] [MainThread]: On master: COMMIT
[0m22:06:21.629146 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:21.629547 [debug] [MainThread]: On master: Close
[0m22:06:21.630111 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:21.630586 [info ] [MainThread]: 
[0m22:06:21.813944 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:21.814701 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:21.815523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:21.816048 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:21.845030 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:21.845965 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:21.893047 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:21.894054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:29.482575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.483191 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:29.484062 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.484505 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.484972 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:29.486038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.487520 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.487989 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:29.489100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.496462 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.497000 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:29.497981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.502675 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.503166 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:29.504038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.521292 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:29.521903 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.522340 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:29.524229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.530834 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.531373 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:29.533036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.535665 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:29.537305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62355950a0>]}
[0m22:06:29.538066 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.72s]
[0m22:06:29.538868 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:29.539865 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:29.540445 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:29.541179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:29.541624 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:29.547178 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:29.547908 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:29.585446 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.586050 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251122220629579151"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:29.586529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:29.594058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.602584 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.603143 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:29.604011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.604444 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.604878 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251122220629579151'
      
      
      order by ordinal_position

  
[0m22:06:29.607575 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.613409 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.613959 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:29.616944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.625656 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.626206 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:29.629318 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.631250 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.631722 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:06:29.632554 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.651016 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:29.651928 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.652437 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251122220629579151"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251122220629579151"
    )
  
[0m22:06:29.711657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.713856 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:29.714363 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.714836 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:29.722190 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.723364 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:29.724202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627cd88cb0>]}
[0m22:06:29.724969 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m22:06:29.725741 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:29.727443 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:29.727912 [debug] [MainThread]: On master: BEGIN
[0m22:06:29.728307 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:29.729209 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:29.729616 [debug] [MainThread]: On master: COMMIT
[0m22:06:29.730049 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:29.730418 [debug] [MainThread]: On master: COMMIT
[0m22:06:29.731068 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:29.731472 [debug] [MainThread]: On master: Close
[0m22:06:29.732009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:29.732374 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:29.732785 [info ] [MainThread]: 
[0m22:06:29.733304 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.69 seconds (8.69s).
[0m22:06:29.734303 [debug] [MainThread]: Command end result
[0m22:06:29.763593 [info ] [MainThread]: 
[0m22:06:29.764269 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:29.764753 [info ] [MainThread]: 
[0m22:06:29.765276 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:29.766299 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.960622, "process_user_time": 5.925612, "process_kernel_time": 0.354635, "process_mem_max_rss": "334852", "process_in_blocks": "1200", "process_out_blocks": "107336"}
[0m22:06:29.766874 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:29.766741 after 10.96 seconds
[0m22:06:29.767319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f628508f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627cda8230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62346def30>]}
[0m22:06:29.767759 [debug] [MainThread]: Flushing usage events
[0m22:06:31.685593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe806c46510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe805cb51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80540cad0>]}


============================== 22:06:31.689126 | 63f285a0-93e8-4a5c-8d8b-e63f8bded3c0 ==============================
[0m22:06:31.689126 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:31.689892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:31.811166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63f285a0-93e8-4a5c-8d8b-e63f8bded3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe804bc1580>]}
[0m22:06:31.831064 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19891493, "process_user_time": 1.419081, "process_kernel_time": 0.119837, "process_mem_max_rss": "99536", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:31.831644 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:31.831534 after 0.20 seconds
[0m22:06:31.832132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe804f8f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8049af3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80498f470>]}
[0m22:06:31.832589 [debug] [MainThread]: Flushing usage events
[0m06:02:55.269830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d45c59220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d467362a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d45d26810>]}


============================== 06:02:55.298146 | 42e4f472-b01e-461f-8a5c-7aa50762a376 ==============================
[0m06:02:55.298146 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:55.298858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:55.508613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42e4f472-b01e-461f-8a5c-7aa50762a376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d449bd700>]}
[0m06:02:55.523748 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-25w7v57_'
[0m06:02:55.524219 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:55.661723 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:55.663082 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:55.732469 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:55.737461 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:55.935864 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:55.936457 [info ] [MainThread]: Updated version available: 1.3.2
[0m06:02:55.937037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '42e4f472-b01e-461f-8a5c-7aa50762a376', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d4399ce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d438e8590>]}
[0m06:02:55.937471 [info ] [MainThread]: 
[0m06:02:55.937985 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:55.956878 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.73759365, "process_user_time": 1.624433, "process_kernel_time": 0.147766, "process_mem_max_rss": "100804", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m06:02:55.957419 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:55.957319 after 0.74 seconds
[0m06:02:55.957875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d44584b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d439ac6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d439aca10>]}
[0m06:02:55.958281 [debug] [MainThread]: Flushing usage events
[0m06:02:57.660017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3580dfc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3597f3b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35b1cb530>]}


============================== 06:02:57.663150 | 471154e4-f271-436e-a8cb-fa1a5427d577 ==============================
[0m06:02:57.663150 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:57.663848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:57.891660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3585f8e00>]}
[0m06:02:57.952462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3591739e0>]}
[0m06:02:57.954194 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:02:57.975589 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:57.976332 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:57.976877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3571c4e30>]}
[0m06:02:59.356466 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:59.357152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34fc9ed80>]}
[0m06:02:59.594944 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:59.600336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34f478aa0>]}
[0m06:02:59.701231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34f554da0>]}
[0m06:02:59.701819 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:02:59.702338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34f5005f0>]}
[0m06:02:59.704208 [info ] [MainThread]: 
[0m06:02:59.704955 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:59.709789 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:59.745683 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:59.746170 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:59.746568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:00.314838 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:03:00.316447 [debug] [ThreadPool]: On list_petro: Close
[0m06:03:00.317300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:03:00.317855 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:03:00.325223 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.325654 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:03:00.326032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:00.327030 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.328579 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.329054 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:03:00.329747 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.330127 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.330486 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:03:00.331116 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.332032 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:00.332429 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.332824 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:00.333389 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.333801 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:03:00.335016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:03:00.340823 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:00.341221 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:03:00.341577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:00.342485 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.342903 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:00.343277 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:03:00.353795 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.355256 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:03:00.356506 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:03:00.356937 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:03:00.358938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3591d5970>]}
[0m06:03:00.359447 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:00.359856 [debug] [MainThread]: On master: BEGIN
[0m06:03:00.360226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:00.360876 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:00.361266 [debug] [MainThread]: On master: COMMIT
[0m06:03:00.361651 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:00.362012 [debug] [MainThread]: On master: COMMIT
[0m06:03:00.362586 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:00.363001 [debug] [MainThread]: On master: Close
[0m06:03:00.363476 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:03:00.363963 [info ] [MainThread]: 
[0m06:03:00.386083 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:03:00.386691 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:03:00.387319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:03:00.387787 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:03:00.414629 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:03:00.415369 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:03:00.451377 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:03:00.452192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:10.414566 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.415118 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:10.415793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.416241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.416711 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:10.417722 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.419315 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.419786 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:10.420982 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.428891 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.429348 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:10.430112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.433122 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.433561 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:10.434298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.450942 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:10.451401 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.451837 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:10.454309 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.460131 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.460581 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:10.462025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.464457 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:10.465989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc303f0ecf0>]}
[0m06:03:10.466691 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.08s]
[0m06:03:10.467444 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:10.468244 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:10.468811 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:10.469440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:10.469911 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:10.474894 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:10.475783 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:10.511783 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.512270 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251123060310505796"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:10.512746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:10.519510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.526899 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.527341 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:10.527997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.528425 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.528863 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251123060310505796'
      
      
      order by ordinal_position

  
[0m06:03:10.531292 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.536392 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.536863 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:10.539305 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.546936 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.547389 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:10.550298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.551973 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.552413 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:10.553147 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.571470 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:10.572161 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.572631 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251123060310505796"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251123060310505796"
    )
  
[0m06:03:10.629945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.631942 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:10.632380 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.632814 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:10.638092 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.638984 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:10.639666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc30321ea50>]}
[0m06:03:10.640329 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:03:10.641141 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:10.642755 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:10.643174 [debug] [MainThread]: On master: BEGIN
[0m06:03:10.643546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:10.644261 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:10.644684 [debug] [MainThread]: On master: COMMIT
[0m06:03:10.645058 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:10.645421 [debug] [MainThread]: On master: COMMIT
[0m06:03:10.646040 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:10.646425 [debug] [MainThread]: On master: Close
[0m06:03:10.646939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:10.647299 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:10.647715 [info ] [MainThread]: 
[0m06:03:10.648165 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.94 seconds (10.94s).
[0m06:03:10.649078 [debug] [MainThread]: Command end result
[0m06:03:10.674608 [info ] [MainThread]: 
[0m06:03:10.675165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:10.675632 [info ] [MainThread]: 
[0m06:03:10.676094 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:10.677048 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.069069, "process_user_time": 5.712059, "process_kernel_time": 0.301214, "process_mem_max_rss": "365612", "process_in_blocks": "1200", "process_out_blocks": "107312"}
[0m06:03:10.677580 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:10.677479 after 13.07 seconds
[0m06:03:10.678037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3574431d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc357844740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc357817dd0>]}
[0m06:03:10.678462 [debug] [MainThread]: Flushing usage events
[0m06:03:12.512816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f599835ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5998f6bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5997465eb0>]}


============================== 06:03:12.516035 | 3a156b8d-77a2-4f69-911e-e84dc86c3012 ==============================
[0m06:03:12.516035 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:12.516742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:03:12.631255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a156b8d-77a2-4f69-911e-e84dc86c3012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59966abd70>]}
[0m06:03:12.649627 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1881399, "process_user_time": 1.323672, "process_kernel_time": 0.111972, "process_mem_max_rss": "99408", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:03:12.650170 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:12.650062 after 0.19 seconds
[0m06:03:12.650607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5996c30fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5996490380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59964ecb90>]}
[0m06:03:12.651034 [debug] [MainThread]: Flushing usage events
[0m14:05:21.028336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc65876ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc65597980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc65597aa0>]}


============================== 14:05:21.040976 | 473d1c3f-5780-4d79-9d90-bd6dff4ff144 ==============================
[0m14:05:21.040976 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:21.041720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:21.211437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '473d1c3f-5780-4d79-9d90-bd6dff4ff144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc65809f70>]}
[0m14:05:21.227416 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-gvrxvb98'
[0m14:05:21.227918 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:21.412713 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:21.414447 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:21.450633 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:21.455541 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:21.614554 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:21.615171 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:05:21.615725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '473d1c3f-5780-4d79-9d90-bd6dff4ff144', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc657a0ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc65140800>]}
[0m14:05:21.616235 [info ] [MainThread]: 
[0m14:05:21.616707 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:21.638410 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6609263, "process_user_time": 1.64401, "process_kernel_time": 0.152278, "process_mem_max_rss": "101016", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m14:05:21.639096 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:21.638935 after 0.66 seconds
[0m14:05:21.639564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6553af00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc657a2930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc657a0ef0>]}
[0m14:05:21.639995 [debug] [MainThread]: Flushing usage events
[0m14:05:23.303566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84d5654c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84cabbc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84d46d4f0>]}


============================== 14:05:23.306618 | 6a0e5afa-5081-42a4-96e6-374b31777f04 ==============================
[0m14:05:23.306618 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.307326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:23.537655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84d9f0e90>]}
[0m14:05:23.599389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84cb317f0>]}
[0m14:05:23.601223 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:05:23.621787 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:23.622551 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:23.623085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff845030b90>]}
[0m14:05:25.010527 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:25.011199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff845103b60>]}
[0m14:05:25.248819 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:25.254213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff844899760>]}
[0m14:05:25.349408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8449470e0>]}
[0m14:05:25.349989 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:05:25.350573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8451df9b0>]}
[0m14:05:25.352472 [info ] [MainThread]: 
[0m14:05:25.353224 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:25.358116 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:25.393942 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:25.394414 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:25.394804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:25.809259 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.812847 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:25.813957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:25.814533 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:25.821954 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:25.822390 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:25.822764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:25.824248 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.825602 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:25.825990 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:25.826636 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.827014 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:25.827438 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:25.828066 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.828969 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:25.829398 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:25.829760 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:25.830381 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.830787 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:25.832029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:25.838158 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:25.838558 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:25.838921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:25.839620 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.840005 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:25.840404 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:25.851427 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.852929 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:25.854218 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:25.854620 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:25.856829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff844906300>]}
[0m14:05:25.857375 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:25.857752 [debug] [MainThread]: On master: BEGIN
[0m14:05:25.858135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:25.858783 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:25.859202 [debug] [MainThread]: On master: COMMIT
[0m14:05:25.859573 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:25.859932 [debug] [MainThread]: On master: COMMIT
[0m14:05:25.860520 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:25.860912 [debug] [MainThread]: On master: Close
[0m14:05:25.861419 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:25.861889 [info ] [MainThread]: 
[0m14:05:25.881527 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:25.882160 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:25.882831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:25.883293 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:25.910080 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:25.910839 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:25.946256 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:25.947057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:34.934986 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.935567 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:34.936315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.936756 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.937215 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:05:34.938212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.939566 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.940016 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:05:34.941080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.947807 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.948284 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:34.949116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.953298 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.953743 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:34.954526 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.971217 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:34.971688 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.972133 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:34.973545 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.979558 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.980015 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:05:34.981215 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.983690 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:34.985241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8451df6e0>]}
[0m14:05:34.985929 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.10s]
[0m14:05:34.986712 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:34.987727 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:34.988328 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:34.988891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:34.989382 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:34.994477 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:34.995141 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:35.031844 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.032410 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251123140535025716"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:35.032873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:35.040058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.047988 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.048498 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:35.049261 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.049695 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.050163 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251123140535025716'
      
      
      order by ordinal_position

  
[0m14:05:35.052719 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.058138 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.058597 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:35.061027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.069276 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.069802 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:35.072638 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.074463 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.074916 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:05:35.075708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.093337 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:35.094141 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.094606 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251123140535025716"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251123140535025716"
    )
  
[0m14:05:35.153010 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.155054 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:35.155507 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.155916 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:35.161911 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.162835 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:35.163538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff844729430>]}
[0m14:05:35.164223 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:05:35.164950 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:35.166615 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:35.167078 [debug] [MainThread]: On master: BEGIN
[0m14:05:35.167474 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:35.168163 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:35.168566 [debug] [MainThread]: On master: COMMIT
[0m14:05:35.168955 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:35.169392 [debug] [MainThread]: On master: COMMIT
[0m14:05:35.169972 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:35.170399 [debug] [MainThread]: On master: Close
[0m14:05:35.170858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:35.171245 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:35.171641 [info ] [MainThread]: 
[0m14:05:35.172173 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.82 seconds (9.82s).
[0m14:05:35.173192 [debug] [MainThread]: Command end result
[0m14:05:35.200141 [info ] [MainThread]: 
[0m14:05:35.200786 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:35.201329 [info ] [MainThread]: 
[0m14:05:35.201858 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:35.202876 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.949886, "process_user_time": 5.218987, "process_kernel_time": 0.274631, "process_mem_max_rss": "334104", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m14:05:35.203467 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:35.203361 after 11.95 seconds
[0m14:05:35.203904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84d9a7b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84cc7c350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7fc1cf8f0>]}
[0m14:05:35.204356 [debug] [MainThread]: Flushing usage events
[0m14:05:37.084948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93644caa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93689f920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93644e7b0>]}


============================== 14:05:37.088258 | f9af1dd8-72ee-4a0e-96e8-6640c053628e ==============================
[0m14:05:37.088258 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:37.088947 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:37.204435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9af1dd8-72ee-4a0e-96e8-6640c053628e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe937d1b980>]}
[0m14:05:37.223001 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19037297, "process_user_time": 1.380766, "process_kernel_time": 0.09991, "process_mem_max_rss": "99476", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:37.223574 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:37.223470 after 0.19 seconds
[0m14:05:37.223996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93618bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe937d1b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe935ccbe00>]}
[0m14:05:37.224446 [debug] [MainThread]: Flushing usage events
[0m22:06:44.249694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48bcb13650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48bda18740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48bcd83b30>]}


============================== 22:06:44.263793 | a4794751-6439-48b4-bd0e-aa9bff333ce1 ==============================
[0m22:06:44.263793 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:44.264419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:44.434346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4794751-6439-48b4-bd0e-aa9bff333ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48bc7be600>]}
[0m22:06:44.448859 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-e1t8ytn4'
[0m22:06:44.449295 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:44.629382 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:44.630588 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:44.672787 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:44.677366 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:44.771600 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:44.772162 [info ] [MainThread]: Updated version available: 1.3.2
[0m22:06:44.772724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a4794751-6439-48b4-bd0e-aa9bff333ce1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48bc6cc770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48bc679550>]}
[0m22:06:44.773172 [info ] [MainThread]: 
[0m22:06:44.773652 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:44.786321 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5870858, "process_user_time": 1.61788, "process_kernel_time": 0.125455, "process_mem_max_rss": "100944", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m22:06:44.786881 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:44.786777 after 0.59 seconds
[0m22:06:44.787302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c0f63920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48bca5e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48bc730ce0>]}
[0m22:06:44.787726 [debug] [MainThread]: Flushing usage events
[0m22:06:46.361281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500f27ce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5011a86de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500fa914c0>]}


============================== 22:06:46.364381 | 63fbde7e-b0d0-41d4-aba2-c13bf138d2d3 ==============================
[0m22:06:46.364381 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:46.365041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:46.601252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50077925d0>]}
[0m22:06:46.662202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500fbd7ce0>]}
[0m22:06:46.663827 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:46.685087 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:46.685821 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:46.686341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50077d7470>]}
[0m22:06:48.060400 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:48.061033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5006e977d0>]}
[0m22:06:48.291343 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:48.296474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5006e96150>]}
[0m22:06:48.395032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5006f4b710>]}
[0m22:06:48.395582 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:48.396106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5006d46d20>]}
[0m22:06:48.397937 [info ] [MainThread]: 
[0m22:06:48.398632 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:48.403463 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:48.439436 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:48.439891 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:48.440281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:48.850159 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:48.851974 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:48.852955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:48.853576 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:48.862156 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:48.862637 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:48.863159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:48.864354 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:48.865822 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:48.866213 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:48.866806 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:48.867189 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:48.867547 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:48.868172 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:48.869089 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:48.869475 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:48.869863 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:48.870436 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:48.870848 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:48.872033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:48.877920 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:48.878324 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:48.878681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:48.879405 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:48.879838 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:48.880216 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:48.891079 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:48.892594 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:48.893866 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:48.894275 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:48.896435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5005ab6690>]}
[0m22:06:48.896955 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:48.897334 [debug] [MainThread]: On master: BEGIN
[0m22:06:48.897692 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:48.898397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:48.898817 [debug] [MainThread]: On master: COMMIT
[0m22:06:48.899184 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:48.899538 [debug] [MainThread]: On master: COMMIT
[0m22:06:48.900119 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:48.900503 [debug] [MainThread]: On master: Close
[0m22:06:48.901008 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:48.901484 [info ] [MainThread]: 
[0m22:06:48.921995 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:48.922571 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:48.923222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:48.923655 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:48.949860 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:48.950581 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:48.985468 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:48.986212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:57.352482 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:57.353030 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:57.353676 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.354139 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:57.354560 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:57.355548 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.356924 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:57.357363 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:57.358534 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.366466 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:57.366954 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:57.367788 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.370771 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:57.371216 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:57.371964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.388587 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:57.389074 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:57.389498 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:57.390844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.396482 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:57.396965 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:57.398750 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.401124 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:57.402633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5005a8bd40>]}
[0m22:06:57.403339 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.48s]
[0m22:06:57.404115 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:57.405102 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:57.405652 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:57.406246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:57.406677 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:57.411637 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:57.412299 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:57.447953 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:57.448437 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251123220657441998"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:57.448915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:57.455759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.463048 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:57.463496 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:57.464153 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.464582 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:57.465029 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251123220657441998'
      
      
      order by ordinal_position

  
[0m22:06:57.467365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.472533 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:57.473008 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:57.475425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.483029 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:57.483483 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:57.485932 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.487594 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:57.488063 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:06:57.488770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.506815 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:57.507473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:57.507944 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251123220657441998"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251123220657441998"
    )
  
[0m22:06:57.567222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.569211 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:57.569664 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:57.570103 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:57.576244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.577157 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:57.577871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5006d6c6e0>]}
[0m22:06:57.578541 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:06:57.579267 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:57.581264 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:57.581682 [debug] [MainThread]: On master: BEGIN
[0m22:06:57.582101 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:57.582842 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:57.583249 [debug] [MainThread]: On master: COMMIT
[0m22:06:57.583624 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:57.584090 [debug] [MainThread]: On master: COMMIT
[0m22:06:57.584769 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:57.585176 [debug] [MainThread]: On master: Close
[0m22:06:57.585633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:57.586033 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:57.586439 [info ] [MainThread]: 
[0m22:06:57.586967 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.19 seconds (9.19s).
[0m22:06:57.587990 [debug] [MainThread]: Command end result
[0m22:06:57.613173 [info ] [MainThread]: 
[0m22:06:57.613763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:57.614253 [info ] [MainThread]: 
[0m22:06:57.614763 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:57.615755 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.3056, "process_user_time": 5.103142, "process_kernel_time": 0.288403, "process_mem_max_rss": "346640", "process_in_blocks": "1200", "process_out_blocks": "107336"}
[0m22:06:57.616296 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:57.616193 after 11.31 seconds
[0m22:06:57.616745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5011a2ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500fafe180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500f2a8620>]}
[0m22:06:57.617172 [debug] [MainThread]: Flushing usage events
[0m22:06:59.267747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a24d57290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a24d54a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a2536cf80>]}


============================== 22:06:59.270717 | 4c1e7ae8-bc9d-4213-b94e-6b4361b555ef ==============================
[0m22:06:59.270717 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:59.271396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:59.385048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c1e7ae8-bc9d-4213-b94e-6b4361b555ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a25eaae40>]}
[0m22:06:59.402650 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18487474, "process_user_time": 1.307487, "process_kernel_time": 0.10804, "process_mem_max_rss": "99944", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:59.403247 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:59.403148 after 0.19 seconds
[0m22:06:59.403653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a2582cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a24b6c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a24d1a180>]}
[0m22:06:59.404086 [debug] [MainThread]: Flushing usage events
[0m06:03:00.336598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d71c754c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d729a7f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d729a68d0>]}


============================== 06:03:00.347844 | 2467c20f-9c05-4130-b363-9e1115d79fd8 ==============================
[0m06:03:00.347844 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:00.348485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:03:00.479081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2467c20f-9c05-4130-b363-9e1115d79fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d7243af60>]}
[0m06:03:00.492233 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ad7etkns'
[0m06:03:00.492675 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:03:00.630667 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:03:00.632332 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:03:00.714738 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:03:00.719504 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:03:01.002179 [info ] [MainThread]: Installed from version 1.2.0
[0m06:03:01.002780 [info ] [MainThread]: Updated version available: 1.3.2
[0m06:03:01.003288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2467c20f-9c05-4130-b363-9e1115d79fd8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d71575fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d71576390>]}
[0m06:03:01.003763 [info ] [MainThread]: 
[0m06:03:01.004172 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:03:01.014329 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7215606, "process_user_time": 1.477729, "process_kernel_time": 0.088222, "process_mem_max_rss": "101216", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m06:03:01.014951 [debug] [MainThread]: Command `dbt deps` succeeded at 06:03:01.014846 after 0.72 seconds
[0m06:03:01.015448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d71eb27b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d7243af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d71c34860>]}
[0m06:03:01.015847 [debug] [MainThread]: Flushing usage events
[0m06:03:02.596833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead1651dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feacf0eddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feacf076b40>]}


============================== 06:03:02.599623 | 2c72f1ae-ec9c-4115-86a8-f4055526ef7a ==============================
[0m06:03:02.599623 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:02.600190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:03:02.802446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feace8b14c0>]}
[0m06:03:02.856142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feacf590ec0>]}
[0m06:03:02.857799 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:03:02.888629 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:03:02.889241 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:03:02.889728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac7336810>]}
[0m06:03:04.083877 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:03:04.084495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feacea04770>]}
[0m06:03:04.293432 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:03:04.298331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac6933f20>]}
[0m06:03:04.383226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac6b52f60>]}
[0m06:03:04.383757 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:03:04.384190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac6afb3e0>]}
[0m06:03:04.386073 [info ] [MainThread]: 
[0m06:03:04.386713 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:03:04.391020 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:03:04.421736 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:03:04.422178 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:03:04.422538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:05.049939 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:03:05.051789 [debug] [ThreadPool]: On list_petro: Close
[0m06:03:05.052787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:03:05.053438 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:03:05.060127 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:05.060533 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:03:05.060864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:05.061849 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:05.063128 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:05.063494 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:03:05.064882 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:05.065244 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:05.065589 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:03:05.066153 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:05.067027 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:05.067389 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:05.067696 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:05.068211 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:05.068574 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:03:05.069761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:03:05.075171 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:05.075636 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:03:05.075945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:05.076573 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:05.076935 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:05.077255 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:03:05.087896 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:05.089285 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:03:05.090440 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:03:05.090797 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:03:05.092774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac6b25a90>]}
[0m06:03:05.093232 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:05.093586 [debug] [MainThread]: On master: BEGIN
[0m06:03:05.093891 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:05.094502 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:05.094864 [debug] [MainThread]: On master: COMMIT
[0m06:03:05.095180 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:05.095505 [debug] [MainThread]: On master: COMMIT
[0m06:03:05.095999 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:05.096347 [debug] [MainThread]: On master: Close
[0m06:03:05.096765 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:03:05.097190 [info ] [MainThread]: 
[0m06:03:05.114031 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:03:05.114612 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:03:05.115129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:03:05.115524 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:03:05.139491 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:03:05.140122 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:03:05.171673 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:03:05.172333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:15.442962 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:15.443479 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:15.444092 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.444517 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:15.444876 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:15.445782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.447099 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:15.447525 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:15.448500 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.454773 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:15.455189 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:15.455898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.459841 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:15.460244 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:15.460918 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.475879 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:15.476308 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:15.476673 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:15.478044 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.483222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:15.483672 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:15.484734 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.486894 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:15.488313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feacf4e4950>]}
[0m06:03:15.488977 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.37s]
[0m06:03:15.489671 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:15.490596 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:15.491115 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:15.491698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:15.492113 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:15.498475 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:15.499836 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:15.532818 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:15.533277 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251124060315527398"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:15.533664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:15.540907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.547684 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:15.548086 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:15.548680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.549047 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:15.549408 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251124060315527398'
      
      
      order by ordinal_position

  
[0m06:03:15.551819 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.556602 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:15.557012 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:15.559418 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.566362 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:15.566776 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:15.569498 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.571044 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:15.571460 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:15.572149 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.587067 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:15.587678 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:15.588068 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251124060315527398"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251124060315527398"
    )
  
[0m06:03:15.647256 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.649106 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:15.649562 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:15.649917 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:15.656114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.656951 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:15.657582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea8053c650>]}
[0m06:03:15.658190 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:03:15.658857 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:15.660349 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:15.660831 [debug] [MainThread]: On master: BEGIN
[0m06:03:15.661176 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:15.661855 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:15.662209 [debug] [MainThread]: On master: COMMIT
[0m06:03:15.662557 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:15.662864 [debug] [MainThread]: On master: COMMIT
[0m06:03:15.663404 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:15.663774 [debug] [MainThread]: On master: Close
[0m06:03:15.664193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:15.664530 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:15.664867 [info ] [MainThread]: 
[0m06:03:15.665326 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.28 seconds (11.28s).
[0m06:03:15.666197 [debug] [MainThread]: Command end result
[0m06:03:15.690202 [info ] [MainThread]: 
[0m06:03:15.690770 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:15.691235 [info ] [MainThread]: 
[0m06:03:15.691731 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:15.692612 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.139614, "process_user_time": 4.678389, "process_kernel_time": 0.218158, "process_mem_max_rss": "347804", "process_in_blocks": "1200", "process_out_blocks": "107312"}
[0m06:03:15.693136 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:15.693054 after 13.14 seconds
[0m06:03:15.693591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feacf077f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea819baab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feacee962d0>]}
[0m06:03:15.693968 [debug] [MainThread]: Flushing usage events
[0m06:03:17.356408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6256bfd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62598ea120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f625771c200>]}


============================== 06:03:17.359425 | 7ba61536-fbfc-416d-a0e9-d97184b91206 ==============================
[0m06:03:17.359425 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:17.359995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:03:17.458917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ba61536-fbfc-416d-a0e9-d97184b91206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62571b4e00>]}
[0m06:03:17.472009 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16053708, "process_user_time": 1.182384, "process_kernel_time": 0.063912, "process_mem_max_rss": "99604", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:03:17.472525 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:17.472437 after 0.16 seconds
[0m06:03:17.472883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6257954260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62571b4e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6256ee2ea0>]}
[0m06:03:17.473241 [debug] [MainThread]: Flushing usage events
[0m14:06:27.275899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdafab20d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdafa975040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdafad1c320>]}


============================== 14:06:27.290765 | 0c991ff8-8276-4421-a7a0-695f86787889 ==============================
[0m14:06:27.290765 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:27.291437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:27.463115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c991ff8-8276-4421-a7a0-695f86787889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdafa8075f0>]}
[0m14:06:27.478290 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0u_fr699'
[0m14:06:27.478750 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:27.673735 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:27.675434 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:27.717496 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:27.722464 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:27.798611 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:27.799210 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:06:27.799778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0c991ff8-8276-4421-a7a0-695f86787889', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdafa6ce450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdafa6cef00>]}
[0m14:06:27.800265 [info ] [MainThread]: 
[0m14:06:27.800771 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:27.812975 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5883191, "process_user_time": 1.663693, "process_kernel_time": 0.141973, "process_mem_max_rss": "101088", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m14:06:27.813612 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:27.813507 after 0.59 seconds
[0m14:06:27.814117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdafad85250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdafa979d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdafaabdee0>]}
[0m14:06:27.814575 [debug] [MainThread]: Flushing usage events
[0m14:06:29.354192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba7c65430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba79f0b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba79554c0>]}


============================== 14:06:29.357241 | e095a6a3-8d59-43e2-b5c0-dff51bea484c ==============================
[0m14:06:29.357241 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:29.357871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:29.589558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba76a38c0>]}
[0m14:06:29.650988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba76e0350>]}
[0m14:06:29.652683 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:06:29.688641 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:29.689390 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:29.689910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba014a060>]}
[0m14:06:31.078218 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:31.078890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba003ce60>]}
[0m14:06:31.321186 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:31.326589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9f9bec60>]}
[0m14:06:31.489810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba00954c0>]}
[0m14:06:31.490419 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:06:31.490927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba78e3e60>]}
[0m14:06:31.492979 [info ] [MainThread]: 
[0m14:06:31.493724 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:31.498582 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:31.537109 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:31.537567 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:31.538025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:31.863869 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:31.866035 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:31.867159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:31.867921 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:31.875502 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:31.875913 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:31.876312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:31.877564 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:31.878845 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:31.879255 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:31.879854 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:31.880255 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:31.880608 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:31.881307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:31.882234 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:31.882617 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:31.882970 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:31.883591 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:31.883979 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:31.885180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:31.890878 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:31.891297 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:31.891655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:31.892324 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:31.892711 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:31.893113 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:31.903253 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:31.904670 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:31.905879 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:31.906285 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:31.908393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba8aab560>]}
[0m14:06:31.908886 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:31.909308 [debug] [MainThread]: On master: BEGIN
[0m14:06:31.909667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:31.910315 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:31.910711 [debug] [MainThread]: On master: COMMIT
[0m14:06:31.911103 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:31.911471 [debug] [MainThread]: On master: COMMIT
[0m14:06:31.912060 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:31.912452 [debug] [MainThread]: On master: Close
[0m14:06:31.912929 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:31.913405 [info ] [MainThread]: 
[0m14:06:31.934292 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:31.934874 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:31.935452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:31.935878 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:31.962430 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:31.963181 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:31.998239 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:31.998941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:39.295348 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:39.295895 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:39.296662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.297121 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:39.297539 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:39.298541 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.299889 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:39.300355 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:39.301326 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.308164 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:39.308615 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:39.309377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.313498 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:39.313940 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:39.314728 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.331289 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:39.331742 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:39.332179 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:39.333955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.339738 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:39.340209 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:39.341364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.343769 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:39.345283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba962afc0>]}
[0m14:06:39.345956 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.41s]
[0m14:06:39.346732 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:39.347682 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:39.348254 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:39.348816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:39.349281 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:39.354258 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:39.354902 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:39.390939 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:39.391441 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251124140639384913"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:39.391888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:39.398858 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.406384 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:39.406834 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:39.407496 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.407931 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:39.408378 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251124140639384913'
      
      
      order by ordinal_position

  
[0m14:06:39.410840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.416110 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:39.416567 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:39.418941 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.426616 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:39.427091 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:39.429420 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.431091 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:39.431530 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:06:39.432251 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.449519 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:39.450236 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:39.450686 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251124140639384913"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251124140639384913"
    )
  
[0m14:06:39.509984 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.511985 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:39.512459 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:39.512870 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:39.518422 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.519341 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:39.520014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b5df1f0e0>]}
[0m14:06:39.520676 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:06:39.521410 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:39.523485 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:39.523891 [debug] [MainThread]: On master: BEGIN
[0m14:06:39.524301 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:39.524962 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:39.525385 [debug] [MainThread]: On master: COMMIT
[0m14:06:39.525757 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:39.526155 [debug] [MainThread]: On master: COMMIT
[0m14:06:39.526750 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:39.527185 [debug] [MainThread]: On master: Close
[0m14:06:39.527650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:39.528035 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:39.528444 [info ] [MainThread]: 
[0m14:06:39.528900 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.03 seconds (8.03s).
[0m14:06:39.529821 [debug] [MainThread]: Command end result
[0m14:06:39.556652 [info ] [MainThread]: 
[0m14:06:39.557258 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:39.557705 [info ] [MainThread]: 
[0m14:06:39.558196 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:39.559158 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.255344, "process_user_time": 5.183659, "process_kernel_time": 0.28209, "process_mem_max_rss": "342008", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m14:06:39.559694 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:39.559593 after 10.26 seconds
[0m14:06:39.560150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba7c65430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba78e0740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b538b0650>]}
[0m14:06:39.560578 [debug] [MainThread]: Flushing usage events
[0m14:06:41.334204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca40b1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca21cd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca1dc0350>]}


============================== 14:06:41.337247 | e2c37c4c-cf17-4ff0-89a7-3965c686a37c ==============================
[0m14:06:41.337247 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:41.337922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:41.452493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2c37c4c-cf17-4ff0-89a7-3965c686a37c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca17f3f20>]}
[0m14:06:41.470203 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.187202, "process_user_time": 1.333678, "process_kernel_time": 0.105895, "process_mem_max_rss": "99612", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:41.470736 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:41.470633 after 0.19 seconds
[0m14:06:41.471178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca5ad3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca1b90920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca154b170>]}
[0m14:06:41.471584 [debug] [MainThread]: Flushing usage events
[0m22:06:03.496335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527eb81220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527eb109b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527f7197f0>]}


============================== 22:06:03.508623 | 263eddb1-c7c2-4794-8e22-5f684b97f970 ==============================
[0m22:06:03.508623 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:03.509232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:03.659296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '263eddb1-c7c2-4794-8e22-5f684b97f970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527e836540>]}
[0m22:06:03.673453 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wnoad0wi'
[0m22:06:03.673938 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:03.774619 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:03.776532 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:03.838906 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:03.844082 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:04.215179 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:04.215770 [info ] [MainThread]: Updated version available: 1.3.2
[0m22:06:04.216333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '263eddb1-c7c2-4794-8e22-5f684b97f970', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527e7f7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527e86a750>]}
[0m22:06:04.216754 [info ] [MainThread]: 
[0m22:06:04.217220 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:04.226626 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7752152, "process_user_time": 1.538517, "process_kernel_time": 0.089971, "process_mem_max_rss": "101076", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m22:06:04.227339 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:04.227206 after 0.78 seconds
[0m22:06:04.227788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527f878740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527e72ce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527ee54080>]}
[0m22:06:04.228177 [debug] [MainThread]: Flushing usage events
[0m22:06:05.859221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c3440c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c33a5da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c33a5dac0>]}


============================== 22:06:05.862154 | b61856d0-a080-497d-a977-389ef0e40ab4 ==============================
[0m22:06:05.862154 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:05.862762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:06.070157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c338a04d0>]}
[0m22:06:06.124930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c33d01f70>]}
[0m22:06:06.126712 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:06.145588 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:06.146289 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:06.146761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c339b2240>]}
[0m22:06:07.348172 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:07.348698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c2c29fd70>]}
[0m22:06:07.568879 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:07.574014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c2c11a870>]}
[0m22:06:07.660991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c2c18ab70>]}
[0m22:06:07.661558 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:07.661995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c2c1563c0>]}
[0m22:06:07.663876 [info ] [MainThread]: 
[0m22:06:07.664541 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:07.668973 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:07.700548 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:07.701022 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:07.701382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:08.274377 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:08.276471 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:08.277509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:08.278174 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:08.285221 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:08.285629 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:08.285950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:08.287047 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:08.288346 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:08.288693 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:08.289768 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:08.290109 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:08.290439 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:08.291018 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:08.291895 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:08.292220 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:08.292546 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:08.293053 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:08.293402 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:08.294753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:08.300642 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:08.301014 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:08.301343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:08.302462 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:08.302799 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:08.303102 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:08.313156 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:08.314702 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:08.315924 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:08.316316 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:08.318064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c2c0dc860>]}
[0m22:06:08.318571 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:08.318908 [debug] [MainThread]: On master: BEGIN
[0m22:06:08.319212 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:08.319911 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:08.320310 [debug] [MainThread]: On master: COMMIT
[0m22:06:08.320644 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:08.320949 [debug] [MainThread]: On master: COMMIT
[0m22:06:08.321511 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:08.321857 [debug] [MainThread]: On master: Close
[0m22:06:08.322330 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:08.322758 [info ] [MainThread]: 
[0m22:06:08.340031 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:08.340650 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:08.341215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:08.341634 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:08.366231 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:08.367012 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:08.399096 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:08.399863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:19.017190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:19.017720 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:19.018401 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.018812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:19.019156 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:19.020106 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.021434 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:19.021831 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:19.022805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.029300 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:19.029720 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:19.030499 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.034699 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:19.035105 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:19.035882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.051219 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:19.051670 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:19.052029 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:19.054041 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.059410 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:19.059831 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:19.061096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.063392 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:19.064846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c0c983530>]}
[0m22:06:19.065511 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.72s]
[0m22:06:19.066196 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:19.067160 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:19.067688 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:19.068209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:19.068625 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:19.073556 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:19.074162 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:19.106930 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.107452 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251124220619101412"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:19.107863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:19.115119 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.122369 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.122823 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:19.123602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.123996 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.124365 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251124220619101412'
      
      
      order by ordinal_position

  
[0m22:06:19.126967 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.132078 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.132514 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:19.135065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.142388 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.142805 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:19.145616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.147243 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.147665 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:06:19.148363 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.163642 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:19.164326 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.164742 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251124220619101412"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251124220619101412"
    )
  
[0m22:06:19.226803 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.228655 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:19.229081 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.229454 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:19.235555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.236440 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:19.237101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c2795d280>]}
[0m22:06:19.237741 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:06:19.238362 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:19.239928 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:19.240350 [debug] [MainThread]: On master: BEGIN
[0m22:06:19.240698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:19.241447 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:19.241815 [debug] [MainThread]: On master: COMMIT
[0m22:06:19.242133 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:19.242508 [debug] [MainThread]: On master: COMMIT
[0m22:06:19.243064 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:19.243460 [debug] [MainThread]: On master: Close
[0m22:06:19.243886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:19.244202 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:19.244587 [info ] [MainThread]: 
[0m22:06:19.245030 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.58 seconds (11.58s).
[0m22:06:19.245953 [debug] [MainThread]: Command end result
[0m22:06:19.270906 [info ] [MainThread]: 
[0m22:06:19.271546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:19.271956 [info ] [MainThread]: 
[0m22:06:19.272526 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:19.273485 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.459174, "process_user_time": 4.834718, "process_kernel_time": 0.220123, "process_mem_max_rss": "347756", "process_in_blocks": "1200", "process_out_blocks": "107336"}
[0m22:06:19.274040 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:19.273955 after 13.46 seconds
[0m22:06:19.274452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c3440c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be6278500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c2c033500>]}
[0m22:06:19.274841 [debug] [MainThread]: Flushing usage events
[0m22:06:21.055902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553ac51b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553aedee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553b26d490>]}


============================== 22:06:21.058801 | a7e40c54-4cb2-42fa-8a76-b994bf58fc67 ==============================
[0m22:06:21.058801 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:21.059434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:21.161800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7e40c54-4cb2-42fa-8a76-b994bf58fc67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553a86c8f0>]}
[0m22:06:21.176600 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1657763, "process_user_time": 1.201764, "process_kernel_time": 0.075921, "process_mem_max_rss": "99848", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:21.177129 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:21.177038 after 0.17 seconds
[0m22:06:21.177558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553abb81a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553a9df770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553a84e330>]}
[0m22:06:21.177937 [debug] [MainThread]: Flushing usage events
[0m06:02:54.965180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03aeb21310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03aedf1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03aeac0c80>]}


============================== 06:02:54.976440 | 3f1ba568-b3a4-4ead-9c99-d460fb8a7716 ==============================
[0m06:02:54.976440 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:54.977119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:55.134851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f1ba568-b3a4-4ead-9c99-d460fb8a7716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03aedcc560>]}
[0m06:02:55.149746 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zkds8frr'
[0m06:02:55.150250 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:55.282576 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:55.284637 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:55.366768 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:55.371582 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:55.647468 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:55.648061 [info ] [MainThread]: Updated version available: 1.3.2
[0m06:02:55.648562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3f1ba568-b3a4-4ead-9c99-d460fb8a7716', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ae80b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ae6d3110>]}
[0m06:02:55.648978 [info ] [MainThread]: 
[0m06:02:55.649398 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:55.657038 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.73726165, "process_user_time": 1.506481, "process_kernel_time": 0.10675, "process_mem_max_rss": "101356", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m06:02:55.657751 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:55.657645 after 0.74 seconds
[0m06:02:55.658152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b2f63920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03aec2e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03af63f9e0>]}
[0m06:02:55.658575 [debug] [MainThread]: Flushing usage events
[0m06:02:57.299328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a6a31a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a5d29970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a5d29940>]}


============================== 06:02:57.302648 | da2096f6-6ed9-45d3-9ab5-a89777c0806f ==============================
[0m06:02:57.302648 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:57.303321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:57.513306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a5a3cce0>]}
[0m06:02:57.567199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a5b875c0>]}
[0m06:02:57.569096 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:02:57.593723 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:57.594440 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:57.594911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a5b85130>]}
[0m06:02:58.808304 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:58.808898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a5a9baa0>]}
[0m06:02:59.051072 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:59.056223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa19ddb3e30>]}
[0m06:02:59.143822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa19e46dbe0>]}
[0m06:02:59.144436 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:02:59.144860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa19dc6fd70>]}
[0m06:02:59.146869 [info ] [MainThread]: 
[0m06:02:59.147587 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:59.152095 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:59.183619 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:59.184026 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:59.184376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:59.887453 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:59.889181 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:59.890133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:59.890680 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:59.897977 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:59.898382 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:59.898706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:59.899754 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:59.901022 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:59.901392 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:59.902545 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:59.902889 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:59.903193 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:59.903784 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:59.904643 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:59.904999 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:59.905323 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:59.905837 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:59.906180 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:59.907404 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:59.913092 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:59.913475 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:59.913787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:59.914441 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:59.914780 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:59.915091 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:59.925348 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:59.926787 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:59.928024 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:59.928405 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:59.930131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa19c9da390>]}
[0m06:02:59.930643 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:59.930970 [debug] [MainThread]: On master: BEGIN
[0m06:02:59.931310 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:59.931947 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:59.932326 [debug] [MainThread]: On master: COMMIT
[0m06:02:59.932639 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:59.932937 [debug] [MainThread]: On master: COMMIT
[0m06:02:59.933456 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:59.933790 [debug] [MainThread]: On master: Close
[0m06:02:59.934243 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:59.934685 [info ] [MainThread]: 
[0m06:02:59.959100 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:59.959708 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:59.960268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:59.960677 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:59.985147 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:59.985869 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:03:00.018617 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:03:00.019585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:10.168463 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.169035 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:10.169864 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.170323 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.170698 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:10.171673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.173054 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.173492 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:10.175112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.183479 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.183902 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:10.184664 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.187720 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.188121 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:10.188823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.204158 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:10.204614 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.204968 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:10.206501 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.211964 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.212404 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:10.213945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.216344 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:10.217846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a7a76ab0>]}
[0m06:03:10.218559 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.26s]
[0m06:03:10.219299 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:10.220172 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:10.220726 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:10.221312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:10.221937 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:10.226834 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:10.227456 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:10.261412 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.262019 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251125060310255630"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:10.262453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:10.271586 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.279136 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.279598 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:10.280346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.280751 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.281106 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251125060310255630'
      
      
      order by ordinal_position

  
[0m06:03:10.283852 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.289004 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.289434 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:10.292350 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.299537 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.299955 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:10.302684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.304313 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.304718 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:10.305403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.322046 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:10.322794 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.323240 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251125060310255630"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251125060310255630"
    )
  
[0m06:03:10.391354 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.393455 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:10.393895 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.394268 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:10.401150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.402060 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:10.402769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa153fb9eb0>]}
[0m06:03:10.403491 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m06:03:10.404138 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:10.405580 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:10.405981 [debug] [MainThread]: On master: BEGIN
[0m06:03:10.406355 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:10.407062 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:10.407443 [debug] [MainThread]: On master: COMMIT
[0m06:03:10.407765 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:10.408075 [debug] [MainThread]: On master: COMMIT
[0m06:03:10.408638 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:10.408979 [debug] [MainThread]: On master: Close
[0m06:03:10.409459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:10.410016 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:10.410424 [info ] [MainThread]: 
[0m06:03:10.410837 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.26 seconds (11.26s).
[0m06:03:10.411662 [debug] [MainThread]: Command end result
[0m06:03:10.435957 [info ] [MainThread]: 
[0m06:03:10.436516 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:10.436937 [info ] [MainThread]: 
[0m06:03:10.437387 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:10.438338 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.184986, "process_user_time": 4.905322, "process_kernel_time": 0.272127, "process_mem_max_rss": "335772", "process_in_blocks": "1200", "process_out_blocks": "107304"}
[0m06:03:10.438852 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:10.438765 after 13.19 seconds
[0m06:03:10.439260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a5fd0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a6132450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa153f91280>]}
[0m06:03:10.439658 [debug] [MainThread]: Flushing usage events
[0m06:03:12.290721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63cb6d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63d41dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63d51fe90>]}


============================== 06:03:12.294020 | 6a981e79-6cc0-4281-8ac0-574f3648f81b ==============================
[0m06:03:12.294020 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:12.294712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:12.394833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a981e79-6cc0-4281-8ac0-574f3648f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63c8e97f0>]}
[0m06:03:12.409056 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16449061, "process_user_time": 1.223421, "process_kernel_time": 0.068967, "process_mem_max_rss": "99404", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:03:12.409577 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:12.409485 after 0.17 seconds
[0m06:03:12.409959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63ca015e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63cbaa480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6410d3920>]}
[0m06:03:12.410351 [debug] [MainThread]: Flushing usage events
[0m14:06:14.258532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ee3dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb98174c9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ee3dcd0>]}


============================== 14:06:14.286604 | c70d3c7c-c9ba-422c-818b-a9fe1b5c2ddc ==============================
[0m14:06:14.286604 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:14.287344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:14.458898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c70d3c7c-c9ba-422c-818b-a9fe1b5c2ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb980b1e270>]}
[0m14:06:14.475075 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ivqawizy'
[0m14:06:14.475589 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:14.593052 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:14.595124 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:14.687429 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:14.693199 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:14.878533 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:14.879245 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:06:14.879898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c70d3c7c-c9ba-422c-818b-a9fe1b5c2ddc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97eb966f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97eb96d20>]}
[0m14:06:14.880401 [info ] [MainThread]: 
[0m14:06:14.880997 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:14.911093 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.70448446, "process_user_time": 1.735288, "process_kernel_time": 0.150719, "process_mem_max_rss": "101016", "process_in_blocks": "8760", "process_out_blocks": "5168"}
[0m14:06:14.911889 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:14.911755 after 0.71 seconds
[0m14:06:14.912394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97f290200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97f4b2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97f4b10a0>]}
[0m14:06:14.912875 [debug] [MainThread]: Flushing usage events
[0m14:06:16.684045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0204020e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0204280ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0204a94440>]}


============================== 14:06:16.687340 | a9eba7bc-d97d-4363-9c37-ec4f9fcacb85 ==============================
[0m14:06:16.687340 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:16.687991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:16.922870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01fc9b8800>]}
[0m14:06:16.984623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0205d7d7c0>]}
[0m14:06:16.986489 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:06:17.019242 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:17.020007 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:17.020556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01fc994680>]}
[0m14:06:18.423036 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:18.423763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01fc850530>]}
[0m14:06:18.687770 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:18.693355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01fc0ad820>]}
[0m14:06:18.794756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01fc1741a0>]}
[0m14:06:18.795361 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:06:18.795961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01fc8c1c70>]}
[0m14:06:18.798087 [info ] [MainThread]: 
[0m14:06:18.798824 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:18.803902 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:18.843485 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:18.844044 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:18.844443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:19.195142 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:19.196910 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:19.197848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:19.198473 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:19.206881 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:19.207299 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:19.207706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:19.209278 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:19.210616 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:19.211045 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:19.211689 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:19.212079 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:19.212444 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:19.213169 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:19.214117 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:19.214508 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:19.214908 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:19.215603 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:19.216047 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:19.217363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:19.223702 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:19.224120 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:19.224477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:19.225229 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:19.225607 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:19.226004 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:19.237282 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:19.238885 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:19.240159 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:19.240553 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:19.242857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01eecf61b0>]}
[0m14:06:19.243418 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:19.243834 [debug] [MainThread]: On master: BEGIN
[0m14:06:19.244199 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:19.244949 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:19.245354 [debug] [MainThread]: On master: COMMIT
[0m14:06:19.245748 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:19.246106 [debug] [MainThread]: On master: COMMIT
[0m14:06:19.246703 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:19.247095 [debug] [MainThread]: On master: Close
[0m14:06:19.247589 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:19.248084 [info ] [MainThread]: 
[0m14:06:19.280077 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:19.280781 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:19.281525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:19.281996 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:19.309208 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:19.310043 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:19.345763 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:19.346682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:27.543466 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:27.544058 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:27.545039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.545476 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:27.545972 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:27.547035 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.548486 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:27.548952 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:27.550018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.558564 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:27.559114 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:27.560149 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.563459 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:27.563924 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:27.564787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.582114 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:27.582690 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:27.583124 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:27.585031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.591349 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:27.591865 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:27.593348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.595919 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:27.597515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01eff73740>]}
[0m14:06:27.598243 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.32s]
[0m14:06:27.599054 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:27.599909 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:27.600736 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:27.601377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:27.601866 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:27.607315 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:27.608060 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:27.645239 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:27.645838 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251125140627638999"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:27.646297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:27.654007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.662299 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:27.662819 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:27.663609 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.664063 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:27.664483 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251125140627638999'
      
      
      order by ordinal_position

  
[0m14:06:27.667233 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.673291 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:27.673805 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:27.676460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.684470 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:27.684970 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:27.688055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.689883 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:27.690326 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:06:27.691071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.710196 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:27.711048 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:27.711507 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251125140627638999"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251125140627638999"
    )
  
[0m14:06:27.769697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.771746 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:27.772216 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:27.772618 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:27.779582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.780635 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:27.781395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01af7e2780>]}
[0m14:06:27.782097 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m14:06:27.782941 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:27.784684 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:27.785100 [debug] [MainThread]: On master: BEGIN
[0m14:06:27.785470 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:27.786335 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:27.786767 [debug] [MainThread]: On master: COMMIT
[0m14:06:27.787143 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:27.787505 [debug] [MainThread]: On master: COMMIT
[0m14:06:27.788162 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:27.788562 [debug] [MainThread]: On master: Close
[0m14:06:27.789112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:27.789470 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:27.789906 [info ] [MainThread]: 
[0m14:06:27.790422 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.99 seconds (8.99s).
[0m14:06:27.791432 [debug] [MainThread]: Command end result
[0m14:06:27.818385 [info ] [MainThread]: 
[0m14:06:27.819114 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:27.819645 [info ] [MainThread]: 
[0m14:06:27.820262 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:27.821323 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.189932, "process_user_time": 5.336343, "process_kernel_time": 0.326326, "process_mem_max_rss": "335552", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m14:06:27.821891 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:27.821785 after 11.19 seconds
[0m14:06:27.822346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0204280ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02040225a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01af7aa450>]}
[0m14:06:27.822803 [debug] [MainThread]: Flushing usage events
[0m14:06:29.949179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6155f0740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6156c7980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6155f12b0>]}


============================== 14:06:29.952652 | cf1178d0-e318-4f51-b1cb-7efb89a24e8a ==============================
[0m14:06:29.952652 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:29.953384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:30.069890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf1178d0-e318-4f51-b1cb-7efb89a24e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6149b2ae0>]}
[0m14:06:30.088108 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19217546, "process_user_time": 1.3947, "process_kernel_time": 0.117805, "process_mem_max_rss": "99548", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:30.088699 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:30.088550 after 0.19 seconds
[0m14:06:30.089125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa619163920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa615626ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6151e8920>]}
[0m14:06:30.089533 [debug] [MainThread]: Flushing usage events
[0m22:07:03.232497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a3902720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a3ef2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a39023c0>]}


============================== 22:07:03.255699 | a68ab182-125c-46e5-89bb-aabf9af13d7b ==============================
[0m22:07:03.255699 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:03.256371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:07:03.397356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a68ab182-125c-46e5-89bb-aabf9af13d7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a581e720>]}
[0m22:07:03.412122 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x17ogl8x'
[0m22:07:03.412620 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:07:03.615990 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:07:03.617957 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:07:03.791940 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:07:03.797131 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:07:04.206158 [info ] [MainThread]: Installed from version 1.2.0
[0m22:07:04.206669 [info ] [MainThread]: Updated version available: 1.3.2
[0m22:07:04.207222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a68ab182-125c-46e5-89bb-aabf9af13d7b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a392bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a3929400>]}
[0m22:07:04.207645 [info ] [MainThread]: 
[0m22:07:04.208085 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:07:04.219388 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0330466, "process_user_time": 1.576242, "process_kernel_time": 0.10688, "process_mem_max_rss": "101388", "process_in_blocks": "8760", "process_out_blocks": "5168"}
[0m22:07:04.220190 [debug] [MainThread]: Command `dbt deps` succeeded at 22:07:04.220057 after 1.03 seconds
[0m22:07:04.220687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a3f4e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a4574860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a3b7ea20>]}
[0m22:07:04.221181 [debug] [MainThread]: Flushing usage events
[0m22:07:05.941687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac93f0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac930be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac93f05c0>]}


============================== 22:07:05.944769 | 39f4dc43-afdc-4e14-8350-bc9f600b9a4f ==============================
[0m22:07:05.944769 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:05.945452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:06.156435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac1397830>]}
[0m22:07:06.211562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac8807ce0>]}
[0m22:07:06.213322 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:07:06.252278 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:07:06.252985 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:07:06.253498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac13956d0>]}
[0m22:07:07.472218 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:07:07.472799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac0976000>]}
[0m22:07:07.716794 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:07:07.722129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac87e3230>]}
[0m22:07:07.814024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac09e56a0>]}
[0m22:07:07.814584 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:07:07.814986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac1180bc0>]}
[0m22:07:07.816966 [info ] [MainThread]: 
[0m22:07:07.817684 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:07:07.822400 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:07:07.859738 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:07:07.860264 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:07:07.860613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:08.270892 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:08.272422 [debug] [ThreadPool]: On list_petro: Close
[0m22:07:08.273277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:07:08.273806 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:07:08.280873 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:08.281357 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:07:08.281690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:08.282974 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:08.284423 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:08.284809 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:07:08.286575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:08.286943 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:08.287290 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:07:08.287972 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:08.288947 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:08.289317 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:08.289634 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:08.290280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:08.290644 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:07:08.291907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:07:08.297981 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:08.298448 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:07:08.298761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:08.299611 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:08.299995 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:08.300348 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:07:08.311220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:08.312945 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:07:08.314304 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:07:08.314714 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:07:08.316881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac1191880>]}
[0m22:07:08.317446 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:08.317823 [debug] [MainThread]: On master: BEGIN
[0m22:07:08.318202 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:08.319072 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:08.319457 [debug] [MainThread]: On master: COMMIT
[0m22:07:08.319775 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:08.320108 [debug] [MainThread]: On master: COMMIT
[0m22:07:08.320713 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:08.321096 [debug] [MainThread]: On master: Close
[0m22:07:08.321582 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:07:08.322026 [info ] [MainThread]: 
[0m22:07:08.341860 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:07:08.342558 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:07:08.343244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:07:08.343956 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:07:08.370257 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:07:08.371085 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:07:08.404771 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:07:08.405625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:20.853272 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:20.853817 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:20.854776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.855274 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:20.855649 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:20.856803 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.858261 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:20.858686 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:20.860344 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.868218 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:20.868649 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:20.869591 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.872752 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:20.873186 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:20.873974 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.889702 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:20.890236 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:20.890617 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:20.892754 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.898582 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:20.899087 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:20.900750 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.903252 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:20.904747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7a4d24b0>]}
[0m22:07:20.905474 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.56s]
[0m22:07:20.906295 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:20.907345 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:20.907879 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:20.908535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:20.908955 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:20.914105 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:20.914739 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:20.949024 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:20.949585 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251125220720943221"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:20.949991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:20.957897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.965718 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:20.966235 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:20.967107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.967537 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:20.967899 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251125220720943221'
      
      
      order by ordinal_position

  
[0m22:07:20.970844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.976338 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:20.976788 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:20.979649 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.987304 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:20.987779 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:20.990721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.992584 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:20.993035 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:07:20.993913 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:21.011683 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:21.012498 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:21.012941 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251125220720943221"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251125220720943221"
    )
  
[0m22:07:21.075818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:21.077745 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:21.078202 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:21.078560 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:21.084501 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:21.085429 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:21.086149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7b1f1b20>]}
[0m22:07:21.086801 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m22:07:21.087454 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:21.089463 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:21.089887 [debug] [MainThread]: On master: BEGIN
[0m22:07:21.090255 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:21.091144 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:21.091529 [debug] [MainThread]: On master: COMMIT
[0m22:07:21.091852 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:21.092210 [debug] [MainThread]: On master: COMMIT
[0m22:07:21.092834 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:21.093238 [debug] [MainThread]: On master: Close
[0m22:07:21.093702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:21.094036 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:21.094417 [info ] [MainThread]: 
[0m22:07:21.094821 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.28 seconds (13.28s).
[0m22:07:21.095670 [debug] [MainThread]: Command end result
[0m22:07:21.120112 [info ] [MainThread]: 
[0m22:07:21.120733 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:21.121148 [info ] [MainThread]: 
[0m22:07:21.121591 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:21.122519 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.227246, "process_user_time": 4.929253, "process_kernel_time": 0.248558, "process_mem_max_rss": "343156", "process_in_blocks": "1200", "process_out_blocks": "107344"}
[0m22:07:21.123089 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:21.122961 after 15.23 seconds
[0m22:07:21.123504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4accf63920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac9aab830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7a4e43e0>]}
[0m22:07:21.123895 [debug] [MainThread]: Flushing usage events
[0m22:07:23.174105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16f393680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16fab1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16eedeff0>]}


============================== 22:07:23.177366 | 7905e1b2-274f-4bf8-9d3d-952be16833ad ==============================
[0m22:07:23.177366 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:23.177955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:07:23.280847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7905e1b2-274f-4bf8-9d3d-952be16833ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16f7503e0>]}
[0m22:07:23.295181 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16876286, "process_user_time": 1.281126, "process_kernel_time": 0.077946, "process_mem_max_rss": "99556", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:23.295709 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:23.295620 after 0.17 seconds
[0m22:07:23.296121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16f7503e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16f7b0380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16f7b05c0>]}
[0m22:07:23.296514 [debug] [MainThread]: Flushing usage events
[0m20:58:47.526674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b88bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b88bd90>]}


============================== 20:58:47.529294 | e9067148-713e-437d-99fb-e6c4b8393197 ==============================
[0m20:58:47.529294 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:58:47.529565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:58:47.616506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9067148-713e-437d-99fb-e6c4b8393197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a695cd0>]}
[0m20:58:47.638531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9067148-713e-437d-99fb-e6c4b8393197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b46fdf0>]}
[0m20:58:47.639502 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:58:47.653605 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m20:58:47.883878 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.39220276, "process_user_time": 0.643356, "process_kernel_time": 0.114516, "process_mem_max_rss": "126353408", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:58:47.884561 [debug] [MainThread]: Command `dbt run` failed at 20:58:47.884443 after 0.39 seconds
[0m20:58:47.885004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b971350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b971450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b902990>]}
[0m20:58:47.885359 [debug] [MainThread]: Flushing usage events
[0m20:58:51.287613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba23ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba23d90>]}


============================== 20:58:51.289204 | 3c153747-6a5f-4048-927a-50a63323e9c7 ==============================
[0m20:58:51.289204 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:58:51.289455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:58:51.330078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c153747-6a5f-4048-927a-50a63323e9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a869f30>]}
[0m20:58:51.337136 [debug] [MainThread]: Set downloads directory='/var/folders/zf/mwchy5wd3lldxn9vw7f15ztw0000gn/T/dbt-downloads-p1ld57ej'
[0m20:58:51.337291 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:58:51.441470 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:58:51.442189 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:58:51.508230 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:58:51.511152 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:58:51.755916 [info ] [MainThread]: Installed from version 1.2.0
[0m20:58:51.756180 [info ] [MainThread]: Updated version available: 1.3.3
[0m20:58:51.756371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3c153747-6a5f-4048-927a-50a63323e9c7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bac5bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb4e360>]}
[0m20:58:51.756563 [info ] [MainThread]: 
[0m20:58:51.756718 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m20:58:51.758365 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49575457, "process_user_time": 0.511164, "process_kernel_time": 0.116872, "process_mem_max_rss": "115195904", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:58:51.758611 [debug] [MainThread]: Command `dbt deps` succeeded at 20:58:51.758556 after 0.50 seconds
[0m20:58:51.758763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbb4d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba8e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba8e120>]}
[0m20:58:51.758909 [debug] [MainThread]: Flushing usage events
[0m20:58:55.255930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107455940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fbd90>]}


============================== 20:58:55.257575 | a48657f9-5b58-4efa-8a6e-57f0a92bf35a ==============================
[0m20:58:55.257575 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:58:55.257808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:58:55.333044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a48657f9-5b58-4efa-8a6e-57f0a92bf35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10823dcd0>]}
[0m20:58:55.352840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a48657f9-5b58-4efa-8a6e-57f0a92bf35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fdbdf0>]}
[0m20:58:55.353553 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:58:55.362568 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:58:55.363074 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:58:55.363264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a48657f9-5b58-4efa-8a6e-57f0a92bf35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e1150>]}
[0m20:58:55.844316 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:58:55.844556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a48657f9-5b58-4efa-8a6e-57f0a92bf35a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f9c70>]}
[0m20:58:55.909980 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m20:58:55.911803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a48657f9-5b58-4efa-8a6e-57f0a92bf35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109606c10>]}
[0m20:58:55.944576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a48657f9-5b58-4efa-8a6e-57f0a92bf35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10974f520>]}
[0m20:58:55.944776 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m20:58:55.944907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a48657f9-5b58-4efa-8a6e-57f0a92bf35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b0d3d0>]}
[0m20:58:55.945791 [info ] [MainThread]: 
[0m20:58:55.946007 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:58:55.947620 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m20:58:55.972509 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m20:58:55.972683 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m20:58:55.972797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:55.974809 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m20:58:55.974933 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m20:58:55.975222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:55.975352 [debug] [MainThread]: Connection 'list_petro' was properly closed.
[0m20:58:55.975460 [info ] [MainThread]: 
[0m20:58:55.975597 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m20:58:55.975770 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: The file "/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/petro.duckdb" exists, but it is not a valid DuckDB database file!
[0m20:58:55.976774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7441672, "process_user_time": 1.107867, "process_kernel_time": 0.11116, "process_mem_max_rss": "140951552", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:58:55.976925 [debug] [MainThread]: Command `dbt run` failed at 20:58:55.976892 after 0.74 seconds
[0m20:58:55.977043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c4c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d02cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d02d50>]}
[0m20:58:55.977160 [debug] [MainThread]: Flushing usage events
[0m20:59:14.258400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078cd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109853ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109853d90>]}


============================== 20:59:14.259955 | 9db65d02-21a0-4fd1-ab39-8a39e7aa3557 ==============================
[0m20:59:14.259955 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:59:14.260216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:59:14.334648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9db65d02-21a0-4fd1-ab39-8a39e7aa3557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10865dcd0>]}
[0m20:59:14.354351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9db65d02-21a0-4fd1-ab39-8a39e7aa3557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109433df0>]}
[0m20:59:14.355086 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:59:14.363079 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:59:14.405110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:59:14.405275 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:59:14.407548 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m20:59:14.419012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9db65d02-21a0-4fd1-ab39-8a39e7aa3557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109939850>]}
[0m20:59:14.450546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9db65d02-21a0-4fd1-ab39-8a39e7aa3557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c65d0>]}
[0m20:59:14.450734 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m20:59:14.450863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9db65d02-21a0-4fd1-ab39-8a39e7aa3557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d44050>]}
[0m20:59:14.451590 [info ] [MainThread]: 
[0m20:59:14.451813 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:59:14.453759 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m20:59:14.475013 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m20:59:14.475189 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m20:59:14.475302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:14.971172 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:14.971857 [debug] [ThreadPool]: On list_petro: Close
[0m20:59:14.972151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m20:59:14.972326 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m20:59:14.974872 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m20:59:14.974991 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m20:59:14.975087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:14.975377 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:14.975866 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m20:59:14.975973 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m20:59:14.976122 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:14.976214 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m20:59:14.976310 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m20:59:14.976484 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:14.976754 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m20:59:14.976848 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m20:59:14.976932 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m20:59:14.977100 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:14.977238 [debug] [ThreadPool]: On create_petro_main: Close
[0m20:59:14.977683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m20:59:14.979894 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m20:59:14.980023 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m20:59:14.980118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:14.980298 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:14.980386 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m20:59:14.980478 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m20:59:14.984148 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:14.984520 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m20:59:14.984974 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m20:59:14.985069 [debug] [ThreadPool]: On list_petro_main: Close
[0m20:59:14.985287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9db65d02-21a0-4fd1-ab39-8a39e7aa3557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f45570>]}
[0m20:59:14.985481 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:14.985595 [debug] [MainThread]: On master: BEGIN
[0m20:59:14.985691 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:59:14.985865 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:59:14.985962 [debug] [MainThread]: On master: COMMIT
[0m20:59:14.986048 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:14.986131 [debug] [MainThread]: On master: COMMIT
[0m20:59:14.986268 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:59:14.986363 [debug] [MainThread]: On master: Close
[0m20:59:14.986507 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:59:14.986635 [info ] [MainThread]: 
[0m20:59:14.987770 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m20:59:14.987937 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m20:59:14.988089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m20:59:14.988196 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m20:59:14.999191 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m20:59:15.001290 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m20:59:15.016137 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m20:59:15.016850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:17.383297 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:17.383503 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m20:59:17.383740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:17.383881 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:17.384024 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m20:59:17.384298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:17.390160 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m20:59:17.390317 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:17.390451 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m20:59:17.390725 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:17.393112 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:17.393266 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m20:59:17.393482 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:17.394533 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m20:59:17.395270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db65d02-21a0-4fd1-ab39-8a39e7aa3557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111891190>]}
[0m20:59:17.395774 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 2.41s]
[0m20:59:17.396253 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m20:59:17.396678 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m20:59:17.396962 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m20:59:17.397208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m20:59:17.397362 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m20:59:17.404097 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m20:59:17.404653 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m20:59:17.419211 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m20:59:17.420496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:17.420628 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m20:59:17.420753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:17.421024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:17.421131 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:17.421255 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

  
    
    

    create  table
      "petro"."main"."petro"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m20:59:17.424280 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:17.424928 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m20:59:17.425062 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:17.425173 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m20:59:17.426019 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:17.426300 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m20:59:17.426503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db65d02-21a0-4fd1-ab39-8a39e7aa3557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d39de0>]}
[0m20:59:17.426727 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.03s]
[0m20:59:17.426943 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m20:59:17.427458 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:17.427573 [debug] [MainThread]: On master: BEGIN
[0m20:59:17.427672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:59:17.427835 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:59:17.427937 [debug] [MainThread]: On master: COMMIT
[0m20:59:17.428038 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:17.428130 [debug] [MainThread]: On master: COMMIT
[0m20:59:17.428272 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:59:17.428371 [debug] [MainThread]: On master: Close
[0m20:59:17.428503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:59:17.428600 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m20:59:17.428709 [info ] [MainThread]: 
[0m20:59:17.428830 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m20:59:17.429107 [debug] [MainThread]: Command end result
[0m20:59:17.441575 [info ] [MainThread]: 
[0m20:59:17.441773 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:59:17.441879 [info ] [MainThread]: 
[0m20:59:17.441988 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:59:17.443618 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2081199, "process_user_time": 1.321079, "process_kernel_time": 0.21114, "process_mem_max_rss": "299188224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:59:17.443779 [debug] [MainThread]: Command `dbt run` succeeded at 20:59:17.443747 after 3.21 seconds
[0m20:59:17.443909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f9ee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111872cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b3c6d0>]}
[0m20:59:17.444030 [debug] [MainThread]: Flushing usage events
[0m20:59:21.304440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107205940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ebed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ebd90>]}


============================== 20:59:21.306255 | c5590b3d-aa2d-4703-a26d-23e1e6c2457c ==============================
[0m20:59:21.306255 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:59:21.306496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -f', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:59:21.387511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5590b3d-aa2d-4703-a26d-23e1e6c2457c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff1cd0>]}
[0m20:59:21.408416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5590b3d-aa2d-4703-a26d-23e1e6c2457c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dcbdf0>]}
[0m20:59:21.409145 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:59:21.418600 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:59:21.461378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:59:21.461567 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:59:21.463820 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m20:59:21.474947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5590b3d-aa2d-4703-a26d-23e1e6c2457c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092cd850>]}
[0m20:59:21.506949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5590b3d-aa2d-4703-a26d-23e1e6c2457c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10925e5d0>]}
[0m20:59:21.507168 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m20:59:21.507301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5590b3d-aa2d-4703-a26d-23e1e6c2457c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e0050>]}
[0m20:59:21.508015 [info ] [MainThread]: 
[0m20:59:21.508237 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:59:21.510096 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m20:59:21.531505 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m20:59:21.531696 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m20:59:21.531811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:21.536604 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:21.537139 [debug] [ThreadPool]: On list_petro: Close
[0m20:59:21.537400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m20:59:21.537563 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m20:59:21.539955 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m20:59:21.540062 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m20:59:21.540152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:21.540396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:21.540814 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m20:59:21.540904 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m20:59:21.541042 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:21.541129 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m20:59:21.541212 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m20:59:21.541358 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:21.541629 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m20:59:21.541718 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m20:59:21.541803 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m20:59:21.541972 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:21.542114 [debug] [ThreadPool]: On create_petro_main: Close
[0m20:59:21.542552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m20:59:21.544713 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m20:59:21.544829 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m20:59:21.544916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:21.545087 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:21.545176 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m20:59:21.545265 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m20:59:21.548939 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:21.549397 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m20:59:21.549840 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m20:59:21.549941 [debug] [ThreadPool]: On list_petro_main: Close
[0m20:59:21.550254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5590b3d-aa2d-4703-a26d-23e1e6c2457c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d9570>]}
[0m20:59:21.550400 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:21.550489 [debug] [MainThread]: On master: BEGIN
[0m20:59:21.550574 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:59:21.550729 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:59:21.550820 [debug] [MainThread]: On master: COMMIT
[0m20:59:21.550903 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:21.550982 [debug] [MainThread]: On master: COMMIT
[0m20:59:21.551118 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:59:21.551208 [debug] [MainThread]: On master: Close
[0m20:59:21.551334 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:59:21.551445 [info ] [MainThread]: 
[0m20:59:21.552236 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m20:59:21.552403 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m20:59:21.552553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m20:59:21.552660 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m20:59:21.563310 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m20:59:21.563718 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m20:59:21.575978 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m20:59:21.576299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:23.617358 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:23.617643 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m20:59:23.617955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.618143 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:23.618324 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m20:59:23.618742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.619425 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:23.619602 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m20:59:23.620090 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.623687 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:23.623897 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m20:59:23.624208 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.625469 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:23.625627 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m20:59:23.625870 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.633655 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m20:59:23.633826 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:23.633977 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m20:59:23.634291 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.636765 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:23.636960 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m20:59:23.637303 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.638358 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m20:59:23.639026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5590b3d-aa2d-4703-a26d-23e1e6c2457c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11127d3d0>]}
[0m20:59:23.639298 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 2.09s]
[0m20:59:23.639562 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m20:59:23.639910 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m20:59:23.640145 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m20:59:23.640339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m20:59:23.640499 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m20:59:23.647502 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m20:59:23.648152 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m20:59:23.662647 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m20:59:23.663074 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.663214 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m20:59:23.663337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:23.663597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.663716 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.663851 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

  
    
    

    create  table
      "petro"."main"."petro__dbt_tmp"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m20:59:23.667006 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.667511 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.667659 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro'
  
[0m20:59:23.667964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.668424 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.668549 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro'
  
[0m20:59:23.668819 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.669904 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.670027 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
alter table "petro"."main"."petro" rename to "petro__dbt_backup"
[0m20:59:23.670223 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.671313 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.671435 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
alter table "petro"."main"."petro__dbt_tmp" rename to "petro"
[0m20:59:23.671613 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.672204 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m20:59:23.672322 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.672431 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m20:59:23.673301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.673476 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.673597 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m20:59:23.673755 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.673867 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.673984 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro__dbt_backup'
  
[0m20:59:23.674218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.674648 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.674764 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro__dbt_backup'
  
[0m20:59:23.674997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.675987 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.676103 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      drop table if exists "petro"."main"."petro__dbt_backup" cascade
    
[0m20:59:23.676281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.676713 [debug] [Thread-1 (]: On model.petro.petro: ROLLBACK
[0m20:59:23.676999 [debug] [Thread-1 (]: Failed to rollback 'model.petro.petro'
[0m20:59:23.677113 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m20:59:23.677307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5590b3d-aa2d-4703-a26d-23e1e6c2457c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d60a0>]}
[0m20:59:23.677523 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.04s]
[0m20:59:23.677733 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m20:59:23.678222 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:23.678336 [debug] [MainThread]: On master: BEGIN
[0m20:59:23.678438 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:59:23.678597 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:59:23.678703 [debug] [MainThread]: On master: COMMIT
[0m20:59:23.678803 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:23.678897 [debug] [MainThread]: On master: COMMIT
[0m20:59:23.679034 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:59:23.679131 [debug] [MainThread]: On master: Close
[0m20:59:23.679258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:59:23.679353 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m20:59:23.679458 [info ] [MainThread]: 
[0m20:59:23.679579 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 2.17 seconds (2.17s).
[0m20:59:23.679859 [debug] [MainThread]: Command end result
[0m20:59:23.692508 [info ] [MainThread]: 
[0m20:59:23.692726 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:59:23.692850 [info ] [MainThread]: 
[0m20:59:23.693026 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:59:23.694853 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4161623, "process_user_time": 1.18842, "process_kernel_time": 0.160725, "process_mem_max_rss": "222642176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:59:23.695036 [debug] [MainThread]: Command `dbt run` succeeded at 20:59:23.695000 after 2.42 seconds
[0m20:59:23.695173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111335c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11125b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093b6ad0>]}
[0m20:59:23.695301 [debug] [MainThread]: Flushing usage events
[0m21:01:56.126162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107109940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090afed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090afd90>]}


============================== 21:01:56.127719 | 4672562a-1f9d-498d-9dd5-39e342344571 ==============================
[0m21:01:56.127719 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:01:56.127965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -f', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:01:56.203699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4672562a-1f9d-498d-9dd5-39e342344571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef5cd0>]}
[0m21:01:56.230460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4672562a-1f9d-498d-9dd5-39e342344571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c8fdf0>]}
[0m21:01:56.231521 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:01:56.246961 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:01:56.295327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:01:56.295684 [debug] [MainThread]: Partial parsing: updated file: petro://models/staging/stg_petro.py
[0m21:01:56.393981 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:01:56.395904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4672562a-1f9d-498d-9dd5-39e342344571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109385450>]}
[0m21:01:56.428416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4672562a-1f9d-498d-9dd5-39e342344571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911a5d0>]}
[0m21:01:56.428622 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m21:01:56.428751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4672562a-1f9d-498d-9dd5-39e342344571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10971d2b0>]}
[0m21:01:56.429815 [info ] [MainThread]: 
[0m21:01:56.430077 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:01:56.431760 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:01:56.454959 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:01:56.455142 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m21:01:56.455265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:56.460186 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:01:56.460689 [debug] [ThreadPool]: On list_petro: Close
[0m21:01:56.460940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:01:56.461094 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:01:56.463466 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:01:56.463576 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m21:01:56.463671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:56.463927 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:01:56.464359 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:01:56.464455 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:01:56.464592 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:01:56.464678 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:01:56.464763 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:01:56.464912 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:01:56.465184 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:01:56.465277 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:01:56.465362 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:01:56.465485 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:01:56.465582 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:01:56.466010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:01:56.468142 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:01:56.468258 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:01:56.468350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:56.468521 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:01:56.468614 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:01:56.468703 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m21:01:56.472390 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:01:56.472816 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:01:56.473245 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:01:56.473344 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:01:56.473706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4672562a-1f9d-498d-9dd5-39e342344571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a68a10>]}
[0m21:01:56.473871 [debug] [MainThread]: Using duckdb connection "master"
[0m21:01:56.473968 [debug] [MainThread]: On master: BEGIN
[0m21:01:56.474059 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:01:56.474232 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:01:56.474325 [debug] [MainThread]: On master: COMMIT
[0m21:01:56.474408 [debug] [MainThread]: Using duckdb connection "master"
[0m21:01:56.474488 [debug] [MainThread]: On master: COMMIT
[0m21:01:56.474624 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:01:56.474718 [debug] [MainThread]: On master: Close
[0m21:01:56.474855 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:01:56.475031 [info ] [MainThread]: 
[0m21:01:56.475824 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:01:56.475997 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m21:01:56.476153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m21:01:56.476270 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:01:56.485855 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:01:56.486261 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:01:56.498259 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:01:56.498596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:58.739571 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:01:58.739861 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:01:58.740142 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.740314 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:01:58.740476 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:01:58.740857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.741534 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:01:58.741705 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:01:58.742113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.745773 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:01:58.745983 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:01:58.746268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.747643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:01:58.747803 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:01:58.748093 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.755988 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:01:58.756178 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:01:58.756331 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:01:58.756705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.759019 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:01:58.759178 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m21:01:58.759513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.760644 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:01:58.761341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4672562a-1f9d-498d-9dd5-39e342344571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f6b10>]}
[0m21:01:58.761636 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 2.28s]
[0m21:01:58.761900 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:01:58.762293 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m21:01:58.762503 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m21:01:58.762685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m21:01:58.762834 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m21:01:58.769429 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m21:01:58.769798 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m21:01:58.784930 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.785104 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      drop table if exists "petro"."main"."petro__dbt_backup" cascade
    
[0m21:01:58.785234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:58.785683 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.786317 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m21:01:58.786633 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.786758 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:01:58.786957 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.787069 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.787200 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

  
    
    

    create  table
      "petro"."main"."petro__dbt_tmp"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m21:01:58.790295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.790692 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.790813 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro'
  
[0m21:01:58.791104 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.791607 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.791735 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro'
  
[0m21:01:58.792034 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.793260 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.793380 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
alter table "petro"."main"."petro" rename to "petro__dbt_backup"
[0m21:01:58.793579 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.794472 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.794590 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
alter table "petro"."main"."petro__dbt_tmp" rename to "petro"
[0m21:01:58.794776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.795377 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:01:58.795494 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.795603 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:01:58.796456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.796628 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.796743 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:01:58.796900 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.797007 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.797118 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro__dbt_backup'
  
[0m21:01:58.797356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.797791 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.797908 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro__dbt_backup'
  
[0m21:01:58.798197 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.799401 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.799543 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      drop table if exists "petro"."main"."petro__dbt_backup" cascade
    
[0m21:01:58.799768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.800467 [debug] [Thread-1 (]: On model.petro.petro: ROLLBACK
[0m21:01:58.800786 [debug] [Thread-1 (]: Failed to rollback 'model.petro.petro'
[0m21:01:58.800908 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m21:01:58.801112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4672562a-1f9d-498d-9dd5-39e342344571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109717070>]}
[0m21:01:58.801340 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.04s]
[0m21:01:58.801561 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m21:01:58.802186 [debug] [MainThread]: Using duckdb connection "master"
[0m21:01:58.802307 [debug] [MainThread]: On master: BEGIN
[0m21:01:58.802408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:01:58.802580 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:01:58.802683 [debug] [MainThread]: On master: COMMIT
[0m21:01:58.802783 [debug] [MainThread]: Using duckdb connection "master"
[0m21:01:58.802881 [debug] [MainThread]: On master: COMMIT
[0m21:01:58.803018 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:01:58.803116 [debug] [MainThread]: On master: Close
[0m21:01:58.803250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:58.803349 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m21:01:58.803468 [info ] [MainThread]: 
[0m21:01:58.803595 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m21:01:58.803880 [debug] [MainThread]: Command end result
[0m21:01:58.814762 [info ] [MainThread]: 
[0m21:01:58.814949 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:01:58.815073 [info ] [MainThread]: 
[0m21:01:58.815195 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:01:58.816992 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7146597, "process_user_time": 1.321709, "process_kernel_time": 0.190001, "process_mem_max_rss": "225476608", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:01:58.817194 [debug] [MainThread]: Command `dbt run` succeeded at 21:01:58.817155 after 2.72 seconds
[0m21:01:58.817354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112b2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111295e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074bfd50>]}
[0m21:01:58.817492 [debug] [MainThread]: Flushing usage events
[0m21:02:21.348024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b23d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d223ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d223d90>]}


============================== 21:02:21.349632 | 3c92545d-b4ae-4e2c-8c9e-29e72e65acff ==============================
[0m21:02:21.349632 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:02:21.349880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_petro --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:02:21.424351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c92545d-b4ae-4e2c-8c9e-29e72e65acff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c029cd0>]}
[0m21:02:21.444260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c92545d-b4ae-4e2c-8c9e-29e72e65acff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce03df0>]}
[0m21:02:21.445098 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:02:21.452998 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:02:21.495839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:02:21.496040 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:02:21.498303 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:02:21.509820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c92545d-b4ae-4e2c-8c9e-29e72e65acff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d305850>]}
[0m21:02:21.541564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c92545d-b4ae-4e2c-8c9e-29e72e65acff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d28e5d0>]}
[0m21:02:21.541793 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m21:02:21.541925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c92545d-b4ae-4e2c-8c9e-29e72e65acff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d714050>]}
[0m21:02:21.542820 [info ] [MainThread]: 
[0m21:02:21.543092 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:02:21.543427 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:02:21.567900 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:02:21.568105 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m21:02:21.568237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:21.573056 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:02:21.573562 [debug] [ThreadPool]: On list_petro: Close
[0m21:02:21.573805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:02:21.573955 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:02:21.576296 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:02:21.576407 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m21:02:21.576533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:21.576881 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:02:21.577354 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:02:21.577462 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:02:21.577611 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:02:21.577706 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:02:21.577792 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:02:21.577941 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:02:21.578243 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:02:21.578339 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:02:21.578423 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:02:21.578550 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:02:21.578643 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:02:21.580347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:02:21.582454 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:02:21.582586 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:02:21.582678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:21.582855 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:02:21.582946 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:02:21.583034 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m21:02:21.586703 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:02:21.587221 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:02:21.587680 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:02:21.587793 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:02:21.588177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c92545d-b4ae-4e2c-8c9e-29e72e65acff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d915640>]}
[0m21:02:21.588320 [debug] [MainThread]: Using duckdb connection "master"
[0m21:02:21.588413 [debug] [MainThread]: On master: BEGIN
[0m21:02:21.588499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:02:21.588660 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:02:21.588751 [debug] [MainThread]: On master: COMMIT
[0m21:02:21.588835 [debug] [MainThread]: Using duckdb connection "master"
[0m21:02:21.588917 [debug] [MainThread]: On master: COMMIT
[0m21:02:21.589091 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:02:21.589225 [debug] [MainThread]: On master: Close
[0m21:02:21.589385 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:02:21.589514 [info ] [MainThread]: 
[0m21:02:21.590294 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:02:21.590480 [info ] [Thread-1 (]: 1 of 1 START python table model main.stg_petro ................................. [RUN]
[0m21:02:21.590646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m21:02:21.590758 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:02:21.601477 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:02:21.601896 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:02:21.613951 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:02:21.614322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:02:23.702676 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:02:23.702989 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:02:23.703276 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:02:23.703452 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:02:23.703619 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:02:23.704015 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:02:23.704713 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:02:23.704893 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:02:23.705326 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:02:23.709035 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:02:23.709223 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:02:23.709515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:02:23.710721 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:02:23.710880 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:02:23.711120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:02:23.718644 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:02:23.718807 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:02:23.718948 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:02:23.719283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:02:23.721812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:02:23.721980 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m21:02:23.722322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:02:23.723793 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:02:23.724554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c92545d-b4ae-4e2c-8c9e-29e72e65acff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152b1550>]}
[0m21:02:23.724868 [info ] [Thread-1 (]: 1 of 1 OK created python table model main.stg_petro ............................ [[32mOK[0m in 2.13s]
[0m21:02:23.725142 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:02:23.725813 [debug] [MainThread]: Using duckdb connection "master"
[0m21:02:23.725946 [debug] [MainThread]: On master: BEGIN
[0m21:02:23.726065 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:02:23.726253 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:02:23.726366 [debug] [MainThread]: On master: COMMIT
[0m21:02:23.726475 [debug] [MainThread]: Using duckdb connection "master"
[0m21:02:23.726583 [debug] [MainThread]: On master: COMMIT
[0m21:02:23.726741 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:02:23.726853 [debug] [MainThread]: On master: Close
[0m21:02:23.727006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:23.727118 [debug] [MainThread]: Connection 'model.petro.stg_petro' was properly closed.
[0m21:02:23.727243 [info ] [MainThread]: 
[0m21:02:23.727384 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m21:02:23.727653 [debug] [MainThread]: Command end result
[0m21:02:23.745767 [info ] [MainThread]: 
[0m21:02:23.745998 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:02:23.746125 [info ] [MainThread]: 
[0m21:02:23.746256 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:02:23.748109 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4233997, "process_user_time": 1.164454, "process_kernel_time": 0.176204, "process_mem_max_rss": "220119040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:02:23.748300 [debug] [MainThread]: Command `dbt run` succeeded at 21:02:23.748263 after 2.42 seconds
[0m21:02:23.748467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4c7d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d388870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7cecb0>]}
[0m21:02:23.748604 [debug] [MainThread]: Flushing usage events
[0m21:03:22.268504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afa1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf47ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf47d90>]}


============================== 21:03:22.270082 | b975bb03-8683-484b-94d1-fe48d389b1df ==============================
[0m21:03:22.270082 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:03:22.270325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_petro --full-refresh', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:03:22.346163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b975bb03-8683-484b-94d1-fe48d389b1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd8dcd0>]}
[0m21:03:22.365998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b975bb03-8683-484b-94d1-fe48d389b1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb27df0>]}
[0m21:03:22.366795 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:03:22.375586 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:03:22.420207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:03:22.420464 [debug] [MainThread]: Partial parsing: updated file: petro://models/staging/stg_petro.py
[0m21:03:22.518125 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:03:22.520010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b975bb03-8683-484b-94d1-fe48d389b1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d219450>]}
[0m21:03:22.551222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b975bb03-8683-484b-94d1-fe48d389b1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfb25d0>]}
[0m21:03:22.551436 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m21:03:22.551572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b975bb03-8683-484b-94d1-fe48d389b1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5b5390>]}
[0m21:03:22.552390 [info ] [MainThread]: 
[0m21:03:22.552613 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:03:22.552965 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:03:22.575726 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:03:22.575887 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m21:03:22.575993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:22.580878 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:22.581443 [debug] [ThreadPool]: On list_petro: Close
[0m21:03:22.581733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:03:22.581912 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:03:22.584294 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:22.584403 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m21:03:22.584496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:22.584769 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:22.585187 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:22.585281 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:03:22.585417 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:22.585503 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:22.585586 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:03:22.585730 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:22.586003 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:03:22.586097 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:22.586184 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:03:22.586315 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:22.586409 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:03:22.588169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:03:22.590174 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:03:22.590272 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:03:22.590353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:22.590500 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:22.590592 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:03:22.590682 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m21:03:22.594272 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:22.594825 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:03:22.595302 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:03:22.595409 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:03:22.595770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b975bb03-8683-484b-94d1-fe48d389b1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d90c940>]}
[0m21:03:22.595926 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:22.596022 [debug] [MainThread]: On master: BEGIN
[0m21:03:22.596112 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:03:22.596285 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:22.596377 [debug] [MainThread]: On master: COMMIT
[0m21:03:22.596460 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:22.596543 [debug] [MainThread]: On master: COMMIT
[0m21:03:22.596713 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:22.596839 [debug] [MainThread]: On master: Close
[0m21:03:22.596986 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:03:22.597117 [info ] [MainThread]: 
[0m21:03:22.597889 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:03:22.598059 [info ] [Thread-1 (]: 1 of 1 START python table model main.stg_petro ................................. [RUN]
[0m21:03:22.598219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m21:03:22.598330 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:03:22.607971 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:03:22.608407 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:03:22.620114 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:03:22.620453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:36.066727 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:36.067329 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:03:36.067593 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:36.067702 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:36.067811 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:03:36.068108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:36.068538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:36.068650 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:03:36.068921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:36.071069 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:36.071186 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:03:36.071401 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:36.072251 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:36.072369 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:03:36.072532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:36.078120 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:03:36.078276 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:36.078402 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:03:36.078859 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:36.080727 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:36.080861 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m21:03:36.081132 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:36.082065 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:03:36.082594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b975bb03-8683-484b-94d1-fe48d389b1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115142090>]}
[0m21:03:36.082820 [info ] [Thread-1 (]: 1 of 1 OK created python table model main.stg_petro ............................ [[32mOK[0m in 13.48s]
[0m21:03:36.083062 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:03:36.083618 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:36.083773 [debug] [MainThread]: On master: BEGIN
[0m21:03:36.083880 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:03:36.084065 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:36.084177 [debug] [MainThread]: On master: COMMIT
[0m21:03:36.084280 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:36.084372 [debug] [MainThread]: On master: COMMIT
[0m21:03:36.084508 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:36.084610 [debug] [MainThread]: On master: Close
[0m21:03:36.084749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:36.084844 [debug] [MainThread]: Connection 'model.petro.stg_petro' was properly closed.
[0m21:03:36.084944 [info ] [MainThread]: 
[0m21:03:36.085064 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.53 seconds (13.53s).
[0m21:03:36.085310 [debug] [MainThread]: Command end result
[0m21:03:36.101079 [info ] [MainThread]: 
[0m21:03:36.101300 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:03:36.101420 [info ] [MainThread]: 
[0m21:03:36.101540 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:03:36.103303 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.857885, "process_user_time": 13.003882, "process_kernel_time": 0.706921, "process_mem_max_rss": "2216361984", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:03:36.103485 [debug] [MainThread]: Command `dbt run` succeeded at 21:03:36.103449 after 13.86 seconds
[0m21:03:36.103625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d28cf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8cf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8cf890>]}
[0m21:03:36.103758 [debug] [MainThread]: Flushing usage events
[0m21:03:42.480686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb35940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dad7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dad7d90>]}


============================== 21:03:42.482396 | e06e38fe-0fff-4069-9ed4-0c8e2dec610d ==============================
[0m21:03:42.482396 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:03:42.482644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -f', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:03:42.560068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e06e38fe-0fff-4069-9ed4-0c8e2dec610d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c921cd0>]}
[0m21:03:42.580332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e06e38fe-0fff-4069-9ed4-0c8e2dec610d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6bbdf0>]}
[0m21:03:42.581071 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:03:42.590630 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:03:42.637237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:03:42.637462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:03:42.640126 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:03:42.652583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e06e38fe-0fff-4069-9ed4-0c8e2dec610d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbbd850>]}
[0m21:03:42.686440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e06e38fe-0fff-4069-9ed4-0c8e2dec610d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db465d0>]}
[0m21:03:42.686650 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m21:03:42.686785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e06e38fe-0fff-4069-9ed4-0c8e2dec610d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfd4050>]}
[0m21:03:42.687482 [info ] [MainThread]: 
[0m21:03:42.687713 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:03:42.689701 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:03:42.712182 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:03:42.712366 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m21:03:42.712483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:42.717455 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:42.717980 [debug] [ThreadPool]: On list_petro: Close
[0m21:03:42.718253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:03:42.718442 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:03:42.720773 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:42.720891 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m21:03:42.720989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:42.721255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:42.721686 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:42.721781 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:03:42.721944 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:42.722039 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:42.722135 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:03:42.722299 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:42.722575 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:03:42.722667 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:42.722748 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:03:42.722875 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:42.722967 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:03:42.723336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:03:42.725531 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:03:42.725672 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:03:42.725773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:42.725959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:42.726056 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:03:42.726149 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m21:03:42.730186 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:42.730779 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:03:42.731286 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:03:42.731409 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:03:42.731871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e06e38fe-0fff-4069-9ed4-0c8e2dec610d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1cd570>]}
[0m21:03:42.732049 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:42.732150 [debug] [MainThread]: On master: BEGIN
[0m21:03:42.732255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:03:42.732446 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:42.732553 [debug] [MainThread]: On master: COMMIT
[0m21:03:42.732648 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:42.732741 [debug] [MainThread]: On master: COMMIT
[0m21:03:42.732897 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:42.732987 [debug] [MainThread]: On master: Close
[0m21:03:42.733136 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:03:42.733258 [info ] [MainThread]: 
[0m21:03:42.734173 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:03:42.734369 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m21:03:42.734526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m21:03:42.734637 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:03:42.745557 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:03:42.745986 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:03:42.758460 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:03:42.758848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:56.032707 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:56.033707 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:03:56.033986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.034099 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:56.034206 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:03:56.034507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.034941 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:56.035052 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:03:56.035318 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.037567 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:56.037682 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:03:56.037883 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.038734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:56.038852 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:03:56.039031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.044561 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:03:56.044678 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:56.044780 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:03:56.045234 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.047276 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:56.047417 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m21:03:56.047788 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.048775 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:03:56.049321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e06e38fe-0fff-4069-9ed4-0c8e2dec610d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b18dd0>]}
[0m21:03:56.049670 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 13.31s]
[0m21:03:56.049906 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:03:56.050257 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m21:03:56.050463 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m21:03:56.050632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m21:03:56.050762 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m21:03:56.056411 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m21:03:56.056716 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m21:03:56.070615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.070773 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      drop table if exists "petro"."main"."petro__dbt_backup" cascade
    
[0m21:03:56.070891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:56.071277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.071843 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m21:03:56.072121 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.072225 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:03:56.072406 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.072509 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.072632 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

  
    
    

    create  table
      "petro"."main"."petro__dbt_tmp"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m21:03:56.347408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.348034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.348204 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro'
  
[0m21:03:56.348626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.349125 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.349258 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro'
  
[0m21:03:56.349546 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.350842 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.350962 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
alter table "petro"."main"."petro" rename to "petro__dbt_backup"
[0m21:03:56.351170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.352079 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.352204 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
alter table "petro"."main"."petro__dbt_tmp" rename to "petro"
[0m21:03:56.352384 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.352970 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:03:56.353085 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.353194 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:03:56.358090 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.358332 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.358458 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:03:56.358650 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.358757 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.358860 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro__dbt_backup'
  
[0m21:03:56.359133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.359591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.359724 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro__dbt_backup'
  
[0m21:03:56.359997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.360969 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.361073 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      drop table if exists "petro"."main"."petro__dbt_backup" cascade
    
[0m21:03:56.361248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.361860 [debug] [Thread-1 (]: On model.petro.petro: ROLLBACK
[0m21:03:56.362133 [debug] [Thread-1 (]: Failed to rollback 'model.petro.petro'
[0m21:03:56.362240 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m21:03:56.362419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e06e38fe-0fff-4069-9ed4-0c8e2dec610d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfca2b0>]}
[0m21:03:56.362629 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m21:03:56.362841 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m21:03:56.363417 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:56.363574 [debug] [MainThread]: On master: BEGIN
[0m21:03:56.363691 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:03:56.363891 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:56.363999 [debug] [MainThread]: On master: COMMIT
[0m21:03:56.364102 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:56.364193 [debug] [MainThread]: On master: COMMIT
[0m21:03:56.364366 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:56.364537 [debug] [MainThread]: On master: Close
[0m21:03:56.364693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:56.364790 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m21:03:56.364902 [info ] [MainThread]: 
[0m21:03:56.365024 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.68 seconds (13.68s).
[0m21:03:56.365309 [debug] [MainThread]: Command end result
[0m21:03:56.381330 [info ] [MainThread]: 
[0m21:03:56.381520 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:03:56.381638 [info ] [MainThread]: 
[0m21:03:56.381759 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:03:56.383998 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.927426, "process_user_time": 15.662326, "process_kernel_time": 0.753275, "process_mem_max_rss": "2244444160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:03:56.384203 [debug] [MainThread]: Command `dbt run` succeeded at 21:03:56.384160 after 13.93 seconds
[0m21:03:56.384370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145d6d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b2009e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db00a50>]}
[0m21:03:56.384509 [debug] [MainThread]: Flushing usage events
[0m21:05:24.757861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5dd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d55fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d55fd90>]}


============================== 21:05:24.760012 | 176b4a3f-b70c-4294-8fa1-7df7d23202cd ==============================
[0m21:05:24.760012 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:05:24.760274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:05:24.841907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '176b4a3f-b70c-4294-8fa1-7df7d23202cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c369cd0>]}
[0m21:05:24.863044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '176b4a3f-b70c-4294-8fa1-7df7d23202cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d143df0>]}
[0m21:05:24.864127 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:05:24.873197 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:05:24.924830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:05:24.925016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:05:24.927432 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:05:24.939061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '176b4a3f-b70c-4294-8fa1-7df7d23202cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d645850>]}
[0m21:05:24.979189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '176b4a3f-b70c-4294-8fa1-7df7d23202cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5ce5d0>]}
[0m21:05:24.979421 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m21:05:24.979558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '176b4a3f-b70c-4294-8fa1-7df7d23202cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da5c050>]}
[0m21:05:24.980260 [info ] [MainThread]: 
[0m21:05:24.980508 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:05:24.982497 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:05:25.011546 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:05:25.011730 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m21:05:25.011845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:25.018084 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:05:25.018694 [debug] [ThreadPool]: On list_petro: Close
[0m21:05:25.018990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:05:25.019179 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:05:25.021735 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:05:25.021870 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m21:05:25.021975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:25.022305 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:05:25.022771 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:05:25.022865 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:05:25.023008 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:05:25.023106 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:05:25.023200 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:05:25.023366 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:05:25.023679 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:05:25.023784 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:05:25.023881 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:05:25.024015 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:05:25.024114 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:05:25.024623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:05:25.026876 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:05:25.027006 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:05:25.027114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:25.027290 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:05:25.027390 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:05:25.027491 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m21:05:25.031264 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:05:25.031781 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:05:25.032528 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:05:25.032629 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:05:25.033060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '176b4a3f-b70c-4294-8fa1-7df7d23202cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc55570>]}
[0m21:05:25.033279 [debug] [MainThread]: Using duckdb connection "master"
[0m21:05:25.033397 [debug] [MainThread]: On master: BEGIN
[0m21:05:25.033492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:05:25.033674 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:05:25.033792 [debug] [MainThread]: On master: COMMIT
[0m21:05:25.033894 [debug] [MainThread]: Using duckdb connection "master"
[0m21:05:25.033988 [debug] [MainThread]: On master: COMMIT
[0m21:05:25.034126 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:05:25.034226 [debug] [MainThread]: On master: Close
[0m21:05:25.034384 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:05:25.034510 [info ] [MainThread]: 
[0m21:05:25.035521 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:05:25.035720 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m21:05:25.035887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m21:05:25.036016 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:05:25.047167 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:05:25.047549 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:05:25.060137 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:05:25.060515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:27.547825 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:05:27.548102 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:05:27.548408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.548583 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:05:27.548745 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:05:27.549100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.549747 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:05:27.549916 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:05:27.550287 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.553371 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:05:27.553553 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:05:27.553829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.555050 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:05:27.555210 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:05:27.555454 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.562792 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:05:27.562964 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:05:27.563108 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:05:27.563464 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.566211 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:05:27.567016 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m21:05:27.568642 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.569891 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:05:27.570550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '176b4a3f-b70c-4294-8fa1-7df7d23202cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155a1310>]}
[0m21:05:27.570822 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 2.53s]
[0m21:05:27.571069 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:05:27.571399 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m21:05:27.571625 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m21:05:27.571886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m21:05:27.572074 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m21:05:27.579007 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m21:05:27.579389 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m21:05:27.594277 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:05:27.594456 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      drop table if exists "petro"."main"."petro__dbt_backup" cascade
    
[0m21:05:27.594582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:27.595086 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.595613 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:05:27.595755 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260129210527591528"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m21:05:27.598835 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.601568 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:05:27.601711 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:05:27.601890 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.602005 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:05:27.602121 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260129210527591528'
      
      
      order by ordinal_position

  
[0m21:05:27.603033 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.604723 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:05:27.604864 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m21:05:27.605696 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.608393 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:05:27.608523 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m21:05:27.609294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.609826 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:05:27.609938 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m21:05:27.610117 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.615798 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m21:05:27.616166 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:05:27.616285 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260129210527591528"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260129210527591528"
    )
  
[0m21:05:27.629911 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.630598 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:05:27.630727 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:05:27.630836 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:05:27.632689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.632981 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m21:05:27.633215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '176b4a3f-b70c-4294-8fa1-7df7d23202cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da522b0>]}
[0m21:05:27.633456 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.06s]
[0m21:05:27.633667 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m21:05:27.634194 [debug] [MainThread]: Using duckdb connection "master"
[0m21:05:27.634348 [debug] [MainThread]: On master: BEGIN
[0m21:05:27.634465 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:05:27.634672 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:05:27.634780 [debug] [MainThread]: On master: COMMIT
[0m21:05:27.634882 [debug] [MainThread]: Using duckdb connection "master"
[0m21:05:27.634981 [debug] [MainThread]: On master: COMMIT
[0m21:05:27.635135 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:05:27.635238 [debug] [MainThread]: On master: Close
[0m21:05:27.635376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:05:27.635476 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m21:05:27.635591 [info ] [MainThread]: 
[0m21:05:27.635720 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m21:05:27.636032 [debug] [MainThread]: Command end result
[0m21:05:27.648244 [info ] [MainThread]: 
[0m21:05:27.648428 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:05:27.648546 [info ] [MainThread]: 
[0m21:05:27.648674 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:05:27.650896 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9179864, "process_user_time": 1.316641, "process_kernel_time": 0.206931, "process_mem_max_rss": "281018368", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:05:27.651068 [debug] [MainThread]: Command `dbt run` succeeded at 21:05:27.651032 after 2.92 seconds
[0m21:05:27.651199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11563ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115582c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155c22d0>]}
[0m21:05:27.651334 [debug] [MainThread]: Flushing usage events
[0m21:08:01.359187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93d40eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93e27d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93e27fec0>]}


============================== 21:08:01.367635 | bdd831c5-474d-42b3-8b7d-65858f2ba704 ==============================
[0m21:08:01.367635 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:08:01.368281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:08:01.618444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdd831c5-474d-42b3-8b7d-65858f2ba704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93d1dfa10>]}
[0m21:08:01.633958 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ne8jp4b7'
[0m21:08:01.634453 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:08:01.780297 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:08:01.781813 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:08:01.862164 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:08:01.867581 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:08:02.185028 [info ] [MainThread]: Installed from version 1.2.0
[0m21:08:02.185649 [info ] [MainThread]: Updated version available: 1.3.3
[0m21:08:02.186176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bdd831c5-474d-42b3-8b7d-65858f2ba704', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f319f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93d274f50>]}
[0m21:08:02.186709 [info ] [MainThread]: 
[0m21:08:02.187187 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:08:02.216990 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9085995, "process_user_time": 1.651168, "process_kernel_time": 0.144101, "process_mem_max_rss": "101304", "process_in_blocks": "8528", "process_out_blocks": "5176"}
[0m21:08:02.217581 [debug] [MainThread]: Command `dbt deps` succeeded at 21:08:02.217477 after 0.91 seconds
[0m21:08:02.218016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93e27d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93d57e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93d12ea20>]}
[0m21:08:02.218485 [debug] [MainThread]: Flushing usage events
[0m21:08:03.972349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb76455eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb75cda300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb75cdabd0>]}


============================== 21:08:03.975441 | 18a4f234-70b0-4ece-b0ee-4e649c08cb49 ==============================
[0m21:08:03.975441 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:08:03.976121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:08:04.208743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb75c30920>]}
[0m21:08:04.270497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb76999df0>]}
[0m21:08:04.272333 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:08:04.332079 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:08:04.332887 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:08:04.333455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6e76a180>]}
[0m21:08:05.717562 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:08:05.718216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6df3e930>]}
[0m21:08:05.959356 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:08:05.964782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6def2570>]}
[0m21:08:06.063507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6df6efc0>]}
[0m21:08:06.064080 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m21:08:06.064618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb770db920>]}
[0m21:08:06.066703 [info ] [MainThread]: 
[0m21:08:06.067454 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:08:06.072381 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:08:06.108908 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:08:06.109407 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m21:08:06.109804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:06.858493 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m21:08:06.860102 [debug] [ThreadPool]: On list_petro: Close
[0m21:08:06.860937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:08:06.861507 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:08:06.869049 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:08:06.869507 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m21:08:06.869902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:08:06.871100 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:08:06.872438 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:08:06.872823 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:08:06.873630 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:08:06.874008 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:08:06.874363 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:08:06.875032 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:08:06.875988 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:08:06.876380 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:08:06.876781 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:08:06.877372 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:08:06.877805 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:08:06.879016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:08:06.885117 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:08:06.885556 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:08:06.885919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:08:06.886681 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:08:06.887065 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:08:06.887478 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m21:08:06.897932 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:08:06.899244 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:08:06.900532 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:08:06.900922 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:08:06.901631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb77b76750>]}
[0m21:08:06.902151 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:06.902569 [debug] [MainThread]: On master: BEGIN
[0m21:08:06.902935 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:08:06.903855 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:08:06.904260 [debug] [MainThread]: On master: COMMIT
[0m21:08:06.904666 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:06.905026 [debug] [MainThread]: On master: COMMIT
[0m21:08:06.905635 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:08:06.906025 [debug] [MainThread]: On master: Close
[0m21:08:06.906535 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:08:06.907016 [info ] [MainThread]: 
[0m21:08:06.990091 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:08:06.990824 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m21:08:06.991575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m21:08:06.992039 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:08:07.019525 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:08:07.020316 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:08:07.055914 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:08:07.056791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:18.353088 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:08:18.353645 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:08:18.354378 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:08:18.354842 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:08:18.355260 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:08:18.356007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:08:18.370448 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:08:18.370920 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:08:18.371347 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:08:18.372858 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:08:18.378962 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:08:18.379454 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m21:08:18.380211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:08:18.382665 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:08:18.384184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb32e9d880>]}
[0m21:08:18.384888 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.39s]
[0m21:08:18.385677 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:08:18.386595 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m21:08:18.387175 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m21:08:18.387871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m21:08:18.388317 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m21:08:18.393522 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m21:08:18.394311 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m21:08:18.431045 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m21:08:18.431808 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:08:18.432249 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:08:18.432685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:18.433648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:08:18.434088 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:08:18.434569 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

  
    
    

    create  table
      "petro"."main"."petro"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m21:08:18.441916 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:08:18.444051 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:08:18.444511 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:08:18.444924 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:08:18.448327 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:08:18.449183 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m21:08:18.449824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6dd647d0>]}
[0m21:08:18.450491 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.06s]
[0m21:08:18.451291 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m21:08:18.453171 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:18.453617 [debug] [MainThread]: On master: BEGIN
[0m21:08:18.453989 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:08:18.454696 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:08:18.455094 [debug] [MainThread]: On master: COMMIT
[0m21:08:18.455505 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:18.455875 [debug] [MainThread]: On master: COMMIT
[0m21:08:18.456493 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:08:18.456898 [debug] [MainThread]: On master: Close
[0m21:08:18.457360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:08:18.457756 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m21:08:18.458150 [info ] [MainThread]: 
[0m21:08:18.458685 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.39 seconds (12.39s).
[0m21:08:18.459704 [debug] [MainThread]: Command end result
[0m21:08:18.485953 [info ] [MainThread]: 
[0m21:08:18.486631 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:08:18.487156 [info ] [MainThread]: 
[0m21:08:18.487707 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:08:18.488724 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.567081, "process_user_time": 5.936412, "process_kernel_time": 0.284827, "process_mem_max_rss": "272840", "process_in_blocks": "1200", "process_out_blocks": "107368"}
[0m21:08:18.489261 [debug] [MainThread]: Command `dbt run` succeeded at 21:08:18.489159 after 14.57 seconds
[0m21:08:18.489729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb7a3bb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb32f19a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6df8a7e0>]}
[0m21:08:18.490160 [debug] [MainThread]: Flushing usage events
[0m21:08:20.419763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25bcbe8740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25baee32c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25baa3b0b0>]}


============================== 21:08:20.422972 | 4a85ff86-703a-4ecd-809c-c03cb3ea29c6 ==============================
[0m21:08:20.422972 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:08:20.423680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m21:08:20.541781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a85ff86-703a-4ecd-809c-c03cb3ea29c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25bc878aa0>]}
[0m21:08:20.560767 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19282293, "process_user_time": 1.36923, "process_kernel_time": 0.111937, "process_mem_max_rss": "99456", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m21:08:20.561329 [debug] [MainThread]: Command `dbt clean` succeeded at 21:08:20.561227 after 0.19 seconds
[0m21:08:20.561810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25bdf63620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ba95b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25baf9da30>]}
[0m21:08:20.562243 [debug] [MainThread]: Flushing usage events
[0m22:08:53.901698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74a3af800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74d7ab1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74a767920>]}


============================== 22:08:53.911182 | 6ae8bf1d-c0d0-4000-97d6-518848a04b24 ==============================
[0m22:08:53.911182 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:08:53.911937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:08:54.129944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ae8bf1d-c0d0-4000-97d6-518848a04b24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74b5ef5f0>]}
[0m22:08:54.146708 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wpmvlwpa'
[0m22:08:54.147289 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:08:54.277026 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:08:54.278970 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:08:54.325473 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:08:54.331730 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:08:54.490318 [info ] [MainThread]: Installed from version 1.2.0
[0m22:08:54.491050 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:08:54.491681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6ae8bf1d-c0d0-4000-97d6-518848a04b24', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74a0bf2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74a0bf140>]}
[0m22:08:54.492215 [info ] [MainThread]: 
[0m22:08:54.492758 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:08:54.503254 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.65709037, "process_user_time": 1.777548, "process_kernel_time": 0.133341, "process_mem_max_rss": "101320", "process_in_blocks": "8520", "process_out_blocks": "5176"}
[0m22:08:54.504086 [debug] [MainThread]: Command `dbt deps` succeeded at 22:08:54.503953 after 0.66 seconds
[0m22:08:54.504578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74a1d0ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74af964b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74af96e40>]}
[0m22:08:54.505085 [debug] [MainThread]: Flushing usage events
[0m22:08:56.388084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01c50ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff019d65b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff019d657f0>]}


============================== 22:08:56.391371 | 101e2816-2800-4d0f-b37a-682d3e3e20f7 ==============================
[0m22:08:56.391371 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:08:56.392095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:08:56.634802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01ba90ce0>]}
[0m22:08:56.699040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0199bcdd0>]}
[0m22:08:56.701053 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:08:56.782461 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:08:56.783316 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:08:56.783909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff019b5fd10>]}
[0m22:08:58.226229 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:08:58.226995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0124de600>]}
[0m22:08:58.501353 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:08:58.507421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff011d910a0>]}
[0m22:08:58.610328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01247fda0>]}
[0m22:08:58.610972 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:08:58.611506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff011c1e420>]}
[0m22:08:58.613669 [info ] [MainThread]: 
[0m22:08:58.614439 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:08:58.619603 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:08:58.658592 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:08:58.659180 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:08:58.659619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:59.142149 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:59.144444 [debug] [ThreadPool]: On list_petro: Close
[0m22:08:59.145687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:08:59.146529 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:08:59.155129 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:59.155668 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:08:59.156137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:59.157886 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:59.159434 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:59.159875 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:08:59.160542 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:59.160961 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:59.161329 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:08:59.162038 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:59.163053 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:08:59.163450 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:59.163813 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:08:59.164569 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:59.165043 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:08:59.166531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:08:59.173222 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:08:59.173753 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:08:59.174203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:59.175182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:59.175600 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:08:59.176015 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:08:59.187667 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:59.189422 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:08:59.190773 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:08:59.191206 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:08:59.192422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0109ea270>]}
[0m22:08:59.192995 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:59.193400 [debug] [MainThread]: On master: BEGIN
[0m22:08:59.193776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:59.194718 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:59.195174 [debug] [MainThread]: On master: COMMIT
[0m22:08:59.195558 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:59.195958 [debug] [MainThread]: On master: COMMIT
[0m22:08:59.196592 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:59.197036 [debug] [MainThread]: On master: Close
[0m22:08:59.197585 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:08:59.198095 [info ] [MainThread]: 
[0m22:08:59.237508 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:08:59.238234 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:08:59.238960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:08:59.239410 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:08:59.267917 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:08:59.268887 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:08:59.306463 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:08:59.307418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:09:07.538334 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:09:07.538943 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:09:07.539814 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.540286 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:09:07.540715 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:09:07.541897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.543437 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:09:07.543906 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:09:07.545050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.553722 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:09:07.554299 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:09:07.555369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.558896 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:09:07.559373 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:09:07.560409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.578792 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:09:07.579726 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:09:07.580469 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:09:07.582229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.589151 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:09:07.589707 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:09:07.591360 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.594061 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:09:07.595666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01252ae70>]}
[0m22:09:07.596413 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.36s]
[0m22:09:07.597211 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:09:07.598222 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:09:07.598829 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:09:07.599566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:09:07.600075 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:09:07.605966 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:09:07.606738 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:09:07.644723 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:07.645356 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260129220907638369"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:09:07.645859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:09:07.653943 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.662545 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:07.663151 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:09:07.664070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.664515 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:07.664978 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260129220907638369'
      
      
      order by ordinal_position

  
[0m22:09:07.667694 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.673702 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:07.674267 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:09:07.677333 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.685983 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:07.686551 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:09:07.690122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.692086 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:07.692545 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:09:07.693428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.713459 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:09:07.714359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:07.714854 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260129220907638369"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260129220907638369"
    )
  
[0m22:09:07.724766 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.726920 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:09:07.727397 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:07.727881 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:09:07.734282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.735359 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:09:07.736131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd2970560>]}
[0m22:09:07.736814 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.14s]
[0m22:09:07.737582 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:09:07.739116 [debug] [MainThread]: Using duckdb connection "master"
[0m22:09:07.739537 [debug] [MainThread]: On master: BEGIN
[0m22:09:07.739944 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:09:07.740763 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:09:07.741209 [debug] [MainThread]: On master: COMMIT
[0m22:09:07.741591 [debug] [MainThread]: Using duckdb connection "master"
[0m22:09:07.741997 [debug] [MainThread]: On master: COMMIT
[0m22:09:07.742646 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:09:07.743114 [debug] [MainThread]: On master: Close
[0m22:09:07.743619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:09:07.744014 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:09:07.744429 [info ] [MainThread]: 
[0m22:09:07.744950 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.13 seconds (9.13s).
[0m22:09:07.745961 [debug] [MainThread]: Command end result
[0m22:09:07.773615 [info ] [MainThread]: 
[0m22:09:07.774323 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:09:07.774825 [info ] [MainThread]: 
[0m22:09:07.775353 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:09:07.776429 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.441113, "process_user_time": 6.095265, "process_kernel_time": 0.30857, "process_mem_max_rss": "313572", "process_in_blocks": "1200", "process_out_blocks": "107432"}
[0m22:09:07.777019 [debug] [MainThread]: Command `dbt run` succeeded at 22:09:07.776910 after 11.44 seconds
[0m22:09:07.777473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01c50ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff019c6a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01a649ca0>]}
[0m22:09:07.777932 [debug] [MainThread]: Flushing usage events
[0m22:09:09.748723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d73846780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d73e94590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d749a61b0>]}


============================== 22:09:09.752114 | 206b11f0-2ccf-46c8-a751-a64e9001023e ==============================
[0m22:09:09.752114 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:09:09.752803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:09:09.873020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '206b11f0-2ccf-46c8-a751-a64e9001023e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d738872c0>]}
[0m22:09:09.892727 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1966639, "process_user_time": 1.459043, "process_kernel_time": 0.111926, "process_mem_max_rss": "99644", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:09:09.893365 [debug] [MainThread]: Command `dbt clean` succeeded at 22:09:09.893249 after 0.20 seconds
[0m22:09:09.893918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d736f9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d738872c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d73885490>]}
[0m22:09:09.894387 [debug] [MainThread]: Flushing usage events
[0m06:20:26.758903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c308b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c3440dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c3fc6c60>]}


============================== 06:20:26.776783 | 6143c17d-cd6f-4176-8ce6-4f2a18385bdb ==============================
[0m06:20:26.776783 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:20:26.777452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:20:26.942950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6143c17d-cd6f-4176-8ce6-4f2a18385bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c2ead760>]}
[0m06:20:26.958430 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_udpg3qe'
[0m06:20:26.958893 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:20:27.012631 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:20:27.014410 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:20:27.049122 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:20:27.055062 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:20:27.291435 [info ] [MainThread]: Installed from version 1.2.0
[0m06:20:27.292008 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:20:27.292593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6143c17d-cd6f-4176-8ce6-4f2a18385bdb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c2eace60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c2d71eb0>]}
[0m06:20:27.293045 [info ] [MainThread]: 
[0m06:20:27.293549 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:20:27.303366 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.59577, "process_user_time": 1.658431, "process_kernel_time": 0.126261, "process_mem_max_rss": "101412", "process_in_blocks": "8528", "process_out_blocks": "5176"}
[0m06:20:27.303916 [debug] [MainThread]: Command `dbt deps` succeeded at 06:20:27.303812 after 0.60 seconds
[0m06:20:27.304379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c73bb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c36f4ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c3046d20>]}
[0m06:20:27.304812 [debug] [MainThread]: Flushing usage events
[0m06:20:29.091694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48b32e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48968aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4896892b0>]}


============================== 06:20:29.094769 | 9718e89c-a094-4bb0-87c4-1373231583f8 ==============================
[0m06:20:29.094769 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:20:29.095475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:20:29.328843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff488fa1490>]}
[0m06:20:29.390951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff489202900>]}
[0m06:20:29.392859 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:20:29.428140 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:20:29.429377 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:20:29.430125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff481b34410>]}
[0m06:20:30.843640 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:20:30.844318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff481c15880>]}
[0m06:20:31.085487 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:20:31.090896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff481211cd0>]}
[0m06:20:31.186211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff481a81c40>]}
[0m06:20:31.186736 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:20:31.187273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff481bba4b0>]}
[0m06:20:31.189291 [info ] [MainThread]: 
[0m06:20:31.189996 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:20:31.194814 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:20:31.230619 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:20:31.231059 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:20:31.231476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:20:31.740497 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:20:31.742086 [debug] [ThreadPool]: On list_petro: Close
[0m06:20:31.742917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:20:31.743476 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:20:31.750933 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:20:31.751372 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:20:31.751743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:20:31.752673 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:20:31.753956 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:20:31.754383 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:20:31.754950 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:20:31.755354 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:20:31.755713 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:20:31.756343 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:20:31.757262 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:20:31.757654 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:20:31.758041 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:20:31.758629 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:20:31.759018 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:20:31.760222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:20:31.766012 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:20:31.766433 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:20:31.766791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:20:31.767431 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:20:31.767827 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:20:31.768226 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:20:31.778759 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:20:31.780081 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:20:31.781327 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:20:31.781724 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:20:31.782840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff481ac24b0>]}
[0m06:20:31.783386 [debug] [MainThread]: Using duckdb connection "master"
[0m06:20:31.783771 [debug] [MainThread]: On master: BEGIN
[0m06:20:31.784134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:20:31.784797 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:20:31.785191 [debug] [MainThread]: On master: COMMIT
[0m06:20:31.785596 [debug] [MainThread]: Using duckdb connection "master"
[0m06:20:31.785963 [debug] [MainThread]: On master: COMMIT
[0m06:20:31.786563 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:20:31.786958 [debug] [MainThread]: On master: Close
[0m06:20:31.787465 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:20:31.787937 [info ] [MainThread]: 
[0m06:20:31.807097 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:20:31.807703 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:20:31.808312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:20:31.808747 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:20:31.835758 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:20:31.836507 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:20:31.871884 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:20:31.872650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:20:43.316532 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:20:43.317063 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:20:43.317820 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.318275 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:20:43.318695 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:20:43.319601 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.320940 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:20:43.321421 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:20:43.322433 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.330319 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:20:43.330781 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:20:43.331528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.334506 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:20:43.334947 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:20:43.335677 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.352159 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:20:43.352654 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:20:43.353070 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:20:43.355069 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.360789 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:20:43.361272 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:20:43.362482 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.364890 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:20:43.366422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48af63bf0>]}
[0m06:20:43.367126 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.56s]
[0m06:20:43.367892 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:20:43.368888 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:20:43.369490 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:20:43.370085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:20:43.370562 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:20:43.375525 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:20:43.376157 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:20:43.412077 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:20:43.412580 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260130062043406030"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:20:43.413029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:20:43.420007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.427552 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:20:43.428008 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:20:43.428722 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.429155 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:20:43.429602 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260130062043406030'
      
      
      order by ordinal_position

  
[0m06:20:43.431991 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.437167 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:20:43.437657 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:20:43.440076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.447826 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:20:43.448302 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:20:43.450619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.452306 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:20:43.452749 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:20:43.453470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.471722 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:20:43.472448 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:20:43.472904 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260130062043406030"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260130062043406030"
    )
  
[0m06:20:43.480055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.481895 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:20:43.482364 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:20:43.482770 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:20:43.488829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.489728 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:20:43.490424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff43da770b0>]}
[0m06:20:43.491086 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m06:20:43.491859 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:20:43.493738 [debug] [MainThread]: Using duckdb connection "master"
[0m06:20:43.494150 [debug] [MainThread]: On master: BEGIN
[0m06:20:43.494564 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:20:43.495283 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:20:43.495756 [debug] [MainThread]: On master: COMMIT
[0m06:20:43.496142 [debug] [MainThread]: Using duckdb connection "master"
[0m06:20:43.496555 [debug] [MainThread]: On master: COMMIT
[0m06:20:43.497158 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:20:43.497626 [debug] [MainThread]: On master: Close
[0m06:20:43.498095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:20:43.498478 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:20:43.498905 [info ] [MainThread]: 
[0m06:20:43.499397 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.31 seconds (12.31s).
[0m06:20:43.500317 [debug] [MainThread]: Command end result
[0m06:20:43.525646 [info ] [MainThread]: 
[0m06:20:43.526218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:20:43.526671 [info ] [MainThread]: 
[0m06:20:43.527122 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:20:43.528043 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.486872, "process_user_time": 5.799391, "process_kernel_time": 0.290269, "process_mem_max_rss": "312788", "process_in_blocks": "1200", "process_out_blocks": "107400"}
[0m06:20:43.528611 [debug] [MainThread]: Command `dbt run` succeeded at 06:20:43.528511 after 14.49 seconds
[0m06:20:43.529050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48b32e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff481c14110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff43dadd940>]}
[0m06:20:43.529499 [debug] [MainThread]: Flushing usage events
[0m06:20:45.468786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc118b1a6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc118a9d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc118a9deb0>]}


============================== 06:20:45.471891 | d1d0d4e3-3901-45a2-abbd-c60ede0a0bdc ==============================
[0m06:20:45.471891 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:20:45.472610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:20:45.587990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1d0d4e3-3901-45a2-abbd-c60ede0a0bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11a778560>]}
[0m06:20:45.606344 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18779896, "process_user_time": 1.351778, "process_kernel_time": 0.100983, "process_mem_max_rss": "99336", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:20:45.606896 [debug] [MainThread]: Command `dbt clean` succeeded at 06:20:45.606793 after 0.19 seconds
[0m06:20:45.607342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc118a9fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc118a68b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc118ad1f10>]}
[0m06:20:45.607763 [debug] [MainThread]: Flushing usage events
[0m14:18:17.107259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b2dc9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7afaf45c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7afaf74a0>]}


============================== 14:18:17.125510 | f8bc9997-f86a-45af-9f11-d79625a6aefd ==============================
[0m14:18:17.125510 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:18:17.126172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:18:17.301765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8bc9997-f86a-45af-9f11-d79625a6aefd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7afb227b0>]}
[0m14:18:17.317587 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3c9q6jf0'
[0m14:18:17.318066 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:18:17.387014 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:18:17.388318 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:18:17.419353 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:18:17.424513 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:18:17.658651 [info ] [MainThread]: Installed from version 1.2.0
[0m14:18:17.659281 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:18:17.659880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f8bc9997-f86a-45af-9f11-d79625a6aefd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7af0adbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7af0ae060>]}
[0m14:18:17.660379 [info ] [MainThread]: 
[0m14:18:17.660867 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:18:17.674557 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6185427, "process_user_time": 1.630593, "process_kernel_time": 0.156248, "process_mem_max_rss": "101212", "process_in_blocks": "8528", "process_out_blocks": "5176"}
[0m14:18:17.675108 [debug] [MainThread]: Command `dbt deps` succeeded at 14:18:17.675002 after 0.62 seconds
[0m14:18:17.675581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7afbdd640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7af072180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b37bb950>]}
[0m14:18:17.676039 [debug] [MainThread]: Flushing usage events
[0m14:18:19.454965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00b183e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00af671730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00af6716d0>]}


============================== 14:18:19.457990 | df9bfd27-85dc-4734-befb-dcf85ba8c93c ==============================
[0m14:18:19.457990 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:18:19.458680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:18:19.691505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00af3e9580>]}
[0m14:18:19.753115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00af3eb7d0>]}
[0m14:18:19.754866 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:18:19.807490 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:18:19.808209 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:18:19.808754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00af6716d0>]}
[0m14:18:21.207560 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:18:21.208233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a7600c20>]}
[0m14:18:21.449047 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:18:21.454414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00af53c290>]}
[0m14:18:21.549935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a7e93380>]}
[0m14:18:21.550500 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:18:21.551007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a7ee5f70>]}
[0m14:18:21.553042 [info ] [MainThread]: 
[0m14:18:21.553774 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:18:21.558602 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:18:21.594715 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:18:21.595163 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:18:21.595580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:22.139536 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:18:22.141121 [debug] [ThreadPool]: On list_petro: Close
[0m14:18:22.142034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:18:22.142608 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:18:22.149937 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:18:22.150377 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:18:22.150755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:22.151799 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:18:22.153127 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:18:22.153530 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:18:22.154107 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:18:22.154508 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:18:22.154867 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:18:22.155494 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:18:22.156409 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:18:22.156800 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:18:22.157163 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:18:22.157819 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:18:22.158210 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:18:22.159482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:18:22.165429 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:18:22.165828 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:18:22.166188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:22.166865 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:18:22.167248 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:18:22.167666 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:18:22.178151 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:18:22.179554 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:18:22.180795 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:18:22.181190 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:18:22.182355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a7e4dee0>]}
[0m14:18:22.182863 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:22.183243 [debug] [MainThread]: On master: BEGIN
[0m14:18:22.183630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:18:22.184271 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:18:22.184688 [debug] [MainThread]: On master: COMMIT
[0m14:18:22.185056 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:22.185441 [debug] [MainThread]: On master: COMMIT
[0m14:18:22.186023 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:18:22.186446 [debug] [MainThread]: On master: Close
[0m14:18:22.186930 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:18:22.187435 [info ] [MainThread]: 
[0m14:18:22.206477 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:18:22.207114 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:18:22.207756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:18:22.208206 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:18:22.235422 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:18:22.236229 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:18:22.271440 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:18:22.272194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:31.417384 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:18:31.417916 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:18:31.418582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.419013 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:18:31.419445 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:18:31.420366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.421710 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:18:31.422149 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:18:31.423180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.430920 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:18:31.431390 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:18:31.432204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.435146 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:18:31.435608 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:18:31.436340 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.452950 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:18:31.453428 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:18:31.453847 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:18:31.455708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.461343 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:18:31.461797 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:18:31.463183 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.465646 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:18:31.467170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0080007650>]}
[0m14:18:31.467868 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.26s]
[0m14:18:31.468649 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:18:31.469481 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:18:31.470227 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:18:31.470851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:18:31.471286 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:18:31.476283 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:18:31.476957 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:18:31.514184 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:18:31.514692 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260130141831508174"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:18:31.515148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:31.522646 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.530213 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:18:31.530687 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:18:31.531348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.531785 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:18:31.532206 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260130141831508174'
      
      
      order by ordinal_position

  
[0m14:18:31.534604 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.539799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:18:31.540257 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:18:31.542697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.550371 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:18:31.550826 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:18:31.554007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.555678 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:18:31.556125 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:18:31.556893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.575476 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:18:31.576189 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:18:31.576661 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260130141831508174"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260130141831508174"
    )
  
[0m14:18:31.585114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.586986 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:18:31.587433 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:18:31.587839 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:18:31.593686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.594574 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:18:31.595222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006c341b20>]}
[0m14:18:31.595896 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m14:18:31.596622 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:18:31.597954 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:31.598421 [debug] [MainThread]: On master: BEGIN
[0m14:18:31.598818 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:18:31.599528 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:18:31.599950 [debug] [MainThread]: On master: COMMIT
[0m14:18:31.600348 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:31.600732 [debug] [MainThread]: On master: COMMIT
[0m14:18:31.601301 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:18:31.601727 [debug] [MainThread]: On master: Close
[0m14:18:31.602187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:31.602587 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:18:31.602981 [info ] [MainThread]: 
[0m14:18:31.603492 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.05 seconds (10.05s).
[0m14:18:31.604434 [debug] [MainThread]: Command end result
[0m14:18:31.630141 [info ] [MainThread]: 
[0m14:18:31.630715 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:18:31.631180 [info ] [MainThread]: 
[0m14:18:31.631673 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:18:31.632614 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.228007, "process_user_time": 5.360382, "process_kernel_time": 0.286806, "process_mem_max_rss": "297576", "process_in_blocks": "1200", "process_out_blocks": "107384"}
[0m14:18:31.633146 [debug] [MainThread]: Command `dbt run` succeeded at 14:18:31.633044 after 12.23 seconds
[0m14:18:31.633593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00af671730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006d49afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006c32f8c0>]}
[0m14:18:31.634012 [debug] [MainThread]: Flushing usage events
[0m14:18:33.592454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21001554f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f210095d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2100046930>]}


============================== 14:18:33.595571 | 523e8826-36c1-438d-8005-8a530883184f ==============================
[0m14:18:33.595571 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:18:33.596236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:18:33.712698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '523e8826-36c1-438d-8005-8a530883184f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f210095c8f0>]}
[0m14:18:33.730828 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18896872, "process_user_time": 1.339973, "process_kernel_time": 0.11691, "process_mem_max_rss": "99644", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:18:33.731402 [debug] [MainThread]: Command `dbt clean` succeeded at 14:18:33.731264 after 0.19 seconds
[0m14:18:33.731840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21001c06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20fff7f6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f210095c8f0>]}
[0m14:18:33.732257 [debug] [MainThread]: Flushing usage events
[0m22:07:18.082059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c51a96870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c51f6b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c51a96ea0>]}


============================== 22:07:18.098622 | 690ee77b-bb0c-483a-8ce7-f2c14955acbe ==============================
[0m22:07:18.098622 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:18.099315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:18.261177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '690ee77b-bb0c-483a-8ce7-f2c14955acbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5332ad20>]}
[0m22:07:18.276770 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fmwxrtu2'
[0m22:07:18.277273 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:07:18.394556 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:07:18.396283 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:07:18.456906 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:07:18.462460 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:07:18.820501 [info ] [MainThread]: Installed from version 1.2.0
[0m22:07:18.821151 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:07:18.821762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '690ee77b-bb0c-483a-8ce7-f2c14955acbe', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c51480830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c51459820>]}
[0m22:07:18.822269 [info ] [MainThread]: 
[0m22:07:18.822782 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:07:18.878909 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8482842, "process_user_time": 1.62606, "process_kernel_time": 0.148279, "process_mem_max_rss": "101476", "process_in_blocks": "8520", "process_out_blocks": "5176"}
[0m22:07:18.879642 [debug] [MainThread]: Command `dbt deps` succeeded at 22:07:18.879530 after 0.85 seconds
[0m22:07:18.880105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c525db530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c513af8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c513ac980>]}
[0m22:07:18.880554 [debug] [MainThread]: Flushing usage events
[0m22:07:20.687804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3216bad4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3217875670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32167aaf30>]}


============================== 22:07:20.690976 | 0d1dd4e9-9bd0-4388-9943-dbd11b848e66 ==============================
[0m22:07:20.690976 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:20.691690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:07:20.925922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f321867c740>]}
[0m22:07:20.987437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3216589100>]}
[0m22:07:20.989285 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:07:21.013263 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:07:21.014005 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:07:21.014513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32172d0aa0>]}
[0m22:07:22.404548 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:07:22.405215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f320e90f860>]}
[0m22:07:22.650417 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:07:22.656111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3216c510a0>]}
[0m22:07:22.751469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f320f0c2d20>]}
[0m22:07:22.752088 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:07:22.752619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3216c51a60>]}
[0m22:07:22.754746 [info ] [MainThread]: 
[0m22:07:22.755501 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:07:22.760520 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:07:22.797459 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:07:22.797958 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:07:22.798372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:23.629920 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:07:23.631594 [debug] [ThreadPool]: On list_petro: Close
[0m22:07:23.632493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:07:23.633117 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:07:23.640904 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:23.641396 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:07:23.641794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:23.642805 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:23.644216 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:23.644646 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:07:23.645303 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:23.645711 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:23.646136 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:07:23.646811 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:23.647787 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:23.648250 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:23.648675 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:23.649343 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:23.649795 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:07:23.651210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:07:23.657672 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:23.658097 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:07:23.658479 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:23.659170 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:23.659559 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:23.659931 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:07:23.670361 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:23.671706 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:07:23.672907 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:07:23.673336 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:07:23.674449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32166a46e0>]}
[0m22:07:23.674954 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:23.675381 [debug] [MainThread]: On master: BEGIN
[0m22:07:23.675746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:23.676397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:23.676793 [debug] [MainThread]: On master: COMMIT
[0m22:07:23.677204 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:23.677570 [debug] [MainThread]: On master: COMMIT
[0m22:07:23.678172 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:23.678567 [debug] [MainThread]: On master: Close
[0m22:07:23.679074 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:07:23.679578 [info ] [MainThread]: 
[0m22:07:23.697553 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:07:23.698168 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:07:23.698730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:07:23.699191 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:07:23.726371 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:07:23.727190 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:07:23.762298 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:07:23.763076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:34.286636 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:34.287213 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:34.287936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.288398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:34.288809 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:34.289779 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.291190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:34.291629 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:34.292838 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.300653 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:34.301132 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:34.302150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.305185 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:34.305638 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:34.306368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.323231 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:34.323752 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:34.324197 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:34.325773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.331746 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:34.332235 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:34.334133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.336601 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:34.338130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f320e8a8f50>]}
[0m22:07:34.338808 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.64s]
[0m22:07:34.339582 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:34.340419 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:34.341013 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:34.341662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:34.342145 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:34.347363 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:34.348280 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:34.384710 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:34.385303 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260130220734378580"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:34.385767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:34.393215 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.402015 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:34.402577 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:34.403432 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.403952 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:34.404427 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260130220734378580'
      
      
      order by ordinal_position

  
[0m22:07:34.407270 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.412703 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:34.413190 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:34.415616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.423522 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:34.424000 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:34.427190 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.428892 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:34.429366 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:07:34.430114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.448784 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:34.449576 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:34.450052 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260130220734378580"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260130220734378580"
    )
  
[0m22:07:34.459025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.460940 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:34.461398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:34.461815 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:34.468436 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.469383 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:34.470096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31fc164080>]}
[0m22:07:34.470764 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m22:07:34.471545 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:34.473304 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:34.473732 [debug] [MainThread]: On master: BEGIN
[0m22:07:34.474158 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:34.474921 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:34.475369 [debug] [MainThread]: On master: COMMIT
[0m22:07:34.475750 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:34.476177 [debug] [MainThread]: On master: COMMIT
[0m22:07:34.476767 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:34.477217 [debug] [MainThread]: On master: Close
[0m22:07:34.477708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:34.478108 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:34.478528 [info ] [MainThread]: 
[0m22:07:34.479026 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.72 seconds (11.72s).
[0m22:07:34.479941 [debug] [MainThread]: Command end result
[0m22:07:34.506336 [info ] [MainThread]: 
[0m22:07:34.507009 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:34.507475 [info ] [MainThread]: 
[0m22:07:34.507931 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:34.508895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.874199, "process_user_time": 5.385848, "process_kernel_time": 0.283097, "process_mem_max_rss": "302060", "process_in_blocks": "1200", "process_out_blocks": "107432"}
[0m22:07:34.509474 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:34.509372 after 13.87 seconds
[0m22:07:34.509915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32173f6f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3216d0b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c775b7d0>]}
[0m22:07:34.510373 [debug] [MainThread]: Flushing usage events
[0m22:07:36.403072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d70af980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d692afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d70adfa0>]}


============================== 22:07:36.406183 | 1482a502-82e9-4462-a312-a7d4ecfaf1c2 ==============================
[0m22:07:36.406183 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:36.406820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:36.521196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1482a502-82e9-4462-a312-a7d4ecfaf1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d77c3860>]}
[0m22:07:36.538924 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18818788, "process_user_time": 1.348855, "process_kernel_time": 0.119987, "process_mem_max_rss": "99700", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:07:36.539491 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:36.539391 after 0.19 seconds
[0m22:07:36.539906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d99f3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d6f6e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d6327950>]}
[0m22:07:36.540374 [debug] [MainThread]: Flushing usage events
[0m06:14:25.787980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ad182d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ad6b23f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25aef0d6d0>]}


============================== 06:14:25.803775 | 46b61f68-2db1-4889-b7b6-f5e03b7b3e8c ==============================
[0m06:14:25.803775 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:14:25.804477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:14:25.965246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46b61f68-2db1-4889-b7b6-f5e03b7b3e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25aef0e960>]}
[0m06:14:25.980510 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xkv8whit'
[0m06:14:25.980973 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:14:26.096163 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:14:26.097698 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:14:26.152930 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:14:26.158061 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:14:26.390905 [info ] [MainThread]: Installed from version 1.2.0
[0m06:14:26.391549 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:14:26.392104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '46b61f68-2db1-4889-b7b6-f5e03b7b3e8c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25acd7c620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ad093740>]}
[0m06:14:26.392606 [info ] [MainThread]: 
[0m06:14:26.393100 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:14:26.404067 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.66776896, "process_user_time": 1.627118, "process_kernel_time": 0.153539, "process_mem_max_rss": "101444", "process_in_blocks": "8520", "process_out_blocks": "5176"}
[0m06:14:26.404681 [debug] [MainThread]: Command `dbt deps` succeeded at 06:14:26.404571 after 0.67 seconds
[0m06:14:26.405131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25acd7d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ace32600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25acd5d670>]}
[0m06:14:26.405600 [debug] [MainThread]: Flushing usage events
[0m06:14:28.163728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c3e96570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c416d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c4daec60>]}


============================== 06:14:28.166852 | 6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc ==============================
[0m06:14:28.166852 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:14:28.167545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:14:28.417122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c5d6c560>]}
[0m06:14:28.479188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c4105730>]}
[0m06:14:28.481047 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:14:28.506923 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:14:28.507700 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:14:28.508259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c4425d30>]}
[0m06:14:29.912357 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:14:29.913009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6bc860080>]}
[0m06:14:30.155895 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:14:30.161499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6b7f14830>]}
[0m06:14:30.256810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6bc177680>]}
[0m06:14:30.257403 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:14:30.257891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6b7f61130>]}
[0m06:14:30.259948 [info ] [MainThread]: 
[0m06:14:30.260704 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:14:30.265604 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:14:30.302195 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:14:30.302709 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:14:30.303098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:30.830536 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:14:30.832492 [debug] [ThreadPool]: On list_petro: Close
[0m06:14:30.833533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:14:30.834287 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:14:30.843599 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:14:30.844024 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:14:30.844445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:14:30.845569 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:14:30.846920 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:14:30.847343 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:14:30.848255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:14:30.848649 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:14:30.849013 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:14:30.849708 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:14:30.850663 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:14:30.851052 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:14:30.851435 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:14:30.851996 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:14:30.852413 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:14:30.853721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:14:30.859940 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:14:30.860380 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:14:30.860745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:14:30.861531 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:14:30.861921 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:14:30.862320 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:14:30.872982 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:14:30.874474 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:14:30.875728 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:14:30.876131 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:14:30.877364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6bc860200>]}
[0m06:14:30.877883 [debug] [MainThread]: Using duckdb connection "master"
[0m06:14:30.878327 [debug] [MainThread]: On master: BEGIN
[0m06:14:30.878704 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:14:30.879386 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:14:30.879801 [debug] [MainThread]: On master: COMMIT
[0m06:14:30.880180 [debug] [MainThread]: Using duckdb connection "master"
[0m06:14:30.880599 [debug] [MainThread]: On master: COMMIT
[0m06:14:30.881196 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:14:30.881634 [debug] [MainThread]: On master: Close
[0m06:14:30.882139 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:14:30.882686 [info ] [MainThread]: 
[0m06:14:30.902860 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:14:30.903587 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:14:30.904330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:14:30.904784 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:14:30.932120 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:14:30.932993 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:14:30.968895 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:14:30.969777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:14:39.348660 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:14:39.349236 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:14:39.349942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.350406 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:14:39.350826 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:14:39.351774 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.353129 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:14:39.353594 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:14:39.354605 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.362398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:14:39.362852 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:14:39.363680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.366685 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:14:39.367137 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:14:39.367944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.384786 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:14:39.385273 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:14:39.385689 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:14:39.387507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.393200 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:14:39.393670 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:14:39.394815 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.397290 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:14:39.398818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c5d47590>]}
[0m06:14:39.399533 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.49s]
[0m06:14:39.400388 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:14:39.401395 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:14:39.401944 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:14:39.402606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:14:39.403043 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:14:39.408038 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:14:39.408693 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:14:39.444619 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:39.445123 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260131061439438614"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:14:39.445599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:14:39.452559 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.460179 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:39.460655 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:14:39.461324 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.461759 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:39.462176 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260131061439438614'
      
      
      order by ordinal_position

  
[0m06:14:39.464537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.469671 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:39.470129 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:14:39.472470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.480049 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:39.480525 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:14:39.483614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.485274 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:39.485716 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:14:39.486464 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.505042 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:14:39.505791 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:39.506290 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260131061439438614"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260131061439438614"
    )
  
[0m06:14:39.514902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.516838 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:14:39.517318 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:39.517729 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:14:39.522875 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.523795 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:14:39.524479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff678309220>]}
[0m06:14:39.525148 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m06:14:39.525971 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:14:39.527585 [debug] [MainThread]: Using duckdb connection "master"
[0m06:14:39.527996 [debug] [MainThread]: On master: BEGIN
[0m06:14:39.528414 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:14:39.529122 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:14:39.529560 [debug] [MainThread]: On master: COMMIT
[0m06:14:39.529930 [debug] [MainThread]: Using duckdb connection "master"
[0m06:14:39.530327 [debug] [MainThread]: On master: COMMIT
[0m06:14:39.530928 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:14:39.531363 [debug] [MainThread]: On master: Close
[0m06:14:39.531821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:14:39.532179 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:14:39.532600 [info ] [MainThread]: 
[0m06:14:39.533114 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.27 seconds (9.27s).
[0m06:14:39.534110 [debug] [MainThread]: Command end result
[0m06:14:39.560101 [info ] [MainThread]: 
[0m06:14:39.560727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:14:39.561262 [info ] [MainThread]: 
[0m06:14:39.561804 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:14:39.562800 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.452127, "process_user_time": 5.424592, "process_kernel_time": 0.289779, "process_mem_max_rss": "279280", "process_in_blocks": "1200", "process_out_blocks": "107400"}
[0m06:14:39.563372 [debug] [MainThread]: Command `dbt run` succeeded at 06:14:39.563265 after 11.45 seconds
[0m06:14:39.563811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c3fc99a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c40abda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c43f7d40>]}
[0m06:14:39.564254 [debug] [MainThread]: Flushing usage events
[0m06:14:41.335201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf4960710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf37a4920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf2e62bd0>]}


============================== 06:14:41.338259 | b251035d-4c46-4be2-b373-e9312a1d7a91 ==============================
[0m06:14:41.338259 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:14:41.338948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:14:41.453258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b251035d-4c46-4be2-b373-e9312a1d7a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf3bed8e0>]}
[0m06:14:41.471422 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18813032, "process_user_time": 1.33291, "process_kernel_time": 0.122899, "process_mem_max_rss": "99688", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:14:41.471961 [debug] [MainThread]: Command `dbt clean` succeeded at 06:14:41.471863 after 0.19 seconds
[0m06:14:41.472422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf6fbb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf35883b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf2b31790>]}
[0m06:14:41.472835 [debug] [MainThread]: Flushing usage events
[0m14:10:01.126595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3171f96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc316cfb740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31694adb0>]}


============================== 14:10:01.146478 | 1f9ef5a5-06a6-4b9d-9aaf-28a0e8e16859 ==============================
[0m14:10:01.146478 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:01.147163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:10:01.330183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f9ef5a5-06a6-4b9d-9aaf-28a0e8e16859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3167c3d70>]}
[0m14:10:01.346421 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qg__b2al'
[0m14:10:01.346936 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:10:01.435046 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:10:01.436953 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:10:01.468843 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:10:01.474761 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:10:01.941844 [info ] [MainThread]: Installed from version 1.2.0
[0m14:10:01.942464 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:10:01.943005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1f9ef5a5-06a6-4b9d-9aaf-28a0e8e16859', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3165ec620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc316757a70>]}
[0m14:10:01.943500 [info ] [MainThread]: 
[0m14:10:01.943981 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:10:01.955623 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8811898, "process_user_time": 1.661222, "process_kernel_time": 0.14262, "process_mem_max_rss": "101408", "process_in_blocks": "8512", "process_out_blocks": "5168"}
[0m14:10:01.956195 [debug] [MainThread]: Command `dbt deps` succeeded at 14:10:01.956090 after 0.88 seconds
[0m14:10:01.956653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc316d643b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31784a180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31694ad20>]}
[0m14:10:01.957084 [debug] [MainThread]: Flushing usage events
[0m14:10:03.857281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7ccfe3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7cf11c0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7ccfaa8a0>]}


============================== 14:10:03.860503 | bd4b7619-9058-4608-b371-8cb40bc80642 ==============================
[0m14:10:03.860503 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:03.861202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:04.098249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7ceca48c0>]}
[0m14:10:04.161465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c597f410>]}
[0m14:10:04.163397 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:10:04.195432 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:10:04.196187 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:10:04.196724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7cce23e60>]}
[0m14:10:05.605358 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:10:05.606034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c50db860>]}
[0m14:10:05.858477 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:10:05.863901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c5098da0>]}
[0m14:10:05.964021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c5197260>]}
[0m14:10:05.964621 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:10:05.965134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c5906180>]}
[0m14:10:05.967238 [info ] [MainThread]: 
[0m14:10:05.967988 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:10:05.972989 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:10:06.010714 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:10:06.011232 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:10:06.011661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:06.452269 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:06.454051 [debug] [ThreadPool]: On list_petro: Close
[0m14:10:06.454974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:10:06.455576 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:10:06.463537 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:10:06.463965 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:10:06.464379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:06.465701 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:06.467082 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:10:06.467510 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:10:06.468309 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:06.468726 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:10:06.469088 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:10:06.469745 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:06.470694 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:10:06.471090 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:10:06.471488 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:10:06.472065 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:06.472496 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:10:06.473762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:10:06.479781 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:10:06.480191 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:10:06.480579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:06.481250 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:06.481666 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:10:06.482046 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:10:06.492890 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:06.494312 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:10:06.495570 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:10:06.495967 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:10:06.497031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c51ebcb0>]}
[0m14:10:06.497589 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:06.497977 [debug] [MainThread]: On master: BEGIN
[0m14:10:06.498363 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:06.499036 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:06.499459 [debug] [MainThread]: On master: COMMIT
[0m14:10:06.499831 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:06.500191 [debug] [MainThread]: On master: COMMIT
[0m14:10:06.500784 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:06.501180 [debug] [MainThread]: On master: Close
[0m14:10:06.501692 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:10:06.502169 [info ] [MainThread]: 
[0m14:10:06.523422 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:10:06.524034 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:10:06.524650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:10:06.525082 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:10:06.552024 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:10:06.552840 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:10:06.588491 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:10:06.589230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:16.882454 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:16.883009 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:16.883685 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.884141 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:16.884587 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:10:16.885591 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.886943 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:16.887402 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:10:16.888460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.896373 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:16.896850 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:16.897668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.900725 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:16.901187 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:16.901908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.918578 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:16.919057 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:16.919500 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:16.920945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.926669 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:16.927124 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:10:16.928557 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.930947 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:16.932457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7cd9fd730>]}
[0m14:10:16.933132 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.41s]
[0m14:10:16.933890 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:16.934718 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:16.935288 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:16.935959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:16.936441 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:16.941496 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:16.942284 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:16.978823 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:16.979382 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260131141016972695"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:16.979841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:16.987049 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.994931 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:16.995415 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:16.996084 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.996536 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:16.996965 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260131141016972695'
      
      
      order by ordinal_position

  
[0m14:10:16.999295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:17.004460 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:17.004916 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:17.007153 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:17.014869 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:17.015331 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:17.018096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:17.019782 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:17.020226 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:10:17.020937 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:17.039308 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:17.040034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:17.040506 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260131141016972695"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260131141016972695"
    )
  
[0m14:10:17.046807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:17.048661 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:17.049107 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:17.049539 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:17.057073 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:17.057969 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:17.058658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd782793020>]}
[0m14:10:17.059325 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m14:10:17.060150 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:17.061900 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:17.062308 [debug] [MainThread]: On master: BEGIN
[0m14:10:17.062726 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:17.063483 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:17.063963 [debug] [MainThread]: On master: COMMIT
[0m14:10:17.064359 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:17.064760 [debug] [MainThread]: On master: COMMIT
[0m14:10:17.065328 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:17.065760 [debug] [MainThread]: On master: Close
[0m14:10:17.066223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:17.066629 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:17.067040 [info ] [MainThread]: 
[0m14:10:17.067588 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.10 seconds (11.10s).
[0m14:10:17.068606 [debug] [MainThread]: Command end result
[0m14:10:17.095360 [info ] [MainThread]: 
[0m14:10:17.096021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:17.096554 [info ] [MainThread]: 
[0m14:10:17.097078 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:17.098117 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.294845, "process_user_time": 5.478823, "process_kernel_time": 0.278041, "process_mem_max_rss": "283128", "process_in_blocks": "1200", "process_out_blocks": "107392"}
[0m14:10:17.098718 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:17.098611 after 13.30 seconds
[0m14:10:17.099166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7ccfe19a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd781a69fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7cd3a3200>]}
[0m14:10:17.099627 [debug] [MainThread]: Flushing usage events
[0m14:10:19.097149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3257e7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa324cfd4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa324fc8a40>]}


============================== 14:10:19.100261 | 8b540e30-43ef-4a0d-9f3a-3870bd6dfdf3 ==============================
[0m14:10:19.100261 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:19.100967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:19.216567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b540e30-43ef-4a0d-9f3a-3870bd6dfdf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa324c94410>]}
[0m14:10:19.235019 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19052821, "process_user_time": 1.350946, "process_kernel_time": 0.097923, "process_mem_max_rss": "99728", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:19.235599 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:19.235493 after 0.19 seconds
[0m14:10:19.236031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa324dd5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa32699e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa325eaebd0>]}
[0m14:10:19.236477 [debug] [MainThread]: Flushing usage events
[0m22:06:34.876374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e9322c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e9742c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ea3f0b00>]}


============================== 22:06:34.895740 | 0af2afb3-00b9-4e5b-a8b7-64c3f35908cd ==============================
[0m22:06:34.895740 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:34.896415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:35.068811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0af2afb3-00b9-4e5b-a8b7-64c3f35908cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e91677d0>]}
[0m22:06:35.085746 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wrm5mvu7'
[0m22:06:35.086263 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:35.169765 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:35.171362 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:35.203781 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:35.209058 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:35.362047 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:35.362714 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:06:35.363327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0af2afb3-00b9-4e5b-a8b7-64c3f35908cd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e908a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e908b500>]}
[0m22:06:35.363812 [info ] [MainThread]: 
[0m22:06:35.364330 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:35.376047 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5518326, "process_user_time": 1.68341, "process_kernel_time": 0.14329, "process_mem_max_rss": "101528", "process_in_blocks": "8512", "process_out_blocks": "5168"}
[0m22:06:35.376594 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:35.376489 after 0.55 seconds
[0m22:06:35.377066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ea3f0b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e9368170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e948e0f0>]}
[0m22:06:35.377502 [debug] [MainThread]: Flushing usage events
[0m22:06:36.994923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06efe7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06efe76b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06efe4290>]}


============================== 22:06:36.998099 | 5fd591ec-0ed6-49fc-82d6-75c53b90f2c9 ==============================
[0m22:06:36.998099 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:36.998832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:37.232695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0702908f0>]}
[0m22:06:37.294305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06e320770>]}
[0m22:06:37.296146 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:37.322974 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:37.323798 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:37.324358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06efe5490>]}
[0m22:06:38.716229 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:38.716906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0665f7b60>]}
[0m22:06:38.964435 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:38.970096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0665e0470>]}
[0m22:06:39.070566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb066c856d0>]}
[0m22:06:39.071204 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:39.071726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0665fb9b0>]}
[0m22:06:39.073864 [info ] [MainThread]: 
[0m22:06:39.074570 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:39.079600 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:39.117062 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:39.117591 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:39.118033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:39.833584 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:39.836332 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:39.837702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:39.838695 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:39.847875 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.848316 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:39.848710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:39.850219 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.851617 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.852028 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:39.852622 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.853032 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.853395 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:39.854055 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.854996 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:39.855390 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.855778 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:39.856364 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.856788 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:39.858098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:39.864300 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:39.864736 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:39.865109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:39.866162 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.866553 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:39.866992 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:39.877806 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.879331 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:39.880577 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:39.881004 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:39.882144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb066c39eb0>]}
[0m22:06:39.882710 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:39.883120 [debug] [MainThread]: On master: BEGIN
[0m22:06:39.883481 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:39.884206 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:39.884606 [debug] [MainThread]: On master: COMMIT
[0m22:06:39.885006 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:39.885364 [debug] [MainThread]: On master: COMMIT
[0m22:06:39.885972 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:39.886368 [debug] [MainThread]: On master: Close
[0m22:06:39.886912 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:39.887415 [info ] [MainThread]: 
[0m22:06:39.908294 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:39.908978 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:39.909666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:39.910132 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:39.937764 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:39.938595 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:39.974479 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:39.975378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:48.853028 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.853591 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:48.854546 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.855012 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.855433 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:48.856423 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.857816 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.858260 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:48.859322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.867315 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.867829 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:48.868704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.872008 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.872458 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:48.873237 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.890050 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:48.890537 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.890989 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:48.892236 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.898080 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.898549 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:48.899854 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.902338 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:48.903879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0640a6180>]}
[0m22:06:48.904568 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.99s]
[0m22:06:48.905366 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:48.906222 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:48.906799 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:48.907513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:48.908114 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:48.913235 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:48.913915 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:48.951319 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.951927 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260131220648945091"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:48.952393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:48.962031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.970105 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.970571 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:48.971268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.971726 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.972156 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260131220648945091'
      
      
      order by ordinal_position

  
[0m22:06:48.974753 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.980119 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.980574 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:48.983045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.991005 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.991468 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:48.993917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.995697 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.996157 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:06:48.996950 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.016194 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:49.017015 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.017484 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260131220648945091"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260131220648945091"
    )
  
[0m22:06:49.025839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.027737 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:49.028185 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.028591 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:49.035397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.036348 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:49.037048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb026fe2c60>]}
[0m22:06:49.037763 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m22:06:49.038511 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:49.040133 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.040544 [debug] [MainThread]: On master: BEGIN
[0m22:06:49.040960 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:49.041719 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.042154 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.042524 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.042929 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.043510 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.043951 [debug] [MainThread]: On master: Close
[0m22:06:49.044417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:49.044800 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:49.045200 [info ] [MainThread]: 
[0m22:06:49.045749 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.97 seconds (9.97s).
[0m22:06:49.046765 [debug] [MainThread]: Command end result
[0m22:06:49.072996 [info ] [MainThread]: 
[0m22:06:49.073704 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:49.074236 [info ] [MainThread]: 
[0m22:06:49.074784 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:49.075857 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.134117, "process_user_time": 6.068084, "process_kernel_time": 0.298397, "process_mem_max_rss": "280308", "process_in_blocks": "1200", "process_out_blocks": "107432"}
[0m22:06:49.076397 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:49.076293 after 12.13 seconds
[0m22:06:49.076855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06e7f2f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06e4fdbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0270690d0>]}
[0m22:06:49.077282 [debug] [MainThread]: Flushing usage events
[0m22:06:50.858381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6e350140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6e1b8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6e1ba6c0>]}


============================== 22:06:50.861563 | 40be1307-5e64-4be2-9bc8-1254161b9e02 ==============================
[0m22:06:50.861563 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:50.862285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:50.978617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40be1307-5e64-4be2-9bc8-1254161b9e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6ff545c0>]}
[0m22:06:50.997454 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19193503, "process_user_time": 1.380567, "process_kernel_time": 0.095969, "process_mem_max_rss": "99560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:50.998042 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:50.997931 after 0.19 seconds
[0m22:06:50.998475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6e8a03b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6e067290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6e0676b0>]}
[0m22:06:50.998935 [debug] [MainThread]: Flushing usage events
[0m06:21:46.751713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72d348d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72b67e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72b62b7a0>]}


============================== 06:21:46.767803 | ec5ff1f2-6f8b-4dca-ab7b-c65bc42ffa98 ==============================
[0m06:21:46.767803 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:21:46.768473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:21:46.953703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec5ff1f2-6f8b-4dca-ab7b-c65bc42ffa98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72aff7b00>]}
[0m06:21:46.968897 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1kxrcl9f'
[0m06:21:46.969353 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:21:47.162354 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:21:47.163813 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:21:47.217202 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:21:47.222375 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:21:47.436352 [info ] [MainThread]: Installed from version 1.2.0
[0m06:21:47.436956 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:21:47.437503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ec5ff1f2-6f8b-4dca-ab7b-c65bc42ffa98', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72b06fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72af93a40>]}
[0m06:21:47.437965 [info ] [MainThread]: 
[0m06:21:47.438450 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:21:47.447378 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.74737006, "process_user_time": 1.616336, "process_kernel_time": 0.139683, "process_mem_max_rss": "101268", "process_in_blocks": "8504", "process_out_blocks": "5168"}
[0m06:21:47.447933 [debug] [MainThread]: Command `dbt deps` succeeded at 06:21:47.447834 after 0.75 seconds
[0m06:21:47.448352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72bd00470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72af58e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72af587d0>]}
[0m06:21:47.448802 [debug] [MainThread]: Flushing usage events
[0m06:21:49.103089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9516b1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9521aa420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb951eb2960>]}


============================== 06:21:49.106076 | a982fe28-7d57-4a0d-a4f1-19b2a4c99a40 ==============================
[0m06:21:49.106076 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:21:49.106748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:21:49.336056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9499c9f10>]}
[0m06:21:49.397345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb951133770>]}
[0m06:21:49.399125 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:21:49.422596 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:21:49.423299 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:21:49.423858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb949865df0>]}
[0m06:21:50.810467 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:21:50.811103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9490ed580>]}
[0m06:21:51.043698 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:21:51.049124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9490ee450>]}
[0m06:21:51.141735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb949197dd0>]}
[0m06:21:51.142247 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:21:51.142807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9513c02c0>]}
[0m06:21:51.144782 [info ] [MainThread]: 
[0m06:21:51.145477 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:21:51.150257 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:21:51.185875 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:21:51.186320 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:21:51.186732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:21:51.738819 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:21:51.740442 [debug] [ThreadPool]: On list_petro: Close
[0m06:21:51.741268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:21:51.741824 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:21:51.749247 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:21:51.749684 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:21:51.750055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:21:51.750973 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:51.752259 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:21:51.752672 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:21:51.753248 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:51.753652 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:21:51.754011 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:21:51.754612 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:51.755532 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:21:51.755923 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:21:51.756289 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:21:51.756872 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:51.757261 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:21:51.758459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:21:51.764190 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:21:51.764609 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:21:51.764969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:21:51.765838 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:51.766221 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:21:51.766640 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:21:51.776783 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:51.778107 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:21:51.779285 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:21:51.779698 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:21:51.780756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb951332e10>]}
[0m06:21:51.781260 [debug] [MainThread]: Using duckdb connection "master"
[0m06:21:51.781673 [debug] [MainThread]: On master: BEGIN
[0m06:21:51.782036 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:21:51.782671 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:21:51.783067 [debug] [MainThread]: On master: COMMIT
[0m06:21:51.783452 [debug] [MainThread]: Using duckdb connection "master"
[0m06:21:51.783813 [debug] [MainThread]: On master: COMMIT
[0m06:21:51.784377 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:21:51.784789 [debug] [MainThread]: On master: Close
[0m06:21:51.785261 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:21:51.785730 [info ] [MainThread]: 
[0m06:21:51.804455 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:21:51.805028 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:21:51.805600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:21:51.806035 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:21:51.832807 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:21:51.833560 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:21:51.868835 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:21:51.869584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:00.698232 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:00.698801 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:22:00.699704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.700147 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:00.700593 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:22:00.701554 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.702922 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:00.703364 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:22:00.704536 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.712557 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:00.713017 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:22:00.713822 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.716822 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:00.717266 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:22:00.717985 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.734727 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:22:00.735193 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:00.735644 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:22:00.737861 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.743549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:00.744002 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:22:00.745412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.747777 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:22:00.749319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb952d47770>]}
[0m06:22:00.750027 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.94s]
[0m06:22:00.750806 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:22:00.751611 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:22:00.752160 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:22:00.752924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:22:00.753363 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:22:00.758299 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:22:00.758955 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:22:00.795067 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:00.795567 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260201062200789067"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:22:00.796016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:00.803112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.810587 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:00.811033 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:22:00.811669 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.812095 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:00.812535 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260201062200789067'
      
      
      order by ordinal_position

  
[0m06:22:00.814905 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.819973 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:00.820455 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:22:00.822689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.830281 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:00.830778 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:22:00.833068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.834734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:00.835174 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:22:00.835907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.854123 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:22:00.854835 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:00.855285 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260201062200789067"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260201062200789067"
    )
  
[0m06:22:00.862886 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.864750 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:22:00.865185 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:00.865614 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:22:00.871910 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.872790 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:22:00.873462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90dba7410>]}
[0m06:22:00.874117 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m06:22:00.874869 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:22:00.876449 [debug] [MainThread]: Using duckdb connection "master"
[0m06:22:00.876857 [debug] [MainThread]: On master: BEGIN
[0m06:22:00.877226 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:22:00.877898 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:22:00.878300 [debug] [MainThread]: On master: COMMIT
[0m06:22:00.878728 [debug] [MainThread]: Using duckdb connection "master"
[0m06:22:00.879093 [debug] [MainThread]: On master: COMMIT
[0m06:22:00.879698 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:22:00.880087 [debug] [MainThread]: On master: Close
[0m06:22:00.880568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:22:00.880922 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:22:00.881310 [info ] [MainThread]: 
[0m06:22:00.881837 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.74 seconds (9.74s).
[0m06:22:00.882834 [debug] [MainThread]: Command end result
[0m06:22:00.908306 [info ] [MainThread]: 
[0m06:22:00.908921 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:22:00.909448 [info ] [MainThread]: 
[0m06:22:00.909975 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:22:00.910951 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.859628, "process_user_time": 5.812298, "process_kernel_time": 0.287915, "process_mem_max_rss": "282560", "process_in_blocks": "1200", "process_out_blocks": "107408"}
[0m06:22:00.911524 [debug] [MainThread]: Command `dbt run` succeeded at 06:22:00.911380 after 11.86 seconds
[0m06:22:00.911955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9532d3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb950fa9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95146ba10>]}
[0m06:22:00.912375 [debug] [MainThread]: Flushing usage events
[0m06:22:02.659806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0531eba930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532932930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0530bc6b40>]}


============================== 06:22:02.662785 | 0b5213ed-c2ad-4cf2-9cc0-53946a35befc ==============================
[0m06:22:02.662785 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:22:02.663442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:22:02.777409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b5213ed-c2ad-4cf2-9cc0-53946a35befc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0530b4a2a0>]}
[0m06:22:02.796262 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18777582, "process_user_time": 1.344874, "process_kernel_time": 0.094991, "process_mem_max_rss": "99628", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:22:02.796870 [debug] [MainThread]: Command `dbt clean` succeeded at 06:22:02.796768 after 0.19 seconds
[0m06:22:02.797284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0531051ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0531625550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0531626c90>]}
[0m06:22:02.797722 [debug] [MainThread]: Flushing usage events
[0m14:11:50.087165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8da375580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8da3742f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8da376d50>]}


============================== 14:11:50.103739 | 5e957892-148b-48a6-8a59-ae6d2997fe2f ==============================
[0m14:11:50.103739 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:11:50.104474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:11:50.264862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e957892-148b-48a6-8a59-ae6d2997fe2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8dc026f90>]}
[0m14:11:50.280733 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_sn7cp2m'
[0m14:11:50.281265 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:11:50.504532 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:11:50.506591 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:11:50.589807 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:11:50.595705 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:11:50.954793 [info ] [MainThread]: Installed from version 1.2.0
[0m14:11:50.955450 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:11:50.956001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5e957892-148b-48a6-8a59-ae6d2997fe2f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8da15bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8da0a5820>]}
[0m14:11:50.956469 [info ] [MainThread]: 
[0m14:11:50.956938 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:11:50.969729 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9354542, "process_user_time": 1.676459, "process_kernel_time": 0.136362, "process_mem_max_rss": "101236", "process_in_blocks": "8504", "process_out_blocks": "5168"}
[0m14:11:50.970303 [debug] [MainThread]: Command `dbt deps` succeeded at 14:11:50.970199 after 0.94 seconds
[0m14:11:50.970733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8de9bb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8dc026f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8dad48d40>]}
[0m14:11:50.971175 [debug] [MainThread]: Flushing usage events
[0m14:11:52.812914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ae0e4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ad8c9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99adc9ddf0>]}


============================== 14:11:52.816208 | d1ef84a2-0f68-4fbf-8d20-1b8fb21a3985 ==============================
[0m14:11:52.816208 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:11:52.816871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:11:53.055041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ad6686e0>]}
[0m14:11:53.117141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ae4ae6c0>]}
[0m14:11:53.119060 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:11:53.143876 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:11:53.144689 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:11:53.145273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a6157410>]}
[0m14:11:54.532508 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:11:54.533184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a58faf60>]}
[0m14:11:54.777455 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:11:54.782948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a58f90d0>]}
[0m14:11:54.877117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a5976180>]}
[0m14:11:54.877673 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:11:54.878222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a58d6e70>]}
[0m14:11:54.880264 [info ] [MainThread]: 
[0m14:11:54.881007 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:11:54.885795 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:11:54.922033 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:11:54.922527 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:11:54.922926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:55.658069 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:11:55.660002 [debug] [ThreadPool]: On list_petro: Close
[0m14:11:55.661192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:11:55.662102 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:11:55.671164 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:11:55.671583 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:11:55.671961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:55.673370 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:55.674704 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:11:55.675112 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:11:55.675703 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:55.676105 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:11:55.676468 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:11:55.677087 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:55.678009 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:11:55.678393 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:11:55.678753 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:11:55.679347 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:55.679740 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:11:55.680947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:11:55.686992 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:11:55.687396 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:11:55.687840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:55.688546 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:55.688924 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:11:55.689321 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:11:55.700123 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:55.701603 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:11:55.702820 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:11:55.703260 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:11:55.704401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ad6ac920>]}
[0m14:11:55.704930 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:55.705413 [debug] [MainThread]: On master: BEGIN
[0m14:11:55.705781 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:55.706501 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:11:55.706897 [debug] [MainThread]: On master: COMMIT
[0m14:11:55.707298 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:55.707665 [debug] [MainThread]: On master: COMMIT
[0m14:11:55.708293 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:11:55.708695 [debug] [MainThread]: On master: Close
[0m14:11:55.709255 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:11:55.709743 [info ] [MainThread]: 
[0m14:11:55.727411 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:11:55.728070 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:11:55.728751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:11:55.729213 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:11:55.756869 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:11:55.757711 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:11:55.793544 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:11:55.794382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:07.078590 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:07.079172 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:12:07.079911 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.080399 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:07.080820 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:12:07.081845 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.083259 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:07.083720 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:12:07.084904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.093414 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:07.093943 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:12:07.095029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.098369 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:07.098817 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:12:07.099616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.116581 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:12:07.117115 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:07.117535 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:12:07.119584 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.125776 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:07.126275 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:12:07.127676 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.130249 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:12:07.131823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a5771730>]}
[0m14:12:07.132582 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.40s]
[0m14:12:07.133407 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:12:07.134367 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:12:07.135098 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:12:07.135784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:12:07.136263 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:12:07.141602 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:12:07.142308 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:12:07.179440 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:07.180029 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260201141207173339"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:12:07.180479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:07.187955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.195999 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:07.196475 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:12:07.197248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.197687 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:07.198153 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260201141207173339'
      
      
      order by ordinal_position

  
[0m14:12:07.200994 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.206581 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:07.207087 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:12:07.209897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.218194 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:07.218683 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:12:07.221623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.223570 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:07.224061 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:12:07.224862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.244780 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:12:07.245639 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:07.246149 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260201141207173339"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260201141207173339"
    )
  
[0m14:12:07.255015 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.257217 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:12:07.257720 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:07.258179 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:12:07.264653 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.265794 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:12:07.266576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99621ef470>]}
[0m14:12:07.267324 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m14:12:07.268221 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:12:07.269933 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:07.270398 [debug] [MainThread]: On master: BEGIN
[0m14:12:07.270773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:12:07.271664 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:12:07.272126 [debug] [MainThread]: On master: COMMIT
[0m14:12:07.272509 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:07.272879 [debug] [MainThread]: On master: COMMIT
[0m14:12:07.273541 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:12:07.273937 [debug] [MainThread]: On master: Close
[0m14:12:07.274481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:07.274848 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:12:07.275299 [info ] [MainThread]: 
[0m14:12:07.275823 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.39 seconds (12.39s).
[0m14:12:07.276862 [debug] [MainThread]: Command end result
[0m14:12:07.304572 [info ] [MainThread]: 
[0m14:12:07.305313 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:12:07.305886 [info ] [MainThread]: 
[0m14:12:07.306480 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:12:07.307563 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.548134, "process_user_time": 6.116972, "process_kernel_time": 0.302394, "process_mem_max_rss": "279136", "process_in_blocks": "1200", "process_out_blocks": "107400"}
[0m14:12:07.308170 [debug] [MainThread]: Command `dbt run` succeeded at 14:12:07.308054 after 14.55 seconds
[0m14:12:07.308630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99adc42930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ad6ff6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9962220560>]}
[0m14:12:07.309101 [debug] [MainThread]: Flushing usage events
[0m14:12:09.278126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fa5eee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fafd8290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fa5eef60>]}


============================== 14:12:09.281411 | 9915b929-0896-42fc-abab-8bb3a217eddb ==============================
[0m14:12:09.281411 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:12:09.282155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:12:09.398037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9915b929-0896-42fc-abab-8bb3a217eddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fa5222a0>]}
[0m14:12:09.416369 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19143593, "process_user_time": 1.381413, "process_kernel_time": 0.112952, "process_mem_max_rss": "100228", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:12:09.416918 [debug] [MainThread]: Command `dbt clean` succeeded at 14:12:09.416814 after 0.19 seconds
[0m14:12:09.417389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fc7b0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fa5727b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fdb1b5f0>]}
[0m14:12:09.417807 [debug] [MainThread]: Flushing usage events
[0m22:07:00.671469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655af074d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655c705e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655a65e120>]}


============================== 22:07:00.688568 | fb5ec63e-7180-4b5c-8616-381f1795f949 ==============================
[0m22:07:00.688568 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:00.689298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:00.848529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb5ec63e-7180-4b5c-8616-381f1795f949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655a4db6b0>]}
[0m22:07:00.863694 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_72fk9gy'
[0m22:07:00.864184 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:07:00.977278 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:07:00.978994 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:07:01.024809 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:07:01.030271 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:07:01.122520 [info ] [MainThread]: Installed from version 1.2.0
[0m22:07:01.123110 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:07:01.123713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fb5ec63e-7180-4b5c-8616-381f1795f949', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655a390950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655a391a90>]}
[0m22:07:01.124201 [info ] [MainThread]: 
[0m22:07:01.124710 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:07:01.135181 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.51495135, "process_user_time": 1.63898, "process_kernel_time": 0.147538, "process_mem_max_rss": "101404", "process_in_blocks": "8512", "process_out_blocks": "5176"}
[0m22:07:01.135787 [debug] [MainThread]: Command `dbt deps` succeeded at 22:07:01.135683 after 0.52 seconds
[0m22:07:01.136302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655dc172f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655a4a7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655a4a7d40>]}
[0m22:07:01.136785 [debug] [MainThread]: Flushing usage events
[0m22:07:02.750465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe048a43320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe045856060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0476f60f0>]}


============================== 22:07:02.753847 | 97eeec6f-1c91-4ef8-9b81-3b41dca1ed78 ==============================
[0m22:07:02.753847 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:02.754567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:02.992921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe048a43320>]}
[0m22:07:03.057205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0469d9e20>]}
[0m22:07:03.059100 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:07:03.077069 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:07:03.077794 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:07:03.078331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe04560f3e0>]}
[0m22:07:04.501358 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:07:04.502028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe03d546750>]}
[0m22:07:04.741868 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:07:04.747281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe03d5104a0>]}
[0m22:07:04.834811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe03d750590>]}
[0m22:07:04.835398 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:07:04.835940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe03de60080>]}
[0m22:07:04.837972 [info ] [MainThread]: 
[0m22:07:04.838702 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:07:04.843507 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:07:04.881606 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:07:04.882069 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:07:04.882512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:05.618837 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:07:05.620594 [debug] [ThreadPool]: On list_petro: Close
[0m22:07:05.621821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:07:05.623208 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:07:05.634324 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:05.634761 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:07:05.635166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:05.636169 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:05.637513 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:05.637904 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:07:05.638536 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:05.638919 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:05.639312 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:07:05.639950 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:05.640890 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:05.641305 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:05.641664 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:05.642263 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:05.642658 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:07:05.643990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:07:05.650139 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:05.650546 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:07:05.650907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:05.651622 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:05.652012 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:05.652421 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:07:05.663579 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:05.664933 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:07:05.666183 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:07:05.666588 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:07:05.667658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe03d7529f0>]}
[0m22:07:05.668202 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:05.668594 [debug] [MainThread]: On master: BEGIN
[0m22:07:05.668959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:05.669641 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:05.670038 [debug] [MainThread]: On master: COMMIT
[0m22:07:05.670446 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:05.670809 [debug] [MainThread]: On master: COMMIT
[0m22:07:05.671415 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:05.671806 [debug] [MainThread]: On master: Close
[0m22:07:05.672331 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:07:05.672791 [info ] [MainThread]: 
[0m22:07:05.683347 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:07:05.683965 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:07:05.684583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:07:05.685034 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:07:05.712261 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:07:05.713003 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:07:05.748862 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:07:05.749613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:14.677739 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:14.678332 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:14.679054 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.679518 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:14.679934 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:14.680921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.682279 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:14.682717 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:14.683963 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.692138 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:14.692597 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:14.693434 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.696450 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:14.696891 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:14.697611 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.714298 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:14.714766 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:14.715201 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:14.717397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.723393 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:14.723854 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:14.725302 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.727994 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:14.730920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe04732b860>]}
[0m22:07:14.732345 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.04s]
[0m22:07:14.733632 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:14.735725 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:14.736737 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:14.737376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:14.737810 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:14.743608 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:14.744329 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:14.788462 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:14.789385 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260201220714777639"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:14.790028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:14.801582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.810814 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:14.811331 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:14.812144 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.812598 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:14.813025 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260201220714777639'
      
      
      order by ordinal_position

  
[0m22:07:14.815740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.821544 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:14.822006 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:14.824601 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.832821 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:14.833309 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:14.835800 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.837522 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:14.837964 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:07:14.838695 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.858316 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:14.859141 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:14.859597 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260201220714777639"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260201220714777639"
    )
  
[0m22:07:14.869126 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.871104 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:14.871578 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:14.871988 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:14.879171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.880180 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:14.880932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff9975760>]}
[0m22:07:14.881735 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.14s]
[0m22:07:14.882603 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:14.884596 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:14.885022 [debug] [MainThread]: On master: BEGIN
[0m22:07:14.885452 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:14.886228 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:14.886637 [debug] [MainThread]: On master: COMMIT
[0m22:07:14.887014 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:14.887423 [debug] [MainThread]: On master: COMMIT
[0m22:07:14.887990 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:14.888449 [debug] [MainThread]: On master: Close
[0m22:07:14.888952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:14.889356 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:14.889777 [info ] [MainThread]: 
[0m22:07:14.890296 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.05 seconds (10.05s).
[0m22:07:14.891298 [debug] [MainThread]: Command end result
[0m22:07:14.919750 [info ] [MainThread]: 
[0m22:07:14.920375 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:14.920838 [info ] [MainThread]: 
[0m22:07:14.921337 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:14.922465 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.225846, "process_user_time": 6.167887, "process_kernel_time": 0.315015, "process_mem_max_rss": "317664", "process_in_blocks": "1200", "process_out_blocks": "107448"}
[0m22:07:14.923033 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:14.922925 after 12.23 seconds
[0m22:07:14.923517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0455258e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0459dbcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff99ae3c0>]}
[0m22:07:14.923961 [debug] [MainThread]: Flushing usage events
[0m22:07:16.987815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f728b0be450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f728a83b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f728a30da30>]}


============================== 22:07:16.991255 | f20827fd-0cf6-42e8-957a-65c5fcb15ee5 ==============================
[0m22:07:16.991255 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:16.991973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:07:17.110729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f20827fd-0cf6-42e8-957a-65c5fcb15ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f728a83b350>]}
[0m22:07:17.134529 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20171516, "process_user_time": 1.403956, "process_kernel_time": 0.115831, "process_mem_max_rss": "99780", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:17.135172 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:17.135040 after 0.20 seconds
[0m22:07:17.135645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7289ef2840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f728a2526c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7289cdf7a0>]}
[0m22:07:17.136122 [debug] [MainThread]: Flushing usage events
[0m06:29:29.200885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78f6f6b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78ee032f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78f073a40>]}


============================== 06:29:29.220289 | 54df96c2-86e1-436f-b93f-fe85321bc14a ==============================
[0m06:29:29.220289 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:29:29.220973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:29:29.448248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54df96c2-86e1-436f-b93f-fe85321bc14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78ea4f560>]}
[0m06:29:29.463250 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-y0t6bwin'
[0m06:29:29.463692 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:29:29.631742 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:29:29.632998 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:29:29.676295 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:29:29.681366 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:29:29.769874 [info ] [MainThread]: Installed from version 1.2.0
[0m06:29:29.770435 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:29:29.771004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '54df96c2-86e1-436f-b93f-fe85321bc14a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78ea0c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78ea0c260>]}
[0m06:29:29.771457 [info ] [MainThread]: 
[0m06:29:29.771970 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:29:29.785034 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6350876, "process_user_time": 1.616727, "process_kernel_time": 0.14333, "process_mem_max_rss": "101248", "process_in_blocks": "8512", "process_out_blocks": "5176"}
[0m06:29:29.785581 [debug] [MainThread]: Command `dbt deps` succeeded at 06:29:29.785478 after 0.64 seconds
[0m06:29:29.786012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78ee032f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78ea4fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78ea4f560>]}
[0m06:29:29.786431 [debug] [MainThread]: Flushing usage events
[0m06:29:31.382544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc57fe840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc5696300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc8c870e0>]}


============================== 06:29:31.385471 | 53403505-d2cb-4152-b263-90ba883e3a87 ==============================
[0m06:29:31.385471 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:29:31.386132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:29:31.615318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafbe1d4650>]}
[0m06:29:31.676578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc641e420>]}
[0m06:29:31.678211 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:29:31.708388 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:29:31.709114 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:29:31.709633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc55918b0>]}
[0m06:29:33.102410 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:29:33.103073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafbd90b2f0>]}
[0m06:29:33.334897 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:29:33.340162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafbd70f320>]}
[0m06:29:33.436249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafbd98bcb0>]}
[0m06:29:33.436738 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:29:33.437298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafbe102cc0>]}
[0m06:29:33.439235 [info ] [MainThread]: 
[0m06:29:33.439929 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:29:33.444699 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:29:33.480587 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:29:33.481068 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:29:33.481492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:29:33.895256 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:33.897391 [debug] [ThreadPool]: On list_petro: Close
[0m06:29:33.898518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:29:33.899308 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:29:33.907190 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:33.907617 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:29:33.908015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:33.909393 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:33.910740 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:33.911183 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:29:33.911771 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:33.912176 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:33.912545 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:29:33.913173 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:33.914092 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:29:33.914483 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:33.914848 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:29:33.915438 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:33.915830 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:29:33.917063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:29:33.923004 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:29:33.923409 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:29:33.923768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:33.924428 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:33.924812 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:29:33.925240 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:29:33.935550 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:33.936882 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:29:33.938087 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:29:33.938486 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:29:33.939604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc75c6660>]}
[0m06:29:33.940224 [debug] [MainThread]: Using duckdb connection "master"
[0m06:29:33.940607 [debug] [MainThread]: On master: BEGIN
[0m06:29:33.940993 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:29:33.941660 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:29:33.942087 [debug] [MainThread]: On master: COMMIT
[0m06:29:33.942459 [debug] [MainThread]: Using duckdb connection "master"
[0m06:29:33.942828 [debug] [MainThread]: On master: COMMIT
[0m06:29:33.943443 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:29:33.943837 [debug] [MainThread]: On master: Close
[0m06:29:33.944345 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:29:33.944823 [info ] [MainThread]: 
[0m06:29:33.967193 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:29:33.967756 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:29:33.968411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:29:33.968838 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:29:33.995624 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:29:33.996350 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:29:34.031481 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:29:34.032207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:43.898873 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:43.899445 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:29:43.900172 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:43.900620 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:43.901077 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:29:43.902023 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:43.903372 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:43.903821 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:29:43.905076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:43.912917 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:43.913408 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:29:43.914250 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:43.917283 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:43.917732 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:29:43.918540 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:43.935298 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:29:43.935764 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:43.936210 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:29:43.937457 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:43.943220 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:43.943682 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:29:43.944846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:43.947303 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:29:43.948824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafbd70e7b0>]}
[0m06:29:43.949529 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.98s]
[0m06:29:43.950310 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:29:43.951126 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:29:43.951870 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:29:43.952552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:29:43.953037 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:29:43.957982 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:29:43.958643 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:29:43.994786 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:43.995290 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260202062943988635"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:29:43.995732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:44.002407 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:44.009777 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:44.010251 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:29:44.010916 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:44.011377 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:44.011808 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260202062943988635'
      
      
      order by ordinal_position

  
[0m06:29:44.014141 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:44.019277 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:44.019739 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:29:44.022088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:44.029780 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:44.030262 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:29:44.032529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:44.034221 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:44.034669 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:29:44.035403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:44.053797 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:29:44.054493 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:44.054944 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260202062943988635"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260202062943988635"
    )
  
[0m06:29:44.062297 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:44.064054 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:29:44.064493 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:44.064896 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:29:44.070916 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:44.071789 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:29:44.072451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf79fff410>]}
[0m06:29:44.073117 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m06:29:44.073912 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:29:44.075543 [debug] [MainThread]: Using duckdb connection "master"
[0m06:29:44.075990 [debug] [MainThread]: On master: BEGIN
[0m06:29:44.076383 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:29:44.077077 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:29:44.077484 [debug] [MainThread]: On master: COMMIT
[0m06:29:44.077860 [debug] [MainThread]: Using duckdb connection "master"
[0m06:29:44.078275 [debug] [MainThread]: On master: COMMIT
[0m06:29:44.078874 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:29:44.079319 [debug] [MainThread]: On master: Close
[0m06:29:44.079784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:29:44.080206 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:29:44.080625 [info ] [MainThread]: 
[0m06:29:44.081133 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.64 seconds (10.64s).
[0m06:29:44.082069 [debug] [MainThread]: Command end result
[0m06:29:44.107816 [info ] [MainThread]: 
[0m06:29:44.108395 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:29:44.108860 [info ] [MainThread]: 
[0m06:29:44.109357 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:29:44.110285 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.78006, "process_user_time": 5.282296, "process_kernel_time": 0.306901, "process_mem_max_rss": "278488", "process_in_blocks": "1200", "process_out_blocks": "107408"}
[0m06:29:44.110826 [debug] [MainThread]: Command `dbt run` succeeded at 06:29:44.110724 after 12.78 seconds
[0m06:29:44.111285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc5696300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf79fe5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf79f86120>]}
[0m06:29:44.111710 [debug] [MainThread]: Flushing usage events
[0m06:29:45.757702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc42b2af080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc42ad40a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc42bf11940>]}


============================== 06:29:45.760701 | d4d4e4a7-114d-4bbd-beb4-db96978176f7 ==============================
[0m06:29:45.760701 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:29:45.761412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:29:45.876627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4d4e4a7-114d-4bbd-beb4-db96978176f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc42ac06f90>]}
[0m06:29:45.894504 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18864508, "process_user_time": 1.326008, "process_kernel_time": 0.107919, "process_mem_max_rss": "99828", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:29:45.895057 [debug] [MainThread]: Command `dbt clean` succeeded at 06:29:45.894928 after 0.19 seconds
[0m06:29:45.895471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc42ac64ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc42ab256d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc42aa2f440>]}
[0m06:29:45.895878 [debug] [MainThread]: Flushing usage events
[0m14:21:50.485683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75fe05b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75fdd181d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75fe242330>]}


============================== 14:21:50.504105 | 6b0fff8c-732c-41fd-91aa-1d36e2f2cc34 ==============================
[0m14:21:50.504105 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:21:50.504803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:21:50.677918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b0fff8c-732c-41fd-91aa-1d36e2f2cc34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75fdb9ee40>]}
[0m14:21:50.694185 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-npgqq0xy'
[0m14:21:50.694751 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:21:50.892537 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:21:50.894621 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:21:50.950370 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:21:50.956420 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:21:51.158465 [info ] [MainThread]: Installed from version 1.2.0
[0m14:21:51.159131 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:21:51.159714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6b0fff8c-732c-41fd-91aa-1d36e2f2cc34', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75fdb9f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75fdb9eb70>]}
[0m14:21:51.160189 [info ] [MainThread]: 
[0m14:21:51.160712 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:21:51.173451 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7396881, "process_user_time": 1.725126, "process_kernel_time": 0.152745, "process_mem_max_rss": "101404", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m14:21:51.174132 [debug] [MainThread]: Command `dbt deps` succeeded at 14:21:51.174023 after 0.74 seconds
[0m14:21:51.174616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75fe5537a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76010e3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75fec250a0>]}
[0m14:21:51.175083 [debug] [MainThread]: Flushing usage events
[0m14:21:53.060319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5d0ef500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5d473650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5d0ed550>]}


============================== 14:21:53.063672 | f66f3295-49f4-4b2c-b9b8-d407afa0e2d2 ==============================
[0m14:21:53.063672 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:21:53.064424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:21:53.301449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5c5de060>]}
[0m14:21:53.364381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5c3471a0>]}
[0m14:21:53.366394 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:21:53.393980 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:21:53.394852 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:21:53.395450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5cac9cd0>]}
[0m14:21:54.798548 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:21:54.799269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa54e4e930>]}
[0m14:21:55.070870 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:21:55.076800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa547fcf20>]}
[0m14:21:55.175549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa54e9aa50>]}
[0m14:21:55.176177 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:21:55.176700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5501a960>]}
[0m14:21:55.178827 [info ] [MainThread]: 
[0m14:21:55.179576 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:21:55.184699 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:21:55.223436 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:21:55.223997 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:21:55.224380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:55.915396 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:21:55.917489 [debug] [ThreadPool]: On list_petro: Close
[0m14:21:55.918650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:21:55.919406 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:21:55.927208 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:21:55.927670 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:21:55.928055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:55.929233 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:21:55.930638 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:21:55.931050 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:21:55.931671 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:21:55.932056 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:21:55.932420 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:21:55.933059 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:21:55.933988 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:21:55.934373 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:21:55.934760 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:21:55.935326 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:21:55.935751 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:21:55.937157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:21:55.943613 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:21:55.944043 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:21:55.944408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:55.945247 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:21:55.945680 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:21:55.946087 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:21:55.957026 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:21:55.958796 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:21:55.960163 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:21:55.960579 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:21:55.961872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5e3ce7e0>]}
[0m14:21:55.962403 [debug] [MainThread]: Using duckdb connection "master"
[0m14:21:55.962840 [debug] [MainThread]: On master: BEGIN
[0m14:21:55.963216 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:21:55.964049 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:21:55.964449 [debug] [MainThread]: On master: COMMIT
[0m14:21:55.964855 [debug] [MainThread]: Using duckdb connection "master"
[0m14:21:55.965218 [debug] [MainThread]: On master: COMMIT
[0m14:21:55.965831 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:21:55.966232 [debug] [MainThread]: On master: Close
[0m14:21:55.966800 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:21:55.967280 [info ] [MainThread]: 
[0m14:21:55.977765 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:21:55.978458 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:21:55.979191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:21:55.979816 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:21:56.007818 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:21:56.008754 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:21:56.044948 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:21:56.045892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:05.759357 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:05.760001 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:22:05.760876 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.761329 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:05.761799 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:22:05.762892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.764396 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:05.764880 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:22:05.766240 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.774756 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:05.775266 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:22:05.776219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.779563 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:05.780055 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:22:05.780985 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.798451 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:22:05.799070 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:05.799501 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:22:05.801912 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.808499 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:05.809046 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:22:05.810628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.813261 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:22:05.814865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa544b9f10>]}
[0m14:22:05.815588 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.83s]
[0m14:22:05.816436 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:22:05.817299 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:22:05.817914 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:22:05.818573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:22:05.819074 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:22:05.824939 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:22:05.825726 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:22:05.863747 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:05.864371 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260202142205857287"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:22:05.864861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:05.872892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.881659 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:05.882222 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:22:05.883074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.883512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:05.883965 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260202142205857287'
      
      
      order by ordinal_position

  
[0m14:22:05.886814 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.892962 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:05.893490 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:22:05.896403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.905104 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:05.905669 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:22:05.909052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.910965 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:05.911429 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:22:05.912282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.932205 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:22:05.933087 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:05.933554 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260202142205857287"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260202142205857287"
    )
  
[0m14:22:05.942353 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.944413 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:22:05.944903 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:05.945318 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:22:05.952571 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.953711 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:22:05.954458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa11227710>]}
[0m14:22:05.955170 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.14s]
[0m14:22:05.955971 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:22:05.957393 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:05.957856 [debug] [MainThread]: On master: BEGIN
[0m14:22:05.958236 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:22:05.959120 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:22:05.959531 [debug] [MainThread]: On master: COMMIT
[0m14:22:05.959953 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:05.960318 [debug] [MainThread]: On master: COMMIT
[0m14:22:05.960955 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:22:05.961355 [debug] [MainThread]: On master: Close
[0m14:22:05.961907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:05.962273 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:22:05.962707 [info ] [MainThread]: 
[0m14:22:05.963236 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.78 seconds (10.78s).
[0m14:22:05.964268 [debug] [MainThread]: Command end result
[0m14:22:05.991390 [info ] [MainThread]: 
[0m14:22:05.992151 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:05.992709 [info ] [MainThread]: 
[0m14:22:05.993242 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:22:05.994342 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.988032, "process_user_time": 5.537238, "process_kernel_time": 0.30061, "process_mem_max_rss": "297532", "process_in_blocks": "1200", "process_out_blocks": "107392"}
[0m14:22:05.994934 [debug] [MainThread]: Command `dbt run` succeeded at 14:22:05.994826 after 12.99 seconds
[0m14:22:05.995383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5c5dd700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa609bb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa54605c10>]}
[0m14:22:05.995850 [debug] [MainThread]: Flushing usage events
[0m14:22:08.094102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc8aeaea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bca92eff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcacf6000>]}


============================== 14:22:08.097702 | 7b237a13-2bd7-4461-b532-414e0598f457 ==============================
[0m14:22:08.097702 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:22:08.098368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:22:08.217820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b237a13-2bd7-4461-b532-414e0598f457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bca950470>]}
[0m14:22:08.237619 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1982405, "process_user_time": 1.436372, "process_kernel_time": 0.11703, "process_mem_max_rss": "99640", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:22:08.238215 [debug] [MainThread]: Command `dbt clean` succeeded at 14:22:08.238111 after 0.20 seconds
[0m14:22:08.238914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc8b95820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc8a6ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc8a6e5d0>]}
[0m14:22:08.239360 [debug] [MainThread]: Flushing usage events
[0m06:21:57.308166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116b008ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1168f20b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1168f22db0>]}


============================== 06:21:57.325484 | 85a637e2-ae4f-43e5-bf4e-f34f0df7e73d ==============================
[0m06:21:57.325484 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:21:57.326156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:21:57.499350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85a637e2-ae4f-43e5-bf4e-f34f0df7e73d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1169d90e90>]}
[0m06:21:57.513914 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mpmdf8jl'
[0m06:21:57.514389 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:21:57.598471 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:21:57.599646 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:21:57.651457 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:21:57.656468 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:21:57.730215 [info ] [MainThread]: Installed from version 1.2.0
[0m06:21:57.730706 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:21:57.731256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '85a637e2-ae4f-43e5-bf4e-f34f0df7e73d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1168f66d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1168c5bb90>]}
[0m06:21:57.731695 [info ] [MainThread]: 
[0m06:21:57.732179 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:21:57.743548 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4865415, "process_user_time": 1.612919, "process_kernel_time": 0.14672, "process_mem_max_rss": "101112", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m06:21:57.744099 [debug] [MainThread]: Command `dbt deps` succeeded at 06:21:57.743994 after 0.49 seconds
[0m06:21:57.744519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1169a0d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116908a180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1168f670b0>]}
[0m06:21:57.744922 [debug] [MainThread]: Flushing usage events
[0m06:21:59.305233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763a6b9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7639eb2870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7639bbb770>]}


============================== 06:21:59.308259 | c984a017-f346-483d-abcc-6160a67a6bde ==============================
[0m06:21:59.308259 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:21:59.308925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:21:59.538102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763b29c590>]}
[0m06:21:59.599315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7639977770>]}
[0m06:21:59.600989 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:21:59.626466 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:21:59.627186 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:21:59.627706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7631e2b9e0>]}
[0m06:22:01.012066 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:22:01.012738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76393c7fb0>]}
[0m06:22:01.247468 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:22:01.252890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76316bec90>]}
[0m06:22:01.347673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763177f230>]}
[0m06:22:01.348219 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:22:01.348689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7631ee4290>]}
[0m06:22:01.350679 [info ] [MainThread]: 
[0m06:22:01.351391 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:22:01.356132 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:22:01.392056 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:22:01.392494 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:22:01.392884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:22:01.800673 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:01.802576 [debug] [ThreadPool]: On list_petro: Close
[0m06:22:01.803588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:22:01.804280 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:22:01.812759 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:22:01.813266 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:22:01.813740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:22:01.814817 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:01.816178 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:22:01.816565 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:22:01.817166 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:01.817555 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:22:01.817919 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:22:01.818540 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:01.819465 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:22:01.819853 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:22:01.820238 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:22:01.820854 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:01.821297 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:22:01.822545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:22:01.828294 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:22:01.828694 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:22:01.829075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:22:01.829744 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:01.830170 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:22:01.830546 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:22:01.841384 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:01.842715 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:22:01.843915 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:22:01.844354 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:22:01.845369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763b2d6450>]}
[0m06:22:01.845881 [debug] [MainThread]: Using duckdb connection "master"
[0m06:22:01.846315 [debug] [MainThread]: On master: BEGIN
[0m06:22:01.846672 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:22:01.847376 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:22:01.847769 [debug] [MainThread]: On master: COMMIT
[0m06:22:01.848187 [debug] [MainThread]: Using duckdb connection "master"
[0m06:22:01.848550 [debug] [MainThread]: On master: COMMIT
[0m06:22:01.849134 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:22:01.849530 [debug] [MainThread]: On master: Close
[0m06:22:01.850042 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:22:01.850536 [info ] [MainThread]: 
[0m06:22:01.870836 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:22:01.871429 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:22:01.872075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:22:01.872515 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:22:01.899482 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:22:01.900236 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:22:01.935392 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:22:01.936156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:09.538738 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:09.539321 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:22:09.540024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.540474 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:09.540897 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:22:09.541845 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.543228 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:09.543670 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:22:09.544694 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.552543 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:09.553026 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:22:09.553847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.556806 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:09.557279 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:22:09.558307 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.575069 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:22:09.575539 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:09.575976 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:22:09.578024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.583715 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:09.584200 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:22:09.585553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.587992 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:22:09.589547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ee362570>]}
[0m06:22:09.590264 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.72s]
[0m06:22:09.591049 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:22:09.591941 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:22:09.592651 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:22:09.593286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:22:09.593719 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:22:09.598688 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:22:09.599403 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:22:09.635599 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:09.636114 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260203062209629588"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:22:09.636569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:09.643375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.650756 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:09.651226 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:22:09.651896 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.652365 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:09.652787 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260203062209629588'
      
      
      order by ordinal_position

  
[0m06:22:09.655164 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.660322 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:09.660784 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:22:09.663147 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.670819 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:09.671302 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:22:09.673624 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.675303 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:09.675748 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:22:09.676464 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.694811 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:22:09.695530 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:09.696004 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260203062209629588"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260203062209629588"
    )
  
[0m06:22:09.703533 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.705309 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:22:09.705746 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:09.706176 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:22:09.711840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.712715 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:22:09.713409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ee342270>]}
[0m06:22:09.714080 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m06:22:09.714806 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:22:09.716595 [debug] [MainThread]: Using duckdb connection "master"
[0m06:22:09.717034 [debug] [MainThread]: On master: BEGIN
[0m06:22:09.717419 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:22:09.718107 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:22:09.718504 [debug] [MainThread]: On master: COMMIT
[0m06:22:09.718877 [debug] [MainThread]: Using duckdb connection "master"
[0m06:22:09.719274 [debug] [MainThread]: On master: COMMIT
[0m06:22:09.719834 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:22:09.720281 [debug] [MainThread]: On master: Close
[0m06:22:09.720745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:22:09.721152 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:22:09.721552 [info ] [MainThread]: 
[0m06:22:09.722058 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.37 seconds (8.37s).
[0m06:22:09.722977 [debug] [MainThread]: Command end result
[0m06:22:09.748582 [info ] [MainThread]: 
[0m06:22:09.749178 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:22:09.749661 [info ] [MainThread]: 
[0m06:22:09.750176 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:22:09.751193 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.497821, "process_user_time": 5.289479, "process_kernel_time": 0.281131, "process_mem_max_rss": "273568", "process_in_blocks": "1200", "process_out_blocks": "107400"}
[0m06:22:09.751738 [debug] [MainThread]: Command `dbt run` succeeded at 06:22:09.751634 after 10.50 seconds
[0m06:22:09.752213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763a6b9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763999f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ee324e30>]}
[0m06:22:09.752645 [debug] [MainThread]: Flushing usage events
[0m06:22:11.452191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2481bfac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2481f74a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2481e94470>]}


============================== 06:22:11.455256 | 627d1cc8-7366-41a3-b9d8-37dff9994fc8 ==============================
[0m06:22:11.455256 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:22:11.455883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:22:11.571188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '627d1cc8-7366-41a3-b9d8-37dff9994fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2481b6a420>]}
[0m06:22:11.589270 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18879193, "process_user_time": 1.306997, "process_kernel_time": 0.127901, "process_mem_max_rss": "99868", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:22:11.589811 [debug] [MainThread]: Command `dbt clean` succeeded at 06:22:11.589708 after 0.19 seconds
[0m06:22:11.590258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24861bb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2481ff2180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24818c3680>]}
[0m06:22:11.590671 [debug] [MainThread]: Flushing usage events
[0m14:23:42.204163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5962d93110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5963203dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5962ada150>]}


============================== 14:23:42.212645 | fda5a1d4-2454-4ee3-97b3-d1dd71d924e1 ==============================
[0m14:23:42.212645 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:23:42.213351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:23:42.381228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fda5a1d4-2454-4ee3-97b3-d1dd71d924e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f596379dfd0>]}
[0m14:23:42.396098 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-b0oo5j95'
[0m14:23:42.396584 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:23:42.499148 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:23:42.500417 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:23:42.542366 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:23:42.547340 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:23:42.642575 [info ] [MainThread]: Installed from version 1.2.0
[0m14:23:42.643065 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:23:42.643598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fda5a1d4-2454-4ee3-97b3-d1dd71d924e1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f596296e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59627e8e90>]}
[0m14:23:42.644026 [info ] [MainThread]: 
[0m14:23:42.644524 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:23:42.646191 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49570405, "process_user_time": 1.656251, "process_kernel_time": 0.126171, "process_mem_max_rss": "100936", "process_in_blocks": "8512", "process_out_blocks": "5176"}
[0m14:23:42.646736 [debug] [MainThread]: Command `dbt deps` succeeded at 14:23:42.646635 after 0.50 seconds
[0m14:23:42.647149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5962d901a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59626a2c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5962d51d30>]}
[0m14:23:42.647586 [debug] [MainThread]: Flushing usage events
[0m14:23:44.226781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21187a54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2118a94fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21191f8500>]}


============================== 14:23:44.229727 | 37f0d644-bb9f-4cbf-9632-4cc90a2fea34 ==============================
[0m14:23:44.229727 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:23:44.230382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:23:44.466649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21185ca000>]}
[0m14:23:44.529950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21187a6ab0>]}
[0m14:23:44.531569 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:23:44.556389 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:23:44.557100 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:23:44.557655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f211104bce0>]}
[0m14:23:45.968968 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:23:45.969622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21108d6c00>]}
[0m14:23:46.211262 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:23:46.216764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f211a3df6b0>]}
[0m14:23:46.312743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21109938c0>]}
[0m14:23:46.313242 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:23:46.313765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21111009e0>]}
[0m14:23:46.315734 [info ] [MainThread]: 
[0m14:23:46.316424 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:23:46.321307 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:23:46.357611 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:23:46.358049 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:23:46.358467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:46.961059 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:23:46.963098 [debug] [ThreadPool]: On list_petro: Close
[0m14:23:46.964169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:23:46.965018 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:23:46.973098 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:23:46.973546 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:23:46.973934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:46.975112 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:23:46.976431 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:23:46.976823 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:23:46.977433 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:23:46.977818 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:23:46.978186 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:23:46.978841 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:23:46.979769 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:23:46.980161 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:23:46.980555 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:23:46.981114 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:23:46.981543 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:23:46.982716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:23:46.988639 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:23:46.989053 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:23:46.989451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:46.990108 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:23:46.990527 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:23:46.990911 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:23:47.001515 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:23:47.002843 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:23:47.004031 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:23:47.004452 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:23:47.005460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21108c2300>]}
[0m14:23:47.005968 [debug] [MainThread]: Using duckdb connection "master"
[0m14:23:47.006379 [debug] [MainThread]: On master: BEGIN
[0m14:23:47.006739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:23:47.007388 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:23:47.007785 [debug] [MainThread]: On master: COMMIT
[0m14:23:47.008153 [debug] [MainThread]: Using duckdb connection "master"
[0m14:23:47.008540 [debug] [MainThread]: On master: COMMIT
[0m14:23:47.009122 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:23:47.009542 [debug] [MainThread]: On master: Close
[0m14:23:47.010021 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:23:47.010506 [info ] [MainThread]: 
[0m14:23:47.029589 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:23:47.030160 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:23:47.030815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:23:47.031275 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:23:47.057965 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:23:47.058716 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:23:47.093734 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:23:47.094461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:09.732965 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:26:09.733510 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:26:09.734191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.734652 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:26:09.735065 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:26:09.736028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.737382 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:26:09.737823 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:26:09.738809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.746424 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:26:09.746881 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:26:09.747658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.750579 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:26:09.751022 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:26:09.751755 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.768119 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:26:09.768596 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:26:09.769012 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:26:09.770205 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.775747 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:26:09.776205 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:26:09.777399 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.779759 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:26:09.781316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f211075e7e0>]}
[0m14:26:09.782008 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 142.75s]
[0m14:26:09.782791 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:26:09.783584 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:26:09.784152 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:26:09.784787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:26:09.785281 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:26:09.790327 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:26:09.791045 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:26:09.826328 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:26:09.826815 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260203142609820436"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:26:09.827282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:09.834102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.841319 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:26:09.841775 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:26:09.842421 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.842856 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:26:09.843300 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260203142609820436'
      
      
      order by ordinal_position

  
[0m14:26:09.845849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.850889 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:26:09.851372 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:26:09.853727 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.861322 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:26:09.861778 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:26:09.864480 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.866136 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:26:09.866623 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:26:09.867356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.885241 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:26:09.885901 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:26:09.886371 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260203142609820436"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260203142609820436"
    )
  
[0m14:26:09.894316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.895958 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:26:09.896407 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:26:09.896805 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:26:09.903382 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.904195 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:26:09.904844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20d53c6f60>]}
[0m14:26:09.905489 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m14:26:09.906306 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:26:09.907853 [debug] [MainThread]: Using duckdb connection "master"
[0m14:26:09.908275 [debug] [MainThread]: On master: BEGIN
[0m14:26:09.908641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:26:09.909289 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:26:09.909678 [debug] [MainThread]: On master: COMMIT
[0m14:26:09.910042 [debug] [MainThread]: Using duckdb connection "master"
[0m14:26:09.910448 [debug] [MainThread]: On master: COMMIT
[0m14:26:09.911013 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:26:09.911432 [debug] [MainThread]: On master: Close
[0m14:26:09.911878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:09.912249 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:26:09.912640 [info ] [MainThread]: 
[0m14:26:09.913136 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 2 minutes and 23.60 seconds (143.60s).
[0m14:26:09.914130 [debug] [MainThread]: Command end result
[0m14:26:09.938729 [info ] [MainThread]: 
[0m14:26:09.939334 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:26:09.939847 [info ] [MainThread]: 
[0m14:26:09.940384 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:26:09.941360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 145.7681, "process_user_time": 5.862326, "process_kernel_time": 0.277062, "process_mem_max_rss": "289424", "process_in_blocks": "1200", "process_out_blocks": "107312"}
[0m14:26:09.941884 [debug] [MainThread]: Command `dbt run` succeeded at 14:26:09.941786 after 145.77 seconds
[0m14:26:09.942322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21107572f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2118aeade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2118b9fb60>]}
[0m14:26:09.942740 [debug] [MainThread]: Flushing usage events
[0m14:26:11.623831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2789526180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27874b5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27877cbda0>]}


============================== 14:26:11.626925 | aed653b7-5d4c-4db9-9823-99a36106e82b ==============================
[0m14:26:11.626925 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:26:11.627591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:26:11.747093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aed653b7-5d4c-4db9-9823-99a36106e82b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27885689b0>]}
[0m14:26:11.766596 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19673762, "process_user_time": 1.35561, "process_kernel_time": 0.112884, "process_mem_max_rss": "99848", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:26:11.767119 [debug] [MainThread]: Command `dbt clean` succeeded at 14:26:11.767015 after 0.20 seconds
[0m14:26:11.767597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2787721040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27874b5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278825ba10>]}
[0m14:26:11.768024 [debug] [MainThread]: Flushing usage events
[0m22:10:54.736919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a02b58e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a00b73770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a013425d0>]}


============================== 22:10:54.754595 | d648643a-c3d5-4f8e-b17a-7bf3f3e79d0a ==============================
[0m22:10:54.754595 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:54.755337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:10:54.918164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd648643a-c3d5-4f8e-b17a-7bf3f3e79d0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a0090a000>]}
[0m22:10:54.936816 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8pu132bo'
[0m22:10:54.937317 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:10:55.030670 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:10:55.032197 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:10:55.077360 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:10:55.082559 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:10:55.174725 [info ] [MainThread]: Installed from version 1.2.0
[0m22:10:55.175311 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:10:55.175798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd648643a-c3d5-4f8e-b17a-7bf3f3e79d0a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a00d0c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a007cfb00>]}
[0m22:10:55.176250 [info ] [MainThread]: 
[0m22:10:55.176698 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:10:55.250889 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5636699, "process_user_time": 1.6216, "process_kernel_time": 0.16226, "process_mem_max_rss": "101384", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m22:10:55.251620 [debug] [MainThread]: Command `dbt deps` succeeded at 22:10:55.251511 after 0.56 seconds
[0m22:10:55.252042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a02b58e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a00edac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a0084ffe0>]}
[0m22:10:55.252473 [debug] [MainThread]: Flushing usage events
[0m22:10:56.904442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a85985220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a85987590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a84f75c10>]}


============================== 22:10:56.907855 | 4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27 ==============================
[0m22:10:56.907855 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:56.908562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:10:57.154615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a84da3bc0>]}
[0m22:10:57.214653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a84da2e70>]}
[0m22:10:57.216682 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:10:57.242886 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:10:57.243622 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:10:57.244105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7d98d850>]}
[0m22:10:58.481583 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:10:58.482279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7d0ce570>]}
[0m22:10:58.722209 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:10:58.727634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7d0d92e0>]}
[0m22:10:58.821207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7d184140>]}
[0m22:10:58.821826 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:10:58.822347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7cf47fb0>]}
[0m22:10:58.824388 [info ] [MainThread]: 
[0m22:10:58.825107 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:10:58.829818 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:10:58.866337 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:10:58.866804 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:10:58.867156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:59.340726 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:59.342460 [debug] [ThreadPool]: On list_petro: Close
[0m22:10:59.343410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:10:59.344235 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:10:59.351930 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:10:59.352380 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:10:59.352725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:59.353966 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:59.355279 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:10:59.355652 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:10:59.356249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:59.356612 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:10:59.356927 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:10:59.357512 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:59.358426 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:10:59.358779 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:10:59.359100 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:10:59.359667 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:59.360042 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:10:59.361316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:10:59.367184 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:10:59.367591 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:10:59.367926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:59.368603 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:59.368972 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:10:59.369331 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:10:59.379285 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:59.380705 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:10:59.381892 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:10:59.382290 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:10:59.383325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7d1755b0>]}
[0m22:10:59.383822 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:59.384176 [debug] [MainThread]: On master: BEGIN
[0m22:10:59.384557 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:59.385193 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:59.385586 [debug] [MainThread]: On master: COMMIT
[0m22:10:59.385908 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:59.386214 [debug] [MainThread]: On master: COMMIT
[0m22:10:59.386875 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:59.387284 [debug] [MainThread]: On master: Close
[0m22:10:59.387755 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:10:59.388201 [info ] [MainThread]: 
[0m22:10:59.406881 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:10:59.407522 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:10:59.408152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:10:59.408583 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:10:59.434594 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:10:59.435424 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:10:59.469941 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:10:59.470760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:08.802842 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:08.803394 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:11:08.804040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.804475 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:08.804844 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:11:08.805787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.807129 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:08.807556 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:11:08.808555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.816602 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:08.817054 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:11:08.817857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.820938 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:08.821374 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:11:08.822064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.838410 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:11:08.838873 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:08.839268 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:11:08.840507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.846489 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:08.846952 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:11:08.848251 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.850751 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:11:08.852294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7d191970>]}
[0m22:11:08.852973 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.44s]
[0m22:11:08.853774 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:11:08.854600 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:11:08.855126 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:11:08.855773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:11:08.856182 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:11:08.861558 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:11:08.862280 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:11:08.897357 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:08.897944 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260203221108891417"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:11:08.898377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:08.906024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.913944 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:08.914425 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:11:08.915112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.915549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:08.915927 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260203221108891417'
      
      
      order by ordinal_position

  
[0m22:11:08.918410 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.923743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:08.924202 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:11:08.926848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.934543 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:08.934983 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:11:08.937513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.939238 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:08.939663 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:11:08.940357 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.958409 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:11:08.959154 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:08.959592 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260203221108891417"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260203221108891417"
    )
  
[0m22:11:08.969737 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.971584 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:11:08.971990 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:08.972370 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:11:08.979147 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.980038 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:11:08.980710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a39527320>]}
[0m22:11:08.981376 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m22:11:08.982108 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:11:08.983702 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:08.984091 [debug] [MainThread]: On master: BEGIN
[0m22:11:08.984471 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:11:08.985128 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:08.985538 [debug] [MainThread]: On master: COMMIT
[0m22:11:08.985865 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:08.986175 [debug] [MainThread]: On master: COMMIT
[0m22:11:08.986728 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:08.987086 [debug] [MainThread]: On master: Close
[0m22:11:08.987553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:08.987872 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:11:08.988249 [info ] [MainThread]: 
[0m22:11:08.988724 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.16 seconds (10.16s).
[0m22:11:08.989623 [debug] [MainThread]: Command end result
[0m22:11:09.015167 [info ] [MainThread]: 
[0m22:11:09.015800 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:11:09.016321 [info ] [MainThread]: 
[0m22:11:09.016807 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:11:09.017809 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.165953, "process_user_time": 5.597971, "process_kernel_time": 0.365259, "process_mem_max_rss": "314060", "process_in_blocks": "1200", "process_out_blocks": "107432"}
[0m22:11:09.018395 [debug] [MainThread]: Command `dbt run` succeeded at 22:11:09.018268 after 12.17 seconds
[0m22:11:09.018801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a84edd130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a84e32c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3958f7d0>]}
[0m22:11:09.019184 [debug] [MainThread]: Flushing usage events
[0m22:11:10.755916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47214bec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47203149b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47201caf90>]}


============================== 22:11:10.759117 | 3bb8edc3-01c9-46b7-96e2-ed2b61928198 ==============================
[0m22:11:10.759117 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:11:10.759802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:11:10.872950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bb8edc3-01c9-46b7-96e2-ed2b61928198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f472076e270>]}
[0m22:11:10.891607 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18708023, "process_user_time": 1.324773, "process_kernel_time": 0.118889, "process_mem_max_rss": "99604", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:11:10.892167 [debug] [MainThread]: Command `dbt clean` succeeded at 22:11:10.892045 after 0.19 seconds
[0m22:11:10.892621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47237e7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47201cacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f472076e270>]}
[0m22:11:10.893006 [debug] [MainThread]: Flushing usage events
[0m06:21:41.470053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26254faff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2627536990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26254fa8a0>]}


============================== 06:21:41.487224 | 7744a268-3cbd-4a6f-bedc-c16b93a1810f ==============================
[0m06:21:41.487224 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:21:41.487959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:21:41.658454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7744a268-3cbd-4a6f-bedc-c16b93a1810f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2624907770>]}
[0m06:21:41.674747 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5jrlqh83'
[0m06:21:41.675242 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:21:41.794110 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:21:41.795639 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:21:41.829055 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:21:41.834223 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:21:42.325890 [info ] [MainThread]: Installed from version 1.2.0
[0m06:21:42.326472 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:21:42.327037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7744a268-3cbd-4a6f-bedc-c16b93a1810f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2624904e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26247cf260>]}
[0m06:21:42.327488 [info ] [MainThread]: 
[0m06:21:42.327983 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:21:42.338700 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9207876, "process_user_time": 1.67454, "process_kernel_time": 0.136043, "process_mem_max_rss": "101048", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m06:21:42.339276 [debug] [MainThread]: Command `dbt deps` succeeded at 06:21:42.339174 after 0.92 seconds
[0m06:21:42.339699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2624bfbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262479de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262479db50>]}
[0m06:21:42.340149 [debug] [MainThread]: Flushing usage events
[0m06:21:44.203317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c02c6d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28bf4b7ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c00beea0>]}


============================== 06:21:44.206488 | ef0403c5-dd51-4c20-88b2-4106282b14c2 ==============================
[0m06:21:44.206488 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:21:44.207212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:21:44.441341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef0403c5-dd51-4c20-88b2-4106282b14c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28bfc4e180>]}
[0m06:21:44.502832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef0403c5-dd51-4c20-88b2-4106282b14c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28bef372c0>]}
[0m06:21:44.504676 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:21:44.547747 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:21:44.548527 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:21:44.549077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ef0403c5-dd51-4c20-88b2-4106282b14c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28bee629f0>]}
[0m06:21:45.934362 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:21:45.935064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ef0403c5-dd51-4c20-88b2-4106282b14c2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b7014c50>]}
[0m06:21:46.181200 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:21:46.186740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef0403c5-dd51-4c20-88b2-4106282b14c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28bf5a2810>]}
[0m06:21:46.287004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef0403c5-dd51-4c20-88b2-4106282b14c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b78c9640>]}
[0m06:21:46.287586 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:21:46.288152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef0403c5-dd51-4c20-88b2-4106282b14c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b78532f0>]}
[0m06:21:46.290224 [info ] [MainThread]: 
[0m06:21:46.290994 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:21:46.295952 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:21:46.332423 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:21:46.332905 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:21:46.333296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:21:46.738106 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:46.739942 [debug] [ThreadPool]: On list_petro: Close
[0m06:21:46.740917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:21:46.741650 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:21:46.751911 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:21:46.752335 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:21:46.752732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:21:46.753666 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:46.754984 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:21:46.755378 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:21:46.755962 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:46.756349 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:21:46.756726 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:21:46.757331 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:46.758237 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:21:46.758627 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:21:46.759023 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:21:46.759595 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:46.760014 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:21:46.761208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:21:46.767135 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:21:46.767534 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:21:46.767930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:21:46.768842 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:46.769228 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:21:46.769599 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:21:46.779896 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:46.781260 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:21:46.782458 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:21:46.782878 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:21:46.784024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef0403c5-dd51-4c20-88b2-4106282b14c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c0eba660>]}
[0m06:21:46.784532 [debug] [MainThread]: Using duckdb connection "master"
[0m06:21:46.784977 [debug] [MainThread]: On master: BEGIN
[0m06:21:46.785348 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:21:46.785996 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:21:46.786399 [debug] [MainThread]: On master: COMMIT
[0m06:21:46.786803 [debug] [MainThread]: Using duckdb connection "master"
[0m06:21:46.787168 [debug] [MainThread]: On master: COMMIT
[0m06:21:46.787774 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:21:46.788173 [debug] [MainThread]: On master: Close
[0m06:21:46.788666 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:21:46.789184 [info ] [MainThread]: 
[0m06:21:46.809180 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:21:46.809793 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:21:46.810438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:21:46.810901 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:21:46.838087 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:21:46.838899 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:21:46.874336 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:21:46.875111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:21:56.868899 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:21:56.869453 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:21:56.870247 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:21:56.870690 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:21:56.871135 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:21:56.872176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:21:56.873565 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:21:56.874031 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:21:56.875203 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:21:56.883411 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:21:56.883904 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:21:56.884741 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:21:56.887920 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:21:56.888370 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:21:56.889114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:21:56.906006 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:21:56.906506 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:21:56.906947 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:21:56.909008 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:21:56.915006 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:21:56.915468 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:21:56.916821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:21:56.919335 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:21:56.920917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef0403c5-dd51-4c20-88b2-4106282b14c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c0e5f890>]}
[0m06:21:56.921619 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.11s]
[0m06:21:56.922470 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:21:56.923477 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:21:56.924043 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:21:56.924675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:21:56.925137 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:21:56.930238 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:21:56.930931 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:21:56.967550 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:21:56.968133 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260204062156961394"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:21:56.968596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:21:56.975865 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:21:56.983831 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:21:56.984296 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:21:56.985005 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:21:56.985445 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:21:56.985895 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260204062156961394'
      
      
      order by ordinal_position

  
[0m06:21:56.988455 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:21:56.993820 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:21:56.994289 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:21:56.996631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:21:57.004401 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:21:57.004879 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:21:57.007215 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:21:57.008906 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:21:57.009347 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:21:57.010071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:21:57.028636 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:21:57.029430 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:21:57.029906 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260204062156961394"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260204062156961394"
    )
  
[0m06:21:57.039231 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:21:57.041220 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:21:57.041666 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:21:57.042108 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:21:57.048837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:21:57.049764 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:21:57.050456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef0403c5-dd51-4c20-88b2-4106282b14c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2885fdc380>]}
[0m06:21:57.051135 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m06:21:57.051964 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:21:57.053702 [debug] [MainThread]: Using duckdb connection "master"
[0m06:21:57.054141 [debug] [MainThread]: On master: BEGIN
[0m06:21:57.054513 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:21:57.055266 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:21:57.055667 [debug] [MainThread]: On master: COMMIT
[0m06:21:57.056078 [debug] [MainThread]: Using duckdb connection "master"
[0m06:21:57.056441 [debug] [MainThread]: On master: COMMIT
[0m06:21:57.057053 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:21:57.057447 [debug] [MainThread]: On master: Close
[0m06:21:57.057944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:21:57.058309 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:21:57.058733 [info ] [MainThread]: 
[0m06:21:57.059276 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.77 seconds (10.77s).
[0m06:21:57.060272 [debug] [MainThread]: Command end result
[0m06:21:57.086552 [info ] [MainThread]: 
[0m06:21:57.087257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:21:57.087799 [info ] [MainThread]: 
[0m06:21:57.088331 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:21:57.089382 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.939346, "process_user_time": 5.684618, "process_kernel_time": 0.302607, "process_mem_max_rss": "285660", "process_in_blocks": "1200", "process_out_blocks": "107400"}
[0m06:21:57.089954 [debug] [MainThread]: Command `dbt run` succeeded at 06:21:57.089849 after 12.94 seconds
[0m06:21:57.090403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b78ae480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28bf9eaab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28bf23da30>]}
[0m06:21:57.090861 [debug] [MainThread]: Flushing usage events
[0m06:21:59.138382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9fe116d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9fe11a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea0112300>]}


============================== 06:21:59.141547 | 87665a8e-ab65-4479-b6b0-a0de286c4cee ==============================
[0m06:21:59.141547 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:21:59.142272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:21:59.257245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87665a8e-ab65-4479-b6b0-a0de286c4cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea158c8c0>]}
[0m06:21:59.276607 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19092365, "process_user_time": 1.380774, "process_kernel_time": 0.107982, "process_mem_max_rss": "99640", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:21:59.277267 [debug] [MainThread]: Command `dbt clean` succeeded at 06:21:59.277157 after 0.19 seconds
[0m06:21:59.277729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea3bbb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea02783b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea158c8c0>]}
[0m06:21:59.278174 [debug] [MainThread]: Flushing usage events
[0m14:22:33.183918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f8532840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6fb597680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f8297770>]}


============================== 14:22:33.200811 | 3762d511-6878-4c95-9177-0e6308987d01 ==============================
[0m14:22:33.200811 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:22:33.201527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:22:33.364783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3762d511-6878-4c95-9177-0e6308987d01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f81a3500>]}
[0m14:22:33.380291 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-k1y562pn'
[0m14:22:33.380759 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:22:33.481077 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:22:33.482390 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:22:33.527881 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:22:33.532901 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:22:33.625318 [info ] [MainThread]: Installed from version 1.2.0
[0m14:22:33.625872 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:22:33.626386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3762d511-6878-4c95-9177-0e6308987d01', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f7e945c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f7f26cc0>]}
[0m14:22:33.626856 [info ] [MainThread]: 
[0m14:22:33.627342 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:22:33.645062 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.51315176, "process_user_time": 1.645778, "process_kernel_time": 0.130219, "process_mem_max_rss": "101340", "process_in_blocks": "8512", "process_out_blocks": "5176"}
[0m14:22:33.645621 [debug] [MainThread]: Command `dbt deps` succeeded at 14:22:33.645519 after 0.51 seconds
[0m14:22:33.646105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f92e87a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f7eb40e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f85331d0>]}
[0m14:22:33.646542 [debug] [MainThread]: Flushing usage events
[0m14:22:35.188593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c461ef320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c46060230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c4578d580>]}


============================== 14:22:35.191664 | e0a0f7f2-4684-4185-85de-8b54f9b76bc8 ==============================
[0m14:22:35.191664 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:22:35.192393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:22:35.423217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0a0f7f2-4684-4185-85de-8b54f9b76bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c45445670>]}
[0m14:22:35.484424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0a0f7f2-4684-4185-85de-8b54f9b76bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c4554a270>]}
[0m14:22:35.486193 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:22:35.511704 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:22:35.512441 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:22:35.512998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e0a0f7f2-4684-4185-85de-8b54f9b76bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c4548d490>]}
[0m14:22:36.925715 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:22:36.926394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e0a0f7f2-4684-4185-85de-8b54f9b76bc8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c454f2d80>]}
[0m14:22:37.167019 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:22:37.172424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0a0f7f2-4684-4185-85de-8b54f9b76bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c3d7af770>]}
[0m14:22:37.268994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0a0f7f2-4684-4185-85de-8b54f9b76bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c3de9d760>]}
[0m14:22:37.269528 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:22:37.270060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0a0f7f2-4684-4185-85de-8b54f9b76bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c461ef740>]}
[0m14:22:37.272058 [info ] [MainThread]: 
[0m14:22:37.272738 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:22:37.277633 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:22:37.313078 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:22:37.313510 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:22:37.313927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:37.769059 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:37.771703 [debug] [ThreadPool]: On list_petro: Close
[0m14:22:37.773029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:22:37.773927 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:22:37.781969 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:22:37.782389 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:22:37.782779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:37.783720 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:37.785060 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:22:37.785451 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:22:37.786249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:37.786633 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:22:37.787033 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:22:37.787634 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:37.788584 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:22:37.789002 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:22:37.789365 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:22:37.789985 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:37.790381 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:22:37.791589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:22:37.797496 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:22:37.797926 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:22:37.798288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:37.798950 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:37.799334 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:22:37.799708 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:22:37.810323 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:37.811665 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:22:37.812880 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:22:37.813273 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:22:37.814316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0a0f7f2-4684-4185-85de-8b54f9b76bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c3d6476b0>]}
[0m14:22:37.814843 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:37.815238 [debug] [MainThread]: On master: BEGIN
[0m14:22:37.815602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:22:37.816265 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:22:37.816659 [debug] [MainThread]: On master: COMMIT
[0m14:22:37.817055 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:37.817419 [debug] [MainThread]: On master: COMMIT
[0m14:22:37.818051 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:22:37.818449 [debug] [MainThread]: On master: Close
[0m14:22:37.818980 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:22:37.819468 [info ] [MainThread]: 
[0m14:22:37.838979 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:22:37.839580 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:22:37.840255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:22:37.840683 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:22:37.867326 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:22:37.868068 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:22:37.903489 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:22:37.904242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:45.921498 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:45.922044 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:22:45.922714 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:45.923171 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:45.923581 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:22:45.924528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:45.925876 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:45.926318 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:22:45.927358 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:45.935094 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:45.935548 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:22:45.936379 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:45.939303 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:45.939744 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:22:45.940482 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:45.956969 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:22:45.957429 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:45.957864 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:22:45.959732 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:45.965410 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:45.965891 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:22:45.967085 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:45.969459 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:22:45.970974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a0f7f2-4684-4185-85de-8b54f9b76bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bfa56b9e0>]}
[0m14:22:45.971643 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.13s]
[0m14:22:45.972512 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:22:45.973311 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:22:45.973888 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:22:45.974677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:22:45.975157 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:22:45.980117 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:22:45.980745 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:22:46.016621 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:46.017125 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260204142246010653"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:22:46.017583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:46.024305 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:46.031672 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:46.032151 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:22:46.032803 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:46.033240 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:46.033671 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260204142246010653'
      
      
      order by ordinal_position

  
[0m14:22:46.036112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:46.041237 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:46.041698 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:22:46.044084 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:46.051831 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:46.052290 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:22:46.054634 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:46.056312 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:46.056756 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:22:46.057480 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:46.075646 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:22:46.076328 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:46.076794 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260204142246010653"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260204142246010653"
    )
  
[0m14:22:46.086502 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:46.088277 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:22:46.088716 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:46.089175 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:22:46.095514 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:46.096406 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:22:46.097099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a0f7f2-4684-4185-85de-8b54f9b76bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bf9d6f6e0>]}
[0m14:22:46.097761 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m14:22:46.098613 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:22:46.100508 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:46.100961 [debug] [MainThread]: On master: BEGIN
[0m14:22:46.101366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:22:46.102102 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:22:46.102508 [debug] [MainThread]: On master: COMMIT
[0m14:22:46.102924 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:46.103297 [debug] [MainThread]: On master: COMMIT
[0m14:22:46.103895 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:22:46.104289 [debug] [MainThread]: On master: Close
[0m14:22:46.104757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:46.105153 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:22:46.105553 [info ] [MainThread]: 
[0m14:22:46.106040 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.83 seconds (8.83s).
[0m14:22:46.106990 [debug] [MainThread]: Command end result
[0m14:22:46.135317 [info ] [MainThread]: 
[0m14:22:46.135905 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:46.136367 [info ] [MainThread]: 
[0m14:22:46.136855 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:22:46.137813 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.001021, "process_user_time": 5.73324, "process_kernel_time": 0.28531, "process_mem_max_rss": "284948", "process_in_blocks": "1200", "process_out_blocks": "107392"}
[0m14:22:46.138364 [debug] [MainThread]: Command `dbt run` succeeded at 14:22:46.138264 after 11.00 seconds
[0m14:22:46.138820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c458a5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c4578e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c45b2b500>]}
[0m14:22:46.139252 [debug] [MainThread]: Flushing usage events
[0m14:22:47.832414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fa00ad4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f9f5bed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f9f6f9760>]}


============================== 14:22:47.835409 | b3285d4d-4726-47b7-a3de-ec807ac01c89 ==============================
[0m14:22:47.835409 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:22:47.836105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:22:47.950086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3285d4d-4726-47b7-a3de-ec807ac01c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f9f6ba2d0>]}
[0m14:22:47.967749 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18680456, "process_user_time": 1.32017, "process_kernel_time": 0.102013, "process_mem_max_rss": "99568", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:22:47.968296 [debug] [MainThread]: Command `dbt clean` succeeded at 14:22:47.968194 after 0.19 seconds
[0m14:22:47.968712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f9f72ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f9f6ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f9f7da180>]}
[0m14:22:47.969155 [debug] [MainThread]: Flushing usage events
[0m22:07:18.150232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0769f62d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0769f62e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0769f61280>]}


============================== 22:07:18.168804 | 419b0d9e-83f3-45d2-9cf5-db355eac5b1b ==============================
[0m22:07:18.168804 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:18.169550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:18.343160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '419b0d9e-83f3-45d2-9cf5-db355eac5b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f076bc26d80>]}
[0m22:07:18.360606 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6qm24c5w'
[0m22:07:18.361161 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:07:18.421662 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:07:18.423988 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:07:18.459039 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:07:18.465266 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:07:18.887565 [info ] [MainThread]: Installed from version 1.2.0
[0m22:07:18.888229 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:07:18.888838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '419b0d9e-83f3-45d2-9cf5-db355eac5b1b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0769d43fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0769e00380>]}
[0m22:07:18.889314 [info ] [MainThread]: 
[0m22:07:18.889829 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:07:18.901633 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.80570614, "process_user_time": 1.784445, "process_kernel_time": 0.160142, "process_mem_max_rss": "101404", "process_in_blocks": "8512", "process_out_blocks": "5176"}
[0m22:07:18.902333 [debug] [MainThread]: Command `dbt deps` succeeded at 22:07:18.902201 after 0.81 seconds
[0m22:07:18.902871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0769f27320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0769fa7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0769dda090>]}
[0m22:07:18.903367 [debug] [MainThread]: Flushing usage events
[0m22:07:20.881303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ed6e70e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ea4eec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ed6e6a20>]}


============================== 22:07:20.884617 | 57012243-3899-473d-8b03-bf72a2a8245d ==============================
[0m22:07:20.884617 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:20.885305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:21.128536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57012243-3899-473d-8b03-bf72a2a8245d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ebf8c800>]}
[0m22:07:21.194089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57012243-3899-473d-8b03-bf72a2a8245d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ea15d640>]}
[0m22:07:21.196239 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:07:21.233207 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:07:21.234024 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:07:21.234598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '57012243-3899-473d-8b03-bf72a2a8245d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e2b76630>]}
[0m22:07:22.656808 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:07:22.657546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '57012243-3899-473d-8b03-bf72a2a8245d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e22997c0>]}
[0m22:07:22.922945 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:07:22.929010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57012243-3899-473d-8b03-bf72a2a8245d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ebe68aa0>]}
[0m22:07:23.031753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57012243-3899-473d-8b03-bf72a2a8245d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e2379700>]}
[0m22:07:23.032364 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:07:23.032897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57012243-3899-473d-8b03-bf72a2a8245d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ec331a60>]}
[0m22:07:23.034989 [info ] [MainThread]: 
[0m22:07:23.035787 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:07:23.041015 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:07:23.080664 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:07:23.081190 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:07:23.081613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:23.525319 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:23.527315 [debug] [ThreadPool]: On list_petro: Close
[0m22:07:23.528281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:07:23.528994 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:07:23.538540 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:23.539199 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:07:23.539688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:23.541548 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:23.543267 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:23.543684 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:07:23.544645 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:23.545057 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:23.545464 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:07:23.546270 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:23.547341 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:23.547754 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:23.548117 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:23.548771 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:23.549176 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:07:23.550617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:07:23.557123 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:23.557614 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:07:23.557981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:23.558879 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:23.559269 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:23.559693 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:07:23.570983 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:23.572647 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:07:23.573898 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:07:23.574295 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:07:23.575469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57012243-3899-473d-8b03-bf72a2a8245d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e23ebcb0>]}
[0m22:07:23.575992 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:23.576383 [debug] [MainThread]: On master: BEGIN
[0m22:07:23.576805 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:23.577542 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:23.577951 [debug] [MainThread]: On master: COMMIT
[0m22:07:23.578327 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:23.578746 [debug] [MainThread]: On master: COMMIT
[0m22:07:23.579330 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:23.579773 [debug] [MainThread]: On master: Close
[0m22:07:23.580280 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:07:23.580830 [info ] [MainThread]: 
[0m22:07:23.599534 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:07:23.600210 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:07:23.600859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:07:23.601297 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:07:23.629302 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:07:23.630209 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:07:23.666828 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:07:23.667810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:32.502959 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:32.503582 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:32.504355 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:32.504823 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:32.505247 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:32.506321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:32.507912 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:32.508485 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:32.509657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:32.518671 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:32.519257 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:32.520616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:32.524120 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:32.524596 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:32.525445 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:32.542998 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:32.543606 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:32.544072 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:32.545986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:32.552536 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:32.553076 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:32.554849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:32.557861 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:32.559644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57012243-3899-473d-8b03-bf72a2a8245d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e22d9670>]}
[0m22:07:32.560437 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.96s]
[0m22:07:32.561280 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:32.562241 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:32.563077 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:32.563747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:32.564204 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:32.569840 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:32.570596 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:32.609283 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:32.609935 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260204220732602792"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:32.610458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:32.618180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:32.626806 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:32.627327 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:32.628166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:32.628647 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:32.629073 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260204220732602792'
      
      
      order by ordinal_position

  
[0m22:07:32.631709 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:32.637380 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:32.637872 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:32.640453 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:32.648714 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:32.649286 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:32.652699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:32.654679 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:32.655156 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:07:32.655947 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:32.675458 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:32.676289 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:32.676830 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260204220732602792"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260204220732602792"
    )
  
[0m22:07:32.686255 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:32.688460 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:32.688989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:32.689460 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:32.695742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:32.696986 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:32.697828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57012243-3899-473d-8b03-bf72a2a8245d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13aec42030>]}
[0m22:07:32.698611 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m22:07:32.699436 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:32.701095 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:32.701549 [debug] [MainThread]: On master: BEGIN
[0m22:07:32.701928 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:32.702788 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:32.703198 [debug] [MainThread]: On master: COMMIT
[0m22:07:32.703614 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:32.703979 [debug] [MainThread]: On master: COMMIT
[0m22:07:32.704600 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:32.705001 [debug] [MainThread]: On master: Close
[0m22:07:32.705536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:32.705908 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:32.706314 [info ] [MainThread]: 
[0m22:07:32.706832 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.67 seconds (9.67s).
[0m22:07:32.707807 [debug] [MainThread]: Command end result
[0m22:07:32.736774 [info ] [MainThread]: 
[0m22:07:32.737514 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:32.738084 [info ] [MainThread]: 
[0m22:07:32.738647 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:32.739775 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.913631, "process_user_time": 5.995304, "process_kernel_time": 0.298716, "process_mem_max_rss": "311236", "process_in_blocks": "1200", "process_out_blocks": "107432"}
[0m22:07:32.740350 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:32.740238 after 11.91 seconds
[0m22:07:32.740866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ea4eec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13af60ce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ea61b230>]}
[0m22:07:32.741329 [debug] [MainThread]: Flushing usage events
[0m22:07:34.974226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5352cf0a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5353abe480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53528faba0>]}


============================== 22:07:34.977493 | d2a1ae06-c7e6-46d7-830a-f670c49269a4 ==============================
[0m22:07:34.977493 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:34.978172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:07:35.104451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2a1ae06-c7e6-46d7-830a-f670c49269a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5356ed3950>]}
[0m22:07:35.128945 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20943199, "process_user_time": 1.479784, "process_kernel_time": 0.116904, "process_mem_max_rss": "99912", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:07:35.129542 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:35.129430 after 0.21 seconds
[0m22:07:35.130055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5352929580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535377b9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53525a9fd0>]}
[0m22:07:35.130579 [debug] [MainThread]: Flushing usage events
[0m06:25:03.769073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d5ef8cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d5fb28200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d5ef8cd70>]}


============================== 06:25:03.785602 | 6cb72533-bfdb-402a-a9a6-361f8dfda452 ==============================
[0m06:25:03.785602 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:25:03.786321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:25:03.951844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cb72533-bfdb-402a-a9a6-361f8dfda452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d5fe2f0b0>]}
[0m06:25:03.967931 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zoxq6r7f'
[0m06:25:03.968434 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:25:04.078158 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:25:04.079881 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:25:04.112793 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:25:04.118338 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:25:04.302208 [info ] [MainThread]: Installed from version 1.2.0
[0m06:25:04.302884 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:25:04.303505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6cb72533-bfdb-402a-a9a6-361f8dfda452', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d5e01c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d5dfc04d0>]}
[0m06:25:04.304023 [info ] [MainThread]: 
[0m06:25:04.304550 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:25:04.314602 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.59852624, "process_user_time": 1.683051, "process_kernel_time": 0.135325, "process_mem_max_rss": "101056", "process_in_blocks": "8512", "process_out_blocks": "5176"}
[0m06:25:04.315228 [debug] [MainThread]: Command `dbt deps` succeeded at 06:25:04.315118 after 0.60 seconds
[0m06:25:04.315718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d5ea116d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d5ea13140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d5ea104d0>]}
[0m06:25:04.316188 [debug] [MainThread]: Flushing usage events
[0m06:25:06.019099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5c52e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5c360860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5d8b3020>]}


============================== 06:25:06.022286 | f8c600dd-886d-4240-8784-11add190cf55 ==============================
[0m06:25:06.022286 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:25:06.022960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:25:06.256261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8c600dd-886d-4240-8784-11add190cf55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5a289430>]}
[0m06:25:06.318180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8c600dd-886d-4240-8784-11add190cf55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5b1384a0>]}
[0m06:25:06.320084 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:25:06.344932 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:25:06.345725 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:25:06.346238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8c600dd-886d-4240-8784-11add190cf55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5a38e090>]}
[0m06:25:07.742671 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:25:07.743368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f8c600dd-886d-4240-8784-11add190cf55', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5250ede0>]}
[0m06:25:07.994816 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:25:08.000359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8c600dd-886d-4240-8784-11add190cf55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5249fe00>]}
[0m06:25:08.096346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8c600dd-886d-4240-8784-11add190cf55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf52559be0>]}
[0m06:25:08.096991 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:25:08.097496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8c600dd-886d-4240-8784-11add190cf55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5246b020>]}
[0m06:25:08.099566 [info ] [MainThread]: 
[0m06:25:08.100314 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:25:08.105387 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:25:08.142701 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:25:08.143217 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:25:08.143603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:25:08.698140 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:25:08.699816 [debug] [ThreadPool]: On list_petro: Close
[0m06:25:08.700652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:25:08.701204 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:25:08.708853 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:25:08.709277 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:25:08.709678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:25:08.710718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:25:08.712045 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:25:08.712433 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:25:08.713045 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:25:08.713425 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:25:08.713818 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:25:08.714420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:25:08.715340 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:25:08.715749 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:25:08.716108 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:25:08.716686 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:25:08.717084 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:25:08.718329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:25:08.724411 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:25:08.724837 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:25:08.725194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:25:08.725870 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:25:08.726258 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:25:08.726628 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:25:08.737522 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:25:08.738969 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:25:08.740192 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:25:08.740591 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:25:08.741804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8c600dd-886d-4240-8784-11add190cf55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf52c79250>]}
[0m06:25:08.742323 [debug] [MainThread]: Using duckdb connection "master"
[0m06:25:08.742748 [debug] [MainThread]: On master: BEGIN
[0m06:25:08.743121 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:25:08.743805 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:25:08.744207 [debug] [MainThread]: On master: COMMIT
[0m06:25:08.744579 [debug] [MainThread]: Using duckdb connection "master"
[0m06:25:08.745034 [debug] [MainThread]: On master: COMMIT
[0m06:25:08.745618 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:25:08.746040 [debug] [MainThread]: On master: Close
[0m06:25:08.746539 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:25:08.747043 [info ] [MainThread]: 
[0m06:25:08.765957 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:25:08.766606 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:25:08.767252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:25:08.767702 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:25:08.795007 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:25:08.795878 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:25:08.831744 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:25:08.832673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:25:17.188007 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:25:17.188568 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:25:17.189282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:25:17.189732 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:25:17.190152 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:25:17.191151 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:25:17.192516 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:25:17.192999 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:25:17.194035 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:25:17.202019 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:25:17.202474 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:25:17.203242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:25:17.206272 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:25:17.206735 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:25:17.207450 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:25:17.224172 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:25:17.224658 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:25:17.225085 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:25:17.226539 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:25:17.232362 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:25:17.232840 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:25:17.234101 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:25:17.236563 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:25:17.238153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c600dd-886d-4240-8784-11add190cf55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf138cddc0>]}
[0m06:25:17.238879 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.47s]
[0m06:25:17.239661 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:25:17.240699 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:25:17.241275 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:25:17.241894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:25:17.242336 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:25:17.247455 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:25:17.248171 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:25:17.285949 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:25:17.286556 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260205062517279677"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:25:17.287092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:25:17.295027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:25:17.303267 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:25:17.303767 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:25:17.304534 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:25:17.305010 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:25:17.305433 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260205062517279677'
      
      
      order by ordinal_position

  
[0m06:25:17.308009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:25:17.313505 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:25:17.313989 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:25:17.316466 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:25:17.324429 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:25:17.324911 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:25:17.327664 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:25:17.329383 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:25:17.329850 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:25:17.330568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:25:17.349626 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:25:17.350381 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:25:17.350889 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260205062517279677"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260205062517279677"
    )
  
[0m06:25:17.361423 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:25:17.363381 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:25:17.363859 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:25:17.364276 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:25:17.370927 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:25:17.371876 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:25:17.372603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c600dd-886d-4240-8784-11add190cf55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf13043320>]}
[0m06:25:17.373369 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m06:25:17.374150 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:25:17.375867 [debug] [MainThread]: Using duckdb connection "master"
[0m06:25:17.376285 [debug] [MainThread]: On master: BEGIN
[0m06:25:17.376698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:25:17.377471 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:25:17.377919 [debug] [MainThread]: On master: COMMIT
[0m06:25:17.378297 [debug] [MainThread]: Using duckdb connection "master"
[0m06:25:17.378691 [debug] [MainThread]: On master: COMMIT
[0m06:25:17.379288 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:25:17.379717 [debug] [MainThread]: On master: Close
[0m06:25:17.380212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:25:17.380576 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:25:17.381124 [info ] [MainThread]: 
[0m06:25:17.381590 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.28 seconds (9.28s).
[0m06:25:17.382562 [debug] [MainThread]: Command end result
[0m06:25:17.409742 [info ] [MainThread]: 
[0m06:25:17.410347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:25:17.410834 [info ] [MainThread]: 
[0m06:25:17.411308 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:25:17.412303 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.446367, "process_user_time": 5.905849, "process_kernel_time": 0.291252, "process_mem_max_rss": "283468", "process_in_blocks": "1200", "process_out_blocks": "107400"}
[0m06:25:17.412887 [debug] [MainThread]: Command `dbt run` succeeded at 06:25:17.412777 after 11.45 seconds
[0m06:25:17.413331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5a35d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf500efcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5a4ce060>]}
[0m06:25:17.413791 [debug] [MainThread]: Flushing usage events
[0m06:25:19.299098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a15cda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a130d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a202ae70>]}


============================== 06:25:19.302407 | 06d925b1-3d28-4b81-8619-deeaec225799 ==============================
[0m06:25:19.302407 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:25:19.303145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:25:19.419435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06d925b1-3d28-4b81-8619-deeaec225799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a17b3b00>]}
[0m06:25:19.438241 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19298498, "process_user_time": 1.401748, "process_kernel_time": 0.114897, "process_mem_max_rss": "99836", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:25:19.438814 [debug] [MainThread]: Command `dbt clean` succeeded at 06:25:19.438710 after 0.19 seconds
[0m06:25:19.439250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a1becb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a14b0170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a17b3b00>]}
[0m06:25:19.439725 [debug] [MainThread]: Flushing usage events
[0m14:24:07.784957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e436b9fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e436b8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e436b9d60>]}


============================== 14:24:07.793642 | 45692165-76d6-4a73-8775-823b44a6bd69 ==============================
[0m14:24:07.793642 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:24:07.794314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:24:07.956647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45692165-76d6-4a73-8775-823b44a6bd69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e45326ab0>]}
[0m14:24:07.971969 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-v7_c7lc0'
[0m14:24:07.972462 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:24:08.071668 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:24:08.073063 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:24:08.106053 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:24:08.111283 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:24:08.292277 [info ] [MainThread]: Installed from version 1.2.0
[0m14:24:08.292896 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:24:08.293448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '45692165-76d6-4a73-8775-823b44a6bd69', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e43453590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e433d7f20>]}
[0m14:24:08.293905 [info ] [MainThread]: 
[0m14:24:08.294403 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:24:08.296247 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.562931, "process_user_time": 1.653568, "process_kernel_time": 0.142703, "process_mem_max_rss": "101240", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m14:24:08.296795 [debug] [MainThread]: Command `dbt deps` succeeded at 14:24:08.296692 after 0.56 seconds
[0m14:24:08.297249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e436b3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e449e7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e436334d0>]}
[0m14:24:08.297663 [debug] [MainThread]: Flushing usage events
[0m14:24:09.855570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f443952aae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f443a061340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f443a6ca840>]}


============================== 14:24:09.858621 | 4790bfc9-3812-4da9-bdee-58daa6a1862b ==============================
[0m14:24:09.858621 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:24:09.859286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:24:10.088469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4790bfc9-3812-4da9-bdee-58daa6a1862b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44392ef8c0>]}
[0m14:24:10.149868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4790bfc9-3812-4da9-bdee-58daa6a1862b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44391f0b00>]}
[0m14:24:10.151725 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:24:10.168661 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:24:10.169431 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:24:10.169979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4790bfc9-3812-4da9-bdee-58daa6a1862b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4431d43170>]}
[0m14:24:11.558266 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:24:11.558921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4790bfc9-3812-4da9-bdee-58daa6a1862b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4439287110>]}
[0m14:24:11.801597 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:24:11.806772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4790bfc9-3812-4da9-bdee-58daa6a1862b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4439ff10a0>]}
[0m14:24:11.896969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4790bfc9-3812-4da9-bdee-58daa6a1862b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4431c9e060>]}
[0m14:24:11.897542 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:24:11.898029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4790bfc9-3812-4da9-bdee-58daa6a1862b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4431c563c0>]}
[0m14:24:11.900024 [info ] [MainThread]: 
[0m14:24:11.900703 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:24:11.905499 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:24:11.941772 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:24:11.942271 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:24:11.942668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:12.390612 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:24:12.394195 [debug] [ThreadPool]: On list_petro: Close
[0m14:24:12.395754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:24:12.396763 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:24:12.404344 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:24:12.404766 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:24:12.405164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:12.406313 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:24:12.407630 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:24:12.408021 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:24:12.408643 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:24:12.409019 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:24:12.409422 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:24:12.410018 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:24:12.410943 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:24:12.411354 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:24:12.411713 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:24:12.412298 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:24:12.412690 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:24:12.413888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:24:12.419660 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:24:12.420058 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:24:12.420442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:12.421107 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:24:12.421494 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:24:12.421866 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:24:12.432342 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:24:12.433704 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:24:12.434896 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:24:12.435304 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:24:12.436473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4790bfc9-3812-4da9-bdee-58daa6a1862b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f443b2ca750>]}
[0m14:24:12.437044 [debug] [MainThread]: Using duckdb connection "master"
[0m14:24:12.437488 [debug] [MainThread]: On master: BEGIN
[0m14:24:12.437854 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:12.438546 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:24:12.438940 [debug] [MainThread]: On master: COMMIT
[0m14:24:12.439337 [debug] [MainThread]: Using duckdb connection "master"
[0m14:24:12.439701 [debug] [MainThread]: On master: COMMIT
[0m14:24:12.440293 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:24:12.440691 [debug] [MainThread]: On master: Close
[0m14:24:12.441216 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:24:12.441688 [info ] [MainThread]: 
[0m14:24:12.451579 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:24:12.452196 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:24:12.452767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:24:12.453223 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:24:12.480299 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:24:12.481047 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:24:12.516344 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:24:12.517181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:20.923117 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:24:20.923709 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:24:20.924467 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:20.924904 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:24:20.925346 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:24:20.926328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:20.927681 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:24:20.928138 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:24:20.929130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:20.936949 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:24:20.937438 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:24:20.938185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:20.941158 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:24:20.941604 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:24:20.942342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:20.958770 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:24:20.959253 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:24:20.959670 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:24:20.961007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:20.966616 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:24:20.967089 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:24:20.968537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:20.970950 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:24:20.972486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4790bfc9-3812-4da9-bdee-58daa6a1862b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44315b9670>]}
[0m14:24:20.973194 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.52s]
[0m14:24:20.973965 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:24:20.974811 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:24:20.975582 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:24:20.976229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:24:20.976671 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:24:20.981638 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:24:20.982306 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:24:21.018225 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:24:21.018731 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260205142421012252"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:24:21.019201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:21.026281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:21.033907 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:24:21.034394 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:24:21.035101 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:21.035532 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:24:21.035947 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260205142421012252'
      
      
      order by ordinal_position

  
[0m14:24:21.038353 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:21.043504 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:24:21.043956 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:24:21.046344 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:21.053987 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:24:21.054460 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:24:21.056770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:21.058441 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:24:21.058881 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:24:21.059636 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:21.077798 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:24:21.078512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:24:21.078954 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260205142421012252"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260205142421012252"
    )
  
[0m14:24:21.089678 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:21.091589 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:24:21.092030 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:24:21.092461 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:24:21.098936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:21.099841 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:24:21.100530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4790bfc9-3812-4da9-bdee-58daa6a1862b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ee141310>]}
[0m14:24:21.101215 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m14:24:21.101938 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:24:21.103832 [debug] [MainThread]: Using duckdb connection "master"
[0m14:24:21.104344 [debug] [MainThread]: On master: BEGIN
[0m14:24:21.104785 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:24:21.105549 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:24:21.105944 [debug] [MainThread]: On master: COMMIT
[0m14:24:21.106398 [debug] [MainThread]: Using duckdb connection "master"
[0m14:24:21.106767 [debug] [MainThread]: On master: COMMIT
[0m14:24:21.107404 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:24:21.107799 [debug] [MainThread]: On master: Close
[0m14:24:21.108303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:21.108667 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:24:21.109061 [info ] [MainThread]: 
[0m14:24:21.109570 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.21 seconds (9.21s).
[0m14:24:21.110472 [debug] [MainThread]: Command end result
[0m14:24:21.135913 [info ] [MainThread]: 
[0m14:24:21.136489 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:24:21.136946 [info ] [MainThread]: 
[0m14:24:21.137434 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:24:21.138391 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.334239, "process_user_time": 5.687762, "process_kernel_time": 0.286138, "process_mem_max_rss": "282532", "process_in_blocks": "1200", "process_out_blocks": "107224"}
[0m14:24:21.138943 [debug] [MainThread]: Command `dbt run` succeeded at 14:24:21.138828 after 11.33 seconds
[0m14:24:21.139398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44315f56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4431c8d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f443992f260>]}
[0m14:24:21.139831 [debug] [MainThread]: Flushing usage events
[0m14:24:22.882948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4f2ee4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4d482840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5063f500>]}


============================== 14:24:22.886177 | 5062413a-bf8d-412d-90cb-52ae008a6cf1 ==============================
[0m14:24:22.886177 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:24:22.886868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:24:23.001131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5062413a-bf8d-412d-90cb-52ae008a6cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4ef4c8c0>]}
[0m14:24:23.019326 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18802279, "process_user_time": 1.333042, "process_kernel_time": 0.108921, "process_mem_max_rss": "99672", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:24:23.019870 [debug] [MainThread]: Command `dbt clean` succeeded at 14:24:23.019768 after 0.19 seconds
[0m14:24:23.020334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4d2f1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4d117860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4dacda30>]}
[0m14:24:23.020832 [debug] [MainThread]: Flushing usage events
[0m22:08:52.261873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2539e595e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2539a79790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2539a78500>]}


============================== 22:08:52.281075 | 8222d668-fafa-4e77-8a73-de25e1855255 ==============================
[0m22:08:52.281075 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:08:52.281808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:08:52.409660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8222d668-fafa-4e77-8a73-de25e1855255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f253b72f500>]}
[0m22:08:52.425542 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-i1fswyl0'
[0m22:08:52.426099 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:08:52.513670 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:08:52.515374 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:08:52.548719 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:08:52.554526 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:08:52.764958 [info ] [MainThread]: Installed from version 1.2.0
[0m22:08:52.765597 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:08:52.766248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8222d668-fafa-4e77-8a73-de25e1855255', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25398876e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25397b0f50>]}
[0m22:08:52.766718 [info ] [MainThread]: 
[0m22:08:52.767246 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:08:52.769174 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.56019115, "process_user_time": 1.711536, "process_kernel_time": 0.160143, "process_mem_max_rss": "101480", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m22:08:52.769734 [debug] [MainThread]: Command `dbt deps` succeeded at 22:08:52.769628 after 0.56 seconds
[0m22:08:52.770200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2539e9af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2539be1d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25397a9520>]}
[0m22:08:52.770624 [debug] [MainThread]: Flushing usage events
[0m22:08:54.556084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd253d3ca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2539c5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd253cb8ce0>]}


============================== 22:08:54.559459 | 36a3a434-d8ca-4c9a-91f7-8c1818518600 ==============================
[0m22:08:54.559459 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:08:54.560214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:08:54.808188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36a3a434-d8ca-4c9a-91f7-8c1818518600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2539c5e50>]}
[0m22:08:54.873303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36a3a434-d8ca-4c9a-91f7-8c1818518600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2537fac30>]}
[0m22:08:54.875312 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:08:54.903608 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:08:54.904503 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:08:54.905118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '36a3a434-d8ca-4c9a-91f7-8c1818518600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2549048f0>]}
[0m22:08:56.341341 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:08:56.342082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '36a3a434-d8ca-4c9a-91f7-8c1818518600', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd24c08dac0>]}
[0m22:08:56.613553 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:08:56.619587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36a3a434-d8ca-4c9a-91f7-8c1818518600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd24b9dd070>]}
[0m22:08:56.724819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36a3a434-d8ca-4c9a-91f7-8c1818518600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd24c0d3f20>]}
[0m22:08:56.725504 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:08:56.726068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36a3a434-d8ca-4c9a-91f7-8c1818518600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd24c0c0560>]}
[0m22:08:56.728391 [info ] [MainThread]: 
[0m22:08:56.729215 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:08:56.734504 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:08:56.774045 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:08:56.774631 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:08:56.775108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:57.350760 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:08:57.352543 [debug] [ThreadPool]: On list_petro: Close
[0m22:08:57.353522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:08:57.354115 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:08:57.362410 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:57.363119 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:08:57.363665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:57.365558 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:57.367103 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:57.367524 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:08:57.368516 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:57.368936 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:57.369309 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:08:57.370049 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:57.371098 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:08:57.371498 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:57.371881 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:08:57.372529 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:57.372963 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:08:57.374348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:08:57.380951 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:08:57.381452 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:08:57.381840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:57.383058 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:57.383471 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:08:57.383873 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:08:57.395224 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:57.396944 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:08:57.398272 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:08:57.398693 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:08:57.399951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36a3a434-d8ca-4c9a-91f7-8c1818518600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd24b9ddca0>]}
[0m22:08:57.400521 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:57.400957 [debug] [MainThread]: On master: BEGIN
[0m22:08:57.401335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:57.402279 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:57.402695 [debug] [MainThread]: On master: COMMIT
[0m22:08:57.403116 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:57.403486 [debug] [MainThread]: On master: COMMIT
[0m22:08:57.404121 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:57.404527 [debug] [MainThread]: On master: Close
[0m22:08:57.405099 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:08:57.405587 [info ] [MainThread]: 
[0m22:08:57.427377 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:08:57.428117 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:08:57.428778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:08:57.429252 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:08:57.458436 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:08:57.459394 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:08:57.497354 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:08:57.498332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:20.409714 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:20.410296 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:11:20.411056 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:20.411501 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:20.411964 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:11:20.412938 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:20.414307 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:20.414752 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:11:20.415829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:20.423932 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:20.424402 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:11:20.425239 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:20.428352 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:20.428792 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:11:20.429528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:20.446358 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:11:20.446902 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:20.447340 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:11:20.448817 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:20.454774 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:20.455287 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:11:20.456704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:20.459239 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:11:20.460812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36a3a434-d8ca-4c9a-91f7-8c1818518600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd24b9f13a0>]}
[0m22:11:20.461539 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 143.03s]
[0m22:11:20.462346 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:11:20.463206 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:11:20.463779 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:11:20.464420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:11:20.464912 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:11:20.470203 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:11:20.471143 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:11:20.508591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:20.509196 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260205221120502345"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:11:20.509662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:20.517514 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:20.525907 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:20.526403 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:11:20.527157 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:20.527600 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:20.528053 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260205221120502345'
      
      
      order by ordinal_position

  
[0m22:11:20.530654 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:20.536349 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:20.536840 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:11:20.539590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:20.547701 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:20.548203 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:11:20.551471 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:20.553261 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:20.553717 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:11:20.554489 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:20.573521 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:11:20.574344 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:20.574818 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260205221120502345"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260205221120502345"
    )
  
[0m22:11:20.586606 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:20.588646 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:11:20.589167 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:20.589582 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:11:20.596003 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:20.597010 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:11:20.597739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36a3a434-d8ca-4c9a-91f7-8c1818518600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2102c2390>]}
[0m22:11:20.598460 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m22:11:20.599238 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:11:20.601250 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:20.601667 [debug] [MainThread]: On master: BEGIN
[0m22:11:20.602088 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:11:20.602811 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:20.603235 [debug] [MainThread]: On master: COMMIT
[0m22:11:20.603603 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:20.603992 [debug] [MainThread]: On master: COMMIT
[0m22:11:20.604564 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:20.604991 [debug] [MainThread]: On master: Close
[0m22:11:20.605448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:20.605801 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:11:20.606239 [info ] [MainThread]: 
[0m22:11:20.606716 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 2 minutes and 23.88 seconds (143.88s).
[0m22:11:20.607700 [debug] [MainThread]: Command end result
[0m22:11:20.633256 [info ] [MainThread]: 
[0m22:11:20.633897 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:11:20.634391 [info ] [MainThread]: 
[0m22:11:20.634896 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:11:20.635897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 146.13489, "process_user_time": 6.080476, "process_kernel_time": 0.311126, "process_mem_max_rss": "317488", "process_in_blocks": "1200", "process_out_blocks": "107344"}
[0m22:11:20.636427 [debug] [MainThread]: Command `dbt run` succeeded at 22:11:20.636327 after 146.14 seconds
[0m22:11:20.636880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2542714f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd253a6d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd253d63ef0>]}
[0m22:11:20.637310 [debug] [MainThread]: Flushing usage events
[0m22:11:22.607449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd8dc5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd8fd80b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd9867560>]}


============================== 22:11:22.610764 | 67996848-51b9-4aec-9d5b-3d05f2ff6332 ==============================
[0m22:11:22.610764 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:11:22.611522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:11:22.728445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67996848-51b9-4aec-9d5b-3d05f2ff6332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd8761f70>]}
[0m22:11:22.749090 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1960428, "process_user_time": 1.414823, "process_kernel_time": 0.101915, "process_mem_max_rss": "99744", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:11:22.749655 [debug] [MainThread]: Command `dbt clean` succeeded at 22:11:22.749548 after 0.20 seconds
[0m22:11:22.750115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd8d12630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd87b27b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd8762480>]}
[0m22:11:22.750547 [debug] [MainThread]: Flushing usage events
[0m06:23:00.348373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f2f58d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f10054f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f0e66e40>]}


============================== 06:23:00.375462 | 88e283b2-4e9e-4a03-8dae-8e021b438e77 ==============================
[0m06:23:00.375462 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:23:00.376143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:23:00.719737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88e283b2-4e9e-4a03-8dae-8e021b438e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f14c4ec0>]}
[0m06:23:00.736101 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wlldmb94'
[0m06:23:00.736658 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:23:00.892961 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:23:00.894733 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:23:00.969050 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:23:00.974727 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:23:01.168809 [info ] [MainThread]: Installed from version 1.2.0
[0m06:23:01.169502 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:23:01.170145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '88e283b2-4e9e-4a03-8dae-8e021b438e77', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f0d05d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f0d051c0>]}
[0m06:23:01.170657 [info ] [MainThread]: 
[0m06:23:01.171196 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:23:01.222589 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.92575246, "process_user_time": 1.690523, "process_kernel_time": 0.157048, "process_mem_max_rss": "101452", "process_in_blocks": "8520", "process_out_blocks": "5168"}
[0m06:23:01.223403 [debug] [MainThread]: Command `dbt deps` succeeded at 06:23:01.223241 after 0.93 seconds
[0m06:23:01.223915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f54d3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f0cca180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f123dee0>]}
[0m06:23:01.224428 [debug] [MainThread]: Flushing usage events
[0m06:23:02.924124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14f01362d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14f14cf320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ee0267e0>]}


============================== 06:23:02.927235 | 61f84e96-04a0-4d5b-9e96-01fa3ca935ff ==============================
[0m06:23:02.927235 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:23:02.927962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:23:03.158211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61f84e96-04a0-4d5b-9e96-01fa3ca935ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14e697ccb0>]}
[0m06:23:03.219701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61f84e96-04a0-4d5b-9e96-01fa3ca935ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ee025190>]}
[0m06:23:03.221577 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:23:03.279367 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:23:03.280204 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:23:03.280799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '61f84e96-04a0-4d5b-9e96-01fa3ca935ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14e6841c10>]}
[0m06:23:04.681760 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:23:04.682447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '61f84e96-04a0-4d5b-9e96-01fa3ca935ff', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14edde84a0>]}
[0m06:23:04.925208 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:23:04.930682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61f84e96-04a0-4d5b-9e96-01fa3ca935ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14e60d0290>]}
[0m06:23:05.466838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61f84e96-04a0-4d5b-9e96-01fa3ca935ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14e68edd90>]}
[0m06:23:05.467501 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:23:05.468052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61f84e96-04a0-4d5b-9e96-01fa3ca935ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14e6132a50>]}
[0m06:23:05.470209 [info ] [MainThread]: 
[0m06:23:05.470999 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:23:05.476093 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:23:05.518874 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:23:05.519435 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:23:05.519844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:23:05.955288 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:23:05.957466 [debug] [ThreadPool]: On list_petro: Close
[0m06:23:05.958604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:23:05.959406 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:23:05.967535 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:23:05.967967 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:23:05.968370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:23:05.969411 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:23:05.970754 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:23:05.971145 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:23:05.971777 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:23:05.972160 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:23:05.972569 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:23:05.973250 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:23:05.974201 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:23:05.974612 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:23:05.974970 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:23:05.975545 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:23:05.975954 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:23:05.977194 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:23:05.983285 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:23:05.983707 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:23:05.984071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:23:05.984777 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:23:05.985166 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:23:05.985590 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:23:05.996839 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:23:05.998265 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:23:05.999518 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:23:05.999917 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:23:06.001016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61f84e96-04a0-4d5b-9e96-01fa3ca935ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14e60b9460>]}
[0m06:23:06.001595 [debug] [MainThread]: Using duckdb connection "master"
[0m06:23:06.001982 [debug] [MainThread]: On master: BEGIN
[0m06:23:06.002368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:23:06.003028 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:23:06.003451 [debug] [MainThread]: On master: COMMIT
[0m06:23:06.003821 [debug] [MainThread]: Using duckdb connection "master"
[0m06:23:06.004182 [debug] [MainThread]: On master: COMMIT
[0m06:23:06.004783 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:23:06.005177 [debug] [MainThread]: On master: Close
[0m06:23:06.005693 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:23:06.006195 [info ] [MainThread]: 
[0m06:23:06.057830 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:23:06.058539 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:23:06.059247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:23:06.059725 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:23:06.086908 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:23:06.087765 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:23:06.123478 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:23:06.124424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:14.804269 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:23:14.804853 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:23:14.805579 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:23:14.806021 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:23:14.806482 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:23:14.807439 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:23:14.808779 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:23:14.809221 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:23:14.810429 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:23:14.818285 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:23:14.818778 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:23:14.819528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:23:14.822513 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:23:14.822957 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:23:14.823689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:23:14.840159 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:23:14.840649 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:23:14.841065 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:23:14.842975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:23:14.848600 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:23:14.849058 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:23:14.850247 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:23:14.852663 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:23:14.854172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f84e96-04a0-4d5b-9e96-01fa3ca935ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14e5f3ebd0>]}
[0m06:23:14.854868 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.79s]
[0m06:23:14.855655 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:23:14.856660 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:23:14.857234 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:23:14.857920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:23:14.858394 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:23:14.863301 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:23:14.863956 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:23:14.899381 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:23:14.899874 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260206062314893437"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:23:14.900338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:14.907189 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:23:14.914787 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:23:14.915246 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:23:14.915961 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:23:14.916423 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:23:14.916857 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260206062314893437'
      
      
      order by ordinal_position

  
[0m06:23:14.919240 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:23:14.924407 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:23:14.924872 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:23:14.927210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:23:14.934864 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:23:14.935343 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:23:14.937987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:23:14.939672 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:23:14.940114 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:23:14.940833 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:23:14.959068 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:23:14.959801 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:23:14.960253 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260206062314893437"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260206062314893437"
    )
  
[0m06:23:14.968300 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:23:14.970063 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:23:14.970572 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:23:14.970985 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:23:14.977937 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:23:14.978822 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:23:14.979495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f84e96-04a0-4d5b-9e96-01fa3ca935ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149ea187a0>]}
[0m06:23:14.980145 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m06:23:14.980971 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:23:14.982743 [debug] [MainThread]: Using duckdb connection "master"
[0m06:23:14.983149 [debug] [MainThread]: On master: BEGIN
[0m06:23:14.983568 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:23:14.984272 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:23:14.984705 [debug] [MainThread]: On master: COMMIT
[0m06:23:14.985074 [debug] [MainThread]: Using duckdb connection "master"
[0m06:23:14.985480 [debug] [MainThread]: On master: COMMIT
[0m06:23:14.986082 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:23:14.986545 [debug] [MainThread]: On master: Close
[0m06:23:14.987005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:23:14.987386 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:23:14.987781 [info ] [MainThread]: 
[0m06:23:14.988294 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.52 seconds (9.52s).
[0m06:23:14.989285 [debug] [MainThread]: Command end result
[0m06:23:15.014676 [info ] [MainThread]: 
[0m06:23:15.015306 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:23:15.015858 [info ] [MainThread]: 
[0m06:23:15.016406 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:23:15.017442 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.144684, "process_user_time": 5.393625, "process_kernel_time": 0.301755, "process_mem_max_rss": "294484", "process_in_blocks": "1200", "process_out_blocks": "107400"}
[0m06:23:15.017986 [debug] [MainThread]: Command `dbt run` succeeded at 06:23:15.017883 after 12.15 seconds
[0m06:23:15.018440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ee0260f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ee026900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14e60f5fd0>]}
[0m06:23:15.018878 [debug] [MainThread]: Flushing usage events
[0m06:23:16.799729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b9d893bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b9dda93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ba089b5c0>]}


============================== 06:23:16.802754 | cb848a00-f709-4b1a-ba63-65d1bfdbbbbd ==============================
[0m06:23:16.802754 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:23:16.803415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:23:16.917084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb848a00-f709-4b1a-ba63-65d1bfdbbbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b9f1947a0>]}
[0m06:23:16.935245 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18716496, "process_user_time": 1.353959, "process_kernel_time": 0.10292, "process_mem_max_rss": "99932", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:23:16.935818 [debug] [MainThread]: Command `dbt clean` succeeded at 06:23:16.935715 after 0.19 seconds
[0m06:23:16.936245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b9d326150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b9d146450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b9e5c7fb0>]}
[0m06:23:16.936697 [debug] [MainThread]: Flushing usage events
[0m14:21:56.766623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf37f1580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf40e09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf3c4dd30>]}


============================== 14:21:56.785630 | 91274abd-0b02-481e-9d7b-792b1d8a16f7 ==============================
[0m14:21:56.785630 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:21:56.786312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:21:56.960505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91274abd-0b02-481e-9d7b-792b1d8a16f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf400ac60>]}
[0m14:21:56.976630 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-iijpr_h6'
[0m14:21:56.977137 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:21:57.112767 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:21:57.114323 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:21:57.147511 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:21:57.153066 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:21:57.226422 [info ] [MainThread]: Installed from version 1.2.0
[0m14:21:57.227089 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:21:57.227718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '91274abd-0b02-481e-9d7b-792b1d8a16f7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf2ce7170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf38ddac0>]}
[0m14:21:57.228176 [info ] [MainThread]: 
[0m14:21:57.228707 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:21:57.239703 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5264502, "process_user_time": 1.682207, "process_kernel_time": 0.155296, "process_mem_max_rss": "101360", "process_in_blocks": "8504", "process_out_blocks": "5168"}
[0m14:21:57.240276 [debug] [MainThread]: Command `dbt deps` succeeded at 14:21:57.240170 after 0.53 seconds
[0m14:21:57.240748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf400ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf2f16000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf4ac2b70>]}
[0m14:21:57.241190 [debug] [MainThread]: Flushing usage events
[0m14:21:58.903565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f324f3e9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f325095d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3251bc7440>]}


============================== 14:21:58.906893 | 69a3199f-45ff-4db9-a507-6fb9bdd41f7d ==============================
[0m14:21:58.906893 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:21:58.907640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:21:59.152267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69a3199f-45ff-4db9-a507-6fb9bdd41f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f324e55e720>]}
[0m14:21:59.216309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69a3199f-45ff-4db9-a507-6fb9bdd41f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f324f9ed310>]}
[0m14:21:59.218316 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:21:59.246480 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:21:59.247311 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:21:59.247885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '69a3199f-45ff-4db9-a507-6fb9bdd41f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3247160ec0>]}
[0m14:22:00.689587 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:22:00.690259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '69a3199f-45ff-4db9-a507-6fb9bdd41f7d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32471111f0>]}
[0m14:22:00.950357 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:22:00.956384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69a3199f-45ff-4db9-a507-6fb9bdd41f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32468b8470>]}
[0m14:22:01.059335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69a3199f-45ff-4db9-a507-6fb9bdd41f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f324697fa10>]}
[0m14:22:01.059972 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:22:01.060520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69a3199f-45ff-4db9-a507-6fb9bdd41f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f324674c9e0>]}
[0m14:22:01.062703 [info ] [MainThread]: 
[0m14:22:01.063449 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:22:01.068754 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:22:01.107976 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:22:01.108520 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:22:01.108965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:01.735250 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:22:01.737181 [debug] [ThreadPool]: On list_petro: Close
[0m14:22:01.738274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:22:01.739038 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:22:01.748117 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:22:01.748568 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:22:01.748957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:01.750069 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:01.751575 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:22:01.752092 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:22:01.752844 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:01.753232 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:22:01.753627 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:22:01.754274 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:01.755198 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:22:01.755606 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:22:01.755976 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:22:01.756569 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:01.756973 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:22:01.758208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:22:01.764227 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:22:01.764658 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:22:01.765025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:01.765763 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:01.766163 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:22:01.766529 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:22:01.777846 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:01.779362 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:22:01.780623 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:22:01.781020 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:22:01.782143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69a3199f-45ff-4db9-a507-6fb9bdd41f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32468fdee0>]}
[0m14:22:01.782712 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:01.783121 [debug] [MainThread]: On master: BEGIN
[0m14:22:01.783499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:22:01.784281 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:22:01.784746 [debug] [MainThread]: On master: COMMIT
[0m14:22:01.785138 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:01.785518 [debug] [MainThread]: On master: COMMIT
[0m14:22:01.786115 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:22:01.786518 [debug] [MainThread]: On master: Close
[0m14:22:01.787078 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:22:01.787588 [info ] [MainThread]: 
[0m14:22:01.809360 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:22:01.810017 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:22:01.810701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:22:01.811150 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:22:01.839031 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:22:01.839933 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:22:01.876317 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:22:01.877261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:09.336163 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:09.336726 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:22:09.337415 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:09.337886 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:09.338301 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:22:09.339257 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:09.340634 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:09.341094 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:22:09.342161 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:09.349963 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:09.350420 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:22:09.351179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:09.354088 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:09.354531 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:22:09.355328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:09.372104 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:22:09.372610 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:09.373036 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:22:09.376729 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:09.382523 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:09.383018 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:22:09.384382 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:09.386890 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:22:09.388472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a3199f-45ff-4db9-a507-6fb9bdd41f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32454d7680>]}
[0m14:22:09.389195 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.58s]
[0m14:22:09.389965 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:22:09.390877 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:22:09.391433 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:22:09.392152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:22:09.392643 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:22:09.397788 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:22:09.398461 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:22:09.434862 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:09.435390 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260206142209428787"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:22:09.435872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:09.443409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:09.451312 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:09.451803 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:22:09.452510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:09.452979 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:09.453401 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260206142209428787'
      
      
      order by ordinal_position

  
[0m14:22:09.455978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:09.461667 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:09.462150 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:22:09.464671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:09.472789 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:09.473255 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:22:09.476009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:09.477824 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:09.478282 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:22:09.479063 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:09.497771 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:22:09.498571 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:09.499048 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260206142209428787"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260206142209428787"
    )
  
[0m14:22:09.508192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:09.510042 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:22:09.510487 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:09.510945 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:22:09.517301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:09.518233 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:22:09.518932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a3199f-45ff-4db9-a507-6fb9bdd41f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3206afb7d0>]}
[0m14:22:09.519614 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m14:22:09.520349 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:22:09.521982 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:09.522400 [debug] [MainThread]: On master: BEGIN
[0m14:22:09.522819 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:22:09.523503 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:22:09.523940 [debug] [MainThread]: On master: COMMIT
[0m14:22:09.524332 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:09.524745 [debug] [MainThread]: On master: COMMIT
[0m14:22:09.525353 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:22:09.525796 [debug] [MainThread]: On master: Close
[0m14:22:09.526273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:09.526692 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:22:09.527112 [info ] [MainThread]: 
[0m14:22:09.527618 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.46 seconds (8.46s).
[0m14:22:09.528595 [debug] [MainThread]: Command end result
[0m14:22:09.554917 [info ] [MainThread]: 
[0m14:22:09.555508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:09.556017 [info ] [MainThread]: 
[0m14:22:09.556525 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:22:09.557518 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.709303, "process_user_time": 6.093281, "process_kernel_time": 0.290013, "process_mem_max_rss": "281744", "process_in_blocks": "1200", "process_out_blocks": "107392"}
[0m14:22:09.558116 [debug] [MainThread]: Command `dbt run` succeeded at 14:22:09.558012 after 10.71 seconds
[0m14:22:09.558578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f324e792420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3207b6efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3247187710>]}
[0m14:22:09.559020 [debug] [MainThread]: Flushing usage events
[0m14:22:11.326679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7efe66bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7efe409cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7efe8d9f40>]}


============================== 14:22:11.330133 | 8be72c69-1173-4d9d-8e20-04c1a5506b7d ==============================
[0m14:22:11.330133 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:22:11.330851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:22:11.448743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8be72c69-1173-4d9d-8e20-04c1a5506b7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7efe0cee10>]}
[0m14:22:11.466927 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19459565, "process_user_time": 1.385337, "process_kernel_time": 0.109868, "process_mem_max_rss": "99560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:22:11.467463 [debug] [MainThread]: Command `dbt clean` succeeded at 14:22:11.467364 after 0.20 seconds
[0m14:22:11.467959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7efeb45e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7efe062180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7efe8db6e0>]}
[0m14:22:11.468392 [debug] [MainThread]: Flushing usage events
[0m22:06:58.805367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c35fb7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c334e6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c32f82d50>]}


============================== 22:06:58.823658 | 4d2014d0-a3b3-44e4-b322-ec236ad2bccc ==============================
[0m22:06:58.823658 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:58.824299 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:58.982240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d2014d0-a3b3-44e4-b322-ec236ad2bccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c32c75be0>]}
[0m22:06:58.997629 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-om1balz8'
[0m22:06:58.998101 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:59.091286 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:59.092561 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:59.126342 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:59.131505 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:59.203627 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:59.204176 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:06:59.204731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4d2014d0-a3b3-44e4-b322-ec236ad2bccc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c329ae810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c329aecc0>]}
[0m22:06:59.205183 [info ] [MainThread]: 
[0m22:06:59.205695 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:59.212701 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46087766, "process_user_time": 1.635731, "process_kernel_time": 0.15025, "process_mem_max_rss": "101300", "process_in_blocks": "8504", "process_out_blocks": "5168"}
[0m22:06:59.213252 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:59.213149 after 0.46 seconds
[0m22:06:59.213702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c3346f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c32cd61b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c32c75be0>]}
[0m22:06:59.214132 [debug] [MainThread]: Flushing usage events
[0m22:07:00.829946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41d8757f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41dbb1f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41d8756a20>]}


============================== 22:07:00.833065 | e6c8c11a-aab5-4701-924c-99bd8e396076 ==============================
[0m22:07:00.833065 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:00.833755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:07:01.063032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6c8c11a-aab5-4701-924c-99bd8e396076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41da444d70>]}
[0m22:07:01.123545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6c8c11a-aab5-4701-924c-99bd8e396076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41d87cee70>]}
[0m22:07:01.125267 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:07:01.151288 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:07:01.152002 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:07:01.152521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e6c8c11a-aab5-4701-924c-99bd8e396076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41d83cb8c0>]}
[0m22:07:02.537710 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:07:02.538394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e6c8c11a-aab5-4701-924c-99bd8e396076', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41d072e660>]}
[0m22:07:02.779105 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:07:02.784520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6c8c11a-aab5-4701-924c-99bd8e396076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41d07e10a0>]}
[0m22:07:02.876342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6c8c11a-aab5-4701-924c-99bd8e396076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41d0ec2540>]}
[0m22:07:02.876947 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:07:02.877454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6c8c11a-aab5-4701-924c-99bd8e396076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41d85ef7a0>]}
[0m22:07:02.879521 [info ] [MainThread]: 
[0m22:07:02.880278 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:07:02.885113 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:07:02.921662 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:07:02.922128 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:07:02.922519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:03.430645 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:07:03.432997 [debug] [ThreadPool]: On list_petro: Close
[0m22:07:03.434173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:07:03.434857 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:07:03.444168 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:03.444629 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:07:03.445282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:03.446897 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:03.448287 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:03.448724 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:07:03.449663 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:03.450058 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:03.450488 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:07:03.451223 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:03.452310 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:03.452750 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:03.453174 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:03.453819 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:03.454256 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:07:03.455768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:07:03.462148 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:03.462630 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:07:03.463004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:03.463704 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:03.464147 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:03.464547 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:07:03.475904 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:03.477387 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:07:03.478669 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:07:03.479070 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:07:03.480294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6c8c11a-aab5-4701-924c-99bd8e396076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41da47ebd0>]}
[0m22:07:03.480860 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:03.481286 [debug] [MainThread]: On master: BEGIN
[0m22:07:03.481734 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:03.482420 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:03.482909 [debug] [MainThread]: On master: COMMIT
[0m22:07:03.483295 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:03.483711 [debug] [MainThread]: On master: COMMIT
[0m22:07:03.484370 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:03.484797 [debug] [MainThread]: On master: Close
[0m22:07:03.485320 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:07:03.485825 [info ] [MainThread]: 
[0m22:07:03.508821 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:07:03.509419 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:07:03.510089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:07:03.510524 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:07:03.544345 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:07:03.545116 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:07:03.581318 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:07:03.582092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:10.970596 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:10.971166 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:10.971893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:10.972340 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:10.972788 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:10.973730 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:10.975075 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:10.975527 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:10.976510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:10.984332 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:10.984820 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:10.985619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:10.988524 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:10.988995 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:10.989731 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:11.006399 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:11.006890 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:11.007309 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:11.009100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:11.014743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:11.015204 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:11.016373 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:11.018770 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:11.020280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6c8c11a-aab5-4701-924c-99bd8e396076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41d068ac90>]}
[0m22:07:11.020983 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.51s]
[0m22:07:11.021834 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:11.022662 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:11.023216 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:11.023887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:11.024341 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:11.029297 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:11.030121 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:11.066003 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:11.066497 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260206220711059937"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:11.066981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:11.074529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:11.082059 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:11.082513 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:11.083184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:11.083637 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:11.084068 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260206220711059937'
      
      
      order by ordinal_position

  
[0m22:07:11.086560 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:11.091723 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:11.092193 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:11.094749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:11.102439 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:11.102924 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:11.105215 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:11.106898 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:11.107354 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:07:11.108077 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:11.126406 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:11.127146 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:11.127621 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260206220711059937"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260206220711059937"
    )
  
[0m22:07:11.137288 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:11.139083 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:11.139526 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:11.139986 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:11.146787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:11.147763 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:11.148500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6c8c11a-aab5-4701-924c-99bd8e396076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41b807d5e0>]}
[0m22:07:11.149206 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m22:07:11.150046 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:11.151877 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:11.152285 [debug] [MainThread]: On master: BEGIN
[0m22:07:11.152700 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:11.153434 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:11.153873 [debug] [MainThread]: On master: COMMIT
[0m22:07:11.154270 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:11.154695 [debug] [MainThread]: On master: COMMIT
[0m22:07:11.155316 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:11.155792 [debug] [MainThread]: On master: Close
[0m22:07:11.156302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:11.156741 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:11.157185 [info ] [MainThread]: 
[0m22:07:11.157673 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.28 seconds (8.28s).
[0m22:07:11.158612 [debug] [MainThread]: Command end result
[0m22:07:11.184266 [info ] [MainThread]: 
[0m22:07:11.184848 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:11.185301 [info ] [MainThread]: 
[0m22:07:11.185786 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:11.186745 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.408619, "process_user_time": 5.392088, "process_kernel_time": 0.282318, "process_mem_max_rss": "299748", "process_in_blocks": "1200", "process_out_blocks": "107432"}
[0m22:07:11.187273 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:11.187174 after 10.41 seconds
[0m22:07:11.187739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41d8756a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f418e39f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41d8b53c20>]}
[0m22:07:11.188166 [debug] [MainThread]: Flushing usage events
[0m22:07:12.862921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38f9a1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38fc2cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38fd38ef0>]}


============================== 22:07:12.866120 | 9bbbf911-c4a8-4e4c-b741-e65b83bb5042 ==============================
[0m22:07:12.866120 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:12.866782 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:07:12.980779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bbbf911-c4a8-4e4c-b741-e65b83bb5042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb39105c5f0>]}
[0m22:07:12.998804 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18818101, "process_user_time": 1.334436, "process_kernel_time": 0.105955, "process_mem_max_rss": "99516", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:12.999355 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:12.999249 after 0.19 seconds
[0m22:07:12.999825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38f9a1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38fce3d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38f733a70>]}
[0m22:07:13.000253 [debug] [MainThread]: Flushing usage events
[0m06:16:58.023806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46b4fe6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46ab622a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46b4fe960>]}


============================== 06:16:58.032488 | 5a4d6227-fef0-46e4-8a4e-147d8fedcd85 ==============================
[0m06:16:58.032488 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:16:58.033238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:16:58.156540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a4d6227-fef0-46e4-8a4e-147d8fedcd85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46ae50e90>]}
[0m06:16:58.171873 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-bvvaaoib'
[0m06:16:58.172378 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:16:58.370619 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:16:58.372263 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:16:58.421776 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:16:58.427164 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:16:58.499574 [info ] [MainThread]: Installed from version 1.2.0
[0m06:16:58.500204 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:16:58.500701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5a4d6227-fef0-46e4-8a4e-147d8fedcd85', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46aa1b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46b879130>]}
[0m06:16:58.501174 [info ] [MainThread]: 
[0m06:16:58.501623 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:16:58.503754 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.53151125, "process_user_time": 1.638082, "process_kernel_time": 0.147736, "process_mem_max_rss": "101468", "process_in_blocks": "8496", "process_out_blocks": "5168"}
[0m06:16:58.504327 [debug] [MainThread]: Command `dbt deps` succeeded at 06:16:58.504222 after 0.53 seconds
[0m06:16:58.504751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46bbd7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46aa546b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46aa54170>]}
[0m06:16:58.505183 [debug] [MainThread]: Flushing usage events
[0m06:17:00.175591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd783b3e5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd781d16ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd781d5eea0>]}


============================== 06:17:00.178734 | e1d6d090-8b1a-41df-8588-c79b9707967d ==============================
[0m06:17:00.178734 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:17:00.179444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:17:00.412287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1d6d090-8b1a-41df-8588-c79b9707967d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd783794b90>]}
[0m06:17:00.473786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1d6d090-8b1a-41df-8588-c79b9707967d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd782bcf7a0>]}
[0m06:17:00.475599 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:17:00.501946 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:17:00.502718 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:17:00.503266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e1d6d090-8b1a-41df-8588-c79b9707967d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7818a73b0>]}
[0m06:17:01.905986 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:17:01.906660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e1d6d090-8b1a-41df-8588-c79b9707967d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd779a641a0>]}
[0m06:17:02.150485 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:17:02.156126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1d6d090-8b1a-41df-8588-c79b9707967d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd782bb5670>]}
[0m06:17:02.249382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1d6d090-8b1a-41df-8588-c79b9707967d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77a2acc50>]}
[0m06:17:02.249953 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:17:02.250482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1d6d090-8b1a-41df-8588-c79b9707967d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77a29e630>]}
[0m06:17:02.252485 [info ] [MainThread]: 
[0m06:17:02.253198 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:17:02.258009 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:17:02.295559 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:17:02.296077 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:17:02.296509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:17:02.734376 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:17:02.736035 [debug] [ThreadPool]: On list_petro: Close
[0m06:17:02.736918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:17:02.737617 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:17:02.746943 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:17:02.747543 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:17:02.748044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:17:02.749228 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:17:02.750558 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:17:02.750953 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:17:02.751818 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:17:02.752233 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:17:02.752598 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:17:02.753226 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:17:02.754156 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:17:02.754557 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:17:02.754926 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:17:02.755531 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:17:02.755927 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:17:02.757134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:17:02.763000 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:17:02.763428 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:17:02.763790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:17:02.764444 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:17:02.764833 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:17:02.765235 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:17:02.776381 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:17:02.777755 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:17:02.778979 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:17:02.779404 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:17:02.780560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1d6d090-8b1a-41df-8588-c79b9707967d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77a3dda60>]}
[0m06:17:02.781191 [debug] [MainThread]: Using duckdb connection "master"
[0m06:17:02.781598 [debug] [MainThread]: On master: BEGIN
[0m06:17:02.781980 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:17:02.782706 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:17:02.783136 [debug] [MainThread]: On master: COMMIT
[0m06:17:02.783525 [debug] [MainThread]: Using duckdb connection "master"
[0m06:17:02.783890 [debug] [MainThread]: On master: COMMIT
[0m06:17:02.784467 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:17:02.784858 [debug] [MainThread]: On master: Close
[0m06:17:02.785399 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:17:02.785897 [info ] [MainThread]: 
[0m06:17:02.806227 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:17:02.806833 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:17:02.807494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:17:02.807929 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:17:02.835370 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:17:02.836140 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:17:02.871916 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:17:02.872809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:17:11.567735 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:17:11.568344 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:17:11.569035 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:17:11.569520 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:17:11.569968 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:17:11.570975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:17:11.572409 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:17:11.572859 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:17:11.573953 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:17:11.582050 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:17:11.582555 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:17:11.583326 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:17:11.586322 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:17:11.586834 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:17:11.587640 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:17:11.604465 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:17:11.604933 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:17:11.605374 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:17:11.607851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:17:11.613635 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:17:11.614118 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:17:11.615311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:17:11.617726 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:17:11.619265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1d6d090-8b1a-41df-8588-c79b9707967d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd779bd5eb0>]}
[0m06:17:11.619949 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.81s]
[0m06:17:11.620814 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:17:11.621773 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:17:11.622344 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:17:11.622977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:17:11.623456 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:17:11.628446 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:17:11.629096 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:17:11.665848 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:17:11.666415 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260207061711659688"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:17:11.666877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:17:11.674259 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:17:11.682565 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:17:11.683046 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:17:11.683817 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:17:11.684276 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:17:11.684698 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260207061711659688'
      
      
      order by ordinal_position

  
[0m06:17:11.687246 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:17:11.692817 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:17:11.693325 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:17:11.695781 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:17:11.703837 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:17:11.704321 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:17:11.706720 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:17:11.708445 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:17:11.708899 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:17:11.709681 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:17:11.728681 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:17:11.729462 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:17:11.729930 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260207061711659688"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260207061711659688"
    )
  
[0m06:17:11.739306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:17:11.741365 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:17:11.741850 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:17:11.742298 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:17:11.748058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:17:11.749002 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:17:11.749730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1d6d090-8b1a-41df-8588-c79b9707967d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd736693410>]}
[0m06:17:11.750444 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m06:17:11.751291 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:17:11.753039 [debug] [MainThread]: Using duckdb connection "master"
[0m06:17:11.753492 [debug] [MainThread]: On master: BEGIN
[0m06:17:11.753872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:17:11.754702 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:17:11.755164 [debug] [MainThread]: On master: COMMIT
[0m06:17:11.755550 [debug] [MainThread]: Using duckdb connection "master"
[0m06:17:11.755917 [debug] [MainThread]: On master: COMMIT
[0m06:17:11.756534 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:17:11.756932 [debug] [MainThread]: On master: Close
[0m06:17:11.757491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:17:11.757863 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:17:11.758312 [info ] [MainThread]: 
[0m06:17:11.758829 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.51 seconds (9.51s).
[0m06:17:11.759845 [debug] [MainThread]: Command end result
[0m06:17:11.785876 [info ] [MainThread]: 
[0m06:17:11.786535 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:17:11.787057 [info ] [MainThread]: 
[0m06:17:11.787604 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:17:11.788625 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.665905, "process_user_time": 5.783462, "process_kernel_time": 0.282364, "process_mem_max_rss": "274732", "process_in_blocks": "1200", "process_out_blocks": "107408"}
[0m06:17:11.789217 [debug] [MainThread]: Command `dbt run` succeeded at 06:17:11.789072 after 11.67 seconds
[0m06:17:11.789670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd781afdee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd781d5eea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd781e935c0>]}
[0m06:17:11.790122 [debug] [MainThread]: Flushing usage events
[0m06:17:13.551398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecd0e9ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecd18f1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecd18f1160>]}


============================== 06:17:13.554503 | a9295d4f-7b17-4953-8ba3-fb225cb8e236 ==============================
[0m06:17:13.554503 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:17:13.555199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:17:13.670592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9295d4f-7b17-4953-8ba3-fb225cb8e236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecd1295280>]}
[0m06:17:13.688846 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1898271, "process_user_time": 1.348789, "process_kernel_time": 0.109063, "process_mem_max_rss": "99768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:17:13.689426 [debug] [MainThread]: Command `dbt clean` succeeded at 06:17:13.689321 after 0.19 seconds
[0m06:17:13.689855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecd1e80200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecd17b2ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecd1a9bc80>]}
[0m06:17:13.690300 [debug] [MainThread]: Flushing usage events
[0m14:11:49.738845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2357f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a250af1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a23fa6a50>]}


============================== 14:11:49.754673 | 0bebe299-9dac-4f85-8105-b1214e7eaf06 ==============================
[0m14:11:49.754673 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:11:49.755377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:11:49.906489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bebe299-9dac-4f85-8105-b1214e7eaf06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a22f5a2a0>]}
[0m14:11:49.922777 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-16gkdwcg'
[0m14:11:49.923340 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:11:50.013697 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:11:50.015430 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:11:50.048928 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:11:50.054677 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:11:50.209594 [info ] [MainThread]: Installed from version 1.2.0
[0m14:11:50.210248 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:11:50.210767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0bebe299-9dac-4f85-8105-b1214e7eaf06', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a231bf680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a23f89190>]}
[0m14:11:50.211250 [info ] [MainThread]: 
[0m14:11:50.211741 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:11:50.216854 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5304923, "process_user_time": 1.713146, "process_kernel_time": 0.139848, "process_mem_max_rss": "101352", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m14:11:50.217465 [debug] [MainThread]: Command `dbt deps` succeeded at 14:11:50.217344 after 0.53 seconds
[0m14:11:50.217890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2357f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a22f5a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a23175f70>]}
[0m14:11:50.218350 [debug] [MainThread]: Flushing usage events
[0m14:11:51.942866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a871f5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a868755e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a89bbb650>]}


============================== 14:11:51.946116 | 7636f609-345b-4307-95db-af7599eb6f0f ==============================
[0m14:11:51.946116 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:11:51.946827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:11:52.188330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7636f609-345b-4307-95db-af7599eb6f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a867e73b0>]}
[0m14:11:52.251814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7636f609-345b-4307-95db-af7599eb6f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a88498aa0>]}
[0m14:11:52.253766 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:11:52.279238 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:11:52.280051 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:11:52.280685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7636f609-345b-4307-95db-af7599eb6f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a7f1ccd70>]}
[0m14:11:53.686969 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:11:53.687687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7636f609-345b-4307-95db-af7599eb6f0f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a7e8db140>]}
[0m14:11:53.950492 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:11:53.956381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7636f609-345b-4307-95db-af7599eb6f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a7e8da000>]}
[0m14:11:54.051544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7636f609-345b-4307-95db-af7599eb6f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a7e94a900>]}
[0m14:11:54.052193 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:11:54.052767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7636f609-345b-4307-95db-af7599eb6f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a7e8c1d30>]}
[0m14:11:54.054932 [info ] [MainThread]: 
[0m14:11:54.055745 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:11:54.060930 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:11:54.098808 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:11:54.099357 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:11:54.099758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:54.532813 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:54.535029 [debug] [ThreadPool]: On list_petro: Close
[0m14:11:54.536241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:11:54.537068 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:11:54.544753 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:11:54.545232 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:11:54.545607 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:54.547104 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:54.548526 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:11:54.548937 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:11:54.549564 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:54.549940 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:11:54.550322 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:11:54.550970 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:54.551906 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:11:54.552317 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:11:54.552675 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:11:54.553270 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:54.553674 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:11:54.554964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:11:54.561210 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:11:54.561624 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:11:54.561984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:54.562732 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:54.563116 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:11:54.563517 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:11:54.574025 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:54.575556 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:11:54.576804 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:11:54.577237 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:11:54.578487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7636f609-345b-4307-95db-af7599eb6f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a867e5ee0>]}
[0m14:11:54.579131 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:54.579572 [debug] [MainThread]: On master: BEGIN
[0m14:11:54.579953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:54.580745 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:11:54.581196 [debug] [MainThread]: On master: COMMIT
[0m14:11:54.581583 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:54.581954 [debug] [MainThread]: On master: COMMIT
[0m14:11:54.582582 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:11:54.582984 [debug] [MainThread]: On master: Close
[0m14:11:54.583544 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:11:54.584052 [info ] [MainThread]: 
[0m14:11:54.601871 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:11:54.602526 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:11:54.603132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:11:54.603599 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:11:54.631521 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:11:54.632456 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:11:54.669305 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:11:54.670266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:01.644300 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:01.644876 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:12:01.645738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:01.646222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:01.646652 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:12:01.647724 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:01.649204 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:01.649658 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:12:01.650734 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:01.659182 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:01.659700 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:12:01.660680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:01.663928 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:01.664397 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:12:01.665289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:01.682423 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:12:01.682954 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:01.683391 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:12:01.685723 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:01.691777 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:01.692272 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:12:01.693641 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:01.696201 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:12:01.697748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7636f609-345b-4307-95db-af7599eb6f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a36cfd6a0>]}
[0m14:12:01.698456 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.09s]
[0m14:12:01.699248 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:12:01.700192 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:12:01.700885 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:12:01.701491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:12:01.701926 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:12:01.707268 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:12:01.707964 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:12:01.745272 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:01.745857 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260207141201739040"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:12:01.746339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:01.753613 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:01.762054 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:01.762597 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:12:01.763415 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:01.763850 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:01.764289 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260207141201739040'
      
      
      order by ordinal_position

  
[0m14:12:01.766888 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:01.772624 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:01.773108 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:12:01.775850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:01.784207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:01.784737 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:12:01.787980 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:01.789855 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:01.790321 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:12:01.791083 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:01.809906 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:12:01.810725 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:01.811215 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260207141201739040"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260207141201739040"
    )
  
[0m14:12:01.823279 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:01.825372 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:12:01.825855 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:01.826311 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:12:01.834600 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:01.835592 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:12:01.836353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7636f609-345b-4307-95db-af7599eb6f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a36d33830>]}
[0m14:12:01.837052 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m14:12:01.837824 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:12:01.839430 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:01.839844 [debug] [MainThread]: On master: BEGIN
[0m14:12:01.840270 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:12:01.841033 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:12:01.841477 [debug] [MainThread]: On master: COMMIT
[0m14:12:01.841854 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:01.842263 [debug] [MainThread]: On master: COMMIT
[0m14:12:01.842870 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:12:01.843308 [debug] [MainThread]: On master: Close
[0m14:12:01.843791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:01.844176 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:12:01.844582 [info ] [MainThread]: 
[0m14:12:01.845044 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.79 seconds (7.79s).
[0m14:12:01.846013 [debug] [MainThread]: Command end result
[0m14:12:01.873126 [info ] [MainThread]: 
[0m14:12:01.873818 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:12:01.874326 [info ] [MainThread]: 
[0m14:12:01.874814 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:12:01.875832 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.987207, "process_user_time": 5.907666, "process_kernel_time": 0.285612, "process_mem_max_rss": "280840", "process_in_blocks": "1200", "process_out_blocks": "107400"}
[0m14:12:01.876438 [debug] [MainThread]: Command `dbt run` succeeded at 14:12:01.876327 after 9.99 seconds
[0m14:12:01.876885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8ad63980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a37a21a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3769b170>]}
[0m14:12:01.877350 [debug] [MainThread]: Flushing usage events
[0m14:12:03.727981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dac9aa060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dac035790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dac0356a0>]}


============================== 14:12:03.731215 | dace107e-2599-45cc-82a3-1e0f4cb807a3 ==============================
[0m14:12:03.731215 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:12:03.731946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:12:03.847299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dace107e-2599-45cc-82a3-1e0f4cb807a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dade4cbc0>]}
[0m14:12:03.865376 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19031337, "process_user_time": 1.369198, "process_kernel_time": 0.110935, "process_mem_max_rss": "99780", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:12:03.865912 [debug] [MainThread]: Command `dbt clean` succeeded at 14:12:03.865807 after 0.19 seconds
[0m14:12:03.866368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dac035790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db06d3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dabebda30>]}
[0m14:12:03.866797 [debug] [MainThread]: Flushing usage events
[0m22:08:06.989829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe54705ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5471f2e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe549381880>]}


============================== 22:08:07.007044 | 1b23327d-324a-41d6-a092-a171703d7661 ==============================
[0m22:08:07.007044 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:08:07.007694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:08:07.214384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b23327d-324a-41d6-a092-a171703d7661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe548d26e10>]}
[0m22:08:07.230126 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mb8qqhn6'
[0m22:08:07.230594 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:08:07.369131 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:08:07.370559 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:08:07.451454 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:08:07.456792 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:08:07.818180 [info ] [MainThread]: Installed from version 1.2.0
[0m22:08:07.818824 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:08:07.819390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1b23327d-324a-41d6-a092-a171703d7661', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe546efc1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe546effa40>]}
[0m22:08:07.819847 [info ] [MainThread]: 
[0m22:08:07.820331 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:08:07.826989 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.88833237, "process_user_time": 1.630315, "process_kernel_time": 0.14294, "process_mem_max_rss": "101484", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m22:08:07.827554 [debug] [MainThread]: Command `dbt deps` succeeded at 22:08:07.827453 after 0.89 seconds
[0m22:08:07.827997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5474322d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe546ed5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe546ed6030>]}
[0m22:08:07.828437 [debug] [MainThread]: Flushing usage events
[0m22:08:09.550816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d30c1df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d30ef15b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d30a0eff0>]}


============================== 22:08:09.553903 | f4c286b7-2624-40d5-86dc-576195348364 ==============================
[0m22:08:09.553903 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:08:09.554590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:08:09.785305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4c286b7-2624-40d5-86dc-576195348364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d30899730>]}
[0m22:08:09.846425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4c286b7-2624-40d5-86dc-576195348364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d31d1d190>]}
[0m22:08:09.848179 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:08:09.873429 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:08:09.874185 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:08:09.874710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f4c286b7-2624-40d5-86dc-576195348364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d308201a0>]}
[0m22:08:11.265004 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:08:11.265612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f4c286b7-2624-40d5-86dc-576195348364', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d292567e0>]}
[0m22:08:11.502290 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:08:11.507627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4c286b7-2624-40d5-86dc-576195348364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d30aa4110>]}
[0m22:08:11.599820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4c286b7-2624-40d5-86dc-576195348364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d292bd760>]}
[0m22:08:11.600385 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:08:11.600924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4c286b7-2624-40d5-86dc-576195348364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d29284d70>]}
[0m22:08:11.602998 [info ] [MainThread]: 
[0m22:08:11.603731 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:08:11.608609 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:08:11.645286 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:08:11.645741 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:08:11.646159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:12.616301 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:08:12.618375 [debug] [ThreadPool]: On list_petro: Close
[0m22:08:12.619396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:08:12.620054 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:08:12.628228 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:12.628653 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:08:12.629077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:12.630341 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:12.631690 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:12.632117 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:08:12.632745 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:12.633200 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:12.633562 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:08:12.634241 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:12.635195 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:08:12.635587 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:12.636005 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:08:12.636628 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:12.637069 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:08:12.638326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:08:12.644423 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:08:12.644858 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:08:12.645230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:12.645945 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:12.646335 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:08:12.646707 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:08:12.658158 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:12.659534 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:08:12.660811 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:08:12.661215 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:08:12.662531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4c286b7-2624-40d5-86dc-576195348364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d3086f290>]}
[0m22:08:12.663319 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:12.663953 [debug] [MainThread]: On master: BEGIN
[0m22:08:12.664543 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:12.665528 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:12.666156 [debug] [MainThread]: On master: COMMIT
[0m22:08:12.666756 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:12.667379 [debug] [MainThread]: On master: COMMIT
[0m22:08:12.668234 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:12.668899 [debug] [MainThread]: On master: Close
[0m22:08:12.669648 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:08:12.670309 [info ] [MainThread]: 
[0m22:08:12.770341 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:08:12.771055 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:08:12.771784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:08:12.772282 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:08:12.799979 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:08:12.800772 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:08:12.842635 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:08:12.843457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:23.961295 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:23.961844 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:08:23.962518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:23.962981 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:23.963402 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:08:23.964333 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:23.965677 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:23.966140 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:08:23.967158 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:23.974917 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:23.975373 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:08:23.976130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:23.979076 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:23.979519 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:08:23.980247 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:23.996820 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:08:23.997317 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:23.997736 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:08:23.999217 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:24.004899 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:24.005358 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:08:24.006570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:24.008952 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:08:24.010482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c286b7-2624-40d5-86dc-576195348364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d3286f9e0>]}
[0m22:08:24.011179 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.24s]
[0m22:08:24.011999 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:08:24.012948 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:08:24.013484 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:08:24.014067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:08:24.014497 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:08:24.019458 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:08:24.020147 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:08:24.056411 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:24.056918 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260207220824050368"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:08:24.057369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:24.064268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:24.071991 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:24.072451 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:08:24.073147 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:24.073586 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:24.074047 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260207220824050368'
      
      
      order by ordinal_position

  
[0m22:08:24.076429 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:24.081650 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:24.082128 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:08:24.084408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:24.092209 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:24.092675 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:08:24.095701 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:24.097380 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:24.097835 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:08:24.098606 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:24.116987 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:08:24.117667 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:24.118137 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260207220824050368"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260207220824050368"
    )
  
[0m22:08:24.127644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:24.129438 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:08:24.129917 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:24.130327 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:08:24.136984 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:24.137863 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:08:24.138518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c286b7-2624-40d5-86dc-576195348364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce5571400>]}
[0m22:08:24.139197 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m22:08:24.139947 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:08:24.141414 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:24.141857 [debug] [MainThread]: On master: BEGIN
[0m22:08:24.142237 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:08:24.142999 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:24.143400 [debug] [MainThread]: On master: COMMIT
[0m22:08:24.143773 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:24.144208 [debug] [MainThread]: On master: COMMIT
[0m22:08:24.144784 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:24.145233 [debug] [MainThread]: On master: Close
[0m22:08:24.145694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:24.146089 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:08:24.146492 [info ] [MainThread]: 
[0m22:08:24.146987 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.54 seconds (12.54s).
[0m22:08:24.147906 [debug] [MainThread]: Command end result
[0m22:08:24.173214 [info ] [MainThread]: 
[0m22:08:24.173791 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:08:24.174282 [info ] [MainThread]: 
[0m22:08:24.174753 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:08:24.175676 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.676944, "process_user_time": 6.258065, "process_kernel_time": 0.302857, "process_mem_max_rss": "284036", "process_in_blocks": "1200", "process_out_blocks": "107448"}
[0m22:08:24.176238 [debug] [MainThread]: Command `dbt run` succeeded at 22:08:24.176137 after 14.68 seconds
[0m22:08:24.176663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d30a0ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d30f77710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce5d4ce30>]}
[0m22:08:24.177112 [debug] [MainThread]: Flushing usage events
[0m22:08:25.990060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e4a42660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e3835070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e29854c0>]}


============================== 22:08:25.993097 | 264c53a0-ab54-4eaf-85d5-d286b95ce340 ==============================
[0m22:08:25.993097 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:08:25.993789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:08:26.108839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '264c53a0-ab54-4eaf-85d5-d286b95ce340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e27c2000>]}
[0m22:08:26.127259 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18919459, "process_user_time": 1.32937, "process_kernel_time": 0.12494, "process_mem_max_rss": "99900", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:08:26.127824 [debug] [MainThread]: Command `dbt clean` succeeded at 22:08:26.127693 after 0.19 seconds
[0m22:08:26.128280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e2c946b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e34bc3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e2772180>]}
[0m22:08:26.128702 [debug] [MainThread]: Flushing usage events
[0m06:21:53.354174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd2f72ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd40bee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd40bdd60>]}


============================== 06:21:53.371318 | 140f89be-ad0d-4283-a903-2973e1770a55 ==============================
[0m06:21:53.371318 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:21:53.371991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:21:53.518890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '140f89be-ad0d-4283-a903-2973e1770a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd33a1f70>]}
[0m06:21:53.534431 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xzvxapmx'
[0m06:21:53.534901 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:21:53.646591 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:21:53.647940 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:21:53.685417 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:21:53.692458 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:21:53.879881 [info ] [MainThread]: Installed from version 1.2.0
[0m06:21:53.880523 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:21:53.881036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '140f89be-ad0d-4283-a903-2973e1770a55', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd2cd6f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd2cd7fb0>]}
[0m06:21:53.881522 [info ] [MainThread]: 
[0m06:21:53.881985 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:21:53.890179 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5879782, "process_user_time": 1.664853, "process_kernel_time": 0.135987, "process_mem_max_rss": "101488", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m06:21:53.890776 [debug] [MainThread]: Command `dbt deps` succeeded at 06:21:53.890669 after 0.59 seconds
[0m06:21:53.891230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd2f72ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd2cabda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd2ca9df0>]}
[0m06:21:53.891660 [debug] [MainThread]: Flushing usage events
[0m06:21:55.522504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb626f7bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62657c560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62657fc20>]}


============================== 06:21:55.525675 | 4775e2b4-b4d6-47f6-96e2-d0549418ab75 ==============================
[0m06:21:55.525675 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:21:55.526383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:21:55.759109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4775e2b4-b4d6-47f6-96e2-d0549418ab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6270c7680>]}
[0m06:21:55.821277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4775e2b4-b4d6-47f6-96e2-d0549418ab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6270c7590>]}
[0m06:21:55.823051 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:21:55.847622 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:21:55.848385 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:21:55.848952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4775e2b4-b4d6-47f6-96e2-d0549418ab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb625c4ca70>]}
[0m06:21:57.245674 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:21:57.246417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4775e2b4-b4d6-47f6-96e2-d0549418ab75', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61dfda660>]}
[0m06:21:57.500568 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:21:57.506238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4775e2b4-b4d6-47f6-96e2-d0549418ab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62656cec0>]}
[0m06:21:57.599646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4775e2b4-b4d6-47f6-96e2-d0549418ab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61e6f4890>]}
[0m06:21:57.600246 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:21:57.600726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4775e2b4-b4d6-47f6-96e2-d0549418ab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb625c99130>]}
[0m06:21:57.602761 [info ] [MainThread]: 
[0m06:21:57.603496 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:21:57.608434 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:21:57.644862 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:21:57.645348 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:21:57.645740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:21:58.091080 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:58.092839 [debug] [ThreadPool]: On list_petro: Close
[0m06:21:58.093818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:21:58.094406 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:21:58.102105 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:21:58.102558 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:21:58.102933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:21:58.104355 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:58.105723 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:21:58.106121 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:21:58.106739 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:58.107127 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:21:58.107523 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:21:58.108133 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:58.109100 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:21:58.109512 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:21:58.109874 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:21:58.110485 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:58.110886 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:21:58.112156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:21:58.118172 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:21:58.118600 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:21:58.118961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:21:58.119653 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:58.120039 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:21:58.120446 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:21:58.131252 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:58.132648 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:21:58.133875 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:21:58.134324 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:21:58.135468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4775e2b4-b4d6-47f6-96e2-d0549418ab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb627cc6870>]}
[0m06:21:58.135991 [debug] [MainThread]: Using duckdb connection "master"
[0m06:21:58.136435 [debug] [MainThread]: On master: BEGIN
[0m06:21:58.136811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:21:58.137511 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:21:58.137921 [debug] [MainThread]: On master: COMMIT
[0m06:21:58.138343 [debug] [MainThread]: Using duckdb connection "master"
[0m06:21:58.138713 [debug] [MainThread]: On master: COMMIT
[0m06:21:58.139357 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:21:58.139783 [debug] [MainThread]: On master: Close
[0m06:21:58.140329 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:21:58.140843 [info ] [MainThread]: 
[0m06:21:58.164859 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:21:58.165489 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:21:58.166138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:21:58.166599 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:21:58.193985 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:21:58.194812 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:21:58.230366 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:21:58.231123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:06.362944 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:06.363556 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:22:06.364321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:06.364766 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:06.365219 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:22:06.366230 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:06.367625 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:06.368096 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:22:06.369178 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:06.377220 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:06.377697 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:22:06.378534 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:06.381575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:06.382053 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:22:06.382805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:06.399753 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:22:06.400241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:06.400667 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:22:06.402655 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:06.408397 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:06.408857 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:22:06.410057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:06.412598 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:22:06.414211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4775e2b4-b4d6-47f6-96e2-d0549418ab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61e716a80>]}
[0m06:22:06.414913 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.25s]
[0m06:22:06.415796 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:22:06.416808 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:22:06.417397 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:22:06.418053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:22:06.418522 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:22:06.423639 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:22:06.424319 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:22:06.460894 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:06.461441 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260208062206454773"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:22:06.461895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:06.469214 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:06.476942 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:06.477419 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:22:06.478157 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:06.478644 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:06.479067 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260208062206454773'
      
      
      order by ordinal_position

  
[0m06:22:06.481624 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:06.486841 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:06.487319 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:22:06.489819 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:06.497562 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:06.498033 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:22:06.500469 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:06.502735 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:06.503204 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:22:06.503926 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:06.522576 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:22:06.523303 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:06.523759 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260208062206454773"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260208062206454773"
    )
  
[0m06:22:06.533581 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:06.535541 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:22:06.536013 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:06.536454 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:22:06.542145 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:06.543058 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:22:06.543777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4775e2b4-b4d6-47f6-96e2-d0549418ab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d699cb30>]}
[0m06:22:06.544463 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m06:22:06.545324 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:22:06.546702 [debug] [MainThread]: Using duckdb connection "master"
[0m06:22:06.547125 [debug] [MainThread]: On master: BEGIN
[0m06:22:06.547555 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:22:06.548311 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:22:06.548726 [debug] [MainThread]: On master: COMMIT
[0m06:22:06.549110 [debug] [MainThread]: Using duckdb connection "master"
[0m06:22:06.549521 [debug] [MainThread]: On master: COMMIT
[0m06:22:06.550112 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:22:06.550554 [debug] [MainThread]: On master: Close
[0m06:22:06.551056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:22:06.551467 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:22:06.551902 [info ] [MainThread]: 
[0m06:22:06.552399 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.95 seconds (8.95s).
[0m06:22:06.553337 [debug] [MainThread]: Command end result
[0m06:22:06.579125 [info ] [MainThread]: 
[0m06:22:06.579731 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:22:06.580202 [info ] [MainThread]: 
[0m06:22:06.580677 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:22:06.581621 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.112015, "process_user_time": 5.783159, "process_kernel_time": 0.304429, "process_mem_max_rss": "312616", "process_in_blocks": "1200", "process_out_blocks": "107408"}
[0m06:22:06.582171 [debug] [MainThread]: Command `dbt run` succeeded at 06:22:06.582068 after 11.11 seconds
[0m06:22:06.582670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb625d434a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb626541d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb626327ec0>]}
[0m06:22:06.583118 [debug] [MainThread]: Flushing usage events
[0m06:22:08.365854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358d8feab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358b1842f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358a132b40>]}


============================== 06:22:08.368987 | c352fc60-56d9-4055-8128-7422d84b41f9 ==============================
[0m06:22:08.368987 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:22:08.369710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:22:08.484943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c352fc60-56d9-4055-8128-7422d84b41f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3589f45190>]}
[0m06:22:08.503589 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19006532, "process_user_time": 1.361271, "process_kernel_time": 0.106942, "process_mem_max_rss": "99648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:22:08.504135 [debug] [MainThread]: Command `dbt clean` succeeded at 06:22:08.504033 after 0.19 seconds
[0m06:22:08.504610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358a4b5ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358a132bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358a132ab0>]}
[0m06:22:08.505034 [debug] [MainThread]: Flushing usage events
[0m14:13:24.122110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335aa1e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335bd52a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335a171a90>]}


============================== 14:13:24.130863 | c4243cf8-b1d2-4554-8a96-371ffa45523e ==============================
[0m14:13:24.130863 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:13:24.131597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:13:24.254902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4243cf8-b1d2-4554-8a96-371ffa45523e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335bd52a50>]}
[0m14:13:24.270980 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8_q4todv'
[0m14:13:24.271546 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:13:24.448135 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:13:24.449861 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:13:24.539803 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:13:24.545628 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:13:24.726824 [info ] [MainThread]: Installed from version 1.2.0
[0m14:13:24.727436 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:13:24.727985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c4243cf8-b1d2-4554-8a96-371ffa45523e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3359ecc530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3359fbb470>]}
[0m14:13:24.728452 [info ] [MainThread]: 
[0m14:13:24.728934 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:13:24.734038 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6646104, "process_user_time": 1.721675, "process_kernel_time": 0.136735, "process_mem_max_rss": "101372", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m14:13:24.734584 [debug] [MainThread]: Command `dbt deps` succeeded at 14:13:24.734482 after 0.67 seconds
[0m14:13:24.735012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335e6d3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3359fda180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335bd52a50>]}
[0m14:13:24.735465 [debug] [MainThread]: Flushing usage events
[0m14:13:26.426421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc912f16ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc912ebcbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc912bd29f0>]}


============================== 14:13:26.429525 | aed4d9b6-af0d-4398-9d19-3dd8b4495e9c ==============================
[0m14:13:26.429525 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:13:26.430188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:13:26.665871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aed4d9b6-af0d-4398-9d19-3dd8b4495e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90f796b40>]}
[0m14:13:26.728517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aed4d9b6-af0d-4398-9d19-3dd8b4495e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90f59e360>]}
[0m14:13:26.730494 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:13:26.756651 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:13:26.757504 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:13:26.758102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aed4d9b6-af0d-4398-9d19-3dd8b4495e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90f59c620>]}
[0m14:13:28.170905 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:13:28.171587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aed4d9b6-af0d-4398-9d19-3dd8b4495e9c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ff9f9f70>]}
[0m14:13:28.432376 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:13:28.437926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aed4d9b6-af0d-4398-9d19-3dd8b4495e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ff8bcda0>]}
[0m14:13:28.530466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aed4d9b6-af0d-4398-9d19-3dd8b4495e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ff97fef0>]}
[0m14:13:28.531123 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:13:28.531612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aed4d9b6-af0d-4398-9d19-3dd8b4495e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ff95d400>]}
[0m14:13:28.533697 [info ] [MainThread]: 
[0m14:13:28.534465 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:13:28.539396 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:13:28.577951 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:13:28.578523 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:13:28.578936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:29.256498 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:13:29.258685 [debug] [ThreadPool]: On list_petro: Close
[0m14:13:29.259774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:13:29.260571 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:13:29.269238 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:13:29.269680 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:13:29.270095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:29.271541 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:29.272956 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:13:29.273390 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:13:29.274240 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:29.274623 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:13:29.274986 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:13:29.275677 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:29.276605 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:13:29.276991 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:13:29.277411 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:13:29.277999 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:29.278430 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:13:29.279711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:13:29.285891 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:13:29.286320 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:13:29.286682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:29.287460 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:29.287866 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:13:29.288290 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:13:29.299069 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:29.300845 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:13:29.302729 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:13:29.303345 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:13:29.304915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aed4d9b6-af0d-4398-9d19-3dd8b4495e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9114c66c0>]}
[0m14:13:29.305754 [debug] [MainThread]: Using duckdb connection "master"
[0m14:13:29.306455 [debug] [MainThread]: On master: BEGIN
[0m14:13:29.307105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:13:29.308241 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:13:29.308939 [debug] [MainThread]: On master: COMMIT
[0m14:13:29.309630 [debug] [MainThread]: Using duckdb connection "master"
[0m14:13:29.310321 [debug] [MainThread]: On master: COMMIT
[0m14:13:29.311281 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:13:29.311976 [debug] [MainThread]: On master: Close
[0m14:13:29.312784 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:13:29.313466 [info ] [MainThread]: 
[0m14:13:29.396470 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:13:29.397475 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:13:29.398340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:13:29.398999 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:13:29.427938 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:13:29.428868 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:13:29.467160 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:13:29.468066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:38.084688 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:13:38.085264 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:13:38.085961 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:38.086425 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:13:38.086842 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:13:38.087813 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:38.089204 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:13:38.089646 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:13:38.090682 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:38.098542 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:13:38.098999 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:13:38.099776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:38.102714 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:13:38.103171 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:13:38.103874 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:38.120474 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:13:38.120941 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:13:38.121389 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:13:38.123385 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:38.129082 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:13:38.129536 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:13:38.130743 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:38.133142 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:13:38.134640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aed4d9b6-af0d-4398-9d19-3dd8b4495e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8cbbf3a70>]}
[0m14:13:38.135336 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.74s]
[0m14:13:38.136216 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:13:38.137228 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:13:38.137821 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:13:38.138499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:13:38.139008 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:13:38.143983 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:13:38.144665 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:13:38.181334 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:13:38.181873 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260208141338175295"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:13:38.182348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:38.189901 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:38.197540 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:13:38.197989 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:13:38.198682 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:38.199128 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:13:38.199552 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260208141338175295'
      
      
      order by ordinal_position

  
[0m14:13:38.201965 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:38.207138 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:13:38.207596 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:13:38.210111 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:38.217768 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:13:38.218240 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:13:38.220926 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:38.222617 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:13:38.223077 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:13:38.223783 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:38.242074 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:13:38.242753 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:13:38.243244 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260208141338175295"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260208141338175295"
    )
  
[0m14:13:38.252558 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:38.254571 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:13:38.255050 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:13:38.255469 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:13:38.261646 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:38.262632 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:13:38.263353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aed4d9b6-af0d-4398-9d19-3dd8b4495e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8cba137d0>]}
[0m14:13:38.264035 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m14:13:38.264851 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:13:38.266570 [debug] [MainThread]: Using duckdb connection "master"
[0m14:13:38.266993 [debug] [MainThread]: On master: BEGIN
[0m14:13:38.267422 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:13:38.268164 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:13:38.268564 [debug] [MainThread]: On master: COMMIT
[0m14:13:38.268935 [debug] [MainThread]: Using duckdb connection "master"
[0m14:13:38.269347 [debug] [MainThread]: On master: COMMIT
[0m14:13:38.269929 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:13:38.270370 [debug] [MainThread]: On master: Close
[0m14:13:38.270840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:38.271250 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:13:38.271650 [info ] [MainThread]: 
[0m14:13:38.272170 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.74 seconds (9.74s).
[0m14:13:38.273194 [debug] [MainThread]: Command end result
[0m14:13:38.299056 [info ] [MainThread]: 
[0m14:13:38.299727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:13:38.300302 [info ] [MainThread]: 
[0m14:13:38.300844 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:13:38.301831 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.928092, "process_user_time": 6.036241, "process_kernel_time": 0.320959, "process_mem_max_rss": "278408", "process_in_blocks": "1200", "process_out_blocks": "107392"}
[0m14:13:38.302411 [debug] [MainThread]: Command `dbt run` succeeded at 14:13:38.302296 after 11.93 seconds
[0m14:13:38.302853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9103edfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ff95e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90fb8f740>]}
[0m14:13:38.303330 [debug] [MainThread]: Flushing usage events
[0m14:13:40.144659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9997b4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd996d2e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9975a3710>]}


============================== 14:13:40.147772 | 20caee44-c88b-487e-ab6b-749951b0a9a4 ==============================
[0m14:13:40.147772 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:13:40.148487 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:13:40.264762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20caee44-c88b-487e-ab6b-749951b0a9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd998a44b60>]}
[0m14:13:40.283703 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1917676, "process_user_time": 1.364382, "process_kernel_time": 0.111949, "process_mem_max_rss": "99828", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:13:40.284334 [debug] [MainThread]: Command `dbt clean` succeeded at 14:13:40.284211 after 0.19 seconds
[0m14:13:40.284779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9973914f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9997fab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd998a44b60>]}
[0m14:13:40.285225 [debug] [MainThread]: Flushing usage events
[0m22:08:32.613236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dee1b7500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4deb007380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4deaea0ad0>]}


============================== 22:08:32.633603 | e02b12fc-73f8-4882-ade7-f8d7d27e4dc3 ==============================
[0m22:08:32.633603 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:08:32.634300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:08:32.794339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e02b12fc-73f8-4882-ade7-f8d7d27e4dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4deca2ee40>]}
[0m22:08:32.809624 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-l42t60hx'
[0m22:08:32.810084 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:08:32.959658 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:08:32.961078 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:08:32.996139 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:08:33.001294 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:08:33.497789 [info ] [MainThread]: Installed from version 1.2.0
[0m22:08:33.498344 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:08:33.498910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e02b12fc-73f8-4882-ade7-f8d7d27e4dc3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4deab76e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4deab76d80>]}
[0m22:08:33.499361 [info ] [MainThread]: 
[0m22:08:33.499865 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:08:33.506954 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.94476324, "process_user_time": 1.615392, "process_kernel_time": 0.151036, "process_mem_max_rss": "101304", "process_in_blocks": "8752", "process_out_blocks": "5176"}
[0m22:08:33.507600 [debug] [MainThread]: Command `dbt deps` succeeded at 22:08:33.507470 after 0.95 seconds
[0m22:08:33.508024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dead65850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dead65fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4deaea0ad0>]}
[0m22:08:33.508442 [debug] [MainThread]: Flushing usage events
[0m22:08:35.391318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e891acbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e895839b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e88b96840>]}


============================== 22:08:35.394385 | 0023fdf1-f8c1-4425-8c46-c2be40932256 ==============================
[0m22:08:35.394385 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:08:35.395064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:08:35.626903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0023fdf1-f8c1-4425-8c46-c2be40932256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e815bdeb0>]}
[0m22:08:35.687883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0023fdf1-f8c1-4425-8c46-c2be40932256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e8c80f950>]}
[0m22:08:35.689720 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:08:35.717558 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:08:35.718319 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:08:35.718880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0023fdf1-f8c1-4425-8c46-c2be40932256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e89991610>]}
[0m22:08:37.132934 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:08:37.133605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0023fdf1-f8c1-4425-8c46-c2be40932256', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e80dfb0e0>]}
[0m22:08:37.388955 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:08:37.395096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0023fdf1-f8c1-4425-8c46-c2be40932256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e891d90d0>]}
[0m22:08:37.492886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0023fdf1-f8c1-4425-8c46-c2be40932256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e80d6e960>]}
[0m22:08:37.493544 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:08:37.494153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0023fdf1-f8c1-4425-8c46-c2be40932256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e88c42d20>]}
[0m22:08:37.496230 [info ] [MainThread]: 
[0m22:08:37.497002 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:08:37.502037 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:08:37.539580 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:08:37.540104 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:08:37.540495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:38.267240 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:08:38.269142 [debug] [ThreadPool]: On list_petro: Close
[0m22:08:38.269963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:08:38.270533 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:08:38.277949 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:38.278368 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:08:38.278789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:38.279953 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:38.281272 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:38.281683 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:08:38.282278 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:38.282680 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:38.283038 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:08:38.283665 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:38.284585 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:08:38.284972 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:38.285337 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:08:38.285921 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:38.286313 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:08:38.287542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:08:38.293403 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:08:38.293832 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:08:38.294194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:38.294883 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:38.295271 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:08:38.295672 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:08:38.306278 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:38.307670 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:08:38.308871 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:08:38.309275 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:08:38.310432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0023fdf1-f8c1-4425-8c46-c2be40932256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e80d22030>]}
[0m22:08:38.310971 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:38.311351 [debug] [MainThread]: On master: BEGIN
[0m22:08:38.311738 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:38.312421 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:38.312843 [debug] [MainThread]: On master: COMMIT
[0m22:08:38.313219 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:38.313604 [debug] [MainThread]: On master: COMMIT
[0m22:08:38.314226 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:38.314645 [debug] [MainThread]: On master: Close
[0m22:08:38.315130 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:08:38.315621 [info ] [MainThread]: 
[0m22:08:38.334582 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:08:38.335184 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:08:38.335847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:08:38.336284 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:08:38.363355 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:08:38.364179 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:08:38.399953 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:08:38.400853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:48.518023 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:48.518595 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:08:48.519324 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:48.519792 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:48.520212 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:08:48.521202 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:48.522559 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:48.523001 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:08:48.524014 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:48.531840 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:48.532313 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:08:48.533147 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:48.536086 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:48.536552 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:08:48.537328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:48.553850 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:08:48.554310 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:48.554751 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:08:48.556787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:48.562485 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:48.562967 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:08:48.564210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:48.566587 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:08:48.568090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0023fdf1-f8c1-4425-8c46-c2be40932256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e80cc6690>]}
[0m22:08:48.568793 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.23s]
[0m22:08:48.569587 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:08:48.570397 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:08:48.571159 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:08:48.571774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:08:48.572217 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:08:48.577218 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:08:48.577900 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:08:48.613693 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:48.614187 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260208220848607727"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:08:48.614661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:48.622026 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:48.629678 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:48.630131 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:08:48.630807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:48.631243 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:48.631691 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260208220848607727'
      
      
      order by ordinal_position

  
[0m22:08:48.634073 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:48.639209 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:48.639696 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:08:48.642121 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:48.649784 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:48.650242 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:08:48.653001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:48.654672 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:48.655118 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:08:48.655848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:48.674046 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:08:48.674747 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:48.675201 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260208220848607727"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260208220848607727"
    )
  
[0m22:08:48.684287 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:48.686105 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:08:48.686564 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:48.686976 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:08:48.692411 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:48.693311 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:08:48.693976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0023fdf1-f8c1-4425-8c46-c2be40932256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e3cfe0e90>]}
[0m22:08:48.694649 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m22:08:48.695370 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:08:48.696693 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:48.697108 [debug] [MainThread]: On master: BEGIN
[0m22:08:48.697482 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:08:48.698159 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:48.698583 [debug] [MainThread]: On master: COMMIT
[0m22:08:48.698969 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:48.699330 [debug] [MainThread]: On master: COMMIT
[0m22:08:48.699993 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:48.700387 [debug] [MainThread]: On master: Close
[0m22:08:48.700885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:48.701247 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:08:48.701671 [info ] [MainThread]: 
[0m22:08:48.702131 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.20 seconds (11.20s).
[0m22:08:48.703058 [debug] [MainThread]: Command end result
[0m22:08:48.728349 [info ] [MainThread]: 
[0m22:08:48.728921 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:08:48.729369 [info ] [MainThread]: 
[0m22:08:48.729853 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:08:48.730786 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.391163, "process_user_time": 5.378791, "process_kernel_time": 0.298988, "process_mem_max_rss": "279888", "process_in_blocks": "1200", "process_out_blocks": "107432"}
[0m22:08:48.731315 [debug] [MainThread]: Command `dbt run` succeeded at 22:08:48.731213 after 13.39 seconds
[0m22:08:48.731775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e8d1bb980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e4824fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e88f8fd40>]}
[0m22:08:48.732201 [debug] [MainThread]: Flushing usage events
[0m22:08:50.677499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f858e178e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f858dd49970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f858e17a240>]}


============================== 22:08:50.680612 | 702c75cd-9b39-4506-b185-3ea88b7c4d47 ==============================
[0m22:08:50.680612 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:08:50.681320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:08:50.797249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '702c75cd-9b39-4506-b185-3ea88b7c4d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f858e178e90>]}
[0m22:08:50.815509 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18938258, "process_user_time": 1.315687, "process_kernel_time": 0.121971, "process_mem_max_rss": "99400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:08:50.816057 [debug] [MainThread]: Command `dbt clean` succeeded at 22:08:50.815953 after 0.19 seconds
[0m22:08:50.816478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f858de815e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f858e178e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f858db933b0>]}
[0m22:08:50.816930 [debug] [MainThread]: Flushing usage events
[0m06:30:23.208151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f15a9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f0cac2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f2748fe0>]}


============================== 06:30:23.227309 | add9a87a-2f7a-43f2-a9b9-edc8840c9084 ==============================
[0m06:30:23.227309 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:30:23.228028 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:30:23.475944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'add9a87a-2f7a-43f2-a9b9-edc8840c9084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f1729d60>]}
[0m06:30:23.492033 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-akxzhpjv'
[0m06:30:23.492492 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:30:23.674524 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:30:23.676324 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:30:23.759454 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:30:23.765253 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:30:24.123876 [info ] [MainThread]: Installed from version 1.2.0
[0m06:30:24.124391 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:30:24.124944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'add9a87a-2f7a-43f2-a9b9-edc8840c9084', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f0add0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f0994a70>]}
[0m06:30:24.125400 [info ] [MainThread]: 
[0m06:30:24.125912 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:30:24.131900 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9753418, "process_user_time": 1.682832, "process_kernel_time": 0.138068, "process_mem_max_rss": "101608", "process_in_blocks": "9024", "process_out_blocks": "5176"}
[0m06:30:24.132500 [debug] [MainThread]: Command `dbt deps` succeeded at 06:30:24.132396 after 0.98 seconds
[0m06:30:24.133020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f4a05190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f2748ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f2748fe0>]}
[0m06:30:24.133478 [debug] [MainThread]: Flushing usage events
[0m06:30:25.926184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610229ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610253c3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6105f0f950>]}


============================== 06:30:25.929524 | 1e44272c-6ade-40c5-80c9-e35e17ee14fe ==============================
[0m06:30:25.929524 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:30:25.930272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:30:26.170970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e44272c-6ade-40c5-80c9-e35e17ee14fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6103f9c7d0>]}
[0m06:30:26.232802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e44272c-6ade-40c5-80c9-e35e17ee14fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6102217e60>]}
[0m06:30:26.234601 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:30:26.261117 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:30:26.261837 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:30:26.262380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1e44272c-6ade-40c5-80c9-e35e17ee14fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61021e1a30>]}
[0m06:30:27.656836 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:30:27.657506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1e44272c-6ade-40c5-80c9-e35e17ee14fe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fab567e0>]}
[0m06:30:27.907622 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:30:27.913112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e44272c-6ade-40c5-80c9-e35e17ee14fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6103d4d700>]}
[0m06:30:28.005310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e44272c-6ade-40c5-80c9-e35e17ee14fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60faabf620>]}
[0m06:30:28.005840 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:30:28.006407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e44272c-6ade-40c5-80c9-e35e17ee14fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fa38b500>]}
[0m06:30:28.008436 [info ] [MainThread]: 
[0m06:30:28.009174 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:30:28.014016 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:30:28.051232 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:30:28.051677 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:30:28.052094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:30:28.917317 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:30:28.919690 [debug] [ThreadPool]: On list_petro: Close
[0m06:30:28.920912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:30:28.921683 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:30:28.930533 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:30:28.930989 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:30:28.931375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:30:28.932357 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:30:28.933739 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:30:28.934132 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:30:28.934730 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:30:28.935127 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:30:28.935494 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:30:28.936119 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:30:28.937051 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:30:28.937438 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:30:28.937824 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:30:28.938382 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:30:28.938789 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:30:28.940174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:30:28.946655 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:30:28.947079 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:30:28.947439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:30:28.948457 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:30:28.948869 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:30:28.949243 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:30:28.959769 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:30:28.961131 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:30:28.962394 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:30:28.962809 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:30:28.963957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e44272c-6ade-40c5-80c9-e35e17ee14fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fab4a270>]}
[0m06:30:28.964598 [debug] [MainThread]: Using duckdb connection "master"
[0m06:30:28.965094 [debug] [MainThread]: On master: BEGIN
[0m06:30:28.965491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:30:28.966222 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:30:28.966635 [debug] [MainThread]: On master: COMMIT
[0m06:30:28.967040 [debug] [MainThread]: Using duckdb connection "master"
[0m06:30:28.967399 [debug] [MainThread]: On master: COMMIT
[0m06:30:28.968023 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:30:28.968422 [debug] [MainThread]: On master: Close
[0m06:30:28.968959 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:30:28.969437 [info ] [MainThread]: 
[0m06:30:28.989466 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:30:28.990108 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:30:28.990690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:30:28.991161 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:30:29.018385 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:30:29.019152 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:30:29.054744 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:30:29.055489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:30:39.449678 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:30:39.450285 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:30:39.451041 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:30:39.451499 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:30:39.451970 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:30:39.452916 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:30:39.454270 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:30:39.454732 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:30:39.455740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:30:39.464082 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:30:39.464542 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:30:39.465302 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:30:39.468251 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:30:39.468696 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:30:39.469428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:30:39.486239 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:30:39.486692 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:30:39.487132 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:30:39.489207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:30:39.494884 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:30:39.495339 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:30:39.496470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:30:39.498990 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:30:39.500574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e44272c-6ade-40c5-80c9-e35e17ee14fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6103f777a0>]}
[0m06:30:39.501305 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.51s]
[0m06:30:39.502115 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:30:39.503015 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:30:39.503808 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:30:39.504433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:30:39.504915 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:30:39.509934 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:30:39.510576 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:30:39.546755 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:30:39.547254 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260209063039540748"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:30:39.547739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:30:39.555223 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:30:39.562823 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:30:39.563289 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:30:39.563954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:30:39.564395 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:30:39.564861 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260209063039540748'
      
      
      order by ordinal_position

  
[0m06:30:39.567330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:30:39.572463 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:30:39.572947 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:30:39.575241 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:30:39.582875 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:30:39.583340 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:30:39.586451 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:30:39.588188 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:30:39.588633 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:30:39.589355 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:30:39.607605 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:30:39.608291 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:30:39.608776 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260209063039540748"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260209063039540748"
    )
  
[0m06:30:39.620344 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:30:39.622156 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:30:39.622597 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:30:39.623037 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:30:39.628785 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:30:39.629653 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:30:39.630344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e44272c-6ade-40c5-80c9-e35e17ee14fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b2c28ec0>]}
[0m06:30:39.631051 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m06:30:39.631832 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:30:39.633839 [debug] [MainThread]: Using duckdb connection "master"
[0m06:30:39.634249 [debug] [MainThread]: On master: BEGIN
[0m06:30:39.634621 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:30:39.635390 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:30:39.635859 [debug] [MainThread]: On master: COMMIT
[0m06:30:39.636240 [debug] [MainThread]: Using duckdb connection "master"
[0m06:30:39.636604 [debug] [MainThread]: On master: COMMIT
[0m06:30:39.637202 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:30:39.637592 [debug] [MainThread]: On master: Close
[0m06:30:39.638095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:30:39.638455 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:30:39.638886 [info ] [MainThread]: 
[0m06:30:39.639374 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.63 seconds (11.63s).
[0m06:30:39.640316 [debug] [MainThread]: Command end result
[0m06:30:39.666822 [info ] [MainThread]: 
[0m06:30:39.667397 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:30:39.667908 [info ] [MainThread]: 
[0m06:30:39.668420 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:30:39.669435 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.795601, "process_user_time": 5.467041, "process_kernel_time": 0.294865, "process_mem_max_rss": "280492", "process_in_blocks": "1200", "process_out_blocks": "107392"}
[0m06:30:39.670020 [debug] [MainThread]: Command `dbt run` succeeded at 06:30:39.669916 after 13.80 seconds
[0m06:30:39.670462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6102d655b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61035eb9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b2c0e1b0>]}
[0m06:30:39.670915 [debug] [MainThread]: Flushing usage events
[0m06:30:41.635221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb2d932930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb2b896900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb2b894dd0>]}


============================== 06:30:41.638570 | 5c122a33-3dc5-4abb-b6ac-388bc308e348 ==============================
[0m06:30:41.638570 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:30:41.639260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:30:41.756570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c122a33-3dc5-4abb-b6ac-388bc308e348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb2b6d3fe0>]}
[0m06:30:41.775467 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19401786, "process_user_time": 1.376738, "process_kernel_time": 0.099053, "process_mem_max_rss": "99884", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:30:41.776064 [debug] [MainThread]: Command `dbt clean` succeeded at 06:30:41.775952 after 0.19 seconds
[0m06:30:41.776501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb2b942de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb2d58cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb2b663380>]}
[0m06:30:41.776979 [debug] [MainThread]: Flushing usage events
[0m14:29:43.972621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f20358740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1d86ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1d86ad50>]}


============================== 14:29:43.988989 | fead6be1-0e73-42bf-9e78-6a60f2b80ec7 ==============================
[0m14:29:43.988989 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:29:43.989675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:29:44.129037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fead6be1-0e73-42bf-9e78-6a60f2b80ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1f532c60>]}
[0m14:29:44.143003 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-pa40hhwq'
[0m14:29:44.143503 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:29:44.234592 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:29:44.236380 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:29:44.287063 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:29:44.292423 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:29:44.705712 [info ] [MainThread]: Installed from version 1.2.0
[0m14:29:44.706312 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:29:44.706885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fead6be1-0e73-42bf-9e78-6a60f2b80ec7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1d582e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1d5cfe00>]}
[0m14:29:44.707343 [info ] [MainThread]: 
[0m14:29:44.707802 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:29:44.714771 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.78735703, "process_user_time": 1.508434, "process_kernel_time": 0.100828, "process_mem_max_rss": "101788", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m14:29:44.715413 [debug] [MainThread]: Command `dbt deps` succeeded at 14:29:44.715317 after 0.79 seconds
[0m14:29:44.715809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1d864950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1d70a3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1d708ef0>]}
[0m14:29:44.716193 [debug] [MainThread]: Flushing usage events
[0m14:29:46.420958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe251fd9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f9e2a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2506bab70>]}


============================== 14:29:46.423954 | 8615ef5f-08ae-4ca9-8dcd-f34ad36b32db ==============================
[0m14:29:46.423954 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:29:46.424580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:29:46.631872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8615ef5f-08ae-4ca9-8dcd-f34ad36b32db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f9673b0>]}
[0m14:29:46.686410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8615ef5f-08ae-4ca9-8dcd-f34ad36b32db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f6c34a0>]}
[0m14:29:46.688133 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:29:46.712169 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:29:46.712880 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:29:46.713357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8615ef5f-08ae-4ca9-8dcd-f34ad36b32db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f877440>]}
[0m14:29:47.921839 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:29:47.922395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8615ef5f-08ae-4ca9-8dcd-f34ad36b32db', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24784aea0>]}
[0m14:29:48.172954 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:29:48.179705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8615ef5f-08ae-4ca9-8dcd-f34ad36b32db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2479d90a0>]}
[0m14:29:48.268497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8615ef5f-08ae-4ca9-8dcd-f34ad36b32db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2480968d0>]}
[0m14:29:48.269032 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:29:48.269465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8615ef5f-08ae-4ca9-8dcd-f34ad36b32db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f7cafc0>]}
[0m14:29:48.271337 [info ] [MainThread]: 
[0m14:29:48.272004 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:29:48.276425 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:29:48.307670 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:29:48.308198 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:29:48.308606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:49.013044 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:29:49.014933 [debug] [ThreadPool]: On list_petro: Close
[0m14:29:49.015922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:29:49.016610 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:29:49.024649 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:29:49.025178 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:29:49.025635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:29:49.027892 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:29:49.029268 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:29:49.029634 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:29:49.030265 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:29:49.030619 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:29:49.030928 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:29:49.031542 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:29:49.032450 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:29:49.032803 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:29:49.033110 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:29:49.033656 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:29:49.034017 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:29:49.035329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:29:49.041114 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:29:49.041537 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:29:49.041861 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:29:49.042625 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:29:49.042990 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:29:49.043331 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:29:49.054237 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:29:49.055776 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:29:49.057021 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:29:49.057430 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:29:49.058677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8615ef5f-08ae-4ca9-8dcd-f34ad36b32db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f9369f0>]}
[0m14:29:49.059338 [debug] [MainThread]: Using duckdb connection "master"
[0m14:29:49.059807 [debug] [MainThread]: On master: BEGIN
[0m14:29:49.060158 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:29:49.061502 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:29:49.061911 [debug] [MainThread]: On master: COMMIT
[0m14:29:49.062265 [debug] [MainThread]: Using duckdb connection "master"
[0m14:29:49.062611 [debug] [MainThread]: On master: COMMIT
[0m14:29:49.063187 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:29:49.063566 [debug] [MainThread]: On master: Close
[0m14:29:49.064037 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:29:49.064494 [info ] [MainThread]: 
[0m14:29:49.073862 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:29:49.074630 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:29:49.075363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:29:49.075891 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:29:49.103407 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:29:49.104206 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:29:49.137233 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:29:49.138045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:59.176453 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:29:59.176988 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:29:59.177757 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:29:59.178172 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:29:59.178594 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:29:59.179617 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:29:59.180994 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:29:59.181428 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:29:59.182503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:29:59.190168 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:29:59.190624 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:29:59.191429 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:29:59.194453 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:29:59.194865 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:29:59.195714 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:29:59.211194 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:29:59.211733 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:29:59.212108 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:29:59.213879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:29:59.219600 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:29:59.220059 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:29:59.221552 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:29:59.223950 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:29:59.225449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8615ef5f-08ae-4ca9-8dcd-f34ad36b32db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24782ddc0>]}
[0m14:29:59.226128 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.15s]
[0m14:29:59.226918 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:29:59.227941 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:29:59.228485 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:29:59.229096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:29:59.229542 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:29:59.234830 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:29:59.235459 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:29:59.268448 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:29:59.268973 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260209142959262847"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:29:59.269404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:59.277139 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:29:59.284836 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:29:59.285352 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:29:59.286258 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:29:59.286669 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:29:59.287025 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260209142959262847'
      
      
      order by ordinal_position

  
[0m14:29:59.289749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:29:59.295034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:29:59.295493 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:29:59.298363 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:29:59.305958 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:29:59.306421 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:29:59.309433 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:29:59.311181 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:29:59.311613 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:29:59.312402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:29:59.329061 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:29:59.329822 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:29:59.330282 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260209142959262847"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260209142959262847"
    )
  
[0m14:29:59.344126 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:29:59.346055 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:29:59.346514 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:29:59.346879 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:29:59.352632 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:29:59.353590 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:29:59.354279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8615ef5f-08ae-4ca9-8dcd-f34ad36b32db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe205d9d4c0>]}
[0m14:29:59.354920 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m14:29:59.355565 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:29:59.357348 [debug] [MainThread]: Using duckdb connection "master"
[0m14:29:59.357750 [debug] [MainThread]: On master: BEGIN
[0m14:29:59.358086 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:29:59.358925 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:29:59.359314 [debug] [MainThread]: On master: COMMIT
[0m14:29:59.359651 [debug] [MainThread]: Using duckdb connection "master"
[0m14:29:59.359970 [debug] [MainThread]: On master: COMMIT
[0m14:29:59.360593 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:29:59.360958 [debug] [MainThread]: On master: Close
[0m14:29:59.361430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:59.361750 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:29:59.362106 [info ] [MainThread]: 
[0m14:29:59.362558 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.09 seconds (11.09s).
[0m14:29:59.363386 [debug] [MainThread]: Command end result
[0m14:29:59.387182 [info ] [MainThread]: 
[0m14:29:59.387791 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:29:59.388206 [info ] [MainThread]: 
[0m14:29:59.388633 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:29:59.389529 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.015363, "process_user_time": 5.152724, "process_kernel_time": 0.196836, "process_mem_max_rss": "301476", "process_in_blocks": "1200", "process_out_blocks": "107384"}
[0m14:29:59.390040 [debug] [MainThread]: Command `dbt run` succeeded at 14:29:59.389953 after 13.02 seconds
[0m14:29:59.390451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f967560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24784b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24fd37560>]}
[0m14:29:59.390844 [debug] [MainThread]: Flushing usage events
[0m14:30:01.280081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589d180f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589d045ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589d35d4c0>]}


============================== 14:30:01.283175 | 71425b88-b309-42c6-9fee-7b95f28b4cc3 ==============================
[0m14:30:01.283175 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:30:01.283802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:30:01.386334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71425b88-b309-42c6-9fee-7b95f28b4cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589fc0b350>]}
[0m14:30:01.400837 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16773783, "process_user_time": 1.230258, "process_kernel_time": 0.079951, "process_mem_max_rss": "99632", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:30:01.401459 [debug] [MainThread]: Command `dbt clean` succeeded at 14:30:01.401355 after 0.17 seconds
[0m14:30:01.401908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589fc0b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589d35d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589c9092e0>]}
[0m14:30:01.402447 [debug] [MainThread]: Flushing usage events
[0m22:14:13.281382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6126933b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6121d41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff612693770>]}


============================== 22:14:13.316746 | 6d479b10-e9de-4480-8062-3aca634bea02 ==============================
[0m22:14:13.316746 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:14:13.317414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:14:13.559466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d479b10-e9de-4480-8062-3aca634bea02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff613d16c60>]}
[0m22:14:13.574729 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-n3h4blye'
[0m22:14:13.575192 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:14:13.617188 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:14:13.618406 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:14:13.652093 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:14:13.657275 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:14:13.837108 [info ] [MainThread]: Installed from version 1.2.0
[0m22:14:13.837697 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:14:13.838226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6d479b10-e9de-4480-8062-3aca634bea02', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff611ec6720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff611d09cd0>]}
[0m22:14:13.838688 [info ] [MainThread]: 
[0m22:14:13.839155 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:14:13.846434 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.61663646, "process_user_time": 1.651728, "process_kernel_time": 0.13322, "process_mem_max_rss": "101264", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m22:14:13.846982 [debug] [MainThread]: Command `dbt deps` succeeded at 22:14:13.846882 after 0.62 seconds
[0m22:14:13.847432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6131d4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff611d55430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff611d55490>]}
[0m22:14:13.847843 [debug] [MainThread]: Flushing usage events
[0m22:14:15.415616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09de4934a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09de359a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09de35a330>]}


============================== 22:14:15.418642 | 3355ac2c-a61d-4c1f-a3ce-97f99333e2be ==============================
[0m22:14:15.418642 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:14:15.419344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:14:15.650349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3355ac2c-a61d-4c1f-a3ce-97f99333e2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09dd8bf3b0>]}
[0m22:14:15.711190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3355ac2c-a61d-4c1f-a3ce-97f99333e2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09dd9c5700>]}
[0m22:14:15.712945 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:14:15.744265 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:14:15.744973 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:14:15.745519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3355ac2c-a61d-4c1f-a3ce-97f99333e2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d62611f0>]}
[0m22:14:17.121259 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:14:17.121857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3355ac2c-a61d-4c1f-a3ce-97f99333e2be', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d5a1e600>]}
[0m22:14:17.357267 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:14:17.362410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3355ac2c-a61d-4c1f-a3ce-97f99333e2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d5a96fc0>]}
[0m22:14:17.453158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3355ac2c-a61d-4c1f-a3ce-97f99333e2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d5b86510>]}
[0m22:14:17.453696 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:14:17.454223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3355ac2c-a61d-4c1f-a3ce-97f99333e2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d5b4ebd0>]}
[0m22:14:17.456249 [info ] [MainThread]: 
[0m22:14:17.456943 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:14:17.461726 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:14:17.497403 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:14:17.497840 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:14:17.498256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:17.948754 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:14:17.950387 [debug] [ThreadPool]: On list_petro: Close
[0m22:14:17.951287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:14:17.951825 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:14:17.959328 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:14:17.959744 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:14:17.960117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:14:17.961256 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:14:17.962539 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:14:17.962928 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:14:17.963514 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:14:17.963893 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:14:17.964268 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:14:17.964866 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:14:17.965771 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:14:17.966163 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:14:17.966555 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:14:17.967140 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:14:17.967566 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:14:17.968737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:14:17.974507 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:14:17.974905 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:14:17.975285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:14:17.975947 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:14:17.976354 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:14:17.976788 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:14:17.987552 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:14:17.988869 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:14:17.990053 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:14:17.990480 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:14:17.991523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3355ac2c-a61d-4c1f-a3ce-97f99333e2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09df782930>]}
[0m22:14:17.992030 [debug] [MainThread]: Using duckdb connection "master"
[0m22:14:17.992471 [debug] [MainThread]: On master: BEGIN
[0m22:14:17.992836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:14:17.993536 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:14:17.993941 [debug] [MainThread]: On master: COMMIT
[0m22:14:17.994363 [debug] [MainThread]: Using duckdb connection "master"
[0m22:14:17.994734 [debug] [MainThread]: On master: COMMIT
[0m22:14:17.995318 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:14:17.995710 [debug] [MainThread]: On master: Close
[0m22:14:17.996192 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:14:17.996712 [info ] [MainThread]: 
[0m22:14:18.053915 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:14:18.054516 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:14:18.055148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:14:18.055604 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:14:18.082358 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:14:18.083078 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:14:18.118198 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:14:18.118944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:26.676590 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:14:26.677139 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:14:26.677898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:14:26.678376 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:14:26.678804 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:14:26.679813 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:14:26.681166 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:14:26.681622 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:14:26.682662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:14:26.690553 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:14:26.691005 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:14:26.691829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:14:26.694780 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:14:26.695243 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:14:26.695963 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:14:26.712500 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:14:26.712961 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:14:26.713401 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:14:26.715193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:14:26.720814 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:14:26.721284 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:14:26.722432 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:14:26.724808 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:14:26.726318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3355ac2c-a61d-4c1f-a3ce-97f99333e2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d40b71a0>]}
[0m22:14:26.726988 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.67s]
[0m22:14:26.727770 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:14:26.728743 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:14:26.729313 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:14:26.729898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:14:26.730351 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:14:26.735336 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:14:26.735971 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:14:26.771773 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:14:26.772274 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260209221426765858"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:14:26.772726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:26.779541 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:14:26.786929 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:14:26.787434 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:14:26.788079 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:14:26.788544 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:14:26.788965 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260209221426765858'
      
      
      order by ordinal_position

  
[0m22:14:26.791451 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:14:26.796554 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:14:26.797009 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:14:26.799481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:14:26.807098 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:14:26.807572 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:14:26.809913 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:14:26.811566 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:14:26.812006 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:14:26.812723 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:14:26.830827 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:14:26.831500 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:14:26.831958 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260209221426765858"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260209221426765858"
    )
  
[0m22:14:26.843186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:14:26.844944 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:14:26.845398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:14:26.845802 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:14:26.851281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:14:26.852123 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:14:26.852782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3355ac2c-a61d-4c1f-a3ce-97f99333e2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09925948c0>]}
[0m22:14:26.853449 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m22:14:26.854174 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:14:26.855705 [debug] [MainThread]: Using duckdb connection "master"
[0m22:14:26.856119 [debug] [MainThread]: On master: BEGIN
[0m22:14:26.856538 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:14:26.857241 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:14:26.857649 [debug] [MainThread]: On master: COMMIT
[0m22:14:26.858015 [debug] [MainThread]: Using duckdb connection "master"
[0m22:14:26.858420 [debug] [MainThread]: On master: COMMIT
[0m22:14:26.858993 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:14:26.859428 [debug] [MainThread]: On master: Close
[0m22:14:26.859886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:14:26.860266 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:14:26.860662 [info ] [MainThread]: 
[0m22:14:26.861115 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.40 seconds (9.40s).
[0m22:14:26.862013 [debug] [MainThread]: Command end result
[0m22:14:26.887415 [info ] [MainThread]: 
[0m22:14:26.887979 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:14:26.888462 [info ] [MainThread]: 
[0m22:14:26.888937 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:14:26.889879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.525606, "process_user_time": 5.691854, "process_kernel_time": 0.284342, "process_mem_max_rss": "282216", "process_in_blocks": "1200", "process_out_blocks": "107416"}
[0m22:14:26.890441 [debug] [MainThread]: Command `dbt run` succeeded at 22:14:26.890338 after 11.53 seconds
[0m22:14:26.890874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09e1fbb980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09dde840e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09de491c70>]}
[0m22:14:26.891318 [debug] [MainThread]: Flushing usage events
[0m22:14:28.649397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d2824800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d06fa240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d0422060>]}


============================== 22:14:28.652399 | 2b50af38-73b7-47b0-9a42-3a4969c9b609 ==============================
[0m22:14:28.652399 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:14:28.653078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:14:28.768430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b50af38-73b7-47b0-9a42-3a4969c9b609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d09b66c0>]}
[0m22:14:28.786389 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18888032, "process_user_time": 1.322092, "process_kernel_time": 0.111923, "process_mem_max_rss": "99764", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:14:28.786923 [debug] [MainThread]: Command `dbt clean` succeeded at 22:14:28.786823 after 0.19 seconds
[0m22:14:28.787377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d46d3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d0cbc3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d09b66c0>]}
[0m22:14:28.787787 [debug] [MainThread]: Flushing usage events
[0m06:30:44.739139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f460f0ae060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f460f05dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f460f4aa180>]}


============================== 06:30:44.757277 | fd1ab471-709c-4db1-aa81-d9abb9726c8c ==============================
[0m06:30:44.757277 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:30:44.758017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:30:44.926808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd1ab471-709c-4db1-aa81-d9abb9726c8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f460eed9910>]}
[0m06:30:44.943653 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fymnox48'
[0m06:30:44.944150 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:30:45.086609 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:30:45.088136 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:30:45.120101 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:30:45.125844 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:30:45.605172 [info ] [MainThread]: Installed from version 1.2.0
[0m06:30:45.605813 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:30:45.606381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fd1ab471-709c-4db1-aa81-d9abb9726c8c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f460eed8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f460eed9010>]}
[0m06:30:45.606877 [info ] [MainThread]: 
[0m06:30:45.607361 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:30:45.618361 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.93108505, "process_user_time": 1.694281, "process_kernel_time": 0.130021, "process_mem_max_rss": "101472", "process_in_blocks": "9032", "process_out_blocks": "5176"}
[0m06:30:45.618959 [debug] [MainThread]: Command `dbt deps` succeeded at 06:30:45.618854 after 0.93 seconds
[0m06:30:45.619392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46133bb980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f460ee43fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f460f4360f0>]}
[0m06:30:45.619856 [debug] [MainThread]: Flushing usage events
[0m06:30:47.462086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafb478b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafb1c21df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafb11a6d50>]}


============================== 06:30:47.465166 | 06029a1c-db88-4b22-ad2d-4e88bc87b7ef ==============================
[0m06:30:47.465166 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:30:47.465872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:30:47.695298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06029a1c-db88-4b22-ad2d-4e88bc87b7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafb30986e0>]}
[0m06:30:47.756115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06029a1c-db88-4b22-ad2d-4e88bc87b7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafb1153ec0>]}
[0m06:30:47.757885 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:30:47.786916 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:30:47.787723 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:30:47.788252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '06029a1c-db88-4b22-ad2d-4e88bc87b7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafb1253470>]}
[0m06:30:49.192522 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:30:49.193183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '06029a1c-db88-4b22-ad2d-4e88bc87b7ef', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa9246450>]}
[0m06:30:49.439373 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:30:49.444825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06029a1c-db88-4b22-ad2d-4e88bc87b7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafb164cf20>]}
[0m06:30:49.562876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06029a1c-db88-4b22-ad2d-4e88bc87b7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa9ac0c20>]}
[0m06:30:49.563479 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:30:49.563990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06029a1c-db88-4b22-ad2d-4e88bc87b7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa9255580>]}
[0m06:30:49.566016 [info ] [MainThread]: 
[0m06:30:49.566758 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:30:49.571627 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:30:49.608001 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:30:49.608485 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:30:49.608876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:30:50.122719 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:30:50.124559 [debug] [ThreadPool]: On list_petro: Close
[0m06:30:50.125497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:30:50.126084 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:30:50.133664 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:30:50.134082 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:30:50.134497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:30:50.135897 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:30:50.137496 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:30:50.137974 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:30:50.138699 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:30:50.139323 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:30:50.139869 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:30:50.140608 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:30:50.141753 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:30:50.142212 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:30:50.142688 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:30:50.143382 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:30:50.143901 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:30:50.145358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:30:50.151640 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:30:50.152050 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:30:50.152435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:30:50.153108 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:30:50.153534 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:30:50.153914 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:30:50.164233 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:30:50.165683 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:30:50.166928 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:30:50.167335 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:30:50.168515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06029a1c-db88-4b22-ad2d-4e88bc87b7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa3d26900>]}
[0m06:30:50.169037 [debug] [MainThread]: Using duckdb connection "master"
[0m06:30:50.169455 [debug] [MainThread]: On master: BEGIN
[0m06:30:50.169831 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:30:50.170738 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:30:50.171139 [debug] [MainThread]: On master: COMMIT
[0m06:30:50.171561 [debug] [MainThread]: Using duckdb connection "master"
[0m06:30:50.171926 [debug] [MainThread]: On master: COMMIT
[0m06:30:50.172554 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:30:50.172950 [debug] [MainThread]: On master: Close
[0m06:30:50.173475 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:30:50.173942 [info ] [MainThread]: 
[0m06:30:50.196022 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:30:50.196669 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:30:50.197262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:30:50.197727 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:30:50.224862 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:30:50.225640 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:30:50.260931 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:30:50.261718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:31:00.259785 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:31:00.260350 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:31:00.261096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:31:00.261553 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:31:00.261969 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:31:00.262935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:31:00.264309 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:31:00.264778 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:31:00.265716 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:31:00.273674 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:31:00.274140 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:31:00.274938 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:31:00.277967 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:31:00.278449 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:31:00.279223 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:31:00.295933 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:31:00.296422 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:31:00.296856 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:31:00.298896 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:31:00.304795 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:31:00.305252 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:31:00.306642 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:31:00.309090 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:31:00.310663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06029a1c-db88-4b22-ad2d-4e88bc87b7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa9270530>]}
[0m06:31:00.311346 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.11s]
[0m06:31:00.312115 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:31:00.312952 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:31:00.313523 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:31:00.314296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:31:00.314778 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:31:00.319863 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:31:00.320554 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:31:00.357634 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:31:00.358386 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260210063100351124"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:31:00.358975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:31:00.366671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:31:00.374449 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:31:00.374909 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:31:00.375569 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:31:00.376006 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:31:00.376458 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260210063100351124'
      
      
      order by ordinal_position

  
[0m06:31:00.379082 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:31:00.384305 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:31:00.384784 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:31:00.387089 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:31:00.394789 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:31:00.395248 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:31:00.398283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:31:00.399991 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:31:00.400459 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:31:00.401176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:31:00.419944 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:31:00.420753 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:31:00.421214 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260210063100351124"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260210063100351124"
    )
  
[0m06:31:00.431999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:31:00.433964 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:31:00.434436 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:31:00.434853 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:31:00.440347 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:31:00.441272 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:31:00.442652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06029a1c-db88-4b22-ad2d-4e88bc87b7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf664ec320>]}
[0m06:31:00.443337 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m06:31:00.444104 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:31:00.445658 [debug] [MainThread]: Using duckdb connection "master"
[0m06:31:00.446097 [debug] [MainThread]: On master: BEGIN
[0m06:31:00.446506 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:31:00.447281 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:31:00.447719 [debug] [MainThread]: On master: COMMIT
[0m06:31:00.448102 [debug] [MainThread]: Using duckdb connection "master"
[0m06:31:00.448514 [debug] [MainThread]: On master: COMMIT
[0m06:31:00.449081 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:31:00.449538 [debug] [MainThread]: On master: Close
[0m06:31:00.450016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:31:00.450381 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:31:00.450807 [info ] [MainThread]: 
[0m06:31:00.451318 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.88 seconds (10.88s).
[0m06:31:00.452652 [debug] [MainThread]: Command end result
[0m06:31:00.480171 [info ] [MainThread]: 
[0m06:31:00.480865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:31:00.481378 [info ] [MainThread]: 
[0m06:31:00.481931 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:31:00.482941 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.073008, "process_user_time": 5.388436, "process_kernel_time": 0.296803, "process_mem_max_rss": "284372", "process_in_blocks": "1200", "process_out_blocks": "107392"}
[0m06:31:00.483520 [debug] [MainThread]: Command `dbt run` succeeded at 06:31:00.483377 after 13.07 seconds
[0m06:31:00.483964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafb1284380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafb17071d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf65cb30b0>]}
[0m06:31:00.484390 [debug] [MainThread]: Flushing usage events
[0m06:31:02.535758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f583c426a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f583cee1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f583cee3d10>]}


============================== 06:31:02.538863 | 37dcf0fc-21b8-4461-9654-ecd056e49d2b ==============================
[0m06:31:02.538863 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:31:02.539514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:31:02.654266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37dcf0fc-21b8-4461-9654-ecd056e49d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f583c6cab70>]}
[0m06:31:02.672716 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18929595, "process_user_time": 1.344155, "process_kernel_time": 0.101935, "process_mem_max_rss": "99768", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:31:02.673260 [debug] [MainThread]: Command `dbt clean` succeeded at 06:31:02.673159 after 0.19 seconds
[0m06:31:02.673730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f583c426a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5840236180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f583c4bac60>]}
[0m06:31:02.674153 [debug] [MainThread]: Flushing usage events
[0m14:35:35.088128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfa7092b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df86c54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df8783d40>]}


============================== 14:35:35.106101 | d7f56c8e-8ee8-4483-8586-3206fa3d90f4 ==============================
[0m14:35:35.106101 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:35:35.106903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:35:35.263894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7f56c8e-8ee8-4483-8586-3206fa3d90f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfa32ebd0>]}
[0m14:35:35.280716 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tlgafrda'
[0m14:35:35.281290 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:35:35.413302 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:35:35.415404 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:35:35.497828 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:35:35.503934 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:35:35.859354 [info ] [MainThread]: Installed from version 1.2.0
[0m14:35:35.859996 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:35:35.860628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd7f56c8e-8ee8-4483-8586-3206fa3d90f4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df8a99d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df83b0350>]}
[0m14:35:35.861138 [info ] [MainThread]: 
[0m14:35:35.861649 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:35:35.868299 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8336413, "process_user_time": 1.728331, "process_kernel_time": 0.152736, "process_mem_max_rss": "101428", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m14:35:35.868861 [debug] [MainThread]: Command `dbt deps` succeeded at 14:35:35.868756 after 0.83 seconds
[0m14:35:35.869348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfa32ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df8cc6e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df8cc5ee0>]}
[0m14:35:35.869778 [debug] [MainThread]: Flushing usage events
[0m14:35:37.725968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2180bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc21809730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc217a1460>]}


============================== 14:35:37.729210 | 9610b60d-89e4-456d-a891-f07b60d489ae ==============================
[0m14:35:37.729210 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:35:37.729950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:35:37.968588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9610b60d-89e4-456d-a891-f07b60d489ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc20c6a480>]}
[0m14:35:38.031608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9610b60d-89e4-456d-a891-f07b60d489ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc21937440>]}
[0m14:35:38.033531 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:35:38.059041 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:35:38.059816 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:35:38.060389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9610b60d-89e4-456d-a891-f07b60d489ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc20cded20>]}
[0m14:35:39.453515 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:35:39.454219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9610b60d-89e4-456d-a891-f07b60d489ae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc19769400>]}
[0m14:35:39.708112 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:35:39.713735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9610b60d-89e4-456d-a891-f07b60d489ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc18fec230>]}
[0m14:35:39.807505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9610b60d-89e4-456d-a891-f07b60d489ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc196be0f0>]}
[0m14:35:39.808120 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:35:39.808639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9610b60d-89e4-456d-a891-f07b60d489ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc220d3fb0>]}
[0m14:35:39.810792 [info ] [MainThread]: 
[0m14:35:39.811560 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:35:39.816608 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:35:39.853851 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:35:39.854386 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:35:39.854775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:40.482575 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:35:40.484847 [debug] [ThreadPool]: On list_petro: Close
[0m14:35:40.486072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:35:40.486686 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:35:40.494517 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:35:40.494969 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:35:40.495347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:40.496603 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:35:40.497996 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:35:40.498394 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:35:40.499013 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:35:40.499406 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:35:40.499771 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:35:40.500445 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:35:40.501396 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:35:40.501783 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:35:40.502170 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:35:40.502761 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:35:40.503196 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:35:40.504575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:35:40.510750 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:35:40.511192 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:35:40.511556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:40.512282 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:35:40.512676 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:35:40.513076 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:35:40.524159 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:35:40.525699 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:35:40.526963 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:35:40.527364 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:35:40.528554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9610b60d-89e4-456d-a891-f07b60d489ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc18a12a20>]}
[0m14:35:40.529113 [debug] [MainThread]: Using duckdb connection "master"
[0m14:35:40.529504 [debug] [MainThread]: On master: BEGIN
[0m14:35:40.529870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:40.530614 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:35:40.531036 [debug] [MainThread]: On master: COMMIT
[0m14:35:40.531412 [debug] [MainThread]: Using duckdb connection "master"
[0m14:35:40.531771 [debug] [MainThread]: On master: COMMIT
[0m14:35:40.532392 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:35:40.532787 [debug] [MainThread]: On master: Close
[0m14:35:40.533316 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:35:40.533793 [info ] [MainThread]: 
[0m14:35:40.552351 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:35:40.553076 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:35:40.553745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:35:40.554227 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:35:40.582219 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:35:40.583154 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:35:40.620199 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:35:40.621159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:52.369946 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:35:52.370528 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:35:52.371271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:35:52.371711 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:35:52.372174 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:35:52.373200 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:35:52.374610 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:35:52.375079 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:35:52.376182 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:35:52.384424 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:35:52.384926 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:35:52.386110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:35:52.389288 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:35:52.389734 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:35:52.390525 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:35:52.407293 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:35:52.407801 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:35:52.408245 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:35:52.410118 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:35:52.416132 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:35:52.416599 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:35:52.418037 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:35:52.420558 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:35:52.422114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9610b60d-89e4-456d-a891-f07b60d489ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbdf428e90>]}
[0m14:35:52.422819 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.87s]
[0m14:35:52.423627 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:35:52.424477 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:35:52.425090 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:35:52.425774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:35:52.426274 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:35:52.431970 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:35:52.432656 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:35:52.470056 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:35:52.470651 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260210143552463849"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:35:52.471190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:52.478643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:35:52.486845 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:35:52.487355 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:35:52.488168 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:35:52.488620 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:35:52.489102 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260210143552463849'
      
      
      order by ordinal_position

  
[0m14:35:52.491750 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:35:52.497332 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:35:52.497805 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:35:52.500412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:35:52.508342 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:35:52.508807 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:35:52.511225 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:35:52.512966 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:35:52.513415 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:35:52.514152 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:35:52.533055 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:35:52.533854 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:35:52.534343 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260210143552463849"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260210143552463849"
    )
  
[0m14:35:52.545563 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:35:52.547594 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:35:52.548097 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:35:52.548510 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:35:52.554744 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:35:52.555718 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:35:52.556448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9610b60d-89e4-456d-a891-f07b60d489ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbde17c230>]}
[0m14:35:52.557136 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m14:35:52.557978 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:35:52.559338 [debug] [MainThread]: Using duckdb connection "master"
[0m14:35:52.559750 [debug] [MainThread]: On master: BEGIN
[0m14:35:52.560174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:35:52.560939 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:35:52.561348 [debug] [MainThread]: On master: COMMIT
[0m14:35:52.561723 [debug] [MainThread]: Using duckdb connection "master"
[0m14:35:52.562126 [debug] [MainThread]: On master: COMMIT
[0m14:35:52.562759 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:35:52.563203 [debug] [MainThread]: On master: Close
[0m14:35:52.563680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:52.564108 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:35:52.564517 [info ] [MainThread]: 
[0m14:35:52.565060 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.75 seconds (12.75s).
[0m14:35:52.566124 [debug] [MainThread]: Command end result
[0m14:35:52.593042 [info ] [MainThread]: 
[0m14:35:52.593738 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:52.594293 [info ] [MainThread]: 
[0m14:35:52.594836 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:35:52.595912 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.923639, "process_user_time": 5.988254, "process_kernel_time": 0.335902, "process_mem_max_rss": "316984", "process_in_blocks": "1200", "process_out_blocks": "107384"}
[0m14:35:52.596465 [debug] [MainThread]: Command `dbt run` succeeded at 14:35:52.596361 after 14.92 seconds
[0m14:35:52.596936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc21c7c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc196c0560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc254d3980>]}
[0m14:35:52.597386 [debug] [MainThread]: Flushing usage events
[0m14:35:54.559536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6afbd4ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6afb96ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6afb96ea20>]}


============================== 14:35:54.562719 | 51d79b23-e45f-49bf-a2bf-493522305052 ==============================
[0m14:35:54.562719 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:35:54.563458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:35:54.679356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51d79b23-e45f-49bf-a2bf-493522305052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6afd688770>]}
[0m14:35:54.698005 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19171965, "process_user_time": 1.391144, "process_kernel_time": 0.116928, "process_mem_max_rss": "99512", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:35:54.698560 [debug] [MainThread]: Command `dbt clean` succeeded at 14:35:54.698458 after 0.19 seconds
[0m14:35:54.699026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6afbc0da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6afbf8c3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6afd688770>]}
[0m14:35:54.699452 [debug] [MainThread]: Flushing usage events
[0m22:17:26.412949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce5925430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce62b6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce81fca70>]}


============================== 22:17:26.431513 | 4a7ae2c1-2745-4c9f-9d63-6f05ea006fa7 ==============================
[0m22:17:26.431513 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:17:26.432162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:17:26.585697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a7ae2c1-2745-4c9f-9d63-6f05ea006fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce5abb440>]}
[0m22:17:26.601487 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-h6g05rm7'
[0m22:17:26.601968 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:17:26.723466 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:17:26.725136 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:17:26.768198 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:17:26.773405 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:17:26.869679 [info ] [MainThread]: Installed from version 1.2.0
[0m22:17:26.870310 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:17:26.870903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4a7ae2c1-2745-4c9f-9d63-6f05ea006fa7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce565de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce568ed80>]}
[0m22:17:26.871394 [info ] [MainThread]: 
[0m22:17:26.871896 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:17:26.877283 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.51541895, "process_user_time": 1.645191, "process_kernel_time": 0.129093, "process_mem_max_rss": "101392", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m22:17:26.877824 [debug] [MainThread]: Command `dbt deps` succeeded at 22:17:26.877725 after 0.52 seconds
[0m22:17:26.878270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce9ed3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce5972180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce56ef740>]}
[0m22:17:26.878684 [debug] [MainThread]: Flushing usage events
[0m22:17:28.499020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a455a80e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a44fe46b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a455a95e0>]}


============================== 22:17:28.502309 | aaef5ff6-5e3a-4118-8d08-a762d31a5699 ==============================
[0m22:17:28.502309 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:17:28.503042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:17:28.735443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aaef5ff6-5e3a-4118-8d08-a762d31a5699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a45d01b50>]}
[0m22:17:28.796438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aaef5ff6-5e3a-4118-8d08-a762d31a5699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a4500d730>]}
[0m22:17:28.798297 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:17:28.823718 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:17:28.824552 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:17:28.825114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aaef5ff6-5e3a-4118-8d08-a762d31a5699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a44afecf0>]}
[0m22:17:30.212488 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:17:30.213155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aaef5ff6-5e3a-4118-8d08-a762d31a5699', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3cc2aae0>]}
[0m22:17:30.466578 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:17:30.472396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aaef5ff6-5e3a-4118-8d08-a762d31a5699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a44b8eed0>]}
[0m22:17:30.565902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aaef5ff6-5e3a-4118-8d08-a762d31a5699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3d4d0dd0>]}
[0m22:17:30.566508 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:17:30.567038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaef5ff6-5e3a-4118-8d08-a762d31a5699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3cdab3e0>]}
[0m22:17:30.569135 [info ] [MainThread]: 
[0m22:17:30.569895 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:17:30.574897 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:17:30.611880 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:17:30.612400 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:17:30.612787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:31.338252 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:17:31.340646 [debug] [ThreadPool]: On list_petro: Close
[0m22:17:31.341650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:17:31.342262 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:17:31.350542 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:17:31.350990 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:17:31.351440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:17:31.352796 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:17:31.354203 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:17:31.354605 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:17:31.355491 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:17:31.355878 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:17:31.356284 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:17:31.356905 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:17:31.357841 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:17:31.358238 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:17:31.358605 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:17:31.359189 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:17:31.359588 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:17:31.360946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:17:31.367127 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:17:31.367552 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:17:31.367918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:17:31.368821 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:17:31.369235 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:17:31.369613 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:17:31.380787 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:17:31.382218 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:17:31.383432 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:17:31.383835 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:17:31.385005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaef5ff6-5e3a-4118-8d08-a762d31a5699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a46a8e870>]}
[0m22:17:31.385661 [debug] [MainThread]: Using duckdb connection "master"
[0m22:17:31.386042 [debug] [MainThread]: On master: BEGIN
[0m22:17:31.386438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:17:31.387101 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:17:31.387520 [debug] [MainThread]: On master: COMMIT
[0m22:17:31.387889 [debug] [MainThread]: Using duckdb connection "master"
[0m22:17:31.388271 [debug] [MainThread]: On master: COMMIT
[0m22:17:31.388853 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:17:31.389264 [debug] [MainThread]: On master: Close
[0m22:17:31.389749 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:17:31.390248 [info ] [MainThread]: 
[0m22:17:31.407462 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:17:31.408077 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:17:31.408755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:17:31.409212 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:17:31.436889 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:17:31.437693 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:17:31.473352 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:17:31.474267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:39.506540 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:39.507106 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:17:39.507871 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:39.508346 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:39.508768 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:17:39.509765 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:39.511139 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:39.511604 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:17:39.512727 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:39.520833 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:39.521338 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:17:39.522163 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:39.525231 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:39.525676 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:17:39.526413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:39.543033 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:17:39.543549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:39.543978 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:17:39.546111 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:39.552200 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:39.552671 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:17:39.553934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:39.556489 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:17:39.558075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaef5ff6-5e3a-4118-8d08-a762d31a5699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3cdde7b0>]}
[0m22:17:39.558834 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.15s]
[0m22:17:39.559623 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:17:39.560635 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:17:39.561237 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:17:39.561859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:17:39.562345 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:17:39.567668 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:17:39.568359 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:17:39.605264 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:39.605831 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260210221739599054"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:17:39.606316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:39.613779 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:39.622009 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:39.622518 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:17:39.623265 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:39.623715 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:39.624149 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260210221739599054'
      
      
      order by ordinal_position

  
[0m22:17:39.626829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:39.632517 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:39.632990 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:17:39.635572 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:39.643593 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:39.644062 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:17:39.647180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:39.648918 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:39.649389 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:17:39.650115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:39.669072 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:17:39.669886 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:39.670407 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260210221739599054"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260210221739599054"
    )
  
[0m22:17:39.682528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:39.684555 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:17:39.685029 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:39.685483 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:17:39.691070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:39.692017 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:17:39.692712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaef5ff6-5e3a-4118-8d08-a762d31a5699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f9014770>]}
[0m22:17:39.693403 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m22:17:39.694133 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:17:39.695572 [debug] [MainThread]: Using duckdb connection "master"
[0m22:17:39.695977 [debug] [MainThread]: On master: BEGIN
[0m22:17:39.696391 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:17:39.697111 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:17:39.697541 [debug] [MainThread]: On master: COMMIT
[0m22:17:39.697911 [debug] [MainThread]: Using duckdb connection "master"
[0m22:17:39.698313 [debug] [MainThread]: On master: COMMIT
[0m22:17:39.698899 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:17:39.699328 [debug] [MainThread]: On master: Close
[0m22:17:39.699795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:39.700162 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:17:39.700609 [info ] [MainThread]: 
[0m22:17:39.701096 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.13 seconds (9.13s).
[0m22:17:39.702052 [debug] [MainThread]: Command end result
[0m22:17:39.729311 [info ] [MainThread]: 
[0m22:17:39.730017 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:17:39.730563 [info ] [MainThread]: 
[0m22:17:39.731079 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:17:39.732143 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.285991, "process_user_time": 6.010376, "process_kernel_time": 0.315442, "process_mem_max_rss": "315772", "process_in_blocks": "1200", "process_out_blocks": "107424"}
[0m22:17:39.732720 [debug] [MainThread]: Command `dbt run` succeeded at 22:17:39.732616 after 11.29 seconds
[0m22:17:39.733185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a4560df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1c1b81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a450eff80>]}
[0m22:17:39.733626 [debug] [MainThread]: Flushing usage events
[0m22:17:41.520254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02c8096180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02c78a6e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02c9599a30>]}


============================== 22:17:41.523358 | ebf26a1a-e256-4c6f-9e2b-1e7d243107ee ==============================
[0m22:17:41.523358 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:17:41.524045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:17:41.639326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebf26a1a-e256-4c6f-9e2b-1e7d243107ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02c79bb4a0>]}
[0m22:17:41.657681 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18989238, "process_user_time": 1.369207, "process_kernel_time": 0.119843, "process_mem_max_rss": "99532", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:17:41.658294 [debug] [MainThread]: Command `dbt clean` succeeded at 22:17:41.658130 after 0.19 seconds
[0m22:17:41.658732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02c7692780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02c7929550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02c7402060>]}
[0m22:17:41.659157 [debug] [MainThread]: Flushing usage events
[0m06:29:37.570491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde0ffd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efddf0ab920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efddf346030>]}


============================== 06:29:37.590119 | 6e9c2367-9445-4c8a-9463-fc1389d803b4 ==============================
[0m06:29:37.590119 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:29:37.590784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:29:37.747939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e9c2367-9445-4c8a-9463-fc1389d803b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdded20e90>]}
[0m06:29:37.763289 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-527tkhyb'
[0m06:29:37.763735 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:29:37.867050 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:29:37.868709 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:29:37.958253 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:29:37.963760 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:29:38.111265 [info ] [MainThread]: Installed from version 1.2.0
[0m06:29:38.111847 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:29:38.112432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6e9c2367-9445-4c8a-9463-fc1389d803b4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efddf2f61b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efddec7f440>]}
[0m06:29:38.112861 [info ] [MainThread]: 
[0m06:29:38.113369 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:29:38.120324 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.59958595, "process_user_time": 1.585335, "process_kernel_time": 0.159234, "process_mem_max_rss": "101540", "process_in_blocks": "8496", "process_out_blocks": "5168"}
[0m06:29:38.120882 [debug] [MainThread]: Command `dbt deps` succeeded at 06:29:38.120784 after 0.60 seconds
[0m06:29:38.121293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde34d3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdded5a180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efddf88c2c0>]}
[0m06:29:38.121676 [debug] [MainThread]: Flushing usage events
[0m06:29:39.679998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00128cae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f001345a180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00136b83b0>]}


============================== 06:29:39.683117 | 121f9806-3b50-4a23-b0c4-005a32a530f1 ==============================
[0m06:29:39.683117 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:29:39.683735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:29:39.908508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '121f9806-3b50-4a23-b0c4-005a32a530f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00124c9d90>]}
[0m06:29:39.967361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '121f9806-3b50-4a23-b0c4-005a32a530f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00121c83b0>]}
[0m06:29:39.969202 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:29:39.990499 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:29:39.991215 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:29:39.991692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '121f9806-3b50-4a23-b0c4-005a32a530f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00127702f0>]}
[0m06:29:41.213397 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:29:41.214017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '121f9806-3b50-4a23-b0c4-005a32a530f1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0012270a40>]}
[0m06:29:41.442737 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:29:41.448129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '121f9806-3b50-4a23-b0c4-005a32a530f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0012b350d0>]}
[0m06:29:41.536140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '121f9806-3b50-4a23-b0c4-005a32a530f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f000acd3860>]}
[0m06:29:41.536707 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:29:41.537175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '121f9806-3b50-4a23-b0c4-005a32a530f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f000a46f560>]}
[0m06:29:41.539185 [info ] [MainThread]: 
[0m06:29:41.539900 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:29:41.544519 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:29:41.580652 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:29:41.581175 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:29:41.581575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:29:42.019587 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:42.021232 [debug] [ThreadPool]: On list_petro: Close
[0m06:29:42.022090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:29:42.022662 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:29:42.029944 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:42.030391 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:29:42.030738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:42.031763 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:42.033087 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:42.033475 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:29:42.034026 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:42.034403 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:42.034725 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:29:42.035311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:42.036211 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:29:42.036561 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:42.036877 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:29:42.037549 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:42.037952 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:29:42.039227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:29:42.044965 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:29:42.045377 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:29:42.045701 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:42.046565 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:42.046944 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:29:42.047316 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:29:42.056853 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:42.058266 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:29:42.059423 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:29:42.059792 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:29:42.060789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '121f9806-3b50-4a23-b0c4-005a32a530f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f001428eb40>]}
[0m06:29:42.061310 [debug] [MainThread]: Using duckdb connection "master"
[0m06:29:42.061672 [debug] [MainThread]: On master: BEGIN
[0m06:29:42.061996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:29:42.062714 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:29:42.063090 [debug] [MainThread]: On master: COMMIT
[0m06:29:42.063469 [debug] [MainThread]: Using duckdb connection "master"
[0m06:29:42.063787 [debug] [MainThread]: On master: COMMIT
[0m06:29:42.064343 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:29:42.064711 [debug] [MainThread]: On master: Close
[0m06:29:42.065200 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:29:42.065636 [info ] [MainThread]: 
[0m06:29:42.088757 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:29:42.089374 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:29:42.089936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:29:42.090364 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:29:42.115793 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:29:42.116599 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:29:42.150562 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:29:42.151396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:50.754808 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:50.755373 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:29:50.756124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:50.756551 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:50.756923 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:29:50.757870 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:50.759249 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:50.759663 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:29:50.760627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:50.768508 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:50.768954 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:29:50.769728 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:50.772646 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:50.773054 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:29:50.773759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:50.789908 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:29:50.790389 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:50.790764 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:29:50.792930 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:50.798564 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:50.799004 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:29:50.800236 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:50.802644 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:29:50.804151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '121f9806-3b50-4a23-b0c4-005a32a530f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f000ac760f0>]}
[0m06:29:50.804824 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.71s]
[0m06:29:50.805595 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:29:50.806588 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:29:50.807147 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:29:50.807758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:29:50.808188 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:29:50.812978 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:29:50.813640 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:29:50.847480 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:50.847981 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260211062950841655"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:29:50.848418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:50.856029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:50.863480 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:50.863923 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:29:50.864595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:50.865025 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:50.865437 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260211062950841655'
      
      
      order by ordinal_position

  
[0m06:29:50.867852 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:50.872990 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:50.873446 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:29:50.875754 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:50.883169 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:50.883611 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:29:50.886362 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:50.888033 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:50.888471 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:29:50.889180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:50.906866 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:29:50.907599 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:50.908015 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260211062950841655"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260211062950841655"
    )
  
[0m06:29:50.918055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:50.919782 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:29:50.920207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:50.920578 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:29:50.926081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:50.926958 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:29:50.927611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '121f9806-3b50-4a23-b0c4-005a32a530f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effc2eff560>]}
[0m06:29:50.928261 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m06:29:50.928923 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:29:50.930648 [debug] [MainThread]: Using duckdb connection "master"
[0m06:29:50.931053 [debug] [MainThread]: On master: BEGIN
[0m06:29:50.931443 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:29:50.932092 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:29:50.932516 [debug] [MainThread]: On master: COMMIT
[0m06:29:50.932853 [debug] [MainThread]: Using duckdb connection "master"
[0m06:29:50.933221 [debug] [MainThread]: On master: COMMIT
[0m06:29:50.933785 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:29:50.934201 [debug] [MainThread]: On master: Close
[0m06:29:50.934651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:29:50.934982 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:29:50.935393 [info ] [MainThread]: 
[0m06:29:50.935821 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.40 seconds (9.40s).
[0m06:29:50.936640 [debug] [MainThread]: Command end result
[0m06:29:50.962006 [info ] [MainThread]: 
[0m06:29:50.962602 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:29:50.963031 [info ] [MainThread]: 
[0m06:29:50.963483 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:29:50.964423 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.334782, "process_user_time": 5.049239, "process_kernel_time": 0.305135, "process_mem_max_rss": "301596", "process_in_blocks": "1200", "process_out_blocks": "107392"}
[0m06:29:50.964930 [debug] [MainThread]: Command `dbt run` succeeded at 06:29:50.964841 after 11.34 seconds
[0m06:29:50.965383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f000a42ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00124394c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f000acd3d70>]}
[0m06:29:50.965781 [debug] [MainThread]: Flushing usage events
[0m06:29:52.712972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fdd0f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fa2faa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fa407c20>]}


============================== 06:29:52.716123 | a11da397-3628-4bf7-8e1f-bbc95352f44d ==============================
[0m06:29:52.716123 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:29:52.716757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:29:52.827943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a11da397-3628-4bf7-8e1f-bbc95352f44d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fbd986e0>]}
[0m06:29:52.845694 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18330954, "process_user_time": 1.279999, "process_kernel_time": 0.131896, "process_mem_max_rss": "99640", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:29:52.846310 [debug] [MainThread]: Command `dbt clean` succeeded at 06:29:52.846210 after 0.18 seconds
[0m06:29:52.846718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fa05b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23f9eb8080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23f9ebbfb0>]}
[0m06:29:52.847122 [debug] [MainThread]: Flushing usage events
[0m14:31:06.191820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1cd2141d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1cd198530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1cd413980>]}


============================== 14:31:06.208693 | 26fc2ca8-e3b9-4f38-9edb-eafb565f1471 ==============================
[0m14:31:06.208693 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:31:06.209409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:31:06.369135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26fc2ca8-e3b9-4f38-9edb-eafb565f1471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1cce2f500>]}
[0m14:31:06.384789 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ugfno5lu'
[0m14:31:06.385284 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:31:06.475241 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:31:06.477031 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:31:06.520678 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:31:06.526354 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:31:06.617318 [info ] [MainThread]: Installed from version 1.2.0
[0m14:31:06.617952 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:31:06.618523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '26fc2ca8-e3b9-4f38-9edb-eafb565f1471', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ccf07320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ccdce540>]}
[0m14:31:06.618998 [info ] [MainThread]: 
[0m14:31:06.619490 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:31:06.625222 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4880208, "process_user_time": 1.679205, "process_kernel_time": 0.13056, "process_mem_max_rss": "101672", "process_in_blocks": "8496", "process_out_blocks": "5168"}
[0m14:31:06.625834 [debug] [MainThread]: Command `dbt deps` succeeded at 14:31:06.625725 after 0.49 seconds
[0m14:31:06.626268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1cdad21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1cce2f500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1cd1cdee0>]}
[0m14:31:06.626746 [debug] [MainThread]: Flushing usage events
[0m14:31:08.242592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d94ead670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d94311700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d9423a540>]}


============================== 14:31:08.245702 | d41f8dfc-1a4c-4230-9828-cf3ef831f33e ==============================
[0m14:31:08.245702 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:31:08.246381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:31:08.478468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd41f8dfc-1a4c-4230-9828-cf3ef831f33e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d94297800>]}
[0m14:31:08.539980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd41f8dfc-1a4c-4230-9828-cf3ef831f33e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d941d89e0>]}
[0m14:31:08.541833 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:31:08.571380 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:31:08.572164 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:31:08.572720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd41f8dfc-1a4c-4230-9828-cf3ef831f33e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d8ca63920>]}
[0m14:31:09.963370 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:31:09.964048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd41f8dfc-1a4c-4230-9828-cf3ef831f33e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d8c325be0>]}
[0m14:31:10.215797 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:31:10.221469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd41f8dfc-1a4c-4230-9828-cf3ef831f33e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d943126c0>]}
[0m14:31:10.314939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd41f8dfc-1a4c-4230-9828-cf3ef831f33e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d8c34d070>]}
[0m14:31:10.315595 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:31:10.316155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd41f8dfc-1a4c-4230-9828-cf3ef831f33e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d8c334b30>]}
[0m14:31:10.318242 [info ] [MainThread]: 
[0m14:31:10.318986 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:31:10.323984 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:31:10.360886 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:31:10.361397 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:31:10.361812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:10.978546 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:31:10.980183 [debug] [ThreadPool]: On list_petro: Close
[0m14:31:10.981163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:31:10.981785 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:31:10.989361 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:31:10.989816 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:31:10.990189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:31:10.991557 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:31:10.992904 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:31:10.993293 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:31:10.993905 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:31:10.994286 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:31:10.994672 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:31:10.995289 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:31:10.996220 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:31:10.996632 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:31:10.997001 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:31:10.997596 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:31:10.998001 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:31:10.999311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:31:11.005535 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:31:11.005949 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:31:11.006312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:31:11.007336 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:31:11.007768 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:31:11.008140 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:31:11.018774 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:31:11.020283 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:31:11.021557 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:31:11.021964 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:31:11.023077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd41f8dfc-1a4c-4230-9828-cf3ef831f33e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d8ca298b0>]}
[0m14:31:11.023628 [debug] [MainThread]: Using duckdb connection "master"
[0m14:31:11.024022 [debug] [MainThread]: On master: BEGIN
[0m14:31:11.024387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:31:11.025088 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:31:11.025483 [debug] [MainThread]: On master: COMMIT
[0m14:31:11.025884 [debug] [MainThread]: Using duckdb connection "master"
[0m14:31:11.026246 [debug] [MainThread]: On master: COMMIT
[0m14:31:11.026862 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:31:11.027257 [debug] [MainThread]: On master: Close
[0m14:31:11.027786 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:31:11.028264 [info ] [MainThread]: 
[0m14:31:11.038685 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:31:11.039297 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:31:11.039975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:31:11.040402 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:31:11.067651 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:31:11.068515 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:31:11.104417 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:31:11.105373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:20.718004 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:31:20.718588 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:31:20.719281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:20.719752 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:31:20.720177 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:31:20.721172 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:20.722568 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:31:20.723009 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:31:20.724044 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:20.731957 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:31:20.732441 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:31:20.733210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:20.736205 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:31:20.736668 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:31:20.737381 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:20.754228 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:31:20.754760 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:31:20.755185 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:31:20.757570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:20.763391 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:31:20.763864 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:31:20.765169 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:20.767658 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:31:20.769215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd41f8dfc-1a4c-4230-9828-cf3ef831f33e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d8c1399a0>]}
[0m14:31:20.769956 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.73s]
[0m14:31:20.770826 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:31:20.771867 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:31:20.772431 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:31:20.773058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:31:20.773518 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:31:20.778760 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:31:20.779417 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:31:20.816247 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:31:20.816837 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260211143120810058"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:31:20.817293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:20.824742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:20.832630 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:31:20.833095 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:31:20.833821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:20.834258 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:31:20.834714 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260211143120810058'
      
      
      order by ordinal_position

  
[0m14:31:20.837160 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:20.842457 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:31:20.842936 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:31:20.845343 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:20.853221 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:31:20.853700 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:31:20.856639 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:20.858322 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:31:20.858778 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:31:20.859483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:20.878105 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:31:20.878910 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:31:20.879377 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260211143120810058"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260211143120810058"
    )
  
[0m14:31:20.891445 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:20.893344 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:31:20.893801 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:31:20.894205 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:31:20.900392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:31:20.901287 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:31:20.901969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd41f8dfc-1a4c-4230-9828-cf3ef831f33e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d58d91a30>]}
[0m14:31:20.902636 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m14:31:20.903356 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:31:20.904988 [debug] [MainThread]: Using duckdb connection "master"
[0m14:31:20.905407 [debug] [MainThread]: On master: BEGIN
[0m14:31:20.905821 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:31:20.906575 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:31:20.906982 [debug] [MainThread]: On master: COMMIT
[0m14:31:20.907356 [debug] [MainThread]: Using duckdb connection "master"
[0m14:31:20.907783 [debug] [MainThread]: On master: COMMIT
[0m14:31:20.908372 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:31:20.908825 [debug] [MainThread]: On master: Close
[0m14:31:20.909290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:31:20.909678 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:31:20.910093 [info ] [MainThread]: 
[0m14:31:20.910636 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.59 seconds (10.59s).
[0m14:31:20.911673 [debug] [MainThread]: Command end result
[0m14:31:20.937409 [info ] [MainThread]: 
[0m14:31:20.938077 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:31:20.938615 [info ] [MainThread]: 
[0m14:31:20.939140 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:31:20.940142 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.75119, "process_user_time": 5.449744, "process_kernel_time": 0.258987, "process_mem_max_rss": "283424", "process_in_blocks": "1200", "process_out_blocks": "107384"}
[0m14:31:20.940724 [debug] [MainThread]: Command `dbt run` succeeded at 14:31:20.940616 after 12.75 seconds
[0m14:31:20.941168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d945c23c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d8c334aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d94667230>]}
[0m14:31:20.941616 [debug] [MainThread]: Flushing usage events
[0m14:31:22.702520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5949ed02c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f594ac5f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f594a181040>]}


============================== 14:31:22.705735 | 3e1a8832-58e8-45c3-97ea-209429710c30 ==============================
[0m14:31:22.705735 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:31:22.706428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:31:22.823777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e1a8832-58e8-45c3-97ea-209429710c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f594a8e14f0>]}
[0m14:31:22.842281 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19306046, "process_user_time": 1.369095, "process_kernel_time": 0.108928, "process_mem_max_rss": "99936", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:31:22.842882 [debug] [MainThread]: Command `dbt clean` succeeded at 14:31:22.842774 after 0.19 seconds
[0m14:31:22.843318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f594e1bb980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f594a2c0ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5949f9e030>]}
[0m14:31:22.843855 [debug] [MainThread]: Flushing usage events
[0m22:11:12.129269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3d750d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3daab530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3dd088f0>]}


============================== 22:11:12.146779 | 15375c7b-d0c3-41bb-a76f-5b956cd12353 ==============================
[0m22:11:12.146779 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:11:12.147392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:11:12.315743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15375c7b-d0c3-41bb-a76f-5b956cd12353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a41529be0>]}
[0m22:11:12.331242 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6fl1q2he'
[0m22:11:12.331725 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:11:12.459831 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:11:12.461314 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:11:12.504128 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:11:12.509307 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:11:12.595213 [info ] [MainThread]: Installed from version 1.2.0
[0m22:11:12.595785 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:11:12.596283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '15375c7b-d0c3-41bb-a76f-5b956cd12353', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3d96dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3ea74d10>]}
[0m22:11:12.596744 [info ] [MainThread]: 
[0m22:11:12.597192 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:11:12.603110 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.52306664, "process_user_time": 1.585639, "process_kernel_time": 0.16828, "process_mem_max_rss": "101304", "process_in_blocks": "8496", "process_out_blocks": "5168"}
[0m22:11:12.603658 [debug] [MainThread]: Command `dbt deps` succeeded at 22:11:12.603564 after 0.52 seconds
[0m22:11:12.604095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a41ed3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3d972570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3ea74d10>]}
[0m22:11:12.604485 [debug] [MainThread]: Flushing usage events
[0m22:11:14.168398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7d6b500b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7d9ecb4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7d65ae300>]}


============================== 22:11:14.171578 | 891b5e30-51c9-4a6e-b67e-9834ce6435ec ==============================
[0m22:11:14.171578 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:11:14.172201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:11:14.401591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '891b5e30-51c9-4a6e-b67e-9834ce6435ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7d5f69400>]}
[0m22:11:14.460997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '891b5e30-51c9-4a6e-b67e-9834ce6435ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7d620bf80>]}
[0m22:11:14.462836 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:11:14.489528 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:11:14.490240 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:11:14.490755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '891b5e30-51c9-4a6e-b67e-9834ce6435ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7d609d3d0>]}
[0m22:11:15.716727 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:11:15.717386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '891b5e30-51c9-4a6e-b67e-9834ce6435ec', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ce2018e0>]}
[0m22:11:15.953326 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:11:15.958833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '891b5e30-51c9-4a6e-b67e-9834ce6435ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ce2010a0>]}
[0m22:11:16.046595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '891b5e30-51c9-4a6e-b67e-9834ce6435ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7cea98140>]}
[0m22:11:16.047177 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:11:16.047648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '891b5e30-51c9-4a6e-b67e-9834ce6435ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ceb52d80>]}
[0m22:11:16.049670 [info ] [MainThread]: 
[0m22:11:16.050408 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:11:16.055080 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:11:16.091658 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:11:16.092134 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:11:16.092485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:16.557271 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:11:16.559315 [debug] [ThreadPool]: On list_petro: Close
[0m22:11:16.560360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:11:16.561059 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:11:16.568868 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:11:16.569280 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:11:16.569615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:11:16.570921 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:11:16.572236 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:11:16.572603 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:11:16.573209 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:11:16.573563 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:11:16.573929 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:11:16.574508 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:11:16.575423 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:11:16.575815 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:11:16.576139 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:11:16.576679 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:11:16.577085 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:11:16.578266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:11:16.584034 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:11:16.584430 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:11:16.584783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:11:16.585435 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:11:16.585826 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:11:16.586160 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:11:16.595883 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:11:16.597295 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:11:16.598465 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:11:16.598855 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:11:16.599878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '891b5e30-51c9-4a6e-b67e-9834ce6435ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7d73f46e0>]}
[0m22:11:16.600369 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:16.600759 [debug] [MainThread]: On master: BEGIN
[0m22:11:16.601105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:11:16.601849 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:16.602225 [debug] [MainThread]: On master: COMMIT
[0m22:11:16.602552 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:16.602896 [debug] [MainThread]: On master: COMMIT
[0m22:11:16.603430 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:16.603818 [debug] [MainThread]: On master: Close
[0m22:11:16.604268 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:11:16.604727 [info ] [MainThread]: 
[0m22:11:16.624427 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:11:16.625046 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:11:16.625587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:11:16.626005 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:11:16.651350 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:11:16.652137 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:11:16.685593 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:11:16.686409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:25.832474 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:25.833033 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:11:25.833794 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:25.834215 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:25.834590 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:11:25.835591 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:25.836959 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:25.837367 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:11:25.838380 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:25.846319 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:25.846898 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:11:25.847662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:25.850590 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:25.851020 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:11:25.851740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:25.867984 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:11:25.868461 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:25.868907 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:11:25.870107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:25.875741 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:25.876187 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:11:25.877387 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:25.879914 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:11:25.881432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '891b5e30-51c9-4a6e-b67e-9834ce6435ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7d7f73800>]}
[0m22:11:25.882133 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.25s]
[0m22:11:25.882911 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:11:25.883740 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:11:25.884490 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:11:25.885113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:11:25.885520 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:11:25.890389 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:11:25.891073 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:11:25.924967 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:25.925488 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260211221125919136"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:11:25.925928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:25.933948 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:25.941465 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:25.941931 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:11:25.942571 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:25.943009 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:25.943395 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260211221125919136'
      
      
      order by ordinal_position

  
[0m22:11:25.945780 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:25.950838 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:25.951280 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:11:25.953730 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:25.961103 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:25.961542 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:11:25.964012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:25.965682 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:25.966120 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:11:25.966816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:25.984491 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:11:25.985287 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:25.985736 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260211221125919136"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260211221125919136"
    )
  
[0m22:11:25.998139 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:25.999934 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:11:26.000345 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:26.000728 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:11:26.006242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:26.007110 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:11:26.007762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '891b5e30-51c9-4a6e-b67e-9834ce6435ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff786dc7a40>]}
[0m22:11:26.008400 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m22:11:26.009077 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:11:26.010904 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:26.011307 [debug] [MainThread]: On master: BEGIN
[0m22:11:26.011643 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:11:26.012382 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:26.012810 [debug] [MainThread]: On master: COMMIT
[0m22:11:26.013154 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:26.013469 [debug] [MainThread]: On master: COMMIT
[0m22:11:26.014100 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:26.014495 [debug] [MainThread]: On master: Close
[0m22:11:26.014967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:26.015297 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:11:26.015651 [info ] [MainThread]: 
[0m22:11:26.016113 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.97 seconds (9.97s).
[0m22:11:26.016962 [debug] [MainThread]: Command end result
[0m22:11:26.042879 [info ] [MainThread]: 
[0m22:11:26.043542 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:11:26.044058 [info ] [MainThread]: 
[0m22:11:26.044554 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:11:26.045549 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.927917, "process_user_time": 5.09095, "process_kernel_time": 0.325124, "process_mem_max_rss": "297212", "process_in_blocks": "1200", "process_out_blocks": "107424"}
[0m22:11:26.046128 [debug] [MainThread]: Command `dbt run` succeeded at 22:11:26.046033 after 11.93 seconds
[0m22:11:26.046539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7d61d98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bc761190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7d668fe30>]}
[0m22:11:26.046957 [debug] [MainThread]: Flushing usage events
[0m22:11:27.845936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa11c7754c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa11ca47770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa11d5b0e00>]}


============================== 22:11:27.849109 | e9cecb73-3820-4bfc-93a6-5d0871d5403b ==============================
[0m22:11:27.849109 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:11:27.849742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:11:27.961528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9cecb73-3820-4bfc-93a6-5d0871d5403b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa11c1ef3b0>]}
[0m22:11:27.979737 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18492444, "process_user_time": 1.32759, "process_kernel_time": 0.099969, "process_mem_max_rss": "99868", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:11:27.980270 [debug] [MainThread]: Command `dbt clean` succeeded at 22:11:27.980177 after 0.19 seconds
[0m22:11:27.980665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa11ca47770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa11c1ef3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa120ad3980>]}
[0m22:11:27.981104 [debug] [MainThread]: Flushing usage events
[0m06:29:06.406342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a33212de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a33615fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a33212e40>]}


============================== 06:29:06.422573 | 9bf24dd6-2829-4fee-8e97-27dfc65ed92a ==============================
[0m06:29:06.422573 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:29:06.423288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:29:06.575978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bf24dd6-2829-4fee-8e97-27dfc65ed92a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a33aaaf90>]}
[0m06:29:06.591487 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-57xs9bhm'
[0m06:29:06.591950 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:29:06.742659 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:29:06.744116 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:29:06.789451 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:29:06.794800 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:29:06.887731 [info ] [MainThread]: Installed from version 1.2.0
[0m06:29:06.888343 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:29:06.888900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9bf24dd6-2829-4fee-8e97-27dfc65ed92a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a33088e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a32fb8080>]}
[0m06:29:06.889375 [info ] [MainThread]: 
[0m06:29:06.889854 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:29:06.895541 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5411466, "process_user_time": 1.634901, "process_kernel_time": 0.133154, "process_mem_max_rss": "101360", "process_in_blocks": "8496", "process_out_blocks": "5168"}
[0m06:29:06.896122 [debug] [MainThread]: Command `dbt deps` succeeded at 06:29:06.895988 after 0.54 seconds
[0m06:29:06.896564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a3325ec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a32fb8080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a34df2960>]}
[0m06:29:06.896979 [debug] [MainThread]: Flushing usage events
[0m06:29:08.512650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf3fae4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf36d0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf36d2e70>]}


============================== 06:29:08.515722 | 6d8892fa-0240-4ce7-8ebe-591ab41efaa5 ==============================
[0m06:29:08.515722 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:29:08.516407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:29:08.747798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d8892fa-0240-4ce7-8ebe-591ab41efaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaeb7d9fd0>]}
[0m06:29:08.809038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d8892fa-0240-4ce7-8ebe-591ab41efaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaeb780830>]}
[0m06:29:08.810707 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:29:08.834996 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:29:08.835722 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:29:08.836262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d8892fa-0240-4ce7-8ebe-591ab41efaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaeb81c7d0>]}
[0m06:29:10.219887 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:29:10.220591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6d8892fa-0240-4ce7-8ebe-591ab41efaa5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaeaee09e0>]}
[0m06:29:10.462673 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:29:10.467976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d8892fa-0240-4ce7-8ebe-591ab41efaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaeaee10a0>]}
[0m06:29:10.558151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d8892fa-0240-4ce7-8ebe-591ab41efaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaeafab7d0>]}
[0m06:29:10.558680 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:29:10.559193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d8892fa-0240-4ce7-8ebe-591ab41efaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf4a8ba70>]}
[0m06:29:10.561288 [info ] [MainThread]: 
[0m06:29:10.561974 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:29:10.566814 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:29:10.602724 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:29:10.603185 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:29:10.603575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:29:11.043703 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:11.045876 [debug] [ThreadPool]: On list_petro: Close
[0m06:29:11.047077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:29:11.047867 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:29:11.055938 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:11.056404 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:29:11.056787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:11.058129 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:11.059482 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:11.059878 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:29:11.060560 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:11.060956 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:11.061354 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:29:11.062012 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:11.062958 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:29:11.063369 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:11.063737 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:29:11.064344 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:11.064742 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:29:11.066056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:29:11.072125 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:29:11.072531 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:29:11.072891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:11.073822 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:11.074240 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:29:11.074617 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:29:11.084849 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:11.086246 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:29:11.087439 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:29:11.087841 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:29:11.088965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d8892fa-0240-4ce7-8ebe-591ab41efaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf4b865d0>]}
[0m06:29:11.089504 [debug] [MainThread]: Using duckdb connection "master"
[0m06:29:11.089891 [debug] [MainThread]: On master: BEGIN
[0m06:29:11.090278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:29:11.090908 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:29:11.091327 [debug] [MainThread]: On master: COMMIT
[0m06:29:11.091698 [debug] [MainThread]: Using duckdb connection "master"
[0m06:29:11.092096 [debug] [MainThread]: On master: COMMIT
[0m06:29:11.092682 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:29:11.093109 [debug] [MainThread]: On master: Close
[0m06:29:11.093594 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:29:11.094069 [info ] [MainThread]: 
[0m06:29:11.112665 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:29:11.113267 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:29:11.113838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:29:11.114291 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:29:11.141063 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:29:11.141803 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:29:11.176984 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:29:11.177735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:19.494118 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:19.494678 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:29:19.495364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:19.495814 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:19.496270 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:29:19.497203 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:19.498561 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:19.499009 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:29:19.500279 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:19.508047 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:19.508512 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:29:19.509278 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:19.512336 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:19.512777 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:29:19.513505 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:19.530038 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:29:19.530499 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:19.530915 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:29:19.532124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:19.537690 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:19.538172 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:29:19.539402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:19.541781 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:29:19.543308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8892fa-0240-4ce7-8ebe-591ab41efaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaeaf3d520>]}
[0m06:29:19.543990 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.43s]
[0m06:29:19.544849 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:29:19.545847 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:29:19.546429 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:29:19.547054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:29:19.547494 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:29:19.552438 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:29:19.553106 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:29:19.588619 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:19.589131 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260212062919582692"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:29:19.589587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:19.596602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:19.604344 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:19.604793 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:29:19.605495 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:19.605926 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:19.606385 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260212062919582692'
      
      
      order by ordinal_position

  
[0m06:29:19.608804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:19.613889 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:19.614377 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:29:19.616677 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:19.624284 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:19.624740 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:29:19.627369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:19.629040 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:19.629485 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:29:19.630199 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:19.648225 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:29:19.648909 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:19.649381 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260212062919582692"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260212062919582692"
    )
  
[0m06:29:19.660374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:19.662297 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:29:19.662741 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:19.663171 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:29:19.669702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:19.670588 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:29:19.671269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8892fa-0240-4ce7-8ebe-591ab41efaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa37e7530>]}
[0m06:29:19.671923 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m06:29:19.672663 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:29:19.674091 [debug] [MainThread]: Using duckdb connection "master"
[0m06:29:19.674500 [debug] [MainThread]: On master: BEGIN
[0m06:29:19.674871 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:29:19.675592 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:29:19.675987 [debug] [MainThread]: On master: COMMIT
[0m06:29:19.676398 [debug] [MainThread]: Using duckdb connection "master"
[0m06:29:19.676762 [debug] [MainThread]: On master: COMMIT
[0m06:29:19.677388 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:29:19.677780 [debug] [MainThread]: On master: Close
[0m06:29:19.678287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:29:19.678658 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:29:19.679066 [info ] [MainThread]: 
[0m06:29:19.679561 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.12 seconds (9.12s).
[0m06:29:19.680550 [debug] [MainThread]: Command end result
[0m06:29:19.705755 [info ] [MainThread]: 
[0m06:29:19.706375 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:29:19.706896 [info ] [MainThread]: 
[0m06:29:19.707453 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:29:19.708446 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.248464, "process_user_time": 5.344572, "process_kernel_time": 0.271774, "process_mem_max_rss": "305208", "process_in_blocks": "1200", "process_out_blocks": "107400"}
[0m06:29:19.708978 [debug] [MainThread]: Command `dbt run` succeeded at 06:29:19.708876 after 11.25 seconds
[0m06:29:19.709432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf2f5de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead8130ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf33d7770>]}
[0m06:29:19.709851 [debug] [MainThread]: Flushing usage events
[0m06:29:21.399499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3751bfb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3728bd5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3736dedb0>]}


============================== 06:29:21.402639 | e96857d0-f591-4096-a106-e54f2c62972c ==============================
[0m06:29:21.402639 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:29:21.403355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:29:21.520393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e96857d0-f591-4096-a106-e54f2c62972c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3725e74a0>]}
[0m06:29:21.538962 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19400483, "process_user_time": 1.350952, "process_kernel_time": 0.104996, "process_mem_max_rss": "99352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:29:21.539549 [debug] [MainThread]: Command `dbt clean` succeeded at 06:29:21.539443 after 0.19 seconds
[0m06:29:21.539980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb376b63980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3723c2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3723c2b40>]}
[0m06:29:21.540441 [debug] [MainThread]: Flushing usage events
[0m14:27:25.921906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d55cc7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d55b1d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d559e2180>]}


============================== 14:27:25.943634 | 3c98e0a3-d2b4-4a03-a6cc-922cebe949dc ==============================
[0m14:27:25.943634 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:27:25.944280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:26.110289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c98e0a3-d2b4-4a03-a6cc-922cebe949dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d55c2bd70>]}
[0m14:27:26.125894 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-e4_nvi12'
[0m14:27:26.126423 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:27:26.289898 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:27:26.291443 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:27:26.334697 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:27:26.340237 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:27:26.441708 [info ] [MainThread]: Installed from version 1.2.0
[0m14:27:26.442220 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:27:26.442770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3c98e0a3-d2b4-4a03-a6cc-922cebe949dc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d555ada90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d56811f40>]}
[0m14:27:26.443244 [info ] [MainThread]: 
[0m14:27:26.443746 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:27:26.451511 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.58165497, "process_user_time": 1.635184, "process_kernel_time": 0.159627, "process_mem_max_rss": "101616", "process_in_blocks": "8504", "process_out_blocks": "5168"}
[0m14:27:26.452062 [debug] [MainThread]: Command `dbt deps` succeeded at 14:27:26.451961 after 0.58 seconds
[0m14:27:26.452530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d55efd070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d555ada60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d555a5e20>]}
[0m14:27:26.452968 [debug] [MainThread]: Flushing usage events
[0m14:27:28.060146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60c612630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60fb5f3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60f04c800>]}


============================== 14:27:28.063330 | 638b5c1a-c922-4e35-97f0-37bfca03df30 ==============================
[0m14:27:28.063330 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:27:28.064018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:28.298618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '638b5c1a-c922-4e35-97f0-37bfca03df30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60c4a9280>]}
[0m14:27:28.360556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '638b5c1a-c922-4e35-97f0-37bfca03df30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60c425310>]}
[0m14:27:28.362265 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:27:28.387657 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:27:28.388387 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:27:28.388917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '638b5c1a-c922-4e35-97f0-37bfca03df30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60c4256a0>]}
[0m14:27:29.779641 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:27:29.780357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '638b5c1a-c922-4e35-97f0-37bfca03df30', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60c4722a0>]}
[0m14:27:30.025066 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:27:30.030427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '638b5c1a-c922-4e35-97f0-37bfca03df30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60462d250>]}
[0m14:27:30.124066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '638b5c1a-c922-4e35-97f0-37bfca03df30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe604ec2870>]}
[0m14:27:30.124720 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:27:30.125235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '638b5c1a-c922-4e35-97f0-37bfca03df30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe604fe7080>]}
[0m14:27:30.127281 [info ] [MainThread]: 
[0m14:27:30.128060 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:27:30.132931 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:27:30.169392 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:27:30.169857 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:27:30.170250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:30.830521 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:27:30.832468 [debug] [ThreadPool]: On list_petro: Close
[0m14:27:30.833494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:27:30.834180 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:27:30.842628 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:27:30.843049 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:27:30.843472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:30.844684 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:30.845993 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:27:30.846409 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:27:30.847012 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:30.847423 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:27:30.847784 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:27:30.848434 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:30.849357 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:27:30.849749 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:27:30.850109 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:27:30.850684 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:30.851076 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:27:30.852283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:27:30.858228 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:27:30.858667 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:27:30.859027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:30.859710 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:30.860096 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:27:30.860521 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:27:30.870939 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:30.872280 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:27:30.873525 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:27:30.873922 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:27:30.875059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '638b5c1a-c922-4e35-97f0-37bfca03df30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60c44ef30>]}
[0m14:27:30.875701 [debug] [MainThread]: Using duckdb connection "master"
[0m14:27:30.876144 [debug] [MainThread]: On master: BEGIN
[0m14:27:30.876577 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:30.877218 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:27:30.877640 [debug] [MainThread]: On master: COMMIT
[0m14:27:30.878017 [debug] [MainThread]: Using duckdb connection "master"
[0m14:27:30.878404 [debug] [MainThread]: On master: COMMIT
[0m14:27:30.878985 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:27:30.879404 [debug] [MainThread]: On master: Close
[0m14:27:30.879890 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:27:30.880364 [info ] [MainThread]: 
[0m14:27:30.890141 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:27:30.890740 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:27:30.891301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:27:30.891760 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:27:30.918186 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:27:30.918937 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:27:30.953816 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:27:30.954558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:39.039025 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:27:39.039582 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:27:39.040231 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:39.040688 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:27:39.041100 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:27:39.042286 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:39.043688 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:27:39.044133 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:27:39.045427 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:39.053238 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:27:39.053709 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:27:39.054520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:39.057432 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:27:39.057868 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:27:39.058654 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:39.075193 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:27:39.075672 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:27:39.076088 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:27:39.078178 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:39.083792 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:27:39.084241 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:27:39.085408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:39.087755 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:27:39.089259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638b5c1a-c922-4e35-97f0-37bfca03df30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6043d6690>]}
[0m14:27:39.089949 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.20s]
[0m14:27:39.090718 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:27:39.091533 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:27:39.092187 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:27:39.092924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:27:39.093387 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:27:39.098261 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:27:39.098914 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:27:39.134750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:27:39.135239 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260212142739128758"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:27:39.135718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:39.142560 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:39.149837 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:27:39.150284 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:27:39.150945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:39.151389 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:27:39.151813 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260212142739128758'
      
      
      order by ordinal_position

  
[0m14:27:39.154112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:39.159165 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:27:39.159640 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:27:39.162000 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:39.169555 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:27:39.170009 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:27:39.172877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:39.174543 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:27:39.174985 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:27:39.175765 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:39.193874 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:27:39.194560 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:27:39.195008 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260212142739128758"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260212142739128758"
    )
  
[0m14:27:39.205923 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:39.207691 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:27:39.208123 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:27:39.208579 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:27:39.215620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:27:39.216503 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:27:39.217152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638b5c1a-c922-4e35-97f0-37bfca03df30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe604ec2540>]}
[0m14:27:39.217830 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m14:27:39.218561 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:27:39.220267 [debug] [MainThread]: Using duckdb connection "master"
[0m14:27:39.220739 [debug] [MainThread]: On master: BEGIN
[0m14:27:39.221131 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:39.221859 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:27:39.222262 [debug] [MainThread]: On master: COMMIT
[0m14:27:39.222686 [debug] [MainThread]: Using duckdb connection "master"
[0m14:27:39.223055 [debug] [MainThread]: On master: COMMIT
[0m14:27:39.223659 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:27:39.224049 [debug] [MainThread]: On master: Close
[0m14:27:39.224570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:39.224936 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:27:39.225366 [info ] [MainThread]: 
[0m14:27:39.225830 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.10 seconds (9.10s).
[0m14:27:39.226731 [debug] [MainThread]: Command end result
[0m14:27:39.252512 [info ] [MainThread]: 
[0m14:27:39.253108 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:39.253589 [info ] [MainThread]: 
[0m14:27:39.254075 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:27:39.255088 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.247944, "process_user_time": 5.373455, "process_kernel_time": 0.298748, "process_mem_max_rss": "302164", "process_in_blocks": "1200", "process_out_blocks": "107400"}
[0m14:27:39.255677 [debug] [MainThread]: Command `dbt run` succeeded at 14:27:39.255571 after 11.25 seconds
[0m14:27:39.256115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60c849220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60c4a94f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60cb774d0>]}
[0m14:27:39.256572 [debug] [MainThread]: Flushing usage events
[0m14:27:41.021870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da0cb3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da17abc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da35a5d00>]}


============================== 14:27:41.024968 | 4cddd08e-7627-4bc4-aac6-d51467f8afb8 ==============================
[0m14:27:41.024968 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:27:41.025645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:41.146110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cddd08e-7627-4bc4-aac6-d51467f8afb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da0bfd610>]}
[0m14:27:41.164384 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19457361, "process_user_time": 1.349204, "process_kernel_time": 0.103015, "process_mem_max_rss": "99792", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:27:41.164935 [debug] [MainThread]: Command `dbt clean` succeeded at 14:27:41.164831 after 0.20 seconds
[0m14:27:41.165412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da4fbb980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da2b60080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da16dc0b0>]}
[0m14:27:41.165842 [debug] [MainThread]: Flushing usage events
[0m22:10:32.320715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb56e86ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb56ecda5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb56e86eb70>]}


============================== 22:10:32.336825 | 2eae9e8b-d53a-4f1d-89fe-7ca537bbc989 ==============================
[0m22:10:32.336825 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:32.337465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:10:32.472892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2eae9e8b-d53a-4f1d-89fe-7ca537bbc989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb56f818e90>]}
[0m22:10:32.488525 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jta6ip8u'
[0m22:10:32.489022 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:10:32.544052 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:10:32.545224 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:10:32.579836 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:10:32.584844 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:10:33.057118 [info ] [MainThread]: Installed from version 1.2.0
[0m22:10:33.057744 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:10:33.058332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2eae9e8b-d53a-4f1d-89fe-7ca537bbc989', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb56ec44320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb56e6d1b20>]}
[0m22:10:33.058820 [info ] [MainThread]: 
[0m22:10:33.059340 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:10:33.070203 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.80129737, "process_user_time": 1.647958, "process_kernel_time": 0.148718, "process_mem_max_rss": "101268", "process_in_blocks": "8488", "process_out_blocks": "5176"}
[0m22:10:33.070787 [debug] [MainThread]: Command `dbt deps` succeeded at 22:10:33.070673 after 0.80 seconds
[0m22:10:33.071208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb56e637740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb56e67b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb56f875e20>]}
[0m22:10:33.071644 [debug] [MainThread]: Flushing usage events
[0m22:10:34.858760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61557b8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61550646b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6155eb65a0>]}


============================== 22:10:34.861777 | 3c824f45-1141-4a9a-b8d8-792e885a52b1 ==============================
[0m22:10:34.861777 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:34.862503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:10:35.089779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c824f45-1141-4a9a-b8d8-792e885a52b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6154d72ba0>]}
[0m22:10:35.150213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c824f45-1141-4a9a-b8d8-792e885a52b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6155e87230>]}
[0m22:10:35.151810 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:10:35.171662 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:10:35.172357 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:10:35.172898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3c824f45-1141-4a9a-b8d8-792e885a52b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6154b79430>]}
[0m22:10:36.546060 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:10:36.546714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3c824f45-1141-4a9a-b8d8-792e885a52b1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f614ccaffb0>]}
[0m22:10:36.781978 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:10:36.787364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c824f45-1141-4a9a-b8d8-792e885a52b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f614cda36e0>]}
[0m22:10:36.882096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c824f45-1141-4a9a-b8d8-792e885a52b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f614cdf57c0>]}
[0m22:10:36.882672 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:10:36.883175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c824f45-1141-4a9a-b8d8-792e885a52b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f614d4c4890>]}
[0m22:10:36.885211 [info ] [MainThread]: 
[0m22:10:36.885968 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:10:36.890865 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:10:36.928465 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:10:36.928935 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:10:36.929329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:37.347533 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:37.349161 [debug] [ThreadPool]: On list_petro: Close
[0m22:10:37.350038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:10:37.350616 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:10:37.358080 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:10:37.358501 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:10:37.358912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:37.359881 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:37.361199 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:10:37.361609 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:10:37.362379 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:37.362791 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:10:37.363149 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:10:37.363763 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:37.364673 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:10:37.365067 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:10:37.365429 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:10:37.366031 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:37.366425 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:10:37.367643 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:10:37.373316 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:10:37.373738 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:10:37.374098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:37.374749 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:37.375134 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:10:37.375505 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:10:37.386213 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:37.387530 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:10:37.388747 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:10:37.389141 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:10:37.390123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c824f45-1141-4a9a-b8d8-792e885a52b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f614cc39bb0>]}
[0m22:10:37.390671 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:37.391058 [debug] [MainThread]: On master: BEGIN
[0m22:10:37.391418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:37.392093 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:37.392478 [debug] [MainThread]: On master: COMMIT
[0m22:10:37.392899 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:37.393260 [debug] [MainThread]: On master: COMMIT
[0m22:10:37.393860 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:37.394245 [debug] [MainThread]: On master: Close
[0m22:10:37.394755 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:10:37.395248 [info ] [MainThread]: 
[0m22:10:37.417176 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:10:37.417800 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:10:37.418464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:10:37.418924 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:10:37.446227 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:10:37.447016 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:10:37.481913 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:10:37.482677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:47.428050 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:47.428633 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:47.429375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:47.429847 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:47.430284 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:10:47.431304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:47.432716 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:47.433157 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:10:47.434170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:47.441005 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:47.441466 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:47.442232 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:47.445245 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:47.445706 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:47.446410 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:47.463144 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:47.463624 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:47.464039 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:47.465271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:47.471066 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:47.471514 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:10:47.472709 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:47.475064 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:47.476592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c824f45-1141-4a9a-b8d8-792e885a52b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610a6b9730>]}
[0m22:10:47.477268 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.06s]
[0m22:10:47.478057 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:47.479098 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:47.479697 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:47.480398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:47.480868 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:47.485868 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:47.486520 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:47.522526 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:47.523029 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260212221047516603"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:47.523472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:47.530370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:47.537818 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:47.538264 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:47.538908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:47.539335 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:47.539785 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260212221047516603'
      
      
      order by ordinal_position

  
[0m22:10:47.542274 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:47.547358 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:47.547832 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:47.550196 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:47.558948 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:47.559409 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:47.562183 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:47.563865 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:47.564322 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:10:47.565076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:47.582040 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:47.582745 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:47.583202 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260212221047516603"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260212221047516603"
    )
  
[0m22:10:47.593468 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:47.595308 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:47.595770 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:47.596172 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:47.601688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:47.602573 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:47.603229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c824f45-1141-4a9a-b8d8-792e885a52b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6109696300>]}
[0m22:10:47.603915 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m22:10:47.604777 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:47.606819 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:47.607246 [debug] [MainThread]: On master: BEGIN
[0m22:10:47.607669 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:47.608334 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:47.608761 [debug] [MainThread]: On master: COMMIT
[0m22:10:47.609130 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:47.609488 [debug] [MainThread]: On master: COMMIT
[0m22:10:47.610110 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:47.610502 [debug] [MainThread]: On master: Close
[0m22:10:47.611006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:47.611366 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:47.611804 [info ] [MainThread]: 
[0m22:10:47.612264 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.73 seconds (10.73s).
[0m22:10:47.613187 [debug] [MainThread]: Command end result
[0m22:10:47.638869 [info ] [MainThread]: 
[0m22:10:47.639411 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:47.639897 [info ] [MainThread]: 
[0m22:10:47.640359 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:47.641287 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.834288, "process_user_time": 5.323727, "process_kernel_time": 0.263134, "process_mem_max_rss": "278692", "process_in_blocks": "1200", "process_out_blocks": "107440"}
[0m22:10:47.641847 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:47.641745 after 12.83 seconds
[0m22:10:47.642276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61550f41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6144055d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f614d4b7bc0>]}
[0m22:10:47.642723 [debug] [MainThread]: Flushing usage events
[0m22:10:49.581510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc951849be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc950efcd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc950fba3c0>]}


============================== 22:10:49.584578 | f42d70f4-e191-4ddf-995d-665e9bb0b5af ==============================
[0m22:10:49.584578 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:49.585227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:10:49.698548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f42d70f4-e191-4ddf-995d-665e9bb0b5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95103bc80>]}
[0m22:10:49.716291 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18715917, "process_user_time": 1.362164, "process_kernel_time": 0.091876, "process_mem_max_rss": "100024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:10:49.716862 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:49.716757 after 0.19 seconds
[0m22:10:49.717281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc950f22f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9509f2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc950ada180>]}
[0m22:10:49.717722 [debug] [MainThread]: Flushing usage events
[0m06:26:18.831744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f692722b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6923e12b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6923e12bd0>]}


============================== 06:26:18.851739 | 8b2fe9d1-8cd3-4079-9b7b-70d69a083c05 ==============================
[0m06:26:18.851739 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:26:18.852486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:26:18.991026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b2fe9d1-8cd3-4079-9b7b-70d69a083c05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6923c1f350>]}
[0m06:26:19.006170 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3bfczxyb'
[0m06:26:19.006626 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:26:19.136901 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:26:19.138462 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:26:19.179002 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:26:19.184240 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:26:19.254718 [info ] [MainThread]: Installed from version 1.2.0
[0m06:26:19.255289 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:26:19.255827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8b2fe9d1-8cd3-4079-9b7b-70d69a083c05', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6923bdecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6923b776e0>]}
[0m06:26:19.256315 [info ] [MainThread]: 
[0m06:26:19.256811 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:26:19.270734 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49080938, "process_user_time": 1.653417, "process_kernel_time": 0.161235, "process_mem_max_rss": "101516", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m06:26:19.271310 [debug] [MainThread]: Command `dbt deps` succeeded at 06:26:19.271200 after 0.49 seconds
[0m06:26:19.271742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6923b46240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69283bb980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f692447cce0>]}
[0m06:26:19.272188 [debug] [MainThread]: Flushing usage events
[0m06:26:20.821758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed92a92c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed938c39e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed92a93020>]}


============================== 06:26:20.824852 | 73e1aec6-5254-4f4e-ac2e-cddb26912f42 ==============================
[0m06:26:20.824852 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:26:20.825514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:26:21.054850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73e1aec6-5254-4f4e-ac2e-cddb26912f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed92a01970>]}
[0m06:26:21.116364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73e1aec6-5254-4f4e-ac2e-cddb26912f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed92a67a40>]}
[0m06:26:21.118048 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:26:21.139044 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:26:21.139784 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:26:21.140339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '73e1aec6-5254-4f4e-ac2e-cddb26912f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8b5d7110>]}
[0m06:26:22.542474 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:26:22.543137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '73e1aec6-5254-4f4e-ac2e-cddb26912f42', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed92b3da60>]}
[0m06:26:22.778794 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:26:22.784045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73e1aec6-5254-4f4e-ac2e-cddb26912f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8ab75340>]}
[0m06:26:22.912062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73e1aec6-5254-4f4e-ac2e-cddb26912f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8ad7dcd0>]}
[0m06:26:22.912598 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:26:22.913079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73e1aec6-5254-4f4e-ac2e-cddb26912f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8ad9cc50>]}
[0m06:26:22.915083 [info ] [MainThread]: 
[0m06:26:22.915790 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:26:22.920589 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:26:22.958467 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:26:22.958910 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:26:22.959328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:26:23.536619 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:26:23.538799 [debug] [ThreadPool]: On list_petro: Close
[0m06:26:23.539888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:26:23.540513 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:26:23.547934 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:26:23.548430 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:26:23.549044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:26:23.550322 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:26:23.551700 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:26:23.552116 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:26:23.552754 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:26:23.553178 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:26:23.553555 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:26:23.554198 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:26:23.555152 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:26:23.555550 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:26:23.555920 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:26:23.556586 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:26:23.556996 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:26:23.558417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:26:23.564753 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:26:23.565191 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:26:23.565559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:26:23.566298 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:26:23.566690 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:26:23.567066 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:26:23.577507 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:26:23.578920 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:26:23.580208 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:26:23.580613 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:26:23.581673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73e1aec6-5254-4f4e-ac2e-cddb26912f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed949c25a0>]}
[0m06:26:23.582218 [debug] [MainThread]: Using duckdb connection "master"
[0m06:26:23.582614 [debug] [MainThread]: On master: BEGIN
[0m06:26:23.582983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:26:23.583868 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:26:23.584304 [debug] [MainThread]: On master: COMMIT
[0m06:26:23.584683 [debug] [MainThread]: Using duckdb connection "master"
[0m06:26:23.585046 [debug] [MainThread]: On master: COMMIT
[0m06:26:23.585661 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:26:23.586052 [debug] [MainThread]: On master: Close
[0m06:26:23.586613 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:26:23.587127 [info ] [MainThread]: 
[0m06:26:23.627449 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:26:23.628029 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:26:23.628731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:26:23.629193 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:26:23.656219 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:26:23.657038 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:26:23.692687 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:26:23.693427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:26:32.532356 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:26:32.532907 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:26:32.533782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:26:32.534248 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:26:32.534679 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:26:32.535652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:26:32.537017 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:26:32.537492 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:26:32.538543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:26:32.545353 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:26:32.545815 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:26:32.546580 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:26:32.549535 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:26:32.549986 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:26:32.550721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:26:32.567801 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:26:32.568388 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:26:32.568817 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:26:32.571064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:26:32.577165 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:26:32.577632 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:26:32.578901 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:26:32.581412 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:26:32.582943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73e1aec6-5254-4f4e-ac2e-cddb26912f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8970c530>]}
[0m06:26:32.583668 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.95s]
[0m06:26:32.584476 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:26:32.585535 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:26:32.586087 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:26:32.586695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:26:32.587158 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:26:32.592152 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:26:32.592814 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:26:32.629763 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:26:32.630270 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260213062632623697"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:26:32.630719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:26:32.637913 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:26:32.646238 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:26:32.646825 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:26:32.647719 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:26:32.648277 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:26:32.648725 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260213062632623697'
      
      
      order by ordinal_position

  
[0m06:26:32.651287 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:26:32.656599 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:26:32.657071 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:26:32.659444 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:26:32.668514 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:26:32.668988 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:26:32.671817 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:26:32.673521 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:26:32.673982 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:26:32.674715 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:26:32.692005 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:26:32.692721 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:26:32.693201 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260213062632623697"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260213062632623697"
    )
  
[0m06:26:32.703936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:26:32.705707 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:26:32.706170 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:26:32.706588 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:26:32.713614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:26:32.714505 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:26:32.715180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73e1aec6-5254-4f4e-ac2e-cddb26912f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed5352c500>]}
[0m06:26:32.715835 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m06:26:32.716577 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:26:32.718677 [debug] [MainThread]: Using duckdb connection "master"
[0m06:26:32.719088 [debug] [MainThread]: On master: BEGIN
[0m06:26:32.719511 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:26:32.720230 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:26:32.720635 [debug] [MainThread]: On master: COMMIT
[0m06:26:32.721017 [debug] [MainThread]: Using duckdb connection "master"
[0m06:26:32.721424 [debug] [MainThread]: On master: COMMIT
[0m06:26:32.722003 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:26:32.722462 [debug] [MainThread]: On master: Close
[0m06:26:32.722929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:26:32.723324 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:26:32.723722 [info ] [MainThread]: 
[0m06:26:32.724214 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.81 seconds (9.81s).
[0m06:26:32.725118 [debug] [MainThread]: Command end result
[0m06:26:32.750635 [info ] [MainThread]: 
[0m06:26:32.751226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:26:32.751712 [info ] [MainThread]: 
[0m06:26:32.752222 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:26:32.753189 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.98389, "process_user_time": 5.389745, "process_kernel_time": 0.269987, "process_mem_max_rss": "298492", "process_in_blocks": "1200", "process_out_blocks": "107408"}
[0m06:26:32.753753 [debug] [MainThread]: Command `dbt run` succeeded at 06:26:32.753651 after 11.98 seconds
[0m06:26:32.754215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed971bb980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed92a93020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed68138350>]}
[0m06:26:32.754647 [debug] [MainThread]: Flushing usage events
[0m06:26:34.449033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7fb8e7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7fc35ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7fbb1c470>]}


============================== 06:26:34.452170 | 8cdea217-fcde-4b9d-a1d6-a899f7497dfa ==============================
[0m06:26:34.452170 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:26:34.452879 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:26:34.566338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cdea217-fcde-4b9d-a1d6-a899f7497dfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7fd758950>]}
[0m06:26:34.584465 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18873869, "process_user_time": 1.358261, "process_kernel_time": 0.099945, "process_mem_max_rss": "99628", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:26:34.585001 [debug] [MainThread]: Command `dbt clean` succeeded at 06:26:34.584900 after 0.19 seconds
[0m06:26:34.585486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7fffbb980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7fd758950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7fc45bfb0>]}
[0m06:26:34.585903 [debug] [MainThread]: Flushing usage events
[0m14:22:29.211719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38f7771d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38fa04dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38f7738890>]}


============================== 14:22:29.230238 | 9b5b1a60-c698-4a6a-aad4-a62b201c7252 ==============================
[0m14:22:29.230238 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:22:29.231023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:22:29.371551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b5b1a60-c698-4a6a-aad4-a62b201c7252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38f7735df0>]}
[0m14:22:29.388017 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0gfa06n0'
[0m14:22:29.388584 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:22:29.481582 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:22:29.483372 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:22:29.521707 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:22:29.527711 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:22:29.714689 [info ] [MainThread]: Installed from version 1.2.0
[0m14:22:29.715338 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:22:29.715891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9b5b1a60-c698-4a6a-aad4-a62b201c7252', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38f7547740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38f75447a0>]}
[0m14:22:29.716392 [info ] [MainThread]: 
[0m14:22:29.716890 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:22:29.727617 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5687299, "process_user_time": 1.759444, "process_kernel_time": 0.13967, "process_mem_max_rss": "101404", "process_in_blocks": "8488", "process_out_blocks": "5176"}
[0m14:22:29.728284 [debug] [MainThread]: Command `dbt deps` succeeded at 14:22:29.728173 after 0.57 seconds
[0m14:22:29.728733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38f773a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38f759c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38f759f7d0>]}
[0m14:22:29.729191 [debug] [MainThread]: Flushing usage events
[0m14:22:31.503711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56027fa8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5602abd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5603349fd0>]}


============================== 14:22:31.506971 | 8dda1f83-1f96-402e-bfbe-930c180aa8ad ==============================
[0m14:22:31.506971 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:22:31.507721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:22:31.743316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dda1f83-1f96-402e-bfbe-930c180aa8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56039ed850>]}
[0m14:22:31.805893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8dda1f83-1f96-402e-bfbe-930c180aa8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56043317c0>]}
[0m14:22:31.807822 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:22:31.829430 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:22:31.830238 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:22:31.830757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8dda1f83-1f96-402e-bfbe-930c180aa8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56027fa8a0>]}
[0m14:22:33.231021 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:22:33.231740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8dda1f83-1f96-402e-bfbe-930c180aa8ad', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55fa716450>]}
[0m14:22:33.495945 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:22:33.501664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dda1f83-1f96-402e-bfbe-930c180aa8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55fa716fc0>]}
[0m14:22:33.602562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dda1f83-1f96-402e-bfbe-930c180aa8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55fa98d310>]}
[0m14:22:33.603178 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:22:33.603691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dda1f83-1f96-402e-bfbe-930c180aa8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5602abd4f0>]}
[0m14:22:33.605775 [info ] [MainThread]: 
[0m14:22:33.606562 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:22:33.611402 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:22:33.650159 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:22:33.650683 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:22:33.651074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:34.071601 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:34.073269 [debug] [ThreadPool]: On list_petro: Close
[0m14:22:34.074086 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:22:34.074670 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:22:34.082013 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:22:34.082463 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:22:34.082837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:34.084196 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:34.085565 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:22:34.085956 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:22:34.086591 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:34.086970 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:22:34.087371 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:22:34.087985 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:34.088926 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:22:34.089352 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:22:34.089714 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:22:34.090326 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:34.090724 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:22:34.092039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:22:34.098579 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:22:34.099080 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:22:34.099479 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:34.100419 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:34.100816 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:22:34.101246 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:22:34.111889 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:34.113589 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:22:34.114865 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:22:34.115331 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:22:34.116534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dda1f83-1f96-402e-bfbe-930c180aa8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f560445d880>]}
[0m14:22:34.117112 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:34.117539 [debug] [MainThread]: On master: BEGIN
[0m14:22:34.117910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:22:34.118778 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:22:34.119205 [debug] [MainThread]: On master: COMMIT
[0m14:22:34.119587 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:34.119955 [debug] [MainThread]: On master: COMMIT
[0m14:22:34.120627 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:22:34.121033 [debug] [MainThread]: On master: Close
[0m14:22:34.121594 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:22:34.122113 [info ] [MainThread]: 
[0m14:22:34.142815 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:22:34.143543 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:22:34.144319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:22:34.144785 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:22:34.172667 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:22:34.173640 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:22:34.210155 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:22:34.211129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:42.712739 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:42.713318 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:22:42.713999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:42.714463 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:42.714875 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:22:42.715864 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:42.717262 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:42.717697 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:22:42.718730 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:42.725428 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:42.725878 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:22:42.726636 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:42.729561 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:42.730001 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:22:42.730729 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:42.747276 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:22:42.747726 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:42.748156 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:22:42.749265 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:42.755137 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:42.755649 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:22:42.757078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:42.759551 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:22:42.761059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dda1f83-1f96-402e-bfbe-930c180aa8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5604563590>]}
[0m14:22:42.761756 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.62s]
[0m14:22:42.762545 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:22:42.763581 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:22:42.764173 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:22:42.764779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:22:42.765238 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:22:42.770197 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:22:42.770850 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:22:42.806580 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:42.807090 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260213142242800629"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:22:42.807566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:42.816026 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:42.826526 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:42.827050 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:22:42.828228 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:42.828727 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:42.829478 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260213142242800629'
      
      
      order by ordinal_position

  
[0m14:22:42.832157 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:42.838005 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:42.838584 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:22:42.841083 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:42.851011 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:42.851535 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:22:42.854186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:42.856121 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:42.856572 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:22:42.857317 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:42.874378 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:22:42.875118 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:42.875574 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260213142242800629"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260213142242800629"
    )
  
[0m14:22:42.887335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:42.889202 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:22:42.889644 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:42.890047 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:22:42.896334 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:42.897222 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:22:42.897894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dda1f83-1f96-402e-bfbe-930c180aa8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b33cb500>]}
[0m14:22:42.898564 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m14:22:42.899342 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:22:42.900656 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:42.901069 [debug] [MainThread]: On master: BEGIN
[0m14:22:42.901488 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:22:42.902201 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:22:42.902597 [debug] [MainThread]: On master: COMMIT
[0m14:22:42.902962 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:42.903385 [debug] [MainThread]: On master: COMMIT
[0m14:22:42.903987 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:22:42.904427 [debug] [MainThread]: On master: Close
[0m14:22:42.904886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:42.905299 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:22:42.905694 [info ] [MainThread]: 
[0m14:22:42.906215 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.30 seconds (9.30s).
[0m14:22:42.907274 [debug] [MainThread]: Command end result
[0m14:22:42.933145 [info ] [MainThread]: 
[0m14:22:42.933791 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:42.934348 [info ] [MainThread]: 
[0m14:22:42.934889 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:22:42.935999 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.486281, "process_user_time": 5.543371, "process_kernel_time": 0.287656, "process_mem_max_rss": "291960", "process_in_blocks": "1200", "process_out_blocks": "107384"}
[0m14:22:42.936613 [debug] [MainThread]: Command `dbt run` succeeded at 14:22:42.936509 after 11.49 seconds
[0m14:22:42.937048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5606dbb980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56028a5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b3529700>]}
[0m14:22:42.937521 [debug] [MainThread]: Flushing usage events
[0m14:22:44.866801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7076d56930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707a3cf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707713f920>]}


============================== 14:22:44.869875 | 3efe5f2a-b625-409b-bfbf-d569bae74347 ==============================
[0m14:22:44.869875 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:22:44.870613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:22:44.983205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3efe5f2a-b625-409b-bfbf-d569bae74347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707652aba0>]}
[0m14:22:45.001582 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18690847, "process_user_time": 1.384073, "process_kernel_time": 0.11892, "process_mem_max_rss": "99684", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:22:45.002215 [debug] [MainThread]: Command `dbt clean` succeeded at 14:22:45.002051 after 0.19 seconds
[0m14:22:45.002661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707670d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707659a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70769fecc0>]}
[0m14:22:45.003088 [debug] [MainThread]: Flushing usage events
[0m22:11:21.120400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9c97f3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9f9475f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9cdf58e0>]}


============================== 22:11:21.138175 | 54073229-c90c-48f1-b680-e3497b30b266 ==============================
[0m22:11:21.138175 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:11:21.138879 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:11:21.274557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54073229-c90c-48f1-b680-e3497b30b266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9e1eaf00>]}
[0m22:11:21.289711 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yh21cnd7'
[0m22:11:21.290206 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:11:21.434770 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:11:21.436298 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:11:21.474089 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:11:21.479457 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:11:21.557117 [info ] [MainThread]: Installed from version 1.2.0
[0m22:11:21.557708 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:11:21.558302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '54073229-c90c-48f1-b680-e3497b30b266', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9c398e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9c398f50>]}
[0m22:11:21.558751 [info ] [MainThread]: 
[0m22:11:21.559284 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:11:21.605084 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5361334, "process_user_time": 1.64953, "process_kernel_time": 0.139213, "process_mem_max_rss": "101600", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m22:11:21.605634 [debug] [MainThread]: Command `dbt deps` succeeded at 22:11:21.605533 after 0.54 seconds
[0m22:11:21.606071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feca0ad3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9ceb2180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9c51dbe0>]}
[0m22:11:21.606490 [debug] [MainThread]: Flushing usage events
[0m22:11:23.187126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d6fb33e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d561f770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d52f9040>]}


============================== 22:11:23.190177 | 32f1aedc-ac4a-4ff0-9f85-fabd6e17effe ==============================
[0m22:11:23.190177 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:11:23.190868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:11:23.422694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32f1aedc-ac4a-4ff0-9f85-fabd6e17effe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84cd937740>]}
[0m22:11:23.484944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32f1aedc-ac4a-4ff0-9f85-fabd6e17effe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d52ac350>]}
[0m22:11:23.486718 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:11:23.506898 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:11:23.507653 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:11:23.508219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '32f1aedc-ac4a-4ff0-9f85-fabd6e17effe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d4df3920>]}
[0m22:11:24.913141 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:11:24.913776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '32f1aedc-ac4a-4ff0-9f85-fabd6e17effe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84cd06faa0>]}
[0m22:11:25.150837 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:11:25.156052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32f1aedc-ac4a-4ff0-9f85-fabd6e17effe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84cd07a570>]}
[0m22:11:25.251512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32f1aedc-ac4a-4ff0-9f85-fabd6e17effe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84cd188e00>]}
[0m22:11:25.252086 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:11:25.252590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32f1aedc-ac4a-4ff0-9f85-fabd6e17effe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84cd16a780>]}
[0m22:11:25.254582 [info ] [MainThread]: 
[0m22:11:25.255315 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:11:25.260250 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:11:25.297891 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:11:25.298396 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:11:25.298789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:25.727215 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:11:25.729914 [debug] [ThreadPool]: On list_petro: Close
[0m22:11:25.731214 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:11:25.732149 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:11:25.742478 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:11:25.742907 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:11:25.743326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:11:25.744270 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:11:25.745570 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:11:25.745964 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:11:25.746798 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:11:25.747227 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:11:25.747593 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:11:25.748267 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:11:25.749209 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:11:25.749601 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:11:25.749967 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:11:25.750577 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:11:25.750974 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:11:25.752195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:11:25.758025 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:11:25.758433 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:11:25.758798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:11:25.759499 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:11:25.759891 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:11:25.760298 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:11:25.771384 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:11:25.772732 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:11:25.773934 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:11:25.774381 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:11:25.775412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32f1aedc-ac4a-4ff0-9f85-fabd6e17effe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84cd07c6e0>]}
[0m22:11:25.775915 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:25.776328 [debug] [MainThread]: On master: BEGIN
[0m22:11:25.776692 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:11:25.777344 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:25.777737 [debug] [MainThread]: On master: COMMIT
[0m22:11:25.778162 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:25.778529 [debug] [MainThread]: On master: COMMIT
[0m22:11:25.779127 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:25.779524 [debug] [MainThread]: On master: Close
[0m22:11:25.780027 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:11:25.780535 [info ] [MainThread]: 
[0m22:11:25.798838 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:11:25.799434 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:11:25.800109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:11:25.800555 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:11:25.827246 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:11:25.828061 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:11:25.863152 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:11:25.863900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:34.154830 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:34.155403 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:11:34.156099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:34.156548 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:34.156972 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:11:34.157976 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:34.159393 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:34.159843 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:11:34.161021 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:34.167902 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:34.168392 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:11:34.169166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:34.172181 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:34.172634 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:11:34.173366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:34.190118 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:11:34.190589 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:34.191032 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:11:34.193208 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:34.199033 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:34.199503 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:11:34.200813 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:34.203296 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:11:34.204843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32f1aedc-ac4a-4ff0-9f85-fabd6e17effe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84cd8e3f80>]}
[0m22:11:34.205553 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.40s]
[0m22:11:34.206343 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:11:34.207385 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:11:34.207936 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:11:34.208559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:11:34.209038 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:11:34.214113 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:11:34.214773 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:11:34.250902 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:34.251437 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260213221134244784"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:11:34.251887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:34.259239 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:34.267189 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:34.267653 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:11:34.268426 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:34.268865 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:34.269330 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260213221134244784'
      
      
      order by ordinal_position

  
[0m22:11:34.271818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:34.277112 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:34.277579 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:11:34.279936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:34.288883 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:34.289371 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:11:34.292171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:34.293893 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:34.294370 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:11:34.295167 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:34.312412 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:11:34.313150 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:34.313612 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260213221134244784"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260213221134244784"
    )
  
[0m22:11:34.325634 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:34.327548 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:11:34.328011 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:34.328434 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:11:34.334648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:34.335565 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:11:34.336269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32f1aedc-ac4a-4ff0-9f85-fabd6e17effe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8489436300>]}
[0m22:11:34.336949 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m22:11:34.337754 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:11:34.339397 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:34.339811 [debug] [MainThread]: On master: BEGIN
[0m22:11:34.340232 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:11:34.340909 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:34.341342 [debug] [MainThread]: On master: COMMIT
[0m22:11:34.341716 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:34.342121 [debug] [MainThread]: On master: COMMIT
[0m22:11:34.342712 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:34.343151 [debug] [MainThread]: On master: Close
[0m22:11:34.343612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:34.343973 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:11:34.344400 [info ] [MainThread]: 
[0m22:11:34.344930 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.09 seconds (9.09s).
[0m22:11:34.346014 [debug] [MainThread]: Command end result
[0m22:11:34.371342 [info ] [MainThread]: 
[0m22:11:34.371959 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:11:34.372511 [info ] [MainThread]: 
[0m22:11:34.373065 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:11:34.374086 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.239104, "process_user_time": 5.366041, "process_kernel_time": 0.283107, "process_mem_max_rss": "294548", "process_in_blocks": "1200", "process_out_blocks": "107424"}
[0m22:11:34.374635 [debug] [MainThread]: Command `dbt run` succeeded at 22:11:34.374534 after 11.24 seconds
[0m22:11:34.375094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d6fb33e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d52d1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d5464110>]}
[0m22:11:34.375542 [debug] [MainThread]: Flushing usage events
[0m22:11:36.124077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0898390740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08962a57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0896be51f0>]}


============================== 22:11:36.127227 | 1ec687cc-3f74-4325-a473-d125dd745c1d ==============================
[0m22:11:36.127227 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:11:36.127895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:11:36.241965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ec687cc-3f74-4325-a473-d125dd745c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f089610b140>]}
[0m22:11:36.260871 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18907014, "process_user_time": 1.357623, "process_kernel_time": 0.101971, "process_mem_max_rss": "99668", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:11:36.261460 [debug] [MainThread]: Command `dbt clean` succeeded at 22:11:36.261355 after 0.19 seconds
[0m22:11:36.261898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0898390740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0895f665d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08960cb980>]}
[0m22:11:36.262518 [debug] [MainThread]: Flushing usage events
[0m06:18:24.588950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c7ee4f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c7fbb8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c7fbb8200>]}


============================== 06:18:24.605764 | 3a9c7010-ee36-4546-b896-a05e3d1e096f ==============================
[0m06:18:24.605764 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:18:24.606348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:18:24.746042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a9c7010-ee36-4546-b896-a05e3d1e096f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c7ecb2000>]}
[0m06:18:24.759219 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-h_6vtcsl'
[0m06:18:24.759668 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:18:25.067214 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:18:25.068917 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:18:25.173935 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:18:25.179374 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:18:25.589034 [info ] [MainThread]: Installed from version 1.2.0
[0m06:18:25.589607 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:18:25.590073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3a9c7010-ee36-4546-b896-a05e3d1e096f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c7ecc4f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c7ebdc230>]}
[0m06:18:25.590466 [info ] [MainThread]: 
[0m06:18:25.590911 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:18:25.601613 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0576851, "process_user_time": 1.484015, "process_kernel_time": 0.086233, "process_mem_max_rss": "101604", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m06:18:25.602250 [debug] [MainThread]: Command `dbt deps` succeeded at 06:18:25.602144 after 1.06 seconds
[0m06:18:25.602656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c82282fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c82f96f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c7ecb2000>]}
[0m06:18:25.603027 [debug] [MainThread]: Flushing usage events
[0m06:18:27.194916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881b9be990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881c44b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881bdf6db0>]}


============================== 06:18:27.197764 | cf349c33-4ccc-4f4f-9fd0-23fa6810b102 ==============================
[0m06:18:27.197764 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:18:27.198375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:18:27.400010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf349c33-4ccc-4f4f-9fd0-23fa6810b102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881cc7f230>]}
[0m06:18:27.453537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf349c33-4ccc-4f4f-9fd0-23fa6810b102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881bbd96a0>]}
[0m06:18:27.455129 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:18:27.474697 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:18:27.475314 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:18:27.475805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cf349c33-4ccc-4f4f-9fd0-23fa6810b102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881bb2a690>]}
[0m06:18:28.668756 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:18:28.669348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cf349c33-4ccc-4f4f-9fd0-23fa6810b102', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881b928560>]}
[0m06:18:28.873807 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:18:28.878687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf349c33-4ccc-4f4f-9fd0-23fa6810b102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881419c200>]}
[0m06:18:28.964560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf349c33-4ccc-4f4f-9fd0-23fa6810b102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88142d7800>]}
[0m06:18:28.965041 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:18:28.965518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf349c33-4ccc-4f4f-9fd0-23fa6810b102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88143dae70>]}
[0m06:18:28.967376 [info ] [MainThread]: 
[0m06:18:28.968046 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:18:28.972272 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:18:29.002656 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:18:29.003062 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:18:29.003407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:18:29.700521 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:18:29.702483 [debug] [ThreadPool]: On list_petro: Close
[0m06:18:29.703566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:18:29.704264 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:18:29.711479 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:18:29.711891 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:18:29.712217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:18:29.713156 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:18:29.714393 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:18:29.714770 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:18:29.715301 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:18:29.715654 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:18:29.715962 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:18:29.716529 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:18:29.717369 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:18:29.717721 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:18:29.718029 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:18:29.718559 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:18:29.718913 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:18:29.720080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:18:29.725373 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:18:29.725821 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:18:29.726136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:18:29.726752 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:18:29.727087 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:18:29.727408 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:18:29.738276 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:18:29.739554 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:18:29.740685 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:18:29.741050 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:18:29.742091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf349c33-4ccc-4f4f-9fd0-23fa6810b102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8814051cd0>]}
[0m06:18:29.742677 [debug] [MainThread]: Using duckdb connection "master"
[0m06:18:29.743110 [debug] [MainThread]: On master: BEGIN
[0m06:18:29.743472 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:18:29.744102 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:18:29.744478 [debug] [MainThread]: On master: COMMIT
[0m06:18:29.744842 [debug] [MainThread]: Using duckdb connection "master"
[0m06:18:29.745160 [debug] [MainThread]: On master: COMMIT
[0m06:18:29.745743 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:18:29.746098 [debug] [MainThread]: On master: Close
[0m06:18:29.746552 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:18:29.746990 [info ] [MainThread]: 
[0m06:18:29.764553 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:18:29.765085 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:18:29.765625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:18:29.766014 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:18:29.790153 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:18:29.790809 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:18:29.822200 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:18:29.822847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:42.114294 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:18:42.114818 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:18:42.115477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:18:42.115910 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:18:42.116267 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:18:42.117231 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:18:42.118582 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:18:42.119001 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:18:42.119995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:18:42.126357 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:18:42.126804 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:18:42.127611 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:18:42.130424 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:18:42.130848 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:18:42.131546 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:18:42.146606 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:18:42.147036 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:18:42.147397 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:18:42.149765 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:18:42.154956 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:18:42.155380 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:18:42.156556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:18:42.158765 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:18:42.160188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf349c33-4ccc-4f4f-9fd0-23fa6810b102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881d8736b0>]}
[0m06:18:42.160852 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.39s]
[0m06:18:42.161551 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:18:42.162520 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:18:42.163036 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:18:42.163584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:18:42.163980 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:18:42.168563 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:18:42.169143 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:18:42.201518 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:18:42.201970 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260214061842196043"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:18:42.202370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:42.209779 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:18:42.216627 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:18:42.217049 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:18:42.217720 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:18:42.218107 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:18:42.218465 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260214061842196043'
      
      
      order by ordinal_position

  
[0m06:18:42.220971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:18:42.225752 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:18:42.226173 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:18:42.228655 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:18:42.236845 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:18:42.237277 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:18:42.239627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:18:42.241196 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:18:42.241636 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:18:42.242383 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:18:42.257485 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:18:42.258112 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:18:42.258533 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260214061842196043"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260214061842196043"
    )
  
[0m06:18:42.269149 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:18:42.270726 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:18:42.271127 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:18:42.271478 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:18:42.277477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:18:42.278213 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:18:42.278797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf349c33-4ccc-4f4f-9fd0-23fa6810b102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87d20aec00>]}
[0m06:18:42.279404 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m06:18:42.280050 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:18:42.281673 [debug] [MainThread]: Using duckdb connection "master"
[0m06:18:42.282061 [debug] [MainThread]: On master: BEGIN
[0m06:18:42.282392 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:18:42.283093 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:18:42.283469 [debug] [MainThread]: On master: COMMIT
[0m06:18:42.283828 [debug] [MainThread]: Using duckdb connection "master"
[0m06:18:42.284141 [debug] [MainThread]: On master: COMMIT
[0m06:18:42.284713 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:18:42.285068 [debug] [MainThread]: On master: Close
[0m06:18:42.285475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:18:42.285841 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:18:42.286191 [info ] [MainThread]: 
[0m06:18:42.286617 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.32 seconds (13.32s).
[0m06:18:42.287382 [debug] [MainThread]: Command end result
[0m06:18:42.310430 [info ] [MainThread]: 
[0m06:18:42.310976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:18:42.311390 [info ] [MainThread]: 
[0m06:18:42.311825 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:18:42.312668 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.163584, "process_user_time": 4.969285, "process_kernel_time": 0.18427, "process_mem_max_rss": "279452", "process_in_blocks": "1200", "process_out_blocks": "107392"}
[0m06:18:42.313174 [debug] [MainThread]: Command `dbt run` succeeded at 06:18:42.313088 after 15.16 seconds
[0m06:18:42.313571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88201bb980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881418f3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881c11f350>]}
[0m06:18:42.313957 [debug] [MainThread]: Flushing usage events
[0m06:18:44.034465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6efbe5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6eec0bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6efbe7ef0>]}


============================== 06:18:44.037315 | f3d164de-7174-4251-801a-ad9ece597bcc ==============================
[0m06:18:44.037315 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:18:44.037963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:18:44.136531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3d164de-7174-4251-801a-ad9ece597bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6edf5a2a0>]}
[0m06:18:44.150303 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1618059, "process_user_time": 1.202464, "process_kernel_time": 0.080963, "process_mem_max_rss": "99696", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:18:44.150832 [debug] [MainThread]: Command `dbt clean` succeeded at 06:18:44.150736 after 0.16 seconds
[0m06:18:44.151230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6f14373e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6edf5a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6edf1b920>]}
[0m06:18:44.151621 [debug] [MainThread]: Flushing usage events
[0m14:12:29.944508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a6e0ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a71af170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a6e0ec30>]}


============================== 14:12:29.964842 | f45acedd-5868-4ab4-82b5-998b9d6e7452 ==============================
[0m14:12:29.964842 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:12:29.965534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:12:30.107008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f45acedd-5868-4ab4-82b5-998b9d6e7452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a7210e90>]}
[0m14:12:30.123148 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-w32jff6a'
[0m14:12:30.123636 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:12:30.203612 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:12:30.205246 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:12:30.236703 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:12:30.242068 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:12:30.312219 [info ] [MainThread]: Installed from version 1.2.0
[0m14:12:30.312961 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:12:30.313481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f45acedd-5868-4ab4-82b5-998b9d6e7452', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a6c84ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a6b3e450>]}
[0m14:12:30.313960 [info ] [MainThread]: 
[0m14:12:30.314411 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:12:30.325616 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43285653, "process_user_time": 1.683881, "process_kernel_time": 0.136071, "process_mem_max_rss": "101336", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m14:12:30.326217 [debug] [MainThread]: Command `dbt deps` succeeded at 14:12:30.326113 after 0.43 seconds
[0m14:12:30.326648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a6e0ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a7210e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a71af170>]}
[0m14:12:30.327115 [debug] [MainThread]: Flushing usage events
[0m14:12:31.930277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc975896de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc975d50620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9767adf70>]}


============================== 14:12:31.933424 | 8d05edbb-1db8-41f5-9616-ac21f60d6ebf ==============================
[0m14:12:31.933424 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:12:31.934083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:12:32.166016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d05edbb-1db8-41f5-9616-ac21f60d6ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9767adf70>]}
[0m14:12:32.228005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d05edbb-1db8-41f5-9616-ac21f60d6ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc975826990>]}
[0m14:12:32.229853 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:12:32.251216 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:12:32.251975 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:12:32.252518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8d05edbb-1db8-41f5-9616-ac21f60d6ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9764770b0>]}
[0m14:12:33.655649 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:12:33.656339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8d05edbb-1db8-41f5-9616-ac21f60d6ebf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96d90de20>]}
[0m14:12:33.899481 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:12:33.905017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d05edbb-1db8-41f5-9616-ac21f60d6ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96daad1f0>]}
[0m14:12:34.003109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d05edbb-1db8-41f5-9616-ac21f60d6ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96dae9a00>]}
[0m14:12:34.003702 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:12:34.004304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d05edbb-1db8-41f5-9616-ac21f60d6ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96db9cf80>]}
[0m14:12:34.006326 [info ] [MainThread]: 
[0m14:12:34.007098 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:12:34.011998 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:12:34.049915 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:12:34.050413 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:12:34.050841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:34.636869 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:12:34.639302 [debug] [ThreadPool]: On list_petro: Close
[0m14:12:34.640440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:12:34.641020 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:12:34.648482 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:12:34.648933 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:12:34.649312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:34.650460 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:12:34.651810 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:12:34.652201 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:12:34.652997 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:12:34.653396 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:12:34.653791 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:12:34.654415 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:12:34.655336 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:12:34.655740 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:12:34.656126 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:12:34.656712 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:12:34.657138 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:12:34.658425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:12:34.664566 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:12:34.665010 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:12:34.665372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:34.666058 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:12:34.666445 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:12:34.666843 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:12:34.677387 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:12:34.678869 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:12:34.680108 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:12:34.680526 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:12:34.681707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d05edbb-1db8-41f5-9616-ac21f60d6ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96daad370>]}
[0m14:12:34.682266 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:34.682648 [debug] [MainThread]: On master: BEGIN
[0m14:12:34.683044 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:12:34.683923 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:12:34.684326 [debug] [MainThread]: On master: COMMIT
[0m14:12:34.684699 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:34.685102 [debug] [MainThread]: On master: COMMIT
[0m14:12:34.685680 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:12:34.686120 [debug] [MainThread]: On master: Close
[0m14:12:34.686631 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:12:34.687154 [info ] [MainThread]: 
[0m14:12:34.708139 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:12:34.708841 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:12:34.709544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:12:34.710015 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:12:34.737568 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:12:34.738419 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:12:34.773581 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:12:34.774447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:43.510121 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:43.510686 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:12:43.511475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:43.511936 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:43.512359 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:12:43.513405 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:43.514801 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:43.515265 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:12:43.516311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:43.523296 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:43.523796 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:12:43.524746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:43.527843 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:43.528283 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:12:43.529107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:43.545911 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:12:43.546417 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:43.546858 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:12:43.549158 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:43.555296 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:43.555783 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:12:43.557112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:43.559589 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:12:43.561171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d05edbb-1db8-41f5-9616-ac21f60d6ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc93a3405f0>]}
[0m14:12:43.561894 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.85s]
[0m14:12:43.562771 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:12:43.563803 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:12:43.564381 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:12:43.565013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:12:43.565452 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:12:43.570677 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:12:43.571365 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:12:43.607784 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:43.608362 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260214141243601626"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:12:43.608848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:43.616152 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:43.624435 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:43.624960 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:12:43.625853 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:43.626294 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:43.626749 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260214141243601626'
      
      
      order by ordinal_position

  
[0m14:12:43.629433 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:43.635068 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:43.635533 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:12:43.638031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:43.647320 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:43.647829 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:12:43.651684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:43.653550 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:43.654031 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:12:43.654854 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:43.672628 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:12:43.673465 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:43.673964 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260214141243601626"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260214141243601626"
    )
  
[0m14:12:43.686596 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:43.688653 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:12:43.689143 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:43.689553 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:12:43.695624 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:43.696590 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:12:43.697301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d05edbb-1db8-41f5-9616-ac21f60d6ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc93a32b800>]}
[0m14:12:43.698003 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m14:12:43.698760 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:12:43.700162 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:43.700601 [debug] [MainThread]: On master: BEGIN
[0m14:12:43.701043 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:12:43.701817 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:12:43.702223 [debug] [MainThread]: On master: COMMIT
[0m14:12:43.702600 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:43.703013 [debug] [MainThread]: On master: COMMIT
[0m14:12:43.703627 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:12:43.704100 [debug] [MainThread]: On master: Close
[0m14:12:43.704584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:43.704982 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:12:43.705390 [info ] [MainThread]: 
[0m14:12:43.705913 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.70 seconds (9.70s).
[0m14:12:43.706894 [debug] [MainThread]: Command end result
[0m14:12:43.733411 [info ] [MainThread]: 
[0m14:12:43.734111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:12:43.734632 [info ] [MainThread]: 
[0m14:12:43.735183 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:12:43.736285 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.859144, "process_user_time": 5.484034, "process_kernel_time": 0.248363, "process_mem_max_rss": "278972", "process_in_blocks": "1200", "process_out_blocks": "107400"}
[0m14:12:43.736860 [debug] [MainThread]: Command `dbt run` succeeded at 14:12:43.736751 after 11.86 seconds
[0m14:12:43.737315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc975c98ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc975896db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96c5101d0>]}
[0m14:12:43.737769 [debug] [MainThread]: Flushing usage events
[0m14:12:45.504619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4bba46660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b9c02180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4baae2ae0>]}


============================== 14:12:45.507861 | 91d898c4-3d96-44db-91d7-f6282a19587d ==============================
[0m14:12:45.507861 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:12:45.508572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:12:45.622309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91d898c4-3d96-44db-91d7-f6282a19587d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4bb6a4a10>]}
[0m14:12:45.642366 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19052254, "process_user_time": 1.392171, "process_kernel_time": 0.095942, "process_mem_max_rss": "99464", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:12:45.642927 [debug] [MainThread]: Command `dbt clean` succeeded at 14:12:45.642825 after 0.19 seconds
[0m14:12:45.643370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b974ce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b96fd9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b96fd880>]}
[0m14:12:45.643821 [debug] [MainThread]: Flushing usage events
[0m22:06:44.629227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f343c370890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f343c9d7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f343c9d6db0>]}


============================== 22:06:44.645981 | 31ff9648-d346-4828-af10-03a56a714851 ==============================
[0m22:06:44.645981 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:44.646741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:44.788313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31ff9648-d346-4828-af10-03a56a714851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f343c13b380>]}
[0m22:06:44.804997 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hnadim2k'
[0m22:06:44.805548 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:44.869535 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:44.871383 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:44.906712 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:44.912437 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:45.153220 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:45.153874 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:06:45.154517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '31ff9648-d346-4828-af10-03a56a714851', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f343c1d7170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f343c0dbd70>]}
[0m22:06:45.154975 [info ] [MainThread]: 
[0m22:06:45.155521 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:45.165697 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5900207, "process_user_time": 1.729032, "process_kernel_time": 0.142167, "process_mem_max_rss": "101176", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m22:06:45.166313 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:45.166181 after 0.59 seconds
[0m22:06:45.166757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f343c506ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f343c2124e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f343c211760>]}
[0m22:06:45.167187 [debug] [MainThread]: Flushing usage events
[0m22:06:47.119984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5ab62cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5a8c8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5b11d100>]}


============================== 22:06:47.123239 | cf71b2cd-6f38-4f99-bf57-c869bd6745e6 ==============================
[0m22:06:47.123239 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:47.123948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:47.362117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf71b2cd-6f38-4f99-bf57-c869bd6745e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5c5987d0>]}
[0m22:06:47.426767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf71b2cd-6f38-4f99-bf57-c869bd6745e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5c5ce390>]}
[0m22:06:47.428721 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:47.450299 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:47.451118 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:47.451752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cf71b2cd-6f38-4f99-bf57-c869bd6745e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5a609b80>]}
[0m22:06:48.881965 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:48.882687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cf71b2cd-6f38-4f99-bf57-c869bd6745e6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff529e8080>]}
[0m22:06:49.137918 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:49.143600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf71b2cd-6f38-4f99-bf57-c869bd6745e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff529cc290>]}
[0m22:06:49.242643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf71b2cd-6f38-4f99-bf57-c869bd6745e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5309dd90>]}
[0m22:06:49.243227 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:49.243793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf71b2cd-6f38-4f99-bf57-c869bd6745e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5a8c8230>]}
[0m22:06:49.245847 [info ] [MainThread]: 
[0m22:06:49.246604 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:49.251616 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:49.290241 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:49.290790 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:49.291190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:49.865300 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:49.867882 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:49.869082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:49.869660 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:49.877138 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.877628 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:49.878006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:49.879307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.880737 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.881131 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:49.881984 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.882400 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.882768 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:49.883423 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.884363 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:49.884760 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.885125 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:49.885750 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.886154 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:49.887579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:49.893833 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:49.894251 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:49.894644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:49.895640 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.896040 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:49.896460 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:49.907166 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.908673 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:49.909902 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:49.910330 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:49.911459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf71b2cd-6f38-4f99-bf57-c869bd6745e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff516b9400>]}
[0m22:06:49.911984 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.912401 [debug] [MainThread]: On master: BEGIN
[0m22:06:49.912773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:49.913444 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.913848 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.914225 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.914647 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.915236 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.915684 [debug] [MainThread]: On master: Close
[0m22:06:49.916193 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:49.916698 [info ] [MainThread]: 
[0m22:06:49.935035 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:49.935700 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:49.936321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:49.936765 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:49.964295 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:49.965192 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:50.000980 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:50.001900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:00.956908 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:00.957519 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:00.958289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.958737 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:00.959159 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:00.960178 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.961602 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:00.962049 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:00.963095 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.970236 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:00.970792 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:00.971848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.975247 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:00.975718 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:00.976590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.993588 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:00.994090 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:00.994540 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:00.996824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:01.002813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:01.003294 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:01.004517 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:01.007052 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:01.008620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf71b2cd-6f38-4f99-bf57-c869bd6745e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5c577800>]}
[0m22:07:01.009347 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.07s]
[0m22:07:01.010152 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:01.011091 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:01.011775 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:01.012489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:01.012937 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:01.018033 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:01.018719 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:01.055434 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:01.056003 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260214220701049318"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:01.056491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:01.064377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:01.072703 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:01.073204 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:01.074200 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:01.074675 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:01.075109 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260214220701049318'
      
      
      order by ordinal_position

  
[0m22:07:01.077654 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:01.083179 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:01.083684 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:01.086251 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:01.096205 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:01.096804 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:01.099765 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:01.101659 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:01.102122 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:07:01.102942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:01.120789 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:01.121670 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:01.122146 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260214220701049318"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260214220701049318"
    )
  
[0m22:07:01.134697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:01.136803 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:01.137362 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:01.138118 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:01.144460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:01.145527 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:01.146231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf71b2cd-6f38-4f99-bf57-c869bd6745e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff1b3a9820>]}
[0m22:07:01.146971 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m22:07:01.147821 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:01.149333 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:01.149771 [debug] [MainThread]: On master: BEGIN
[0m22:07:01.150160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:01.151020 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:01.151473 [debug] [MainThread]: On master: COMMIT
[0m22:07:01.151863 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:01.152242 [debug] [MainThread]: On master: COMMIT
[0m22:07:01.152919 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:01.153367 [debug] [MainThread]: On master: Close
[0m22:07:01.153896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:01.154286 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:01.154717 [info ] [MainThread]: 
[0m22:07:01.155220 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.91 seconds (11.91s).
[0m22:07:01.156200 [debug] [MainThread]: Command end result
[0m22:07:01.182999 [info ] [MainThread]: 
[0m22:07:01.183694 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:01.184172 [info ] [MainThread]: 
[0m22:07:01.184681 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:01.185686 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.120536, "process_user_time": 5.574212, "process_kernel_time": 0.273863, "process_mem_max_rss": "281564", "process_in_blocks": "1200", "process_out_blocks": "107424"}
[0m22:07:01.186244 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:01.186138 after 14.12 seconds
[0m22:07:01.186740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5b9b0cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5b11f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff1b45cc50>]}
[0m22:07:01.187194 [debug] [MainThread]: Flushing usage events
[0m22:07:03.336030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f454c9a2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f454c9a2db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f454cb0ab70>]}


============================== 22:07:03.339199 | 2e22c4ee-5d62-49e1-afb8-52ced4df9344 ==============================
[0m22:07:03.339199 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:03.339905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:03.456063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e22c4ee-5d62-49e1-afb8-52ced4df9344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f454cc14770>]}
[0m22:07:03.474972 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19306378, "process_user_time": 1.416711, "process_kernel_time": 0.111977, "process_mem_max_rss": "99920", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:07:03.475590 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:03.475480 after 0.19 seconds
[0m22:07:03.476041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f454cda5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f454cc14770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f454ed614f0>]}
[0m22:07:03.476692 [debug] [MainThread]: Flushing usage events
[0m06:22:15.608354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77a5dadfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77a4e20c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77a4e71dc0>]}


============================== 06:22:15.624035 | 4b169528-e4d2-4809-ad53-ae9b14f4056b ==============================
[0m06:22:15.624035 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:22:15.624692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:22:15.758980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b169528-e4d2-4809-ad53-ae9b14f4056b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77a58bb950>]}
[0m06:22:15.774598 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ywphxptd'
[0m06:22:15.775090 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:22:15.865259 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:22:15.866633 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:22:15.900074 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:22:15.905258 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:22:16.085507 [info ] [MainThread]: Installed from version 1.2.0
[0m06:22:16.086141 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:22:16.086741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4b169528-e4d2-4809-ad53-ae9b14f4056b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77a4c88530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77a4c8bef0>]}
[0m06:22:16.087189 [info ] [MainThread]: 
[0m06:22:16.087731 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:22:16.098119 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.54113686, "process_user_time": 1.651407, "process_kernel_time": 0.138034, "process_mem_max_rss": "101128", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m06:22:16.098716 [debug] [MainThread]: Command `dbt deps` succeeded at 06:22:16.098608 after 0.54 seconds
[0m06:22:16.099147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77a93bb980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77a4e6b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77a4c06a20>]}
[0m06:22:16.099623 [debug] [MainThread]: Flushing usage events
[0m06:22:17.836089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a8496a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a86cf770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a8496cc0>]}


============================== 06:22:17.839246 | d25c4a4e-3d00-4730-922d-7c4e08c9ab9c ==============================
[0m06:22:17.839246 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:22:17.839937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:22:18.074789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd25c4a4e-3d00-4730-922d-7c4e08c9ab9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a8a2e210>]}
[0m06:22:18.136714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd25c4a4e-3d00-4730-922d-7c4e08c9ab9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a89d3170>]}
[0m06:22:18.138612 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:22:18.159344 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:22:18.160168 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:22:18.160774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd25c4a4e-3d00-4730-922d-7c4e08c9ab9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a0fde930>]}
[0m06:22:19.550986 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:22:19.551639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd25c4a4e-3d00-4730-922d-7c4e08c9ab9c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a0504b00>]}
[0m06:22:19.800885 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:22:19.806483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd25c4a4e-3d00-4730-922d-7c4e08c9ab9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a97f0830>]}
[0m06:22:19.902063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd25c4a4e-3d00-4730-922d-7c4e08c9ab9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a06e90d0>]}
[0m06:22:19.902655 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:22:19.903193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd25c4a4e-3d00-4730-922d-7c4e08c9ab9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a079e6c0>]}
[0m06:22:19.905244 [info ] [MainThread]: 
[0m06:22:19.906010 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:22:19.910873 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:22:19.948965 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:22:19.949445 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:22:19.949844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:22:20.370672 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:20.372969 [debug] [ThreadPool]: On list_petro: Close
[0m06:22:20.374117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:22:20.374895 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:22:20.382637 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:22:20.383061 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:22:20.383471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:22:20.384460 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:20.385798 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:22:20.386185 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:22:20.387022 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:20.387439 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:22:20.387810 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:22:20.388464 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:20.389370 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:22:20.389788 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:22:20.390155 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:22:20.390759 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:20.391151 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:22:20.392358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:22:20.398290 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:22:20.398720 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:22:20.399087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:22:20.399797 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:20.400181 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:22:20.400578 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:22:20.411199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:20.412570 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:22:20.413786 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:22:20.414186 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:22:20.415339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd25c4a4e-3d00-4730-922d-7c4e08c9ab9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3aa3ba5d0>]}
[0m06:22:20.415918 [debug] [MainThread]: Using duckdb connection "master"
[0m06:22:20.416312 [debug] [MainThread]: On master: BEGIN
[0m06:22:20.416701 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:22:20.417544 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:22:20.417949 [debug] [MainThread]: On master: COMMIT
[0m06:22:20.418322 [debug] [MainThread]: Using duckdb connection "master"
[0m06:22:20.418719 [debug] [MainThread]: On master: COMMIT
[0m06:22:20.419309 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:22:20.419743 [debug] [MainThread]: On master: Close
[0m06:22:20.420228 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:22:20.420740 [info ] [MainThread]: 
[0m06:22:20.438329 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:22:20.438947 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:22:20.439544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:22:20.439984 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:22:20.467194 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:22:20.468015 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:22:20.503966 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:22:20.504836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:28.672183 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:28.672781 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:22:28.673491 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:28.673934 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:28.674355 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:22:28.675368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:28.676780 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:28.677224 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:22:28.678250 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:28.685104 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:28.685579 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:22:28.686313 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:28.689363 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:28.689829 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:22:28.690559 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:28.707158 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:22:28.707647 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:28.708063 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:22:28.710321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:28.716152 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:28.716631 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:22:28.717824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:28.720247 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:22:28.721786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25c4a4e-3d00-4730-922d-7c4e08c9ab9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3aa367680>]}
[0m06:22:28.722503 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.28s]
[0m06:22:28.723271 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:22:28.724183 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:22:28.724789 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:22:28.725477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:22:28.725951 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:22:28.731182 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:22:28.731887 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:22:28.768031 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:28.768545 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260215062228762021"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:22:28.769009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:28.776434 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:28.784120 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:28.784605 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:22:28.785278 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:28.785733 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:28.786154 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260215062228762021'
      
      
      order by ordinal_position

  
[0m06:22:28.788625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:28.793894 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:28.794354 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:22:28.796730 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:28.805687 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:28.806152 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:22:28.808552 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:28.810221 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:28.810698 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:22:28.811434 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:28.830875 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:22:28.831621 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:28.832083 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260215062228762021"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260215062228762021"
    )
  
[0m06:22:28.845316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:28.847158 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:22:28.847616 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:28.848024 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:22:28.854062 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:28.854971 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:22:28.855661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25c4a4e-3d00-4730-922d-7c4e08c9ab9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35cfe45c0>]}
[0m06:22:28.856325 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m06:22:28.857089 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:22:28.858825 [debug] [MainThread]: Using duckdb connection "master"
[0m06:22:28.859249 [debug] [MainThread]: On master: BEGIN
[0m06:22:28.859682 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:22:28.860366 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:22:28.860794 [debug] [MainThread]: On master: COMMIT
[0m06:22:28.861164 [debug] [MainThread]: Using duckdb connection "master"
[0m06:22:28.861563 [debug] [MainThread]: On master: COMMIT
[0m06:22:28.862155 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:22:28.862592 [debug] [MainThread]: On master: Close
[0m06:22:28.863056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:22:28.863472 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:22:28.863880 [info ] [MainThread]: 
[0m06:22:28.864345 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.96 seconds (8.96s).
[0m06:22:28.865267 [debug] [MainThread]: Command end result
[0m06:22:28.891186 [info ] [MainThread]: 
[0m06:22:28.891775 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:22:28.892246 [info ] [MainThread]: 
[0m06:22:28.892735 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:22:28.893699 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.110351, "process_user_time": 5.740549, "process_kernel_time": 0.311975, "process_mem_max_rss": "317008", "process_in_blocks": "1200", "process_out_blocks": "107400"}
[0m06:22:28.894239 [debug] [MainThread]: Command `dbt run` succeeded at 06:22:28.894138 after 11.11 seconds
[0m06:22:28.894697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a86cf770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3aa367680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a89f7290>]}
[0m06:22:28.895123 [debug] [MainThread]: Flushing usage events
[0m06:22:30.666686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc266b8fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26715a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc267f19ac0>]}


============================== 06:22:30.669817 | 5cf303d4-e9e8-471f-858c-907601c0b83d ==============================
[0m06:22:30.669817 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:22:30.670480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:22:30.783076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cf303d4-e9e8-471f-858c-907601c0b83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2663073e0>]}
[0m06:22:30.801139 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.186507, "process_user_time": 1.343648, "process_kernel_time": 0.102973, "process_mem_max_rss": "99656", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:22:30.801700 [debug] [MainThread]: Command `dbt clean` succeeded at 06:22:30.801598 after 0.19 seconds
[0m06:22:30.802126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26633ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2662060f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc266204590>]}
[0m06:22:30.802564 [debug] [MainThread]: Flushing usage events
[0m14:13:17.420320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8b796ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8b65e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8d751370>]}


============================== 14:13:17.439401 | 11682db8-b6da-449f-9200-ed65d0784ffd ==============================
[0m14:13:17.439401 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:13:17.440141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:13:17.580197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11682db8-b6da-449f-9200-ed65d0784ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8b4417c0>]}
[0m14:13:17.595635 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mbj4_w4n'
[0m14:13:17.596142 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:13:17.632183 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:13:17.633690 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:13:17.666584 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:13:17.672567 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:13:17.827833 [info ] [MainThread]: Installed from version 1.2.0
[0m14:13:17.828471 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:13:17.829054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '11682db8-b6da-449f-9200-ed65d0784ffd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8c404620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8b4000b0>]}
[0m14:13:17.829555 [info ] [MainThread]: 
[0m14:13:17.830080 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:13:17.840025 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47127926, "process_user_time": 1.641714, "process_kernel_time": 0.141975, "process_mem_max_rss": "101460", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m14:13:17.840625 [debug] [MainThread]: Command `dbt deps` succeeded at 14:13:17.840496 after 0.47 seconds
[0m14:13:17.841069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8b796ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8b796ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8b3912e0>]}
[0m14:13:17.841498 [debug] [MainThread]: Flushing usage events
[0m14:13:19.486200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c87ae0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c8a478c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c8a1d9a0>]}


============================== 14:13:19.489298 | c3ef5967-48cc-4c6e-941a-8c59e710dd20 ==============================
[0m14:13:19.489298 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:13:19.490058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:13:19.729277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3ef5967-48cc-4c6e-941a-8c59e710dd20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c8512db0>]}
[0m14:13:19.791885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3ef5967-48cc-4c6e-941a-8c59e710dd20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c854b830>]}
[0m14:13:19.793854 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:13:19.816681 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:13:19.817516 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:13:19.818115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c3ef5967-48cc-4c6e-941a-8c59e710dd20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c86c2540>]}
[0m14:13:21.219025 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:13:21.219707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c3ef5967-48cc-4c6e-941a-8c59e710dd20', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c079fa40>]}
[0m14:13:21.462867 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:13:21.468294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3ef5967-48cc-4c6e-941a-8c59e710dd20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46cbb63350>]}
[0m14:13:21.560059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3ef5967-48cc-4c6e-941a-8c59e710dd20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c0609310>]}
[0m14:13:21.560657 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:13:21.561189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3ef5967-48cc-4c6e-941a-8c59e710dd20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c86afd70>]}
[0m14:13:21.563273 [info ] [MainThread]: 
[0m14:13:21.564038 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:13:21.568886 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:13:21.606432 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:13:21.606903 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:13:21.607287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:22.009694 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:22.011889 [debug] [ThreadPool]: On list_petro: Close
[0m14:13:22.013023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:13:22.013578 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:13:22.021294 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:13:22.021736 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:13:22.022112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:22.023238 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:22.024579 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:13:22.024990 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:13:22.025586 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:22.026003 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:13:22.026364 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:13:22.027035 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:22.028120 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:13:22.028510 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:13:22.028912 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:13:22.029482 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:22.029913 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:13:22.031182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:13:22.037261 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:13:22.037687 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:13:22.038048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:22.038950 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:22.039342 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:13:22.039761 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:13:22.050107 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:22.051453 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:13:22.052708 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:13:22.053117 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:13:22.054290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3ef5967-48cc-4c6e-941a-8c59e710dd20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c022e510>]}
[0m14:13:22.054863 [debug] [MainThread]: Using duckdb connection "master"
[0m14:13:22.055248 [debug] [MainThread]: On master: BEGIN
[0m14:13:22.055633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:13:22.056317 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:13:22.056747 [debug] [MainThread]: On master: COMMIT
[0m14:13:22.057118 [debug] [MainThread]: Using duckdb connection "master"
[0m14:13:22.057474 [debug] [MainThread]: On master: COMMIT
[0m14:13:22.058100 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:13:22.058493 [debug] [MainThread]: On master: Close
[0m14:13:22.059004 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:13:22.059487 [info ] [MainThread]: 
[0m14:13:22.083157 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:13:22.083934 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:13:22.084573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:13:22.085040 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:13:22.113015 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:13:22.113883 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:13:22.149670 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:13:22.150432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:30.808994 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:13:30.809541 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:13:30.810237 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:30.810708 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:13:30.811136 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:13:30.812110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:30.813466 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:13:30.813935 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:13:30.814979 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:30.821789 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:13:30.822245 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:13:30.822997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:30.825947 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:13:30.826386 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:13:30.827114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:30.843825 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:13:30.844289 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:13:30.844724 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:13:30.848757 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:30.854525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:13:30.855020 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:13:30.856269 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:30.858717 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:13:30.860262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ef5967-48cc-4c6e-941a-8c59e710dd20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c07af9b0>]}
[0m14:13:30.860984 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.77s]
[0m14:13:30.861854 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:13:30.862881 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:13:30.863432 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:13:30.864118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:13:30.864573 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:13:30.869622 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:13:30.870274 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:13:30.906741 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:13:30.907251 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260215141330900636"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:13:30.907738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:30.915096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:30.922830 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:13:30.923293 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:13:30.923978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:30.924413 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:13:30.924869 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260215141330900636'
      
      
      order by ordinal_position

  
[0m14:13:30.927365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:30.932671 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:13:30.933127 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:13:30.935512 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:30.944653 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:13:30.945118 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:13:30.947477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:30.949204 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:13:30.949681 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:13:30.950392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:30.967784 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:13:30.968483 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:13:30.968977 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260215141330900636"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260215141330900636"
    )
  
[0m14:13:30.980799 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:30.982526 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:13:30.982998 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:13:30.983402 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:13:30.989408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:30.990299 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:13:30.990974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ef5967-48cc-4c6e-941a-8c59e710dd20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f467cab6e10>]}
[0m14:13:30.991650 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m14:13:30.992475 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:13:30.994763 [debug] [MainThread]: Using duckdb connection "master"
[0m14:13:30.995180 [debug] [MainThread]: On master: BEGIN
[0m14:13:30.995554 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:13:30.996312 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:13:30.996768 [debug] [MainThread]: On master: COMMIT
[0m14:13:30.997146 [debug] [MainThread]: Using duckdb connection "master"
[0m14:13:30.997515 [debug] [MainThread]: On master: COMMIT
[0m14:13:30.998134 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:13:30.998533 [debug] [MainThread]: On master: Close
[0m14:13:30.999058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:30.999420 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:13:30.999848 [info ] [MainThread]: 
[0m14:13:31.000383 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.44 seconds (9.44s).
[0m14:13:31.001404 [debug] [MainThread]: Command end result
[0m14:13:31.027201 [info ] [MainThread]: 
[0m14:13:31.027843 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:13:31.028381 [info ] [MainThread]: 
[0m14:13:31.028962 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:13:31.029993 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.596036, "process_user_time": 5.770931, "process_kernel_time": 0.274091, "process_mem_max_rss": "316268", "process_in_blocks": "1200", "process_out_blocks": "107376"}
[0m14:13:31.030535 [debug] [MainThread]: Command `dbt run` succeeded at 14:13:31.030434 after 11.60 seconds
[0m14:13:31.031020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c8a478c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c96a6b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46927e04a0>]}
[0m14:13:31.031448 [debug] [MainThread]: Flushing usage events
[0m14:13:32.799319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d3ba7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d33eeea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d3151fd0>]}


============================== 14:13:32.802404 | 39a35102-41b5-4ddb-ac64-1e6dfd59f8d7 ==============================
[0m14:13:32.802404 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:13:32.803116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:13:32.916293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39a35102-41b5-4ddb-ac64-1e6dfd59f8d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d355de80>]}
[0m14:13:32.934381 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18723443, "process_user_time": 1.342562, "process_kernel_time": 0.103966, "process_mem_max_rss": "99844", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:13:32.934947 [debug] [MainThread]: Command `dbt clean` succeeded at 14:13:32.934839 after 0.19 seconds
[0m14:13:32.935375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d77bb980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d3768200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d376a930>]}
[0m14:13:32.935843 [debug] [MainThread]: Flushing usage events
[0m22:06:47.133777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd134b69580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd134873920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd134739c10>]}


============================== 22:06:47.149897 | 4a31a0e9-3d96-4445-87ac-278794894212 ==============================
[0m22:06:47.149897 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:47.150574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:47.274376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a31a0e9-3d96-4445-87ac-278794894212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13571ce00>]}
[0m22:06:47.288451 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qxotl6dt'
[0m22:06:47.288926 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:47.361149 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:47.362580 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:47.400687 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:47.405830 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:47.748837 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:47.749386 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:06:47.749882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4a31a0e9-3d96-4445-87ac-278794894212', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1345dd9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1344dc140>]}
[0m22:06:47.750334 [info ] [MainThread]: 
[0m22:06:47.750755 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:47.760561 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.67191315, "process_user_time": 1.502063, "process_kernel_time": 0.077312, "process_mem_max_rss": "101688", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m22:06:47.761251 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:47.761134 after 0.67 seconds
[0m22:06:47.761724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd134847860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1345837a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd134583d40>]}
[0m22:06:47.762194 [debug] [MainThread]: Flushing usage events
[0m22:06:49.336256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b1f5bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b1f90a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b1f913d0>]}


============================== 22:06:49.339141 | 9874e642-0c60-492f-934f-ffec9e2638d5 ==============================
[0m22:06:49.339141 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:49.339772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:49.542199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9874e642-0c60-492f-934f-ffec9e2638d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b24f4590>]}
[0m22:06:49.596060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9874e642-0c60-492f-934f-ffec9e2638d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b4936ae0>]}
[0m22:06:49.597744 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:49.617254 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:49.617895 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:49.618392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9874e642-0c60-492f-934f-ffec9e2638d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b4936ae0>]}
[0m22:06:50.816842 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:50.817430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9874e642-0c60-492f-934f-ffec9e2638d5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a95a9e80>]}
[0m22:06:51.025098 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:51.029951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9874e642-0c60-492f-934f-ffec9e2638d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a9599fa0>]}
[0m22:06:51.116466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9874e642-0c60-492f-934f-ffec9e2638d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a9cb42f0>]}
[0m22:06:51.116997 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:51.117480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9874e642-0c60-492f-934f-ffec9e2638d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a9c7fa70>]}
[0m22:06:51.119398 [info ] [MainThread]: 
[0m22:06:51.120109 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:51.124491 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:51.155101 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:51.155541 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:51.155892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:51.821103 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:51.822607 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:51.823458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:51.823967 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:51.830737 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:51.831144 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:51.831468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:51.832453 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:51.833696 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:51.834077 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:51.834970 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:51.835329 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:51.835636 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:51.836219 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:51.837073 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:51.837420 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:51.837738 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:51.838254 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:51.838602 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:51.839727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:51.845209 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:51.845579 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:51.845893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:51.846534 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:51.846872 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:51.847214 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:51.857003 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:51.858330 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:51.859719 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:51.860104 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:51.861110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9874e642-0c60-492f-934f-ffec9e2638d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b32767b0>]}
[0m22:06:51.861687 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:51.862156 [debug] [MainThread]: On master: BEGIN
[0m22:06:51.862559 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:51.863516 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:51.863869 [debug] [MainThread]: On master: COMMIT
[0m22:06:51.864221 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:51.864530 [debug] [MainThread]: On master: COMMIT
[0m22:06:51.865085 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:51.865442 [debug] [MainThread]: On master: Close
[0m22:06:51.865878 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:51.866307 [info ] [MainThread]: 
[0m22:06:51.883140 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:51.883698 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:51.884235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:51.884622 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:51.909362 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:51.910040 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:51.941589 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:51.942266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:02.318212 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:02.318725 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:02.319461 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:02.319888 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:02.320270 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:02.321213 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:02.322557 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:02.322969 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:02.324340 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:02.330808 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:02.331252 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:02.332008 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:02.334894 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:02.335316 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:02.335981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:02.351066 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:02.351494 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:02.351866 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:02.354781 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:02.359986 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:02.360422 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:02.361616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:02.363826 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:02.365272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9874e642-0c60-492f-934f-ffec9e2638d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a82d5430>]}
[0m22:07:02.365922 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.48s]
[0m22:07:02.366646 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:02.367665 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:02.368209 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:02.368749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:02.369172 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:02.373785 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:02.374382 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:02.406903 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:02.407372 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260215220702401510"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:02.407778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:02.414774 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:02.421662 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:02.422101 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:02.422707 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:02.423101 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:02.423468 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260215220702401510'
      
      
      order by ordinal_position

  
[0m22:07:02.425889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:02.430716 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:02.431152 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:02.433614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:02.441755 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:02.442202 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:02.444852 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:02.446435 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:02.446857 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:07:02.447555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:02.462891 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:02.463546 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:02.463953 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260215220702401510"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260215220702401510"
    )
  
[0m22:07:02.476363 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:02.478125 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:02.478535 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:02.478899 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:02.485374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:02.486160 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:02.486769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9874e642-0c60-492f-934f-ffec9e2638d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8563f25670>]}
[0m22:07:02.487387 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m22:07:02.488079 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:02.489614 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:02.490143 [debug] [MainThread]: On master: BEGIN
[0m22:07:02.490554 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:02.491185 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:02.491543 [debug] [MainThread]: On master: COMMIT
[0m22:07:02.491862 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:02.492202 [debug] [MainThread]: On master: COMMIT
[0m22:07:02.492718 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:02.493111 [debug] [MainThread]: On master: Close
[0m22:07:02.493527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:02.493837 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:02.494220 [info ] [MainThread]: 
[0m22:07:02.494670 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.37 seconds (11.37s).
[0m22:07:02.495590 [debug] [MainThread]: Command end result
[0m22:07:02.518587 [info ] [MainThread]: 
[0m22:07:02.519170 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:02.519656 [info ] [MainThread]: 
[0m22:07:02.520154 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:02.521094 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.230917, "process_user_time": 4.952572, "process_kernel_time": 0.222115, "process_mem_max_rss": "278208", "process_in_blocks": "1200", "process_out_blocks": "107416"}
[0m22:07:02.521603 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:02.521516 after 13.23 seconds
[0m22:07:02.521987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b5ad3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b12b6060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8563f4cfb0>]}
[0m22:07:02.522390 [debug] [MainThread]: Flushing usage events
[0m22:07:04.216127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907f336d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907f49e720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907f49e930>]}


============================== 22:07:04.218970 | 2243a92d-153d-4ffa-84c5-972a1911fb9e ==============================
[0m22:07:04.218970 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:04.219637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:07:04.317567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2243a92d-153d-4ffa-84c5-972a1911fb9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907f56f770>]}
[0m22:07:04.331326 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16091748, "process_user_time": 1.189802, "process_kernel_time": 0.065933, "process_mem_max_rss": "100000", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:07:04.331828 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:04.331745 after 0.16 seconds
[0m22:07:04.332235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9080915490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907f2bb6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907f40aab0>]}
[0m22:07:04.332613 [debug] [MainThread]: Flushing usage events
[0m06:29:43.969021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ae1e16c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ae156ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ae156eea0>]}


============================== 06:29:43.989068 | cd4d6d89-416e-4bcd-b26e-92d9baa9d725 ==============================
[0m06:29:43.989068 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:29:43.989764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:29:44.135637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd4d6d89-416e-4bcd-b26e-92d9baa9d725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ae251cef0>]}
[0m06:29:44.152382 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fyh2e2fd'
[0m06:29:44.152920 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:29:44.276778 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:29:44.278323 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:29:44.314900 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:29:44.320220 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:29:44.574743 [info ] [MainThread]: Installed from version 1.2.0
[0m06:29:44.575441 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:29:44.576017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cd4d6d89-416e-4bcd-b26e-92d9baa9d725', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ae1337620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ae1336de0>]}
[0m06:29:44.576476 [info ] [MainThread]: 
[0m06:29:44.576989 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:29:44.587750 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6710263, "process_user_time": 1.701856, "process_kernel_time": 0.144327, "process_mem_max_rss": "101736", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m06:29:44.588325 [debug] [MainThread]: Command `dbt deps` succeeded at 06:29:44.588221 after 0.67 seconds
[0m06:29:44.588746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ae5b63980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ae16a2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ae171c1a0>]}
[0m06:29:44.589201 [debug] [MainThread]: Flushing usage events
[0m06:29:46.453524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd925e4e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd92619bce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd925ce6b70>]}


============================== 06:29:46.456642 | e7073dcf-f655-4854-8af1-522bba8c04ad ==============================
[0m06:29:46.456642 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:29:46.457405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:29:46.690638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7073dcf-f655-4854-8af1-522bba8c04ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd925d91490>]}
[0m06:29:46.752339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7073dcf-f655-4854-8af1-522bba8c04ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd928a2cfb0>]}
[0m06:29:46.754186 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:29:46.776038 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:29:46.776804 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:29:46.777373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e7073dcf-f655-4854-8af1-522bba8c04ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd926284170>]}
[0m06:29:48.194807 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:29:48.195490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e7073dcf-f655-4854-8af1-522bba8c04ad', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91dd2f2c0>]}
[0m06:29:48.450455 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:29:48.456098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7073dcf-f655-4854-8af1-522bba8c04ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91de98e30>]}
[0m06:29:48.557852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7073dcf-f655-4854-8af1-522bba8c04ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91df9a6c0>]}
[0m06:29:48.558500 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:29:48.559076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7073dcf-f655-4854-8af1-522bba8c04ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91df9fe00>]}
[0m06:29:48.561253 [info ] [MainThread]: 
[0m06:29:48.562011 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:29:48.567087 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:29:48.606010 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:29:48.606585 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:29:48.607037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:29:49.331796 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:29:49.333368 [debug] [ThreadPool]: On list_petro: Close
[0m06:29:49.334212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:29:49.334751 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:29:49.342207 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:49.342638 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:29:49.343053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:49.344100 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:49.345456 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:49.345846 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:29:49.346500 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:49.346903 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:49.347273 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:29:49.347969 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:49.348893 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:29:49.349294 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:49.349674 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:29:49.350318 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:49.350716 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:29:49.352053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:29:49.358261 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:29:49.358713 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:29:49.359118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:49.360105 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:49.360506 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:29:49.360954 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:29:49.371806 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:49.373418 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:29:49.374695 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:29:49.375141 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:29:49.376416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7073dcf-f655-4854-8af1-522bba8c04ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91c919f10>]}
[0m06:29:49.377016 [debug] [MainThread]: Using duckdb connection "master"
[0m06:29:49.377423 [debug] [MainThread]: On master: BEGIN
[0m06:29:49.377793 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:29:49.378560 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:29:49.378991 [debug] [MainThread]: On master: COMMIT
[0m06:29:49.379420 [debug] [MainThread]: Using duckdb connection "master"
[0m06:29:49.379794 [debug] [MainThread]: On master: COMMIT
[0m06:29:49.380414 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:29:49.380811 [debug] [MainThread]: On master: Close
[0m06:29:49.381363 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:29:49.381832 [info ] [MainThread]: 
[0m06:29:49.401552 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:29:49.402276 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:29:49.402918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:29:49.403362 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:29:49.432579 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:29:49.433479 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:29:49.468797 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:29:49.469678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:59.844057 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:59.844605 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:29:59.845338 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:59.845774 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:59.846223 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:29:59.847184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:59.848533 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:59.848995 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:29:59.850022 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:59.856706 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:59.857182 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:29:59.858003 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:59.860915 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:59.861358 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:29:59.862083 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:59.878704 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:29:59.879189 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:59.879604 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:29:59.881847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:59.887709 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:59.888188 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:29:59.889409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:59.891780 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:29:59.893337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7073dcf-f655-4854-8af1-522bba8c04ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d6d3f290>]}
[0m06:29:59.894053 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.49s]
[0m06:29:59.894930 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:29:59.895958 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:29:59.896516 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:29:59.897144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:29:59.897575 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:29:59.902523 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:29:59.903194 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:29:59.939152 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:59.939666 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260216062959933093"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:29:59.940146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:59.947243 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:59.954748 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:59.955220 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:29:59.955888 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:59.956347 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:59.956773 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260216062959933093'
      
      
      order by ordinal_position

  
[0m06:29:59.959164 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:59.964374 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:59.964832 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:29:59.967242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:59.976050 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:59.976527 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:29:59.979311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:59.981000 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:59.981460 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:29:59.982253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:59.999284 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:29:59.999982 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:30:00.000433 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260216062959933093"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260216062959933093"
    )
  
[0m06:30:00.011891 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:30:00.013828 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:30:00.014313 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:30:00.014724 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:30:00.021494 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:30:00.022412 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:30:00.023114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7073dcf-f655-4854-8af1-522bba8c04ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d6b1bf50>]}
[0m06:30:00.023776 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m06:30:00.024579 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:30:00.026729 [debug] [MainThread]: Using duckdb connection "master"
[0m06:30:00.027190 [debug] [MainThread]: On master: BEGIN
[0m06:30:00.027575 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:30:00.028314 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:30:00.028719 [debug] [MainThread]: On master: COMMIT
[0m06:30:00.029154 [debug] [MainThread]: Using duckdb connection "master"
[0m06:30:00.029519 [debug] [MainThread]: On master: COMMIT
[0m06:30:00.030123 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:30:00.030529 [debug] [MainThread]: On master: Close
[0m06:30:00.031031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:30:00.031411 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:30:00.031809 [info ] [MainThread]: 
[0m06:30:00.032367 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.47 seconds (11.47s).
[0m06:30:00.033407 [debug] [MainThread]: Command end result
[0m06:30:00.060283 [info ] [MainThread]: 
[0m06:30:00.061130 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:30:00.061734 [info ] [MainThread]: 
[0m06:30:00.062323 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:30:00.063443 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.663358, "process_user_time": 5.521124, "process_kernel_time": 0.270054, "process_mem_max_rss": "281508", "process_in_blocks": "1200", "process_out_blocks": "107392"}
[0m06:30:00.064058 [debug] [MainThread]: Command `dbt run` succeeded at 06:30:00.063946 after 13.66 seconds
[0m06:30:00.064528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd92a3bb980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91df9fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd92624f3b0>]}
[0m06:30:00.065006 [debug] [MainThread]: Flushing usage events
[0m06:30:02.148078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d3b92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429e242180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429dab52e0>]}


============================== 06:30:02.151279 | 2253e2af-79d6-4ac5-87a3-a82a1538772c ==============================
[0m06:30:02.151279 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:30:02.152024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:30:02.268079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2253e2af-79d6-4ac5-87a3-a82a1538772c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d46eea0>]}
[0m06:30:02.287754 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19450325, "process_user_time": 1.382007, "process_kernel_time": 0.118914, "process_mem_max_rss": "99528", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:30:02.288345 [debug] [MainThread]: Command `dbt clean` succeeded at 06:30:02.288238 after 0.20 seconds
[0m06:30:02.288784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0729c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429ce8e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d0a0bf0>]}
[0m06:30:02.289301 [debug] [MainThread]: Flushing usage events
[0m14:23:49.163601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe660e3fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe661165a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe660e3c530>]}


============================== 14:23:49.183794 | 6fcb0e2d-8671-4650-ab5c-863b7108a3fe ==============================
[0m14:23:49.183794 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:23:49.184519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:23:49.304027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fcb0e2d-8671-4650-ab5c-863b7108a3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6610587a0>]}
[0m14:23:49.318914 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4n746_35'
[0m14:23:49.319384 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:23:49.378706 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:23:49.379892 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:23:49.413167 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:23:49.418165 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:23:49.650497 [info ] [MainThread]: Installed from version 1.2.0
[0m14:23:49.651044 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:23:49.651588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6fcb0e2d-8671-4650-ab5c-863b7108a3fe', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe661022f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe660d91fa0>]}
[0m14:23:49.652074 [info ] [MainThread]: 
[0m14:23:49.652560 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:23:49.665204 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.55354255, "process_user_time": 1.616294, "process_kernel_time": 0.152121, "process_mem_max_rss": "101520", "process_in_blocks": "8496", "process_out_blocks": "5168"}
[0m14:23:49.665757 [debug] [MainThread]: Command `dbt deps` succeeded at 14:23:49.665653 after 0.55 seconds
[0m14:23:49.666197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe661165a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe66109d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6610587a0>]}
[0m14:23:49.666605 [debug] [MainThread]: Flushing usage events
[0m14:23:51.418817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e40affe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e36098b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e573e720>]}


============================== 14:23:51.421879 | 089af15a-11ef-4387-9db4-ed121fad36d5 ==============================
[0m14:23:51.421879 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:23:51.422609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:23:51.652160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '089af15a-11ef-4387-9db4-ed121fad36d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e5394a10>]}
[0m14:23:51.713339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '089af15a-11ef-4387-9db4-ed121fad36d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e418df70>]}
[0m14:23:51.714925 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:23:51.736237 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:23:51.736939 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:23:51.737502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '089af15a-11ef-4387-9db4-ed121fad36d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63dbf84da0>]}
[0m14:23:53.127518 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:23:53.128204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '089af15a-11ef-4387-9db4-ed121fad36d5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63db5186e0>]}
[0m14:23:53.361221 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:23:53.366506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '089af15a-11ef-4387-9db4-ed121fad36d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63db6c52e0>]}
[0m14:23:53.468166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '089af15a-11ef-4387-9db4-ed121fad36d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63db76e360>]}
[0m14:23:53.468673 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:23:53.469225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '089af15a-11ef-4387-9db4-ed121fad36d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63dbef84d0>]}
[0m14:23:53.471212 [info ] [MainThread]: 
[0m14:23:53.471893 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:23:53.476660 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:23:53.513133 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:23:53.513578 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:23:53.513972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:54.095730 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:23:54.097370 [debug] [ThreadPool]: On list_petro: Close
[0m14:23:54.098239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:23:54.098840 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:23:54.106720 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:23:54.107187 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:23:54.107569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:54.108686 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:23:54.110270 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:23:54.110759 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:23:54.111727 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:23:54.112262 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:23:54.112784 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:23:54.113582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:23:54.114545 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:23:54.115034 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:23:54.115412 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:23:54.116044 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:23:54.116452 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:23:54.117614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:23:54.123365 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:23:54.123767 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:23:54.124153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:54.124810 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:23:54.125224 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:23:54.125596 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:23:54.136046 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:23:54.137365 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:23:54.138542 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:23:54.138937 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:23:54.140079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '089af15a-11ef-4387-9db4-ed121fad36d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63db6c46e0>]}
[0m14:23:54.140689 [debug] [MainThread]: Using duckdb connection "master"
[0m14:23:54.141096 [debug] [MainThread]: On master: BEGIN
[0m14:23:54.141455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:23:54.142092 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:23:54.142493 [debug] [MainThread]: On master: COMMIT
[0m14:23:54.142864 [debug] [MainThread]: Using duckdb connection "master"
[0m14:23:54.143255 [debug] [MainThread]: On master: COMMIT
[0m14:23:54.143836 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:23:54.144258 [debug] [MainThread]: On master: Close
[0m14:23:54.144746 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:23:54.145272 [info ] [MainThread]: 
[0m14:23:54.166953 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:23:54.167550 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:23:54.168224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:23:54.168658 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:23:54.195232 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:23:54.195945 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:23:54.230780 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:23:54.231519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:04.077336 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:24:04.077871 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:24:04.078579 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:04.079046 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:24:04.079477 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:24:04.080450 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:04.081798 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:24:04.082260 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:24:04.083305 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:04.090034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:24:04.090491 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:24:04.091293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:04.094264 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:24:04.094704 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:24:04.095423 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:04.111905 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:24:04.112380 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:24:04.112794 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:24:04.115128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:04.120869 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:24:04.121354 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:24:04.122648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:04.125054 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:24:04.126558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '089af15a-11ef-4387-9db4-ed121fad36d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63a8ac6ab0>]}
[0m14:24:04.127261 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.96s]
[0m14:24:04.128026 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:24:04.129040 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:24:04.129587 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:24:04.130178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:24:04.130615 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:24:04.135525 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:24:04.136171 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:24:04.171763 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:24:04.172263 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260216142404165828"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:24:04.172709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:04.179625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:04.187004 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:24:04.187455 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:24:04.188110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:04.188556 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:24:04.188999 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260216142404165828'
      
      
      order by ordinal_position

  
[0m14:24:04.191410 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:04.196471 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:24:04.196934 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:24:04.199316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:04.208012 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:24:04.208479 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:24:04.211266 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:04.212939 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:24:04.213413 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:24:04.214156 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:04.231064 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:24:04.231709 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:24:04.232181 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260216142404165828"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260216142404165828"
    )
  
[0m14:24:04.244921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:04.246689 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:24:04.247142 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:24:04.247552 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:24:04.254110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:24:04.254945 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:24:04.255593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '089af15a-11ef-4387-9db4-ed121fad36d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63a8257b60>]}
[0m14:24:04.256258 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m14:24:04.256967 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:24:04.259425 [debug] [MainThread]: Using duckdb connection "master"
[0m14:24:04.259875 [debug] [MainThread]: On master: BEGIN
[0m14:24:04.260303 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:24:04.261016 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:24:04.261437 [debug] [MainThread]: On master: COMMIT
[0m14:24:04.261809 [debug] [MainThread]: Using duckdb connection "master"
[0m14:24:04.262197 [debug] [MainThread]: On master: COMMIT
[0m14:24:04.262772 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:24:04.263199 [debug] [MainThread]: On master: Close
[0m14:24:04.263666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:04.264065 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:24:04.264478 [info ] [MainThread]: 
[0m14:24:04.265019 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.79 seconds (10.79s).
[0m14:24:04.266042 [debug] [MainThread]: Command end result
[0m14:24:04.291077 [info ] [MainThread]: 
[0m14:24:04.291680 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:24:04.292229 [info ] [MainThread]: 
[0m14:24:04.292768 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:24:04.293773 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.927322, "process_user_time": 5.340881, "process_kernel_time": 0.251465, "process_mem_max_rss": "287092", "process_in_blocks": "1200", "process_out_blocks": "107384"}
[0m14:24:04.294356 [debug] [MainThread]: Command `dbt run` succeeded at 14:24:04.294251 after 12.93 seconds
[0m14:24:04.294776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e397ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e3a2b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e3a64140>]}
[0m14:24:04.295220 [debug] [MainThread]: Flushing usage events
[0m14:24:06.205844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392abbb7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392a16d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392abbb890>]}


============================== 14:24:06.208797 | 61002772-ec5d-4102-b168-27f42a87e6b8 ==============================
[0m14:24:06.208797 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:24:06.209497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:24:06.321563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61002772-ec5d-4102-b168-27f42a87e6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3929f4b590>]}
[0m14:24:06.339424 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18531905, "process_user_time": 1.339763, "process_kernel_time": 0.095911, "process_mem_max_rss": "99996", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:24:06.339964 [debug] [MainThread]: Command `dbt clean` succeeded at 14:24:06.339859 after 0.19 seconds
[0m14:24:06.340429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392a3d2f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3929dd3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392a16d9a0>]}
[0m14:24:06.340842 [debug] [MainThread]: Flushing usage events
[0m22:08:31.669949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23e46d02c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23e487bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23e455efc0>]}


============================== 22:08:31.690824 | 300b3cdf-38c3-41c0-8b2d-ace8de7ed591 ==============================
[0m22:08:31.690824 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:08:31.691533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:08:31.839099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '300b3cdf-38c3-41c0-8b2d-ace8de7ed591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23e540af00>]}
[0m22:08:31.854514 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vxux9zpq'
[0m22:08:31.855007 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:08:32.018607 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:08:32.019939 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:08:32.064198 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:08:32.069244 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:08:32.159840 [info ] [MainThread]: Installed from version 1.2.0
[0m22:08:32.160409 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:08:32.161007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '300b3cdf-38c3-41c0-8b2d-ace8de7ed591', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23e42a2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23e42a1070>]}
[0m22:08:32.161462 [info ] [MainThread]: 
[0m22:08:32.162016 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:08:32.163978 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.54582644, "process_user_time": 1.6776, "process_kernel_time": 0.14271, "process_mem_max_rss": "101364", "process_in_blocks": "8496", "process_out_blocks": "5168"}
[0m22:08:32.164524 [debug] [MainThread]: Command `dbt deps` succeeded at 22:08:32.164421 after 0.55 seconds
[0m22:08:32.164988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23e41f7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23e89bb980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23e41596d0>]}
[0m22:08:32.165485 [debug] [MainThread]: Flushing usage events
[0m22:08:33.769452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8d06d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8ce0ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8cda61b0>]}


============================== 22:08:33.772612 | 2cb2f98f-3d5e-4ead-bb83-079ed58871a4 ==============================
[0m22:08:33.772612 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:08:33.773345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:08:34.002792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cb2f98f-3d5e-4ead-bb83-079ed58871a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8e998830>]}
[0m22:08:34.063651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cb2f98f-3d5e-4ead-bb83-079ed58871a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8cc6e480>]}
[0m22:08:34.065351 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:08:34.081965 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:08:34.082680 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:08:34.083236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2cb2f98f-3d5e-4ead-bb83-079ed58871a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8c9c9550>]}
[0m22:08:35.490318 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:08:35.491014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2cb2f98f-3d5e-4ead-bb83-079ed58871a4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8c96caa0>]}
[0m22:08:35.741460 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:08:35.747217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cb2f98f-3d5e-4ead-bb83-079ed58871a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b84d85a90>]}
[0m22:08:35.837169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cb2f98f-3d5e-4ead-bb83-079ed58871a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b854b8bf0>]}
[0m22:08:35.837798 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:08:35.838340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cb2f98f-3d5e-4ead-bb83-079ed58871a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b84d775c0>]}
[0m22:08:35.840436 [info ] [MainThread]: 
[0m22:08:35.841200 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:08:35.846117 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:08:35.884665 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:08:35.885192 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:08:35.885578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:36.346216 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:36.347835 [debug] [ThreadPool]: On list_petro: Close
[0m22:08:36.348650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:08:36.349230 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:08:36.356776 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:36.357200 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:08:36.357574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:36.358807 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:36.360145 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:36.360537 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:08:36.361142 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:36.361526 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:36.361918 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:08:36.362523 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:36.363449 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:08:36.363874 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:36.364237 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:08:36.364868 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:36.365273 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:08:36.366507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:08:36.372516 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:08:36.372965 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:08:36.373330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:36.374083 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:36.374473 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:08:36.374898 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:08:36.386630 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:36.388173 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:08:36.389429 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:08:36.389884 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:08:36.391014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cb2f98f-3d5e-4ead-bb83-079ed58871a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b84d97620>]}
[0m22:08:36.391538 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:36.392002 [debug] [MainThread]: On master: BEGIN
[0m22:08:36.392387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:36.393237 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:36.393644 [debug] [MainThread]: On master: COMMIT
[0m22:08:36.394067 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:36.394431 [debug] [MainThread]: On master: COMMIT
[0m22:08:36.395091 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:36.395483 [debug] [MainThread]: On master: Close
[0m22:08:36.396039 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:08:36.396538 [info ] [MainThread]: 
[0m22:08:36.407235 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:08:36.407896 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:08:36.408595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:08:36.409061 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:08:36.437012 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:08:36.437887 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:08:36.473234 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:08:36.474103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:44.967479 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:44.968052 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:08:44.968805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:44.969249 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:44.969667 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:08:44.970635 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:44.971993 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:44.972437 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:08:44.973573 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:44.980304 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:44.980782 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:08:44.981542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:44.984471 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:44.984930 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:08:44.985650 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:45.002204 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:08:45.002667 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:45.003110 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:08:45.005296 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:45.010998 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:45.011451 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:08:45.012711 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:45.015103 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:08:45.016633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cb2f98f-3d5e-4ead-bb83-079ed58871a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b84d85460>]}
[0m22:08:45.017324 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.61s]
[0m22:08:45.018129 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:08:45.018974 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:08:45.019546 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:08:45.020314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:08:45.020807 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:08:45.025890 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:08:45.026533 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:08:45.062428 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:45.062938 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260216220845056398"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:08:45.063398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:45.070226 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:45.077633 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:45.078140 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:08:45.078805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:45.079239 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:45.079715 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260216220845056398'
      
      
      order by ordinal_position

  
[0m22:08:45.082215 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:45.087385 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:45.087861 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:08:45.090328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:45.099107 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:45.099573 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:08:45.101919 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:45.103616 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:45.104091 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:08:45.104853 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:45.122123 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:08:45.122830 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:45.123289 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260216220845056398"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260216220845056398"
    )
  
[0m22:08:45.133764 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:45.135496 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:08:45.135954 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:45.136360 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:08:45.143840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:45.144683 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:08:45.145347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cb2f98f-3d5e-4ead-bb83-079ed58871a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b49187920>]}
[0m22:08:45.146019 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m22:08:45.146790 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:08:45.148683 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:45.149135 [debug] [MainThread]: On master: BEGIN
[0m22:08:45.149512 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:08:45.150232 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:45.150629 [debug] [MainThread]: On master: COMMIT
[0m22:08:45.151058 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:45.151427 [debug] [MainThread]: On master: COMMIT
[0m22:08:45.152039 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:45.152432 [debug] [MainThread]: On master: Close
[0m22:08:45.152930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:45.153294 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:08:45.153701 [info ] [MainThread]: 
[0m22:08:45.154262 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.31 seconds (9.31s).
[0m22:08:45.155276 [debug] [MainThread]: Command end result
[0m22:08:45.180883 [info ] [MainThread]: 
[0m22:08:45.181494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:08:45.182042 [info ] [MainThread]: 
[0m22:08:45.182582 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:08:45.183591 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.46686, "process_user_time": 5.43425, "process_kernel_time": 0.289492, "process_mem_max_rss": "279092", "process_in_blocks": "1200", "process_out_blocks": "107424"}
[0m22:08:45.184155 [debug] [MainThread]: Command `dbt run` succeeded at 22:08:45.184054 after 11.47 seconds
[0m22:08:45.184591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8d06d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8cb33140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8d093860>]}
[0m22:08:45.185036 [debug] [MainThread]: Flushing usage events
[0m22:08:47.065253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed0f46420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ecfd34b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ecf2c5100>]}


============================== 22:08:47.068496 | 4d548cf2-778d-405a-8bbf-0a3a7baa2876 ==============================
[0m22:08:47.068496 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:08:47.069269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:08:47.183599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d548cf2-778d-405a-8bbf-0a3a7baa2876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ecf291d90>]}
[0m22:08:47.202517 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19070251, "process_user_time": 1.420716, "process_kernel_time": 0.101979, "process_mem_max_rss": "99612", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:08:47.203106 [debug] [MainThread]: Command `dbt clean` succeeded at 22:08:47.203000 after 0.19 seconds
[0m22:08:47.203551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ecf5eade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ecf11a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ecf18adb0>]}
[0m22:08:47.204004 [debug] [MainThread]: Flushing usage events
