[0m06:03:06.008204 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:06.009186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.009603 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.009990 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251119060305984631'
      
      
      order by ordinal_position

  
[0m06:03:06.012735 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.017942 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.018360 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:06.021191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.028429 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.028857 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:06.031460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.033031 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.033429 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:06.034110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.049220 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:06.049881 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.050280 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251119060305984631"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251119060305984631"
    )
  
[0m06:03:06.115440 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.117464 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:06.117919 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.118372 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:06.124483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.125419 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:06.126102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cde5f77f-5dfe-4b46-88d6-4f8cebaaf83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd64e594fe0>]}
[0m06:03:06.126764 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m06:03:06.127451 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:06.129001 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:06.129385 [debug] [MainThread]: On master: BEGIN
[0m06:03:06.129710 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:06.130449 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:06.130803 [debug] [MainThread]: On master: COMMIT
[0m06:03:06.131159 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:06.131471 [debug] [MainThread]: On master: COMMIT
[0m06:03:06.132067 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:06.132435 [debug] [MainThread]: On master: Close
[0m06:03:06.132881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:06.133205 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:06.133559 [info ] [MainThread]: 
[0m06:03:06.133999 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.66 seconds (9.66s).
[0m06:03:06.134829 [debug] [MainThread]: Command end result
[0m06:03:06.160214 [info ] [MainThread]: 
[0m06:03:06.160780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:06.161227 [info ] [MainThread]: 
[0m06:03:06.161596 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:06.162523 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.577324, "process_user_time": 4.874011, "process_kernel_time": 0.274831, "process_mem_max_rss": "327440", "process_in_blocks": "1200", "process_out_blocks": "107304"}
[0m06:03:06.163095 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:06.162998 after 11.58 seconds
[0m06:03:06.163503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd698135fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd698c1a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd648384c80>]}
[0m06:03:06.163908 [debug] [MainThread]: Flushing usage events
[0m06:03:07.861631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947eba2f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947fc083e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947fc0a930>]}


============================== 06:03:07.864866 | 021a097e-f851-4104-b01a-c27421e29f19 ==============================
[0m06:03:07.864866 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:07.865483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:03:07.965958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '021a097e-f851-4104-b01a-c27421e29f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947e0d2750>]}
[0m06:03:07.980671 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16507837, "process_user_time": 1.220228, "process_kernel_time": 0.074952, "process_mem_max_rss": "99364", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:03:07.981252 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:07.981160 after 0.17 seconds
[0m06:03:07.981632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94826d3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947df60c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947e4c0530>]}
[0m06:03:07.982029 [debug] [MainThread]: Flushing usage events
[0m14:06:02.650225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5672555430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5671efc2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5671efdca0>]}


============================== 14:06:02.665396 | 48da9350-70f4-4b6c-86b0-8d9b40083dce ==============================
[0m14:06:02.665396 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:02.666059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:02.847865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48da9350-70f4-4b6c-86b0-8d9b40083dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56722443e0>]}
[0m14:06:02.863425 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kmzgbmsj'
[0m14:06:02.863927 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:02.989852 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:02.991656 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:03.038294 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:03.043539 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:03.155624 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:03.156243 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:06:03.156803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '48da9350-70f4-4b6c-86b0-8d9b40083dce', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5672f63bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56731945f0>]}
[0m14:06:03.157294 [info ] [MainThread]: 
[0m14:06:03.157797 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:03.177816 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5785703, "process_user_time": 1.670071, "process_kernel_time": 0.149469, "process_mem_max_rss": "101120", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m14:06:03.178525 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:03.178385 after 0.58 seconds
[0m14:06:03.179079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5671e984d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56722443e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5672f63bf0>]}
[0m14:06:03.179638 [debug] [MainThread]: Flushing usage events
[0m14:06:04.763805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36ebd3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37023dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36efe6570>]}


============================== 14:06:04.766961 | a879ce7d-82e6-4cb8-83be-fcc809017ca1 ==============================
[0m14:06:04.766961 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:04.767641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:05.001229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36f2fce60>]}
[0m14:06:05.062310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36e0a0a40>]}
[0m14:06:05.064153 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:06:05.089401 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:05.090136 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:05.090664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa370af72f0>]}
[0m14:06:06.463942 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:06.464633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36600eb40>]}
[0m14:06:06.709894 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:06.715483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3661b7050>]}
[0m14:06:06.844227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa366850c80>]}
[0m14:06:06.844862 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:06:06.845373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36de2b0b0>]}
[0m14:06:06.847286 [info ] [MainThread]: 
[0m14:06:06.848016 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:06.852953 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:06.889930 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:06.890392 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:06.890804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:07.317231 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.319033 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:07.319954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:07.320533 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:07.328224 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:07.328662 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:07.329033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:07.330006 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.331292 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:07.331694 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:07.332307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.332709 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:07.333069 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:07.333701 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.334614 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:07.334995 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:07.335348 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:07.335928 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.336312 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:07.337606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:07.343549 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:07.343945 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:07.344303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:07.344969 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.345355 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:07.345771 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:07.356998 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.358450 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:07.359750 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:07.360158 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:07.362213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36602ad80>]}
[0m14:06:07.362751 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:07.363132 [debug] [MainThread]: On master: BEGIN
[0m14:06:07.363484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:07.364145 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:07.364562 [debug] [MainThread]: On master: COMMIT
[0m14:06:07.364936 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:07.365301 [debug] [MainThread]: On master: COMMIT
[0m14:06:07.365892 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:07.366279 [debug] [MainThread]: On master: Close
[0m14:06:07.366778 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:07.367248 [info ] [MainThread]: 
[0m14:06:07.388810 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:07.389608 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:07.390296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:07.390772 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:07.418017 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:07.418866 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:07.454283 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:07.455053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:15.646519 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.647083 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:15.647770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.648213 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.648666 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:15.649635 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.650994 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.651438 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:15.652493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.659274 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.659764 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:15.660830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.665051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.665514 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:15.666271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.683240 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:15.683724 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.684138 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:15.686113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.691915 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.692373 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:15.693638 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.696105 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:15.697621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3661b6720>]}
[0m14:06:15.698298 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.31s]
[0m14:06:15.699072 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:15.700220 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:15.700805 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:15.701402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:15.701931 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:15.706985 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:15.707659 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:15.743896 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.744396 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251119140615737863"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:15.744877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:15.751940 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.759490 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.759962 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:15.760621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.761051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.761475 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251119140615737863'
      
      
      order by ordinal_position

  
[0m14:06:15.763981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.769176 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.769646 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:15.772071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.779682 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.780141 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:15.782578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.784262 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.784726 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:06:15.785443 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.802588 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:15.803314 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.803783 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251119140615737863"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251119140615737863"
    )
  
[0m14:06:15.864829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.867154 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:15.867626 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.868035 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:15.874235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.875287 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:15.876086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3661dc2f0>]}
[0m14:06:15.876835 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:06:15.877604 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:15.879305 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:15.879751 [debug] [MainThread]: On master: BEGIN
[0m14:06:15.880129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:15.880907 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:15.881309 [debug] [MainThread]: On master: COMMIT
[0m14:06:15.881721 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:15.882084 [debug] [MainThread]: On master: COMMIT
[0m14:06:15.882682 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:15.883076 [debug] [MainThread]: On master: Close
[0m14:06:15.883574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:15.883944 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:15.884352 [info ] [MainThread]: 
[0m14:06:15.884882 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.04 seconds (9.04s).
[0m14:06:15.885876 [debug] [MainThread]: Command end result
[0m14:06:15.914456 [info ] [MainThread]: 
[0m14:06:15.915089 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:15.915607 [info ] [MainThread]: 
[0m14:06:15.916108 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:15.917219 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.204388, "process_user_time": 5.671275, "process_kernel_time": 0.284364, "process_mem_max_rss": "369444", "process_in_blocks": "1200", "process_out_blocks": "107288"}
[0m14:06:15.917839 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:15.917727 after 11.21 seconds
[0m14:06:15.918289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37023dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa344f67f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36e51bd40>]}
[0m14:06:15.918765 [debug] [MainThread]: Flushing usage events
[0m14:06:17.667653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56374d74a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5637e39d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563755be00>]}


============================== 14:06:17.670832 | e7a7d9a0-fad7-4c9e-afdc-84c8928b5281 ==============================
[0m14:06:17.670832 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:17.671561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:17.786458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7a7d9a0-fad7-4c9e-afdc-84c8928b5281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563755b0b0>]}
[0m14:06:17.805109 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18851323, "process_user_time": 1.334391, "process_kernel_time": 0.115947, "process_mem_max_rss": "99404", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:17.805802 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:17.805691 after 0.19 seconds
[0m14:06:17.806233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5637fd5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563755b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5637534200>]}
[0m14:06:17.806684 [debug] [MainThread]: Flushing usage events
[0m22:06:45.110829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949f7da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949a74b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9495a0050>]}


============================== 22:06:45.125425 | cc9f9267-01c5-435a-8161-1a81059cdac9 ==============================
[0m22:06:45.125425 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:45.126052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:45.272366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc9f9267-01c5-435a-8161-1a81059cdac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9495a0260>]}
[0m22:06:45.287454 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-g212j8i7'
[0m22:06:45.287919 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:45.381560 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:45.383031 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:45.417060 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:45.421677 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:45.512836 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:45.513382 [info ] [MainThread]: Updated version available: 1.3.2
[0m22:06:45.513878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cc9f9267-01c5-435a-8161-1a81059cdac9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949732f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94a605370>]}
[0m22:06:45.514349 [info ] [MainThread]: 
[0m22:06:45.514802 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:45.524056 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46460143, "process_user_time": 1.635375, "process_kernel_time": 0.130392, "process_mem_max_rss": "100928", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m22:06:45.524632 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:45.524528 after 0.47 seconds
[0m22:06:45.525058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949f7da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949a01a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94a7c2600>]}
[0m22:06:45.525499 [debug] [MainThread]: Flushing usage events
[0m22:06:47.110660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1037e8bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035f78dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035f7a180>]}


============================== 22:06:47.113819 | d717296a-b81a-4e0f-afb2-e4ce2efc7e02 ==============================
[0m22:06:47.113819 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:47.114473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:47.348083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035523440>]}
[0m22:06:47.409495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10359b68a0>]}
[0m22:06:47.411285 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:47.432269 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:47.432993 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:47.433562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10355c28a0>]}
[0m22:06:48.821772 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:48.822428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102dd06930>]}
[0m22:06:49.060347 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:49.065610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102d59eea0>]}
[0m22:06:49.159490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102dd445f0>]}
[0m22:06:49.160023 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:49.160566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035597500>]}
[0m22:06:49.162391 [info ] [MainThread]: 
[0m22:06:49.163069 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:49.167895 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:49.203694 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:49.204126 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:49.204536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:49.633325 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.635573 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:49.636727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:49.637563 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:49.647434 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.648045 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:49.648588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:49.649718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.651007 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.651421 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:49.651979 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.652382 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.652744 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:49.653410 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.654336 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:49.654730 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.655093 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:49.655696 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.656081 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:49.657286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:49.663035 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:49.663467 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:49.663825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:49.664487 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.664870 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:49.665272 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:49.676092 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.677566 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:49.678831 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:49.679253 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:49.681471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10372ddcd0>]}
[0m22:06:49.681976 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.682407 [debug] [MainThread]: On master: BEGIN
[0m22:06:49.682776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:49.683421 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.683814 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.684200 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.684564 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.685135 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.685548 [debug] [MainThread]: On master: Close
[0m22:06:49.686032 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:49.686526 [info ] [MainThread]: 
[0m22:06:49.696601 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:49.697218 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:49.697788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:49.698250 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:49.725626 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:49.726446 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:49.762086 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:49.762894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:58.836721 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.837316 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:58.838016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.838479 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.838905 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:58.839882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.841258 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.841699 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:58.843019 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.850012 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.850537 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:58.851499 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.856078 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.856554 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:58.857392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.874071 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:58.874566 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.874980 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:58.876657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.882514 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.882969 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:58.884456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.886920 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:58.888439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102c138c50>]}
[0m22:06:58.889114 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.19s]
[0m22:06:58.889955 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:58.890880 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:58.891540 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:58.892110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:58.892577 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:58.897594 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:58.898271 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:58.937547 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.938427 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251119220658928571"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:58.939120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:58.947850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.958006 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.958692 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:58.959542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.960111 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.960789 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251119220658928571'
      
      
      order by ordinal_position

  
[0m22:06:58.964373 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.970654 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.971347 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:58.974334 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.982275 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.982739 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:58.986049 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.988155 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.988775 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:06:58.989757 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:59.009042 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:59.009779 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:59.010268 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251119220658928571"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251119220658928571"
    )
  
[0m22:06:59.069130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:59.071128 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:59.071591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:59.072007 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:59.089851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:59.090810 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:59.091519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fe56e7c50>]}
[0m22:06:59.092208 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.20s]
[0m22:06:59.093104 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:59.094963 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:59.095417 [debug] [MainThread]: On master: BEGIN
[0m22:06:59.095802 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:59.096528 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:59.096931 [debug] [MainThread]: On master: COMMIT
[0m22:06:59.097378 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:59.097749 [debug] [MainThread]: On master: COMMIT
[0m22:06:59.098343 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:59.098744 [debug] [MainThread]: On master: Close
[0m22:06:59.099241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:59.099614 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:59.100008 [info ] [MainThread]: 
[0m22:06:59.100551 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.94 seconds (9.94s).
[0m22:06:59.101562 [debug] [MainThread]: Command end result
[0m22:06:59.128030 [info ] [MainThread]: 
[0m22:06:59.128639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:59.129118 [info ] [MainThread]: 
[0m22:06:59.129635 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:59.130588 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.071445, "process_user_time": 5.633693, "process_kernel_time": 0.315758, "process_mem_max_rss": "331856", "process_in_blocks": "1200", "process_out_blocks": "107328"}
[0m22:06:59.131139 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:59.131034 after 12.07 seconds
[0m22:06:59.131629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10356f8e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10359b47a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fe56cb350>]}
[0m22:06:59.132050 [debug] [MainThread]: Flushing usage events
[0m22:07:00.849516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa59b354f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa59527ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa594cd0a0>]}


============================== 22:07:00.852642 | aaa10c2d-7541-432c-ad5e-9376a450c0ac ==============================
[0m22:07:00.852642 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:00.853337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:00.969422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aaa10c2d-7541-432c-ad5e-9376a450c0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa58f57020>]}
[0m22:07:00.987844 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18902452, "process_user_time": 1.354442, "process_kernel_time": 0.104956, "process_mem_max_rss": "99392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:00.988415 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:00.988308 after 0.19 seconds
[0m22:07:00.988845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa5d6d3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa590a5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa58f6fbc0>]}
[0m22:07:00.989296 [debug] [MainThread]: Flushing usage events
[0m06:02:52.963025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b551fd4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b56a597f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b55fc3440>]}


============================== 06:02:52.975427 | b6315041-664c-4beb-8f51-7b44686fdedb ==============================
[0m06:02:52.975427 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:52.976097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:53.128221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6315041-664c-4beb-8f51-7b44686fdedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b54e3ade0>]}
[0m06:02:53.143838 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-t41c24x8'
[0m06:02:53.144323 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:53.180813 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:53.182591 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:53.215908 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:53.221315 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:53.473828 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:53.474417 [info ] [MainThread]: Updated version available: 1.3.2
[0m06:02:53.474966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b6315041-664c-4beb-8f51-7b44686fdedb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b54f50140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b55e011f0>]}
[0m06:02:53.475421 [info ] [MainThread]: 
[0m06:02:53.475925 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:53.486319 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.57421726, "process_user_time": 1.714649, "process_kernel_time": 0.150319, "process_mem_max_rss": "100944", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m06:02:53.486897 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:53.486790 after 0.57 seconds
[0m06:02:53.487326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b55fc3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b54c30c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b54c30830>]}
[0m06:02:53.487795 [debug] [MainThread]: Flushing usage events
[0m06:02:55.357852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c8635e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c7376000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c706ed80>]}


============================== 06:02:55.361149 | 129e2fa3-d541-4795-b67d-8cefb79b40f2 ==============================
[0m06:02:55.361149 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:55.361821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:55.601432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c6483ce0>]}
[0m06:02:55.664995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c82739e0>]}
[0m06:02:55.666945 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:02:55.688814 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:55.689585 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:55.690122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c6300800>]}
[0m06:02:57.101808 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:57.102480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c625f1d0>]}
[0m06:02:57.358216 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:57.364114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c76b2930>]}
[0m06:02:57.465772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bec29f10>]}
[0m06:02:57.466392 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:02:57.466962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38be5d4d40>]}
[0m06:02:57.468993 [info ] [MainThread]: 
[0m06:02:57.469759 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:57.474880 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:57.512954 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:57.513470 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:57.513898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:58.003362 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.005360 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:58.006362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:58.007061 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:58.016530 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:58.017127 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:58.017513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:58.019224 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.020686 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:58.021082 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:58.021693 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.022077 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:58.022435 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:58.023101 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.024051 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:58.024449 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:58.024840 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:58.025411 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.025840 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:58.027201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:58.033550 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:58.034016 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:58.034379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:58.035282 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.035705 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:58.036093 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:58.047512 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.049235 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:58.050554 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:58.050994 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:58.053290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38be41be60>]}
[0m06:02:58.053855 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:58.054249 [debug] [MainThread]: On master: BEGIN
[0m06:02:58.054616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:58.055397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:58.055837 [debug] [MainThread]: On master: COMMIT
[0m06:02:58.056220 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:58.056581 [debug] [MainThread]: On master: COMMIT
[0m06:02:58.057206 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:58.057605 [debug] [MainThread]: On master: Close
[0m06:02:58.058162 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:58.058701 [info ] [MainThread]: 
[0m06:02:58.078882 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:58.079582 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:58.080315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:58.080779 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:58.108863 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:58.109832 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:58.146876 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:58.147807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:08.287993 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.288570 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:08.289357 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.289831 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.290248 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:08.291337 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.292832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.293290 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:08.294419 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.301604 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.302130 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:08.303102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.307867 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.308351 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:08.309253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.326886 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:08.327452 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.327914 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:08.329698 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.337237 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.338053 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:08.341010 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.343718 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:08.345340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bd178e60>]}
[0m06:03:08.346096 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.26s]
[0m06:03:08.346992 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:08.348103 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:08.348707 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:08.349381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:08.349850 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:08.357126 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:08.358145 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:08.404398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.405007 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251120060308397904"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:08.405471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:08.412778 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.424442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.425221 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:08.426594 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.427072 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.427528 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251120060308397904'
      
      
      order by ordinal_position

  
[0m06:03:08.430592 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.436607 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.437132 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:08.439966 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.448468 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.449037 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:08.451964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.453851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.454310 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:08.455137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.476808 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:08.477619 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.478126 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251120060308397904"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251120060308397904"
    )
  
[0m06:03:08.543630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.545725 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:08.546221 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.546670 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:08.652440 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.653671 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:08.654510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3875d9a240>]}
[0m06:03:08.655279 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m06:03:08.656096 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:08.658097 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:08.658528 [debug] [MainThread]: On master: BEGIN
[0m06:03:08.658962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:08.659813 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:08.660241 [debug] [MainThread]: On master: COMMIT
[0m06:03:08.660632 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:08.661064 [debug] [MainThread]: On master: COMMIT
[0m06:03:08.661707 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:08.662121 [debug] [MainThread]: On master: Close
[0m06:03:08.662609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:08.663011 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:08.663416 [info ] [MainThread]: 
[0m06:03:08.663969 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.19 seconds (11.19s).
[0m06:03:08.664984 [debug] [MainThread]: Command end result
[0m06:03:08.692976 [info ] [MainThread]: 
[0m06:03:08.693661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:08.694200 [info ] [MainThread]: 
[0m06:03:08.694737 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:08.695766 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.390484, "process_user_time": 5.963643, "process_kernel_time": 0.314611, "process_mem_max_rss": "334412", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m06:03:08.696304 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:08.696201 after 13.39 seconds
[0m06:03:08.696787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38cabbb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c691b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c6940200>]}
[0m06:03:08.697251 [debug] [MainThread]: Flushing usage events
[0m06:03:10.830883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb169a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb26c2cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb26c2180>]}


============================== 06:03:10.834291 | 15d8f03c-c736-4b71-81f9-827f3ee84702 ==============================
[0m06:03:10.834291 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:10.834994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:10.966984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15d8f03c-c736-4b71-81f9-827f3ee84702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb1f7fc80>]}
[0m06:03:10.986505 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20906797, "process_user_time": 1.459182, "process_kernel_time": 0.107939, "process_mem_max_rss": "99560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:03:10.987108 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:10.986999 after 0.21 seconds
[0m06:03:10.987555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb1b423c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb1354380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb133d550>]}
[0m06:03:10.988038 [debug] [MainThread]: Flushing usage events
[0m14:05:53.179557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a58c7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a62117f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a5abe600>]}


============================== 14:05:53.191610 | 5a672e3c-23f6-4110-bc27-b90d7988f7aa ==============================
[0m14:05:53.191610 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:53.192305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:53.358203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a672e3c-23f6-4110-bc27-b90d7988f7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a56d7d70>]}
[0m14:05:53.373640 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-k_qvy3k2'
[0m14:05:53.374135 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:53.485516 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:53.486960 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:53.521317 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:53.525868 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:53.596609 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:53.597239 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:05:53.597813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5a672e3c-23f6-4110-bc27-b90d7988f7aa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a68d42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a543de80>]}
[0m14:05:53.598270 [info ] [MainThread]: 
[0m14:05:53.598792 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:53.607982 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4789139, "process_user_time": 1.630166, "process_kernel_time": 0.145461, "process_mem_max_rss": "100920", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m14:05:53.608518 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:53.608417 after 0.48 seconds
[0m14:05:53.608958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a5d89970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a68d42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a56d7d70>]}
[0m14:05:53.609364 [debug] [MainThread]: Flushing usage events
[0m14:05:55.230135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06390955b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06383d54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063839dee0>]}


============================== 14:05:55.233197 | d8802396-d66b-4a81-a57e-17063e595344 ==============================
[0m14:05:55.233197 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:55.233852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:55.464047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06382ad310>]}
[0m14:05:55.525264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06385a4ce0>]}
[0m14:05:55.526935 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:05:55.567943 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:55.568651 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:55.569182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06380ef2f0>]}
[0m14:05:56.991250 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:56.991891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06303d6a20>]}
[0m14:05:57.238909 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:57.246488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063876a930>]}
[0m14:05:57.383057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0630a96b40>]}
[0m14:05:57.383651 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:05:57.384226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06381e0260>]}
[0m14:05:57.386195 [info ] [MainThread]: 
[0m14:05:57.386979 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:57.391932 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:57.428666 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:57.429139 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:57.429529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:57.886792 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.888403 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:57.889298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:57.889886 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:57.897451 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:57.897890 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:57.898327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:57.899326 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.900649 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:57.901061 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:57.901645 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.902047 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:57.902410 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:57.903050 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.903979 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:57.904371 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:57.904755 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:57.905339 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.905758 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:57.907052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:57.913119 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:57.913515 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:57.913900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:57.914596 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.915014 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:57.915384 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:57.927360 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.928875 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:57.930122 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:57.930521 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:57.932595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0630a38bf0>]}
[0m14:05:57.933159 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:57.933539 [debug] [MainThread]: On master: BEGIN
[0m14:05:57.933932 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:57.934611 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:57.935045 [debug] [MainThread]: On master: COMMIT
[0m14:05:57.935418 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:57.935816 [debug] [MainThread]: On master: COMMIT
[0m14:05:57.936451 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:57.936878 [debug] [MainThread]: On master: Close
[0m14:05:57.937365 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:57.937848 [info ] [MainThread]: 
[0m14:05:57.956891 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:57.957476 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:57.958057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:57.958494 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:57.985553 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:57.986370 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:58.021870 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:58.022637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:05.384534 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.385116 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:05.385837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.386275 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.386714 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:05.387679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.389046 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.389483 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:05.390463 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.397278 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.397752 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:05.398481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.402677 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.403142 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:05.403862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.420336 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:05.420825 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.421329 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:05.423679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.429416 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.429888 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:05.431315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.433753 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:05.435261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062afaf620>]}
[0m14:06:05.435971 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.48s]
[0m14:06:05.436763 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:05.437774 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:05.438326 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:05.438938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:05.439367 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:05.444388 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:05.445054 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:05.481184 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.481674 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251120140605475122"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:05.482145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:05.489088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.496643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.497116 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:05.497775 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.498204 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.498613 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251120140605475122'
      
      
      order by ordinal_position

  
[0m14:06:05.501036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.506129 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.506585 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:05.508920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.516500 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.516987 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:05.519275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.520940 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.521379 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:06:05.522096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.539162 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:05.539869 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.540324 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251120140605475122"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251120140605475122"
    )
  
[0m14:06:05.601256 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.603275 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:05.603729 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.604140 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:05.609893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.610797 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:05.611479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06280cc5f0>]}
[0m14:06:05.612166 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:06:05.612912 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:05.614658 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:05.615094 [debug] [MainThread]: On master: BEGIN
[0m14:06:05.615461 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:05.616186 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:05.616582 [debug] [MainThread]: On master: COMMIT
[0m14:06:05.617012 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:05.617381 [debug] [MainThread]: On master: COMMIT
[0m14:06:05.617967 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:05.618356 [debug] [MainThread]: On master: Close
[0m14:06:05.618833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:05.619208 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:05.619602 [info ] [MainThread]: 
[0m14:06:05.620106 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.23 seconds (8.23s).
[0m14:06:05.621110 [debug] [MainThread]: Command end result
[0m14:06:05.647878 [info ] [MainThread]: 
[0m14:06:05.648476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:05.649003 [info ] [MainThread]: 
[0m14:06:05.649520 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:05.650514 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.470858, "process_user_time": 5.215342, "process_kernel_time": 0.274859, "process_mem_max_rss": "323848", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m14:06:05.651082 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:05.650977 after 10.47 seconds
[0m14:06:05.651510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063c8d3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063af6c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05e82976b0>]}
[0m14:06:05.651954 [debug] [MainThread]: Flushing usage events
[0m14:06:07.361218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28613bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff284665eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28384cd70>]}


============================== 14:06:07.364281 | c8511478-8494-47d2-bea8-498865bb57db ==============================
[0m14:06:07.364281 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:07.364951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:07.480396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8511478-8494-47d2-bea8-498865bb57db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff283e81f70>]}
[0m14:06:07.498954 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18795969, "process_user_time": 1.33182, "process_kernel_time": 0.106905, "process_mem_max_rss": "99312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:07.499502 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:07.499395 after 0.19 seconds
[0m14:06:07.499972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff287dbb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2838d36e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28364d4c0>]}
[0m14:06:07.500402 [debug] [MainThread]: Flushing usage events
