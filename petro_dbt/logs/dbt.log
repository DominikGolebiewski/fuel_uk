[0m21:00:20.944754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8eaa210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8fd2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e92fb1a0>]}


============================== 21:00:20.951955 | f918d5aa-2af2-4fe0-b7ab-caae99178f6b ==============================
[0m21:00:20.951955 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:00:20.952631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:00:21.098081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f918d5aa-2af2-4fe0-b7ab-caae99178f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8d13a70>]}
[0m21:00:21.111536 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-dtlheftm'
[0m21:00:21.112018 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:00:21.155754 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:00:21.156396 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:00:21.166432 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:00:21.170132 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:00:21.402208 [info ] [MainThread]: Installed from version 1.2.0
[0m21:00:21.402744 [info ] [MainThread]: Up to date!
[0m21:00:21.403302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f918d5aa-2af2-4fe0-b7ab-caae99178f6b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8c343b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8bef410>]}
[0m21:00:21.404681 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.50804603, "process_user_time": 1.591879, "process_kernel_time": 0.124616, "process_mem_max_rss": "93076", "process_in_blocks": "5672", "process_out_blocks": "3840"}
[0m21:00:21.405295 [debug] [MainThread]: Command `dbt deps` succeeded at 21:00:21.405188 after 0.51 seconds
[0m21:00:21.405748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8eaa210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e992caa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ea0491f0>]}
[0m21:00:21.406251 [debug] [MainThread]: Flushing usage events
[0m21:00:23.183919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dc1a81a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dd3d3380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dc392000>]}


============================== 21:00:23.186764 | 00c5cfc1-e684-49c0-906a-b29bb090025b ==============================
[0m21:00:23.186764 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:00:23.187445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:00:23.415213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dc0e4e90>]}
[0m21:00:23.474418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dda0f440>]}
[0m21:00:23.475204 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m21:00:23.490414 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:00:23.491149 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:00:23.491712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d57772c0>]}
[0m21:00:24.708884 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:00:24.709588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d5469220>]}
[0m21:00:24.900557 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:00:24.906640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d5220ef0>]}
[0m21:00:25.063637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d543c380>]}
[0m21:00:25.064219 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m21:00:25.064727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d52214f0>]}
[0m21:00:25.066451 [info ] [MainThread]: 
[0m21:00:25.067153 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:00:25.071859 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:00:25.106617 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:00:25.107072 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m21:00:25.107491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:25.533862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.535472 [debug] [ThreadPool]: On list_petro: Close
[0m21:00:25.537697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:00:25.538306 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:00:25.545170 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:00:25.545622 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m21:00:25.546028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:25.551669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.553004 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:00:25.553420 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:00:25.554355 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.554771 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:00:25.555167 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:00:25.555787 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.556728 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:00:25.557140 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:00:25.557531 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:00:25.558081 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.558543 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:00:25.560517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:00:25.565802 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:00:25.566260 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:00:25.566658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:25.571509 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.571938 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:00:25.572351 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m21:00:25.591753 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.596342 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:00:25.597519 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:00:25.597944 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:00:25.601025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d53af7a0>]}
[0m21:00:25.601552 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:25.601958 [debug] [MainThread]: On master: BEGIN
[0m21:00:25.602392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:25.607369 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:00:25.607801 [debug] [MainThread]: On master: COMMIT
[0m21:00:25.608202 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:25.608598 [debug] [MainThread]: On master: COMMIT
[0m21:00:25.609227 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:00:25.609645 [debug] [MainThread]: On master: Close
[0m21:00:25.611134 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:00:25.611651 [info ] [MainThread]: 
[0m21:00:25.629868 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:00:25.630538 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m21:00:25.631196 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m21:00:25.631652 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:00:25.657029 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:00:25.657774 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:00:25.691987 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:00:25.692737 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:00:37.006438 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.006974 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:00:37.007589 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.008051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.008503 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:00:37.009185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.011890 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.012361 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:00:37.013045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.033594 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:00:37.034080 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.034556 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:00:37.035771 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.040484 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.040979 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m21:00:37.042078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.044400 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:00:37.069529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dcc73530>]}
[0m21:00:37.070303 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.44s]
[0m21:00:37.071194 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:00:37.072178 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m21:00:37.072782 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m21:00:37.073387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m21:00:37.073844 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m21:00:37.078684 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m21:00:37.079322 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m21:00:37.112254 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.112768 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240621210037106502"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m21:00:37.113242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:37.127681 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.134525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.134996 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:00:37.135576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.136030 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.136477 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240621210037106502'
      
      
      order by ordinal_position

  
[0m21:00:37.162344 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.167218 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.167710 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:00:37.181680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.190310 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.190798 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:00:37.199027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.216831 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m21:00:37.217530 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.218011 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240621210037106502"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240621210037106502"
    )
  
[0m21:00:37.228272 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.230000 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:00:37.230512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.230950 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:00:37.239013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.239881 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m21:00:37.337164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a9155d60>]}
[0m21:00:37.337921 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.26s]
[0m21:00:37.338838 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m21:00:37.340252 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:37.340736 [debug] [MainThread]: On master: BEGIN
[0m21:00:37.341178 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:00:37.346468 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:00:37.346950 [debug] [MainThread]: On master: COMMIT
[0m21:00:37.347400 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:37.347832 [debug] [MainThread]: On master: COMMIT
[0m21:00:37.348517 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:00:37.348985 [debug] [MainThread]: On master: Close
[0m21:00:37.350436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:37.350885 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m21:00:37.351305 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m21:00:37.351781 [info ] [MainThread]: 
[0m21:00:37.352310 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.28 seconds (12.28s).
[0m21:00:37.353306 [debug] [MainThread]: Command end result
[0m21:00:37.380681 [info ] [MainThread]: 
[0m21:00:37.381296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:00:37.381810 [info ] [MainThread]: 
[0m21:00:37.382373 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:00:37.383343 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.24889, "process_user_time": 4.636834, "process_kernel_time": 0.333185, "process_mem_max_rss": "267884", "process_in_blocks": "1184", "process_out_blocks": "106080"}
[0m21:00:37.383989 [debug] [MainThread]: Command `dbt run` succeeded at 21:00:37.383881 after 14.25 seconds
[0m21:00:37.384482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dc8a5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dffbbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a92ff530>]}
[0m21:00:37.384977 [debug] [MainThread]: Flushing usage events
[0m21:03:40.897075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d6c7e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d6de24e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d90d1970>]}


============================== 21:03:41.039058 | 4ee9d8e9-8ad0-4fa2-8c2f-ebde5674a0c5 ==============================
[0m21:03:41.039058 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:03:41.039749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:03:41.183577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ee9d8e9-8ad0-4fa2-8c2f-ebde5674a0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d72db620>]}
[0m21:03:41.204192 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jpugovjm'
[0m21:03:41.204674 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:03:41.292975 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:03:41.293739 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:03:41.343759 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:03:41.347649 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:03:41.419490 [info ] [MainThread]: Installed from version 1.2.0
[0m21:03:41.420074 [info ] [MainThread]: Up to date!
[0m21:03:41.420722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4ee9d8e9-8ad0-4fa2-8c2f-ebde5674a0c5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d69d8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d7c9d160>]}
[0m21:03:41.422186 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5743885, "process_user_time": 1.673774, "process_kernel_time": 0.107344, "process_mem_max_rss": "93412", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m21:03:41.422796 [debug] [MainThread]: Command `dbt deps` succeeded at 21:03:41.422691 after 0.58 seconds
[0m21:03:41.423247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d70a1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d72db620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d6cc6030>]}
[0m21:03:41.423685 [debug] [MainThread]: Flushing usage events
[0m21:03:48.252082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ca83320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97d4d39b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ca83380>]}


============================== 21:03:48.254974 | 1aec2a5c-ad67-4921-bdce-de02a192cc9c ==============================
[0m21:03:48.254974 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:03:48.255634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:03:48.493316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ca128a0>]}
[0m21:03:48.556995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97d40c2c0>]}
[0m21:03:48.557920 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m21:03:48.573248 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:03:48.672329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:03:48.672812 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:03:48.678739 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:03:48.708459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97cab5490>]}
[0m21:03:48.811461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb975664b60>]}
[0m21:03:48.812056 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m21:03:48.812606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb975894890>]}
[0m21:03:48.814353 [info ] [MainThread]: 
[0m21:03:48.815109 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:03:48.819888 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:03:48.858279 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:03:48.858777 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m21:03:48.859191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:49.407276 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m21:03:49.408875 [debug] [ThreadPool]: On list_petro: Close
[0m21:03:49.411079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:03:49.411674 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:03:49.418628 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:49.419080 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m21:03:49.419505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:49.425044 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.426498 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:49.426921 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:03:49.427589 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.428007 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:49.428404 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:03:49.428984 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.429945 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:03:49.430358 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:49.430757 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:03:49.431403 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.431838 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:03:49.434039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:03:49.439375 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:03:49.439801 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:03:49.440190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:49.445060 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.445520 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:03:49.445932 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m21:03:49.465484 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.471882 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:03:49.473069 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:03:49.473539 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:03:49.477087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97e09d010>]}
[0m21:03:49.477646 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:49.478046 [debug] [MainThread]: On master: BEGIN
[0m21:03:49.478427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:03:49.483864 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:49.484302 [debug] [MainThread]: On master: COMMIT
[0m21:03:49.484700 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:49.485084 [debug] [MainThread]: On master: COMMIT
[0m21:03:49.485743 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:49.486160 [debug] [MainThread]: On master: Close
[0m21:03:49.487675 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:03:49.488187 [info ] [MainThread]: 
[0m21:03:49.497351 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:03:49.497998 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m21:03:49.498743 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m21:03:49.499201 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:03:49.525169 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:03:49.525842 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:03:49.560427 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:03:49.561093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:03:57.942719 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.943251 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:03:57.944049 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.944517 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.944968 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:03:57.945850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.948538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.949008 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:03:57.949746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.970495 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:03:57.970989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.971442 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:03:57.972624 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.977398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.977898 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m21:03:57.979033 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.981351 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:03:58.006795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97d7872c0>]}
[0m21:03:58.007594 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.51s]
[0m21:03:58.008394 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:03:58.009419 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m21:03:58.009992 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m21:03:58.010603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m21:03:58.011066 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m21:03:58.027087 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m21:03:58.027753 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m21:03:58.061144 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.061699 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240621210358055298"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m21:03:58.062193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:58.076717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.083942 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.084424 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:03:58.085036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.085526 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.085980 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240621210358055298'
      
      
      order by ordinal_position

  
[0m21:03:58.112161 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.117199 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.117746 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:03:58.126067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.134711 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.135209 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:03:58.144268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.162221 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m21:03:58.162913 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.163430 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240621210358055298"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240621210358055298"
    )
  
[0m21:03:58.173120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.174931 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:03:58.175394 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.175843 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:03:58.184638 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.185578 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m21:03:58.289503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb94918ae70>]}
[0m21:03:58.290341 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.28s]
[0m21:03:58.291215 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m21:03:58.292567 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:58.293054 [debug] [MainThread]: On master: BEGIN
[0m21:03:58.293538 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:03:58.298790 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:58.299279 [debug] [MainThread]: On master: COMMIT
[0m21:03:58.299731 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:58.300169 [debug] [MainThread]: On master: COMMIT
[0m21:03:58.300734 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:58.301201 [debug] [MainThread]: On master: Close
[0m21:03:58.302630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:58.303083 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m21:03:58.303503 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m21:03:58.303976 [info ] [MainThread]: 
[0m21:03:58.304538 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.49 seconds (9.49s).
[0m21:03:58.305627 [debug] [MainThread]: Command end result
[0m21:03:58.333134 [info ] [MainThread]: 
[0m21:03:58.333820 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:03:58.334371 [info ] [MainThread]: 
[0m21:03:58.334934 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:03:58.335956 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.135513, "process_user_time": 3.377523, "process_kernel_time": 0.335753, "process_mem_max_rss": "280980", "process_in_blocks": "1200", "process_out_blocks": "105520"}
[0m21:03:58.336600 [debug] [MainThread]: Command `dbt run` succeeded at 21:03:58.336490 after 10.14 seconds
[0m21:03:58.337097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97cef2ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ca83320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb94a31fc80>]}
[0m21:03:58.337616 [debug] [MainThread]: Flushing usage events
[0m21:04:00.088300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd45b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cce1b1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd4584d0>]}


============================== 21:04:00.091191 | 6d0ff847-f120-4914-a5f6-f2722a0cfeb4 ==============================
[0m21:04:00.091191 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:04:00.091844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:04:00.237635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d0ff847-f120-4914-a5f6-f2722a0cfeb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd5f0da0>]}
[0m21:04:00.254043 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21470842, "process_user_time": 1.465699, "process_kernel_time": 0.091855, "process_mem_max_rss": "92004", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m21:04:00.254629 [debug] [MainThread]: Command `dbt clean` succeeded at 21:04:00.254526 after 0.22 seconds
[0m21:04:00.255073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd2f78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd45bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd45b500>]}
[0m21:04:00.255512 [debug] [MainThread]: Flushing usage events
[0m15:09:37.490422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104326750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037ff170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046130b0>]}


============================== 15:09:37.493033 | fed66eda-7429-4c22-9306-2773c8f8ba2e ==============================
[0m15:09:37.493033 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:09:37.493378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:09:37.701277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fed66eda-7429-4c22-9306-2773c8f8ba2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d39e0>]}
[0m15:09:37.732645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fed66eda-7429-4c22-9306-2773c8f8ba2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10410b710>]}
[0m15:09:37.733444 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:09:37.744055 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path /Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/dbt_packages/dbt_utils/dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in /Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/dbt_packages/dbt_utils
[0m15:09:37.745972 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.29012808, "process_user_time": 0.71857, "process_kernel_time": 0.133344, "process_mem_max_rss": "107872256", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:09:37.746444 [debug] [MainThread]: Command `dbt run` failed at 15:09:37.746379 after 0.29 seconds
[0m15:09:37.746752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041faba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104799580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104798b00>]}
[0m15:09:37.746985 [debug] [MainThread]: Flushing usage events
[0m15:11:48.316480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106682660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e14560>]}


============================== 15:11:48.319149 | 77f6d568-f934-4241-9a39-46acf7cc7213 ==============================
[0m15:11:48.319149 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:11:48.319485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:11:48.526884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77f6d568-f934-4241-9a39-46acf7cc7213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052410d0>]}
[0m15:11:48.551648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77f6d568-f934-4241-9a39-46acf7cc7213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10527eae0>]}
[0m15:11:48.552292 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:11:48.562108 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path /Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/dbt_packages/dbt_utils/dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in /Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/dbt_packages/dbt_utils
[0m15:11:48.564109 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.28322184, "process_user_time": 0.708596, "process_kernel_time": 0.1308, "process_mem_max_rss": "111247360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:11:48.564589 [debug] [MainThread]: Command `dbt run` failed at 15:11:48.564524 after 0.28 seconds
[0m15:11:48.564849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cead80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b59a90>]}
[0m15:11:48.565067 [debug] [MainThread]: Flushing usage events
[0m15:11:54.543031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10392b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10392b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ed6de0>]}


============================== 15:11:54.545602 | 3b954267-3675-4fc1-b015-363c1e0e1a6b ==============================
[0m15:11:54.545602 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:11:54.545929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:11:54.616551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b954267-3675-4fc1-b015-363c1e0e1a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c25910>]}
[0m15:11:54.631811 [debug] [MainThread]: Set downloads directory='/var/folders/dk/sk1h93cx0q3c33j8g4dmjgv00000gn/T/dbt-downloads-xyw8jbi1'
[0m15:11:54.632064 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:11:55.702442 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:11:55.704402 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:11:56.434403 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:11:56.438891 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:11:59.160325 [info ] [MainThread]: Installed from version 1.2.0
[0m15:11:59.161137 [info ] [MainThread]: Up to date!
[0m15:11:59.161602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3b954267-3675-4fc1-b015-363c1e0e1a6b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f92ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f92a80>]}
[0m15:11:59.163820 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.652415, "process_user_time": 0.705097, "process_kernel_time": 0.138505, "process_mem_max_rss": "97337344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:11:59.164473 [debug] [MainThread]: Command `dbt deps` succeeded at 15:11:59.164339 after 4.65 seconds
[0m15:11:59.164866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a24170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10027eb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033acbf0>]}
[0m15:11:59.165072 [debug] [MainThread]: Flushing usage events
[0m15:13:09.032599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106402e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106277170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b3290>]}


============================== 15:13:09.035383 | e664f550-bc85-44c4-ad5a-c7c71702bd6f ==============================
[0m15:13:09.035383 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:13:09.035752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:13:09.247374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e16a0>]}
[0m15:13:09.272326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ca300>]}
[0m15:13:09.272923 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:13:09.284722 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m15:13:09.285285 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:13:09.285512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a5400>]}
[0m15:13:09.885184 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:13:09.885535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b40e60>]}
[0m15:13:09.969854 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m15:13:09.972457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af02c0>]}
[0m15:13:10.050179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4fb90>]}
[0m15:13:10.050476 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m15:13:10.050654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d05400>]}
[0m15:13:10.051470 [info ] [MainThread]: 
[0m15:13:10.051739 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:13:10.053922 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m15:13:10.083910 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m15:13:10.084159 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m15:13:10.084318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:10.104530 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.105947 [debug] [ThreadPool]: On list_petro: Close
[0m15:13:10.107472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m15:13:10.107760 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m15:13:10.111347 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m15:13:10.111593 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m15:13:10.111755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:10.116361 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.117148 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m15:13:10.117315 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m15:13:10.117520 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.117660 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m15:13:10.117795 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m15:13:10.118653 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.119073 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m15:13:10.119212 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m15:13:10.119339 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m15:13:10.119516 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.119659 [debug] [ThreadPool]: On create_petro_main: Close
[0m15:13:10.120848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m15:13:10.123664 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m15:13:10.123885 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m15:13:10.124044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:10.127868 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.128149 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m15:13:10.128325 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m15:13:10.148635 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.153407 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m15:13:10.154334 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m15:13:10.154491 [debug] [ThreadPool]: On list_petro_main: Close
[0m15:13:10.156347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f321b0>]}
[0m15:13:10.156569 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:10.156714 [debug] [MainThread]: On master: BEGIN
[0m15:13:10.156839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:13:10.160194 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:13:10.160373 [debug] [MainThread]: On master: COMMIT
[0m15:13:10.160518 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:10.160646 [debug] [MainThread]: On master: COMMIT
[0m15:13:10.160814 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:13:10.160952 [debug] [MainThread]: On master: Close
[0m15:13:10.161762 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m15:13:10.161990 [info ] [MainThread]: 
[0m15:13:10.164565 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m15:13:10.164948 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m15:13:10.165197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m15:13:10.165372 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m15:13:10.178046 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m15:13:10.178794 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m15:13:10.195526 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m15:13:10.196250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:24.320349 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m15:13:24.321075 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m15:13:24.321459 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.321663 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m15:13:24.321859 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m15:13:24.322487 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.324161 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m15:13:24.324364 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m15:13:24.324670 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.335159 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m15:13:24.335377 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m15:13:24.335549 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m15:13:24.335890 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.338125 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m15:13:24.338312 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m15:13:24.338844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.339989 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m15:13:24.360459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f840e0>]}
[0m15:13:24.360904 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 14.19s]
[0m15:13:24.361260 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m15:13:24.361753 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m15:13:24.362036 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m15:13:24.362327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m15:13:24.362523 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m15:13:24.364774 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m15:13:24.365217 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m15:13:24.383701 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.384018 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622151324380798"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m15:13:24.384219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:24.394708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.399847 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.400114 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m15:13:24.400402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.400567 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.400732 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622151324380798'
      
      
      order by ordinal_position

  
[0m15:13:24.424555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.427473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.427686 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m15:13:24.434920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.439018 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.439269 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m15:13:24.446567 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.454429 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m15:13:24.454898 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.455092 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622151324380798"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622151324380798"
    )
  
[0m15:13:24.462596 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.463477 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m15:13:24.463659 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.463816 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m15:13:24.469542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.469995 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m15:13:24.541486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcbba40>]}
[0m15:13:24.541958 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m15:13:24.542270 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m15:13:24.543125 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:24.543443 [debug] [MainThread]: On master: BEGIN
[0m15:13:24.543659 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:13:24.547559 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:13:24.547855 [debug] [MainThread]: On master: COMMIT
[0m15:13:24.548021 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:24.548172 [debug] [MainThread]: On master: COMMIT
[0m15:13:24.548386 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:13:24.548548 [debug] [MainThread]: On master: Close
[0m15:13:24.549479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:24.549632 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m15:13:24.549802 [info ] [MainThread]: 
[0m15:13:24.549978 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.50 seconds (14.50s).
[0m15:13:24.550370 [debug] [MainThread]: Command end result
[0m15:13:24.566291 [info ] [MainThread]: 
[0m15:13:24.566589 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:24.566761 [info ] [MainThread]: 
[0m15:13:24.566935 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:13:24.568379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.570353, "process_user_time": 3.690199, "process_kernel_time": 0.826286, "process_mem_max_rss": "211435520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:13:24.568669 [debug] [MainThread]: Command `dbt run` succeeded at 15:13:24.568627 after 15.57 seconds
[0m15:13:24.568846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d0e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdd3620>]}
[0m15:13:24.569020 [debug] [MainThread]: Flushing usage events
[0m13:48:02.872110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5a59e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5a69b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5a59e300>]}


============================== 13:48:02.879532 | 26a57913-33c6-45d9-888a-204e0fdddd7c ==============================
[0m13:48:02.879532 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:48:02.880223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:48:03.025567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26a57913-33c6-45d9-888a-204e0fdddd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5afc75c0>]}
[0m13:48:03.039315 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ss59q2_3'
[0m13:48:03.039799 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:48:03.084575 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:48:03.085337 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:48:03.095997 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:48:03.099769 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:48:03.255041 [info ] [MainThread]: Installed from version 1.2.0
[0m13:48:03.255669 [info ] [MainThread]: Up to date!
[0m13:48:03.256219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '26a57913-33c6-45d9-888a-204e0fdddd7c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5b5bc9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5b5bc9b0>]}
[0m13:48:03.282582 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45893046, "process_user_time": 1.595321, "process_kernel_time": 0.149315, "process_mem_max_rss": "93660", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m13:48:03.283384 [debug] [MainThread]: Command `dbt deps` succeeded at 13:48:03.283254 after 0.46 seconds
[0m13:48:03.283883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5a69b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5a9eac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5a2e4e90>]}
[0m13:48:03.284346 [debug] [MainThread]: Flushing usage events
[0m13:48:04.929008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a12e671d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a16471a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a14c18830>]}


============================== 13:48:04.932050 | 1285590a-ff38-43b1-acd3-650ae6316bae ==============================
[0m13:48:04.932050 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:48:04.932757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:48:05.173976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a153519a0>]}
[0m13:48:05.233939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a12d2a900>]}
[0m13:48:05.234870 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:48:05.250792 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:48:05.251580 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:48:05.252152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a12dd3590>]}
[0m13:48:06.473572 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:48:06.474274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a12c9ce60>]}
[0m13:48:06.668814 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m13:48:06.674075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0c024e30>]}
[0m13:48:06.838632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0be638f0>]}
[0m13:48:06.839229 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m13:48:06.839727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0be47200>]}
[0m13:48:06.841479 [info ] [MainThread]: 
[0m13:48:06.842202 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:48:06.847077 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m13:48:06.883244 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m13:48:06.883771 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m13:48:06.884187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:07.361283 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.362821 [debug] [ThreadPool]: On list_petro: Close
[0m13:48:07.365062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m13:48:07.365629 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m13:48:07.372382 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:48:07.372829 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m13:48:07.373286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:07.378714 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.380079 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:48:07.380499 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m13:48:07.381357 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.381795 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:48:07.382192 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m13:48:07.382739 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.383669 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m13:48:07.384085 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:48:07.384479 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m13:48:07.385109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.385539 [debug] [ThreadPool]: On create_petro_main: Close
[0m13:48:07.387826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m13:48:07.393329 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m13:48:07.393763 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m13:48:07.394158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:07.399494 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.399947 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m13:48:07.400367 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m13:48:07.421052 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.426051 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m13:48:07.427320 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m13:48:07.427746 [debug] [ThreadPool]: On list_petro_main: Close
[0m13:48:07.431370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0be95fa0>]}
[0m13:48:07.431921 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:07.432340 [debug] [MainThread]: On master: BEGIN
[0m13:48:07.432752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:48:07.438170 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:48:07.438617 [debug] [MainThread]: On master: COMMIT
[0m13:48:07.439031 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:07.439428 [debug] [MainThread]: On master: COMMIT
[0m13:48:07.440067 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:48:07.440497 [debug] [MainThread]: On master: Close
[0m13:48:07.442251 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:48:07.442767 [info ] [MainThread]: 
[0m13:48:07.452082 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m13:48:07.452720 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m13:48:07.453433 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m13:48:07.453896 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m13:48:07.479487 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m13:48:07.480339 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m13:48:07.514726 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m13:48:07.515608 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:50:30.195058 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:50:30.195637 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m13:50:30.196583 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.197262 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:50:30.197747 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m13:50:30.198619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.201611 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:50:30.202112 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m13:50:30.202971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.223833 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m13:50:30.224338 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:50:30.224798 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m13:50:30.226062 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.230935 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:50:30.231421 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m13:50:30.232686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.235083 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m13:50:30.261136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0bfe43b0>]}
[0m13:50:30.261982 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 142.81s]
[0m13:50:30.262886 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m13:50:30.263919 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m13:50:30.264494 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m13:50:30.265199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m13:50:30.265678 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m13:50:30.270819 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m13:50:30.271480 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m13:50:30.305241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.305842 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622135030299232"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m13:50:30.306350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:30.323409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.331555 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.332105 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m13:50:30.332908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.333423 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.333888 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622135030299232'
      
      
      order by ordinal_position

  
[0m13:50:30.360782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.366447 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.366966 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m13:50:30.381424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.390629 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.391172 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m13:50:30.400633 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.419069 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m13:50:30.419855 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.420362 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622135030299232"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622135030299232"
    )
  
[0m13:50:30.432863 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.434801 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m13:50:30.435277 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.435725 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m13:50:30.444346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.445308 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m13:50:30.562363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69e00c3620>]}
[0m13:50:30.563210 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m13:50:30.563981 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m13:50:30.565328 [debug] [MainThread]: Using duckdb connection "master"
[0m13:50:30.565831 [debug] [MainThread]: On master: BEGIN
[0m13:50:30.566290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:30.571778 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:50:30.572288 [debug] [MainThread]: On master: COMMIT
[0m13:50:30.572744 [debug] [MainThread]: Using duckdb connection "master"
[0m13:50:30.573266 [debug] [MainThread]: On master: COMMIT
[0m13:50:30.573987 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:50:30.574460 [debug] [MainThread]: On master: Close
[0m13:50:30.576132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:30.576591 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m13:50:30.577057 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m13:50:30.577557 [info ] [MainThread]: 
[0m13:50:30.578110 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 2 minutes and 23.74 seconds (143.74s).
[0m13:50:30.579122 [debug] [MainThread]: Command end result
[0m13:50:30.606704 [info ] [MainThread]: 
[0m13:50:30.607401 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:50:30.607927 [info ] [MainThread]: 
[0m13:50:30.608461 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:50:30.609494 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 145.72975, "process_user_time": 4.790523, "process_kernel_time": 0.290696, "process_mem_max_rss": "267828", "process_in_blocks": "1184", "process_out_blocks": "107024"}
[0m13:50:30.610149 [debug] [MainThread]: Command `dbt run` succeeded at 13:50:30.610040 after 145.73 seconds
[0m13:50:30.610657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a12fe1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a13148da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69e0161b50>]}
[0m13:50:30.611155 [debug] [MainThread]: Flushing usage events
[0m13:50:32.401985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd37ad850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd2984b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd2c27a70>]}


============================== 13:50:32.404866 | dc83d47b-f8b6-4298-85e4-235e985099a8 ==============================
[0m13:50:32.404866 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:50:32.405654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:50:32.550954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc83d47b-f8b6-4298-85e4-235e985099a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd2c25700>]}
[0m13:50:32.569046 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21620041, "process_user_time": 1.406766, "process_kernel_time": 0.13226, "process_mem_max_rss": "92160", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m13:50:32.569664 [debug] [MainThread]: Command `dbt clean` succeeded at 13:50:32.569556 after 0.22 seconds
[0m13:50:32.570130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd4b1d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd261ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd26bd370>]}
[0m13:50:32.570580 [debug] [MainThread]: Flushing usage events
[0m14:05:22.048919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4d923e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4dd7a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4dd78860>]}


============================== 14:05:22.056871 | bf4b2954-f21c-454a-aeac-93659c33bd01 ==============================
[0m14:05:22.056871 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:22.057593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:22.209644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf4b2954-f21c-454a-aeac-93659c33bd01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4de03320>]}
[0m14:05:22.223440 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zc7qqx8u'
[0m14:05:22.223913 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:22.316534 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:22.317345 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:22.329167 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:22.333058 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:22.486762 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:22.487382 [info ] [MainThread]: Up to date!
[0m14:05:22.488001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bf4b2954-f21c-454a-aeac-93659c33bd01', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4d7b2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4e27d0a0>]}
[0m14:05:22.489456 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48974532, "process_user_time": 1.59689, "process_kernel_time": 0.136075, "process_mem_max_rss": "93524", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m14:05:22.490084 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:22.489975 after 0.49 seconds
[0m14:05:22.490608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4e3e3320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4d7b2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4d923d70>]}
[0m14:05:22.491069 [debug] [MainThread]: Flushing usage events
[0m14:05:24.128871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84401cf260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8440286cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844105c9b0>]}


============================== 14:05:24.132122 | efb0c34b-50ff-417e-9837-dd88c9566f79 ==============================
[0m14:05:24.132122 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:24.132811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:24.378766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843ffc2870>]}
[0m14:05:24.439329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844000d100>]}
[0m14:05:24.440270 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:24.479639 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:24.480399 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:24.480969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843ffc3a10>]}
[0m14:05:25.700506 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:25.701323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843947a390>]}
[0m14:05:25.896585 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:25.901864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843ffb0d40>]}
[0m14:05:26.040551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843913f470>]}
[0m14:05:26.041156 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:26.041695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8439158b00>]}
[0m14:05:26.043528 [info ] [MainThread]: 
[0m14:05:26.044310 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:26.049410 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:26.086618 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:26.087130 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:26.087541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:26.801583 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:26.803198 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:26.805402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:26.805977 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:26.812869 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:26.813316 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:26.813724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:26.819611 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.821040 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:26.821455 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:26.822115 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.822563 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:26.822962 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:26.823541 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.824476 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:26.824890 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:26.825279 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:26.825827 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.826301 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:26.828857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:26.834510 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:26.834954 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:26.835349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:26.840711 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.841139 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:26.841559 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:26.861346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.866306 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:26.867515 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:26.867937 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:26.871489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843913faa0>]}
[0m14:05:26.872029 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.872429 [debug] [MainThread]: On master: BEGIN
[0m14:05:26.872806 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:26.878070 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.878544 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.878942 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.879325 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.879951 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.880366 [debug] [MainThread]: On master: Close
[0m14:05:26.881980 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:26.882559 [info ] [MainThread]: 
[0m14:05:26.892123 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:26.892784 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:26.893557 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:26.894020 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:26.919676 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:26.920500 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:26.954890 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:26.955784 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:38.313032 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.313637 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:38.314670 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.315149 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.315600 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:38.316378 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.319426 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.319903 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:38.320631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.341828 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:38.342464 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.342931 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:38.344678 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.349844 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.350369 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:38.351628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.354099 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:38.380458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840cb03dd0>]}
[0m14:05:38.381330 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.49s]
[0m14:05:38.382272 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:38.383305 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:38.383896 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:38.384589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:38.385075 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:38.390388 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:38.391085 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:38.425319 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.425969 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622140538419200"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:38.426512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:38.442074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.449982 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.450540 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:38.451230 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.451693 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.452147 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622140538419200'
      
      
      order by ordinal_position

  
[0m14:05:38.479787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.485703 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.486310 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:38.494916 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.504388 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.504965 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:38.514638 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.533504 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:38.534362 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.534860 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622140538419200"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622140538419200"
    )
  
[0m14:05:38.547208 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.549333 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:38.549831 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.550339 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:38.559846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.560850 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:38.685294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840caae090>]}
[0m14:05:38.686169 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m14:05:38.686976 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:38.688457 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:38.688948 [debug] [MainThread]: On master: BEGIN
[0m14:05:38.689414 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:38.694999 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:38.695493 [debug] [MainThread]: On master: COMMIT
[0m14:05:38.695946 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:38.696384 [debug] [MainThread]: On master: COMMIT
[0m14:05:38.696947 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:38.697416 [debug] [MainThread]: On master: Close
[0m14:05:38.699058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:38.699516 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:38.699940 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:38.700439 [info ] [MainThread]: 
[0m14:05:38.701010 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.66 seconds (12.66s).
[0m14:05:38.702071 [debug] [MainThread]: Command end result
[0m14:05:38.730592 [info ] [MainThread]: 
[0m14:05:38.731340 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:38.731903 [info ] [MainThread]: 
[0m14:05:38.732476 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:38.733559 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.654432, "process_user_time": 4.813725, "process_kernel_time": 0.323309, "process_mem_max_rss": "274504", "process_in_blocks": "1184", "process_out_blocks": "107104"}
[0m14:05:38.734251 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:38.734114 after 14.66 seconds
[0m14:05:38.734781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84342467b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84405f4d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844013f6e0>]}
[0m14:05:38.735284 [debug] [MainThread]: Flushing usage events
[0m14:05:40.570780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4246f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4246ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4246eb10>]}


============================== 14:05:40.573651 | 81f8f104-bd44-4d0b-9ee1-e2a2749a72be ==============================
[0m14:05:40.573651 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:40.574369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:40.724535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81f8f104-bd44-4d0b-9ee1-e2a2749a72be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c42bb6d20>]}
[0m14:05:40.741317 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21956562, "process_user_time": 1.43797, "process_kernel_time": 0.108148, "process_mem_max_rss": "92124", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:40.741930 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:40.741826 after 0.22 seconds
[0m14:05:40.742422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4246d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4246ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c41adf680>]}
[0m14:05:40.742870 [debug] [MainThread]: Flushing usage events
[0m23:25:24.084505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d3a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df7110>]}


============================== 23:25:24.087361 | 7b8fee30-4d72-46c3-84ab-007b1cb39f55 ==============================
[0m23:25:24.087361 [info ] [MainThread]: Running with dbt=1.8.2
[0m23:25:24.087706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:25:24.291283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e77e30>]}
[0m23:25:24.316246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db2900>]}
[0m23:25:24.316873 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m23:25:24.328806 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m23:25:24.395738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:25:24.396000 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:25:24.398950 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m23:25:24.413147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080fb200>]}
[0m23:25:24.462738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10801b9b0>]}
[0m23:25:24.463030 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m23:25:24.463207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a6cb60>]}
[0m23:25:24.464078 [info ] [MainThread]: 
[0m23:25:24.464380 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:25:24.466460 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m23:25:24.496435 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m23:25:24.496677 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m23:25:24.496829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:25:24.513114 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.514140 [debug] [ThreadPool]: On list_petro: Close
[0m23:25:24.515549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m23:25:24.515774 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m23:25:24.519006 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:25:24.519180 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m23:25:24.519319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:25:24.523037 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.523944 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:25:24.524108 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m23:25:24.524291 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.524429 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:25:24.524564 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m23:25:24.525408 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.525810 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m23:25:24.525946 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:25:24.526070 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m23:25:24.526244 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.526382 [debug] [ThreadPool]: On create_petro_main: Close
[0m23:25:24.527584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m23:25:24.530230 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m23:25:24.530415 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m23:25:24.530559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:25:24.534104 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.534348 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m23:25:24.534512 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m23:25:24.553004 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.557476 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m23:25:24.558440 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m23:25:24.558593 [debug] [ThreadPool]: On list_petro_main: Close
[0m23:25:24.560550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593ed50>]}
[0m23:25:24.560822 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:24.560978 [debug] [MainThread]: On master: BEGIN
[0m23:25:24.561116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:25:24.564518 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:25:24.564705 [debug] [MainThread]: On master: COMMIT
[0m23:25:24.564853 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:24.564992 [debug] [MainThread]: On master: COMMIT
[0m23:25:24.565177 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:25:24.565319 [debug] [MainThread]: On master: Close
[0m23:25:24.566120 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m23:25:24.566297 [info ] [MainThread]: 
[0m23:25:24.568008 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m23:25:24.568278 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m23:25:24.568506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m23:25:24.568675 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m23:25:24.581338 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m23:25:24.582216 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m23:25:24.598371 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m23:25:24.598874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:34.226950 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:25:34.227500 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m23:25:34.227931 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.228175 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:25:34.228406 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m23:25:34.229078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.230915 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:25:34.231156 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m23:25:34.231513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.243319 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m23:25:34.243555 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:25:34.243745 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m23:25:34.244115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.246731 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:25:34.246944 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m23:25:34.247446 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.248744 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m23:25:34.269740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797d730>]}
[0m23:25:34.270147 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.70s]
[0m23:25:34.270454 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m23:25:34.270850 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m23:25:34.271118 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m23:25:34.271331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m23:25:34.271506 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m23:25:34.278959 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m23:25:34.279426 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m23:25:34.295242 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.295579 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622232534292421"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m23:25:34.295799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:34.306353 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.310918 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.311205 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m23:25:34.311550 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.311773 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.311961 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622232534292421'
      
      
      order by ordinal_position

  
[0m23:25:34.335688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.339348 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.339610 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m23:25:34.348170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.353324 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.353697 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m23:25:34.362878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.372857 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m23:25:34.373487 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.373706 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622232534292421"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622232534292421"
    )
  
[0m23:25:34.385357 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.386485 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m23:25:34.386695 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.386869 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m23:25:34.395350 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.396101 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m23:25:34.471562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c3adbb0>]}
[0m23:25:34.471977 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.20s]
[0m23:25:34.472300 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m23:25:34.473033 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:34.473193 [debug] [MainThread]: On master: BEGIN
[0m23:25:34.473330 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:25:34.476762 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:25:34.476945 [debug] [MainThread]: On master: COMMIT
[0m23:25:34.477089 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:34.477221 [debug] [MainThread]: On master: COMMIT
[0m23:25:34.477395 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:25:34.477535 [debug] [MainThread]: On master: Close
[0m23:25:34.478346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:25:34.478534 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m23:25:34.478759 [info ] [MainThread]: 
[0m23:25:34.478959 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.01 seconds (10.01s).
[0m23:25:34.479384 [debug] [MainThread]: Command end result
[0m23:25:34.495957 [info ] [MainThread]: 
[0m23:25:34.496282 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:25:34.496452 [info ] [MainThread]: 
[0m23:25:34.496625 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:25:34.498504 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.448308, "process_user_time": 2.847289, "process_kernel_time": 1.129004, "process_mem_max_rss": "200294400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:25:34.498900 [debug] [MainThread]: Command `dbt run` succeeded at 23:25:34.498853 after 10.45 seconds
[0m23:25:34.499122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d3a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f80e0>]}
[0m23:25:34.499303 [debug] [MainThread]: Flushing usage events
[0m23:27:17.532882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10217c560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10403b1a0>]}


============================== 23:27:17.535623 | 4a1f0b10-ed61-49b9-a046-ad5e29b07e7f ==============================
[0m23:27:17.535623 [info ] [MainThread]: Running with dbt=1.8.2
[0m23:27:17.535963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:27:17.730839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a8f140>]}
[0m23:27:17.755780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035d91c0>]}
[0m23:27:17.756440 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m23:27:17.768364 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m23:27:17.842748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:27:17.843025 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:27:17.845923 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m23:27:17.859751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10440a600>]}
[0m23:27:17.905905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104319610>]}
[0m23:27:17.906195 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m23:27:17.906372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104531040>]}
[0m23:27:17.907192 [info ] [MainThread]: 
[0m23:27:17.907485 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:27:17.909598 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m23:27:17.939243 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m23:27:17.939497 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m23:27:17.939657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:17.955507 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.956840 [debug] [ThreadPool]: On list_petro: Close
[0m23:27:17.958222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m23:27:17.958492 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m23:27:17.961782 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:27:17.961971 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m23:27:17.962120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:17.965897 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.966603 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:27:17.966756 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m23:27:17.966942 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.967083 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:27:17.967219 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m23:27:17.967954 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.968391 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m23:27:17.968541 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:27:17.968686 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m23:27:17.968877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.969026 [debug] [ThreadPool]: On create_petro_main: Close
[0m23:27:17.970120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m23:27:17.972704 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m23:27:17.972871 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m23:27:17.973002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:17.976205 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.976395 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m23:27:17.976553 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m23:27:17.994614 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.998915 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m23:27:17.999921 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m23:27:18.000084 [debug] [ThreadPool]: On list_petro_main: Close
[0m23:27:18.002174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10431a5d0>]}
[0m23:27:18.002399 [debug] [MainThread]: Using duckdb connection "master"
[0m23:27:18.002537 [debug] [MainThread]: On master: BEGIN
[0m23:27:18.002667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:27:18.006070 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:27:18.006254 [debug] [MainThread]: On master: COMMIT
[0m23:27:18.006399 [debug] [MainThread]: Using duckdb connection "master"
[0m23:27:18.006528 [debug] [MainThread]: On master: COMMIT
[0m23:27:18.006701 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:27:18.006843 [debug] [MainThread]: On master: Close
[0m23:27:18.007702 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m23:27:18.007893 [info ] [MainThread]: 
[0m23:27:18.010794 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m23:27:18.011092 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m23:27:18.011323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m23:27:18.011496 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m23:27:18.023601 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m23:27:18.024479 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m23:27:18.040538 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m23:27:18.041154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:23.815456 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:27:23.815795 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m23:27:23.816166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.816396 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:27:23.816620 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m23:27:23.817271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.819191 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:27:23.819445 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m23:27:23.819845 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.831818 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m23:27:23.832065 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:27:23.832261 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m23:27:23.832651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.835415 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:27:23.835636 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m23:27:23.836135 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.837352 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m23:27:23.857617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a24ad0>]}
[0m23:27:23.858004 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 5.85s]
[0m23:27:23.858319 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m23:27:23.858735 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m23:27:23.859003 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m23:27:23.859229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m23:27:23.859408 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m23:27:23.866803 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m23:27:23.867530 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m23:27:23.883825 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.884104 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622232723881223"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m23:27:23.884293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:23.894631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.899285 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.899523 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m23:27:23.899836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.900010 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.900181 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622232723881223'
      
      
      order by ordinal_position

  
[0m23:27:23.923942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.927147 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.927405 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m23:27:23.936151 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.940492 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.940755 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m23:27:23.949191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.957226 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m23:27:23.957976 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.958176 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622232723881223"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622232723881223"
    )
  
[0m23:27:23.966119 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.967008 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m23:27:23.967199 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.967354 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m23:27:23.972733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.973165 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m23:27:24.048521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12719e240>]}
[0m23:27:24.048947 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.19s]
[0m23:27:24.049251 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m23:27:24.049820 [debug] [MainThread]: Using duckdb connection "master"
[0m23:27:24.050012 [debug] [MainThread]: On master: BEGIN
[0m23:27:24.050160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:27:24.055637 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:27:24.055859 [debug] [MainThread]: On master: COMMIT
[0m23:27:24.056158 [debug] [MainThread]: Using duckdb connection "master"
[0m23:27:24.056384 [debug] [MainThread]: On master: COMMIT
[0m23:27:24.056765 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:27:24.057048 [debug] [MainThread]: On master: Close
[0m23:27:24.058749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:24.059018 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m23:27:24.059554 [info ] [MainThread]: 
[0m23:27:24.059909 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 6.15 seconds (6.15s).
[0m23:27:24.060385 [debug] [MainThread]: Command end result
[0m23:27:24.076952 [info ] [MainThread]: 
[0m23:27:24.077296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:27:24.077486 [info ] [MainThread]: 
[0m23:27:24.077665 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:27:24.079797 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.584207, "process_user_time": 2.837844, "process_kernel_time": 1.169798, "process_mem_max_rss": "210436096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:27:24.080178 [debug] [MainThread]: Command `dbt run` succeeded at 23:27:24.080132 after 6.58 seconds
[0m23:27:24.080374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040adb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aec440>]}
[0m23:27:24.080569 [debug] [MainThread]: Flushing usage events
[0m21:29:00.982754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55eff2ed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ef98d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ef98cc80>]}


============================== 21:29:00.989637 | bcac8110-35a9-49a3-bb74-874deb3e44eb ==============================
[0m21:29:00.989637 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:29:00.990422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m21:29:01.135062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcac8110-35a9-49a3-bb74-874deb3e44eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ef915910>]}
[0m21:29:01.148296 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-10b7qqmu'
[0m21:29:01.148770 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:29:01.221818 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:29:01.222471 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:29:01.245152 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:29:01.248821 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:29:01.319243 [info ] [MainThread]: Installed from version 1.2.0
[0m21:29:01.319789 [info ] [MainThread]: Up to date!
[0m21:29:01.320381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bcac8110-35a9-49a3-bb74-874deb3e44eb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55eff2ed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ef8c2f00>]}
[0m21:29:01.321809 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38735923, "process_user_time": 1.571707, "process_kernel_time": 0.107161, "process_mem_max_rss": "93396", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m21:29:01.322425 [debug] [MainThread]: Command `dbt deps` succeeded at 21:29:01.322320 after 0.39 seconds
[0m21:29:01.322873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55efbc2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ef4f2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55eff2ed20>]}
[0m21:29:01.323313 [debug] [MainThread]: Flushing usage events
[0m21:29:02.882443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e83248200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e80f13bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e80f12540>]}


============================== 21:29:02.885154 | c0ff1444-ceb4-42bb-8df8-f349f625605e ==============================
[0m21:29:02.885154 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:29:02.885850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:29:03.117793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e809533e0>]}
[0m21:29:03.176885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e808f6870>]}
[0m21:29:03.177657 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m21:29:03.192879 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:29:03.193611 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:29:03.194200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e82688230>]}
[0m21:29:04.397405 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:29:04.398239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e79c7dd60>]}
[0m21:29:04.586705 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:29:04.591627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e79d041a0>]}
[0m21:29:04.714562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e815519a0>]}
[0m21:29:04.715116 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m21:29:04.715653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e80f2a930>]}
[0m21:29:04.717361 [info ] [MainThread]: 
[0m21:29:04.718086 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:29:04.722954 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:29:04.758087 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:29:04.758636 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m21:29:04.759044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:05.284124 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m21:29:05.285693 [debug] [ThreadPool]: On list_petro: Close
[0m21:29:05.287980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:29:05.288564 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:29:05.295448 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:29:05.295895 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m21:29:05.296298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:05.301827 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:29:05.303154 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:29:05.303574 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:29:05.304109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:29:05.304512 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:29:05.304901 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:29:05.305468 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:29:05.306424 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:29:05.306836 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:29:05.307228 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:29:05.307802 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:29:05.308279 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:29:05.310434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:29:05.315724 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:29:05.316149 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:29:05.316533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:05.321396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:29:05.321860 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:29:05.322275 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m21:29:05.342271 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:29:05.346959 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:29:05.348122 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:29:05.348539 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:29:05.351549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e82689670>]}
[0m21:29:05.352066 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:05.352464 [debug] [MainThread]: On master: BEGIN
[0m21:29:05.352841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:05.357798 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:29:05.358232 [debug] [MainThread]: On master: COMMIT
[0m21:29:05.358626 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:05.359008 [debug] [MainThread]: On master: COMMIT
[0m21:29:05.359648 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:29:05.360067 [debug] [MainThread]: On master: Close
[0m21:29:05.361468 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:29:05.362002 [info ] [MainThread]: 
[0m21:29:05.371057 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:29:05.371656 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m21:29:05.372312 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m21:29:05.372757 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:29:05.398576 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:29:05.399329 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:29:05.433705 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:29:05.434425 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:29:14.625821 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:29:14.626357 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:29:14.626965 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.627435 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:29:14.627879 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:29:14.628562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.631217 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:29:14.631682 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:29:14.632373 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.652822 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:29:14.653304 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:29:14.653778 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:29:14.654930 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.659595 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:29:14.660074 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m21:29:14.661196 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.663503 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:29:14.689005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e822c2570>]}
[0m21:29:14.689754 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.32s]
[0m21:29:14.690527 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:29:14.691504 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m21:29:14.692082 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m21:29:14.692662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m21:29:14.693124 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m21:29:14.697858 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m21:29:14.698494 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m21:29:14.731910 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.732458 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622212914726033"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m21:29:14.732946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:14.749640 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.756845 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.757349 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:29:14.758125 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.758586 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.759066 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622212914726033'
      
      
      order by ordinal_position

  
[0m21:29:14.785799 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.791168 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.791656 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:29:14.800235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.808939 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.809436 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:29:14.817547 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.835449 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m21:29:14.836159 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.836646 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622212914726033"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622212914726033"
    )
  
[0m21:29:14.845849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.847556 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:29:14.848017 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.848450 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:29:14.856936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.857878 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m21:29:14.993826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e4d4e80b0>]}
[0m21:29:14.994639 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m21:29:14.995375 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m21:29:14.996738 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:14.997225 [debug] [MainThread]: On master: BEGIN
[0m21:29:14.997669 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:29:15.003052 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:29:15.003531 [debug] [MainThread]: On master: COMMIT
[0m21:29:15.003973 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:15.004397 [debug] [MainThread]: On master: COMMIT
[0m21:29:15.004949 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:29:15.005409 [debug] [MainThread]: On master: Close
[0m21:29:15.006755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:15.007197 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m21:29:15.007612 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m21:29:15.008074 [info ] [MainThread]: 
[0m21:29:15.008669 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m21:29:15.009851 [debug] [MainThread]: Command end result
[0m21:29:15.037202 [info ] [MainThread]: 
[0m21:29:15.037922 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:29:15.038527 [info ] [MainThread]: 
[0m21:29:15.039137 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:29:15.040216 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.206544, "process_user_time": 4.680707, "process_kernel_time": 0.311514, "process_mem_max_rss": "282052", "process_in_blocks": "1184", "process_out_blocks": "108632"}
[0m21:29:15.040873 [debug] [MainThread]: Command `dbt run` succeeded at 21:29:15.040763 after 12.21 seconds
[0m21:29:15.041383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e83248200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e80a73740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e79ecb650>]}
[0m21:29:15.041918 [debug] [MainThread]: Flushing usage events
[0m21:29:16.672399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca445ef380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca445ef2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca44e701d0>]}


============================== 21:29:16.675184 | eb376c2d-6d86-4c48-8754-8569d6f316b7 ==============================
[0m21:29:16.675184 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:29:16.675834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:29:16.817476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb376c2d-6d86-4c48-8754-8569d6f316b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca4503d9a0>]}
[0m21:29:16.834002 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21008946, "process_user_time": 1.411492, "process_kernel_time": 0.111643, "process_mem_max_rss": "92148", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m21:29:16.834582 [debug] [MainThread]: Command `dbt clean` succeeded at 21:29:16.834479 after 0.21 seconds
[0m21:29:16.835023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca4488f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca448c4bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca456036e0>]}
[0m21:29:16.835460 [debug] [MainThread]: Flushing usage events
[0m22:06:09.742657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e531ed8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e52855580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e5162bd40>]}


============================== 22:06:09.789746 | 93ff7505-44b7-4915-9cb7-bd9e1dee6efa ==============================
[0m22:06:09.789746 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:09.790472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:09.933024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93ff7505-44b7-4915-9cb7-bd9e1dee6efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e520a5b80>]}
[0m22:06:09.946333 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5vp294jm'
[0m22:06:09.946797 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:10.006981 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:10.007654 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:10.017706 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:10.021545 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:10.068027 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:10.068570 [info ] [MainThread]: Up to date!
[0m22:06:10.069170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '93ff7505-44b7-4915-9cb7-bd9e1dee6efa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e51625520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e5138f8c0>]}
[0m22:06:10.084090 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38966253, "process_user_time": 1.566005, "process_kernel_time": 0.115852, "process_mem_max_rss": "93244", "process_in_blocks": "5672", "process_out_blocks": "3840"}
[0m22:06:10.084699 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:10.084596 after 0.39 seconds
[0m22:06:10.085169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e517d7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e553bbd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e51f430b0>]}
[0m22:06:10.085614 [debug] [MainThread]: Flushing usage events
[0m22:06:11.661192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46395a4e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4639c66cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463aaab3e0>]}


============================== 22:06:11.664082 | 156ace07-4859-4a70-bec2-f7b2bd5d3ed2 ==============================
[0m22:06:11.664082 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:11.664826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:11.890486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46395a5100>]}
[0m22:06:11.949285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463a604800>]}
[0m22:06:11.950037 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:06:11.964833 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:11.965573 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:11.966121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4639457f20>]}
[0m22:06:13.189916 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:13.190668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4632ba6f30>]}
[0m22:06:13.380217 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:13.385082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46328cfcb0>]}
[0m22:06:13.523254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4639467b60>]}
[0m22:06:13.523827 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:13.524315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463269aba0>]}
[0m22:06:13.526024 [info ] [MainThread]: 
[0m22:06:13.526716 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:13.531374 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:13.566296 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:13.566752 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:06:13.567157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:14.028870 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.030449 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:14.032805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:14.033441 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:14.040309 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:14.040760 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:06:14.041198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:14.046592 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.047915 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:14.048331 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:14.049204 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.049616 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:14.050014 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:14.050646 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.051588 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:14.052015 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:14.052407 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:14.052954 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.053419 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:14.055528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:14.060827 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:14.061292 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:14.061711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:14.066555 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.066980 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:14.067390 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:06:14.087188 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.091899 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:14.093068 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:14.093524 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:14.096579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463269bf20>]}
[0m22:06:14.097100 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:14.097545 [debug] [MainThread]: On master: BEGIN
[0m22:06:14.097997 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:14.103054 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:14.103482 [debug] [MainThread]: On master: COMMIT
[0m22:06:14.103877 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:14.104260 [debug] [MainThread]: On master: COMMIT
[0m22:06:14.104891 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:14.105339 [debug] [MainThread]: On master: Close
[0m22:06:14.106831 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:14.107376 [info ] [MainThread]: 
[0m22:06:14.122803 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:14.123407 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:14.124133 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:14.124585 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:14.150198 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:14.150941 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:14.185585 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:14.186321 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:21.662714 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.663249 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:21.664034 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.664508 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.664964 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:21.665699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.668372 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.668841 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:21.669590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.690287 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:21.690798 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.691251 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:21.692302 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.697040 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.697553 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:21.698665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.700967 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:21.726539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463a067410>]}
[0m22:06:21.727276 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.60s]
[0m22:06:21.728064 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:21.729058 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:21.729668 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:21.730280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:21.730750 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:21.735575 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:21.736233 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:21.769681 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.770197 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622220621763818"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:21.770683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:21.785052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.791967 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.792454 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:21.793076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.793557 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.794011 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622220621763818'
      
      
      order by ordinal_position

  
[0m22:06:21.826267 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.831132 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.831621 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:21.840128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.848512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.849009 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:21.858052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.875974 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:21.876655 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.877163 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622220621763818"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622220621763818"
    )
  
[0m22:06:21.888287 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.890022 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:21.890483 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.890919 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:21.899535 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.900399 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:22.040657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46065d0d10>]}
[0m22:06:22.041493 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m22:06:22.042265 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:22.043682 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:22.044178 [debug] [MainThread]: On master: BEGIN
[0m22:06:22.044628 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:22.049942 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:22.050426 [debug] [MainThread]: On master: COMMIT
[0m22:06:22.050876 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:22.051308 [debug] [MainThread]: On master: COMMIT
[0m22:06:22.051995 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:22.052462 [debug] [MainThread]: On master: Close
[0m22:06:22.053891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:22.054343 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:22.054766 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:22.055247 [info ] [MainThread]: 
[0m22:06:22.055854 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.53 seconds (8.53s).
[0m22:06:22.056974 [debug] [MainThread]: Command end result
[0m22:06:22.084552 [info ] [MainThread]: 
[0m22:06:22.085257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:22.085872 [info ] [MainThread]: 
[0m22:06:22.086482 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:22.087579 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.475895, "process_user_time": 4.714553, "process_kernel_time": 0.312169, "process_mem_max_rss": "281976", "process_in_blocks": "1184", "process_out_blocks": "108640"}
[0m22:06:22.088234 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:22.088123 after 10.48 seconds
[0m22:06:22.088736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463a7cf8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4632654530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4639a418e0>]}
[0m22:06:22.089276 [debug] [MainThread]: Flushing usage events
[0m22:06:23.706844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fdc16bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fdc16b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fdc17c80>]}


============================== 22:06:23.709561 | d6f4023d-19ad-44c3-ae46-0c6d2ecbe8d4 ==============================
[0m22:06:23.709561 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:23.710296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:23.850267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6f4023d-19ad-44c3-ae46-0c6d2ecbe8d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fe1b5c10>]}
[0m22:06:23.866690 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20847084, "process_user_time": 1.414527, "process_kernel_time": 0.104186, "process_mem_max_rss": "92248", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:23.867280 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:23.867177 after 0.21 seconds
[0m22:06:23.867730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fd4a7d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fd4a4bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fd02dac0>]}
[0m22:06:23.868172 [debug] [MainThread]: Flushing usage events
[0m06:02:10.216111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5af219b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aee71b6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aee71b6b0>]}


============================== 06:02:10.223290 | 0403180a-75f1-4c0d-b8ce-7f65668a4a69 ==============================
[0m06:02:10.223290 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.223965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.362641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0403180a-75f1-4c0d-b8ce-7f65668a4a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aef4d8aa0>]}
[0m06:02:10.375995 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-niwqi81k'
[0m06:02:10.376456 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.498711 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.499341 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.563712 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.567463 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.701618 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.702118 [info ] [MainThread]: Up to date!
[0m06:02:10.702709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0403180a-75f1-4c0d-b8ce-7f65668a4a69', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aee87af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aee3c6e70>]}
[0m06:02:10.704103 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.53657216, "process_user_time": 1.557671, "process_kernel_time": 0.107562, "process_mem_max_rss": "93644", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m06:02:10.704698 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:10.704594 after 0.54 seconds
[0m06:02:10.705134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5af21bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aee87af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5af1539bb0>]}
[0m06:02:10.705569 [debug] [MainThread]: Flushing usage events
[0m06:02:12.330110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe08d5b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe09850cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe09852000>]}


============================== 06:02:12.332878 | 1b304f64-eb2f-49f8-a398-8f57932b18d4 ==============================
[0m06:02:12.332878 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.333618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.561144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe08b34770>]}
[0m06:02:12.620178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe091876e0>]}
[0m06:02:12.620928 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:12.636153 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:12.636879 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:12.637438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe08a461e0>]}
[0m06:02:13.845663 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:13.846462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe01fb49e0>]}
[0m06:02:14.035549 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:14.040466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe020c50a0>]}
[0m06:02:14.171347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe01d011f0>]}
[0m06:02:14.171890 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:14.172432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe01eecef0>]}
[0m06:02:14.174128 [info ] [MainThread]: 
[0m06:02:14.174856 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.179555 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.214408 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.214917 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:14.215331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:14.716271 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:14.717841 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:14.720024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:14.720611 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:14.727540 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.727992 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:14.728409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.733932 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.735379 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.735803 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:14.736350 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.736762 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.737155 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:14.737727 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.738689 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.739109 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.739507 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.740116 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.740541 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:14.742661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:14.747966 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.748405 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:14.748795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.753661 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.754089 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.754528 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:14.774587 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.779286 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:14.780475 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:14.780903 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:14.783946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe01eab320>]}
[0m06:02:14.784477 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.784882 [debug] [MainThread]: On master: BEGIN
[0m06:02:14.785262 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:14.790255 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.790730 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.791133 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.791523 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.792166 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.792581 [debug] [MainThread]: On master: Close
[0m06:02:14.794018 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:14.794589 [info ] [MainThread]: 
[0m06:02:14.804036 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:14.804640 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:14.805386 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:14.805846 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:14.831265 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:14.832016 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:14.866103 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:14.866852 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:23.772403 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.772934 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:23.773556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.774030 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.774485 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:23.775359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.778005 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.778476 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:23.779198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.799851 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.800340 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.800795 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.801922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.806640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.807124 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:23.808623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.810950 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:23.836388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdd5e2e960>]}
[0m06:02:23.837103 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.03s]
[0m06:02:23.837883 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:23.838887 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:23.839474 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:23.840058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:23.840521 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:23.845260 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:23.845911 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:23.878774 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.879293 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240623060223872931"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:23.879784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:23.893993 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.900799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.901279 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:23.901867 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.902334 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.902830 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240623060223872931'
      
      
      order by ordinal_position

  
[0m06:02:23.929203 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.934006 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.934527 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.942907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.951217 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.951717 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.960145 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.978045 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:23.978749 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.979242 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240623060223872931"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240623060223872931"
    )
  
[0m06:02:23.988851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.990610 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:23.991084 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.991530 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:24.000097 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.001033 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:24.147387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdd5d67fe0>]}
[0m06:02:24.148164 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m06:02:24.148948 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:24.150330 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:24.150859 [debug] [MainThread]: On master: BEGIN
[0m06:02:24.151316 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:24.156647 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:24.157129 [debug] [MainThread]: On master: COMMIT
[0m06:02:24.157573 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:24.158003 [debug] [MainThread]: On master: COMMIT
[0m06:02:24.158725 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:24.159192 [debug] [MainThread]: On master: Close
[0m06:02:24.160581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:24.161024 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:24.161441 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:24.161911 [info ] [MainThread]: 
[0m06:02:24.162549 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.99 seconds (9.99s).
[0m06:02:24.163675 [debug] [MainThread]: Command end result
[0m06:02:24.191457 [info ] [MainThread]: 
[0m06:02:24.192142 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:24.192755 [info ] [MainThread]: 
[0m06:02:24.193366 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:24.194463 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.913357, "process_user_time": 4.674241, "process_kernel_time": 0.303366, "process_mem_max_rss": "268800", "process_in_blocks": "1184", "process_out_blocks": "109120"}
[0m06:02:24.195158 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:24.195047 after 11.91 seconds
[0m06:02:24.195654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe0cbbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdd65a51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbde889d100>]}
[0m06:02:24.196151 [debug] [MainThread]: Flushing usage events
[0m06:02:25.889204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f39b6e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f43ca930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f43caff0>]}


============================== 06:02:25.891976 | efd07a2c-8d4c-46d5-b64e-ee02f04a6cfd ==============================
[0m06:02:25.891976 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.892697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:26.035070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efd07a2c-8d4c-46d5-b64e-ee02f04a6cfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f3845880>]}
[0m06:02:26.051567 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21105623, "process_user_time": 1.410436, "process_kernel_time": 0.099889, "process_mem_max_rss": "92288", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:26.052151 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:26.052047 after 0.21 seconds
[0m06:02:26.052597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f5e2d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f37dac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f6ee9c40>]}
[0m06:02:26.053039 [debug] [MainThread]: Flushing usage events
[0m13:56:00.489779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112be3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112827170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e2f020>]}


============================== 13:56:00.492526 | 7dd3d873-9664-410d-b441-18792474801c ==============================
[0m13:56:00.492526 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:56:00.492875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:56:00.689703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a79cd0>]}
[0m13:56:00.714524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138d2d80>]}
[0m13:56:00.715153 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:56:00.727832 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:56:00.795680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:00.795930 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:00.798863 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m13:56:00.812528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a34050>]}
[0m13:56:00.859594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11135dac0>]}
[0m13:56:00.859886 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m13:56:00.860078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113865b20>]}
[0m13:56:00.860894 [info ] [MainThread]: 
[0m13:56:00.861199 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:56:00.863280 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m13:56:00.893700 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m13:56:00.893968 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m13:56:00.894131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:00.914475 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.916049 [debug] [ThreadPool]: On list_petro: Close
[0m13:56:00.918196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m13:56:00.918495 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m13:56:00.922330 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:56:00.922559 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m13:56:00.922702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:00.926584 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.927472 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:56:00.927628 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m13:56:00.927822 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.927962 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:56:00.928098 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m13:56:00.928663 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.929151 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m13:56:00.929313 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:56:00.929458 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m13:56:00.929692 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.929846 [debug] [ThreadPool]: On create_petro_main: Close
[0m13:56:00.931050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m13:56:00.933720 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m13:56:00.933885 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m13:56:00.934017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:00.937422 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.937604 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m13:56:00.937759 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m13:56:00.958877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.962748 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m13:56:00.963693 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m13:56:00.963856 [debug] [ThreadPool]: On list_petro_main: Close
[0m13:56:00.965866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a18c80>]}
[0m13:56:00.966094 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:00.966236 [debug] [MainThread]: On master: BEGIN
[0m13:56:00.966374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:00.969646 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:56:00.969822 [debug] [MainThread]: On master: COMMIT
[0m13:56:00.969966 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:00.970100 [debug] [MainThread]: On master: COMMIT
[0m13:56:00.970325 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:56:00.970502 [debug] [MainThread]: On master: Close
[0m13:56:00.971326 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:56:00.971538 [info ] [MainThread]: 
[0m13:56:00.973263 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m13:56:00.973530 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m13:56:00.973750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m13:56:00.973916 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m13:56:00.986331 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m13:56:00.987205 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m13:56:01.003723 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m13:56:01.004755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:20.995750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:56:20.996395 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m13:56:20.996847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:20.997080 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:56:20.997307 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m13:56:20.997984 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:20.999866 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:56:21.000108 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m13:56:21.000477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.012298 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m13:56:21.012550 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:56:21.012740 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m13:56:21.013108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.015727 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:56:21.015944 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m13:56:21.016479 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.018178 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m13:56:21.038883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f521370>]}
[0m13:56:21.039435 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 20.06s]
[0m13:56:21.039842 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m13:56:21.040613 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m13:56:21.040927 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m13:56:21.041159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m13:56:21.041339 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m13:56:21.051967 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m13:56:21.053844 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m13:56:21.076410 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.076796 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240623135621073585"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m13:56:21.077037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:21.088821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.094141 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.094461 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m13:56:21.094807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.094987 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.095166 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240623135621073585'
      
      
      order by ordinal_position

  
[0m13:56:21.118412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.121283 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.121513 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m13:56:21.129026 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.132965 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.133207 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m13:56:21.140504 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.148491 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m13:56:21.148977 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.149177 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240623135621073585"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240623135621073585"
    )
  
[0m13:56:21.159133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.160152 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m13:56:21.160416 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.160632 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m13:56:21.165279 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.165835 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m13:56:21.256095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f9c78f0>]}
[0m13:56:21.256534 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.21s]
[0m13:56:21.256839 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m13:56:21.257507 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:21.257717 [debug] [MainThread]: On master: BEGIN
[0m13:56:21.257869 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:21.261400 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:56:21.261592 [debug] [MainThread]: On master: COMMIT
[0m13:56:21.261745 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:21.261885 [debug] [MainThread]: On master: COMMIT
[0m13:56:21.262060 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:56:21.262206 [debug] [MainThread]: On master: Close
[0m13:56:21.262966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:21.263161 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m13:56:21.263368 [info ] [MainThread]: 
[0m13:56:21.263565 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 20.40 seconds (20.40s).
[0m13:56:21.263991 [debug] [MainThread]: Command end result
[0m13:56:21.292322 [info ] [MainThread]: 
[0m13:56:21.292687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:21.292870 [info ] [MainThread]: 
[0m13:56:21.293068 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:56:21.296161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.856356, "process_user_time": 2.826022, "process_kernel_time": 1.142126, "process_mem_max_rss": "182501376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:56:21.296731 [debug] [MainThread]: Command `dbt run` succeeded at 13:56:21.296671 after 20.86 seconds
[0m13:56:21.297005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f74d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11279c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112be3650>]}
[0m13:56:21.297216 [debug] [MainThread]: Flushing usage events
[0m11:58:03.241061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca8d42000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca7028e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca6f20aa0>]}


============================== 11:58:03.248191 | 1eb90afa-de04-46a2-8f11-f965027fdde1 ==============================
[0m11:58:03.248191 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:58:03.248843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:58:03.387580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1eb90afa-de04-46a2-8f11-f965027fdde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca76fb290>]}
[0m11:58:03.400796 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q8q_a93p'
[0m11:58:03.401262 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:58:03.475793 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:58:03.476414 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:58:03.499793 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:58:03.503426 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:58:03.573185 [info ] [MainThread]: Installed from version 1.2.0
[0m11:58:03.573685 [info ] [MainThread]: Up to date!
[0m11:58:03.574214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1eb90afa-de04-46a2-8f11-f965027fdde1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca6f20aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca7c9d5e0>]}
[0m11:58:03.575485 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3823983, "process_user_time": 1.540696, "process_kernel_time": 0.133096, "process_mem_max_rss": "93492", "process_in_blocks": "5672", "process_out_blocks": "3840"}
[0m11:58:03.576100 [debug] [MainThread]: Command `dbt deps` succeeded at 11:58:03.575997 after 0.38 seconds
[0m11:58:03.576545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca7303380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca6ae6030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca6cc69f0>]}
[0m11:58:03.576977 [debug] [MainThread]: Flushing usage events
[0m11:58:05.165675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfee55b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfd2cf5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfd2cf4d0>]}


============================== 11:58:05.168396 | bf957561-8e59-4507-a382-a636972b80b0 ==============================
[0m11:58:05.168396 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:58:05.169085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:58:05.392148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfe25bfe0>]}
[0m11:58:05.449554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfee55b50>]}
[0m11:58:05.450290 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:58:05.473658 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m11:58:05.474371 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:58:05.474936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfd0861e0>]}
[0m11:58:06.670941 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:58:06.671598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df5ecbbc0>]}
[0m11:58:06.856672 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m11:58:06.861302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df60c92e0>]}
[0m11:58:06.990655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df5c37260>]}
[0m11:58:06.991229 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m11:58:06.991678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df5c4ce60>]}
[0m11:58:06.993523 [info ] [MainThread]: 
[0m11:58:06.994244 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:58:06.998955 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m11:58:07.033522 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m11:58:07.033982 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m11:58:07.034397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:07.579526 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m11:58:07.581201 [debug] [ThreadPool]: On list_petro: Close
[0m11:58:07.583387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m11:58:07.584013 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m11:58:07.590857 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m11:58:07.591308 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m11:58:07.591750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:07.597130 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:07.598449 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m11:58:07.598862 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m11:58:07.599728 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:07.600148 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m11:58:07.600546 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m11:58:07.601103 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:07.602031 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m11:58:07.602446 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m11:58:07.602834 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m11:58:07.603493 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:07.603969 [debug] [ThreadPool]: On create_petro_main: Close
[0m11:58:07.605940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m11:58:07.611216 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m11:58:07.611645 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m11:58:07.612074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:07.616975 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:07.617400 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m11:58:07.617811 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m11:58:07.637819 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:07.642517 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m11:58:07.643720 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m11:58:07.644145 [debug] [ThreadPool]: On list_petro_main: Close
[0m11:58:07.647446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfd3ddb20>]}
[0m11:58:07.648031 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:07.648439 [debug] [MainThread]: On master: BEGIN
[0m11:58:07.648825 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:58:07.653862 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:58:07.654298 [debug] [MainThread]: On master: COMMIT
[0m11:58:07.654695 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:07.655092 [debug] [MainThread]: On master: COMMIT
[0m11:58:07.655773 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:58:07.656199 [debug] [MainThread]: On master: Close
[0m11:58:07.657626 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m11:58:07.658119 [info ] [MainThread]: 
[0m11:58:07.667133 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m11:58:07.667771 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m11:58:07.668404 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m11:58:07.668858 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m11:58:07.694087 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m11:58:07.694834 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m11:58:07.728838 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m11:58:07.729568 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:58:20.335240 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m11:58:20.335801 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m11:58:20.336428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.336900 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m11:58:20.337355 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m11:58:20.338047 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.340760 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m11:58:20.341236 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m11:58:20.342068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.362734 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m11:58:20.363224 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m11:58:20.363678 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m11:58:20.365395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.370101 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m11:58:20.370579 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m11:58:20.371669 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.373983 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m11:58:20.399880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfea8a720>]}
[0m11:58:20.400593 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.73s]
[0m11:58:20.401466 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m11:58:20.402433 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m11:58:20.403000 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m11:58:20.403668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m11:58:20.404174 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m11:58:20.408917 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m11:58:20.409552 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m11:58:20.442294 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.442816 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240623115820436510"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m11:58:20.443300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:20.459677 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.466558 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.467033 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m11:58:20.467619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.468102 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.468555 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240623115820436510'
      
      
      order by ordinal_position

  
[0m11:58:20.495043 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.499946 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.500439 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m11:58:20.508992 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.517430 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.517927 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m11:58:20.526518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.544346 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m11:58:20.545037 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.545534 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240623115820436510"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240623115820436510"
    )
  
[0m11:58:20.557811 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.559509 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m11:58:20.560010 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.560447 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m11:58:20.571229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.572157 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m11:58:20.730632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc9c15640>]}
[0m11:58:20.731428 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m11:58:20.732266 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m11:58:20.733591 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:20.734080 [debug] [MainThread]: On master: BEGIN
[0m11:58:20.734532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:58:20.739903 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:58:20.740397 [debug] [MainThread]: On master: COMMIT
[0m11:58:20.740851 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:20.741291 [debug] [MainThread]: On master: COMMIT
[0m11:58:20.741957 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:58:20.742431 [debug] [MainThread]: On master: Close
[0m11:58:20.743973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:20.744437 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m11:58:20.744862 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m11:58:20.745339 [info ] [MainThread]: 
[0m11:58:20.745910 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.75 seconds (13.75s).
[0m11:58:20.746956 [debug] [MainThread]: Command end result
[0m11:58:20.774554 [info ] [MainThread]: 
[0m11:58:20.775231 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:58:20.775816 [info ] [MainThread]: 
[0m11:58:20.776381 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:58:20.777407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.660628, "process_user_time": 4.667923, "process_kernel_time": 0.277183, "process_mem_max_rss": "276412", "process_in_blocks": "1184", "process_out_blocks": "109656"}
[0m11:58:20.778070 [debug] [MainThread]: Command `dbt run` succeeded at 11:58:20.777957 after 15.66 seconds
[0m11:58:20.778576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e00dbbd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df4971220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc9baa660>]}
[0m11:58:20.779075 [debug] [MainThread]: Flushing usage events
[0m11:58:22.396565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88f4261e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88ffb61e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88fb1ad20>]}


============================== 11:58:22.399237 | 001014b8-5f70-43ea-9342-46f2c47cca55 ==============================
[0m11:58:22.399237 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:58:22.399979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:58:22.547161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '001014b8-5f70-43ea-9342-46f2c47cca55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88f05b9b0>]}
[0m11:58:22.563649 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21528837, "process_user_time": 1.396306, "process_kernel_time": 0.112346, "process_mem_max_rss": "92296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:58:22.564278 [debug] [MainThread]: Command `dbt clean` succeeded at 11:58:22.564176 after 0.22 seconds
[0m11:58:22.564731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa892bbbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88ed820c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88f3774a0>]}
[0m11:58:22.565171 [debug] [MainThread]: Flushing usage events
[0m14:05:29.796131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9ea67d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9ee85b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9f4a6f60>]}


============================== 14:05:29.803199 | 2af7c019-afb8-4289-8b7b-019084e56bdf ==============================
[0m14:05:29.803199 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:29.803872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:29.948789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2af7c019-afb8-4289-8b7b-019084e56bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aa01f2030>]}
[0m14:05:29.962120 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x27b7apb'
[0m14:05:29.962588 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:30.034077 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:30.034720 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:30.044487 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:30.048221 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:30.109828 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:30.110333 [info ] [MainThread]: Up to date!
[0m14:05:30.110835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2af7c019-afb8-4289-8b7b-019084e56bdf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9e881970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9e83ffe0>]}
[0m14:05:30.112250 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.36413231, "process_user_time": 1.489832, "process_kernel_time": 0.191208, "process_mem_max_rss": "93560", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m14:05:30.112845 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:30.112741 after 0.36 seconds
[0m14:05:30.113313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9ebc41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9fb93fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9e993d70>]}
[0m14:05:30.113748 [debug] [MainThread]: Flushing usage events
[0m14:05:31.691401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d21eda00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d25f6300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d25f70e0>]}


============================== 14:05:31.694415 | c68646c2-0eb3-4fe2-812a-11c3169b7cd1 ==============================
[0m14:05:31.694415 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:31.695131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:31.930002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d1fe6a80>]}
[0m14:05:31.988327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d2613b90>]}
[0m14:05:31.989188 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:32.004814 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:32.005594 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:32.006140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d339c170>]}
[0m14:05:33.209653 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:33.210378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29cb4a4140>]}
[0m14:05:33.399606 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:33.404509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29cb2191c0>]}
[0m14:05:33.533715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29cb3a0230>]}
[0m14:05:33.534319 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:33.534855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29cb37c9b0>]}
[0m14:05:33.536609 [info ] [MainThread]: 
[0m14:05:33.537362 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:33.542145 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:33.577596 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:33.578096 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:33.578506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:34.131404 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:34.132949 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:34.135358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:34.135951 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:34.142804 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.143263 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:34.143678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:34.149251 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.150572 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.150980 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:34.151623 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.152028 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.152410 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:34.152991 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.153961 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:34.154372 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.154761 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:34.155296 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.155718 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:34.157860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:34.163067 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:34.163493 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:34.163877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:34.168890 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.169355 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:34.169770 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:34.189891 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.194471 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:34.195642 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:34.196062 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:34.199612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d228b290>]}
[0m14:05:34.200135 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.200539 [debug] [MainThread]: On master: BEGIN
[0m14:05:34.200925 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:34.206016 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.206445 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.206849 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.207237 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.207861 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.208282 [debug] [MainThread]: On master: Close
[0m14:05:34.210014 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:34.210510 [info ] [MainThread]: 
[0m14:05:34.219894 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:34.220506 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:34.221258 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:34.221714 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:34.246784 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:34.247536 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:34.281507 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:34.282275 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:49.959786 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:49.960314 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:49.960955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:49.961465 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:49.961918 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:49.962602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:49.965281 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:49.965757 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:49.966585 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:49.987406 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:49.987904 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:49.988354 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:49.989615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:49.994309 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:49.994794 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:49.995956 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:49.998291 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:50.023681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29c85113a0>]}
[0m14:05:50.024400 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 15.80s]
[0m14:05:50.025197 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:50.026184 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:50.026769 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:50.027343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:50.027818 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:50.032572 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:50.033250 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:50.066179 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.066696 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240623140550060382"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:50.067192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:50.083496 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.090343 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.090820 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:50.091471 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.091933 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.092385 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240623140550060382'
      
      
      order by ordinal_position

  
[0m14:05:50.124600 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.129429 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.129926 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:50.138615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.147176 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.147681 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:50.156039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.173814 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:50.174497 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.174977 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240623140550060382"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240623140550060382"
    )
  
[0m14:05:50.186742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.188430 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:50.188896 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.189398 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:50.198699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.199553 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:50.371415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299b1abdd0>]}
[0m14:05:50.372233 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m14:05:50.372984 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:50.374421 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:50.374911 [debug] [MainThread]: On master: BEGIN
[0m14:05:50.375369 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:50.380840 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:50.381374 [debug] [MainThread]: On master: COMMIT
[0m14:05:50.381832 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:50.382266 [debug] [MainThread]: On master: COMMIT
[0m14:05:50.382953 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:50.383426 [debug] [MainThread]: On master: Close
[0m14:05:50.384959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:50.385456 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:50.385881 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:50.386362 [info ] [MainThread]: 
[0m14:05:50.386970 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 16.85 seconds (16.85s).
[0m14:05:50.388079 [debug] [MainThread]: Command end result
[0m14:05:50.415657 [info ] [MainThread]: 
[0m14:05:50.416389 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:50.416998 [info ] [MainThread]: 
[0m14:05:50.417639 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:50.418721 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.775753, "process_user_time": 4.772354, "process_kernel_time": 0.284498, "process_mem_max_rss": "275324", "process_in_blocks": "1184", "process_out_blocks": "109664"}
[0m14:05:50.419376 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:50.419265 after 18.78 seconds
[0m14:05:50.419882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d21eda00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d2573860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299b1e05c0>]}
[0m14:05:50.420383 [debug] [MainThread]: Flushing usage events
[0m14:05:52.023911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8611d55eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86101cf290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86101cf200>]}


============================== 14:05:52.026652 | 600daa58-0ff4-4ca3-ad25-57516a1cc326 ==============================
[0m14:05:52.026652 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:52.027394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:52.168653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '600daa58-0ff4-4ca3-ad25-57516a1cc326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860ff63ce0>]}
[0m14:05:52.184747 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20914142, "process_user_time": 1.453116, "process_kernel_time": 0.064049, "process_mem_max_rss": "92168", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:52.185360 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:52.185253 after 0.21 seconds
[0m14:05:52.185806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86104d2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86101cf290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86101cf200>]}
[0m14:05:52.186256 [debug] [MainThread]: Flushing usage events
[0m22:05:10.780788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12309c56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1230c29f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12307061e0>]}


============================== 22:05:10.788164 | 79f1c0cb-6ce8-4e01-9d64-40024b480f62 ==============================
[0m22:05:10.788164 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:10.788840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:10.929923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79f1c0cb-6ce8-4e01-9d64-40024b480f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1230451df0>]}
[0m22:05:10.943268 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r2ucme2m'
[0m22:05:10.943737 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:11.013532 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:11.014144 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:11.035987 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:11.039603 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:11.108342 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:11.108886 [info ] [MainThread]: Up to date!
[0m22:05:11.109431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '79f1c0cb-6ce8-4e01-9d64-40024b480f62', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12305e58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f123028c230>]}
[0m22:05:11.110781 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.37822577, "process_user_time": 1.573308, "process_kernel_time": 0.108089, "process_mem_max_rss": "93624", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m22:05:11.111398 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:11.111295 after 0.38 seconds
[0m22:05:11.111838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1230503da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12303fc5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1230733e30>]}
[0m22:05:11.112270 [debug] [MainThread]: Flushing usage events
[0m22:05:12.717898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf83562ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf8189ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf81fb94c0>]}


============================== 22:05:12.720844 | b70b262e-57a4-43a4-a46b-a4f31efc8ff9 ==============================
[0m22:05:12.720844 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:12.721540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:12.952734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf8273f890>]}
[0m22:05:13.012558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf8273f890>]}
[0m22:05:13.013358 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:13.049057 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:13.049787 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:13.050337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf80dba270>]}
[0m22:05:14.259802 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:14.260484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf819cc740>]}
[0m22:05:14.451001 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:14.455983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf79f51730>]}
[0m22:05:14.583100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf79f34650>]}
[0m22:05:14.583709 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:14.584216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf79f96fc0>]}
[0m22:05:14.585909 [info ] [MainThread]: 
[0m22:05:14.586616 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:14.591572 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:14.626755 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:14.627254 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:14.627692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:15.274752 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:15.276436 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:15.278805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:15.279450 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:15.286444 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:15.286907 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:15.287368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:15.293215 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:15.294649 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:15.295075 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:15.295788 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:15.296208 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:15.296610 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:15.297200 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:15.298133 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:15.298572 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:15.298973 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:15.299678 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:15.300117 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:15.302351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:15.307833 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:15.308264 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:15.308657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:15.313602 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:15.314031 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:15.314450 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:15.334811 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:15.339509 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:15.340736 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:15.341162 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:15.344784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf81f6db20>]}
[0m22:05:15.345314 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:15.345726 [debug] [MainThread]: On master: BEGIN
[0m22:05:15.346114 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:15.351231 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:15.351678 [debug] [MainThread]: On master: COMMIT
[0m22:05:15.352082 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:15.352476 [debug] [MainThread]: On master: COMMIT
[0m22:05:15.353126 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:15.353551 [debug] [MainThread]: On master: Close
[0m22:05:15.355106 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:15.355689 [info ] [MainThread]: 
[0m22:05:15.364989 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:15.365619 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:15.366425 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:15.367153 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:15.394914 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:15.395787 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:15.430390 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:15.431259 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:25.010388 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.010928 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:25.013052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.013528 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.013980 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:25.014686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.017447 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.017923 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:25.018770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.039419 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:25.039913 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.040437 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:25.042365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.047182 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.047706 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:25.049361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.051713 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:25.078108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf700a2360>]}
[0m22:05:25.078973 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.71s]
[0m22:05:25.079822 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:25.080850 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:25.081457 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:25.082093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:25.082570 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:25.087861 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:25.088533 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:25.122123 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.122664 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240623220525116260"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:25.123159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:25.137825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.144957 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.145447 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:25.146071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.146537 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.146994 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240623220525116260'
      
      
      order by ordinal_position

  
[0m22:05:25.173611 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.178666 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.179165 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:25.187517 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.196218 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.196715 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:25.210974 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.228791 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:25.229511 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.229998 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240623220525116260"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240623220525116260"
    )
  
[0m22:05:25.241928 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.243771 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:25.244244 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.244700 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:25.254342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.255264 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:25.439558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4d894860>]}
[0m22:05:25.440447 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m22:05:25.441365 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:25.442819 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:25.443355 [debug] [MainThread]: On master: BEGIN
[0m22:05:25.443818 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:25.449299 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:25.449784 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.450233 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:25.450674 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.451405 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:25.451881 [debug] [MainThread]: On master: Close
[0m22:05:25.453420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:25.453876 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:25.454304 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:25.454786 [info ] [MainThread]: 
[0m22:05:25.455363 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.87 seconds (10.87s).
[0m22:05:25.456406 [debug] [MainThread]: Command end result
[0m22:05:25.484305 [info ] [MainThread]: 
[0m22:05:25.484960 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:25.485484 [info ] [MainThread]: 
[0m22:05:25.486017 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:25.487036 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.818917, "process_user_time": 4.771646, "process_kernel_time": 0.307719, "process_mem_max_rss": "282988", "process_in_blocks": "1184", "process_out_blocks": "110176"}
[0m22:05:25.487720 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:25.487608 after 12.82 seconds
[0m22:05:25.488236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf78c6e720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4d882180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4d8817c0>]}
[0m22:05:25.488742 [debug] [MainThread]: Flushing usage events
[0m22:05:27.197886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2c656d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2a999a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2a99be0>]}


============================== 22:05:27.200742 | cca7d8f3-1abe-4a23-a91b-55a8dc57f2a0 ==============================
[0m22:05:27.200742 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:27.201471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:27.345162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cca7d8f3-1abe-4a23-a91b-55a8dc57f2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2ae8ec0>]}
[0m22:05:27.361880 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21280985, "process_user_time": 1.422547, "process_kernel_time": 0.123873, "process_mem_max_rss": "92292", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:27.362490 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:27.362375 after 0.21 seconds
[0m22:05:27.362943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2884b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2886300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd1ffda60>]}
[0m22:05:27.363429 [debug] [MainThread]: Flushing usage events
[0m06:02:00.653671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f6de3a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f7283f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f6d53dd0>]}


============================== 06:02:00.661198 | 543961bf-a289-4072-9bda-21801dee755f ==============================
[0m06:02:00.661198 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:00.661956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:00.810563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '543961bf-a289-4072-9bda-21801dee755f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f6ca3050>]}
[0m06:02:00.824298 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nah4g3gi'
[0m06:02:00.824776 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:00.915608 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:00.916464 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:00.928787 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:00.932676 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:00.980795 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:00.981404 [info ] [MainThread]: Up to date!
[0m06:02:00.982013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '543961bf-a289-4072-9bda-21801dee755f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f6f0fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f6b4b0e0>]}
[0m06:02:00.983473 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.37835535, "process_user_time": 1.594632, "process_kernel_time": 0.144238, "process_mem_max_rss": "93552", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m06:02:00.984120 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:00.984011 after 0.38 seconds
[0m06:02:00.984575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f7e2ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f6b2b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fa2e9c40>]}
[0m06:02:00.985019 [debug] [MainThread]: Flushing usage events
[0m06:02:02.617297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108ae98980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1089ab2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1089798080>]}


============================== 06:02:02.620441 | 52801b4c-9882-47f3-a75a-7aa5aaeb9cbe ==============================
[0m06:02:02.620441 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:02.621258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:02.861859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1089777a40>]}
[0m06:02:02.921969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108965b3b0>]}
[0m06:02:02.922861 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:02.938779 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:02.939526 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:02.940115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1082d1e030>]}
[0m06:02:04.149093 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:04.149823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1082cd5a30>]}
[0m06:02:04.344676 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:04.349978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1082951730>]}
[0m06:02:04.509500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108282b0b0>]}
[0m06:02:04.510130 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:04.510706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1082844e60>]}
[0m06:02:04.512544 [info ] [MainThread]: 
[0m06:02:04.513316 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:04.518245 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:04.554486 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:04.555000 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:04.555421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:05.078477 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:05.080130 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:05.082393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:05.083015 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:05.090030 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.090485 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:05.090898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:05.096653 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.098071 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.098494 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:05.099184 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.099600 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.100067 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:05.100666 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.101601 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:05.102016 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.102415 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:05.102959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.103387 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:05.105543 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:05.111120 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:05.111554 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:05.111989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:05.117225 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.117658 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:05.118073 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:05.138445 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.143454 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:05.144681 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:05.145106 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:05.148525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1089b34170>]}
[0m06:02:05.149061 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:05.149467 [debug] [MainThread]: On master: BEGIN
[0m06:02:05.149851 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:05.155140 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:05.155589 [debug] [MainThread]: On master: COMMIT
[0m06:02:05.156033 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:05.156426 [debug] [MainThread]: On master: COMMIT
[0m06:02:05.157065 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:05.157486 [debug] [MainThread]: On master: Close
[0m06:02:05.159180 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:05.159726 [info ] [MainThread]: 
[0m06:02:05.169325 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:05.169963 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:05.170712 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:05.171169 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:05.197204 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:05.198007 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:05.232727 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:05.233569 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:12.048995 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:12.049561 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:12.050228 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.050701 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:12.051160 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:12.052096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.054978 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:12.055452 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:12.056368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.077194 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:12.077710 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:12.078173 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:12.079579 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.084522 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:12.085017 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:12.086343 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.088768 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:12.115776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10563df470>]}
[0m06:02:12.116647 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.94s]
[0m06:02:12.117483 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:12.118507 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:12.119117 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:12.119753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:12.120269 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:12.125574 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:12.126259 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:12.160159 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:12.160738 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240624060212154192"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:12.161250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:12.177208 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.185265 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:12.185832 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:12.186558 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.187039 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:12.187509 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240624060212154192'
      
      
      order by ordinal_position

  
[0m06:02:12.214548 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.220383 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:12.220926 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:12.229754 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.238967 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:12.239488 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:12.248748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.267096 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:12.267894 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:12.268396 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240624060212154192"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240624060212154192"
    )
  
[0m06:02:12.281902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.283963 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:12.284472 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:12.284938 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:12.294410 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.295361 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:12.478831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105614aab0>]}
[0m06:02:12.479768 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m06:02:12.480660 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:12.482277 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.482790 [debug] [MainThread]: On master: BEGIN
[0m06:02:12.483254 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:12.488950 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.489449 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.489904 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.490349 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.491060 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.491556 [debug] [MainThread]: On master: Close
[0m06:02:12.493384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:12.493838 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:12.494266 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:12.494763 [info ] [MainThread]: 
[0m06:02:12.495335 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.98 seconds (7.98s).
[0m06:02:12.496453 [debug] [MainThread]: Command end result
[0m06:02:12.525027 [info ] [MainThread]: 
[0m06:02:12.525730 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:12.526289 [info ] [MainThread]: 
[0m06:02:12.526864 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:12.527959 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.960196, "process_user_time": 4.884432, "process_kernel_time": 0.284958, "process_mem_max_rss": "288128", "process_in_blocks": "1184", "process_out_blocks": "110168"}
[0m06:02:12.528624 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:12.528510 after 9.96 seconds
[0m06:02:12.529329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1089872ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1056a1e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1082829640>]}
[0m06:02:12.529960 [debug] [MainThread]: Flushing usage events
[0m06:02:14.251099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bea19af00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bea44ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be955c110>]}


============================== 06:02:14.254074 | dceb43fc-f73c-4d0e-bfe4-47d5e9c7739f ==============================
[0m06:02:14.254074 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.254709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.400214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dceb43fc-f73c-4d0e-bfe4-47d5e9c7739f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be9ba2ff0>]}
[0m06:02:14.416769 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21444912, "process_user_time": 1.453364, "process_kernel_time": 0.079855, "process_mem_max_rss": "92280", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:14.417384 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:14.417278 after 0.22 seconds
[0m06:02:14.417840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be988d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be97d3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bea804560>]}
[0m06:02:14.418292 [debug] [MainThread]: Flushing usage events
[0m14:05:08.108772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cf3353050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cf3353b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cf283bdd0>]}


============================== 14:05:08.116922 | 665ef06c-78aa-4c88-b960-ee2929c41746 ==============================
[0m14:05:08.116922 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:08.117654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:08.355685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '665ef06c-78aa-4c88-b960-ee2929c41746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cf63bbd40>]}
[0m14:05:08.372704 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wop012c9'
[0m14:05:08.373438 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:08.430146 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:08.431433 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:08.445083 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:08.449944 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:08.505789 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:08.506610 [info ] [MainThread]: Up to date!
[0m14:05:08.507272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '665ef06c-78aa-4c88-b960-ee2929c41746', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cf2cf6870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cf2736ff0>]}
[0m14:05:08.509184 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45352206, "process_user_time": 2.071649, "process_kernel_time": 0.132232, "process_mem_max_rss": "93560", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m14:05:08.509899 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:08.509788 after 0.45 seconds
[0m14:05:08.510416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cf29f5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cf63bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cf63bbd10>]}
[0m14:05:08.510918 [debug] [MainThread]: Flushing usage events
[0m14:05:12.135533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d7721790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d66e2630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d5c4caa0>]}


============================== 14:05:12.140110 | 1fd57981-6756-4ce2-b4f4-452f138ca36a ==============================
[0m14:05:12.140110 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:12.141218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:12.429853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d715af00>]}
[0m14:05:12.497626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d6419c10>]}
[0m14:05:12.498906 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:12.517882 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:12.518890 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:12.519530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d5bca900>]}
[0m14:05:13.840047 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:13.840959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8cefcaf00>]}
[0m14:05:14.057176 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:14.064025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8cec93770>]}
[0m14:05:14.286692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8cecf3b90>]}
[0m14:05:14.287517 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:14.288169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d70b9fd0>]}
[0m14:05:14.290459 [info ] [MainThread]: 
[0m14:05:14.291521 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:14.298153 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:14.347952 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:14.348641 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:14.349136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:14.895475 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:14.897755 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:14.901289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:14.902160 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:14.910773 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.911423 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:14.911927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:14.918727 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.920494 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.920929 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:14.921678 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.922189 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.922612 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:14.923260 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.924299 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:14.924720 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.925114 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:14.925649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.926078 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:14.928950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:14.935168 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:14.935674 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:14.936120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:14.942372 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.942934 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:14.943383 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:14.964749 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.972190 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:14.973862 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:14.974452 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:14.980274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d6418e60>]}
[0m14:05:14.981028 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:14.981503 [debug] [MainThread]: On master: BEGIN
[0m14:05:14.981961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:14.989480 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:14.990184 [debug] [MainThread]: On master: COMMIT
[0m14:05:14.990678 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:14.991150 [debug] [MainThread]: On master: COMMIT
[0m14:05:14.991815 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:14.992325 [debug] [MainThread]: On master: Close
[0m14:05:14.995035 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:14.995685 [info ] [MainThread]: 
[0m14:05:15.007193 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:15.008185 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:15.009140 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:15.009715 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:15.040364 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:15.041379 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:15.081811 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:15.082905 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:23.046575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.047363 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:23.048703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.049355 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.049954 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:23.051016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.054674 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.055213 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:23.056484 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.080642 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:23.081385 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.081888 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:23.083529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.090944 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.091730 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:23.093641 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.097079 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:23.131360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ea7b890>]}
[0m14:05:23.132711 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.12s]
[0m14:05:23.133695 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:23.134968 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:23.135644 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:23.136425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:23.136933 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:23.143660 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:23.144808 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:23.183013 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.183722 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240624140523176509"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:23.184285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:23.203702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.212127 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.212790 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:23.213697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.214167 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.214619 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240624140523176509'
      
      
      order by ordinal_position

  
[0m14:05:23.247759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.255660 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.256462 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:23.268577 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.280591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.281255 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:23.291922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.313666 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:23.314679 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.315246 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240624140523176509"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240624140523176509"
    )
  
[0m14:05:23.329329 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.331661 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:23.332346 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.332828 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:23.346408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.347819 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:23.539420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89eab3fb0>]}
[0m14:05:23.540465 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.40s]
[0m14:05:23.541312 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:23.543342 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:23.544292 [debug] [MainThread]: On master: BEGIN
[0m14:05:23.544972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:23.552301 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:23.553051 [debug] [MainThread]: On master: COMMIT
[0m14:05:23.553631 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:23.554179 [debug] [MainThread]: On master: COMMIT
[0m14:05:23.555095 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:23.555644 [debug] [MainThread]: On master: Close
[0m14:05:23.558167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:23.558736 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:23.559216 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:23.559800 [info ] [MainThread]: 
[0m14:05:23.560489 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.27 seconds (9.27s).
[0m14:05:23.561624 [debug] [MainThread]: Command end result
[0m14:05:23.595489 [info ] [MainThread]: 
[0m14:05:23.596369 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:23.596928 [info ] [MainThread]: 
[0m14:05:23.597478 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:23.598604 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.520457, "process_user_time": 5.643769, "process_kernel_time": 0.385624, "process_mem_max_rss": "273568", "process_in_blocks": "1184", "process_out_blocks": "110648"}
[0m14:05:23.599302 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:23.599186 after 11.52 seconds
[0m14:05:23.599887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d5d0e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b3de3fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8cedebc50>]}
[0m14:05:23.600435 [debug] [MainThread]: Flushing usage events
[0m14:05:26.419065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72d456f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72d4a9e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72d409ae10>]}


============================== 14:05:26.422611 | 9b37b026-5bef-4a21-895b-6f3079381875 ==============================
[0m14:05:26.422611 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:26.423441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:26.622052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b37b026-5bef-4a21-895b-6f3079381875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72d519c9e0>]}
[0m14:05:26.644699 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.27845472, "process_user_time": 1.696782, "process_kernel_time": 0.119772, "process_mem_max_rss": "92040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:26.645527 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:26.645396 after 0.28 seconds
[0m14:05:26.646113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72d409b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72d4a9e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72d3fe1610>]}
[0m14:05:26.646699 [debug] [MainThread]: Flushing usage events
[0m22:06:34.120951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd074cf9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd073b1d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd073132750>]}


============================== 22:06:34.128696 | fc502711-3971-4a88-89b7-b8b176b37af6 ==============================
[0m22:06:34.128696 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:34.129470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:34.275237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc502711-3971-4a88-89b7-b8b176b37af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0734dd430>]}
[0m22:06:34.288929 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xikfdj4u'
[0m22:06:34.289483 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:34.428092 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:34.428844 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:34.440837 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:34.444601 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:34.493811 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:34.494411 [info ] [MainThread]: Up to date!
[0m22:06:34.495173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fc502711-3971-4a88-89b7-b8b176b37af6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd072e97aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd072e97d70>]}
[0m22:06:34.496771 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42490903, "process_user_time": 1.615261, "process_kernel_time": 0.131289, "process_mem_max_rss": "93560", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m22:06:34.497414 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:34.497307 after 0.43 seconds
[0m22:06:34.497872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd07312fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd072f9aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0734dd430>]}
[0m22:06:34.498308 [debug] [MainThread]: Flushing usage events
[0m22:06:36.143271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502c0648f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502c362000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502c066c90>]}


============================== 22:06:36.146200 | 848d815f-3df2-47ab-90b5-dfaa7f2feeed ==============================
[0m22:06:36.146200 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:36.146874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:36.378949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5024b2d100>]}
[0m22:06:36.439635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502b64a600>]}
[0m22:06:36.440552 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:06:36.455946 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:36.456681 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:36.457270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5024a195b0>]}
[0m22:06:37.664825 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:37.665600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502486a480>]}
[0m22:06:37.858520 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:37.866063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5024650200>]}
[0m22:06:37.990636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50248ec140>]}
[0m22:06:37.991231 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:37.991723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50247e38f0>]}
[0m22:06:37.993489 [info ] [MainThread]: 
[0m22:06:37.994205 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:37.999104 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:38.035221 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:38.035734 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:06:38.036149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:38.597064 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:38.598648 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:38.600864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:38.601457 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:38.608229 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:38.608672 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:06:38.609077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:38.614833 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:38.616170 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:38.616586 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:38.617455 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:38.617872 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:38.618268 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:38.618842 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:38.619769 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:38.620199 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:38.620599 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:38.621142 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:38.621619 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:38.623765 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:38.629270 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:38.629703 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:38.630098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:38.635277 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:38.635716 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:38.636125 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:06:38.656496 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:38.661470 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:38.662692 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:38.663109 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:38.667222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502463a390>]}
[0m22:06:38.667759 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:38.668162 [debug] [MainThread]: On master: BEGIN
[0m22:06:38.668548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:38.673913 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:38.674354 [debug] [MainThread]: On master: COMMIT
[0m22:06:38.674752 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:38.675135 [debug] [MainThread]: On master: COMMIT
[0m22:06:38.675784 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:38.676204 [debug] [MainThread]: On master: Close
[0m22:06:38.677854 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:38.678356 [info ] [MainThread]: 
[0m22:06:38.687685 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:38.688324 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:38.688981 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:38.689472 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:38.715176 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:38.716010 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:38.750829 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:38.751731 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:50.550761 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:50.551398 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:50.554702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.555197 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:50.555651 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:50.556602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.559546 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:50.560023 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:50.560790 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.581725 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:50.582255 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:50.582709 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:50.584365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.589303 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:50.589791 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:50.591081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.593493 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:50.620174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5024a2eb40>]}
[0m22:06:50.620993 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.93s]
[0m22:06:50.621817 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:50.622828 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:50.623428 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:50.624027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:50.624495 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:50.629723 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:50.630407 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:50.664554 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:50.665147 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240624220650658583"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:50.665658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:50.682506 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.689979 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:50.690478 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:50.691106 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.691566 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:50.692035 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240624220650658583'
      
      
      order by ordinal_position

  
[0m22:06:50.718661 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.723851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:50.724351 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:50.733055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.741965 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:50.742480 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:50.751888 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.770543 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:50.771385 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:50.771883 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240624220650658583"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240624220650658583"
    )
  
[0m22:06:50.785253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.787299 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:50.787780 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:50.788238 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:50.799797 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.800852 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:50.913269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ff8545280>]}
[0m22:06:50.914147 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.29s]
[0m22:06:50.915033 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:50.916480 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:50.916979 [debug] [MainThread]: On master: BEGIN
[0m22:06:50.917478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:50.923126 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:50.923630 [debug] [MainThread]: On master: COMMIT
[0m22:06:50.924086 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:50.924530 [debug] [MainThread]: On master: COMMIT
[0m22:06:50.925281 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:50.925761 [debug] [MainThread]: On master: Close
[0m22:06:50.927469 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:50.927926 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:50.928349 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:50.928840 [info ] [MainThread]: 
[0m22:06:50.929422 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.93 seconds (12.93s).
[0m22:06:50.930465 [debug] [MainThread]: Command end result
[0m22:06:50.959191 [info ] [MainThread]: 
[0m22:06:50.959901 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:50.960436 [info ] [MainThread]: 
[0m22:06:50.960967 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:50.962013 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.868215, "process_user_time": 4.793325, "process_kernel_time": 0.326727, "process_mem_max_rss": "283524", "process_in_blocks": "1184", "process_out_blocks": "105576"}
[0m22:06:50.962675 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:50.962561 after 14.87 seconds
[0m22:06:50.963189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502c362000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5024928c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502463ab10>]}
[0m22:06:50.963688 [debug] [MainThread]: Flushing usage events
[0m22:06:52.728559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41de21c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41de91b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41de232f0>]}


============================== 22:06:52.731573 | 37535ad6-40ae-43d2-b0fe-1a809f224ce8 ==============================
[0m22:06:52.731573 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:52.732333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:52.883718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37535ad6-40ae-43d2-b0fe-1a809f224ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41dbd0650>]}
[0m22:06:52.900740 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22148597, "process_user_time": 1.411532, "process_kernel_time": 0.135954, "process_mem_max_rss": "92156", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:52.901392 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:52.901279 after 0.22 seconds
[0m22:06:52.901853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41e1b2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41dc02c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41de566c0>]}
[0m22:06:52.902303 [debug] [MainThread]: Flushing usage events
[0m07:40:41.837141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106faab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084233e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108422c30>]}


============================== 07:40:41.839892 | 8c979e33-25f2-471d-8581-5ec05ac4114b ==============================
[0m07:40:41.839892 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:40:41.840229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:40:42.041136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c979e33-25f2-471d-8581-5ec05ac4114b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728d9d0>]}
[0m07:40:42.066190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c979e33-25f2-471d-8581-5ec05ac4114b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e45dc0>]}
[0m07:40:42.066827 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m07:40:42.079292 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:40:42.146500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:40:42.146746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:40:42.149655 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m07:40:42.163421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c979e33-25f2-471d-8581-5ec05ac4114b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108614b60>]}
[0m07:40:42.209720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c979e33-25f2-471d-8581-5ec05ac4114b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10885a8d0>]}
[0m07:40:42.210019 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m07:40:42.210196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c979e33-25f2-471d-8581-5ec05ac4114b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084fcb00>]}
[0m07:40:42.211031 [info ] [MainThread]: 
[0m07:40:42.211325 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:40:42.213399 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m07:40:42.244257 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m07:40:42.244526 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m07:40:42.244695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:40:42.262543 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:40:42.263876 [debug] [ThreadPool]: On list_petro: Close
[0m07:40:42.265293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m07:40:42.265564 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m07:40:42.268855 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:40:42.269041 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m07:40:42.269191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:40:42.273218 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:40:42.273919 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:40:42.274068 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m07:40:42.274263 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:40:42.274401 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:40:42.274535 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m07:40:42.275148 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:40:42.275550 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m07:40:42.275684 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:40:42.275806 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m07:40:42.275985 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:40:42.276122 [debug] [ThreadPool]: On create_petro_main: Close
[0m07:40:42.277246 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m07:40:42.279821 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m07:40:42.279987 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m07:40:42.280121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:40:42.283679 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:40:42.283888 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m07:40:42.284039 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m07:40:42.301920 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:40:42.306432 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m07:40:42.307390 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m07:40:42.307548 [debug] [ThreadPool]: On list_petro_main: Close
[0m07:40:42.309497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c979e33-25f2-471d-8581-5ec05ac4114b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c2510>]}
[0m07:40:42.309774 [debug] [MainThread]: Using duckdb connection "master"
[0m07:40:42.309927 [debug] [MainThread]: On master: BEGIN
[0m07:40:42.310065 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:40:42.313443 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:40:42.313627 [debug] [MainThread]: On master: COMMIT
[0m07:40:42.313772 [debug] [MainThread]: Using duckdb connection "master"
[0m07:40:42.313901 [debug] [MainThread]: On master: COMMIT
[0m07:40:42.314074 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:40:42.314212 [debug] [MainThread]: On master: Close
[0m07:40:42.315020 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m07:40:42.315200 [info ] [MainThread]: 
[0m07:40:42.317130 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m07:40:42.317437 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m07:40:42.317690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m07:40:42.317857 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m07:40:42.331045 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m07:40:42.332113 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m07:40:42.349185 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m07:40:42.349948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:40:52.475597 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:40:52.476053 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m07:40:52.476415 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.476630 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:40:52.476842 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m07:40:52.477643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.479425 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:40:52.479671 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m07:40:52.480035 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.491700 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m07:40:52.491937 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:40:52.492125 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m07:40:52.492509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.495195 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:40:52.495423 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m07:40:52.496020 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.497347 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m07:40:52.519540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c979e33-25f2-471d-8581-5ec05ac4114b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d4cb6b0>]}
[0m07:40:52.519937 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.20s]
[0m07:40:52.520258 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m07:40:52.520711 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m07:40:52.521006 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m07:40:52.521262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m07:40:52.521449 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m07:40:52.529515 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m07:40:52.530338 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m07:40:52.547050 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:40:52.547390 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240625074052544367"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m07:40:52.547595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:40:52.560404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.565652 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:40:52.565877 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m07:40:52.566159 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.566324 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:40:52.566485 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240625074052544367'
      
      
      order by ordinal_position

  
[0m07:40:52.589090 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.591897 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:40:52.592108 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m07:40:52.599321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.602992 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:40:52.603194 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m07:40:52.610430 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.618421 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m07:40:52.618861 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:40:52.619066 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240625074052544367"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240625074052544367"
    )
  
[0m07:40:52.628701 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.629543 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m07:40:52.629726 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:40:52.629884 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m07:40:52.634643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.635090 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m07:40:52.693783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c979e33-25f2-471d-8581-5ec05ac4114b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d40d820>]}
[0m07:40:52.694305 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m07:40:52.694649 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m07:40:52.695590 [debug] [MainThread]: Using duckdb connection "master"
[0m07:40:52.695784 [debug] [MainThread]: On master: BEGIN
[0m07:40:52.695935 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:40:52.700061 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:40:52.700295 [debug] [MainThread]: On master: COMMIT
[0m07:40:52.700454 [debug] [MainThread]: Using duckdb connection "master"
[0m07:40:52.700595 [debug] [MainThread]: On master: COMMIT
[0m07:40:52.700785 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:40:52.700935 [debug] [MainThread]: On master: Close
[0m07:40:52.701936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:40:52.702128 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m07:40:52.702319 [info ] [MainThread]: 
[0m07:40:52.702505 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.49 seconds (10.49s).
[0m07:40:52.702906 [debug] [MainThread]: Command end result
[0m07:40:52.719008 [info ] [MainThread]: 
[0m07:40:52.719280 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:40:52.719455 [info ] [MainThread]: 
[0m07:40:52.719629 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:40:52.721161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.919691, "process_user_time": 3.11396, "process_kernel_time": 0.78215, "process_mem_max_rss": "207339520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:40:52.721488 [debug] [MainThread]: Command `dbt run` succeeded at 07:40:52.721447 after 10.92 seconds
[0m07:40:52.721698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086a11f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e77f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d477d40>]}
[0m07:40:52.721873 [debug] [MainThread]: Flushing usage events
[0m06:02:13.176009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe725679b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe725ac7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe72567a090>]}


============================== 06:02:13.183691 | 56de5e40-84d4-4cc0-95b6-3d1ee1fec1ce ==============================
[0m06:02:13.183691 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:13.184370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.347411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56de5e40-84d4-4cc0-95b6-3d1ee1fec1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7254e3bf0>]}
[0m06:02:13.362484 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1xv8r8fi'
[0m06:02:13.363080 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:13.392340 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:13.393179 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:13.406237 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:13.410224 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:13.656237 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:13.656829 [info ] [MainThread]: Up to date!
[0m06:02:13.657398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '56de5e40-84d4-4cc0-95b6-3d1ee1fec1ce', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7254e2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7253c0380>]}
[0m06:02:13.658977 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5325097, "process_user_time": 1.628601, "process_kernel_time": 0.149154, "process_mem_max_rss": "93564", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m06:02:13.659605 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:13.659498 after 0.53 seconds
[0m06:02:13.660063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7255ebe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7254e1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe725a4b5f0>]}
[0m06:02:13.660508 [debug] [MainThread]: Flushing usage events
[0m06:02:18.908497 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m06:02:20.529266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6084277b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6082c37860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f608214c320>]}


============================== 06:02:20.532228 | fd1bfae7-e340-44f0-9d8c-14faa4721fae ==============================
[0m06:02:20.532228 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:20.532981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:20.777188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6082222000>]}
[0m06:02:20.839652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f608219c1d0>]}
[0m06:02:20.840652 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:20.857638 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:20.858543 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:20.859150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f608205deb0>]}
[0m06:02:22.085030 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:22.085803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f607b495f40>]}
[0m06:02:22.283626 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:22.289327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f607b3064e0>]}
[0m06:02:22.428208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f607b3045c0>]}
[0m06:02:22.428809 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:22.429306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f607b3b7ef0>]}
[0m06:02:22.431114 [info ] [MainThread]: 
[0m06:02:22.431848 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:22.436857 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:22.474646 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:22.475194 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:22.475623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:22.903341 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.904924 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:22.907326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:22.907946 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:22.915163 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.915693 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:22.916108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:22.922522 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.924155 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.924611 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:22.925194 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.925604 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.926015 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:22.926682 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.927667 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:22.928104 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.928504 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:22.929392 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.929836 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:22.932583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:22.938511 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.939044 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:22.939456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:22.945260 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.945766 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.946255 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:22.967343 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.973334 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:22.974759 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:22.975215 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:22.979300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60824cb5c0>]}
[0m06:02:22.979882 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.980317 [debug] [MainThread]: On master: BEGIN
[0m06:02:22.980705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:22.986319 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.986831 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.987254 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.987689 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.988236 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.988682 [debug] [MainThread]: On master: Close
[0m06:02:22.990572 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:22.991111 [info ] [MainThread]: 
[0m06:02:23.001159 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:23.001847 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:23.002619 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:23.003081 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:23.029663 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:23.030620 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:23.066339 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:23.067261 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:32.074808 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.075392 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:32.076370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.076846 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.077298 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:32.078230 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.081285 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.081766 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:32.082766 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.103876 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:32.104397 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.104850 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:32.106941 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.112035 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.112542 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:32.113785 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.116258 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:32.143204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604ac2a840>]}
[0m06:02:32.144050 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.14s]
[0m06:02:32.144834 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:32.145855 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:32.146473 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:32.147094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:32.147574 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:32.152764 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:32.153477 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:32.187445 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.188014 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240625060232181455"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:32.188499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:32.205219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.213019 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.213544 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:32.214386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.214858 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.215328 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240625060232181455'
      
      
      order by ordinal_position

  
[0m06:02:32.242477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.248087 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.248631 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:32.257481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.266740 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.267265 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:32.276011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.294606 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:32.295371 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.295870 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240625060232181455"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240625060232181455"
    )
  
[0m06:02:32.307150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.309132 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:32.309612 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.310051 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:32.318860 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.319838 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:32.425886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604ac3ecc0>]}
[0m06:02:32.426816 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.28s]
[0m06:02:32.427613 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:32.429120 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:32.429630 [debug] [MainThread]: On master: BEGIN
[0m06:02:32.430080 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:32.435705 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:32.436235 [debug] [MainThread]: On master: COMMIT
[0m06:02:32.436695 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:32.437136 [debug] [MainThread]: On master: COMMIT
[0m06:02:32.437821 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:32.438343 [debug] [MainThread]: On master: Close
[0m06:02:32.440087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:32.440545 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:32.440968 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:32.441456 [info ] [MainThread]: 
[0m06:02:32.442127 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.01 seconds (10.01s).
[0m06:02:32.443285 [debug] [MainThread]: Command end result
[0m06:02:32.472435 [info ] [MainThread]: 
[0m06:02:32.473239 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:32.473868 [info ] [MainThread]: 
[0m06:02:32.474533 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:32.475687 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.995988, "process_user_time": 4.84027, "process_kernel_time": 0.3187, "process_mem_max_rss": "270920", "process_in_blocks": "1184", "process_out_blocks": "106080"}
[0m06:02:32.476352 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:32.476238 after 12.00 seconds
[0m06:02:32.476871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60832094c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60833c77a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6082e031d0>]}
[0m06:02:32.477372 [debug] [MainThread]: Flushing usage events
[0m06:02:38.219978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931dd2a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931b603050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931b6031a0>]}


============================== 06:02:38.223045 | dd1fc596-d65e-4a7d-90d7-8a675e25bef7 ==============================
[0m06:02:38.223045 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:38.223738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:38.380308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd1fc596-d65e-4a7d-90d7-8a675e25bef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931b600c80>]}
[0m06:02:38.397560 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22758175, "process_user_time": 1.439669, "process_kernel_time": 0.140357, "process_mem_max_rss": "92004", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:38.398222 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:38.398076 after 0.23 seconds
[0m06:02:38.398694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931b6031a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931b600c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931c1ef8f0>]}
[0m06:02:38.399167 [debug] [MainThread]: Flushing usage events
[0m14:05:02.345601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a02f26f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a02d633b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0249a270>]}


============================== 14:05:02.353102 | 93fbe739-3253-4a17-96e1-6c3cc7e3f29d ==============================
[0m14:05:02.353102 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:02.353774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:02.499736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93fbe739-3253-4a17-96e1-6c3cc7e3f29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0234c9e0>]}
[0m14:05:02.513385 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-e38vpglk'
[0m14:05:02.513884 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:02.548182 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:02.548880 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:02.559734 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:02.563517 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:02.773050 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:02.773691 [info ] [MainThread]: Up to date!
[0m14:05:02.774297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '93fbe739-3253-4a17-96e1-6c3cc7e3f29d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a021d3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a022e8230>]}
[0m14:05:02.775857 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47860673, "process_user_time": 1.604244, "process_kernel_time": 0.119719, "process_mem_max_rss": "93568", "process_in_blocks": "5672", "process_out_blocks": "3840"}
[0m14:05:02.776514 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:02.776398 after 0.48 seconds
[0m14:05:02.777034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a024e7da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a02602120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0249bd40>]}
[0m14:05:02.777499 [debug] [MainThread]: Flushing usage events
[0m14:05:05.185648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e6b09dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e6b9519d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e695272f0>]}


============================== 14:05:05.188456 | e0126243-bace-48a1-800a-203525940d96 ==============================
[0m14:05:05.188456 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:05.189201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:05.427462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e69497590>]}
[0m14:05:05.486739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e6955a600>]}
[0m14:05:05.487613 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:05.502777 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:05.503522 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:05.504109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e6926c230>]}
[0m14:05:06.708048 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:06.708734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e692ba5d0>]}
[0m14:05:06.898580 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:06.903791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e62686b40>]}
[0m14:05:07.062341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e626f17f0>]}
[0m14:05:07.062916 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:07.063403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e62593200>]}
[0m14:05:07.065145 [info ] [MainThread]: 
[0m14:05:07.065848 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:07.070750 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:07.106616 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:07.107137 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:07.107558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:07.615736 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:07.617402 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:07.619560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:07.620127 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:07.626892 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:07.627337 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:07.627744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:07.633560 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.634910 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:07.635332 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:07.636019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.636437 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:07.636870 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:07.637469 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.638397 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:07.638818 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:07.639221 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:07.639775 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.640205 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:07.642332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:07.647815 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:07.648247 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:07.648644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:07.653718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.654144 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:07.654559 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:07.674939 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.679750 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:07.681021 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:07.681454 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:07.685100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e6ab699a0>]}
[0m14:05:07.685619 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:07.686018 [debug] [MainThread]: On master: BEGIN
[0m14:05:07.686408 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:07.691643 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:07.692101 [debug] [MainThread]: On master: COMMIT
[0m14:05:07.692518 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:07.692943 [debug] [MainThread]: On master: COMMIT
[0m14:05:07.693584 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:07.693997 [debug] [MainThread]: On master: Close
[0m14:05:07.695540 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:07.696042 [info ] [MainThread]: 
[0m14:05:07.705841 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:07.706479 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:07.707155 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:07.707614 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:07.733452 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:07.734218 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:07.768678 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:07.769515 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:16.952493 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.953065 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:16.953749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.954214 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.954656 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:16.955374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.958130 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.958603 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:16.959304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.979953 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:16.980568 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.981053 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:16.983260 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.988457 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.988968 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:16.990398 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.992891 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:17.018971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e6254c2c0>]}
[0m14:05:17.019810 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.31s]
[0m14:05:17.020594 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:17.021645 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:17.022238 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:17.022888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:17.023358 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:17.028471 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:17.029184 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:17.062514 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.063076 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240625140517056573"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:17.063559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:17.077993 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.085250 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.085733 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:17.086366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.086840 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.087296 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240625140517056573'
      
      
      order by ordinal_position

  
[0m14:05:17.114105 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.119350 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.119850 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:17.128493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.137332 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.137838 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:17.146714 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.164774 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:17.165517 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.166011 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240625140517056573"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240625140517056573"
    )
  
[0m14:05:17.179955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.181941 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:17.182417 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.182860 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:17.192065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.193030 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:17.302450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e324564b0>]}
[0m14:05:17.303290 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.28s]
[0m14:05:17.304058 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:17.305533 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:17.306055 [debug] [MainThread]: On master: BEGIN
[0m14:05:17.306504 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:17.311935 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:17.312417 [debug] [MainThread]: On master: COMMIT
[0m14:05:17.312903 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:17.313343 [debug] [MainThread]: On master: COMMIT
[0m14:05:17.313900 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:17.314364 [debug] [MainThread]: On master: Close
[0m14:05:17.315734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:17.316179 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:17.316599 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:17.317178 [info ] [MainThread]: 
[0m14:05:17.317709 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.25 seconds (10.25s).
[0m14:05:17.318724 [debug] [MainThread]: Command end result
[0m14:05:17.347035 [info ] [MainThread]: 
[0m14:05:17.347797 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:17.348340 [info ] [MainThread]: 
[0m14:05:17.348902 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:17.349978 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.212913, "process_user_time": 4.789226, "process_kernel_time": 0.248063, "process_mem_max_rss": "281232", "process_in_blocks": "1184", "process_out_blocks": "106552"}
[0m14:05:17.350646 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:17.350533 after 12.21 seconds
[0m14:05:17.351186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e6cfbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e603cde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e324c11c0>]}
[0m14:05:17.351729 [debug] [MainThread]: Flushing usage events
[0m14:05:22.302937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5625f64b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5625f6ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5625f7ce0>]}


============================== 14:05:22.305828 | 497692df-b625-41ed-bc81-e25a74709f80 ==============================
[0m14:05:22.305828 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:22.307807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:22.450924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '497692df-b625-41ed-bc81-e25a74709f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5624215e0>]}
[0m14:05:22.467395 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21292976, "process_user_time": 1.428454, "process_kernel_time": 0.119702, "process_mem_max_rss": "92060", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:22.467996 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:22.467891 after 0.21 seconds
[0m14:05:22.468450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa562fa2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa56269a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5623bb7d0>]}
[0m14:05:22.468921 [debug] [MainThread]: Flushing usage events
[0m14:05:27.683242 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m22:05:19.580864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f951fa4e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9520319d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9522099730>]}


============================== 22:05:19.610791 | 4a7538a1-ce9a-4c0f-9049-fdf157541d30 ==============================
[0m22:05:19.610791 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:19.611499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:19.752427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a7538a1-ce9a-4c0f-9049-fdf157541d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f951fa4cd70>]}
[0m22:05:19.765844 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r6prohk1'
[0m22:05:19.766310 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:19.946538 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:19.947283 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:19.978096 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:19.981835 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:20.339983 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:20.340598 [info ] [MainThread]: Up to date!
[0m22:05:20.341150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4a7538a1-ce9a-4c0f-9049-fdf157541d30', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95200b2ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f951f7b31a0>]}
[0m22:05:20.352202 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8198836, "process_user_time": 1.558904, "process_kernel_time": 0.136957, "process_mem_max_rss": "93560", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m22:05:20.352827 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:20.352721 after 0.82 seconds
[0m22:05:20.353282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f951fbb2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95200b2ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95207870b0>]}
[0m22:05:20.353733 [debug] [MainThread]: Flushing usage events
[0m22:05:22.148294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70ca455730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c833b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c80a3500>]}


============================== 22:05:22.151091 | 104a067d-e94e-4cd2-ac44-ca8c69a3b8a6 ==============================
[0m22:05:22.151091 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:22.151820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:22.375964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c7dece90>]}
[0m22:05:22.434292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c151e9f0>]}
[0m22:05:22.435083 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:22.455070 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:22.455813 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:22.456340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c7ea8e30>]}
[0m22:05:23.659035 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:23.659725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c151f950>]}
[0m22:05:23.848750 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:23.853985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c102e030>]}
[0m22:05:23.986102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c7e58fb0>]}
[0m22:05:23.986674 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:23.987217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c862af60>]}
[0m22:05:23.988948 [info ] [MainThread]: 
[0m22:05:23.989674 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:23.994373 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:24.029287 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:24.029739 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:24.030150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:24.668486 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:24.670036 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:24.672186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:24.672750 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:24.679664 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.680110 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:24.680521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.685927 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.687260 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.687672 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:24.688328 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.688736 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.689128 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:24.689695 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.690614 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.691085 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.691487 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.692018 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.692435 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:24.694402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:24.699679 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.700104 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:24.700491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.705371 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.705800 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.706203 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:24.726577 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.731442 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:24.732679 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:24.733117 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:24.736879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c11d3f20>]}
[0m22:05:24.737406 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.737805 [debug] [MainThread]: On master: BEGIN
[0m22:05:24.738183 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:24.743522 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.743963 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.744364 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.744740 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.745371 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.745788 [debug] [MainThread]: On master: Close
[0m22:05:24.747495 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:24.747995 [info ] [MainThread]: 
[0m22:05:24.767139 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:24.767772 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:24.768472 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:24.768917 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:24.794395 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:24.795164 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:24.829236 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:24.829965 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:39.176656 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.177172 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:39.177787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.178246 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.178689 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:39.179637 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.182297 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.182763 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:39.183490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.204194 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:39.204680 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.205127 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:39.207584 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.212317 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.212803 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:39.214574 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.216925 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:39.243418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c97d6600>]}
[0m22:05:39.244136 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 14.47s]
[0m22:05:39.245047 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:39.246022 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:39.246583 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:39.247291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:39.247763 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:39.252602 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:39.253239 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:39.286461 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:39.286999 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240625220539280686"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:39.287477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:39.302010 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.308939 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:39.309405 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:39.309991 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.310448 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:39.310950 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240625220539280686'
      
      
      order by ordinal_position

  
[0m22:05:39.337508 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.342453 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:39.342971 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:39.351609 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.360354 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:39.360847 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:39.369453 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.387471 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:39.388164 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:39.388661 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240625220539280686"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240625220539280686"
    )
  
[0m22:05:39.402406 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.404159 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:39.404648 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:39.405085 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:39.416140 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.417024 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:39.538059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7094928560>]}
[0m22:05:39.538925 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.29s]
[0m22:05:39.539802 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:39.541225 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:39.541718 [debug] [MainThread]: On master: BEGIN
[0m22:05:39.542162 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:39.547578 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:39.548061 [debug] [MainThread]: On master: COMMIT
[0m22:05:39.548504 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:39.548934 [debug] [MainThread]: On master: COMMIT
[0m22:05:39.549629 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:39.550093 [debug] [MainThread]: On master: Close
[0m22:05:39.551512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:39.551957 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:39.552370 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:39.552835 [info ] [MainThread]: 
[0m22:05:39.553373 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 15.56 seconds (15.56s).
[0m22:05:39.554362 [debug] [MainThread]: Command end result
[0m22:05:39.581849 [info ] [MainThread]: 
[0m22:05:39.582493 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:39.583060 [info ] [MainThread]: 
[0m22:05:39.583598 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:39.584580 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.484686, "process_user_time": 4.632635, "process_kernel_time": 0.34986, "process_mem_max_rss": "274952", "process_in_blocks": "1184", "process_out_blocks": "107112"}
[0m22:05:39.585225 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:39.585116 after 17.49 seconds
[0m22:05:39.585723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70ca455730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c102d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c8435100>]}
[0m22:05:39.586213 [debug] [MainThread]: Flushing usage events
[0m22:05:41.490062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c144b1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c12bf2330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c130aae70>]}


============================== 22:05:41.492823 | b7d417b0-1f2c-44f6-9abf-0137890c9397 ==============================
[0m22:05:41.492823 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:41.493492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:41.635405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7d417b0-1f2c-44f6-9abf-0137890c9397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c13e4b1d0>]}
[0m22:05:41.651571 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2107093, "process_user_time": 1.43257, "process_kernel_time": 0.079808, "process_mem_max_rss": "92064", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:41.652172 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:41.652068 after 0.21 seconds
[0m22:05:41.652623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c12a20da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c12688890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c12a7acc0>]}
[0m22:05:41.653069 [debug] [MainThread]: Flushing usage events
[0m06:02:24.793021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e6d31730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e4a95c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e56842c0>]}


============================== 06:02:24.838694 | 3a5afe4d-6aca-41ea-ae5b-e63d285a99df ==============================
[0m06:02:24.838694 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.839787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.984902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a5afe4d-6aca-41ea-ae5b-e63d285a99df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e4534050>]}
[0m06:02:24.998271 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6032hz3a'
[0m06:02:24.998733 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:25.072663 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:25.073390 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:25.095481 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:25.099187 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:25.173236 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:25.173798 [info ] [MainThread]: Up to date!
[0m06:02:25.174378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3a5afe4d-6aca-41ea-ae5b-e63d285a99df', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e44cd1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e44ce810>]}
[0m06:02:25.186576 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44206268, "process_user_time": 1.596394, "process_kernel_time": 0.12676, "process_mem_max_rss": "93688", "process_in_blocks": "5672", "process_out_blocks": "3840"}
[0m06:02:25.187327 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:25.187198 after 0.44 seconds
[0m06:02:25.187779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e4832000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e5716c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e4415580>]}
[0m06:02:25.188230 [debug] [MainThread]: Flushing usage events
[0m06:02:26.782673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55ec33680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5611d5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55ec33890>]}


============================== 06:02:26.785472 | 2e48f65e-7087-424a-a4d8-1859e2d42895 ==============================
[0m06:02:26.785472 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:26.786129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.009370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55f90b530>]}
[0m06:02:27.068192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55ebfdeb0>]}
[0m06:02:27.069006 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:27.083902 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:27.084620 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:27.085184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55eade840>]}
[0m06:02:28.292390 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:28.293045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc557e924e0>]}
[0m06:02:28.485493 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:28.490893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc557ef3fb0>]}
[0m06:02:28.705980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc557d4d0a0>]}
[0m06:02:28.706557 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:28.707057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc557da9610>]}
[0m06:02:28.708792 [info ] [MainThread]: 
[0m06:02:28.709497 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:28.714458 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:28.749970 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:28.750454 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:28.750871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:29.119419 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.120987 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:29.123297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:29.123896 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:29.130776 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.131284 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:29.131718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.137183 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.138509 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.138925 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:29.139827 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.140249 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.140645 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:29.141275 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.142204 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.142620 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.143019 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.143609 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.144031 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:29.146088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:29.151459 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.151888 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:29.152278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.157311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.157737 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.158157 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:29.178304 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.182996 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:29.184193 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:29.184614 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:29.187857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55f7e6d20>]}
[0m06:02:29.188382 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.188781 [debug] [MainThread]: On master: BEGIN
[0m06:02:29.189159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:29.194190 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.194623 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.195017 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.195440 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.196067 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.196477 [debug] [MainThread]: On master: Close
[0m06:02:29.197919 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:29.198454 [info ] [MainThread]: 
[0m06:02:29.213799 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:29.214405 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:29.215165 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:29.215630 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:29.240631 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:29.241364 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:29.275724 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:29.276477 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:41.827485 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:41.828008 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:41.828619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.829085 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:41.829531 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:41.830220 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.832946 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:41.833417 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:41.834283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.854784 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:41.855302 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:41.855754 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:41.857001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.861746 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:41.862234 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:41.863592 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.865896 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:41.893473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc527b0d550>]}
[0m06:02:41.894219 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.68s]
[0m06:02:41.895121 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:41.896122 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:41.896694 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:41.897374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:41.897857 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:41.902754 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:41.903429 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:41.936586 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:41.937101 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240626060241930784"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:41.937577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:41.952390 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.959283 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:41.959758 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:41.960344 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.960797 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:41.961242 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240626060241930784'
      
      
      order by ordinal_position

  
[0m06:02:41.987306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.992165 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:41.992655 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:42.006855 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.015352 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:42.015860 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:42.029609 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.047440 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:42.048144 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:42.048624 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240626060241930784"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240626060241930784"
    )
  
[0m06:02:42.062903 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.064711 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:42.065168 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:42.065605 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:42.075919 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.076804 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:42.207348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc527b837a0>]}
[0m06:02:42.208161 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m06:02:42.208913 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:42.210296 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:42.210787 [debug] [MainThread]: On master: BEGIN
[0m06:02:42.211278 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:42.216581 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:42.217067 [debug] [MainThread]: On master: COMMIT
[0m06:02:42.217514 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:42.217953 [debug] [MainThread]: On master: COMMIT
[0m06:02:42.218656 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:42.219154 [debug] [MainThread]: On master: Close
[0m06:02:42.220603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:42.221057 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:42.221477 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:42.221949 [info ] [MainThread]: 
[0m06:02:42.222554 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.51 seconds (13.51s).
[0m06:02:42.223708 [debug] [MainThread]: Command end result
[0m06:02:42.251281 [info ] [MainThread]: 
[0m06:02:42.251974 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:42.252569 [info ] [MainThread]: 
[0m06:02:42.253181 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:42.254262 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.519896, "process_user_time": 4.757894, "process_kernel_time": 0.293102, "process_mem_max_rss": "270912", "process_in_blocks": "1184", "process_out_blocks": "108608"}
[0m06:02:42.254909 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:42.254799 after 15.52 seconds
[0m06:02:42.255453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55ef0f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55ec337a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc527b9e1e0>]}
[0m06:02:42.255949 [debug] [MainThread]: Flushing usage events
[0m06:02:43.887650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79df6930b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79df33b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79df33ba40>]}


============================== 06:02:43.890472 | 8e5cce46-8e9e-4382-a387-2138a8e6c650 ==============================
[0m06:02:43.890472 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:43.891254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:44.037609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e5cce46-8e9e-4382-a387-2138a8e6c650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79df584b90>]}
[0m06:02:44.054387 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21854515, "process_user_time": 1.394104, "process_kernel_time": 0.144217, "process_mem_max_rss": "92024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:44.054974 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:44.054872 after 0.22 seconds
[0m06:02:44.055461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79dfb335f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79df690830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79dfcd3800>]}
[0m06:02:44.055907 [debug] [MainThread]: Flushing usage events
[0m14:04:48.911773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fcc9d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fb74db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fb0c2090>]}


============================== 14:04:48.930136 | d3375578-7281-4150-93f7-8a19a5836904 ==============================
[0m14:04:48.930136 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:48.930822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:49.076408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3375578-7281-4150-93f7-8a19a5836904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5faf20110>]}
[0m14:04:49.090161 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8eespdjs'
[0m14:04:49.090648 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:49.245434 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:49.246332 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:49.330195 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:49.334166 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:49.406837 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:49.407452 [info ] [MainThread]: Up to date!
[0m14:04:49.408015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd3375578-7281-4150-93f7-8a19a5836904', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fb4ea990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fae0c6b0>]}
[0m14:04:49.409449 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5469035, "process_user_time": 1.622801, "process_kernel_time": 0.122999, "process_mem_max_rss": "93540", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m14:04:49.410061 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:49.409954 after 0.55 seconds
[0m14:04:49.410519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fcc9d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fcf50c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5faebb560>]}
[0m14:04:49.410962 [debug] [MainThread]: Flushing usage events
[0m14:04:51.000156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fc2552b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fab62000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f9e85d00>]}


============================== 14:04:51.003107 | d653fea0-4bf6-4744-8ecf-2d99eed48452 ==============================
[0m14:04:51.003107 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:51.003765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:51.231023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f9bc86e0>]}
[0m14:04:51.290405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f9c54920>]}
[0m14:04:51.291262 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:51.306555 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:51.307300 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:51.307854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f9c0b770>]}
[0m14:04:52.519409 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:52.520195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f30dfda0>]}
[0m14:04:52.714377 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:52.720518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f306a510>]}
[0m14:04:52.856459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f9c7ff20>]}
[0m14:04:52.857071 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:52.857563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fad7a960>]}
[0m14:04:52.859316 [info ] [MainThread]: 
[0m14:04:52.860039 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:52.864839 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:52.902157 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:52.902701 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:04:52.903136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:53.475120 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:53.476703 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:53.479190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:53.479781 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:53.486664 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.487114 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:04:53.487522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:53.493353 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.494770 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.495199 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:53.495756 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.496228 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.496617 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:53.497269 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.498213 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:53.498629 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.499028 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:53.499562 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.499991 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:53.502442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:53.508061 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:53.508502 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:53.508892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:53.514379 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.514819 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:53.515251 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:04:53.535025 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.539921 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:53.541211 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:53.541659 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:53.545296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f2ec2390>]}
[0m14:04:53.545835 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:53.546247 [debug] [MainThread]: On master: BEGIN
[0m14:04:53.546629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:53.551909 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:53.552346 [debug] [MainThread]: On master: COMMIT
[0m14:04:53.552739 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:53.553175 [debug] [MainThread]: On master: COMMIT
[0m14:04:53.553812 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:53.554228 [debug] [MainThread]: On master: Close
[0m14:04:53.555859 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:53.556361 [info ] [MainThread]: 
[0m14:04:53.566551 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:53.567202 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:53.567866 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:53.568320 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:53.594472 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:53.595323 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:53.630138 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:53.630945 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:00.960750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:00.961342 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:00.961985 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:00.962448 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:00.962904 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:00.963601 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:00.966302 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:00.966776 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:00.967470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:00.988107 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:00.988621 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:00.989097 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:00.990382 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:00.995243 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:00.995732 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:00.996897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:00.999300 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:01.025094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fb5da180>]}
[0m14:05:01.025842 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.46s]
[0m14:05:01.026626 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:01.027618 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:01.028194 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:01.028802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:01.029306 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:01.034278 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:01.034967 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:01.068419 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.068952 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240626140501062545"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:01.069483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:01.085896 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.093129 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.093617 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:01.094216 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.094676 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.095127 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240626140501062545'
      
      
      order by ordinal_position

  
[0m14:05:01.127058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.132216 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.132722 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:01.144341 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.153128 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.153630 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:01.167610 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.185757 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:01.186463 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.186951 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240626140501062545"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240626140501062545"
    )
  
[0m14:05:01.199995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.201807 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:01.202276 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.202718 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:01.213627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.214533 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:01.338190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c2d20bc0>]}
[0m14:05:01.339043 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m14:05:01.339909 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:01.341509 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:01.342001 [debug] [MainThread]: On master: BEGIN
[0m14:05:01.342450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:01.347782 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:01.348272 [debug] [MainThread]: On master: COMMIT
[0m14:05:01.348723 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:01.349200 [debug] [MainThread]: On master: COMMIT
[0m14:05:01.349887 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:01.350361 [debug] [MainThread]: On master: Close
[0m14:05:01.351807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:01.352253 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:01.352670 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:01.353198 [info ] [MainThread]: 
[0m14:05:01.353808 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.49 seconds (8.49s).
[0m14:05:01.354937 [debug] [MainThread]: Command end result
[0m14:05:01.382566 [info ] [MainThread]: 
[0m14:05:01.383274 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:01.383896 [info ] [MainThread]: 
[0m14:05:01.384513 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:01.385613 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.434969, "process_user_time": 4.828375, "process_kernel_time": 0.26556, "process_mem_max_rss": "276552", "process_in_blocks": "1184", "process_out_blocks": "107592"}
[0m14:05:01.386266 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:01.386155 after 10.44 seconds
[0m14:05:01.386774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fa4365d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f9e85d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fb5da180>]}
[0m14:05:01.387275 [debug] [MainThread]: Flushing usage events
[0m14:05:03.045990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63cc5f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63d932c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63cc5f2f0>]}


============================== 14:05:03.048842 | 2c7146b5-edb6-4833-a89f-82e2073def4a ==============================
[0m14:05:03.048842 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:03.049532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:03.191429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c7146b5-edb6-4833-a89f-82e2073def4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63ca549e0>]}
[0m14:05:03.208067 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21137992, "process_user_time": 1.409804, "process_kernel_time": 0.108138, "process_mem_max_rss": "92016", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:03.208669 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:03.208563 after 0.21 seconds
[0m14:05:03.209174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63dc45e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6409bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63cf92fc0>]}
[0m14:05:03.209629 [debug] [MainThread]: Flushing usage events
[0m22:05:19.993750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fb2c8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43faa2bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fc58d820>]}


============================== 22:05:20.000761 | 21dfe44b-9508-4e25-98ed-106da07d6d84 ==============================
[0m22:05:20.000761 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:20.001394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:20.137477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21dfe44b-9508-4e25-98ed-106da07d6d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fab422a0>]}
[0m22:05:20.150492 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vdhar8hk'
[0m22:05:20.150952 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:20.226360 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:20.226984 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:20.250073 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:20.253765 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:20.326015 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:20.326523 [info ] [MainThread]: Up to date!
[0m22:05:20.327051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '21dfe44b-9508-4e25-98ed-106da07d6d84', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fa6ea0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fa7433e0>]}
[0m22:05:20.344124 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.39853555, "process_user_time": 1.54561, "process_kernel_time": 0.120125, "process_mem_max_rss": "93680", "process_in_blocks": "5672", "process_out_blocks": "3840"}
[0m22:05:20.344734 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:20.344628 after 0.40 seconds
[0m22:05:20.345176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fe7bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fbbcef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fab422a0>]}
[0m22:05:20.345608 [debug] [MainThread]: Flushing usage events
[0m22:05:21.894260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe802617860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8028f33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe802614c20>]}


============================== 22:05:21.897044 | c1b33cc7-0a1b-4b04-a777-a23cd209ce2b ==============================
[0m22:05:21.897044 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:21.897780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:22.115655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7fb769f40>]}
[0m22:05:22.174693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7fb743860>]}
[0m22:05:22.175541 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:22.190818 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:22.191585 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:22.192130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7fb7b90d0>]}
[0m22:05:23.382859 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:23.383533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7fb768a10>]}
[0m22:05:23.574213 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:23.579226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80203d4f0>]}
[0m22:05:23.712949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe802bc2f60>]}
[0m22:05:23.713518 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:23.714028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7fb2aef60>]}
[0m22:05:23.715739 [info ] [MainThread]: 
[0m22:05:23.716438 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:23.721147 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:23.755751 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:23.756200 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:23.756607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:24.393270 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:24.394804 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:24.397119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:24.397703 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:24.404464 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.404912 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:24.405318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.410778 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.412057 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.412438 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:24.413257 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.413670 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.414062 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:24.414612 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.415596 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.416016 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.416406 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.417050 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.417473 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:24.419638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:24.424909 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.425336 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:24.425723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.430563 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.430986 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.431453 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:24.451405 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.456143 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:24.457339 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:24.457763 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:24.461107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe803290380>]}
[0m22:05:24.461657 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.462065 [debug] [MainThread]: On master: BEGIN
[0m22:05:24.462454 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:24.467636 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.468072 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.468478 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.468867 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.469397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.469823 [debug] [MainThread]: On master: Close
[0m22:05:24.471326 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:24.471838 [info ] [MainThread]: 
[0m22:05:24.486149 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:24.486762 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:24.487449 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:24.487900 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:24.513598 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:24.514336 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:24.548618 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:24.549446 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:32.823253 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:32.823734 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:32.824321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:32.824750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:32.825162 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:32.825968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:32.828666 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:32.829135 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:32.829824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:32.850137 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:32.850615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:32.851097 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:32.853078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:32.857860 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:32.858354 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:32.859479 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:32.861745 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:32.887151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7cab6f500>]}
[0m22:05:32.887855 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.40s]
[0m22:05:32.888735 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:32.889695 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:32.890270 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:32.890947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:32.891419 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:32.896178 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:32.896829 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:32.929652 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:32.930184 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240626220532923885"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:32.930683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:32.945055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:32.951832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:32.952310 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:32.952852 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:32.953278 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:32.953693 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240626220532923885'
      
      
      order by ordinal_position

  
[0m22:05:32.979004 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:32.983854 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:32.984353 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:32.993080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.001851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.002346 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:33.010881 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.028810 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:33.029493 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.029974 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240626220532923885"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240626220532923885"
    )
  
[0m22:05:33.042692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.044481 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:33.044941 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.045376 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:33.054519 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.055429 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:33.191058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7cabf0e00>]}
[0m22:05:33.191890 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m22:05:33.192760 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:33.194155 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.194647 [debug] [MainThread]: On master: BEGIN
[0m22:05:33.195131 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:33.200465 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.200950 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.201395 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.201824 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.202388 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.202845 [debug] [MainThread]: On master: Close
[0m22:05:33.204220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:33.204669 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:33.205083 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:33.205548 [info ] [MainThread]: 
[0m22:05:33.206086 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.49 seconds (9.49s).
[0m22:05:33.207132 [debug] [MainThread]: Command end result
[0m22:05:33.234830 [info ] [MainThread]: 
[0m22:05:33.235491 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:33.236011 [info ] [MainThread]: 
[0m22:05:33.236540 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:33.237530 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.392115, "process_user_time": 4.670752, "process_kernel_time": 0.253015, "process_mem_max_rss": "271668", "process_in_blocks": "1184", "process_out_blocks": "108648"}
[0m22:05:33.238182 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:33.238073 after 11.39 seconds
[0m22:05:33.238687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8028f33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe805806a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f0f42a80>]}
[0m22:05:33.239198 [debug] [MainThread]: Flushing usage events
[0m22:05:34.930727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0246272c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02464f2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0246271a00>]}


============================== 22:05:34.933586 | 512226c7-dd91-4eb2-b176-118bae286117 ==============================
[0m22:05:34.933586 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:34.934264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:35.078053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '512226c7-dd91-4eb2-b176-118bae286117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0245610770>]}
[0m22:05:35.094176 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21260738, "process_user_time": 1.471596, "process_kernel_time": 0.103971, "process_mem_max_rss": "92084", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:35.094756 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:35.094653 after 0.21 seconds
[0m22:05:35.095241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02464f2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0245612c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02462a0e00>]}
[0m22:05:35.095681 [debug] [MainThread]: Flushing usage events
[0m06:02:14.788059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62f38e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd631619970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62f81b3b0>]}


============================== 06:02:14.795673 | 277c7d73-cd1d-4ee7-9ac3-779d6d91dcef ==============================
[0m06:02:14.795673 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.796366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.938225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '277c7d73-cd1d-4ee7-9ac3-779d6d91dcef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62efebbf0>]}
[0m06:02:14.951584 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-bxrqygv0'
[0m06:02:14.952043 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:15.196532 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:15.197409 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:15.230583 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:15.234476 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:15.595964 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:15.596598 [info ] [MainThread]: Up to date!
[0m06:02:15.597172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '277c7d73-cd1d-4ee7-9ac3-779d6d91dcef', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62f18d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62efeb410>]}
[0m06:02:15.598744 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8588429, "process_user_time": 1.602331, "process_kernel_time": 0.133527, "process_mem_max_rss": "93396", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m06:02:15.599387 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:15.599241 after 0.86 seconds
[0m06:02:15.599842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62f2f65a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62effa270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62eff9040>]}
[0m06:02:15.600280 [debug] [MainThread]: Flushing usage events
[0m06:02:18.293131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc892c31bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8935ab8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc894a6c560>]}


============================== 06:02:18.295984 | ebef625f-1923-4357-9fcb-b6410c6f3867 ==============================
[0m06:02:18.295984 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:18.296721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:18.526471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8929c1e20>]}
[0m06:02:18.586016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8929c1e20>]}
[0m06:02:18.586887 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:18.602539 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:18.603281 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:18.603878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc892ad09e0>]}
[0m06:02:19.799333 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:19.800018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc892a93cb0>]}
[0m06:02:19.989754 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:19.994897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc892869520>]}
[0m06:02:20.121262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88bb6bad0>]}
[0m06:02:20.121843 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:20.122346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8941d6b40>]}
[0m06:02:20.124070 [info ] [MainThread]: 
[0m06:02:20.124772 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:20.129738 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:20.165655 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:20.166189 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:20.166617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:20.756629 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:20.758153 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:20.760377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:20.760947 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:20.767688 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:20.768129 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:20.768542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:20.773821 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.775113 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:20.775584 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:20.776214 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.776620 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:20.777009 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:20.777556 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.778462 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:20.778874 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:20.779268 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:20.779851 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.780268 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:20.782285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:20.787499 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:20.787920 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:20.788304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:20.793255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.793682 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:20.794088 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:20.813669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.818452 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:20.819655 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:20.820067 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:20.823356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8937d5820>]}
[0m06:02:20.823886 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.824299 [debug] [MainThread]: On master: BEGIN
[0m06:02:20.824684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:20.829860 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.830288 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.830687 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.831068 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.831734 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.832152 [debug] [MainThread]: On master: Close
[0m06:02:20.833816 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:20.834307 [info ] [MainThread]: 
[0m06:02:20.844542 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:20.845177 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:20.845932 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:20.846385 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:20.872146 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:20.872905 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:20.907243 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:20.908103 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:33.371876 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:33.372404 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:33.373039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.373507 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:33.373959 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:33.374651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.377380 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:33.377852 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:33.378733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.399433 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:33.399930 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:33.400439 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:33.402899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.407735 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:33.408217 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:33.409547 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.411928 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:33.440199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88bb10c80>]}
[0m06:02:33.440994 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.59s]
[0m06:02:33.441785 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:33.442776 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:33.443392 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:33.444017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:33.444484 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:33.449546 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:33.450210 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:33.483946 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.484491 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240627060233477997"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:33.484988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:33.501275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.508488 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.508971 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:33.509570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.510054 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.510506 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240627060233477997'
      
      
      order by ordinal_position

  
[0m06:02:33.536716 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.541728 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.542215 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:33.549986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.558591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.559095 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:33.567568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.585621 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:33.586330 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.586810 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240627060233477997"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240627060233477997"
    )
  
[0m06:02:33.602768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.604718 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:33.605191 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.605632 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:33.615272 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.616226 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:33.759687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc85b98bfe0>]}
[0m06:02:33.760541 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m06:02:33.761408 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:33.762826 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:33.763383 [debug] [MainThread]: On master: BEGIN
[0m06:02:33.763874 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:33.769178 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:33.769654 [debug] [MainThread]: On master: COMMIT
[0m06:02:33.770103 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:33.770540 [debug] [MainThread]: On master: COMMIT
[0m06:02:33.771228 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:33.771737 [debug] [MainThread]: On master: Close
[0m06:02:33.773120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:33.773564 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:33.773983 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:33.774453 [info ] [MainThread]: 
[0m06:02:33.774983 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.65 seconds (13.65s).
[0m06:02:33.776037 [debug] [MainThread]: Command end result
[0m06:02:33.803533 [info ] [MainThread]: 
[0m06:02:33.804220 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:33.804728 [info ] [MainThread]: 
[0m06:02:33.805248 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:33.806227 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.561697, "process_user_time": 4.723607, "process_kernel_time": 0.300738, "process_mem_max_rss": "267856", "process_in_blocks": "1184", "process_out_blocks": "108616"}
[0m06:02:33.806876 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:33.806767 after 15.56 seconds
[0m06:02:33.807416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8965bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc892f882c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc85ba32b10>]}
[0m06:02:33.807924 [debug] [MainThread]: Flushing usage events
[0m06:02:39.608514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711a4d5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711c0df650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711b7d1b20>]}


============================== 06:02:39.611477 | 6cd69af9-1d5e-4535-83c8-ac622bb23f1b ==============================
[0m06:02:39.611477 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:39.612201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:39.775670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cd69af9-1d5e-4535-83c8-ac622bb23f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711a4d7260>]}
[0m06:02:39.792071 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23307717, "process_user_time": 1.472227, "process_kernel_time": 0.080012, "process_mem_max_rss": "92288", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:39.792667 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:39.792563 after 0.23 seconds
[0m06:02:39.793129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711b669670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711a331820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711a593a70>]}
[0m06:02:39.793577 [debug] [MainThread]: Flushing usage events
[0m14:05:18.631806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9810563da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9810c5b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9810762000>]}


============================== 14:05:18.679988 | 64105381-5b6c-4181-943f-263bc38ccdb4 ==============================
[0m14:05:18.679988 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:18.680664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:18.822449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64105381-5b6c-4181-943f-263bc38ccdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98106475c0>]}
[0m14:05:18.835818 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q1ll6ac8'
[0m14:05:18.836288 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:18.951352 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:18.952084 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:18.996233 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:19.000018 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:19.071568 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:19.072101 [info ] [MainThread]: Up to date!
[0m14:05:19.072616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '64105381-5b6c-4181-943f-263bc38ccdb4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981044a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9810415dc0>]}
[0m14:05:19.074004 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49170014, "process_user_time": 1.589429, "process_kernel_time": 0.107018, "process_mem_max_rss": "93556", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m14:05:19.074604 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:19.074499 after 0.49 seconds
[0m14:05:19.075046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9810a4b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981044a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9810eb6480>]}
[0m14:05:19.075511 [debug] [MainThread]: Flushing usage events
[0m14:05:21.773380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a12ecc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a12ecf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a12ec530>]}


============================== 14:05:21.776214 | 174142d3-82e4-42d3-ba93-6535f8f7b519 ==============================
[0m14:05:21.776214 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:21.776889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:22.004955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a1153500>]}
[0m14:05:22.064964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a1783e00>]}
[0m14:05:22.065827 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:22.225731 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:22.226541 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:22.227116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a1d537a0>]}
[0m14:05:23.453429 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:23.454082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc79a5c49e0>]}
[0m14:05:23.646036 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:23.651110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc79a4b7980>]}
[0m14:05:23.778046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc79a4b58e0>]}
[0m14:05:23.778618 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:23.779177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc79a35b110>]}
[0m14:05:23.780921 [info ] [MainThread]: 
[0m14:05:23.781668 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:23.786533 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:23.822247 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:23.822735 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:23.823157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:24.219073 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.220735 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:24.223029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:24.223681 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:24.230738 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:24.231223 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:24.231663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:24.237379 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.238742 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:24.239164 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:24.239736 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.240149 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:24.240548 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:24.241127 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.242064 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:24.242482 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:24.242884 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:24.243517 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.244000 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:24.245999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:24.251382 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:24.251814 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:24.252207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:24.257125 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.257552 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:24.257981 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:24.278005 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.284562 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:24.285776 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:24.286195 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:24.289487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a1eb32c0>]}
[0m14:05:24.290014 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:24.290422 [debug] [MainThread]: On master: BEGIN
[0m14:05:24.290807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:24.295952 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:24.296403 [debug] [MainThread]: On master: COMMIT
[0m14:05:24.296813 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:24.297209 [debug] [MainThread]: On master: COMMIT
[0m14:05:24.297865 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:24.298290 [debug] [MainThread]: On master: Close
[0m14:05:24.299895 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:24.300414 [info ] [MainThread]: 
[0m14:05:24.334277 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:24.334909 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:24.335618 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:24.336079 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:24.361676 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:24.362435 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:24.396862 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:24.397622 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:33.630597 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:33.631161 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:33.631911 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.632382 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:33.632838 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:33.633583 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.636452 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:33.636927 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:33.637634 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.658461 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:33.658991 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:33.659486 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:33.661250 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.666173 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:33.666680 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:33.667885 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.670257 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:33.696063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7989d5c70>]}
[0m14:05:33.696850 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.36s]
[0m14:05:33.697750 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:33.698752 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:33.699365 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:33.700057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:33.700534 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:33.705593 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:33.706260 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:33.740379 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.740922 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240627140533734419"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:33.741414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:33.755882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.762956 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.763473 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:33.764087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.764553 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.765009 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240627140533734419'
      
      
      order by ordinal_position

  
[0m14:05:33.791229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.796145 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.796642 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:33.805225 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.813934 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.814447 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:33.823239 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.841319 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:33.842039 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.842530 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240627140533734419"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240627140533734419"
    )
  
[0m14:05:33.855620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.857468 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:33.857937 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.858383 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:33.868001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.868907 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:34.016763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76b7e5580>]}
[0m14:05:34.017616 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m14:05:34.018390 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:34.019962 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.020508 [debug] [MainThread]: On master: BEGIN
[0m14:05:34.020953 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:34.026436 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.026921 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.027439 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.027884 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.028581 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.029046 [debug] [MainThread]: On master: Close
[0m14:05:34.030530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:34.030977 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:34.031457 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:34.031942 [info ] [MainThread]: 
[0m14:05:34.032543 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.25 seconds (10.25s).
[0m14:05:34.033653 [debug] [MainThread]: Command end result
[0m14:05:34.068014 [info ] [MainThread]: 
[0m14:05:34.068940 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:34.069791 [info ] [MainThread]: 
[0m14:05:34.070617 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:34.072101 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.348133, "process_user_time": 4.761526, "process_kernel_time": 0.277019, "process_mem_max_rss": "267372", "process_in_blocks": "1184", "process_out_blocks": "108592"}
[0m14:05:34.073177 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:34.073016 after 12.35 seconds
[0m14:05:34.074054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc79a693c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a1780f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76a2c8fb0>]}
[0m14:05:34.074876 [debug] [MainThread]: Flushing usage events
[0m14:05:36.704592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b88c3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b8db4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b8e37650>]}


============================== 14:05:36.707401 | f9343c0c-f144-472d-8ba1-58edfdff8657 ==============================
[0m14:05:36.707401 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:36.708155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:36.852535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9343c0c-f144-472d-8ba1-58edfdff8657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b87d4470>]}
[0m14:05:36.869168 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21403854, "process_user_time": 1.408605, "process_kernel_time": 0.120051, "process_mem_max_rss": "91924", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:36.869748 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:36.869643 after 0.21 seconds
[0m14:05:36.870197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b8804dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b8e36600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b86ebdd0>]}
[0m14:05:36.870646 [debug] [MainThread]: Flushing usage events
[0m22:05:19.388005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2159c11760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2157f97c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2158aadb80>]}


============================== 22:05:19.395717 | fff876ba-342c-4628-a5b8-f015481488cd ==============================
[0m22:05:19.395717 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:19.396408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:05:19.535653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fff876ba-342c-4628-a5b8-f015481488cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2158062030>]}
[0m22:05:19.548854 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nlyqu5e6'
[0m22:05:19.549314 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:19.583326 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:19.583975 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:19.695242 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:19.699142 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:20.056337 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:20.056976 [info ] [MainThread]: Up to date!
[0m22:05:20.057523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fff876ba-342c-4628-a5b8-f015481488cd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2157ed5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2157ed5bb0>]}
[0m22:05:20.074461 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.73503107, "process_user_time": 1.561475, "process_kernel_time": 0.125079, "process_mem_max_rss": "93304", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m22:05:20.075202 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:20.075080 after 0.74 seconds
[0m22:05:20.075659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21582149b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f215935a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2158e9aa20>]}
[0m22:05:20.076109 [debug] [MainThread]: Flushing usage events
[0m22:05:21.884783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da71dc860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da7076b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da7139730>]}


============================== 22:05:21.887653 | 635589b7-b28e-4fb4-ba9f-017d689f3397 ==============================
[0m22:05:21.887653 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:21.888386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:22.113583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da6bbb0e0>]}
[0m22:05:22.172552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da6a65490>]}
[0m22:05:22.173340 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:22.226369 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:22.227111 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:22.227655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da010eb70>]}
[0m22:05:23.432855 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:23.433558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9ff5f2f0>]}
[0m22:05:23.621673 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:23.626610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9fe95340>]}
[0m22:05:23.746788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9fff2db0>]}
[0m22:05:23.747371 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:23.747874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9fd7f7a0>]}
[0m22:05:23.749545 [info ] [MainThread]: 
[0m22:05:23.750251 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:23.755107 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:23.789763 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:23.790256 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:23.790679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:24.202191 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.203813 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:24.206200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:24.206862 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:24.213714 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.214164 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:24.214618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.220427 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.221821 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.222271 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:24.222958 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.223373 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.223769 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:24.224363 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.225303 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.225718 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.226109 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.226789 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.227225 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:24.229430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:24.234780 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.235209 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:24.235597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.240690 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.241119 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.241538 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:24.261632 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.266524 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:24.267741 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:24.268163 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:24.271355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9fd3c530>]}
[0m22:05:24.271898 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.272314 [debug] [MainThread]: On master: BEGIN
[0m22:05:24.272696 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:24.277900 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.278363 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.278773 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.279167 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.279688 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.280118 [debug] [MainThread]: On master: Close
[0m22:05:24.281722 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:24.282302 [info ] [MainThread]: 
[0m22:05:24.292068 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:24.292695 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:24.293440 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:24.293913 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:24.319455 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:24.320217 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:24.354492 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:24.355248 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:37.819356 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.819899 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:37.820671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.821142 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.821591 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:37.822451 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.826694 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.827425 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:37.828374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.852894 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:37.853434 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.854181 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:37.866464 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.872563 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.873216 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:37.879724 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.882724 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:37.932826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6fb03890>]}
[0m22:05:37.934034 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 13.64s]
[0m22:05:37.935208 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:37.936323 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:37.936937 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:37.937575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:37.938091 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:37.943265 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:37.943933 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:37.977477 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.978008 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240627220537971623"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:37.978525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:37.994480 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.001438 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:38.001920 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:38.002653 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.003130 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:38.003587 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240627220537971623'
      
      
      order by ordinal_position

  
[0m22:05:38.031014 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.035850 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:38.036338 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:38.044953 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.053392 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:38.053891 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:38.062846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.080792 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:38.081532 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:38.082024 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240627220537971623"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240627220537971623"
    )
  
[0m22:05:38.096536 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.098473 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:38.098944 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:38.099386 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:38.109863 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.110843 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:38.267403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6fba7e30>]}
[0m22:05:38.268253 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m22:05:38.269112 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:38.270540 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:38.271033 [debug] [MainThread]: On master: BEGIN
[0m22:05:38.271481 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:38.276738 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:38.277218 [debug] [MainThread]: On master: COMMIT
[0m22:05:38.277659 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:38.278086 [debug] [MainThread]: On master: COMMIT
[0m22:05:38.278819 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:38.279280 [debug] [MainThread]: On master: Close
[0m22:05:38.280647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:38.281090 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:38.281503 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:38.281971 [info ] [MainThread]: 
[0m22:05:38.282538 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.53 seconds (14.53s).
[0m22:05:38.283517 [debug] [MainThread]: Command end result
[0m22:05:38.311188 [info ] [MainThread]: 
[0m22:05:38.311813 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:38.312326 [info ] [MainThread]: 
[0m22:05:38.312856 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:38.313851 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.477825, "process_user_time": 4.743039, "process_kernel_time": 0.299182, "process_mem_max_rss": "267940", "process_in_blocks": "1184", "process_out_blocks": "109152"}
[0m22:05:38.314566 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:38.314450 after 16.48 seconds
[0m22:05:38.315069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da6d3bc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9ea4f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da89494f0>]}
[0m22:05:38.315566 [debug] [MainThread]: Flushing usage events
[0m22:05:40.176274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32967b4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3295dcb7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3295dcb590>]}


============================== 22:05:40.179063 | f868163d-72b5-4f51-bff4-9c07c59d2b03 ==============================
[0m22:05:40.179063 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:40.179714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:40.317941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f868163d-72b5-4f51-bff4-9c07c59d2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3296d3c9b0>]}
[0m22:05:40.334227 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2066004, "process_user_time": 1.414725, "process_kernel_time": 0.08792, "process_mem_max_rss": "92036", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:40.334865 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:40.334757 after 0.21 seconds
[0m22:05:40.335320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3295d63bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3295bf9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329692a840>]}
[0m22:05:40.335767 [debug] [MainThread]: Flushing usage events
[0m06:02:00.980306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c3a92180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c44bf260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c60cd460>]}


============================== 06:02:00.988493 | 8da4f272-398b-4d94-8bf4-d2f9b71340e5 ==============================
[0m06:02:00.988493 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:00.989226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:01.129444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8da4f272-398b-4d94-8bf4-d2f9b71340e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c40ee7e0>]}
[0m06:02:01.142642 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-33j3zrqe'
[0m06:02:01.143111 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:01.409356 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:01.410003 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:01.441539 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:01.445348 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:01.778408 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:01.778933 [info ] [MainThread]: Up to date!
[0m06:02:01.779472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8da4f272-398b-4d94-8bf4-d2f9b71340e5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c3792420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c3bfa420>]}
[0m06:02:01.785267 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8534143, "process_user_time": 1.55399, "process_kernel_time": 0.135824, "process_mem_max_rss": "93468", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m06:02:01.785878 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:01.785767 after 0.85 seconds
[0m06:02:01.786334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c44bf260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c3ada840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c38f0d10>]}
[0m06:02:01.786781 [debug] [MainThread]: Flushing usage events
[0m06:02:03.620552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d6133b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d744ccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d68aa0f0>]}


============================== 06:02:03.623242 | 053f4e3e-d3ca-496e-a5a5-ce312824939a ==============================
[0m06:02:03.623242 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:03.623983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:03.851041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d99bbd40>]}
[0m06:02:03.909931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d76435c0>]}
[0m06:02:03.910675 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:03.961937 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:03.962672 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:03.963238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d7199a30>]}
[0m06:02:05.162841 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:05.166730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4cf093e30>]}
[0m06:02:05.355537 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:05.360365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4cefaf8f0>]}
[0m06:02:05.501488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4cefafef0>]}
[0m06:02:05.502055 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:05.502582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4cee8a7b0>]}
[0m06:02:05.504275 [info ] [MainThread]: 
[0m06:02:05.505007 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:05.509721 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:05.544370 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:05.544833 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:05.545250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:06.105041 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:06.106664 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:06.109109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:06.109713 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:06.116624 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.117083 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:06.117497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:06.123351 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.124801 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.125227 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:06.125900 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.126311 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.126724 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:06.127305 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.128236 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:06.128693 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.129093 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:06.129641 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.130063 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:06.132233 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:06.138167 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:06.138624 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:06.139023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:06.145090 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.145600 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:06.146056 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:06.166657 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.171523 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:06.172806 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:06.173236 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:06.176826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d741ff20>]}
[0m06:02:06.177377 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.177786 [debug] [MainThread]: On master: BEGIN
[0m06:02:06.178171 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:06.183372 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.183812 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.184211 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.184642 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.185279 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.185696 [debug] [MainThread]: On master: Close
[0m06:02:06.187429 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:06.187946 [info ] [MainThread]: 
[0m06:02:06.201544 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:06.202239 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:06.202939 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:06.203393 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:06.229251 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:06.230015 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:06.264728 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:06.265683 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:18.678513 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.679106 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:18.679806 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.680282 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.680784 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:18.681525 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.684391 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.684862 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:18.685728 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.706646 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:18.707191 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.707647 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:18.709009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.713966 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.714454 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:18.715750 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.718194 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:18.745276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c4431430>]}
[0m06:02:18.746113 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.54s]
[0m06:02:18.746898 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:18.747899 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:18.748512 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:18.749109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:18.749582 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:18.754726 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:18.755393 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:18.789091 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.789663 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240628060218783159"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:18.790148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:18.806527 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.813933 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.814420 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:18.815088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.815548 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.815994 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240628060218783159'
      
      
      order by ordinal_position

  
[0m06:02:18.848369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.853787 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.854289 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:18.863192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.871932 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.872472 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:18.881454 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.899433 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:18.900170 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.900696 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240628060218783159"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240628060218783159"
    )
  
[0m06:02:18.914951 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.916857 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:18.917326 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.917767 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:18.928528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.929440 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:19.092310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4a2d61b50>]}
[0m06:02:19.093200 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m06:02:19.093955 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:19.095444 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.095932 [debug] [MainThread]: On master: BEGIN
[0m06:02:19.096408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:19.102127 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.102644 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.103098 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.103537 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.104248 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.104770 [debug] [MainThread]: On master: Close
[0m06:02:19.106617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:19.107096 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:19.107522 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:19.108029 [info ] [MainThread]: 
[0m06:02:19.108641 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.60 seconds (13.60s).
[0m06:02:19.109703 [debug] [MainThread]: Command end result
[0m06:02:19.137949 [info ] [MainThread]: 
[0m06:02:19.138654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:19.139212 [info ] [MainThread]: 
[0m06:02:19.139780 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:19.140860 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.568721, "process_user_time": 4.861901, "process_kernel_time": 0.241285, "process_mem_max_rss": "280260", "process_in_blocks": "1184", "process_out_blocks": "109120"}
[0m06:02:19.141521 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:19.141408 after 15.57 seconds
[0m06:02:19.142033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d5e8bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d6279940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d76b5160>]}
[0m06:02:19.142535 [debug] [MainThread]: Flushing usage events
[0m06:02:21.087683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d6a5b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d69965a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d6a5b800>]}


============================== 06:02:21.090595 | ba6019ca-8492-4887-91bd-d07949964611 ==============================
[0m06:02:21.090595 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:21.091325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:21.237569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba6019ca-8492-4887-91bd-d07949964611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d6827f20>]}
[0m06:02:21.254323 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21593904, "process_user_time": 1.447459, "process_kernel_time": 0.099962, "process_mem_max_rss": "92040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:21.254935 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:21.254824 after 0.22 seconds
[0m06:02:21.255396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d6c6aae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d6ad1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d6952c00>]}
[0m06:02:21.255843 [debug] [MainThread]: Flushing usage events
[0m14:04:44.021268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe9009b920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8f18e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8fed3740>]}


============================== 14:04:44.028650 | 0ff9f583-4e56-479c-8331-9903430e139b ==============================
[0m14:04:44.028650 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:44.029339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:44.173584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ff9f583-4e56-479c-8331-9903430e139b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8ee145c0>]}
[0m14:04:44.186905 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-n0grnjt3'
[0m14:04:44.187376 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:44.263164 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:44.263920 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:44.292127 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:44.296198 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:44.344430 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:44.344916 [info ] [MainThread]: Up to date!
[0m14:04:44.345406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0ff9f583-4e56-479c-8331-9903430e139b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8eeadbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8ed782f0>]}
[0m14:04:44.346725 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.37372598, "process_user_time": 1.594642, "process_kernel_time": 0.108179, "process_mem_max_rss": "93680", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m14:04:44.347321 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:44.347217 after 0.37 seconds
[0m14:04:44.347768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe9009b920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8f19f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8f047e30>]}
[0m14:04:44.348201 [debug] [MainThread]: Flushing usage events
[0m14:04:46.044800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4804d81c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480675d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48045edbe0>]}


============================== 14:04:46.047547 | 9d0f04dc-2efe-41cf-8318-1661384f4e23 ==============================
[0m14:04:46.047547 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:46.048226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:04:46.270969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480471b3b0>]}
[0m14:04:46.329809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480471b3b0>]}
[0m14:04:46.330556 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:46.384795 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:46.385539 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:46.386121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48040429c0>]}
[0m14:04:47.585523 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:47.586228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47fd5a8aa0>]}
[0m14:04:47.774650 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:47.779609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47fd588da0>]}
[0m14:04:47.900911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47fd4cf500>]}
[0m14:04:47.901488 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:47.902074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47fd3b3f50>]}
[0m14:04:47.903781 [info ] [MainThread]: 
[0m14:04:47.904505 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:47.909224 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:47.944731 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:47.945228 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:04:47.945653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:48.516819 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:48.518417 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:48.520606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:48.521204 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:48.528061 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:48.528517 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:04:48.528926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:48.534381 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:48.535720 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:48.536136 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:48.536955 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:48.537372 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:48.537814 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:48.538406 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:48.539354 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:48.539774 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:48.540178 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:48.540729 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:48.541151 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:48.543189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:48.548458 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:48.548885 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:48.549271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:48.554079 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:48.554502 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:48.554913 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:04:48.574741 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:48.579491 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:48.580663 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:48.581078 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:48.584166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48043a3a10>]}
[0m14:04:48.584691 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:48.585117 [debug] [MainThread]: On master: BEGIN
[0m14:04:48.585496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:48.590693 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:48.591128 [debug] [MainThread]: On master: COMMIT
[0m14:04:48.591538 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:48.591922 [debug] [MainThread]: On master: COMMIT
[0m14:04:48.592433 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:48.592843 [debug] [MainThread]: On master: Close
[0m14:04:48.594477 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:48.595022 [info ] [MainThread]: 
[0m14:04:48.613822 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:48.614457 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:48.615217 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:48.615679 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:48.641116 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:48.641892 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:48.675918 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:48.676666 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:55.227922 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:55.228461 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:04:55.229269 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.229765 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:55.230227 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:04:55.231043 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.233698 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:55.234197 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:04:55.234914 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.255429 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:55.255932 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:55.256401 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:55.257610 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.262356 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:55.262845 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:04:55.264593 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.266935 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:04:55.292459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d7bb3ec0>]}
[0m14:04:55.293196 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.68s]
[0m14:04:55.294018 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:04:55.295032 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:04:55.295695 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:04:55.296346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:04:55.296818 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:04:55.301557 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:04:55.302241 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:04:55.335687 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:55.336205 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240628140455329486"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:04:55.336695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:55.355185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.362197 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:55.362683 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:04:55.363335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.363795 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:55.364241 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240628140455329486'
      
      
      order by ordinal_position

  
[0m14:04:55.391027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.395851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:55.396339 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:55.404815 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.413318 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:55.413884 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:55.428968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.453610 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:04:55.454364 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:55.454854 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240628140455329486"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240628140455329486"
    )
  
[0m14:04:55.472790 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.474899 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:55.475402 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:55.475862 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:55.500955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.502281 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:04:55.675462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d0be1340>]}
[0m14:04:55.676296 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m14:04:55.677152 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:04:55.678514 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:55.679044 [debug] [MainThread]: On master: BEGIN
[0m14:04:55.679514 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:55.684975 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:55.685462 [debug] [MainThread]: On master: COMMIT
[0m14:04:55.685952 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:55.686390 [debug] [MainThread]: On master: COMMIT
[0m14:04:55.687087 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:55.687554 [debug] [MainThread]: On master: Close
[0m14:04:55.688957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:55.689403 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:04:55.689860 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:04:55.690336 [info ] [MainThread]: 
[0m14:04:55.690872 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.79 seconds (7.79s).
[0m14:04:55.691881 [debug] [MainThread]: Command end result
[0m14:04:55.719476 [info ] [MainThread]: 
[0m14:04:55.720134 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:55.720682 [info ] [MainThread]: 
[0m14:04:55.721232 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:04:55.722252 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.72627, "process_user_time": 4.740103, "process_kernel_time": 0.323461, "process_mem_max_rss": "279468", "process_in_blocks": "1184", "process_out_blocks": "109600"}
[0m14:04:55.722902 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:55.722793 after 9.73 seconds
[0m14:04:55.723400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480675d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48079bc680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48047358e0>]}
[0m14:04:55.723887 [debug] [MainThread]: Flushing usage events
[0m14:04:57.406259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb33adba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb33846120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb33d5ac00>]}


============================== 14:04:57.409005 | 61abf74b-d96b-45c3-b7c4-6e2c0706bfa8 ==============================
[0m14:04:57.409005 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:57.409731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:04:57.553520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61abf74b-d96b-45c3-b7c4-6e2c0706bfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb347483b0>]}
[0m14:04:57.569977 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.212335, "process_user_time": 1.402655, "process_kernel_time": 0.095908, "process_mem_max_rss": "92168", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:04:57.570572 [debug] [MainThread]: Command `dbt clean` succeeded at 14:04:57.570462 after 0.21 seconds
[0m14:04:57.571019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb371bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb34262fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb339adbe0>]}
[0m14:04:57.571475 [debug] [MainThread]: Flushing usage events
[0m22:05:19.936756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881cc47e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881d59f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881cc46300>]}


============================== 22:05:19.944262 | 986511e8-9c19-403b-afac-6fa36876c317 ==============================
[0m22:05:19.944262 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:19.944965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:20.089775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '986511e8-9c19-403b-afac-6fa36876c317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881caf8e90>]}
[0m22:05:20.104069 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hc6o62ti'
[0m22:05:20.104560 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:20.132637 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:20.133400 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:20.145010 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:20.148748 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:20.359814 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:20.360414 [info ] [MainThread]: Up to date!
[0m22:05:20.360982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '986511e8-9c19-403b-afac-6fa36876c317', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881cafa900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881cafaea0>]}
[0m22:05:20.362561 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4747897, "process_user_time": 1.558276, "process_kernel_time": 0.142742, "process_mem_max_rss": "93348", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m22:05:20.363164 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:20.363058 after 0.48 seconds
[0m22:05:20.363612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881ca5fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881d092690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881d091400>]}
[0m22:05:20.364056 [debug] [MainThread]: Flushing usage events
[0m22:05:22.188648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed7f68bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed856e180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed7f68080>]}


============================== 22:05:22.191558 | 93742f37-6dc1-4119-bc22-4abaff892d6b ==============================
[0m22:05:22.191558 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:22.192204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:22.419747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed85efec0>]}
[0m22:05:22.478966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed87dfa10>]}
[0m22:05:22.479800 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:22.495546 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:22.496279 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:22.496850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed8077890>]}
[0m22:05:23.705040 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:23.705737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed13d7cb0>]}
[0m22:05:23.895555 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:23.900818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed1528200>]}
[0m22:05:24.025593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed9c33ef0>]}
[0m22:05:24.026169 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:24.026671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed11a4a10>]}
[0m22:05:24.028358 [info ] [MainThread]: 
[0m22:05:24.029090 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:24.033917 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:24.069309 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:24.069800 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:24.070211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:24.451374 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.453055 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:24.455277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:24.455892 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:24.462845 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.463310 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:24.463718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.469440 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.470929 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.471346 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:24.472021 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.472433 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.472869 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:24.473485 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.474439 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.474851 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.475254 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.475906 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.476333 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:24.478671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:24.484097 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.484531 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:24.484974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.489984 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.490414 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.490828 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:24.510828 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.515676 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:24.516910 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:24.517334 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:24.520627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed84c2d80>]}
[0m22:05:24.521191 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.521592 [debug] [MainThread]: On master: BEGIN
[0m22:05:24.521973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:24.527216 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.527657 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.528056 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.528466 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.529130 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.529556 [debug] [MainThread]: On master: Close
[0m22:05:24.531155 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:24.531712 [info ] [MainThread]: 
[0m22:05:24.540934 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:24.541562 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:24.542310 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:24.542767 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:24.568909 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:24.569680 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:24.604119 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:24.604928 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:33.748283 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.748931 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:33.749773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.750269 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.750732 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:33.751543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.754562 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.755055 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:33.755807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.776847 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:33.777363 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.777818 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:33.779831 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.784771 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.785290 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:33.786749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.789173 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:33.815263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea5377f80>]}
[0m22:05:33.816141 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.27s]
[0m22:05:33.817003 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:33.818074 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:33.818685 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:33.819403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:33.819875 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:33.825011 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:33.825677 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:33.859245 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.859800 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240628220533853299"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:33.860289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:33.875763 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.883238 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.883732 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:33.884425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.884916 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.885377 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240628220533853299'
      
      
      order by ordinal_position

  
[0m22:05:33.911911 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.917185 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.917687 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:33.926249 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.933805 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.934297 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:33.942901 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.962188 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:33.962919 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.963407 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240628220533853299"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240628220533853299"
    )
  
[0m22:05:33.977221 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.979153 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:33.979640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.980081 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:33.989913 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.990890 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:34.165134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea514ff80>]}
[0m22:05:34.165982 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m22:05:34.166853 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:34.168188 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:34.168673 [debug] [MainThread]: On master: BEGIN
[0m22:05:34.169160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:34.174549 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:34.175033 [debug] [MainThread]: On master: COMMIT
[0m22:05:34.175478 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:34.175912 [debug] [MainThread]: On master: COMMIT
[0m22:05:34.176600 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:34.177118 [debug] [MainThread]: On master: Close
[0m22:05:34.178714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:34.179160 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:34.179588 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:34.180058 [info ] [MainThread]: 
[0m22:05:34.180621 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.15 seconds (10.15s).
[0m22:05:34.181680 [debug] [MainThread]: Command end result
[0m22:05:34.209309 [info ] [MainThread]: 
[0m22:05:34.209969 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:34.210519 [info ] [MainThread]: 
[0m22:05:34.211069 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:34.212094 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.072771, "process_user_time": 4.770731, "process_kernel_time": 0.282033, "process_mem_max_rss": "290464", "process_in_blocks": "1184", "process_out_blocks": "108928"}
[0m22:05:34.212748 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:34.212638 after 12.07 seconds
[0m22:05:34.213299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed8077650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed7f6be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb8f5bb60>]}
[0m22:05:34.213794 [debug] [MainThread]: Flushing usage events
[0m22:05:36.137052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca89ae6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca88ed5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcaa9c93d0>]}


============================== 22:05:36.139959 | 5e84a050-c439-4b54-a1bd-35ef267a7bfd ==============================
[0m22:05:36.139959 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:36.140699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:36.286328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e84a050-c439-4b54-a1bd-35ef267a7bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca956c0b0>]}
[0m22:05:36.303081 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21510698, "process_user_time": 1.40863, "process_kernel_time": 0.120053, "process_mem_max_rss": "92156", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:36.303687 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:36.303581 after 0.22 seconds
[0m22:05:36.304150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca88ed5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca86fe390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca88b7ef0>]}
[0m22:05:36.304611 [debug] [MainThread]: Flushing usage events
[0m06:02:07.699968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b008b2330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b008b0170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b01551a30>]}


============================== 06:02:07.744618 | 704a10ad-951c-4618-bafd-c96a7ff48171 ==============================
[0m06:02:07.744618 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:07.745319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.888015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '704a10ad-951c-4618-bafd-c96a7ff48171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b00cc7860>]}
[0m06:02:07.901272 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7q7pq4p7'
[0m06:02:07.901740 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:07.944251 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:07.944911 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:07.957114 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:07.960865 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:08.095284 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:08.095786 [info ] [MainThread]: Up to date!
[0m06:02:08.096330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '704a10ad-951c-4618-bafd-c96a7ff48171', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b0070a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b018d8c80>]}
[0m06:02:08.097921 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44616526, "process_user_time": 1.572341, "process_kernel_time": 0.099767, "process_mem_max_rss": "93312", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m06:02:08.098513 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:08.098408 after 0.45 seconds
[0m06:02:08.098952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b012e3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b006b2c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b0070a960>]}
[0m06:02:08.099388 [debug] [MainThread]: Flushing usage events
[0m06:02:09.727810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cc9cf170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cc9cf2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cd427e00>]}


============================== 06:02:09.730607 | 4d04c263-4adc-4a00-bd02-5790002a2ee2 ==============================
[0m06:02:09.730607 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.731274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:09.961117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cc89b440>]}
[0m06:02:10.019748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cc80d340>]}
[0m06:02:10.020504 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:10.055569 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:10.056312 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:10.056885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cc80eb40>]}
[0m06:02:11.270221 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:11.270911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c5c3b590>]}
[0m06:02:11.460770 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:11.467235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c5cccd70>]}
[0m06:02:11.594135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c5cbad80>]}
[0m06:02:11.594710 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:11.595200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c5a0a150>]}
[0m06:02:11.596907 [info ] [MainThread]: 
[0m06:02:11.597594 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:11.602238 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:11.636822 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:11.637282 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:11.637699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:12.178991 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:12.180580 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:12.182877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:12.183470 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:12.190370 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.190819 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:12.191224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.196660 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.198008 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.198424 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:12.199262 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.199672 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.200064 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:12.200750 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.201698 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.202113 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.202517 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.203062 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.203480 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:12.205639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:12.210920 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.211348 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:12.211749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.216746 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.217172 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.217581 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:12.237487 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.242116 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:12.243312 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:12.243731 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:12.246881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c4948b90>]}
[0m06:02:12.247409 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.247803 [debug] [MainThread]: On master: BEGIN
[0m06:02:12.248179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:12.253330 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.253762 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.254158 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.254543 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.255175 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.255589 [debug] [MainThread]: On master: Close
[0m06:02:12.257124 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:12.257659 [info ] [MainThread]: 
[0m06:02:12.281532 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:12.282143 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:12.282875 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:12.283327 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:12.308698 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:12.309449 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:12.343400 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:12.344138 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:20.013616 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.014207 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:20.014995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.015476 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.015938 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:20.016739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.019615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.020090 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:20.020824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.041582 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.042091 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.042557 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.045068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.049840 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.050326 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:20.052411 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.054732 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:20.080638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2299493590>]}
[0m06:02:20.081385 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.80s]
[0m06:02:20.082271 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:20.083248 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:20.083831 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:20.084556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:20.085035 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:20.089967 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:20.090643 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:20.123964 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.124548 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240629060220118067"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:20.125042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:20.140111 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.147233 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.147721 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:20.148414 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.148884 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.149343 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240629060220118067'
      
      
      order by ordinal_position

  
[0m06:02:20.176019 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.181075 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.181591 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:20.190108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.197549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.198043 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:20.212425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.231520 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:20.232234 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.232765 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240629060220118067"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240629060220118067"
    )
  
[0m06:02:20.247127 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.249055 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:20.249539 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.249990 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:20.260038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.261026 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:20.436808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22992eee40>]}
[0m06:02:20.437662 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m06:02:20.438462 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:20.439940 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.440471 [debug] [MainThread]: On master: BEGIN
[0m06:02:20.440924 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:20.446344 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.446836 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.447291 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.447737 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.448462 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.448942 [debug] [MainThread]: On master: Close
[0m06:02:20.450635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:20.451089 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:20.451514 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:20.451993 [info ] [MainThread]: 
[0m06:02:20.452574 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.85 seconds (8.85s).
[0m06:02:20.453604 [debug] [MainThread]: Command end result
[0m06:02:20.481818 [info ] [MainThread]: 
[0m06:02:20.482485 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:20.483010 [info ] [MainThread]: 
[0m06:02:20.483539 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:20.484560 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.805444, "process_user_time": 4.719902, "process_kernel_time": 0.289219, "process_mem_max_rss": "276716", "process_in_blocks": "1184", "process_out_blocks": "108912"}
[0m06:02:20.485226 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:20.485113 after 10.81 seconds
[0m06:02:20.485727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cc95fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2299b23d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2299374980>]}
[0m06:02:20.486257 [debug] [MainThread]: Flushing usage events
[0m06:02:22.186283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85646ff980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856351b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8563518ad0>]}


============================== 06:02:22.189153 | 58d80699-44cf-401c-893c-b7a45a486e70 ==============================
[0m06:02:22.189153 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:22.189813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:22.328001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58d80699-44cf-401c-893c-b7a45a486e70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8563303bf0>]}
[0m06:02:22.344177 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20647684, "process_user_time": 1.399729, "process_kernel_time": 0.104277, "process_mem_max_rss": "91876", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:22.344790 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:22.344687 after 0.21 seconds
[0m06:02:22.345264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856354fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856339a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8563301790>]}
[0m06:02:22.345736 [debug] [MainThread]: Flushing usage events
[0m14:04:33.943835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10be47e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10bed933b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10be88dbe0>]}


============================== 14:04:33.950920 | d1b33c93-48c7-4abb-81ed-9be8ded03881 ==============================
[0m14:04:33.950920 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:33.951603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:04:34.088145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1b33c93-48c7-4abb-81ed-9be8ded03881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10be27f980>]}
[0m14:04:34.101250 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2wi1cqek'
[0m14:04:34.101708 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:34.197761 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:34.198463 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:34.210090 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:34.213944 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:34.281906 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:34.282472 [info ] [MainThread]: Up to date!
[0m14:04:34.283030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd1b33c93-48c7-4abb-81ed-9be8ded03881', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10beb05670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10be189250>]}
[0m14:04:34.284551 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3885446, "process_user_time": 1.559477, "process_kernel_time": 0.095722, "process_mem_max_rss": "93692", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m14:04:34.285158 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:34.285052 after 0.39 seconds
[0m14:04:34.285605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10bf0c70b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10be5ab2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10be2d4da0>]}
[0m14:04:34.286046 [debug] [MainThread]: Flushing usage events
[0m14:04:35.877402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0617feab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff061b1e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff06233caa0>]}


============================== 14:04:35.880287 | c861e98d-8df4-496a-b488-1587eeeb86cd ==============================
[0m14:04:35.880287 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:35.880952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:36.110616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0617cb620>]}
[0m14:04:36.169977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff062992f00>]}
[0m14:04:36.170870 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:36.186934 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:36.187710 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:36.188282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0615acef0>]}
[0m14:04:37.394037 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:37.394752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0627b9af0>]}
[0m14:04:37.584319 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:37.589323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05a9f8200>]}
[0m14:04:37.716198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05a7559a0>]}
[0m14:04:37.716793 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:37.717359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05a7b7ef0>]}
[0m14:04:37.719099 [info ] [MainThread]: 
[0m14:04:37.719876 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:37.724879 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:37.760927 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:37.761440 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:04:37.761863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:38.325713 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:38.327266 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:38.329562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:38.330170 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:38.337150 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:38.337601 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:04:38.338011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:38.343563 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:38.344919 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:38.345337 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:38.346177 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:38.346589 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:38.346991 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:38.347595 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:38.348553 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:38.348968 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:38.349361 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:38.349912 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:38.350335 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:38.352564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:38.358133 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:38.358558 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:38.358955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:38.364126 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:38.364558 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:38.364964 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:04:38.385329 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:38.390395 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:38.391724 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:38.392219 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:38.395946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05a7dbda0>]}
[0m14:04:38.396488 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:38.396895 [debug] [MainThread]: On master: BEGIN
[0m14:04:38.397279 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:38.402587 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:38.403022 [debug] [MainThread]: On master: COMMIT
[0m14:04:38.403477 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:38.403871 [debug] [MainThread]: On master: COMMIT
[0m14:04:38.404503 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:38.404922 [debug] [MainThread]: On master: Close
[0m14:04:38.406407 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:38.406909 [info ] [MainThread]: 
[0m14:04:38.416047 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:38.416669 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:38.417347 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:38.417800 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:38.443477 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:38.444237 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:38.478344 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:38.479095 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:45.567831 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:45.568429 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:04:45.569459 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.569959 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:45.570442 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:04:45.571230 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.574178 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:45.574652 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:04:45.575402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.596186 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:45.596692 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:45.597157 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:45.599221 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.604160 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:45.604642 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:04:45.606012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.608382 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:04:45.633526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02a717e90>]}
[0m14:04:45.634294 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.22s]
[0m14:04:45.635191 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:04:45.636235 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:04:45.636824 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:04:45.637507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:04:45.637990 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:04:45.642940 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:04:45.643654 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:04:45.677315 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:45.677850 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240629140445671423"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:04:45.678341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:45.694025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.701427 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:45.701932 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:04:45.702568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.703037 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:45.703515 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240629140445671423'
      
      
      order by ordinal_position

  
[0m14:04:45.730083 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.735501 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:45.736059 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:45.750649 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.758977 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:45.759545 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:45.770364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.797248 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:04:45.798405 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:45.799280 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240629140445671423"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240629140445671423"
    )
  
[0m14:04:45.820664 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.822892 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:45.823467 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:45.823953 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:45.844912 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.845910 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:04:46.030045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02a699430>]}
[0m14:04:46.030881 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.39s]
[0m14:04:46.031782 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:04:46.033130 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:46.033608 [debug] [MainThread]: On master: BEGIN
[0m14:04:46.034047 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:46.039472 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:46.039961 [debug] [MainThread]: On master: COMMIT
[0m14:04:46.040411 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:46.040844 [debug] [MainThread]: On master: COMMIT
[0m14:04:46.041542 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:46.042013 [debug] [MainThread]: On master: Close
[0m14:04:46.043552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:46.044005 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:04:46.044423 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:04:46.044899 [info ] [MainThread]: 
[0m14:04:46.045499 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.33 seconds (8.33s).
[0m14:04:46.046614 [debug] [MainThread]: Command end result
[0m14:04:46.074348 [info ] [MainThread]: 
[0m14:04:46.075065 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:46.075705 [info ] [MainThread]: 
[0m14:04:46.076327 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:04:46.077419 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.248616, "process_user_time": 4.792791, "process_kernel_time": 0.284521, "process_mem_max_rss": "271740", "process_in_blocks": "1184", "process_out_blocks": "109424"}
[0m14:04:46.078075 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:46.077963 after 10.25 seconds
[0m14:04:46.078583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff065567d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff062e53a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff063359b20>]}
[0m14:04:46.079082 [debug] [MainThread]: Flushing usage events
[0m14:04:47.687677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3698360230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369a815340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36987e4aa0>]}


============================== 14:04:47.690434 | ab5c0ba9-051d-43d2-93ba-33536a8506f3 ==============================
[0m14:04:47.690434 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:47.691078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:47.831801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab5c0ba9-051d-43d2-93ba-33536a8506f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3698363050>]}
[0m14:04:47.848005 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20940295, "process_user_time": 1.392168, "process_kernel_time": 0.112013, "process_mem_max_rss": "92124", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:04:47.848605 [debug] [MainThread]: Command `dbt clean` succeeded at 14:04:47.848502 after 0.21 seconds
[0m14:04:47.849053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3699b87290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36981c62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36981850d0>]}
[0m14:04:47.849495 [debug] [MainThread]: Flushing usage events
[0m22:05:11.805553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790c0a8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790bfd2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790c0ab350>]}


============================== 22:05:11.813167 | b91aec07-8010-4fde-a135-16073d623540 ==============================
[0m22:05:11.813167 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:11.813972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:11.962675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b91aec07-8010-4fde-a135-16073d623540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790cd19a00>]}
[0m22:05:11.976245 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3lfglk0y'
[0m22:05:11.976736 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:12.076019 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:12.076758 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:12.087365 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:12.091225 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:12.305856 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:12.306440 [info ] [MainThread]: Up to date!
[0m22:05:12.306988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b91aec07-8010-4fde-a135-16073d623540', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790b405d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790b405370>]}
[0m22:05:12.308470 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.55139095, "process_user_time": 1.626261, "process_kernel_time": 0.107884, "process_mem_max_rss": "93412", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m22:05:12.309089 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:12.308981 after 0.55 seconds
[0m22:05:12.309594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790c0451c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790f367d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790c1830b0>]}
[0m22:05:12.310049 [debug] [MainThread]: Flushing usage events
[0m22:05:14.178867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbccc642000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcca9604a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcca9616d0>]}


============================== 22:05:14.181838 | 0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405 ==============================
[0m22:05:14.181838 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:14.182490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:14.412003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcca1b7ec0>]}
[0m22:05:14.471680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbccaea4a40>]}
[0m22:05:14.472565 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:14.517060 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:14.517875 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:14.518456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc9d50d10>]}
[0m22:05:15.734781 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:15.735522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc32f5d00>]}
[0m22:05:15.925936 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:15.931180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc30661e0>]}
[0m22:05:16.056378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc2f302c0>]}
[0m22:05:16.056982 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:16.057553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc2f6c890>]}
[0m22:05:16.059381 [info ] [MainThread]: 
[0m22:05:16.060127 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:16.064972 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:16.101005 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:16.101547 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:16.101961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:16.451752 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.453370 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:16.455846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:16.456452 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:16.463505 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:16.463983 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:16.464405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:16.470125 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.471536 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:16.471965 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:16.472507 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.472935 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:16.473393 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:16.474192 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.475166 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:16.475579 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:16.476006 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:16.476673 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.477104 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:16.479550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:16.485102 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:16.485576 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:16.485964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:16.491182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.491641 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:16.492046 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:16.511517 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.516250 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:16.517489 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:16.517911 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:16.521685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc2f6f710>]}
[0m22:05:16.522211 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:16.522612 [debug] [MainThread]: On master: BEGIN
[0m22:05:16.522992 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:16.528090 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:16.528518 [debug] [MainThread]: On master: COMMIT
[0m22:05:16.528915 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:16.529341 [debug] [MainThread]: On master: COMMIT
[0m22:05:16.529968 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:16.530379 [debug] [MainThread]: On master: Close
[0m22:05:16.531859 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:16.532412 [info ] [MainThread]: 
[0m22:05:16.541862 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:16.542492 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:16.543229 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:16.543680 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:16.569441 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:16.570276 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:16.604926 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:16.605881 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:26.003899 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:26.004515 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:26.005355 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.005830 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:26.006282 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:26.007064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.010067 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:26.010549 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:26.011294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.032396 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:26.032989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:26.033508 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:26.035518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.040665 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:26.041203 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:26.042667 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.045235 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:26.072090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc93467f20>]}
[0m22:05:26.072974 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.53s]
[0m22:05:26.073843 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:26.074879 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:26.075463 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:26.076107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:26.076576 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:26.081877 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:26.082615 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:26.117123 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:26.117750 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240629220526110993"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:26.118246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:26.132078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.139653 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:26.140150 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:26.140806 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.141300 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:26.141756 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240629220526110993'
      
      
      order by ordinal_position

  
[0m22:05:26.168556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.174265 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:26.174789 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:26.183540 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.191123 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:26.191621 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:26.205874 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.225228 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:26.225962 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:26.226445 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240629220526110993"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240629220526110993"
    )
  
[0m22:05:26.241244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.243288 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:26.243761 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:26.244206 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:26.253671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.254640 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:26.445615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc92e292e0>]}
[0m22:05:26.446464 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m22:05:26.447229 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:26.448729 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:26.449247 [debug] [MainThread]: On master: BEGIN
[0m22:05:26.449694 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:26.455108 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:26.455593 [debug] [MainThread]: On master: COMMIT
[0m22:05:26.456037 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:26.456468 [debug] [MainThread]: On master: COMMIT
[0m22:05:26.457158 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:26.457636 [debug] [MainThread]: On master: Close
[0m22:05:26.459107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:26.459558 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:26.459974 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:26.460441 [info ] [MainThread]: 
[0m22:05:26.460996 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.40 seconds (10.40s).
[0m22:05:26.462091 [debug] [MainThread]: Command end result
[0m22:05:26.489870 [info ] [MainThread]: 
[0m22:05:26.490564 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:26.491125 [info ] [MainThread]: 
[0m22:05:26.491692 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:26.492740 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.362995, "process_user_time": 4.764984, "process_kernel_time": 0.332907, "process_mem_max_rss": "282192", "process_in_blocks": "1184", "process_out_blocks": "109952"}
[0m22:05:26.493430 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:26.493318 after 12.36 seconds
[0m22:05:26.493943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcca1eaae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc9e83d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc92e498b0>]}
[0m22:05:26.494439 [debug] [MainThread]: Flushing usage events
[0m22:05:28.431530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ea517800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ea5176b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ea0809b0>]}


============================== 22:05:28.434444 | e35743db-11a8-4661-a6f5-05750594fde1 ==============================
[0m22:05:28.434444 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:28.435126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:28.577633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e35743db-11a8-4661-a6f5-05750594fde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3eae2dd60>]}
[0m22:05:28.594156 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2115214, "process_user_time": 1.430046, "process_kernel_time": 0.087879, "process_mem_max_rss": "92284", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:28.594759 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:28.594655 after 0.21 seconds
[0m22:05:28.595220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ea081010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ea063a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e9f9be00>]}
[0m22:05:28.595668 [debug] [MainThread]: Flushing usage events
[0m06:02:35.541370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2ca61bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2c3f49b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2ca63170>]}


============================== 06:02:35.621940 | 9330f291-fcae-4b12-a6b7-9342c7c40fad ==============================
[0m06:02:35.621940 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:35.622725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:35.772313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9330f291-fcae-4b12-a6b7-9342c7c40fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2bde6db0>]}
[0m06:02:35.786192 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-p97fvq__'
[0m06:02:35.786688 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:35.854779 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:35.855539 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:35.878931 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:35.882840 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:35.958187 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:35.958791 [info ] [MainThread]: Up to date!
[0m06:02:35.959334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9330f291-fcae-4b12-a6b7-9342c7c40fad', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2c14a240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2cda5430>]}
[0m06:02:35.961703 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4696397, "process_user_time": 1.635888, "process_kernel_time": 0.119991, "process_mem_max_rss": "93692", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m06:02:35.962306 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:35.962200 after 0.47 seconds
[0m06:02:35.962750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2c3f49b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2ca61bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2c14a240>]}
[0m06:02:35.963196 [debug] [MainThread]: Flushing usage events
[0m06:02:37.760678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613f881ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6141cc51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6141cc57f0>]}


============================== 06:02:37.763924 | 46688d0d-a85e-4320-89f7-c483a4c48b7f ==============================
[0m06:02:37.763924 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:37.764674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:38.021336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613f664530>]}
[0m06:02:38.086560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613f6d3140>]}
[0m06:02:38.087553 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:38.204081 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:38.204951 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:38.205578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61387ab9b0>]}
[0m06:02:39.497535 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:39.498339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613860b620>]}
[0m06:02:39.706748 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:39.712362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613831ccb0>]}
[0m06:02:39.851997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613f730d70>]}
[0m06:02:39.852619 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:39.853200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613fcab8c0>]}
[0m06:02:39.855007 [info ] [MainThread]: 
[0m06:02:39.855786 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:39.860844 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:39.897758 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:39.898293 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:39.898730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:40.463340 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:40.464978 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:40.467273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:40.467890 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:40.474801 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:40.475266 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:40.475723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:40.481634 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:40.483169 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:40.483637 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:40.484239 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:40.484712 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:40.485111 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:40.485715 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:40.486690 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:40.487101 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:40.487499 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:40.488095 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:40.488532 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:40.490942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:40.496659 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:40.497107 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:40.497503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:40.503149 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:40.503669 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:40.504102 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:40.525068 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:40.530299 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:40.531688 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:40.532170 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:40.536924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61382c84a0>]}
[0m06:02:40.537494 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:40.537912 [debug] [MainThread]: On master: BEGIN
[0m06:02:40.538306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:40.543889 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:40.544376 [debug] [MainThread]: On master: COMMIT
[0m06:02:40.544800 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:40.545214 [debug] [MainThread]: On master: COMMIT
[0m06:02:40.545867 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:40.546301 [debug] [MainThread]: On master: Close
[0m06:02:40.548126 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:40.548640 [info ] [MainThread]: 
[0m06:02:40.593340 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:40.594048 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:40.594757 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:40.595215 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:40.621375 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:40.622335 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:40.657999 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:40.658987 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:49.604326 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:49.604987 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:49.605880 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.606389 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:49.606859 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:49.607741 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.610871 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:49.611360 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:49.612216 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.633882 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:49.634500 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:49.634999 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:49.636773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.642040 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:49.642547 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:49.644357 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.646928 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:49.676802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610c16fc50>]}
[0m06:02:49.677693 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.08s]
[0m06:02:49.678549 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:49.679658 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:49.680299 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:49.680943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:49.681431 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:49.686808 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:49.687517 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:49.722379 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:49.723020 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240630060249716173"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:49.723583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:49.739547 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.747592 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:49.748152 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:49.748865 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.749351 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:49.749818 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240630060249716173'
      
      
      order by ordinal_position

  
[0m06:02:49.783276 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.789271 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:49.789837 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:49.798883 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.807037 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:49.807601 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:49.817052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.838927 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:49.839897 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:49.840457 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240630060249716173"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240630060249716173"
    )
  
[0m06:02:49.858171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.860452 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:49.861036 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:49.861532 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:49.870029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.871066 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:50.067944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610c1e6ed0>]}
[0m06:02:50.068825 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.39s]
[0m06:02:50.069592 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:50.071071 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:50.071626 [debug] [MainThread]: On master: BEGIN
[0m06:02:50.072097 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:50.077690 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:50.078201 [debug] [MainThread]: On master: COMMIT
[0m06:02:50.078661 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:50.079097 [debug] [MainThread]: On master: COMMIT
[0m06:02:50.079708 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:50.080188 [debug] [MainThread]: On master: Close
[0m06:02:50.081790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:50.082243 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:50.082665 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:50.083151 [info ] [MainThread]: 
[0m06:02:50.083743 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.23 seconds (10.23s).
[0m06:02:50.084805 [debug] [MainThread]: Command end result
[0m06:02:50.113372 [info ] [MainThread]: 
[0m06:02:50.114109 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:50.114668 [info ] [MainThread]: 
[0m06:02:50.115236 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:50.116360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.409639, "process_user_time": 5.088242, "process_kernel_time": 0.284909, "process_mem_max_rss": "271624", "process_in_blocks": "1184", "process_out_blocks": "110448"}
[0m06:02:50.117033 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:50.116919 after 12.41 seconds
[0m06:02:50.117552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f614012ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6141cc6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610c1c53a0>]}
[0m06:02:50.118054 [debug] [MainThread]: Flushing usage events
[0m06:02:51.832835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8faad93380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8faae02330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fab0c38c0>]}


============================== 06:02:51.836063 | e8a536f6-c57d-4bd3-ba8a-965764890d1a ==============================
[0m06:02:51.836063 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:51.836845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:52.009658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8a536f6-c57d-4bd3-ba8a-965764890d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8faab7b050>]}
[0m06:02:52.027661 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.24849483, "process_user_time": 1.520109, "process_kernel_time": 0.104281, "process_mem_max_rss": "91836", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:52.028307 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:52.028198 after 0.25 seconds
[0m06:02:52.028784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8faaea17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8faaa61fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8faab483e0>]}
[0m06:02:52.029254 [debug] [MainThread]: Flushing usage events
[0m14:05:23.393807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff405ffee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff405378170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff405378f50>]}


============================== 14:05:23.401072 | 97abaa12-1450-4118-8456-29c0e54e48b1 ==============================
[0m14:05:23.401072 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.401799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:23.537031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97abaa12-1450-4118-8456-29c0e54e48b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4055c76b0>]}
[0m14:05:23.550088 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6du6k86l'
[0m14:05:23.550545 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:23.640697 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:23.641322 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:23.693303 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:23.697176 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:23.785348 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:23.785894 [info ] [MainThread]: Up to date!
[0m14:05:23.786448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '97abaa12-1450-4118-8456-29c0e54e48b1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4053d2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4052399a0>]}
[0m14:05:23.787729 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44139385, "process_user_time": 1.539298, "process_kernel_time": 0.112828, "process_mem_max_rss": "93792", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m14:05:23.788319 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:23.788216 after 0.44 seconds
[0m14:05:23.788761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4055c2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4052d43e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff405988b30>]}
[0m14:05:23.789191 [debug] [MainThread]: Flushing usage events
[0m14:05:25.323692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd8514b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd875c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd99c1310>]}


============================== 14:05:25.326409 | b6377189-090f-4547-91bb-d5ab025b4ca8 ==============================
[0m14:05:25.326409 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:25.327128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:25.549040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd9c171d0>]}
[0m14:05:25.607440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd1966c60>]}
[0m14:05:25.608140 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:25.640266 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:25.640976 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:25.641530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd182ab70>]}
[0m14:05:26.836764 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:26.837361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd1738da0>]}
[0m14:05:27.023352 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:27.028032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd95b5d60>]}
[0m14:05:27.144293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd15f0c50>]}
[0m14:05:27.144839 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:27.145345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd14aeb40>]}
[0m14:05:27.146975 [info ] [MainThread]: 
[0m14:05:27.147678 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:27.152390 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:27.186516 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:27.186970 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:27.187428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:27.694577 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:27.696184 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:27.698368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:27.698955 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:27.705778 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:27.706231 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:27.706639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:27.712052 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:27.713378 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:27.713796 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:27.714652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:27.715068 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:27.715522 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:27.716142 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:27.717081 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:27.717492 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:27.717880 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:27.718419 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:27.718835 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:27.720979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:27.726245 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:27.726675 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:27.727069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:27.731897 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:27.732321 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:27.732728 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:27.752233 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:27.756868 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:27.758032 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:27.758446 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:27.761409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd8fcb620>]}
[0m14:05:27.761930 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:27.762334 [debug] [MainThread]: On master: BEGIN
[0m14:05:27.762711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:27.767667 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:27.768091 [debug] [MainThread]: On master: COMMIT
[0m14:05:27.768564 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:27.768964 [debug] [MainThread]: On master: COMMIT
[0m14:05:27.769469 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:27.769875 [debug] [MainThread]: On master: Close
[0m14:05:27.771288 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:27.771774 [info ] [MainThread]: 
[0m14:05:27.780487 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:27.781080 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:27.781701 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:27.782144 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:27.807480 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:27.808213 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:27.842269 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:27.843004 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:34.307744 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.308323 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:34.309094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.309572 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.310031 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:34.310787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.313643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.314126 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:34.314833 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.335573 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:34.336067 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.336517 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:34.337751 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.342496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.342979 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:34.344152 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.346449 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:34.371063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fc0f92ed0>]}
[0m14:05:34.371814 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.59s]
[0m14:05:34.372565 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:34.373508 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:34.374080 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:34.374652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:34.375111 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:34.379940 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:34.380591 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:34.413812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.414334 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240630140534407994"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:34.414822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:34.429838 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.436706 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.437184 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:34.437772 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.438234 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.438689 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240630140534407994'
      
      
      order by ordinal_position

  
[0m14:05:34.470306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.475162 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.475685 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:34.484020 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.491236 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.491729 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:34.500179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.519072 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:34.519784 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.520266 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240630140534407994"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240630140534407994"
    )
  
[0m14:05:34.534398 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.536126 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:34.536591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.537025 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:34.547046 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.547946 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:34.705265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fc8778740>]}
[0m14:05:34.706103 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m14:05:34.706850 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:34.708233 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.708718 [debug] [MainThread]: On master: BEGIN
[0m14:05:34.709158 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:34.714403 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.714895 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.715378 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.715819 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.716511 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.716978 [debug] [MainThread]: On master: Close
[0m14:05:34.718368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:34.718821 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:34.719267 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:34.719749 [info ] [MainThread]: 
[0m14:05:34.720272 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.57 seconds (7.57s).
[0m14:05:34.721261 [debug] [MainThread]: Command end result
[0m14:05:34.748714 [info ] [MainThread]: 
[0m14:05:34.749327 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:34.749843 [info ] [MainThread]: 
[0m14:05:34.750376 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:34.751369 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.476417, "process_user_time": 4.685581, "process_kernel_time": 0.343236, "process_mem_max_rss": "293316", "process_in_blocks": "1184", "process_out_blocks": "106864"}
[0m14:05:34.752015 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:34.751907 after 9.48 seconds
[0m14:05:34.752517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd81f0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd99efe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd9ad8da0>]}
[0m14:05:34.753008 [debug] [MainThread]: Flushing usage events
[0m14:05:36.344993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa43569bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa42296600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa4181b8c0>]}


============================== 14:05:36.347695 | 5ec6e506-1b80-43da-81e6-00bfacf220ce ==============================
[0m14:05:36.347695 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:36.348414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:36.485167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ec6e506-1b80-43da-81e6-00bfacf220ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa417e1eb0>]}
[0m14:05:36.501149 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20449881, "process_user_time": 1.416213, "process_kernel_time": 0.084012, "process_mem_max_rss": "92148", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:36.501721 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:36.501621 after 0.21 seconds
[0m14:05:36.502164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa41fe7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa4181b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa417e1eb0>]}
[0m14:05:36.502601 [debug] [MainThread]: Flushing usage events
[0m22:05:23.478966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769ac565a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769ad507a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769ad53a40>]}


============================== 22:05:23.511502 | 912ce4a2-07b9-45ef-90f2-d80424e70492 ==============================
[0m22:05:23.511502 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:23.512184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:23.651649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '912ce4a2-07b9-45ef-90f2-d80424e70492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769a70c410>]}
[0m22:05:23.664904 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qa8jm4fa'
[0m22:05:23.665379 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:23.845333 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:23.846149 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:23.908442 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:23.912293 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:24.083274 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:24.083889 [info ] [MainThread]: Up to date!
[0m22:05:24.084495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '912ce4a2-07b9-45ef-90f2-d80424e70492', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769a630770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769a6c58b0>]}
[0m22:05:24.085908 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6553382, "process_user_time": 1.578024, "process_kernel_time": 0.123532, "process_mem_max_rss": "93676", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m22:05:24.086576 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:24.086469 after 0.66 seconds
[0m22:05:24.087024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769e3bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769a70d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769a70cb30>]}
[0m22:05:24.087471 [debug] [MainThread]: Flushing usage events
[0m22:05:25.722228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fe8cf320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ffa5e7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fe8cf440>]}


============================== 22:05:25.724955 | c12e0c07-24a8-4809-8926-088130413e74 ==============================
[0m22:05:25.724955 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:25.725610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:25.949723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ff17a840>]}
[0m22:05:26.008130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fe7660c0>]}
[0m22:05:26.008893 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:26.041668 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:26.042430 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:26.042987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fe93e1e0>]}
[0m22:05:27.246986 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:27.247695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f7522480>]}
[0m22:05:27.436463 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:27.441423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f7238200>]}
[0m22:05:27.563719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f73dba70>]}
[0m22:05:27.564427 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:27.565025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f72737a0>]}
[0m22:05:27.566765 [info ] [MainThread]: 
[0m22:05:27.567517 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:27.572306 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:27.607041 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:27.607498 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:27.607909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:28.175276 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:28.176862 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:28.179250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:28.179846 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:28.186748 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:28.187196 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:28.187610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:28.193318 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:28.194720 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:28.195139 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:28.195988 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:28.196402 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:28.196797 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:28.197382 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:28.198366 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:28.198787 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:28.199177 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:28.199725 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:28.200146 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:28.202200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:28.207527 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:28.207956 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:28.208348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:28.213377 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:28.213806 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:28.214288 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:28.234662 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:28.239399 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:28.240595 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:28.241016 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:28.244853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fff89d30>]}
[0m22:05:28.245383 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:28.245783 [debug] [MainThread]: On master: BEGIN
[0m22:05:28.246205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:28.251245 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:28.251684 [debug] [MainThread]: On master: COMMIT
[0m22:05:28.252081 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:28.252469 [debug] [MainThread]: On master: COMMIT
[0m22:05:28.252990 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:28.253400 [debug] [MainThread]: On master: Close
[0m22:05:28.254825 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:28.255376 [info ] [MainThread]: 
[0m22:05:28.279993 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:28.280619 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:28.281351 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:28.281816 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:28.307250 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:28.308071 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:28.342459 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:28.343257 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:35.446227 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.446826 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:35.447626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.448108 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.448576 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:35.449361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.452258 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.452736 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:35.453466 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.474181 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:35.474685 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.475139 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:35.476412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.481216 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.481703 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:35.483050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.485351 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:35.510720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c7172d50>]}
[0m22:05:35.511519 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.23s]
[0m22:05:35.512304 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:35.513339 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:35.513949 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:35.514546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:35.515025 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:35.520087 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:35.520757 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:35.554117 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.554641 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240630220535548226"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:35.555133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:35.568527 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.575417 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.575899 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:35.576515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.576978 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.577431 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240630220535548226'
      
      
      order by ordinal_position

  
[0m22:05:35.609692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.614674 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.615163 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:35.623743 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.631046 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.631537 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:35.640492 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.659669 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:35.660376 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.660871 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240630220535548226"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240630220535548226"
    )
  
[0m22:05:35.673494 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.675268 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:35.675733 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.676169 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:35.685652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.686582 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:35.958485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c71b7980>]}
[0m22:05:35.959501 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.44s]
[0m22:05:35.960444 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:35.962305 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:35.962796 [debug] [MainThread]: On master: BEGIN
[0m22:05:35.963250 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:35.969858 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:35.970380 [debug] [MainThread]: On master: COMMIT
[0m22:05:35.970829 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:35.971266 [debug] [MainThread]: On master: COMMIT
[0m22:05:35.971977 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:35.972448 [debug] [MainThread]: On master: Close
[0m22:05:35.973911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:35.974390 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:35.974801 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:35.975280 [info ] [MainThread]: 
[0m22:05:35.975870 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.41 seconds (8.41s).
[0m22:05:35.976899 [debug] [MainThread]: Command end result
[0m22:05:36.009010 [info ] [MainThread]: 
[0m22:05:36.009751 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:36.010395 [info ] [MainThread]: 
[0m22:05:36.011003 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:36.012074 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.338226, "process_user_time": 4.671705, "process_kernel_time": 0.307717, "process_mem_max_rss": "275288", "process_in_blocks": "1184", "process_out_blocks": "106888"}
[0m22:05:36.012731 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:36.012622 after 10.34 seconds
[0m22:05:36.013238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fe858950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74023bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c71b0890>]}
[0m22:05:36.013731 [debug] [MainThread]: Flushing usage events
[0m22:05:37.747991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293dfe2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293ea888f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2940095340>]}


============================== 22:05:37.750742 | 5eb55665-3b48-4809-b2f5-40a8742d4023 ==============================
[0m22:05:37.750742 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:37.751413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:37.891162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5eb55665-3b48-4809-b2f5-40a8742d4023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293dc1b4d0>]}
[0m22:05:37.907430 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20791948, "process_user_time": 1.377325, "process_kernel_time": 0.123759, "process_mem_max_rss": "92268", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:37.908018 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:37.907915 after 0.21 seconds
[0m22:05:37.908464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293e6a1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293da9b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293da12c60>]}
[0m22:05:37.908907 [debug] [MainThread]: Flushing usage events
[0m06:02:09.827356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccbc11700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccabab380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cca45e600>]}


============================== 06:02:09.853365 | fca7f0b5-61f3-49f2-a853-3258ee36e056 ==============================
[0m06:02:09.853365 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.854095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.001063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fca7f0b5-61f3-49f2-a853-3258ee36e056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cca6e2120>]}
[0m06:02:10.015483 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-m0jx8aeo'
[0m06:02:10.015987 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.062293 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.063097 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.074877 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.078861 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.292694 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.293341 [info ] [MainThread]: Up to date!
[0m06:02:10.294004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fca7f0b5-61f3-49f2-a853-3258ee36e056', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cc9d61880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccb060950>]}
[0m06:02:10.295623 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5177814, "process_user_time": 1.561708, "process_kernel_time": 0.147406, "process_mem_max_rss": "93560", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m06:02:10.296244 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:10.296137 after 0.52 seconds
[0m06:02:10.296697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccbc11700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cc9e3fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cca0623c0>]}
[0m06:02:10.297151 [debug] [MainThread]: Flushing usage events
[0m06:02:12.162264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f048ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1efb8b1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1efa13350>]}


============================== 06:02:12.165253 | bfa0a6ac-073b-486a-bd72-16065c89cddf ==============================
[0m06:02:12.165253 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.166050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.405474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e8f24140>]}
[0m06:02:12.465514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ef8b3050>]}
[0m06:02:12.466452 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:12.557854 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:12.558675 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:12.559281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ef851df0>]}
[0m06:02:13.779436 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:13.780180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e8cf9820>]}
[0m06:02:13.974841 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:13.980426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e8cf8bf0>]}
[0m06:02:14.139737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f10a7a40>]}
[0m06:02:14.140389 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:14.140927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e8a398b0>]}
[0m06:02:14.142763 [info ] [MainThread]: 
[0m06:02:14.143530 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.148514 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.184500 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.185033 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:14.185450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:14.490998 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.492600 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:14.494754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:14.495363 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:14.502101 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.502559 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:14.502966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.508584 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.509962 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.510375 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:14.511229 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.511715 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.512110 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:14.512781 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.513734 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.514141 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.514532 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.515080 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.515552 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:14.517933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:14.523427 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.523855 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:14.524251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.529400 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.529835 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.530244 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:14.550418 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.555355 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:14.556587 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:14.557002 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:14.560606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e8a74fb0>]}
[0m06:02:14.561166 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.561585 [debug] [MainThread]: On master: BEGIN
[0m06:02:14.561983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:14.567499 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.567989 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.568408 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.568814 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.569473 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.569909 [debug] [MainThread]: On master: Close
[0m06:02:14.571768 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:14.572291 [info ] [MainThread]: 
[0m06:02:14.581410 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:14.582079 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:14.582787 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:14.583304 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:14.609057 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:14.609900 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:14.644604 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:14.645517 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:23.091273 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.091901 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:23.092731 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.093225 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.093689 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:23.094507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.097504 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.097987 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:23.098735 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.119720 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.120228 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.120687 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.122031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.126897 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.127419 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:23.128652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.131011 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:23.155968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bcbe7830>]}
[0m06:02:23.156766 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.57s]
[0m06:02:23.157676 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:23.158706 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:23.159357 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:23.160055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:23.160527 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:23.165584 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:23.166256 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:23.200426 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.200969 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240701060223194468"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:23.201464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:23.216111 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.223496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.224002 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:23.224628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.225104 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.225556 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240701060223194468'
      
      
      order by ordinal_position

  
[0m06:02:23.251873 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.256933 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.257425 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.265962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.273344 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.273839 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.282452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.301783 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:23.302496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.302977 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240701060223194468"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240701060223194468"
    )
  
[0m06:02:23.317478 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.319389 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:23.319872 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.320313 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:23.328790 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.329697 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:23.466997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bc9bd6a0>]}
[0m06:02:23.467892 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m06:02:23.468783 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:23.470188 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.470690 [debug] [MainThread]: On master: BEGIN
[0m06:02:23.471149 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:23.476651 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.477151 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.477609 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.478055 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.478638 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.479124 [debug] [MainThread]: On master: Close
[0m06:02:23.480872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:23.481337 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:23.481764 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:23.482265 [info ] [MainThread]: 
[0m06:02:23.482880 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.34 seconds (9.34s).
[0m06:02:23.484048 [debug] [MainThread]: Command end result
[0m06:02:23.512192 [info ] [MainThread]: 
[0m06:02:23.512902 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:23.513509 [info ] [MainThread]: 
[0m06:02:23.514129 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:23.515211 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.402095, "process_user_time": 4.761874, "process_kernel_time": 0.312385, "process_mem_max_rss": "268556", "process_in_blocks": "1184", "process_out_blocks": "107896"}
[0m06:02:23.515914 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:23.515801 after 11.40 seconds
[0m06:02:23.516423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1efb22ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1efe382f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1d1dec260>]}
[0m06:02:23.516917 [debug] [MainThread]: Flushing usage events
[0m06:02:25.448733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6bb9a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6c95f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6ba39d90>]}


============================== 06:02:25.451622 | 07d23671-d75c-4d19-8185-3860bde62bc2 ==============================
[0m06:02:25.451622 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.452300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:25.596278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07d23671-d75c-4d19-8185-3860bde62bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6b6291f0>]}
[0m06:02:25.612687 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21297897, "process_user_time": 1.430638, "process_kernel_time": 0.096177, "process_mem_max_rss": "92288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:25.613308 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:25.613204 after 0.21 seconds
[0m06:02:25.613762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6f567d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6b834110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6b5c3f20>]}
[0m06:02:25.614207 [debug] [MainThread]: Flushing usage events
[0m14:04:48.260955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa4e36000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa47a57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa6a09070>]}


============================== 14:04:48.318641 | 5f861c1a-1bdc-4fbf-8dce-14662c837f2b ==============================
[0m14:04:48.318641 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:48.319340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:48.461266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f861c1a-1bdc-4fbf-8dce-14662c837f2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa47a7d40>]}
[0m14:04:48.474726 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-v_erobe_'
[0m14:04:48.475236 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:48.520842 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:48.521522 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:48.531944 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:48.535725 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:48.740767 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:48.741372 [info ] [MainThread]: Up to date!
[0m14:04:48.741962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5f861c1a-1bdc-4fbf-8dce-14662c837f2b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa43fa960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa477a0f0>]}
[0m14:04:48.743423 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.53091365, "process_user_time": 1.574452, "process_kernel_time": 0.124828, "process_mem_max_rss": "93556", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m14:04:48.744061 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:48.743950 after 0.53 seconds
[0m14:04:48.744619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa43b23f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa4542ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa4323e30>]}
[0m14:04:48.745090 [debug] [MainThread]: Flushing usage events
[0m14:04:50.566546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b9960da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ba03a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75bbe215e0>]}


============================== 14:04:50.569468 | 59767cf1-b964-4c73-8a84-7d005c50b91d ==============================
[0m14:04:50.569468 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:50.570149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:50.804180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b9961190>]}
[0m14:04:50.863842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b983a060>]}
[0m14:04:50.864716 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:50.921959 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:50.922759 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:50.923360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b96f6120>]}
[0m14:04:52.159161 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:52.159896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b2ba9340>]}
[0m14:04:52.351477 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:52.356328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b2c04620>]}
[0m14:04:52.475248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b2aea060>]}
[0m14:04:52.475805 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:52.476341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b2943ef0>]}
[0m14:04:52.477992 [info ] [MainThread]: 
[0m14:04:52.478677 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:52.483622 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:52.518145 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:52.518598 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:04:52.519049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:53.042249 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:53.043900 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:53.046296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:53.046931 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:53.053879 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.054333 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:04:53.054747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:53.060258 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.061603 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.062020 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:53.062878 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.063349 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.063750 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:53.064371 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.065317 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:53.065735 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.066147 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:53.066990 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.067554 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:53.069885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:53.075278 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:53.075706 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:53.076095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:53.081155 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.081584 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:53.082004 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:04:53.102187 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.106871 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:53.108122 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:53.108545 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:53.112186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75bbf84a40>]}
[0m14:04:53.112722 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:53.113130 [debug] [MainThread]: On master: BEGIN
[0m14:04:53.113521 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:53.118644 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:53.119125 [debug] [MainThread]: On master: COMMIT
[0m14:04:53.119539 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:53.119941 [debug] [MainThread]: On master: COMMIT
[0m14:04:53.120581 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:53.121016 [debug] [MainThread]: On master: Close
[0m14:04:53.122598 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:53.123130 [info ] [MainThread]: 
[0m14:04:53.132208 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:53.132833 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:53.133483 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:53.133938 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:53.159970 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:53.160724 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:53.195315 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:53.196053 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:03.150795 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:03.151391 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:03.152145 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.152613 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:03.153066 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:03.154062 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.156840 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:03.157316 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:03.158018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.178747 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:03.179282 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:03.179735 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:03.181573 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.186384 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:03.186877 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:03.188155 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.190520 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:03.216595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a89facc0>]}
[0m14:05:03.217334 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.08s]
[0m14:05:03.218136 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:03.219180 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:03.219762 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:03.220376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:03.220851 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:03.225727 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:03.226392 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:03.259725 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:03.260263 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240701140503253755"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:03.260761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:03.277595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.284813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:03.285300 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:03.285963 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.286432 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:03.286896 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240701140503253755'
      
      
      order by ordinal_position

  
[0m14:05:03.319364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.324590 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:03.325090 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:03.333699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.342325 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:03.342818 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:03.350783 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.368726 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:03.369439 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:03.369923 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240701140503253755"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240701140503253755"
    )
  
[0m14:05:03.382967 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.384700 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:03.385173 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:03.385619 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:03.400065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.400956 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:03.543423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75828a9400>]}
[0m14:05:03.544289 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m14:05:03.545168 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:03.546650 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:03.547218 [debug] [MainThread]: On master: BEGIN
[0m14:05:03.547704 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:03.553115 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:03.553621 [debug] [MainThread]: On master: COMMIT
[0m14:05:03.554082 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:03.554536 [debug] [MainThread]: On master: COMMIT
[0m14:05:03.555286 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:03.555767 [debug] [MainThread]: On master: Close
[0m14:05:03.557197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:03.557659 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:03.558097 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:03.558591 [info ] [MainThread]: 
[0m14:05:03.559183 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.08 seconds (11.08s).
[0m14:05:03.560234 [debug] [MainThread]: Command end result
[0m14:05:03.588163 [info ] [MainThread]: 
[0m14:05:03.588819 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:03.589374 [info ] [MainThread]: 
[0m14:05:03.589945 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:03.591025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.073806, "process_user_time": 4.791286, "process_kernel_time": 0.300456, "process_mem_max_rss": "288616", "process_in_blocks": "1184", "process_out_blocks": "108576"}
[0m14:05:03.591687 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:03.591575 after 13.07 seconds
[0m14:05:03.592195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b986ef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ba27ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b9df9280>]}
[0m14:05:03.592697 [debug] [MainThread]: Flushing usage events
[0m14:05:05.473882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc6d894c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc7b49160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc5d15be0>]}


============================== 14:05:05.476821 | 85e9d62e-dab1-4252-99be-41d55c5b55e7 ==============================
[0m14:05:05.476821 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:05.477524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:05.624129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85e9d62e-dab1-4252-99be-41d55c5b55e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc5505640>]}
[0m14:05:05.640541 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21559656, "process_user_time": 1.424479, "process_kernel_time": 0.095763, "process_mem_max_rss": "92160", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:05.641147 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:05.641045 after 0.22 seconds
[0m14:05:05.641604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc6d894c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc54c72f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc5fa1160>]}
[0m14:05:05.642042 [debug] [MainThread]: Flushing usage events
[0m22:05:35.587221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b77611f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b87da9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b7a56450>]}


============================== 22:05:35.594784 | 28c55452-5f7e-4190-b5ac-7bdfb1f46e3e ==============================
[0m22:05:35.594784 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:35.595583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:35.750062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28c55452-5f7e-4190-b5ac-7bdfb1f46e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b7fbe5d0>]}
[0m22:05:35.764284 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-exeoynuc'
[0m22:05:35.764798 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:35.792552 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:35.793345 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:35.804788 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:35.808728 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:36.019649 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:36.020301 [info ] [MainThread]: Up to date!
[0m22:05:36.020951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '28c55452-5f7e-4190-b5ac-7bdfb1f46e3e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b7ab2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b9176240>]}
[0m22:05:36.022390 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48446536, "process_user_time": 1.604271, "process_kernel_time": 0.141791, "process_mem_max_rss": "93672", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m22:05:36.023001 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:36.022893 after 0.49 seconds
[0m22:05:36.023459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b7a57860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b76aac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b7fbe5d0>]}
[0m22:05:36.023958 [debug] [MainThread]: Flushing usage events
[0m22:05:37.921180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8870f9fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8855aaf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe885834d40>]}


============================== 22:05:37.924135 | df7de61f-c544-4879-b562-f4ea46183a5b ==============================
[0m22:05:37.924135 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:37.924794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:38.164958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe885f82cf0>]}
[0m22:05:38.225351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe888fbbd40>]}
[0m22:05:38.226294 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:38.242613 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:38.243430 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:38.244012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe885405280>]}
[0m22:05:39.468276 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:39.469247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87e78c260>]}
[0m22:05:39.665386 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:39.670958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87e74d100>]}
[0m22:05:39.812745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87e6ca420>]}
[0m22:05:39.813373 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:39.813902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87e573fe0>]}
[0m22:05:39.815770 [info ] [MainThread]: 
[0m22:05:39.816530 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:39.821466 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:39.857718 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:39.858250 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:39.858664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:40.354227 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.355796 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:40.357928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:40.358494 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:40.365288 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.365752 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:40.366161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:40.372019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.373452 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.373871 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:40.374728 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.375140 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.375538 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:40.376211 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.377160 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:40.377574 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.377971 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:40.378510 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.378938 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:40.381386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:40.386954 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:40.387385 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:40.387833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:40.393068 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.393511 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:40.393935 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:40.414721 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.420297 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:40.421576 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:40.421997 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:40.425718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8878b6540>]}
[0m22:05:40.426461 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:40.426881 [debug] [MainThread]: On master: BEGIN
[0m22:05:40.427302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:40.432942 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:40.433437 [debug] [MainThread]: On master: COMMIT
[0m22:05:40.433855 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:40.434257 [debug] [MainThread]: On master: COMMIT
[0m22:05:40.434942 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:40.435373 [debug] [MainThread]: On master: Close
[0m22:05:40.437251 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:40.437814 [info ] [MainThread]: 
[0m22:05:40.447205 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:40.447898 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:40.448674 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:40.449138 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:40.475042 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:40.475960 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:40.510985 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:40.511947 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:51.134613 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.135191 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:51.135939 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.136410 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.136862 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:51.137597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.140570 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.141058 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:51.141787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.162923 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.163536 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.164030 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.165692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.170783 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.171279 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:51.172559 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.175022 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:51.204046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe851e27950>]}
[0m22:05:51.204929 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.75s]
[0m22:05:51.205777 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:51.206824 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:51.207473 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:51.208200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:51.208684 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:51.214213 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:51.215025 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:51.249677 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.250308 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240701220551243559"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:51.250800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:51.265785 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.273533 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.274061 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:51.274758 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.275222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.275675 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240701220551243559'
      
      
      order by ordinal_position

  
[0m22:05:51.303070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.308868 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.309399 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:51.324232 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.333875 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.334465 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:51.344276 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.363044 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:51.363930 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.364439 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240701220551243559"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240701220551243559"
    )
  
[0m22:05:51.378009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.380127 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:51.380610 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.381054 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:51.390702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.391788 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:51.543326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe851ee2db0>]}
[0m22:05:51.544212 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m22:05:51.544985 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:51.546498 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:51.546999 [debug] [MainThread]: On master: BEGIN
[0m22:05:51.547457 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:51.552947 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:51.553442 [debug] [MainThread]: On master: COMMIT
[0m22:05:51.553904 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:51.554341 [debug] [MainThread]: On master: COMMIT
[0m22:05:51.555053 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:51.555537 [debug] [MainThread]: On master: Close
[0m22:05:51.557303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:51.557754 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:51.558170 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:51.558649 [info ] [MainThread]: 
[0m22:05:51.559202 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.74 seconds (11.74s).
[0m22:05:51.560268 [debug] [MainThread]: Command end result
[0m22:05:51.588362 [info ] [MainThread]: 
[0m22:05:51.589093 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:51.589631 [info ] [MainThread]: 
[0m22:05:51.590164 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:51.591184 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.7198, "process_user_time": 4.887137, "process_kernel_time": 0.297408, "process_mem_max_rss": "269896", "process_in_blocks": "1184", "process_out_blocks": "108616"}
[0m22:05:51.591874 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:51.591760 after 13.72 seconds
[0m22:05:51.592389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8854ebb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe885f835c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe851ee9a00>]}
[0m22:05:51.592883 [debug] [MainThread]: Flushing usage events
[0m22:05:53.588588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fc09fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f9630e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f8db7020>]}


============================== 22:05:53.591504 | 78fe9049-a545-44f7-84ea-d04c886016aa ==============================
[0m22:05:53.591504 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:53.592199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:05:53.743998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78fe9049-a545-44f7-84ea-d04c886016aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f97feba0>]}
[0m22:05:53.760750 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22222081, "process_user_time": 1.445221, "process_kernel_time": 0.116098, "process_mem_max_rss": "92272", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:53.761365 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:53.761260 after 0.22 seconds
[0m22:05:53.761836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f8c53410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f8b6cef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f8debbf0>]}
[0m22:05:53.762301 [debug] [MainThread]: Flushing usage events
[0m06:02:08.683747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b344f9760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b36720fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b344f9610>]}


============================== 06:02:08.691034 | cba8867b-a0d8-47d7-bf45-5894a1c7cbf0 ==============================
[0m06:02:08.691034 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:08.691708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:08.831876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cba8867b-a0d8-47d7-bf45-5894a1c7cbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b35765670>]}
[0m06:02:08.845163 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6x868bad'
[0m06:02:08.845633 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:08.936964 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:08.937596 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:08.961106 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:08.964790 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:09.038263 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:09.038803 [info ] [MainThread]: Up to date!
[0m06:02:09.039370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cba8867b-a0d8-47d7-bf45-5894a1c7cbf0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b33e30440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b33e5c560>]}
[0m06:02:09.040700 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40574142, "process_user_time": 1.512654, "process_kernel_time": 0.160493, "process_mem_max_rss": "93684", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m06:02:09.041285 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:09.041181 after 0.41 seconds
[0m06:02:09.041717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b37bbbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b34542840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b34d390d0>]}
[0m06:02:09.042209 [debug] [MainThread]: Flushing usage events
[0m06:02:10.608768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163c176480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163b7e2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163b7e0950>]}


============================== 06:02:10.611546 | 6a11a7b3-ff9a-4068-8a31-00088c53426d ==============================
[0m06:02:10.611546 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.612237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.838716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163d0472f0>]}
[0m06:02:10.898120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163b6a6ea0>]}
[0m06:02:10.898872 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:10.914233 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:10.914954 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:10.915501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163b6bf950>]}
[0m06:02:12.131477 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:12.132161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1634929580>]}
[0m06:02:12.322490 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:12.327302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1634aa3200>]}
[0m06:02:12.451164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1634aac4d0>]}
[0m06:02:12.451722 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:12.452214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1634860a40>]}
[0m06:02:12.453873 [info ] [MainThread]: 
[0m06:02:12.454549 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:12.459292 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:12.493952 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:12.494414 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:12.494837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:13.013731 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:13.015335 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:13.017498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:13.018152 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:13.025055 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.025509 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:13.025961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:13.031389 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.032729 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.033143 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:13.034031 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.034444 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.034837 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:13.035482 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.036449 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:13.036864 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.037252 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:13.037794 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.038266 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:13.040387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:13.045695 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:13.046161 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:13.046553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:13.051412 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.051837 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:13.052247 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:13.071663 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.076370 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:13.077549 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:13.078001 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:13.080765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163486bf20>]}
[0m06:02:13.081279 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:13.081680 [debug] [MainThread]: On master: BEGIN
[0m06:02:13.082097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:13.087066 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:13.087511 [debug] [MainThread]: On master: COMMIT
[0m06:02:13.087910 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:13.088305 [debug] [MainThread]: On master: COMMIT
[0m06:02:13.088927 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:13.089343 [debug] [MainThread]: On master: Close
[0m06:02:13.090891 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:13.091427 [info ] [MainThread]: 
[0m06:02:13.100869 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:13.101477 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:13.102173 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:13.102628 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:13.128289 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:13.129046 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:13.163398 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:13.164142 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:21.548853 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.549394 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:21.550036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.550507 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.550958 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:21.551737 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.554422 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.554897 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:21.555700 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.576402 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:21.576906 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.577391 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:21.578490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.583266 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.583747 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:21.584862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.587188 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:21.612046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16087aff80>]}
[0m06:02:21.612757 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.51s]
[0m06:02:21.613653 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:21.614704 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:21.615383 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:21.616047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:21.616519 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:21.621300 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:21.622008 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:21.655488 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.656005 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240702060221649568"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:21.656490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:21.671990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.678843 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.679324 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:21.679922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.680381 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.680832 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240702060221649568'
      
      
      order by ordinal_position

  
[0m06:02:21.706658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.711518 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.712007 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.720568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.728904 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.729401 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.738404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.756494 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:21.757161 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.757659 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240702060221649568"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240702060221649568"
    )
  
[0m06:02:21.772906 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.774655 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.775129 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.775574 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.784114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.784991 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:21.935799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f160879f0b0>]}
[0m06:02:21.936559 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m06:02:21.937321 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:21.938787 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.939271 [debug] [MainThread]: On master: BEGIN
[0m06:02:21.939714 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:21.945021 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.945508 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.946016 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.946466 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.947150 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.947617 [debug] [MainThread]: On master: Close
[0m06:02:21.949237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:21.949691 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:21.950161 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:21.950638 [info ] [MainThread]: 
[0m06:02:21.951188 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.50 seconds (9.50s).
[0m06:02:21.952294 [debug] [MainThread]: Command end result
[0m06:02:21.980136 [info ] [MainThread]: 
[0m06:02:21.980829 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:21.981441 [info ] [MainThread]: 
[0m06:02:21.982073 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:21.983145 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.422882, "process_user_time": 4.733403, "process_kernel_time": 0.256509, "process_mem_max_rss": "266784", "process_in_blocks": "1184", "process_out_blocks": "109104"}
[0m06:02:21.983803 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:21.983693 after 11.42 seconds
[0m06:02:21.984301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163efbc830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163b88b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163b807a40>]}
[0m06:02:21.984791 [debug] [MainThread]: Flushing usage events
[0m06:02:23.586388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f010b0f7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f010b4c6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f010b0f7350>]}


============================== 06:02:23.589273 | 13471731-2886-49fb-b217-53e8715c90b6 ==============================
[0m06:02:23.589273 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:23.589988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:23.733864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13471731-2886-49fb-b217-53e8715c90b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f010b12a510>]}
[0m06:02:23.750093 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21287633, "process_user_time": 1.384671, "process_kernel_time": 0.128062, "process_mem_max_rss": "91928", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:23.750681 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:23.750578 after 0.21 seconds
[0m06:02:23.751130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f010bef2ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f010b0cb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f010adc6570>]}
[0m06:02:23.751573 [debug] [MainThread]: Flushing usage events
[0m14:05:06.003394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe766852f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe765db3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe766852ea0>]}


============================== 14:05:06.010560 | 2aaea165-6efd-4c81-b802-0b0ce941a813 ==============================
[0m14:05:06.010560 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:06.011216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:06.153466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2aaea165-6efd-4c81-b802-0b0ce941a813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe765d47bf0>]}
[0m14:05:06.166707 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-001eu6sg'
[0m14:05:06.167170 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:06.209071 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:06.209681 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:06.220115 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:06.223908 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:06.452097 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:06.452649 [info ] [MainThread]: Up to date!
[0m14:05:06.453187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2aaea165-6efd-4c81-b802-0b0ce941a813', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe765ae1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe765b1c800>]}
[0m14:05:06.454937 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49940225, "process_user_time": 1.551718, "process_kernel_time": 0.17376, "process_mem_max_rss": "93432", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m14:05:06.455582 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:06.455474 after 0.50 seconds
[0m14:05:06.456028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7667fff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe765c91820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe765d47bf0>]}
[0m14:05:06.456477 [debug] [MainThread]: Flushing usage events
[0m14:05:08.348109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102a520c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102a917170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102a6a5be0>]}


============================== 14:05:08.351041 | fe15777e-bc08-42ae-ab14-a576a088ca45 ==============================
[0m14:05:08.351041 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:08.351763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:08.587191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102a3d5bb0>]}
[0m14:05:08.650043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102a3fd9a0>]}
[0m14:05:08.650842 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:08.759626 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:08.760372 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:08.760934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102a2def00>]}
[0m14:05:09.992106 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:09.992876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102bcbfe30>]}
[0m14:05:10.198979 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:10.204243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1023745760>]}
[0m14:05:10.333546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102393f320>]}
[0m14:05:10.334121 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:10.334678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1023562780>]}
[0m14:05:10.336455 [info ] [MainThread]: 
[0m14:05:10.337190 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:10.342020 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:10.376440 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:10.376914 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:10.377323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:11.078719 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:11.080364 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:11.082779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:11.083391 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:11.090214 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:11.090665 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:11.091074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:11.096869 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.098243 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:11.098657 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:11.099350 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.099767 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:11.100159 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:11.100734 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.101654 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:11.102072 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:11.102470 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:11.102996 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.103451 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:11.105526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:11.110782 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:11.111219 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:11.111654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:11.116713 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.117140 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:11.117556 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:11.137473 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.142154 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:11.143369 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:11.143795 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:11.146870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10237de330>]}
[0m14:05:11.147421 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:11.147828 [debug] [MainThread]: On master: BEGIN
[0m14:05:11.148209 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:11.153313 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:11.153742 [debug] [MainThread]: On master: COMMIT
[0m14:05:11.154138 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:11.154522 [debug] [MainThread]: On master: COMMIT
[0m14:05:11.155038 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:11.155496 [debug] [MainThread]: On master: Close
[0m14:05:11.156953 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:11.157460 [info ] [MainThread]: 
[0m14:05:11.167359 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:11.167979 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:11.168649 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:11.169100 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:11.194764 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:11.195563 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:11.229934 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:11.230683 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:20.782281 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.782818 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:20.783498 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.783969 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.784424 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:20.785119 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.787862 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.788337 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:20.789035 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.810662 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:20.811162 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.811659 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:20.812910 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.817679 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.818172 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:20.819551 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.821899 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:20.847944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102bd96600>]}
[0m14:05:20.848678 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.68s]
[0m14:05:20.849456 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:20.850463 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:20.851049 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:20.851656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:20.852127 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:20.856966 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:20.857638 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:20.890859 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:20.891407 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240702140520885012"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:20.891903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:20.908413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.915535 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:20.916042 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:20.916639 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.917126 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:20.917591 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240702140520885012'
      
      
      order by ordinal_position

  
[0m14:05:20.944547 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.949517 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:20.950012 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:20.958590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.967171 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:20.967705 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:20.976115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.994083 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:20.994788 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:20.995310 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240702140520885012"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240702140520885012"
    )
  
[0m14:05:21.011612 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.013363 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:21.013832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.014278 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:21.023966 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.024923 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:21.188730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ff7477fe0>]}
[0m14:05:21.189590 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m14:05:21.190364 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:21.191893 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.192418 [debug] [MainThread]: On master: BEGIN
[0m14:05:21.192893 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:21.198464 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.198947 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.199437 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.199880 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.200537 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.201003 [debug] [MainThread]: On master: Close
[0m14:05:21.202503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:21.202951 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:21.203418 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:21.203902 [info ] [MainThread]: 
[0m14:05:21.204503 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.87 seconds (10.87s).
[0m14:05:21.205615 [debug] [MainThread]: Command end result
[0m14:05:21.233250 [info ] [MainThread]: 
[0m14:05:21.233948 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:21.234566 [info ] [MainThread]: 
[0m14:05:21.235181 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:21.236321 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.939521, "process_user_time": 4.834602, "process_kernel_time": 0.26327, "process_mem_max_rss": "271404", "process_in_blocks": "1184", "process_out_blocks": "109592"}
[0m14:05:21.236987 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:21.236872 after 12.94 seconds
[0m14:05:21.237494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10236f8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102ab36c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10238bb980>]}
[0m14:05:21.237995 [debug] [MainThread]: Flushing usage events
[0m14:05:23.498545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a967d5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a949bb020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a949bac00>]}


============================== 14:05:23.501527 | 4afe5002-d961-4c68-834a-8270374370cc ==============================
[0m14:05:23.501527 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.502280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:23.651724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4afe5002-d961-4c68-834a-8270374370cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a942cc620>]}
[0m14:05:23.668507 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22140175, "process_user_time": 1.415608, "process_kernel_time": 0.115641, "process_mem_max_rss": "92088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:23.669099 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:23.668996 after 0.22 seconds
[0m14:05:23.669559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a94264290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a942649b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a949bb3b0>]}
[0m14:05:23.670002 [debug] [MainThread]: Flushing usage events
[0m22:06:18.599066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d4a60200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d4a9bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d444c0e0>]}


============================== 22:06:18.631270 | b0e4ee1a-e5bf-4db9-ba0d-0b5fb5afdb54 ==============================
[0m22:06:18.631270 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:18.632155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:18.784962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0e4ee1a-e5bf-4db9-ba0d-0b5fb5afdb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d450bbf0>]}
[0m22:06:18.798614 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3r8xmz0r'
[0m22:06:18.799102 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:18.993701 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:18.994528 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:19.028536 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:19.032635 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:19.389219 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:19.389835 [info ] [MainThread]: Up to date!
[0m22:06:19.390486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b0e4ee1a-e5bf-4db9-ba0d-0b5fb5afdb54', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d4393170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d4359820>]}
[0m22:06:19.391932 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8417211, "process_user_time": 1.612079, "process_kernel_time": 0.129289, "process_mem_max_rss": "93284", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m22:06:19.392543 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:19.392439 after 0.84 seconds
[0m22:06:19.392992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d4a60200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d55c95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d442fce0>]}
[0m22:06:19.393430 [debug] [MainThread]: Flushing usage events
[0m22:06:21.497412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a0f1eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a1eadcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a03074d0>]}


============================== 22:06:21.500476 | 1f972b7f-82c0-424e-945c-0db81c1fa700 ==============================
[0m22:06:21.500476 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:21.501236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:21.745293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a001e900>]}
[0m22:06:21.806697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a0161fd0>]}
[0m22:06:21.807753 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:06:21.868243 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:21.869437 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:21.870226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a013d970>]}
[0m22:06:23.118380 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:23.119133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a09536e0>]}
[0m22:06:23.313808 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:23.319386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc199557530>]}
[0m22:06:23.460995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a28c0a10>]}
[0m22:06:23.461611 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:23.462124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a0774680>]}
[0m22:06:23.463973 [info ] [MainThread]: 
[0m22:06:23.464712 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:23.469677 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:23.506105 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:23.506638 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:06:23.507057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:24.123107 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:24.124795 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:24.127041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:24.127656 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:24.134547 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.135007 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:06:24.135453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:24.141171 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.142582 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.142998 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:24.143668 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.144081 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.144482 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:24.145130 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.146074 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:24.146490 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.146885 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:24.147466 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.147895 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:24.150305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:24.155855 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:24.156312 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:24.156702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:24.162007 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.162441 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:24.162856 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:06:24.183316 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.188613 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:24.189919 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:24.190386 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:24.193905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a1666420>]}
[0m22:06:24.194468 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:24.194877 [debug] [MainThread]: On master: BEGIN
[0m22:06:24.195259 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:24.200735 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:24.201179 [debug] [MainThread]: On master: COMMIT
[0m22:06:24.201579 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:24.201976 [debug] [MainThread]: On master: COMMIT
[0m22:06:24.202647 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:24.203086 [debug] [MainThread]: On master: Close
[0m22:06:24.204942 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:24.205453 [info ] [MainThread]: 
[0m22:06:24.245921 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:24.246648 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:24.247408 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:24.247881 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:24.273723 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:24.274575 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:24.309758 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:24.310779 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:37.788611 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.789215 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:37.790023 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.790496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.790985 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:37.791824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.794734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.795213 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:37.795975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.816877 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:37.817406 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.817866 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:37.819550 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.824473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.824964 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:37.826304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.828833 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:37.857411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16d2783b0>]}
[0m22:06:37.858289 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 13.61s]
[0m22:06:37.859197 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:37.860396 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:37.860979 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:37.861681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:37.862164 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:37.867420 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:37.868089 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:37.901742 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.902346 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240702220637895788"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:37.902832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:37.919688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.927600 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.928125 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:37.928818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.929275 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.929724 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240702220637895788'
      
      
      order by ordinal_position

  
[0m22:06:37.956446 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.961998 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.962522 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:37.977170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.987057 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.987736 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:38.000571 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:38.023521 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:38.024434 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:38.025080 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240702220637895788"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240702220637895788"
    )
  
[0m22:06:38.049013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:38.051196 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:38.051716 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:38.052181 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:38.065556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:38.066721 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:38.246006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16d22c800>]}
[0m22:06:38.246902 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m22:06:38.247710 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:38.249285 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:38.249782 [debug] [MainThread]: On master: BEGIN
[0m22:06:38.250224 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:38.255735 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:38.256232 [debug] [MainThread]: On master: COMMIT
[0m22:06:38.256676 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:38.257104 [debug] [MainThread]: On master: COMMIT
[0m22:06:38.257667 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:38.258127 [debug] [MainThread]: On master: Close
[0m22:06:38.259629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:38.260085 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:38.260504 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:38.261005 [info ] [MainThread]: 
[0m22:06:38.261568 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.80 seconds (14.80s).
[0m22:06:38.262608 [debug] [MainThread]: Command end result
[0m22:06:38.290834 [info ] [MainThread]: 
[0m22:06:38.291580 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:38.292180 [info ] [MainThread]: 
[0m22:06:38.292795 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:38.293909 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.846651, "process_user_time": 4.96508, "process_kernel_time": 0.323549, "process_mem_max_rss": "281508", "process_in_blocks": "1184", "process_out_blocks": "109640"}
[0m22:06:38.294571 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:38.294458 after 16.85 seconds
[0m22:06:38.295079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a1edf470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a1467d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc199436de0>]}
[0m22:06:38.295621 [debug] [MainThread]: Flushing usage events
[0m22:06:40.236060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff4a70eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff4a01a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff4c0f97c0>]}


============================== 22:06:40.239219 | be6b3289-5fa0-461e-8e58-32d1a8c03da4 ==============================
[0m22:06:40.239219 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:40.239959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:40.397182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be6b3289-5fa0-461e-8e58-32d1a8c03da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff49aa1640>]}
[0m22:06:40.413984 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2273765, "process_user_time": 1.466205, "process_kernel_time": 0.096144, "process_mem_max_rss": "91928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:40.414599 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:40.414494 after 0.23 seconds
[0m22:06:40.415056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff49c4ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff49ab2c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff49d7cec0>]}
[0m22:06:40.415575 [debug] [MainThread]: Flushing usage events
[0m06:02:10.311741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263110bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26312222d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263110b710>]}


============================== 06:02:10.361390 | 1c9fedcc-2043-47c6-9e74-193de9bf0706 ==============================
[0m06:02:10.361390 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.362047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.510634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c9fedcc-2043-47c6-9e74-193de9bf0706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263135cc80>]}
[0m06:02:10.524813 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-sep9zvvz'
[0m06:02:10.525291 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.597337 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.597971 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.610415 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.614275 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.825160 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.825792 [info ] [MainThread]: Up to date!
[0m06:02:10.826408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1c9fedcc-2043-47c6-9e74-193de9bf0706', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2630e5c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2630e23290>]}
[0m06:02:10.828546 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5679207, "process_user_time": 1.623239, "process_kernel_time": 0.119649, "process_mem_max_rss": "93712", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m06:02:10.829155 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:10.829048 after 0.57 seconds
[0m06:02:10.829607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263148b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26314e29f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263102bd70>]}
[0m06:02:10.830051 [debug] [MainThread]: Flushing usage events
[0m06:02:12.745963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03a166e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0398f5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03a167230>]}


============================== 06:02:12.748820 | 616e87ed-4c42-4675-b2ae-15ca04155233 ==============================
[0m06:02:12.748820 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.749571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.997106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03a7eb4d0>]}
[0m06:02:13.059270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0390ab950>]}
[0m06:02:13.060091 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:13.144819 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:13.145548 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:13.146096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd032515070>]}
[0m06:02:14.408664 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:14.409351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0324754c0>]}
[0m06:02:14.609410 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:14.614579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0324d0c20>]}
[0m06:02:14.740160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0320259a0>]}
[0m06:02:14.740723 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:14.741257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0321ca480>]}
[0m06:02:14.742994 [info ] [MainThread]: 
[0m06:02:14.743715 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.748478 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.782903 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.783418 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:14.783849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:15.219761 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.221361 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:15.223664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:15.224255 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:15.231265 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.231723 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:15.232136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.237803 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.239279 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.239712 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:15.240400 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.240825 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.241237 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:15.241831 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.242863 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.243291 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.243681 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.244219 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.244643 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:15.246939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:15.252337 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.252768 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:15.253157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.258152 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.258578 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.259028 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:15.279359 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.284066 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:15.285285 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:15.285700 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:15.289201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd038de8740>]}
[0m06:02:15.289718 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.290118 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.290500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:15.295621 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.296054 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.296459 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.296846 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.297484 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.297904 [debug] [MainThread]: On master: Close
[0m06:02:15.299363 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:15.299877 [info ] [MainThread]: 
[0m06:02:15.348997 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:15.349621 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:15.350299 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:15.350771 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:15.378151 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:15.378975 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:15.415677 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:15.416471 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:27.519202 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.519781 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:27.520740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.521210 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.521670 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:27.522503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.525374 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.525847 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:27.526611 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.547376 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:27.547939 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.548403 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:27.551582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.556724 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.557220 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:27.559052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.561643 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:27.589975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0201313a0>]}
[0m06:02:27.590919 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.24s]
[0m06:02:27.591770 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:27.592827 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:27.593452 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:27.594110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:27.594586 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:27.600039 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:27.600733 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:27.634917 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.635531 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240703060227628881"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:27.636051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:27.651625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.659606 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.660135 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:27.660794 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.661272 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.661735 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240703060227628881'
      
      
      order by ordinal_position

  
[0m06:02:27.688156 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.693385 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.693887 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:27.702422 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.711861 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.712383 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:27.721057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.739015 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:27.739743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.740224 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240703060227628881"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240703060227628881"
    )
  
[0m06:02:27.755091 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.757090 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:27.757590 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.758050 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:27.769744 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.770708 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:27.946997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd005f37590>]}
[0m06:02:27.947867 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m06:02:27.948738 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:27.950161 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.950655 [debug] [MainThread]: On master: BEGIN
[0m06:02:27.951145 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:27.956627 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.957113 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.957561 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.957995 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.958697 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.959209 [debug] [MainThread]: On master: Close
[0m06:02:27.960746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:27.961205 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:27.961633 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:27.962119 [info ] [MainThread]: 
[0m06:02:27.962692 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.22 seconds (13.22s).
[0m06:02:27.963767 [debug] [MainThread]: Command end result
[0m06:02:27.991561 [info ] [MainThread]: 
[0m06:02:27.992221 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:27.992770 [info ] [MainThread]: 
[0m06:02:27.993327 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:27.994355 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.299865, "process_user_time": 4.892074, "process_kernel_time": 0.336005, "process_mem_max_rss": "298808", "process_in_blocks": "1184", "process_out_blocks": "109616"}
[0m06:02:27.995035 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:27.994924 after 15.30 seconds
[0m06:02:27.995547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03a166ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd038fe33e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd006f65580>]}
[0m06:02:27.996045 [debug] [MainThread]: Flushing usage events
[0m06:02:30.054430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e21ab6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e21a9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e261a000>]}


============================== 06:02:30.057557 | fd08c3bd-6d0c-49d0-8d88-ef34b440ee7b ==============================
[0m06:02:30.057557 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:30.058328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:30.215996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd08c3bd-6d0c-49d0-8d88-ef34b440ee7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e1bffd70>]}
[0m06:02:30.233318 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23176347, "process_user_time": 1.485321, "process_kernel_time": 0.107805, "process_mem_max_rss": "91968", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:30.233929 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:30.233824 after 0.23 seconds
[0m06:02:30.234392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e1cc2ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e1b5a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e2036600>]}
[0m06:02:30.234883 [debug] [MainThread]: Flushing usage events
[0m14:04:47.115979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6651b7adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6650894d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f664fd82330>]}


============================== 14:04:47.123652 | 02deac34-8a88-4d78-888e-1c9302abe8d5 ==============================
[0m14:04:47.123652 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:47.124431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:47.276911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02deac34-8a88-4d78-888e-1c9302abe8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f664fc3ce90>]}
[0m14:04:47.291095 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-h76c07tx'
[0m14:04:47.291626 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:47.371528 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:47.372405 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:47.641841 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:47.645719 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:47.705533 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:47.706182 [info ] [MainThread]: Up to date!
[0m14:04:47.706743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '02deac34-8a88-4d78-888e-1c9302abe8d5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f664fc3dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f664fbe8800>]}
[0m14:04:47.708171 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.64215595, "process_user_time": 1.63173, "process_kernel_time": 0.142776, "process_mem_max_rss": "93776", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m14:04:47.708800 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:47.708691 after 0.64 seconds
[0m14:04:47.709251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66501a57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6653b67d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f664fadc680>]}
[0m14:04:47.709711 [debug] [MainThread]: Flushing usage events
[0m14:04:49.423686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96174a72f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9618fef650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96177a63f0>]}


============================== 14:04:49.426800 | 3d1c411a-963e-44be-b8a2-aa68aafc7e55 ==============================
[0m14:04:49.426800 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:49.427481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:49.668030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9610911eb0>]}
[0m14:04:49.728437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9618c5b320>]}
[0m14:04:49.729369 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:49.765234 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:49.766155 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:49.766738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96172e5eb0>]}
[0m14:04:51.011820 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:51.012623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f961089a600>]}
[0m14:04:51.216826 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:51.222573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96105ec2c0>]}
[0m14:04:51.367310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f961044b0e0>]}
[0m14:04:51.367918 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:51.368414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96104aa780>]}
[0m14:04:51.370211 [info ] [MainThread]: 
[0m14:04:51.370966 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:51.376057 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:51.413819 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:51.414420 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:04:51.414844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:52.019633 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:52.021193 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:52.023403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:52.023973 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:52.030819 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.031269 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:04:52.031685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:52.037272 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.038686 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.039105 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:52.039727 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.040138 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.040528 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:52.041156 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.042129 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:52.042549 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.042945 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:52.043490 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.043914 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:52.046090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:52.051423 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:52.051851 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:52.052237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:52.057390 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.057827 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:52.058269 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:04:52.078561 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.083624 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:52.084825 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:52.085240 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:52.088770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9617aea6f0>]}
[0m14:04:52.089352 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:52.089767 [debug] [MainThread]: On master: BEGIN
[0m14:04:52.090210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:52.095496 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:52.095957 [debug] [MainThread]: On master: COMMIT
[0m14:04:52.096368 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:52.096779 [debug] [MainThread]: On master: COMMIT
[0m14:04:52.097456 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:52.097886 [debug] [MainThread]: On master: Close
[0m14:04:52.099789 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:52.100292 [info ] [MainThread]: 
[0m14:04:52.109485 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:52.110165 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:52.110841 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:52.111300 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:52.137296 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:52.138127 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:52.173093 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:52.174107 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:58.991590 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:58.992166 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:04:58.992881 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.993359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:58.993820 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:04:58.994645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.997618 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:58.998141 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:04:58.998902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.019992 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:59.020502 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:59.020990 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:59.022335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.027552 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:59.028107 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:04:59.029664 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.032259 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:04:59.058909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9604f1da60>]}
[0m14:04:59.059842 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.95s]
[0m14:04:59.060822 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:04:59.061955 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:04:59.062644 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:04:59.063392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:04:59.063882 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:04:59.069212 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:04:59.069912 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:04:59.104562 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:59.105211 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240703140459098423"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:04:59.105715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:59.120413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.128314 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:59.128846 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:04:59.129518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.130018 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:59.130482 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240703140459098423'
      
      
      order by ordinal_position

  
[0m14:04:59.157595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.163703 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:59.164247 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:59.173919 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.183203 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:59.183730 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:59.192469 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.210931 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:04:59.211743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:59.212258 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240703140459098423"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240703140459098423"
    )
  
[0m14:04:59.230636 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.232762 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:59.233292 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:59.233759 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:59.244264 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.245365 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:04:59.428408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e445d190>]}
[0m14:04:59.429311 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m14:04:59.430188 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:04:59.431807 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:59.432306 [debug] [MainThread]: On master: BEGIN
[0m14:04:59.432758 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:59.438358 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:59.438847 [debug] [MainThread]: On master: COMMIT
[0m14:04:59.439297 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:59.439731 [debug] [MainThread]: On master: COMMIT
[0m14:04:59.440450 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:59.440927 [debug] [MainThread]: On master: Close
[0m14:04:59.442728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:59.443190 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:04:59.443616 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:04:59.444108 [info ] [MainThread]: 
[0m14:04:59.444676 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.07 seconds (8.07s).
[0m14:04:59.445726 [debug] [MainThread]: Command end result
[0m14:04:59.474063 [info ] [MainThread]: 
[0m14:04:59.474746 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:59.475306 [info ] [MainThread]: 
[0m14:04:59.475871 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:04:59.476927 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.103377, "process_user_time": 4.900436, "process_kernel_time": 0.362552, "process_mem_max_rss": "279780", "process_in_blocks": "1184", "process_out_blocks": "110112"}
[0m14:04:59.477592 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:59.477479 after 10.10 seconds
[0m14:04:59.478130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f961761f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e494bda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96178ccce0>]}
[0m14:04:59.478632 [debug] [MainThread]: Flushing usage events
[0m14:05:01.214016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86905c9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868e485c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868e4a8d40>]}


============================== 14:05:01.218303 | 2b8dbdf0-993d-4824-b08c-ffe32ddeb3e7 ==============================
[0m14:05:01.218303 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:01.219137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:01.362579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b8dbdf0-993d-4824-b08c-ffe32ddeb3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868dc90500>]}
[0m14:05:01.379181 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21435416, "process_user_time": 1.453879, "process_kernel_time": 0.099854, "process_mem_max_rss": "92024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:01.379782 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:01.379677 after 0.22 seconds
[0m14:05:01.380241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868e013050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86919bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868f69b5c0>]}
[0m14:05:01.380687 [debug] [MainThread]: Flushing usage events
[0m22:06:07.372646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6fa8e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6fa8e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6fa8e300>]}


============================== 22:06:07.417319 | ba4f03b3-c2d4-48bd-98c2-ee36d87ebec1 ==============================
[0m22:06:07.417319 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:07.418073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:07.589245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba4f03b3-c2d4-48bd-98c2-ee36d87ebec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6f9ba2a0>]}
[0m22:06:07.603303 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-gqsxn4x9'
[0m22:06:07.603826 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:07.705182 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:07.705999 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:07.747935 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:07.751990 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:07.825566 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:07.826199 [info ] [MainThread]: Up to date!
[0m22:06:07.826885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ba4f03b3-c2d4-48bd-98c2-ee36d87ebec1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6f5daf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6f6e8590>]}
[0m22:06:07.828427 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.50579476, "process_user_time": 1.694338, "process_kernel_time": 0.116435, "process_mem_max_rss": "93556", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m22:06:07.829170 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:07.829036 after 0.51 seconds
[0m22:06:07.829678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6f9f45f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6ff1a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6f6e8590>]}
[0m22:06:07.830133 [debug] [MainThread]: Flushing usage events
[0m22:06:09.497782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81be8c4dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81befa2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81be8c4ce0>]}


============================== 22:06:09.500867 | b47c094a-a914-4f66-a231-c812e93a964c ==============================
[0m22:06:09.500867 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:09.501612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:09.751325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81bed5ffe0>]}
[0m22:06:09.812401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81bed41700>]}
[0m22:06:09.813363 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:06:09.847763 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:09.848577 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:09.849154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81be77b8f0>]}
[0m22:06:11.078382 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:11.079142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b75bd460>]}
[0m22:06:11.277195 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:11.282546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b74af2c0>]}
[0m22:06:11.435513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81befc44a0>]}
[0m22:06:11.436140 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:11.436717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b731dbe0>]}
[0m22:06:11.438550 [info ] [MainThread]: 
[0m22:06:11.439341 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:11.444324 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:11.480334 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:11.480854 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:06:11.481276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:12.022996 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:12.024527 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:12.026781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:12.027358 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:12.034216 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.034670 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:06:12.035123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:12.040800 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.042149 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.042572 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:12.043453 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.043863 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.044258 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:12.044821 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.045746 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:12.046155 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.046545 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:12.047263 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.047688 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:12.049860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:12.055323 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:12.055753 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:12.056146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:12.061240 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.061664 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:12.062074 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:06:12.082059 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.086886 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:12.088097 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:12.088515 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:12.092349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81bff07ef0>]}
[0m22:06:12.092884 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:12.093297 [debug] [MainThread]: On master: BEGIN
[0m22:06:12.093680 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:12.099021 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:12.099454 [debug] [MainThread]: On master: COMMIT
[0m22:06:12.099862 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:12.100253 [debug] [MainThread]: On master: COMMIT
[0m22:06:12.100895 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:12.101316 [debug] [MainThread]: On master: Close
[0m22:06:12.102833 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:12.103388 [info ] [MainThread]: 
[0m22:06:12.123042 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:12.123661 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:12.124401 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:12.124876 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:12.150750 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:12.151494 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:12.186137 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:12.186911 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:21.299988 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.300531 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:21.301361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.301849 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.302301 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:21.303015 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.305793 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.306268 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:21.306978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.327652 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:21.328177 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.328630 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:21.330182 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.335061 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.335550 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:21.337117 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.339526 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:21.365226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c012a450>]}
[0m22:06:21.366025 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.24s]
[0m22:06:21.366849 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:21.367889 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:21.368468 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:21.369095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:21.369564 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:21.374620 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:21.375342 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:21.409148 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.409745 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240703220621403201"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:21.410240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:21.424971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.432421 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.432945 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:21.433620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.434094 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.434548 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240703220621403201'
      
      
      order by ordinal_position

  
[0m22:06:21.461316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.466851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.467369 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:21.476053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.484847 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.485346 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:21.499714 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.517706 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:21.518425 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.518950 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240703220621403201"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240703220621403201"
    )
  
[0m22:06:21.533656 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.535563 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:21.536038 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.536489 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:21.545471 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.546415 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:21.737451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818b1a5100>]}
[0m22:06:21.738296 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m22:06:21.739088 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:21.740556 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:21.741045 [debug] [MainThread]: On master: BEGIN
[0m22:06:21.741489 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:21.747006 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:21.747496 [debug] [MainThread]: On master: COMMIT
[0m22:06:21.747946 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:21.748381 [debug] [MainThread]: On master: COMMIT
[0m22:06:21.749081 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:21.749554 [debug] [MainThread]: On master: Close
[0m22:06:21.751205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:21.751661 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:21.752087 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:21.752568 [info ] [MainThread]: 
[0m22:06:21.753145 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.31 seconds (10.31s).
[0m22:06:21.754185 [debug] [MainThread]: Command end result
[0m22:06:21.781904 [info ] [MainThread]: 
[0m22:06:21.782547 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:21.783116 [info ] [MainThread]: 
[0m22:06:21.783675 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:21.784694 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.336941, "process_user_time": 4.896886, "process_kernel_time": 0.299076, "process_mem_max_rss": "290776", "process_in_blocks": "1184", "process_out_blocks": "111176"}
[0m22:06:21.785343 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:21.785234 after 12.34 seconds
[0m22:06:21.785840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81be96f260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c0db6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818b230d70>]}
[0m22:06:21.786334 [debug] [MainThread]: Flushing usage events
[0m22:06:23.470826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53439cf1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5343cfb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5343f2f680>]}


============================== 22:06:23.473679 | e1e27949-4ab0-4052-9bc8-2e28ba272b86 ==============================
[0m22:06:23.473679 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:23.474353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:23.617831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1e27949-4ab0-4052-9bc8-2e28ba272b86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53450678f0>]}
[0m22:06:23.635400 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21399531, "process_user_time": 1.42242, "process_kernel_time": 0.119866, "process_mem_max_rss": "91808", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:23.635998 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:23.635895 after 0.21 seconds
[0m22:06:23.636450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5344190da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5343b461e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5346de9c40>]}
[0m22:06:23.636893 [debug] [MainThread]: Flushing usage events
[0m06:02:10.868267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd851722a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd856fb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8529f0b0>]}


============================== 06:02:10.875574 | 19756dd2-f37a-473a-a44b-15478993724a ==============================
[0m06:02:10.875574 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.876288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:11.032851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19756dd2-f37a-473a-a44b-15478993724a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd84f8b050>]}
[0m06:02:11.046894 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-52gl9tnb'
[0m06:02:11.047388 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:11.094947 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:11.095794 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:11.108977 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:11.112862 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:11.173108 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:11.173762 [info ] [MainThread]: Up to date!
[0m06:02:11.174363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '19756dd2-f37a-473a-a44b-15478993724a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8529e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd84fbc800>]}
[0m06:02:11.176021 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.35698986, "process_user_time": 1.702331, "process_kernel_time": 0.135866, "process_mem_max_rss": "93596", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m06:02:11.176699 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:11.176565 after 0.36 seconds
[0m06:02:11.177179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd852d6300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd852d6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd855c3530>]}
[0m06:02:11.177635 [debug] [MainThread]: Flushing usage events
[0m06:02:12.798543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0a84da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0a4a9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0a4a9b20>]}


============================== 06:02:12.801704 | 7b7093b3-a463-4601-882d-6536e66bf37d ==============================
[0m06:02:12.801704 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.802396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.040386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab09d3b890>]}
[0m06:02:13.100112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0a352b70>]}
[0m06:02:13.101007 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:13.116439 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:13.117228 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:13.117785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab09ed0e30>]}
[0m06:02:14.338837 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:14.339872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab031d3e30>]}
[0m06:02:14.534180 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:14.539414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab02f3e330>]}
[0m06:02:14.672410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab031e5b20>]}
[0m06:02:14.673063 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:14.673605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab02f7b1d0>]}
[0m06:02:14.675356 [info ] [MainThread]: 
[0m06:02:14.676073 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.681113 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.717257 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.717758 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:14.718166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:15.141634 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.143318 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:15.145877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:15.146492 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:15.153658 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.154129 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:15.154543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.160120 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.161516 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.161936 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:15.162780 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.163193 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.163587 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:15.164157 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.165133 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.165553 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.165947 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.166500 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.166926 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:15.169191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:15.174671 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.175105 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:15.175509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.180775 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.181201 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.181614 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:15.201797 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.206613 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:15.207826 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:15.208244 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:15.211615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab01dae1b0>]}
[0m06:02:15.212158 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.212566 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.212998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:15.218204 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.218642 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.219044 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.219425 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.220054 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.220473 [debug] [MainThread]: On master: Close
[0m06:02:15.222077 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:15.222590 [info ] [MainThread]: 
[0m06:02:15.231843 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:15.232470 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:15.233133 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:15.233590 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:15.259284 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:15.260073 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:15.294580 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:15.295422 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:22.084346 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.084933 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:22.085612 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.086084 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.086542 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:22.087252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.090151 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.090634 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:22.091547 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.112645 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:22.113202 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.113666 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:22.114954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.119966 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.120461 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:22.121682 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.124163 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:22.150513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0b61a330>]}
[0m06:02:22.151351 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.92s]
[0m06:02:22.152270 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:22.153337 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:22.153947 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:22.154676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:22.155169 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:22.160419 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:22.161148 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:22.195093 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.195672 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240704060222189167"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:22.196176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:22.210955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.218515 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.219024 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:22.219665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.220133 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.220591 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240704060222189167'
      
      
      order by ordinal_position

  
[0m06:02:22.247473 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.252888 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.253386 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:22.262475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.271340 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.271843 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:22.281065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.299233 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:22.299985 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.300468 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240704060222189167"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240704060222189167"
    )
  
[0m06:02:22.315795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.317714 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:22.318183 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.318624 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:22.327614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.328545 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:22.525557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad2e053a0>]}
[0m06:02:22.526480 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m06:02:22.527317 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:22.528918 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.529418 [debug] [MainThread]: On master: BEGIN
[0m06:02:22.529884 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:22.535418 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.535907 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.536358 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.536839 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.537545 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.538017 [debug] [MainThread]: On master: Close
[0m06:02:22.539796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:22.540266 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:22.540721 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:22.541218 [info ] [MainThread]: 
[0m06:02:22.541789 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.87 seconds (7.87s).
[0m06:02:22.542837 [debug] [MainThread]: Command end result
[0m06:02:22.571089 [info ] [MainThread]: 
[0m06:02:22.571765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:22.572326 [info ] [MainThread]: 
[0m06:02:22.572920 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:22.573991 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.825212, "process_user_time": 4.931379, "process_kernel_time": 0.228527, "process_mem_max_rss": "272016", "process_in_blocks": "1184", "process_out_blocks": "111152"}
[0m06:02:22.574648 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:22.574536 after 9.83 seconds
[0m06:02:22.575149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0a84da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab031e3e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad2db4260>]}
[0m06:02:22.575658 [debug] [MainThread]: Flushing usage events
[0m06:02:24.261879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa74cbbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa98957c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa74cb8c0>]}


============================== 06:02:24.264973 | 5a70db62-f882-4d93-b03e-703e78693a33 ==============================
[0m06:02:24.264973 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.265688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.417429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a70db62-f882-4d93-b03e-703e78693a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa8444680>]}
[0m06:02:24.434082 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22165042, "process_user_time": 1.42247, "process_kernel_time": 0.119871, "process_mem_max_rss": "91956", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:24.434691 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:24.434578 after 0.22 seconds
[0m06:02:24.435166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa73faf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa74e4800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa7222330>]}
[0m06:02:24.435604 [debug] [MainThread]: Flushing usage events
[0m14:05:16.975955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0549a322a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0549de2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0549828320>]}


============================== 14:05:17.044759 | e8b006ed-7ad4-4957-984c-72801575b4c2 ==============================
[0m14:05:17.044759 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:17.045462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:17.198239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8b006ed-7ad4-4957-984c-72801575b4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0549a301a0>]}
[0m14:05:17.212359 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-15djfvit'
[0m14:05:17.212899 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:17.322628 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:17.323423 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:17.335307 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:17.339465 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:17.550746 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:17.551373 [info ] [MainThread]: Up to date!
[0m14:05:17.551918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e8b006ed-7ad4-4957-984c-72801575b4c2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05497323f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054978b410>]}
[0m14:05:17.553451 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.62645566, "process_user_time": 1.66041, "process_kernel_time": 0.128651, "process_mem_max_rss": "93568", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m14:05:17.554056 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:17.553950 after 0.63 seconds
[0m14:05:17.554506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054a952120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054984d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054ae961e0>]}
[0m14:05:17.554941 [debug] [MainThread]: Flushing usage events
[0m14:05:19.806565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f3cfbc920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f3d0a00e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f3d0a2f30>]}


============================== 14:05:19.809576 | b80fe615-7344-4d4b-8625-5003d4eae201 ==============================
[0m14:05:19.809576 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:19.810282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:20.051363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f3e72b320>]}
[0m14:05:20.115879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f3dda61e0>]}
[0m14:05:20.116887 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:20.176508 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:20.177336 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:20.177886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f35fd9bb0>]}
[0m14:05:21.476033 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:21.476789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f35b3a060>]}
[0m14:05:21.677369 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:21.682974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f35d853a0>]}
[0m14:05:21.827010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f35bf8bf0>]}
[0m14:05:21.827636 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:21.828236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f35a5a780>]}
[0m14:05:21.830122 [info ] [MainThread]: 
[0m14:05:21.830888 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:21.836127 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:21.872700 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:21.873242 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:21.873655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:22.326541 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.328103 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:22.330328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:22.330887 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:22.337673 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.338116 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:22.338530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:22.344228 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.345663 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.346089 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:22.346753 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.347170 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.347565 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:22.348124 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.349107 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:22.349517 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.349948 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:22.350494 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.350915 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:22.353243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:22.358796 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:22.359225 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:22.359627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:22.365031 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.365484 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:22.365905 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:22.386318 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.391412 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:22.392690 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:22.393112 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:22.397115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f3df44800>]}
[0m14:05:22.397666 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.398088 [debug] [MainThread]: On master: BEGIN
[0m14:05:22.398491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:22.403978 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.404474 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.404878 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.405282 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.405938 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.406382 [debug] [MainThread]: On master: Close
[0m14:05:22.408211 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:22.408764 [info ] [MainThread]: 
[0m14:05:22.431893 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:22.432627 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:22.433346 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:22.433810 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:22.460036 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:22.460969 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:22.496400 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:22.497338 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:32.531698 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:32.532290 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:32.533182 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.533661 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:32.534120 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:32.534887 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.537717 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:32.538190 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:32.538945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.559684 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:32.560289 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:32.560752 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:32.562387 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.567425 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:32.567911 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:32.569482 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.571949 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:32.599147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f0a993ec0>]}
[0m14:05:32.600000 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.16s]
[0m14:05:32.600859 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:32.601895 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:32.602491 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:32.603107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:32.603573 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:32.608878 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:32.609580 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:32.643728 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.644373 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240704140532637701"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:32.644891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:32.661626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.669425 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.670006 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:32.670750 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.671214 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.671666 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240704140532637701'
      
      
      order by ordinal_position

  
[0m14:05:32.698969 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.704728 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.705284 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:32.714180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.723631 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.724172 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:32.733901 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.752738 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:32.753594 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.754101 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240704140532637701"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240704140532637701"
    )
  
[0m14:05:32.769888 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.771939 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:32.772478 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.772923 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:32.784174 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.785275 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:32.974465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f09896e40>]}
[0m14:05:32.975320 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m14:05:32.976107 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:32.977769 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:32.978291 [debug] [MainThread]: On master: BEGIN
[0m14:05:32.978743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:32.984464 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:32.985006 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.985476 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:32.985928 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.986672 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:32.987163 [debug] [MainThread]: On master: Close
[0m14:05:32.989016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:32.989477 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:32.989902 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:32.990416 [info ] [MainThread]: 
[0m14:05:32.990988 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.16 seconds (11.16s).
[0m14:05:32.992100 [debug] [MainThread]: Command end result
[0m14:05:33.021270 [info ] [MainThread]: 
[0m14:05:33.022037 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:33.022593 [info ] [MainThread]: 
[0m14:05:33.023162 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:33.024327 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.269884, "process_user_time": 5.118934, "process_kernel_time": 0.337512, "process_mem_max_rss": "309572", "process_in_blocks": "1184", "process_out_blocks": "108336"}
[0m14:05:33.024998 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:33.024882 after 13.27 seconds
[0m14:05:33.025522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f3d30ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f3d45d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f098ce360>]}
[0m14:05:33.026043 [debug] [MainThread]: Flushing usage events
[0m14:05:35.287863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba47aef380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba49d514f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba482d29f0>]}


============================== 14:05:35.290930 | 301a8b30-9381-43c3-8380-3ff2b2525b28 ==============================
[0m14:05:35.290930 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:35.291616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:35.449400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '301a8b30-9381-43c3-8380-3ff2b2525b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba47a13bf0>]}
[0m14:05:35.466508 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22811587, "process_user_time": 1.44536, "process_kernel_time": 0.139744, "process_mem_max_rss": "91960", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:35.467144 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:35.467031 after 0.23 seconds
[0m14:05:35.467623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4836ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba47991820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba47a10c80>]}
[0m14:05:35.468087 [debug] [MainThread]: Flushing usage events
[0m22:05:44.855911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595e364e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595f342000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595e364620>]}


============================== 22:05:44.875244 | 20fe16b8-a4a2-43ce-a4b1-97a2ec9391ac ==============================
[0m22:05:44.875244 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:44.875933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:45.013702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20fe16b8-a4a2-43ce-a4b1-97a2ec9391ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595e3bc920>]}
[0m22:05:45.027075 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-npfiadf8'
[0m22:05:45.027536 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:45.194914 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:45.195544 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:45.229670 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:45.233360 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:45.568510 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:45.569111 [info ] [MainThread]: Up to date!
[0m22:05:45.569708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '20fe16b8-a4a2-43ce-a4b1-97a2ec9391ac', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595e2c66f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595e2c5e50>]}
[0m22:05:45.571665 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.76496655, "process_user_time": 1.568242, "process_kernel_time": 0.136021, "process_mem_max_rss": "93700", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m22:05:45.572261 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:45.572156 after 0.77 seconds
[0m22:05:45.572699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595e3bfd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595e3bf1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595ee3e8d0>]}
[0m22:05:45.573125 [debug] [MainThread]: Flushing usage events
[0m22:05:47.375776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894b4df170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894b0cc980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894b03ba40>]}


============================== 22:05:47.378532 | bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e ==============================
[0m22:05:47.378532 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:47.379253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:47.603779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894c793470>]}
[0m22:05:47.663214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894ae78d70>]}
[0m22:05:47.664015 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:47.706343 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:47.707063 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:47.707622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894aea8500>]}
[0m22:05:48.904794 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:48.905475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894bab5e80>]}
[0m22:05:49.095568 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:49.100794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89442f55e0>]}
[0m22:05:49.222001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894402f0e0>]}
[0m22:05:49.222585 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:49.223113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8944025430>]}
[0m22:05:49.224929 [info ] [MainThread]: 
[0m22:05:49.225671 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:49.230585 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:49.266408 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:49.266939 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:49.267350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:50.235044 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:50.236610 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:50.238785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:50.239350 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:50.246065 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:50.246506 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:50.246905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:50.252718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:50.254159 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:50.254577 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:50.255127 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:50.255528 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:50.255955 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:50.256532 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:50.257454 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:50.257864 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:50.258250 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:50.258789 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:50.259207 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:50.261516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:50.266924 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:50.267351 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:50.267786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:50.273164 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:50.273593 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:50.273998 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:50.294273 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:50.299456 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:50.300709 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:50.301126 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:50.305276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894b53d1f0>]}
[0m22:05:50.305820 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:50.306233 [debug] [MainThread]: On master: BEGIN
[0m22:05:50.306619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:50.312044 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:50.312494 [debug] [MainThread]: On master: COMMIT
[0m22:05:50.312903 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:50.313289 [debug] [MainThread]: On master: COMMIT
[0m22:05:50.313929 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:50.314350 [debug] [MainThread]: On master: Close
[0m22:05:50.316082 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:50.316600 [info ] [MainThread]: 
[0m22:05:50.327238 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:50.327917 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:50.328678 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:50.329133 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:50.355357 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:50.356231 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:50.391405 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:50.392300 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:01.772207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:01.772733 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:01.773374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.773827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:01.774264 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:01.774962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.777666 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:01.778133 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:01.778832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.799558 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:01.800079 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:01.800525 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:01.802114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.806850 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:01.807334 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:01.808687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.811008 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:01.837832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8918f30530>]}
[0m22:06:01.838577 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.51s]
[0m22:06:01.839464 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:01.840496 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:01.841074 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:01.841751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:01.842222 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:01.847083 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:01.847811 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:01.881233 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:01.881779 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240704220601875328"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:01.882259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:01.898297 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.905489 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:01.905965 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:01.906562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.907015 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:01.907467 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240704220601875328'
      
      
      order by ordinal_position

  
[0m22:06:01.934026 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.939027 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:01.939531 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:01.948233 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.957060 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:01.957555 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:01.966830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.984855 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:01.985563 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:01.986043 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240704220601875328"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240704220601875328"
    )
  
[0m22:06:01.999408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.001214 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:02.001676 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:02.002114 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:02.011078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.012106 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:02.170349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8913fd9790>]}
[0m22:06:02.171184 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m22:06:02.172077 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:02.173402 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:02.173933 [debug] [MainThread]: On master: BEGIN
[0m22:06:02.174371 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:02.179831 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:02.180307 [debug] [MainThread]: On master: COMMIT
[0m22:06:02.180837 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:02.181270 [debug] [MainThread]: On master: COMMIT
[0m22:06:02.181830 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:02.182287 [debug] [MainThread]: On master: Close
[0m22:06:02.183683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:02.184128 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:02.184555 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:02.185038 [info ] [MainThread]: 
[0m22:06:02.185558 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.96 seconds (12.96s).
[0m22:06:02.186540 [debug] [MainThread]: Command end result
[0m22:06:02.214267 [info ] [MainThread]: 
[0m22:06:02.214921 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:02.215440 [info ] [MainThread]: 
[0m22:06:02.215995 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:02.216993 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.890252, "process_user_time": 4.687639, "process_kernel_time": 0.324251, "process_mem_max_rss": "280684", "process_in_blocks": "1184", "process_out_blocks": "108880"}
[0m22:06:02.217636 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:02.217525 after 14.89 seconds
[0m22:06:02.218132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894b142ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894b0a2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8913f652e0>]}
[0m22:06:02.218626 [debug] [MainThread]: Flushing usage events
[0m22:06:04.078535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1955172c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1955a345c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19550b72f0>]}


============================== 22:06:04.081400 | d281fa11-ce58-4c45-9b32-a1560bddbf03 ==============================
[0m22:06:04.081400 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:04.082100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:04.222045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd281fa11-ce58-4c45-9b32-a1560bddbf03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1954ea45c0>]}
[0m22:06:04.238373 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20883004, "process_user_time": 1.43128, "process_kernel_time": 0.111943, "process_mem_max_rss": "92100", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:04.238955 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:04.238852 after 0.21 seconds
[0m22:06:04.239396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19559ff530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19555fad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19555f8d40>]}
[0m22:06:04.239876 [debug] [MainThread]: Flushing usage events
[0m06:02:10.286840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa40476f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa40e33f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa3feb9400>]}


============================== 06:02:10.317496 | 5510b6e0-4988-42cf-9412-a3330d6a2c73 ==============================
[0m06:02:10.317496 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.318302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.482312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5510b6e0-4988-42cf-9412-a3330d6a2c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa3f94bbf0>]}
[0m06:02:10.497237 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zi6jm11e'
[0m06:02:10.497774 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.513495 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.514287 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.525568 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.529540 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.577072 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.577724 [info ] [MainThread]: Up to date!
[0m06:02:10.578374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5510b6e0-4988-42cf-9412-a3330d6a2c73', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa3feb8d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa3f80bc80>]}
[0m06:02:10.585306 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.34853145, "process_user_time": 1.662873, "process_kernel_time": 0.132868, "process_mem_max_rss": "93452", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m06:02:10.585942 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:10.585833 after 0.35 seconds
[0m06:02:10.586398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa408e3ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa3f8404a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa3fb2e990>]}
[0m06:02:10.586848 [debug] [MainThread]: Flushing usage events
[0m06:02:12.269228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12823f1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1280e79d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f128128bb60>]}


============================== 06:02:12.272340 | 335c1b72-b73b-4ba8-9a67-aae8b2e73a05 ==============================
[0m06:02:12.272340 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.273123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.518479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1282027470>]}
[0m06:02:12.578965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12814e2f60>]}
[0m06:02:12.579930 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:12.605905 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:12.606709 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:12.607240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12807108f0>]}
[0m06:02:13.831834 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:13.832556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1280625460>]}
[0m06:02:14.029372 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:14.034938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1279a9c500>]}
[0m06:02:14.188860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1279a9d970>]}
[0m06:02:14.189530 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:14.190039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1279af46e0>]}
[0m06:02:14.191821 [info ] [MainThread]: 
[0m06:02:14.192567 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.197751 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.236104 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.236660 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:14.237148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:14.698218 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.699809 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:14.702070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:14.702664 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:14.709794 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.710280 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:14.710704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.716936 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.718525 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.718956 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:14.719642 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.720057 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.720450 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:14.721086 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.722055 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.722467 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.722853 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.723397 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.723826 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:14.726356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:14.732227 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.732722 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:14.733166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.738896 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.739416 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.739833 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:14.760946 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.766324 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:14.767734 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:14.768210 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:14.772206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1280cfd760>]}
[0m06:02:14.772821 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.773351 [debug] [MainThread]: On master: BEGIN
[0m06:02:14.773746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:14.779370 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.779893 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.780303 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.780696 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.781414 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.781845 [debug] [MainThread]: On master: Close
[0m06:02:14.783860 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:14.784378 [info ] [MainThread]: 
[0m06:02:14.804235 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:14.805012 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:14.805747 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:14.806201 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:14.832407 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:14.833393 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:14.869539 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:14.870558 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:22.449209 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.449817 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:22.450746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.451247 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.451707 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:22.452506 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.455528 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.456010 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:22.456777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.478034 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:22.478603 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.479063 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:22.481692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.486921 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.487406 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:22.488778 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.491397 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:22.518203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1279950ec0>]}
[0m06:02:22.519074 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.71s]
[0m06:02:22.519975 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:22.521038 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:22.521628 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:22.522342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:22.522817 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:22.528175 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:22.528885 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:22.563207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.563842 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240705060222557217"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:22.564348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:22.581186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.589123 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.589667 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:22.590381 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.590844 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.591294 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240705060222557217'
      
      
      order by ordinal_position

  
[0m06:02:22.625028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.630860 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.631403 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:22.644109 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.653488 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.654008 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:22.662858 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.681383 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:22.682227 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.682722 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240705060222557217"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240705060222557217"
    )
  
[0m06:02:22.697809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.699891 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:22.700384 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.700826 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:22.710592 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.711637 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:22.882347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f124d1c9340>]}
[0m06:02:22.883587 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m06:02:22.884701 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:22.886529 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.887036 [debug] [MainThread]: On master: BEGIN
[0m06:02:22.887492 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:22.893948 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.894453 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.894908 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.895348 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.896039 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.896551 [debug] [MainThread]: On master: Close
[0m06:02:22.898690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:22.899260 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:22.899749 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:22.900297 [info ] [MainThread]: 
[0m06:02:22.901048 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.71 seconds (8.71s).
[0m06:02:22.902348 [debug] [MainThread]: Command end result
[0m06:02:22.932696 [info ] [MainThread]: 
[0m06:02:22.933557 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:22.934169 [info ] [MainThread]: 
[0m06:02:22.934951 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:22.936235 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.716856, "process_user_time": 4.996104, "process_kernel_time": 0.301212, "process_mem_max_rss": "277372", "process_in_blocks": "1184", "process_out_blocks": "108856"}
[0m06:02:22.936925 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:22.936787 after 10.72 seconds
[0m06:02:22.937623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1280d58cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1280d3f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f124e323620>]}
[0m06:02:22.938244 [debug] [MainThread]: Flushing usage events
[0m06:02:24.758095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd4457b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd4457590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd45bb1d0>]}


============================== 06:02:24.761131 | 88b309fc-97a3-41ca-92b7-7fbb042b7e18 ==============================
[0m06:02:24.761131 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.761886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.919931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88b309fc-97a3-41ca-92b7-7fbb042b7e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd4368cb0>]}
[0m06:02:24.937115 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2294497, "process_user_time": 1.489172, "process_kernel_time": 0.092072, "process_mem_max_rss": "92208", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:24.937740 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:24.937634 after 0.23 seconds
[0m06:02:24.938197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd7fbbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd4afde80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd45efdd0>]}
[0m06:02:24.938646 [debug] [MainThread]: Flushing usage events
[0m14:05:23.663375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19ad300dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19af67d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19b0b883b0>]}


============================== 14:05:23.670778 | 31e4bcaf-a209-4537-8701-9680d34f681a ==============================
[0m14:05:23.670778 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.671503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:23.812261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31e4bcaf-a209-4537-8701-9680d34f681a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19adc23050>]}
[0m14:05:23.825528 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-dgtm92yr'
[0m14:05:23.825991 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:23.854669 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:23.855315 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:23.866017 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:23.869655 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:24.078676 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:24.079237 [info ] [MainThread]: Up to date!
[0m14:05:24.079804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '31e4bcaf-a209-4537-8701-9680d34f681a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19ad34ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19b0fbbd40>]}
[0m14:05:24.081578 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46614787, "process_user_time": 1.552673, "process_kernel_time": 0.138986, "process_mem_max_rss": "93492", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m14:05:24.082224 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:24.082099 after 0.47 seconds
[0m14:05:24.082674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19ae04b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19b0b883b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19adb4f110>]}
[0m14:05:24.083143 [debug] [MainThread]: Flushing usage events
[0m14:05:25.989370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ec11ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16eb7db320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16eb7d9070>]}


============================== 14:05:25.992114 | 4dbc5b2b-7b28-44b6-a160-b5102d82361a ==============================
[0m14:05:25.992114 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:25.992839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:26.217146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16eb893200>]}
[0m14:05:26.276246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16eb61ab70>]}
[0m14:05:26.277123 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:26.344735 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:26.345479 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:26.346052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ebb5fda0>]}
[0m14:05:27.549759 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:27.550492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e4a8f950>]}
[0m14:05:27.746061 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:27.751035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e4970170>]}
[0m14:05:27.873885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e48f7ad0>]}
[0m14:05:27.874519 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:27.875011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e47b2780>]}
[0m14:05:27.876702 [info ] [MainThread]: 
[0m14:05:27.877391 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:27.882357 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:27.917168 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:27.917640 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:27.918153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:28.390216 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.391753 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:28.394115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:28.394685 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:28.401402 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.401846 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:28.402293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:28.407684 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.409060 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.409481 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:28.410348 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.410764 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.411158 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:28.411801 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.412736 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:28.413144 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.413536 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:28.414110 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.414531 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:28.416630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:28.422115 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:28.422548 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:28.422934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:28.428253 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.428685 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:28.429118 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:28.449669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.454610 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:28.455865 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:28.456296 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:28.460386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16eb80ec30>]}
[0m14:05:28.460928 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:28.461337 [debug] [MainThread]: On master: BEGIN
[0m14:05:28.461727 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:28.467122 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:28.467569 [debug] [MainThread]: On master: COMMIT
[0m14:05:28.467986 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:28.468381 [debug] [MainThread]: On master: COMMIT
[0m14:05:28.469028 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:28.469454 [debug] [MainThread]: On master: Close
[0m14:05:28.471052 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:28.471577 [info ] [MainThread]: 
[0m14:05:28.480414 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:28.481056 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:28.481721 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:28.482218 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:28.507926 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:28.508741 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:28.543053 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:28.543880 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:39.128708 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.129246 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:39.129883 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.130387 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.130840 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:39.131538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.134272 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.134748 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:39.135448 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.156019 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:39.156513 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.156967 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:39.158290 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.163052 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.163547 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:39.164879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.167244 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:39.194175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ece7a750>]}
[0m14:05:39.194934 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.71s]
[0m14:05:39.195713 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:39.196694 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:39.197271 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:39.197849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:39.198356 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:39.203301 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:39.203978 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:39.237301 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.237927 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240705140539231350"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:39.238451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:39.255110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.262506 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.263014 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:39.263754 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.264222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.264676 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240705140539231350'
      
      
      order by ordinal_position

  
[0m14:05:39.291528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.297290 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.297829 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:39.312342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.321835 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.322383 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:39.331763 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.349994 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:39.350776 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.351260 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240705140539231350"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240705140539231350"
    )
  
[0m14:05:39.366345 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.368184 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:39.368662 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.369106 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:39.378944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.379869 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:39.548662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ece7a750>]}
[0m14:05:39.549514 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m14:05:39.550299 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:39.551633 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.552124 [debug] [MainThread]: On master: BEGIN
[0m14:05:39.552567 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:39.557861 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.558383 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.558832 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.559272 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.559984 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.560448 [debug] [MainThread]: On master: Close
[0m14:05:39.561839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:39.562333 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:39.562748 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:39.563219 [info ] [MainThread]: 
[0m14:05:39.563746 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.69 seconds (11.69s).
[0m14:05:39.564767 [debug] [MainThread]: Command end result
[0m14:05:39.592723 [info ] [MainThread]: 
[0m14:05:39.593361 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:39.593885 [info ] [MainThread]: 
[0m14:05:39.594459 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:39.595463 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.654462, "process_user_time": 4.708136, "process_kernel_time": 0.339433, "process_mem_max_rss": "267812", "process_in_blocks": "1184", "process_out_blocks": "109568"}
[0m14:05:39.596130 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:39.596008 after 13.66 seconds
[0m14:05:39.596630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ebfe3a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e3587bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e49ef980>]}
[0m14:05:39.597132 [debug] [MainThread]: Flushing usage events
[0m14:05:41.572755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d7e2d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d7cab530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d7e11580>]}


============================== 14:05:41.575615 | 8e93415c-a9c6-47e7-923d-18b462720011 ==============================
[0m14:05:41.575615 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:41.576321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:41.716708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e93415c-a9c6-47e7-923d-18b462720011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d888c050>]}
[0m14:05:41.733563 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20938076, "process_user_time": 1.459596, "process_kernel_time": 0.095973, "process_mem_max_rss": "91880", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:41.734204 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:41.734096 after 0.21 seconds
[0m14:05:41.734660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d7e12240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d77fe570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d7889c40>]}
[0m14:05:41.735107 [debug] [MainThread]: Flushing usage events
[0m22:06:07.830517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c42b8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c46833b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c68016a0>]}


============================== 22:06:07.851752 | e5912975-844a-41cc-999a-42a470c9d6d3 ==============================
[0m22:06:07.851752 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:07.852500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:07.995322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5912975-844a-41cc-999a-42a470c9d6d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c4120b30>]}
[0m22:06:08.008809 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-n9yzqggc'
[0m22:06:08.009277 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:08.099046 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:08.099785 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:08.123479 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:08.127305 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:08.199778 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:08.200395 [info ] [MainThread]: Up to date!
[0m22:06:08.200975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e5912975-844a-41cc-999a-42a470c9d6d3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c401f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c401fe00>]}
[0m22:06:08.202393 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42020696, "process_user_time": 1.580239, "process_kernel_time": 0.120322, "process_mem_max_rss": "93728", "process_in_blocks": "5752", "process_out_blocks": "3840"}
[0m22:06:08.203006 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:08.202901 after 0.42 seconds
[0m22:06:08.203458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c4a79e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c4044350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c4000e30>]}
[0m22:06:08.203901 [debug] [MainThread]: Flushing usage events
[0m22:06:09.809246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7172b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6f1d13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6f20eb40>]}


============================== 22:06:09.812022 | 4fa23025-4ad4-4216-ad63-bf332f90d57f ==============================
[0m22:06:09.812022 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:09.812756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:10.036968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c67d17680>]}
[0m22:06:10.096294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c70c325d0>]}
[0m22:06:10.097171 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:06:10.112772 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:10.113499 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:10.114071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c67c2cfb0>]}
[0m22:06:11.315298 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:11.315986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c67905940>]}
[0m22:06:11.505771 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:11.510598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c679f3fb0>]}
[0m22:06:11.632799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c67813440>]}
[0m22:06:11.633380 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:11.633890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6f040e90>]}
[0m22:06:11.635625 [info ] [MainThread]: 
[0m22:06:11.636326 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:11.641116 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:11.676136 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:11.676600 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:06:11.677022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:12.169215 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.170829 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:12.173157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:12.173755 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:12.180689 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.181141 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:06:12.181553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:12.187373 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.188769 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.189195 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:12.189866 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.190355 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.190756 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:12.191345 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.192335 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:12.192770 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.193167 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:12.193714 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.194181 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:12.196290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:12.201609 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:12.202074 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:12.202472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:12.207677 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.208106 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:12.208519 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:06:12.229053 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.233743 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:12.234958 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:12.235384 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:12.238627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c67850650>]}
[0m22:06:12.239158 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:12.239561 [debug] [MainThread]: On master: BEGIN
[0m22:06:12.239944 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:12.245015 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:12.245445 [debug] [MainThread]: On master: COMMIT
[0m22:06:12.245843 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:12.246280 [debug] [MainThread]: On master: COMMIT
[0m22:06:12.246787 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:12.247196 [debug] [MainThread]: On master: Close
[0m22:06:12.248563 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:12.249125 [info ] [MainThread]: 
[0m22:06:12.258019 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:12.258631 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:12.259365 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:12.259823 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:12.284998 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:12.285756 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:12.319710 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:12.320463 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:20.098943 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:20.099503 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:20.100296 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.100766 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:20.101214 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:20.101934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.104629 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:20.105102 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:20.105816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.126552 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:20.127051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:20.127496 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:20.128693 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.133468 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:20.133983 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:20.135164 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.137527 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:20.163673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c4c1c8dd0>]}
[0m22:06:20.164476 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.90s]
[0m22:06:20.165269 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:20.166312 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:20.166910 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:20.167594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:20.168061 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:20.173108 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:20.173770 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:20.207183 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.207722 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240705220620201169"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:20.208210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:20.224865 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.232400 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.232908 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:20.233564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.234046 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.234498 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240705220620201169'
      
      
      order by ordinal_position

  
[0m22:06:20.261062 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.266490 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.267001 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:20.275773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.284690 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.285183 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:20.294677 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.312621 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:20.313343 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.313834 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240705220620201169"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240705220620201169"
    )
  
[0m22:06:20.328138 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.329887 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:20.330381 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.330817 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:20.341352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.342318 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:20.514923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c3772f410>]}
[0m22:06:20.515760 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m22:06:20.516513 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:20.517973 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:20.518481 [debug] [MainThread]: On master: BEGIN
[0m22:06:20.518923 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:20.524246 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:20.524732 [debug] [MainThread]: On master: COMMIT
[0m22:06:20.525177 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:20.525607 [debug] [MainThread]: On master: COMMIT
[0m22:06:20.526361 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:20.526826 [debug] [MainThread]: On master: Close
[0m22:06:20.528184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:20.528632 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:20.529049 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:20.529532 [info ] [MainThread]: 
[0m22:06:20.530106 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.89 seconds (8.89s).
[0m22:06:20.531100 [debug] [MainThread]: Command end result
[0m22:06:20.558837 [info ] [MainThread]: 
[0m22:06:20.559447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:20.559954 [info ] [MainThread]: 
[0m22:06:20.560475 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:20.561449 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.80099, "process_user_time": 4.685303, "process_kernel_time": 0.354886, "process_mem_max_rss": "273532", "process_in_blocks": "1184", "process_out_blocks": "109600"}
[0m22:06:20.562147 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:20.562031 after 10.80 seconds
[0m22:06:20.562655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6e9a2ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c679c1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6658b140>]}
[0m22:06:20.563149 [debug] [MainThread]: Flushing usage events
[0m22:06:22.260584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd5732930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4fa7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4dd72c0>]}


============================== 22:06:22.263394 | 6e92c1ca-adbd-41f6-83fb-c60c82c9c6c9 ==============================
[0m22:06:22.263394 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:22.264120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:22.405284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e92c1ca-adbd-41f6-83fb-c60c82c9c6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd53408c0>]}
[0m22:06:22.421802 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21014805, "process_user_time": 1.405213, "process_kernel_time": 0.12811, "process_mem_max_rss": "92076", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:22.422469 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:22.422362 after 0.21 seconds
[0m22:06:22.422932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd51aaae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd5f7ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4ca1820>]}
[0m22:06:22.423381 [debug] [MainThread]: Flushing usage events
[0m06:02:09.942246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7386a1d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7384a96750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73858f07d0>]}


============================== 06:02:09.949155 | 6cb6ac62-d221-4327-8ee1-9ff09c76701d ==============================
[0m06:02:09.949155 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.949819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.108079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cb6ac62-d221-4327-8ee1-9ff09c76701d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7384511010>]}
[0m06:02:10.123762 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4z_gz1vs'
[0m06:02:10.124348 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.165956 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.166766 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.179227 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.183129 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.398732 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.399261 [info ] [MainThread]: Up to date!
[0m06:02:10.399806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6cb6ac62-d221-4327-8ee1-9ff09c76701d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73843b5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7385472f30>]}
[0m06:02:10.401287 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5071558, "process_user_time": 1.603147, "process_kernel_time": 0.116228, "process_mem_max_rss": "93196", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m06:02:10.401890 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:10.401784 after 0.51 seconds
[0m06:02:10.402333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7388367da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7384b17170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7384e66fc0>]}
[0m06:02:10.402767 [debug] [MainThread]: Flushing usage events
[0m06:02:12.198763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee619f0da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee61a6b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee61a6b0b0>]}


============================== 06:02:12.201540 | c8be9ef3-95a5-45bc-a750-464758da8db1 ==============================
[0m06:02:12.201540 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.202186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.428006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5af7ce90>]}
[0m06:02:12.487142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6312b4d0>]}
[0m06:02:12.487912 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:12.503684 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:12.504407 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:12.505006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee61a6b230>]}
[0m06:02:13.720099 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:13.720816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5aeee9f0>]}
[0m06:02:13.910930 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:13.916932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5abd7e30>]}
[0m06:02:14.043299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5abd5fd0>]}
[0m06:02:14.043871 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:14.044387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5aa75d00>]}
[0m06:02:14.046152 [info ] [MainThread]: 
[0m06:02:14.046881 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.051666 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.087262 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.087768 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:14.088187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:14.447304 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.448891 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:14.451244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:14.451857 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:14.458713 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.459161 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:14.459562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.464962 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.466310 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.466725 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:14.467285 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.467763 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.468153 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:14.468726 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.469664 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.470075 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.470466 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.471130 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.471555 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:14.473665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:14.478922 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.479345 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:14.479727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.484736 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.485157 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.485565 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:14.505070 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.509800 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:14.510982 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:14.511577 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:14.515402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5ab38140>]}
[0m06:02:14.515931 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.516339 [debug] [MainThread]: On master: BEGIN
[0m06:02:14.516783 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:14.521871 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.522306 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.522713 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.523105 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.523615 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.524036 [debug] [MainThread]: On master: Close
[0m06:02:14.525486 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:14.526037 [info ] [MainThread]: 
[0m06:02:14.535008 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:14.535632 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:14.536378 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:14.536885 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:14.562348 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:14.563124 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:14.597144 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:14.597896 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:26.231584 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.232109 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:26.232793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.233259 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.233710 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:26.234490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.237191 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.237666 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:26.238375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.258979 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:26.259471 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.259922 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:26.261048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.265817 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.266298 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:26.267461 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.269789 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:26.294845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2af58ef0>]}
[0m06:02:26.295594 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.76s]
[0m06:02:26.296380 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:26.297419 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:26.298009 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:26.298630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:26.299092 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:26.303992 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:26.304704 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:26.337980 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.338502 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240706060226332087"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:26.338984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:26.353852 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.360829 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.361315 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:26.361918 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.362379 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.362829 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240706060226332087'
      
      
      order by ordinal_position

  
[0m06:02:26.388782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.393802 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.394303 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:26.402648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.411191 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.411693 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:26.419999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.437957 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:26.438657 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.439140 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240706060226332087"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240706060226332087"
    )
  
[0m06:02:26.454923 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.456785 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:26.457261 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.457699 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:26.467448 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.468342 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:26.646488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2a8cf590>]}
[0m06:02:26.647356 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m06:02:26.648256 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:26.649753 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.650256 [debug] [MainThread]: On master: BEGIN
[0m06:02:26.650721 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:26.656126 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.656677 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.657144 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.657601 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.658177 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.658643 [debug] [MainThread]: On master: Close
[0m06:02:26.660408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:26.660907 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:26.661335 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:26.661814 [info ] [MainThread]: 
[0m06:02:26.662431 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.62 seconds (12.62s).
[0m06:02:26.663574 [debug] [MainThread]: Command end result
[0m06:02:26.692247 [info ] [MainThread]: 
[0m06:02:26.692970 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:26.693574 [info ] [MainThread]: 
[0m06:02:26.694187 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:26.695292 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.544912, "process_user_time": 4.780916, "process_kernel_time": 0.263609, "process_mem_max_rss": "278252", "process_in_blocks": "1184", "process_out_blocks": "110072"}
[0m06:02:26.695947 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:26.695832 after 14.55 seconds
[0m06:02:26.696459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee61dc3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee619f0ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee61e95580>]}
[0m06:02:26.697010 [debug] [MainThread]: Flushing usage events
[0m06:02:28.595920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8764d3f770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87649c7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f876492f4d0>]}


============================== 06:02:28.598745 | ce2b2932-20ad-46d0-a942-1e0ecc6339af ==============================
[0m06:02:28.598745 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:28.599485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:28.743338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce2b2932-20ad-46d0-a942-1e0ecc6339af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87648b8290>]}
[0m06:02:28.759937 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21273965, "process_user_time": 1.424759, "process_kernel_time": 0.092049, "process_mem_max_rss": "92204", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:28.760529 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:28.760426 after 0.21 seconds
[0m06:02:28.761024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87653aac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8764994260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8764cda660>]}
[0m06:02:28.761466 [debug] [MainThread]: Flushing usage events
[0m14:04:57.499345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5c882450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5c882000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5de952e0>]}


============================== 14:04:57.534404 | f0941742-5993-4e44-9777-876632896acb ==============================
[0m14:04:57.534404 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:57.535099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:57.682682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0941742-5993-4e44-9777-876632896acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5bfb42c0>]}
[0m14:04:57.696251 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-unkmjs1m'
[0m14:04:57.696741 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:57.805567 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:57.806281 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:57.830461 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:57.834180 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:57.907205 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:57.907819 [info ] [MainThread]: Up to date!
[0m14:04:57.908446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f0941742-5993-4e44-9777-876632896acb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5b878e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5b87b980>]}
[0m14:04:57.910384 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4594648, "process_user_time": 1.583588, "process_kernel_time": 0.111688, "process_mem_max_rss": "93572", "process_in_blocks": "5752", "process_out_blocks": "3840"}
[0m14:04:57.911001 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:57.910897 after 0.46 seconds
[0m14:04:57.911440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5c335d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5b919250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5bb6aea0>]}
[0m14:04:57.911886 [debug] [MainThread]: Flushing usage events
[0m14:04:59.463428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa739757170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73971d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa738d68b90>]}


============================== 14:04:59.466219 | 39fccebe-4b67-4583-abbf-32398542557f ==============================
[0m14:04:59.466219 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:59.466990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:59.698335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73a47f830>]}
[0m14:04:59.757400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73a47f830>]}
[0m14:04:59.758229 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:59.862880 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:59.864043 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:59.864741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa738b94260>]}
[0m14:05:01.095443 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:01.096137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7320cdeb0>]}
[0m14:05:01.286185 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:01.291252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa738c1d5b0>]}
[0m14:05:01.415337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa731eef950>]}
[0m14:05:01.415897 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:01.416426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa731daaba0>]}
[0m14:05:01.418160 [info ] [MainThread]: 
[0m14:05:01.418928 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:01.423804 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:01.457978 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:01.458455 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:01.458865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:02.011315 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:02.012857 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:02.015078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:02.015667 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:02.022431 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:02.022875 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:02.023274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:02.028776 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:02.030144 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:02.030604 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:02.031254 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:02.031660 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:02.032049 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:02.032619 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:02.033533 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:02.033942 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:02.034369 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:02.035055 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:02.035503 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:02.037517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:02.043008 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:02.043434 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:02.043822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:02.048912 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:02.049332 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:02.049737 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:02.069862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:02.074634 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:02.075835 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:02.076251 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:02.079497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73a7743b0>]}
[0m14:05:02.080031 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:02.080433 [debug] [MainThread]: On master: BEGIN
[0m14:05:02.080806 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:02.085988 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:02.086454 [debug] [MainThread]: On master: COMMIT
[0m14:05:02.086899 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:02.087289 [debug] [MainThread]: On master: COMMIT
[0m14:05:02.087912 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:02.088327 [debug] [MainThread]: On master: Close
[0m14:05:02.089784 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:02.090324 [info ] [MainThread]: 
[0m14:05:02.132314 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:02.132976 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:02.133660 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:02.134107 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:02.159310 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:02.160077 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:02.194663 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:02.195441 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:16.902704 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.903233 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:16.903835 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.904292 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.904740 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:16.905410 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.908131 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.908598 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:16.909284 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.929463 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:16.929951 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.930432 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:16.932493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.937263 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.937746 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:16.940768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.943166 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:16.968768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73a47e7e0>]}
[0m14:05:16.969497 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 14.83s]
[0m14:05:16.970277 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:16.971325 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:16.971912 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:16.972523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:16.972989 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:16.977830 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:16.978526 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:17.011616 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.012209 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240706140517005796"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:17.012700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:17.028991 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.035893 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.036371 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:17.036964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.037422 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.037867 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240706140517005796'
      
      
      order by ordinal_position

  
[0m14:05:17.064738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.070378 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.070908 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:17.085290 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.094668 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.095183 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:17.103947 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.121784 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:17.122535 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.123020 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240706140517005796"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240706140517005796"
    )
  
[0m14:05:17.138272 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.140170 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:17.140661 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.141110 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:17.150768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.151718 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:17.347473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa705c54e30>]}
[0m14:05:17.348293 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m14:05:17.349051 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:17.350380 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:17.350859 [debug] [MainThread]: On master: BEGIN
[0m14:05:17.351298 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:17.356489 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:17.356959 [debug] [MainThread]: On master: COMMIT
[0m14:05:17.357398 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:17.357822 [debug] [MainThread]: On master: COMMIT
[0m14:05:17.358392 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:17.358848 [debug] [MainThread]: On master: Close
[0m14:05:17.360168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:17.360607 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:17.361018 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:17.361476 [info ] [MainThread]: 
[0m14:05:17.362021 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 15.94 seconds (15.94s).
[0m14:05:17.363108 [debug] [MainThread]: Command end result
[0m14:05:17.390575 [info ] [MainThread]: 
[0m14:05:17.391214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:17.391758 [info ] [MainThread]: 
[0m14:05:17.392321 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:17.393339 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.978561, "process_user_time": 4.789821, "process_kernel_time": 0.310046, "process_mem_max_rss": "279336", "process_in_blocks": "1184", "process_out_blocks": "111096"}
[0m14:05:17.393980 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:17.393870 after 17.98 seconds
[0m14:05:17.394512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7399933b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7390d9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa705c31610>]}
[0m14:05:17.395020 [debug] [MainThread]: Flushing usage events
[0m14:05:19.023830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0721a7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0725d6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0725d70b0>]}


============================== 14:05:19.026661 | 71bd17ff-c12a-4806-bca0-f25d6552e951 ==============================
[0m14:05:19.026661 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:19.027390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:19.174267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71bd17ff-c12a-4806-bca0-f25d6552e951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff071af7a40>]}
[0m14:05:19.191338 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2159999, "process_user_time": 1.415083, "process_kernel_time": 0.095937, "process_mem_max_rss": "91844", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:19.191939 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:19.191835 after 0.22 seconds
[0m14:05:19.192391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0721a7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0720a2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff071af7a40>]}
[0m14:05:19.192832 [debug] [MainThread]: Flushing usage events
[0m22:05:30.700450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236de8f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236d4ca000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236d486600>]}


============================== 22:05:30.759456 | cbe274b2-5895-4280-872c-9d6670032a5f ==============================
[0m22:05:30.759456 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:30.760111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:30.897539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbe274b2-5895-4280-872c-9d6670032a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236d0b7e60>]}
[0m22:05:30.910675 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yusukxht'
[0m22:05:30.911129 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:30.985874 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:30.986598 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:31.010030 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:31.013674 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:31.085057 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:31.085562 [info ] [MainThread]: Up to date!
[0m22:05:31.086090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cbe274b2-5895-4280-872c-9d6670032a5f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236d4de7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236ce1f590>]}
[0m22:05:31.087592 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43505037, "process_user_time": 1.555033, "process_kernel_time": 0.116226, "process_mem_max_rss": "93540", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m22:05:31.088182 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:31.088080 after 0.44 seconds
[0m22:05:31.088619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236d101970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236cebb2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236da330b0>]}
[0m22:05:31.089042 [debug] [MainThread]: Flushing usage events
[0m22:05:32.632743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104126d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1041676120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1041676510>]}


============================== 22:05:32.635437 | 44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684 ==============================
[0m22:05:32.635437 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:32.636179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:32.860175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1041fd34a0>]}
[0m22:05:32.919021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1041e39040>]}
[0m22:05:32.919747 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:32.943625 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:32.944336 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:32.944884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10405ed070>]}
[0m22:05:34.156256 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:34.156949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1039c7f680>]}
[0m22:05:34.348962 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:34.353866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1039a87380>]}
[0m22:05:34.471450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10399433e0>]}
[0m22:05:34.472086 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:34.472636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10425de540>]}
[0m22:05:34.474316 [info ] [MainThread]: 
[0m22:05:34.475066 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:34.479994 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:34.514426 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:34.514901 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:34.515308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:34.886100 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.887695 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:34.889697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:34.890256 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:34.896887 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:34.897328 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:34.897728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:34.903012 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.904285 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:34.904690 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:34.905545 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.905945 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:34.906338 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:34.907025 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.907932 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:34.908340 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:34.908719 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:34.909256 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.909662 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:34.911649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:34.916848 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:34.917276 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:34.917667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:34.922567 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.922996 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:34.923408 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:34.943626 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.948396 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:34.949562 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:34.949974 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:34.953130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10399abf20>]}
[0m22:05:34.953642 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:34.954042 [debug] [MainThread]: On master: BEGIN
[0m22:05:34.954417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:34.959441 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:34.959870 [debug] [MainThread]: On master: COMMIT
[0m22:05:34.960263 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:34.960647 [debug] [MainThread]: On master: COMMIT
[0m22:05:34.961156 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:34.961571 [debug] [MainThread]: On master: Close
[0m22:05:34.962971 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:34.963493 [info ] [MainThread]: 
[0m22:05:34.972104 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:34.972702 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:34.973365 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:34.973818 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:34.998912 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:34.999658 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:35.034908 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:35.035671 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:41.989683 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.990203 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:41.990893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.991372 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.991824 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:41.992518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.995218 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.995696 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:41.996391 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.016998 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:42.017489 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.017944 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:42.019203 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.023941 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.024431 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:42.026121 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.028454 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:42.054277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1041fd2570>]}
[0m22:05:42.055025 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.08s]
[0m22:05:42.055798 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:42.056774 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:42.057336 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:42.057899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:42.058359 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:42.063151 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:42.063796 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:42.097564 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.098106 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240706220542091338"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:42.098641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:42.114696 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.121606 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.122085 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:42.122703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.123166 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.123619 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240706220542091338'
      
      
      order by ordinal_position

  
[0m22:05:42.156178 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.161075 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.161571 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:42.170346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.178854 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.179352 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:42.188570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.206524 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:42.207229 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.207713 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240706220542091338"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240706220542091338"
    )
  
[0m22:05:42.222186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.223909 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:42.224375 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.224825 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:42.234301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.235214 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:42.425354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f100d198530>]}
[0m22:05:42.426214 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m22:05:42.426999 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:42.428336 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:42.428822 [debug] [MainThread]: On master: BEGIN
[0m22:05:42.429269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:42.434719 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:42.435200 [debug] [MainThread]: On master: COMMIT
[0m22:05:42.435645 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:42.436081 [debug] [MainThread]: On master: COMMIT
[0m22:05:42.436726 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:42.437194 [debug] [MainThread]: On master: Close
[0m22:05:42.438652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:42.439102 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:42.439519 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:42.439991 [info ] [MainThread]: 
[0m22:05:42.440521 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.97 seconds (7.97s).
[0m22:05:42.441538 [debug] [MainThread]: Command end result
[0m22:05:42.469385 [info ] [MainThread]: 
[0m22:05:42.470006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:42.470539 [info ] [MainThread]: 
[0m22:05:42.471069 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:42.472058 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.888197, "process_user_time": 4.698295, "process_kernel_time": 0.317235, "process_mem_max_rss": "279424", "process_in_blocks": "1184", "process_out_blocks": "111136"}
[0m22:05:42.472711 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:42.472599 after 9.89 seconds
[0m22:05:42.473211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10406e3b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104089f6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f100d24b320>]}
[0m22:05:42.473704 [debug] [MainThread]: Flushing usage events
[0m22:05:44.121029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88848d7170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8885eb1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8886f61f40>]}


============================== 22:05:44.123931 | 90cd82ad-4054-4545-a344-4b99bea01ced ==============================
[0m22:05:44.123931 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:44.124672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:05:44.266381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90cd82ad-4054-4545-a344-4b99bea01ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f888494a030>]}
[0m22:05:44.282854 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21048708, "process_user_time": 1.408753, "process_kernel_time": 0.128068, "process_mem_max_rss": "91984", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:44.283459 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:44.283348 after 0.21 seconds
[0m22:05:44.283910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f888490a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8885231820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8885262c00>]}
[0m22:05:44.284350 [debug] [MainThread]: Flushing usage events
[0m06:01:57.778367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d85e5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d82fe600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d82fe300>]}


============================== 06:01:57.785535 | 98215c8b-fe36-4a69-b7f9-9c4107f9eb68 ==============================
[0m06:01:57.785535 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:01:57.786237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:01:57.925809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98215c8b-fe36-4a69-b7f9-9c4107f9eb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d81bbbf0>]}
[0m06:01:57.939207 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-dtqi3adu'
[0m06:01:57.939685 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:01:58.038561 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:01:58.039197 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:01:58.062735 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:01:58.066655 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:01:58.140262 [info ] [MainThread]: Installed from version 1.2.0
[0m06:01:58.140776 [info ] [MainThread]: Up to date!
[0m06:01:58.141303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '98215c8b-fe36-4a69-b7f9-9c4107f9eb68', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d7ff0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d92894f0>]}
[0m06:01:58.142951 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41277158, "process_user_time": 1.539866, "process_kernel_time": 0.138905, "process_mem_max_rss": "93484", "process_in_blocks": "5752", "process_out_blocks": "3840"}
[0m06:01:58.143561 [debug] [MainThread]: Command `dbt deps` succeeded at 06:01:58.143455 after 0.41 seconds
[0m06:01:58.144017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d89bc2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d8396240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d83961b0>]}
[0m06:01:58.144453 [debug] [MainThread]: Flushing usage events
[0m06:01:59.725014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f93ba8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f93c1dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f93c1f230>]}


============================== 06:01:59.727774 | c0d39a50-9c87-4828-9bd7-2d71a5adf5a6 ==============================
[0m06:01:59.727774 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:01:59.728419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:01:59.951445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f93a5deb0>]}
[0m06:02:00.010863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f93abeed0>]}
[0m06:02:00.011776 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:00.027460 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:00.028211 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:00.028769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8d1e5040>]}
[0m06:02:01.235326 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:01.235984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8cf58770>]}
[0m06:02:01.425438 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:01.430414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8ce70ce0>]}
[0m06:02:01.551736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8ceb0290>]}
[0m06:02:01.552307 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:01.552811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8cc0a2a0>]}
[0m06:02:01.554536 [info ] [MainThread]: 
[0m06:02:01.555229 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:01.560000 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:01.594899 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:01.595349 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:01.595754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:02.009780 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:02.011381 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:02.013595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:02.014202 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:02.021076 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:02.021523 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:02.021924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:02.027285 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:02.028640 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:02.029055 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:02.029871 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:02.030323 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:02.030715 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:02.031333 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:02.032274 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:02.032681 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:02.033064 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:02.033602 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:02.034020 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:02.036264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:02.041560 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:02.041980 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:02.042400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:02.047218 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:02.047637 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:02.048040 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:02.067390 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:02.074080 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:02.075307 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:02.075725 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:02.079296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8cc08650>]}
[0m06:02:02.079848 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:02.080251 [debug] [MainThread]: On master: BEGIN
[0m06:02:02.080644 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:02.086034 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:02.086518 [debug] [MainThread]: On master: COMMIT
[0m06:02:02.086926 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:02.087315 [debug] [MainThread]: On master: COMMIT
[0m06:02:02.087951 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:02.088376 [debug] [MainThread]: On master: Close
[0m06:02:02.090182 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:02.090691 [info ] [MainThread]: 
[0m06:02:02.100374 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:02.100993 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:02.101651 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:02.102131 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:02.127887 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:02.128647 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:02.162911 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:02.163667 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:11.015089 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:11.015613 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:11.016258 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.016726 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:11.017176 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:11.017853 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.020583 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:11.021069 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:11.021754 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.042331 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:11.042835 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:11.043287 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:11.045574 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.050392 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:11.050887 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:11.052352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.054767 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:11.080906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f604d3350>]}
[0m06:02:11.081713 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.98s]
[0m06:02:11.082540 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:11.083540 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:11.084111 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:11.084721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:11.085197 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:11.090240 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:11.090941 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:11.124476 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:11.124999 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240707060211118645"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:11.125491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:11.141601 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.148549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:11.149034 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:11.149648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.150125 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:11.150589 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240707060211118645'
      
      
      order by ordinal_position

  
[0m06:02:11.176586 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.181630 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:11.182151 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:11.190448 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.199008 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:11.199520 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:11.207946 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.225882 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:11.226621 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:11.227107 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240707060211118645"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240707060211118645"
    )
  
[0m06:02:11.242846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.244691 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:11.245160 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:11.245616 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:11.257795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.259045 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:11.467188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f60515400>]}
[0m06:02:11.468015 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m06:02:11.468868 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:11.470390 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:11.470865 [debug] [MainThread]: On master: BEGIN
[0m06:02:11.471299 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:11.476583 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:11.477062 [debug] [MainThread]: On master: COMMIT
[0m06:02:11.477502 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:11.477941 [debug] [MainThread]: On master: COMMIT
[0m06:02:11.478679 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:11.479144 [debug] [MainThread]: On master: Close
[0m06:02:11.480517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:11.480963 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:11.481380 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:11.481846 [info ] [MainThread]: 
[0m06:02:11.482450 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.93 seconds (9.93s).
[0m06:02:11.483490 [debug] [MainThread]: Command end result
[0m06:02:11.513228 [info ] [MainThread]: 
[0m06:02:11.513930 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:11.514574 [info ] [MainThread]: 
[0m06:02:11.515190 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:11.516262 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.839974, "process_user_time": 4.882793, "process_kernel_time": 0.324451, "process_mem_max_rss": "291032", "process_in_blocks": "1184", "process_out_blocks": "109056"}
[0m06:02:11.516923 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:11.516811 after 11.84 seconds
[0m06:02:11.517423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f93f731a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f93bcfb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8ceb2c00>]}
[0m06:02:11.517918 [debug] [MainThread]: Flushing usage events
[0m06:02:13.168552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023d6f1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023bda1b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023bf5a330>]}


============================== 06:02:13.171367 | 06ee74cb-3712-405c-b51a-a9cba1c383d3 ==============================
[0m06:02:13.171367 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:13.172027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.312992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06ee74cb-3712-405c-b51a-a9cba1c383d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023c7dc5c0>]}
[0m06:02:13.329592 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20961884, "process_user_time": 1.409637, "process_kernel_time": 0.095839, "process_mem_max_rss": "92096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:13.330224 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:13.330086 after 0.21 seconds
[0m06:02:13.330675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023c03e5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023bb9b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023bbff0b0>]}
[0m06:02:13.331125 [debug] [MainThread]: Flushing usage events
[0m14:04:30.740608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26ded2fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26dfe61910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26debca000>]}


============================== 14:04:30.761187 | 98bc3c35-543d-45aa-a772-865ea2560327 ==============================
[0m14:04:30.761187 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:30.761842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:30.907436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98bc3c35-543d-45aa-a772-865ea2560327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26de21d640>]}
[0m14:04:30.920882 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ag97hule'
[0m14:04:30.921343 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:30.966332 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:30.967033 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:30.979698 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:30.983408 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:31.124132 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:31.124754 [info ] [MainThread]: Up to date!
[0m14:04:31.125317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '98bc3c35-543d-45aa-a772-865ea2560327', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26de3fe990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26de0c1040>]}
[0m14:04:31.127178 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43434957, "process_user_time": 1.541247, "process_kernel_time": 0.152917, "process_mem_max_rss": "93452", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m14:04:31.127783 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:31.127677 after 0.44 seconds
[0m14:04:31.128291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e1dbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26df4a2f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26de1401a0>]}
[0m14:04:31.128732 [debug] [MainThread]: Flushing usage events
[0m14:04:32.743295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3bababd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3bab8ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3bab8d10>]}


============================== 14:04:32.746147 | a75cf497-4bbf-42a6-bc21-190069e46385 ==============================
[0m14:04:32.746147 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:32.746880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:32.983057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3d2273b0>]}
[0m14:04:33.042409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3b96e300>]}
[0m14:04:33.043288 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:33.094550 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:33.095344 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:33.095888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3b927f20>]}
[0m14:04:34.303986 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:34.304680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3c3e8fb0>]}
[0m14:04:34.498485 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:34.503772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb348192e0>]}
[0m14:04:34.670603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3455be90>]}
[0m14:04:34.671192 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:34.671727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb34585d90>]}
[0m14:04:34.673535 [info ] [MainThread]: 
[0m14:04:34.674275 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:34.679154 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:34.714162 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:34.714623 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:04:34.715033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:35.401401 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:35.403000 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:35.405338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:35.405928 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:35.412800 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:35.413251 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:04:35.413665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:35.419438 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:35.420825 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:35.421248 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:35.422104 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:35.422521 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:35.422919 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:35.423541 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:35.424528 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:35.424944 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:35.425331 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:35.425860 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:35.426283 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:35.428528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:35.433928 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:35.434370 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:35.434760 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:35.439818 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:35.440285 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:35.440701 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:04:35.460659 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:35.465464 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:35.466680 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:35.467106 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:35.470972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3b915700>]}
[0m14:04:35.471506 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:35.471910 [debug] [MainThread]: On master: BEGIN
[0m14:04:35.472350 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:35.477631 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:35.478068 [debug] [MainThread]: On master: COMMIT
[0m14:04:35.478468 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:35.478857 [debug] [MainThread]: On master: COMMIT
[0m14:04:35.479365 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:35.479782 [debug] [MainThread]: On master: Close
[0m14:04:35.481556 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:35.482074 [info ] [MainThread]: 
[0m14:04:35.496076 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:35.496715 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:35.497397 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:35.497853 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:35.523544 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:35.524386 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:35.558559 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:35.559380 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:44.627177 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:44.627704 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:04:44.628347 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.628813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:44.629263 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:04:44.629942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.632623 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:44.633089 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:04:44.633922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.654132 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:44.654611 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:44.655052 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:44.657491 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.662172 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:44.662656 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:04:44.664578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.666888 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:04:44.693086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb309c2e10>]}
[0m14:04:44.693843 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.19s]
[0m14:04:44.694642 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:04:44.695679 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:04:44.696310 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:04:44.696935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:04:44.697403 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:04:44.702312 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:04:44.702992 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:04:44.736290 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:44.736816 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240707140444730468"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:04:44.737306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:44.752220 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.759404 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:44.759891 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:04:44.760538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.760997 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:44.761438 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240707140444730468'
      
      
      order by ordinal_position

  
[0m14:04:44.787434 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.792467 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:44.792958 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:44.806972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.815690 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:44.816230 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:44.825294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.842875 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:04:44.843587 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:44.844105 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240707140444730468"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240707140444730468"
    )
  
[0m14:04:44.859355 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.861264 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:44.861747 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:44.862207 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:44.872064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.872986 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:04:45.040624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb08396720>]}
[0m14:04:45.041477 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m14:04:45.042272 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:04:45.043717 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:45.044274 [debug] [MainThread]: On master: BEGIN
[0m14:04:45.044743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:45.050133 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:45.050624 [debug] [MainThread]: On master: COMMIT
[0m14:04:45.051075 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:45.051515 [debug] [MainThread]: On master: COMMIT
[0m14:04:45.052240 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:45.052713 [debug] [MainThread]: On master: Close
[0m14:04:45.054556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:45.055004 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:04:45.055426 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:04:45.055924 [info ] [MainThread]: 
[0m14:04:45.056536 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.38 seconds (10.38s).
[0m14:04:45.057614 [debug] [MainThread]: Command end result
[0m14:04:45.085970 [info ] [MainThread]: 
[0m14:04:45.086616 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:45.087167 [info ] [MainThread]: 
[0m14:04:45.087735 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:04:45.088797 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.39346, "process_user_time": 4.788215, "process_kernel_time": 0.275782, "process_mem_max_rss": "271340", "process_in_blocks": "1184", "process_out_blocks": "109568"}
[0m14:04:45.089449 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:45.089338 after 12.39 seconds
[0m14:04:45.089950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3bfd3a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb181eab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb083bce90>]}
[0m14:04:45.090441 [debug] [MainThread]: Flushing usage events
[0m14:04:46.813686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc375d74860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc375e9f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc375c49790>]}


============================== 14:04:46.816468 | 678cf81a-7506-419d-ad44-d24a81b75c17 ==============================
[0m14:04:46.816468 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:46.817149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:04:46.961553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '678cf81a-7506-419d-ad44-d24a81b75c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37587ffb0>]}
[0m14:04:46.977970 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21309517, "process_user_time": 1.417512, "process_kernel_time": 0.092359, "process_mem_max_rss": "92364", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:04:46.978567 [debug] [MainThread]: Command `dbt clean` succeeded at 14:04:46.978461 after 0.21 seconds
[0m14:04:46.979014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc377e21610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc376b5ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37718f6e0>]}
[0m14:04:46.979470 [debug] [MainThread]: Flushing usage events
[0m22:05:13.359088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ebd2a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ec512a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ec13e240>]}


============================== 22:05:13.366070 | 1f5dbaad-9387-45bf-bdb0-65100214eb08 ==============================
[0m22:05:13.366070 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:13.366824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:13.510794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f5dbaad-9387-45bf-bdb0-65100214eb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ebd27bc0>]}
[0m22:05:13.523931 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jh09s47w'
[0m22:05:13.524397 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:13.597527 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:13.598166 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:13.622632 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:13.626402 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:13.697386 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:13.697885 [info ] [MainThread]: Up to date!
[0m22:05:13.698419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1f5dbaad-9387-45bf-bdb0-65100214eb08', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ec512a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3eba833e0>]}
[0m22:05:13.699805 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38946906, "process_user_time": 1.572785, "process_kernel_time": 0.123747, "process_mem_max_rss": "93368", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m22:05:13.700401 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:13.700296 after 0.39 seconds
[0m22:05:13.700837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ec1c5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ec152c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ebd27bc0>]}
[0m22:05:13.701265 [debug] [MainThread]: Flushing usage events
[0m22:05:15.272709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c86db3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c86db1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c86db2cc0>]}


============================== 22:05:15.275437 | 7d7f8fba-18c6-4006-be6d-da807cc28b48 ==============================
[0m22:05:15.275437 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:15.276174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:15.499612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7f928440>]}
[0m22:05:15.558642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c863002f0>]}
[0m22:05:15.559436 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:15.574781 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:15.575495 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:15.576050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c86244e60>]}
[0m22:05:16.786542 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:16.787232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c862a0050>]}
[0m22:05:16.976079 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:16.981318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7f450bf0>]}
[0m22:05:17.103032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7f49d0d0>]}
[0m22:05:17.103596 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:17.104131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7f5a1280>]}
[0m22:05:17.105898 [info ] [MainThread]: 
[0m22:05:17.106650 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:17.111404 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:17.145764 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:17.146213 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:17.146621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:17.669975 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:17.671567 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:17.673833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:17.674415 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:17.681317 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:17.681767 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:17.682173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:17.687878 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:17.689208 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:17.689625 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:17.690490 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:17.690958 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:17.691355 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:17.691986 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:17.692922 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:17.693333 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:17.693736 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:17.694280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:17.694727 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:17.696831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:17.702136 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:17.702562 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:17.702987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:17.708019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:17.708443 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:17.708859 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:17.728937 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:17.733631 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:17.734827 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:17.735323 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:17.738981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c873132f0>]}
[0m22:05:17.739508 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:17.739917 [debug] [MainThread]: On master: BEGIN
[0m22:05:17.740306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:17.745665 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:17.746115 [debug] [MainThread]: On master: COMMIT
[0m22:05:17.746521 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:17.746962 [debug] [MainThread]: On master: COMMIT
[0m22:05:17.747575 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:17.748002 [debug] [MainThread]: On master: Close
[0m22:05:17.749469 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:17.749983 [info ] [MainThread]: 
[0m22:05:17.758937 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:17.759537 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:17.760200 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:17.760644 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:17.786402 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:17.787181 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:17.821568 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:17.822304 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:25.325399 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.325921 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:25.326551 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.327052 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.327502 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:25.328189 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.330890 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.331374 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:25.332063 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.352496 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:25.352985 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.353436 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:25.354621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.359389 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.359878 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:25.361087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.363420 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:25.390357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4eccf500>]}
[0m22:05:25.391121 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.63s]
[0m22:05:25.391889 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:25.392845 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:25.393417 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:25.393986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:25.394451 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:25.399357 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:25.400008 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:25.433349 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.433875 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240707220525427422"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:25.434357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:25.450127 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.456980 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.457454 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:25.458046 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.458512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.458994 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240707220525427422'
      
      
      order by ordinal_position

  
[0m22:05:25.491034 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.495917 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.496469 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:25.505026 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.513395 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.513901 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:25.522562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.540405 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:25.541082 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.541559 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240707220525427422"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240707220525427422"
    )
  
[0m22:05:25.556679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.558431 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:25.558966 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.559409 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:25.569067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.569955 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:25.743518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4ec86090>]}
[0m22:05:25.744344 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m22:05:25.745111 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:25.746501 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:25.747027 [debug] [MainThread]: On master: BEGIN
[0m22:05:25.747476 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:25.752740 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:25.753224 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.753674 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:25.754118 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.754669 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:25.755165 [debug] [MainThread]: On master: Close
[0m22:05:25.756713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:25.757158 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:25.757586 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:25.758056 [info ] [MainThread]: 
[0m22:05:25.758598 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.65 seconds (8.65s).
[0m22:05:25.759717 [debug] [MainThread]: Command end result
[0m22:05:25.788106 [info ] [MainThread]: 
[0m22:05:25.788758 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:25.789284 [info ] [MainThread]: 
[0m22:05:25.789827 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:25.790858 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.566594, "process_user_time": 4.771006, "process_kernel_time": 0.281593, "process_mem_max_rss": "294400", "process_in_blocks": "1184", "process_out_blocks": "109600"}
[0m22:05:25.791517 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:25.791407 after 10.57 seconds
[0m22:05:25.792019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c89dbbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c863f0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c86894c80>]}
[0m22:05:25.792512 [debug] [MainThread]: Flushing usage events
[0m22:05:27.429338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcd6637d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcf065b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcf91d730>]}


============================== 22:05:27.432077 | 166f47f0-c022-4dfc-a985-d25e7d8f0242 ==============================
[0m22:05:27.432077 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:27.432806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:05:27.575134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '166f47f0-c022-4dfc-a985-d25e7d8f0242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcd537d70>]}
[0m22:05:27.591636 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21132627, "process_user_time": 1.420173, "process_kernel_time": 0.091752, "process_mem_max_rss": "91836", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:27.592215 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:27.592109 after 0.21 seconds
[0m22:05:27.592666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcd747140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcd552c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcea266f0>]}
[0m22:05:27.593113 [debug] [MainThread]: Flushing usage events
