[0m21:00:20.944754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8eaa210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8fd2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e92fb1a0>]}


============================== 21:00:20.951955 | f918d5aa-2af2-4fe0-b7ab-caae99178f6b ==============================
[0m21:00:20.951955 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:00:20.952631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:00:21.098081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f918d5aa-2af2-4fe0-b7ab-caae99178f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8d13a70>]}
[0m21:00:21.111536 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-dtlheftm'
[0m21:00:21.112018 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:00:21.155754 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:00:21.156396 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:00:21.166432 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:00:21.170132 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:00:21.402208 [info ] [MainThread]: Installed from version 1.2.0
[0m21:00:21.402744 [info ] [MainThread]: Up to date!
[0m21:00:21.403302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f918d5aa-2af2-4fe0-b7ab-caae99178f6b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8c343b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8bef410>]}
[0m21:00:21.404681 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.50804603, "process_user_time": 1.591879, "process_kernel_time": 0.124616, "process_mem_max_rss": "93076", "process_in_blocks": "5672", "process_out_blocks": "3840"}
[0m21:00:21.405295 [debug] [MainThread]: Command `dbt deps` succeeded at 21:00:21.405188 after 0.51 seconds
[0m21:00:21.405748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8eaa210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e992caa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ea0491f0>]}
[0m21:00:21.406251 [debug] [MainThread]: Flushing usage events
[0m21:00:23.183919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dc1a81a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dd3d3380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dc392000>]}


============================== 21:00:23.186764 | 00c5cfc1-e684-49c0-906a-b29bb090025b ==============================
[0m21:00:23.186764 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:00:23.187445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:00:23.415213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dc0e4e90>]}
[0m21:00:23.474418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dda0f440>]}
[0m21:00:23.475204 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m21:00:23.490414 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:00:23.491149 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:00:23.491712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d57772c0>]}
[0m21:00:24.708884 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:00:24.709588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d5469220>]}
[0m21:00:24.900557 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:00:24.906640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d5220ef0>]}
[0m21:00:25.063637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d543c380>]}
[0m21:00:25.064219 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m21:00:25.064727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d52214f0>]}
[0m21:00:25.066451 [info ] [MainThread]: 
[0m21:00:25.067153 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:00:25.071859 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:00:25.106617 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:00:25.107072 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m21:00:25.107491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:25.533862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.535472 [debug] [ThreadPool]: On list_petro: Close
[0m21:00:25.537697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:00:25.538306 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:00:25.545170 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:00:25.545622 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m21:00:25.546028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:25.551669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.553004 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:00:25.553420 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:00:25.554355 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.554771 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:00:25.555167 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:00:25.555787 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.556728 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:00:25.557140 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:00:25.557531 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:00:25.558081 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.558543 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:00:25.560517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:00:25.565802 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:00:25.566260 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:00:25.566658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:25.571509 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.571938 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:00:25.572351 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m21:00:25.591753 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.596342 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:00:25.597519 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:00:25.597944 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:00:25.601025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d53af7a0>]}
[0m21:00:25.601552 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:25.601958 [debug] [MainThread]: On master: BEGIN
[0m21:00:25.602392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:25.607369 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:00:25.607801 [debug] [MainThread]: On master: COMMIT
[0m21:00:25.608202 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:25.608598 [debug] [MainThread]: On master: COMMIT
[0m21:00:25.609227 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:00:25.609645 [debug] [MainThread]: On master: Close
[0m21:00:25.611134 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:00:25.611651 [info ] [MainThread]: 
[0m21:00:25.629868 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:00:25.630538 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m21:00:25.631196 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m21:00:25.631652 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:00:25.657029 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:00:25.657774 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:00:25.691987 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:00:25.692737 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:00:37.006438 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.006974 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:00:37.007589 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.008051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.008503 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:00:37.009185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.011890 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.012361 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:00:37.013045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.033594 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:00:37.034080 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.034556 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:00:37.035771 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.040484 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.040979 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m21:00:37.042078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.044400 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:00:37.069529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dcc73530>]}
[0m21:00:37.070303 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.44s]
[0m21:00:37.071194 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:00:37.072178 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m21:00:37.072782 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m21:00:37.073387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m21:00:37.073844 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m21:00:37.078684 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m21:00:37.079322 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m21:00:37.112254 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.112768 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240621210037106502"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m21:00:37.113242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:37.127681 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.134525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.134996 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:00:37.135576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.136030 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.136477 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240621210037106502'
      
      
      order by ordinal_position

  
[0m21:00:37.162344 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.167218 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.167710 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:00:37.181680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.190310 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.190798 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:00:37.199027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.216831 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m21:00:37.217530 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.218011 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240621210037106502"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240621210037106502"
    )
  
[0m21:00:37.228272 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.230000 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:00:37.230512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.230950 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:00:37.239013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.239881 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m21:00:37.337164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a9155d60>]}
[0m21:00:37.337921 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.26s]
[0m21:00:37.338838 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m21:00:37.340252 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:37.340736 [debug] [MainThread]: On master: BEGIN
[0m21:00:37.341178 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:00:37.346468 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:00:37.346950 [debug] [MainThread]: On master: COMMIT
[0m21:00:37.347400 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:37.347832 [debug] [MainThread]: On master: COMMIT
[0m21:00:37.348517 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:00:37.348985 [debug] [MainThread]: On master: Close
[0m21:00:37.350436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:37.350885 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m21:00:37.351305 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m21:00:37.351781 [info ] [MainThread]: 
[0m21:00:37.352310 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.28 seconds (12.28s).
[0m21:00:37.353306 [debug] [MainThread]: Command end result
[0m21:00:37.380681 [info ] [MainThread]: 
[0m21:00:37.381296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:00:37.381810 [info ] [MainThread]: 
[0m21:00:37.382373 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:00:37.383343 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.24889, "process_user_time": 4.636834, "process_kernel_time": 0.333185, "process_mem_max_rss": "267884", "process_in_blocks": "1184", "process_out_blocks": "106080"}
[0m21:00:37.383989 [debug] [MainThread]: Command `dbt run` succeeded at 21:00:37.383881 after 14.25 seconds
[0m21:00:37.384482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dc8a5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dffbbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a92ff530>]}
[0m21:00:37.384977 [debug] [MainThread]: Flushing usage events
[0m21:03:40.897075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d6c7e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d6de24e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d90d1970>]}


============================== 21:03:41.039058 | 4ee9d8e9-8ad0-4fa2-8c2f-ebde5674a0c5 ==============================
[0m21:03:41.039058 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:03:41.039749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:03:41.183577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ee9d8e9-8ad0-4fa2-8c2f-ebde5674a0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d72db620>]}
[0m21:03:41.204192 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jpugovjm'
[0m21:03:41.204674 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:03:41.292975 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:03:41.293739 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:03:41.343759 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:03:41.347649 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:03:41.419490 [info ] [MainThread]: Installed from version 1.2.0
[0m21:03:41.420074 [info ] [MainThread]: Up to date!
[0m21:03:41.420722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4ee9d8e9-8ad0-4fa2-8c2f-ebde5674a0c5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d69d8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d7c9d160>]}
[0m21:03:41.422186 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5743885, "process_user_time": 1.673774, "process_kernel_time": 0.107344, "process_mem_max_rss": "93412", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m21:03:41.422796 [debug] [MainThread]: Command `dbt deps` succeeded at 21:03:41.422691 after 0.58 seconds
[0m21:03:41.423247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d70a1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d72db620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d6cc6030>]}
[0m21:03:41.423685 [debug] [MainThread]: Flushing usage events
[0m21:03:48.252082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ca83320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97d4d39b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ca83380>]}


============================== 21:03:48.254974 | 1aec2a5c-ad67-4921-bdce-de02a192cc9c ==============================
[0m21:03:48.254974 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:03:48.255634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:03:48.493316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ca128a0>]}
[0m21:03:48.556995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97d40c2c0>]}
[0m21:03:48.557920 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m21:03:48.573248 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:03:48.672329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:03:48.672812 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:03:48.678739 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:03:48.708459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97cab5490>]}
[0m21:03:48.811461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb975664b60>]}
[0m21:03:48.812056 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m21:03:48.812606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb975894890>]}
[0m21:03:48.814353 [info ] [MainThread]: 
[0m21:03:48.815109 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:03:48.819888 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:03:48.858279 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:03:48.858777 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m21:03:48.859191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:49.407276 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m21:03:49.408875 [debug] [ThreadPool]: On list_petro: Close
[0m21:03:49.411079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:03:49.411674 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:03:49.418628 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:49.419080 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m21:03:49.419505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:49.425044 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.426498 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:49.426921 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:03:49.427589 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.428007 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:49.428404 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:03:49.428984 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.429945 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:03:49.430358 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:49.430757 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:03:49.431403 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.431838 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:03:49.434039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:03:49.439375 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:03:49.439801 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:03:49.440190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:49.445060 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.445520 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:03:49.445932 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m21:03:49.465484 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.471882 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:03:49.473069 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:03:49.473539 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:03:49.477087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97e09d010>]}
[0m21:03:49.477646 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:49.478046 [debug] [MainThread]: On master: BEGIN
[0m21:03:49.478427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:03:49.483864 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:49.484302 [debug] [MainThread]: On master: COMMIT
[0m21:03:49.484700 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:49.485084 [debug] [MainThread]: On master: COMMIT
[0m21:03:49.485743 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:49.486160 [debug] [MainThread]: On master: Close
[0m21:03:49.487675 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:03:49.488187 [info ] [MainThread]: 
[0m21:03:49.497351 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:03:49.497998 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m21:03:49.498743 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m21:03:49.499201 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:03:49.525169 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:03:49.525842 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:03:49.560427 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:03:49.561093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:03:57.942719 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.943251 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:03:57.944049 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.944517 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.944968 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:03:57.945850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.948538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.949008 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:03:57.949746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.970495 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:03:57.970989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.971442 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:03:57.972624 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.977398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.977898 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m21:03:57.979033 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.981351 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:03:58.006795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97d7872c0>]}
[0m21:03:58.007594 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.51s]
[0m21:03:58.008394 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:03:58.009419 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m21:03:58.009992 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m21:03:58.010603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m21:03:58.011066 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m21:03:58.027087 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m21:03:58.027753 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m21:03:58.061144 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.061699 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240621210358055298"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m21:03:58.062193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:58.076717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.083942 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.084424 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:03:58.085036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.085526 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.085980 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240621210358055298'
      
      
      order by ordinal_position

  
[0m21:03:58.112161 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.117199 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.117746 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:03:58.126067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.134711 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.135209 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:03:58.144268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.162221 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m21:03:58.162913 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.163430 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240621210358055298"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240621210358055298"
    )
  
[0m21:03:58.173120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.174931 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:03:58.175394 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.175843 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:03:58.184638 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.185578 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m21:03:58.289503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb94918ae70>]}
[0m21:03:58.290341 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.28s]
[0m21:03:58.291215 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m21:03:58.292567 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:58.293054 [debug] [MainThread]: On master: BEGIN
[0m21:03:58.293538 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:03:58.298790 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:58.299279 [debug] [MainThread]: On master: COMMIT
[0m21:03:58.299731 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:58.300169 [debug] [MainThread]: On master: COMMIT
[0m21:03:58.300734 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:58.301201 [debug] [MainThread]: On master: Close
[0m21:03:58.302630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:58.303083 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m21:03:58.303503 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m21:03:58.303976 [info ] [MainThread]: 
[0m21:03:58.304538 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.49 seconds (9.49s).
[0m21:03:58.305627 [debug] [MainThread]: Command end result
[0m21:03:58.333134 [info ] [MainThread]: 
[0m21:03:58.333820 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:03:58.334371 [info ] [MainThread]: 
[0m21:03:58.334934 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:03:58.335956 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.135513, "process_user_time": 3.377523, "process_kernel_time": 0.335753, "process_mem_max_rss": "280980", "process_in_blocks": "1200", "process_out_blocks": "105520"}
[0m21:03:58.336600 [debug] [MainThread]: Command `dbt run` succeeded at 21:03:58.336490 after 10.14 seconds
[0m21:03:58.337097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97cef2ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ca83320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb94a31fc80>]}
[0m21:03:58.337616 [debug] [MainThread]: Flushing usage events
[0m21:04:00.088300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd45b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cce1b1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd4584d0>]}


============================== 21:04:00.091191 | 6d0ff847-f120-4914-a5f6-f2722a0cfeb4 ==============================
[0m21:04:00.091191 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:04:00.091844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:04:00.237635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d0ff847-f120-4914-a5f6-f2722a0cfeb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd5f0da0>]}
[0m21:04:00.254043 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21470842, "process_user_time": 1.465699, "process_kernel_time": 0.091855, "process_mem_max_rss": "92004", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m21:04:00.254629 [debug] [MainThread]: Command `dbt clean` succeeded at 21:04:00.254526 after 0.22 seconds
[0m21:04:00.255073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd2f78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd45bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd45b500>]}
[0m21:04:00.255512 [debug] [MainThread]: Flushing usage events
