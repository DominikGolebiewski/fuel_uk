[0m14:06:54.474287 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250715140654467815"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:54.474881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:54.482667 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.490110 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.490561 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:54.491169 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.491605 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.492058 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250715140654467815'
      
      
      order by ordinal_position

  
[0m14:06:54.494179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.499235 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.499683 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:54.501772 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.509308 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.509759 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:54.512134 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.530292 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:54.530949 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.531419 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250715140654467815"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250715140654467815"
    )
  
[0m14:06:54.579481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.581534 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:54.582021 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.582441 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:54.590003 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.590903 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:54.592487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09308d6d-edf1-4466-9431-a161911700cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e3732750>]}
[0m14:06:54.593182 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:06:54.593905 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:54.595517 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:54.595917 [debug] [MainThread]: On master: BEGIN
[0m14:06:54.596322 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:54.596956 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:54.597386 [debug] [MainThread]: On master: COMMIT
[0m14:06:54.597756 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:54.598158 [debug] [MainThread]: On master: COMMIT
[0m14:06:54.598668 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:54.599086 [debug] [MainThread]: On master: Close
[0m14:06:54.599708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:54.600097 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:54.600492 [info ] [MainThread]: 
[0m14:06:54.600953 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.52 seconds (8.52s).
[0m14:06:54.601884 [debug] [MainThread]: Command end result
[0m14:06:54.627801 [info ] [MainThread]: 
[0m14:06:54.628362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:54.628806 [info ] [MainThread]: 
[0m14:06:54.629278 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:54.630216 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.538381, "process_user_time": 4.943477, "process_kernel_time": 0.274693, "process_mem_max_rss": "339808", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m14:06:54.630746 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:54.630646 after 10.54 seconds
[0m14:06:54.631199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9255cf1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9273674d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9259f23f0>]}
[0m14:06:54.631617 [debug] [MainThread]: Flushing usage events
[0m14:06:56.430822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6768e135c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6769b84f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67670bdee0>]}


============================== 14:06:56.433947 | d676c5db-9b13-438b-99e5-6cbbd5564aef ==============================
[0m14:06:56.433947 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:56.434659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:56.542057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd676c5db-9b13-438b-99e5-6cbbd5564aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6766e4b2f0>]}
[0m14:06:56.559685 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17781195, "process_user_time": 1.342943, "process_kernel_time": 0.097922, "process_mem_max_rss": "100468", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:06:56.560259 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:56.560155 after 0.18 seconds
[0m14:06:56.560668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f676738af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f676703f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6766fde660>]}
[0m14:06:56.561099 [debug] [MainThread]: Flushing usage events
[0m22:06:37.212915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53bacdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53bacf980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53bacfd70>]}


============================== 22:06:37.228375 | aabb3fd5-bfb4-489e-8aa5-efc015182123 ==============================
[0m22:06:37.228375 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:37.229046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:37.362884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aabb3fd5-bfb4-489e-8aa5-efc015182123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53baec560>]}
[0m22:06:37.378224 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yj9vlmh4'
[0m22:06:37.378705 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:37.465005 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:37.465726 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:37.506004 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:37.509847 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:37.878680 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:37.879264 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:37.879792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'aabb3fd5-bfb4-489e-8aa5-efc015182123', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53b198980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53b1982c0>]}
[0m22:06:37.880251 [info ] [MainThread]: 
[0m22:06:37.880734 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:37.890962 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.72705317, "process_user_time": 1.53077, "process_kernel_time": 0.147073, "process_mem_max_rss": "101828", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m22:06:37.891525 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:37.891422 after 0.73 seconds
[0m22:06:37.891942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53b4377a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53b56cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53d7eb1a0>]}
[0m22:06:37.892375 [debug] [MainThread]: Flushing usage events
[0m22:06:39.668735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd92b512e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9080b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8ffcf950>]}


============================== 22:06:39.671802 | 07f61831-7c10-488c-aa9a-cde013106d34 ==============================
[0m22:06:39.671802 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:39.672440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:39.872747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8fe4ef90>]}
[0m22:06:39.931763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd91cdccb0>]}
[0m22:06:39.934306 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:39.958071 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:39.958785 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:39.959321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8fcb1c70>]}
[0m22:06:41.257700 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:41.258343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bddb350>]}
[0m22:06:41.489356 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:41.494798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bb78980>]}
[0m22:06:41.591409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bb19df0>]}
[0m22:06:41.591925 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:41.592464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bbdaa20>]}
[0m22:06:41.594279 [info ] [MainThread]: 
[0m22:06:41.594998 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:41.599646 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:41.633853 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:41.634300 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:41.634682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:42.118118 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.119955 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:42.121170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:42.121788 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:42.130250 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.130778 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:42.131309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.132436 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.134095 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.134645 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:42.135367 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.135779 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.136232 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:42.136884 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.137949 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.138387 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.138785 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.139363 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.139789 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:42.141166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:42.147512 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.148033 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:42.148480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.149180 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.149642 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.150062 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:42.161782 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.163266 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:42.164494 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:42.164891 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:42.167228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bbd6810>]}
[0m22:06:42.167738 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.168118 [debug] [MainThread]: On master: BEGIN
[0m22:06:42.168500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:42.169097 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.169524 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.169887 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.170259 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.170775 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.171193 [debug] [MainThread]: On master: Close
[0m22:06:42.171723 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:42.172235 [info ] [MainThread]: 
[0m22:06:42.191027 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:42.191623 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:42.192266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:42.192703 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:42.219858 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:42.220731 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:42.256835 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:42.257715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:54.131366 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.131853 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:54.132518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.132949 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.133387 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:54.134061 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.136969 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.137423 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:54.138080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.154671 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.155124 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.155565 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.157016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.162600 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.163055 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:54.165002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.167376 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:54.168886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8a725e20>]}
[0m22:06:54.169571 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.98s]
[0m22:06:54.170390 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:54.171241 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:54.171793 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:54.172577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:54.173012 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:54.177899 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:54.178541 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:54.214469 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.214953 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250715220654208490"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:54.215423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:54.223242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.230804 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.231350 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:54.232014 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.232552 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.232968 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250715220654208490'
      
      
      order by ordinal_position

  
[0m22:06:54.236007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.241188 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.241644 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.243783 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.251419 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.251872 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.254599 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.272778 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:54.273476 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.273936 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250715220654208490"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250715220654208490"
    )
  
[0m22:06:54.324834 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.326820 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.327295 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.327701 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.337283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.338165 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:54.339699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd51cff9e0>]}
[0m22:06:54.340384 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:06:54.341102 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:54.342474 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:54.342894 [debug] [MainThread]: On master: BEGIN
[0m22:06:54.343308 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:54.343940 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:54.344375 [debug] [MainThread]: On master: COMMIT
[0m22:06:54.344836 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:54.345226 [debug] [MainThread]: On master: COMMIT
[0m22:06:54.345741 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:54.346129 [debug] [MainThread]: On master: Close
[0m22:06:54.346829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:54.347233 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:54.347630 [info ] [MainThread]: 
[0m22:06:54.348156 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.75 seconds (12.75s).
[0m22:06:54.349167 [debug] [MainThread]: Command end result
[0m22:06:54.374556 [info ] [MainThread]: 
[0m22:06:54.375162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:54.375674 [info ] [MainThread]: 
[0m22:06:54.376203 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:54.377187 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.757243, "process_user_time": 5.138785, "process_kernel_time": 0.273935, "process_mem_max_rss": "338488", "process_in_blocks": "1200", "process_out_blocks": "100152"}
[0m22:06:54.377716 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:54.377615 after 14.76 seconds
[0m22:06:54.378175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd90be5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd900cc860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bb193d0>]}
[0m22:06:54.378597 [debug] [MainThread]: Flushing usage events
[0m22:06:56.323267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abf787680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abf07efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abf07ccb0>]}


============================== 22:06:56.326368 | 95fa7ffe-f6a5-4e22-86a0-17caea396030 ==============================
[0m22:06:56.326368 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:56.326999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:56.434372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95fa7ffe-f6a5-4e22-86a0-17caea396030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac0353440>]}
[0m22:06:56.451700 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1783122, "process_user_time": 1.325029, "process_kernel_time": 0.103923, "process_mem_max_rss": "100612", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:56.452240 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:56.452119 after 0.18 seconds
[0m22:06:56.452683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abebec500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abe9575f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abe905f70>]}
[0m22:06:56.453089 [debug] [MainThread]: Flushing usage events
[0m06:02:22.133185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef604d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef5ace3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef5acd9d0>]}


============================== 06:02:22.148970 | fe0263f7-afe7-4523-98b3-40ac2073f6c9 ==============================
[0m06:02:22.148970 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:22.149595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:22.282135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe0263f7-afe7-4523-98b3-40ac2073f6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef57e3c80>]}
[0m06:02:22.296398 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-c_151u01'
[0m06:02:22.296846 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:22.461089 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:22.461670 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:22.484325 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:22.488101 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:22.556772 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:22.557253 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:22.557780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fe0263f7-afe7-4523-98b3-40ac2073f6c9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef4ec3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef4ec36b0>]}
[0m06:02:22.558198 [info ] [MainThread]: 
[0m06:02:22.558651 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:22.566816 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4823665, "process_user_time": 1.539886, "process_kernel_time": 0.136078, "process_mem_max_rss": "101216", "process_in_blocks": "8744", "process_out_blocks": "5168"}
[0m06:02:22.567342 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:22.567241 after 0.48 seconds
[0m06:02:22.567766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef529c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef529f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef5185c40>]}
[0m06:02:22.568186 [debug] [MainThread]: Flushing usage events
[0m06:02:24.167576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e255910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e7eb770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e254680>]}


============================== 06:02:24.170612 | 8b2c16f7-faaf-4259-ba0e-97c5c525244b ==============================
[0m06:02:24.170612 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.171275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.370525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22a11a1b0>]}
[0m06:02:24.428430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22ffd8c80>]}
[0m06:02:24.430961 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:24.454388 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:24.455099 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:24.455606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22a119c70>]}
[0m06:02:25.753023 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:25.753550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22ffd8a70>]}
[0m06:02:25.970929 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:25.976275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e27d940>]}
[0m06:02:26.079676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe229e57cb0>]}
[0m06:02:26.080189 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:26.080703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe229ef1ee0>]}
[0m06:02:26.082479 [info ] [MainThread]: 
[0m06:02:26.083143 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:26.087686 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:26.121488 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:26.121930 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:26.122313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:26.611513 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.613913 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:26.615271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:26.616105 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:26.624951 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.625370 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:26.625768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:26.626708 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.628031 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.628419 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:26.628959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.629341 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.629703 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:26.630307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.631237 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:26.631624 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.632007 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:26.632556 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.632992 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:26.634193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:26.639837 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:26.640323 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:26.640690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:26.641303 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.641688 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:26.642084 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:26.651535 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.652979 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:26.654206 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:26.654607 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:26.656873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe229f683e0>]}
[0m06:02:26.657371 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.657775 [debug] [MainThread]: On master: BEGIN
[0m06:02:26.658134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:26.658717 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.659140 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.659504 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.659881 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.660451 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.660864 [debug] [MainThread]: On master: Close
[0m06:02:26.661364 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:26.661847 [info ] [MainThread]: 
[0m06:02:26.686022 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:26.686590 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:26.687183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:26.687608 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:26.713873 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:26.714599 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:26.749326 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:26.750048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:34.254565 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.255070 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:34.255741 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.256173 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.256589 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:34.257321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.260166 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.260601 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:34.261270 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.277667 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:34.278153 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.278572 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:34.279633 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.285167 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.285618 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:34.286763 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.289051 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:34.290530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2289c1e50>]}
[0m06:02:34.291216 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.60s]
[0m06:02:34.291982 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:34.292821 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:34.293377 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:34.294146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:34.294586 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:34.299405 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:34.300038 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:34.335622 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.336129 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250716060234329630"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:34.336577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:34.344074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.351394 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.351876 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:34.352467 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.352923 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.353336 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250716060234329630'
      
      
      order by ordinal_position

  
[0m06:02:34.355413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.360423 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.360896 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:34.362954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.370381 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.370850 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:34.373179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.391000 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:34.391637 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.392109 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250716060234329630"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250716060234329630"
    )
  
[0m06:02:34.441268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.443258 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:34.443704 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.444142 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:34.450907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.451814 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:34.453272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1f0fe3aa0>]}
[0m06:02:34.453958 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:34.454691 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:34.455986 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:34.456394 [debug] [MainThread]: On master: BEGIN
[0m06:02:34.456786 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:34.457409 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:34.457832 [debug] [MainThread]: On master: COMMIT
[0m06:02:34.458205 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:34.458565 [debug] [MainThread]: On master: COMMIT
[0m06:02:34.459117 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:34.459505 [debug] [MainThread]: On master: Close
[0m06:02:34.460195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:34.460576 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:34.461004 [info ] [MainThread]: 
[0m06:02:34.461462 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.38 seconds (8.38s).
[0m06:02:34.462400 [debug] [MainThread]: Command end result
[0m06:02:34.489060 [info ] [MainThread]: 
[0m06:02:34.489655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:34.490133 [info ] [MainThread]: 
[0m06:02:34.490586 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:34.491528 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.372398, "process_user_time": 5.058285, "process_kernel_time": 0.255115, "process_mem_max_rss": "340888", "process_in_blocks": "1200", "process_out_blocks": "99944"}
[0m06:02:34.492111 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:34.492008 after 10.37 seconds
[0m06:02:34.492548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22ec87f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e27d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e672630>]}
[0m06:02:34.492994 [debug] [MainThread]: Flushing usage events
[0m06:02:36.275928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda84dc41d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda847b8d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda84385910>]}


============================== 06:02:36.278785 | d7f03ad2-8ec7-4939-a39d-e05b19251acb ==============================
[0m06:02:36.278785 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:36.279404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:36.383775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7f03ad2-8ec7-4939-a39d-e05b19251acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda844032f0>]}
[0m06:02:36.401004 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17326723, "process_user_time": 1.278813, "process_kernel_time": 0.123885, "process_mem_max_rss": "100716", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:36.401505 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:36.401406 after 0.17 seconds
[0m06:02:36.401930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda84ffc980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda842d5ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda844f8e00>]}
[0m06:02:36.402326 [debug] [MainThread]: Flushing usage events
[0m14:06:12.632996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6c0285f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6abfb0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6a2b20f0>]}


============================== 14:06:12.648999 | 6603dc7b-2553-4b12-bc47-5a0d288b1481 ==============================
[0m14:06:12.648999 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:12.649624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:12.768487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6603dc7b-2553-4b12-bc47-5a0d288b1481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf69ebb2f0>]}
[0m14:06:12.783486 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fs0yalhe'
[0m14:06:12.783969 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:12.859521 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:12.860265 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:12.872290 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:12.876291 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:12.928017 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:12.928534 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:06:12.929066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6603dc7b-2553-4b12-bc47-5a0d288b1481', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf69bc7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6af080e0>]}
[0m14:06:12.929503 [info ] [MainThread]: 
[0m14:06:12.929964 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:12.935546 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3514694, "process_user_time": 1.558616, "process_kernel_time": 0.132052, "process_mem_max_rss": "101680", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m14:06:12.936109 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:12.936008 after 0.35 seconds
[0m14:06:12.936531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6a2d5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf69c28140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf69c28380>]}
[0m14:06:12.936979 [debug] [MainThread]: Flushing usage events
[0m14:06:14.546089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa1b64470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa1e80f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa19ff7d0>]}


============================== 14:06:14.549226 | e11eaf46-d5d0-4fb8-b904-6ba3366f0659 ==============================
[0m14:06:14.549226 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:14.549942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:14.752298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0a774d0>]}
[0m14:06:14.811297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0b871d0>]}
[0m14:06:14.814052 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:06:14.838777 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:14.839473 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:14.840004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0d30d10>]}
[0m14:06:16.119571 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:16.120228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0b0ac00>]}
[0m14:06:16.360569 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:16.366226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa293b680>]}
[0m14:06:16.469246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9c9f1190>]}
[0m14:06:16.469881 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:06:16.470409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9c9ddb50>]}
[0m14:06:16.472336 [info ] [MainThread]: 
[0m14:06:16.473068 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:16.477823 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:16.513560 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:16.514129 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:16.514558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:17.025084 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:06:17.027141 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:17.028323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:17.029066 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:17.037651 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.038109 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:17.038502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:17.039633 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.041032 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.041424 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:17.042029 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.042416 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.042811 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:17.043416 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.044370 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:17.044776 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.045142 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:17.045687 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.046130 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:17.047505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:17.053575 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:17.054103 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:17.054467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:17.055199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.055585 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:17.056009 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:17.066307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.068171 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:17.069567 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:17.070020 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:17.072428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9b3503e0>]}
[0m14:06:17.073030 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:17.073422 [debug] [MainThread]: On master: BEGIN
[0m14:06:17.073819 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:17.074600 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:17.075032 [debug] [MainThread]: On master: COMMIT
[0m14:06:17.075421 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:17.075803 [debug] [MainThread]: On master: COMMIT
[0m14:06:17.076369 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:17.076812 [debug] [MainThread]: On master: Close
[0m14:06:17.077409 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:17.077925 [info ] [MainThread]: 
[0m14:06:17.089903 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:17.090591 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:17.091254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:17.091697 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:17.119376 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:17.120338 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:17.156656 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:17.157611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:23.705359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.705901 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:23.706531 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.706995 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.707408 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:23.708116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.711197 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.711634 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:23.712322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.728979 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:23.729449 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.729889 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:23.731851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.737668 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.738144 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:23.740068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.742456 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:23.744010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5eba48f0>]}
[0m14:06:23.744679 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.65s]
[0m14:06:23.745508 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:23.746346 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:23.746979 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:23.747662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:23.748236 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:23.753206 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:23.753872 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:23.790247 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.790846 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250716140623784138"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:23.791321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:23.799614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.807744 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.808205 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:23.808882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.809314 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.809746 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250716140623784138'
      
      
      order by ordinal_position

  
[0m14:06:23.812285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.817467 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.817945 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:23.820897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.828580 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.829059 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:23.831808 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.849906 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:23.850594 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.851065 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250716140623784138"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250716140623784138"
    )
  
[0m14:06:23.897929 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.899989 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:23.900442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.900875 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:23.908342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.909246 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:23.910719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f900d6060>]}
[0m14:06:23.911410 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:06:23.912146 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:23.913493 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:23.913929 [debug] [MainThread]: On master: BEGIN
[0m14:06:23.914291 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:23.914929 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:23.915319 [debug] [MainThread]: On master: COMMIT
[0m14:06:23.915679 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:23.916070 [debug] [MainThread]: On master: COMMIT
[0m14:06:23.916581 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:23.916997 [debug] [MainThread]: On master: Close
[0m14:06:23.917589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:23.917997 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:23.918393 [info ] [MainThread]: 
[0m14:06:23.918885 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.45 seconds (7.45s).
[0m14:06:23.919836 [debug] [MainThread]: Command end result
[0m14:06:23.945858 [info ] [MainThread]: 
[0m14:06:23.946448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:23.946933 [info ] [MainThread]: 
[0m14:06:23.947416 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:23.948407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.451223, "process_user_time": 5.203976, "process_kernel_time": 0.292617, "process_mem_max_rss": "334352", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m14:06:23.948969 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:23.948863 after 9.45 seconds
[0m14:06:23.949395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa38ed1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0e135f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5e9d3560>]}
[0m14:06:23.949827 [debug] [MainThread]: Flushing usage events
[0m14:06:25.833688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff52914d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5297c4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5297c40e0>]}


============================== 14:06:25.836958 | 321da84a-e5c0-4a21-8797-f34a97dc65a2 ==============================
[0m14:06:25.836958 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:25.837591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:25.945080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '321da84a-e5c0-4a21-8797-f34a97dc65a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff528d02cf0>]}
[0m14:06:25.963382 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17884552, "process_user_time": 1.34691, "process_kernel_time": 0.11091, "process_mem_max_rss": "100768", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:06:25.963952 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:25.963846 after 0.18 seconds
[0m14:06:25.964372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5297c4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff529b64230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff528c16a20>]}
[0m14:06:25.964807 [debug] [MainThread]: Flushing usage events
[0m22:06:26.799923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02d195580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02dec3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02dbe7e60>]}


============================== 22:06:26.815508 | 151c28ef-8ade-4cd5-a1fe-d2d0b0fb68f4 ==============================
[0m22:06:26.815508 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:26.816194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:26.940088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '151c28ef-8ade-4cd5-a1fe-d2d0b0fb68f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02cf4b2f0>]}
[0m22:06:26.954701 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2n04ynic'
[0m22:06:26.955158 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:27.051671 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:27.052336 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:27.062519 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:27.066363 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:27.272176 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:27.272777 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:27.273360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '151c28ef-8ade-4cd5-a1fe-d2d0b0fb68f4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02cb100b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02dd10260>]}
[0m22:06:27.273847 [info ] [MainThread]: 
[0m22:06:27.274355 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:27.281412 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5302712, "process_user_time": 1.574517, "process_kernel_time": 0.132295, "process_mem_max_rss": "101436", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m22:06:27.281984 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:27.281881 after 0.53 seconds
[0m22:06:27.282402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02dec3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02d1b4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02cab9f40>]}
[0m22:06:27.282829 [debug] [MainThread]: Flushing usage events
[0m22:06:29.048671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a852a54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a858d86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a86d39580>]}


============================== 22:06:29.051667 | be82b3f8-3659-458c-9cdb-17cdf8fef51a ==============================
[0m22:06:29.051667 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:29.052370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:29.253262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a86973380>]}
[0m22:06:29.311481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a85dd0e60>]}
[0m22:06:29.314048 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:29.339324 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:29.340047 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:29.340560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a80b01df0>]}
[0m22:06:30.625685 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:30.626357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a80a7dac0>]}
[0m22:06:30.858309 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:30.863782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a84dc0b30>]}
[0m22:06:30.963484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8066a810>]}
[0m22:06:30.964123 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:30.964630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a80681520>]}
[0m22:06:30.966561 [info ] [MainThread]: 
[0m22:06:30.967297 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:30.972180 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:31.009706 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:31.010191 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:31.010585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:31.478929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.481216 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:31.482551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:31.483279 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:31.491985 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.492412 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:31.492813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:31.493733 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.495048 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.495439 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:31.496043 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.496427 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.496832 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:31.497427 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.498364 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:31.498779 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.499150 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:31.499762 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.500164 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:31.501424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:31.507151 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:31.507553 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:31.507937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:31.508656 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.509086 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:31.509462 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:31.518986 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.520418 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:31.521655 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:31.522073 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:31.524285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a869d5100>]}
[0m22:06:31.524812 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.525200 [debug] [MainThread]: On master: BEGIN
[0m22:06:31.525560 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:31.526178 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.526571 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.526986 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.527349 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.527874 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.528267 [debug] [MainThread]: On master: Close
[0m22:06:31.528807 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:31.529267 [info ] [MainThread]: 
[0m22:06:31.546808 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:31.547392 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:31.547983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:31.548425 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:31.574966 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:31.575705 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:31.610832 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:31.611601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:42.044049 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.044535 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:42.045212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.045645 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.046094 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:42.046842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.049732 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.050186 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:42.050889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.067404 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:42.067902 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.068324 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:42.069437 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.075042 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.075497 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:42.076675 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.079011 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:42.080529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7f26eb40>]}
[0m22:06:42.081235 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.53s]
[0m22:06:42.081998 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:42.082907 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:42.083561 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:42.084178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:42.084609 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:42.089490 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:42.090149 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:42.126115 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.126600 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250716220642120108"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:42.127071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:42.134800 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.142144 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.142594 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:42.143204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.143636 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.144087 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250716220642120108'
      
      
      order by ordinal_position

  
[0m22:06:42.146222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.151274 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.151757 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:42.153839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.161398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.161877 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:42.164237 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.182100 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:42.182775 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.183231 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250716220642120108"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250716220642120108"
    )
  
[0m22:06:42.230104 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.232103 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:42.232548 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.232984 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:42.239972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.240865 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:42.242388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a46367800>]}
[0m22:06:42.243076 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:06:42.243887 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:42.245220 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.245623 [debug] [MainThread]: On master: BEGIN
[0m22:06:42.246033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:42.246647 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.247072 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.247436 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.247832 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.248348 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.248756 [debug] [MainThread]: On master: Close
[0m22:06:42.249360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:42.249748 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:42.250158 [info ] [MainThread]: 
[0m22:06:42.250669 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.28 seconds (11.28s).
[0m22:06:42.251678 [debug] [MainThread]: Command end result
[0m22:06:42.277176 [info ] [MainThread]: 
[0m22:06:42.277785 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:42.278294 [info ] [MainThread]: 
[0m22:06:42.278828 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:42.279820 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.279617, "process_user_time": 5.06972, "process_kernel_time": 0.280371, "process_mem_max_rss": "345932", "process_in_blocks": "1200", "process_out_blocks": "100136"}
[0m22:06:42.280359 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:42.280257 after 13.28 seconds
[0m22:06:42.280810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a84d24b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a85da7a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a47492ab0>]}
[0m22:06:42.281240 [debug] [MainThread]: Flushing usage events
[0m22:06:44.312400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6c9755e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6ee57140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6eb3ff50>]}


============================== 22:06:44.315577 | a9494496-d521-4b29-ab8a-f33b906cb8bb ==============================
[0m22:06:44.315577 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:44.316283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:44.423630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9494496-d521-4b29-ab8a-f33b906cb8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6c657380>]}
[0m22:06:44.441652 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1781356, "process_user_time": 1.328535, "process_kernel_time": 0.109961, "process_mem_max_rss": "100620", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:44.442217 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:44.442111 after 0.18 seconds
[0m22:06:44.442640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6c8d1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6eb3ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6c38fe60>]}
[0m22:06:44.443087 [debug] [MainThread]: Flushing usage events
[0m06:02:24.765499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4167ee7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41670f3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41670a8920>]}


============================== 06:02:24.779884 | 8749df10-7965-4093-96de-f8ea67da9811 ==============================
[0m06:02:24.779884 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.780513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.890836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8749df10-7965-4093-96de-f8ea67da9811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41680009b0>]}
[0m06:02:24.905609 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ogvzcj7o'
[0m06:02:24.906075 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:25.068823 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:25.069585 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:25.111270 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:25.115282 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:25.324178 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:25.324763 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:25.325276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8749df10-7965-4093-96de-f8ea67da9811', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4166efe4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4166efd4f0>]}
[0m06:02:25.325752 [info ] [MainThread]: 
[0m06:02:25.326232 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:25.331134 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6152713, "process_user_time": 1.576581, "process_kernel_time": 0.125364, "process_mem_max_rss": "101292", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m06:02:25.331669 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:25.331568 after 0.62 seconds
[0m06:02:25.332117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41679a8f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4166e04380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4166e04350>]}
[0m06:02:25.332524 [debug] [MainThread]: Flushing usage events
[0m06:02:27.050657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4593a9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4593a9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4593a9b50>]}


============================== 06:02:27.053780 | b319958f-50c8-4358-97be-50c6f7f36638 ==============================
[0m06:02:27.053780 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:27.054456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.259267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4598a9220>]}
[0m06:02:27.318377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45927d250>]}
[0m06:02:27.320968 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:27.343863 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:27.344570 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:27.345112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4553a9df0>]}
[0m06:02:28.637748 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:28.638385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4552a14c0>]}
[0m06:02:28.867722 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:28.873115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4594f27e0>]}
[0m06:02:28.967594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4550d6570>]}
[0m06:02:28.968170 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:28.968666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4550b7d70>]}
[0m06:02:28.970515 [info ] [MainThread]: 
[0m06:02:28.971227 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:28.976032 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:29.010773 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:29.011206 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:29.011595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:29.476250 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.477908 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:29.479031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:29.479677 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:29.487564 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.488031 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:29.488410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.489514 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.490868 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.491260 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:29.491856 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.492254 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.492619 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:29.493220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.494145 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.494536 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.494924 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.495453 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.495871 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:29.497115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:29.502913 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.503401 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:29.503790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.504380 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.504785 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.505158 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:29.515346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.516817 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:29.518052 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:29.518442 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:29.520824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff455187dd0>]}
[0m06:02:29.521321 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.521752 [debug] [MainThread]: On master: BEGIN
[0m06:02:29.522125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:29.522759 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.523163 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.523544 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.523972 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.524498 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.524912 [debug] [MainThread]: On master: Close
[0m06:02:29.525427 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:29.525903 [info ] [MainThread]: 
[0m06:02:29.543799 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:29.544418 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:29.545022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:29.545461 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:29.572837 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:29.573575 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:29.609088 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:29.609840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:38.774023 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.774515 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:38.775162 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.775596 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.776038 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:38.776732 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.779648 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.780108 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:38.780773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.797465 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.797944 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.798362 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.800028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.805753 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.806206 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:38.807558 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.809911 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:38.811432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff453c24680>]}
[0m06:02:38.812123 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.27s]
[0m06:02:38.812951 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:38.813785 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:38.814355 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:38.814997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:38.815461 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:38.820553 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:38.821219 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:38.857666 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.858197 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250717060238851555"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:38.858653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:38.866702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.874630 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.875118 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:38.875773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.876207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.876622 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250717060238851555'
      
      
      order by ordinal_position

  
[0m06:02:38.878769 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.883956 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.884427 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:38.886908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.894612 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.895092 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:38.898048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.916282 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:38.916989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.917456 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250717060238851555"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250717060238851555"
    )
  
[0m06:02:38.967289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.969322 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:38.969814 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.970236 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:38.977017 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.977951 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:38.979473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff421d905c0>]}
[0m06:02:38.980184 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:38.981022 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:38.982365 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:38.982810 [debug] [MainThread]: On master: BEGIN
[0m06:02:38.983190 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:38.983867 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:38.984271 [debug] [MainThread]: On master: COMMIT
[0m06:02:38.984655 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:38.985065 [debug] [MainThread]: On master: COMMIT
[0m06:02:38.985614 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:38.986039 [debug] [MainThread]: On master: Close
[0m06:02:38.986635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:38.987039 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:38.987441 [info ] [MainThread]: 
[0m06:02:38.987981 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.02 seconds (10.02s).
[0m06:02:38.988994 [debug] [MainThread]: Command end result
[0m06:02:39.015121 [info ] [MainThread]: 
[0m06:02:39.015740 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:39.016255 [info ] [MainThread]: 
[0m06:02:39.016790 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:39.017806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.016199, "process_user_time": 5.101509, "process_kernel_time": 0.282415, "process_mem_max_rss": "339416", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:39.018345 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:39.018241 after 12.02 seconds
[0m06:02:39.018801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4593a9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff459866720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff417039fa0>]}
[0m06:02:39.019232 [debug] [MainThread]: Flushing usage events
[0m06:02:40.969133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd971f81a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd973082ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd973083a10>]}


============================== 06:02:40.972221 | 2bef1067-5902-4bc1-b9d9-144ac25d8a11 ==============================
[0m06:02:40.972221 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:40.972915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:41.081320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bef1067-5902-4bc1-b9d9-144ac25d8a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd972989dc0>]}
[0m06:02:41.099653 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17934872, "process_user_time": 1.349669, "process_kernel_time": 0.100975, "process_mem_max_rss": "100732", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:41.100212 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:41.100109 after 0.18 seconds
[0m06:02:41.100650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9764d38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd972989dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd971f03110>]}
[0m06:02:41.101107 [debug] [MainThread]: Flushing usage events
[0m14:05:08.056641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d3294350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d299efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d2c83350>]}


============================== 14:05:08.152161 | 931d3a87-7fd0-4172-8030-1e6df84bde61 ==============================
[0m14:05:08.152161 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:08.152857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:08.286345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '931d3a87-7fd0-4172-8030-1e6df84bde61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d39f8860>]}
[0m14:05:08.301554 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-i6zyxnzx'
[0m14:05:08.302027 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:08.375923 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:08.376745 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:08.388795 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:08.393052 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:08.441061 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:08.441616 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:08.442150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '931d3a87-7fd0-4172-8030-1e6df84bde61', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d252c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d39df710>]}
[0m14:05:08.442612 [info ] [MainThread]: 
[0m14:05:08.443093 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:08.472945 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46701247, "process_user_time": 1.625777, "process_kernel_time": 0.136812, "process_mem_max_rss": "101276", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m14:05:08.473690 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:08.473535 after 0.47 seconds
[0m14:05:08.474220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d30f34a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d27b6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d2ba6c00>]}
[0m14:05:08.474692 [debug] [MainThread]: Flushing usage events
[0m14:05:10.089785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4afc4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4aa69430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4afc46e0>]}


============================== 14:05:10.093189 | 0fda693f-2d26-4f04-91fc-3097f2c42bba ==============================
[0m14:05:10.093189 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:10.093857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:10.301729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4a9c4560>]}
[0m14:05:10.361375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4a545460>]}
[0m14:05:10.364271 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:05:10.460385 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:10.461276 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:10.461871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4a3d29f0>]}
[0m14:05:11.759115 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:11.759865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f463c69f0>]}
[0m14:05:12.002347 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:12.008092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4a5f19a0>]}
[0m14:05:12.106293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f461d5df0>]}
[0m14:05:12.106861 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:05:12.107367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f46153bf0>]}
[0m14:05:12.109294 [info ] [MainThread]: 
[0m14:05:12.110033 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:12.114837 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:12.150119 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:12.150549 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:12.150959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:12.625380 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.627550 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:12.628616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:12.629177 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:12.637068 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.637492 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:12.637900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:12.638741 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.640063 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.640451 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:12.641072 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.641452 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.641868 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:12.642485 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.643490 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:12.643913 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.644281 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:12.644833 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.645229 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:12.646552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:12.652259 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:12.652771 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:12.653133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:12.653761 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.654147 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:12.654526 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:12.665146 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.666575 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:12.667848 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:12.668238 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:12.670506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f46114ec0>]}
[0m14:05:12.671089 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:12.671468 [debug] [MainThread]: On master: BEGIN
[0m14:05:12.671854 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:12.672449 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:12.672872 [debug] [MainThread]: On master: COMMIT
[0m14:05:12.673244 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:12.673620 [debug] [MainThread]: On master: COMMIT
[0m14:05:12.674141 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:12.674524 [debug] [MainThread]: On master: Close
[0m14:05:12.675072 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:12.675544 [info ] [MainThread]: 
[0m14:05:12.692107 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:12.692704 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:12.693340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:12.693828 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:12.720771 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:12.721534 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:12.757128 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:12.757885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:19.627850 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:19.628346 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:19.629019 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.629458 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:19.629911 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:19.630619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.633476 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:19.633945 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:19.634615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.651346 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:19.651827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:19.652249 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:19.654246 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.659884 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:19.660339 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:05:19.661490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.663875 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:19.665408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4c27a000>]}
[0m14:05:19.666138 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.97s]
[0m14:05:19.666915 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:19.667892 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:19.668439 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:19.669076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:19.669524 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:19.674460 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:19.675118 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:19.711315 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.711821 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250717140519705231"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:19.712275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:19.720146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.727556 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.728048 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:19.728651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.729094 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.729520 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250717140519705231'
      
      
      order by ordinal_position

  
[0m14:05:19.731776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.736895 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.737354 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:19.739994 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.747645 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.748117 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:19.750244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.768492 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:19.769201 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.769677 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250717140519705231"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250717140519705231"
    )
  
[0m14:05:19.818838 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.821013 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:19.821468 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.821908 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:19.829262 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.830206 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:19.831775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f0c1ca900>]}
[0m14:05:19.832456 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:05:19.833209 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:19.834955 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:19.835359 [debug] [MainThread]: On master: BEGIN
[0m14:05:19.835766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:19.836403 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:19.836836 [debug] [MainThread]: On master: COMMIT
[0m14:05:19.837205 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:19.837562 [debug] [MainThread]: On master: COMMIT
[0m14:05:19.838155 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:19.838543 [debug] [MainThread]: On master: Close
[0m14:05:19.839156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:19.839528 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:19.839975 [info ] [MainThread]: 
[0m14:05:19.840451 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.73 seconds (7.73s).
[0m14:05:19.841409 [debug] [MainThread]: Command end result
[0m14:05:19.867626 [info ] [MainThread]: 
[0m14:05:19.868198 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:19.868690 [info ] [MainThread]: 
[0m14:05:19.869178 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:19.870174 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.830445, "process_user_time": 5.183729, "process_kernel_time": 0.30416, "process_mem_max_rss": "340812", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m14:05:19.870749 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:19.870643 after 9.83 seconds
[0m14:05:19.871187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4aa69430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4617cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f461434a0>]}
[0m14:05:19.871628 [debug] [MainThread]: Flushing usage events
[0m14:05:21.805470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08a0fba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0892f3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff089cefce0>]}


============================== 14:05:21.808648 | 531f34c9-259d-405e-b4c0-446614e77e36 ==============================
[0m14:05:21.808648 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:21.809284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:21.917800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '531f34c9-259d-405e-b4c0-446614e77e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0896d8380>]}
[0m14:05:21.935522 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17981568, "process_user_time": 1.351823, "process_kernel_time": 0.119984, "process_mem_max_rss": "100656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:21.936076 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:21.935968 after 0.18 seconds
[0m14:05:21.936487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0896d8380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0892ace30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0892adac0>]}
[0m14:05:21.936918 [debug] [MainThread]: Flushing usage events
[0m22:06:37.688362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0f1b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0b3fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e1cad340>]}


============================== 22:06:37.703009 | 55ccfe61-aebd-4131-9ccf-d42c867bad5b ==============================
[0m22:06:37.703009 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:37.703722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:37.833597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55ccfe61-aebd-4131-9ccf-d42c867bad5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0f18830>]}
[0m22:06:37.848621 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8czs9t6f'
[0m22:06:37.849082 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:37.987684 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:37.988416 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:38.011784 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:38.015656 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:38.097151 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:38.097702 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:38.098255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '55ccfe61-aebd-4131-9ccf-d42c867bad5b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0ce3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e11d8860>]}
[0m22:06:38.098729 [info ] [MainThread]: 
[0m22:06:38.099223 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:38.106792 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46789932, "process_user_time": 1.540341, "process_kernel_time": 0.141755, "process_mem_max_rss": "101444", "process_in_blocks": "8744", "process_out_blocks": "5168"}
[0m22:06:38.107331 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:38.107230 after 0.47 seconds
[0m22:06:38.107775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0ca5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e17fb770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e1bffbf0>]}
[0m22:06:38.108198 [debug] [MainThread]: Flushing usage events
[0m22:06:39.695347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729d511b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729db4ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729db4a360>]}


============================== 22:06:39.698625 | 93c2906c-261c-4428-9733-b1a42c9b6a69 ==============================
[0m22:06:39.698625 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:39.699319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:39.901254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729d1e74d0>]}
[0m22:06:39.959928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729f1fa240>]}
[0m22:06:39.962439 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:39.984500 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:39.985240 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:39.985761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729e2663f0>]}
[0m22:06:41.269687 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:41.270324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72993e1fa0>]}
[0m22:06:41.492580 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:41.497961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729e3e7d70>]}
[0m22:06:41.592582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72991211f0>]}
[0m22:06:41.593088 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:41.593632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7299117890>]}
[0m22:06:41.595391 [info ] [MainThread]: 
[0m22:06:41.596091 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:41.600732 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:41.634948 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:41.635371 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:41.635783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:42.153368 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:42.155333 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:42.156412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:42.157091 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:42.164747 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.165165 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:42.165561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.166424 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.167738 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.168126 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:42.168670 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.169054 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.169414 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:42.170044 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.170974 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.171364 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.171747 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.172257 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.172670 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:42.173907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:42.179626 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.180033 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:42.180393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.181012 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.181392 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.181801 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:42.191478 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.192926 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:42.194143 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:42.194562 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:42.196745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72992e4290>]}
[0m22:06:42.197239 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.197658 [debug] [MainThread]: On master: BEGIN
[0m22:06:42.198015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:42.198630 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.199021 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.199378 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.199766 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.200310 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.200717 [debug] [MainThread]: On master: Close
[0m22:06:42.201239 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:42.201719 [info ] [MainThread]: 
[0m22:06:42.218993 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:42.219592 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:42.220159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:42.220616 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:42.247371 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:42.248234 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:42.283711 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:42.284483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:49.289847 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:49.290332 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:49.290986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.291417 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:49.291860 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:49.292744 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.295705 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:49.296142 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:49.296820 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.313443 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:49.313930 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:49.314346 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:49.316207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.321973 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:49.322421 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:49.323703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.326032 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:49.327601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729f2767e0>]}
[0m22:06:49.328276 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.11s]
[0m22:06:49.329103 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:49.330047 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:49.330608 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:49.331227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:49.331700 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:49.336537 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:49.337176 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:49.373122 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.373621 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250717220649367133"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:49.374072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:49.381884 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.389303 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.389797 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:49.390395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.390849 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.391263 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250717220649367133'
      
      
      order by ordinal_position

  
[0m22:06:49.393400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.398532 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.398994 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:49.401235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.408813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.409265 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:49.411578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.429598 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:49.430260 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.430729 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250717220649367133"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250717220649367133"
    )
  
[0m22:06:49.479849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.481824 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:49.482258 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.482693 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:49.489277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.490150 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:49.491612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f725b130aa0>]}
[0m22:06:49.492273 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:06:49.493078 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:49.494388 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.494824 [debug] [MainThread]: On master: BEGIN
[0m22:06:49.495191 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:49.495809 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.496200 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.496589 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.496950 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.497495 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.497913 [debug] [MainThread]: On master: Close
[0m22:06:49.498490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:49.498887 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:49.499276 [info ] [MainThread]: 
[0m22:06:49.499785 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.90 seconds (7.90s).
[0m22:06:49.500741 [debug] [MainThread]: Command end result
[0m22:06:49.526243 [info ] [MainThread]: 
[0m22:06:49.526832 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:49.527315 [info ] [MainThread]: 
[0m22:06:49.527820 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:49.528793 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.883148, "process_user_time": 5.089763, "process_kernel_time": 0.286267, "process_mem_max_rss": "341320", "process_in_blocks": "1200", "process_out_blocks": "100144"}
[0m22:06:49.529333 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:49.529231 after 9.88 seconds
[0m22:06:49.529781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729db4a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7299117530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729d9128d0>]}
[0m22:06:49.530196 [debug] [MainThread]: Flushing usage events
[0m22:06:51.318826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b72613a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b77e73e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b77e5730>]}


============================== 22:06:51.321854 | 540f7f8c-94da-4d3d-b31e-021cf5ff666a ==============================
[0m22:06:51.321854 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:51.322471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:51.430858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '540f7f8c-94da-4d3d-b31e-021cf5ff666a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b7e64d40>]}
[0m22:06:51.448163 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17809294, "process_user_time": 1.309544, "process_kernel_time": 0.117048, "process_mem_max_rss": "100496", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:51.448739 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:51.448632 after 0.18 seconds
[0m22:06:51.449157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b73c7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b70975f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b7d27260>]}
[0m22:06:51.449582 [debug] [MainThread]: Flushing usage events
[0m06:02:23.258268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4ac61f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4a43fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4aae32f0>]}


============================== 06:02:23.274827 | 5812e736-3002-42a7-ad8e-5ade1c05b5c2 ==============================
[0m06:02:23.274827 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:23.275533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:23.413662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5812e736-3002-42a7-ad8e-5ade1c05b5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a49e732f0>]}
[0m06:02:23.429894 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x64oqzrk'
[0m06:02:23.430441 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:23.549303 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:23.550095 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:23.573791 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:23.577904 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:23.652174 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:23.652888 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:23.653522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5812e736-3002-42a7-ad8e-5ade1c05b5c2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a49e633b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a49e2ff50>]}
[0m06:02:23.654013 [info ] [MainThread]: 
[0m06:02:23.654529 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:23.664949 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45777413, "process_user_time": 1.654493, "process_kernel_time": 0.148595, "process_mem_max_rss": "101764", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m06:02:23.665622 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:23.665503 after 0.46 seconds
[0m06:02:23.666119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4a4dffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4a087620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4a414c80>]}
[0m06:02:23.666595 [debug] [MainThread]: Flushing usage events
[0m06:02:25.473645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc51ee9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc50107a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc50370170>]}


============================== 06:02:25.477240 | 1418e1cb-b4dd-4f68-a55c-e92e497b1091 ==============================
[0m06:02:25.477240 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.477925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:25.686803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc513553a0>]}
[0m06:02:25.747235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc508abd40>]}
[0m06:02:25.750066 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:25.778712 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:25.779524 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:25.780077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4fd713a0>]}
[0m06:02:27.080827 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:27.081542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4b8a24b0>]}
[0m06:02:27.338467 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:27.344390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc50158650>]}
[0m06:02:27.448386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4bbfde20>]}
[0m06:02:27.449030 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:27.449607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4b840920>]}
[0m06:02:27.451698 [info ] [MainThread]: 
[0m06:02:27.452480 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:27.457556 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:27.493639 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:27.494214 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:27.494656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:28.001694 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:28.003865 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:28.005176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:28.005841 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:28.015305 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:28.015768 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:28.016185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:28.017605 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.019337 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:28.019731 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:28.020323 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.020744 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:28.021364 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:28.022199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.023326 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:28.023776 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:28.024244 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:28.024892 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.025431 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:28.027013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:28.033238 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:28.033688 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:28.034070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:28.034828 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.035234 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:28.035604 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:28.045631 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.047428 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:28.048763 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:28.049186 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:28.051545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4a438560>]}
[0m06:02:28.052119 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:28.052512 [debug] [MainThread]: On master: BEGIN
[0m06:02:28.052879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:28.053698 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:28.054135 [debug] [MainThread]: On master: COMMIT
[0m06:02:28.054521 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:28.054898 [debug] [MainThread]: On master: COMMIT
[0m06:02:28.055532 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:28.055933 [debug] [MainThread]: On master: Close
[0m06:02:28.056562 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:28.057037 [info ] [MainThread]: 
[0m06:02:28.077108 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:28.077810 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:28.078469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:28.078924 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:28.106847 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:28.107791 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:28.144270 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:28.145219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:35.336813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.337378 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:35.338163 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.338608 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.339023 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:35.339805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.342982 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.343450 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:35.344205 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.361315 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:35.361874 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.362340 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:35.364416 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.370509 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.370976 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:35.372709 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.375231 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:35.376832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc51b2a4e0>]}
[0m06:02:35.377562 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.30s]
[0m06:02:35.378355 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:35.379204 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:35.379778 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:35.380435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:35.380884 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:35.386144 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:35.387144 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:35.424791 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.425400 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250718060235418436"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:35.425873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:35.434293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.442643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.443169 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:35.443893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.444359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.444787 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250718060235418436'
      
      
      order by ordinal_position

  
[0m06:02:35.447204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.452819 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.453319 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:35.456029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.464252 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.464761 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:35.467899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.486723 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:35.487538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.488018 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250718060235418436"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250718060235418436"
    )
  
[0m06:02:35.538040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.540122 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:35.540591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.541004 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:35.548586 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.549602 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:35.551196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc12af94c0>]}
[0m06:02:35.551907 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:02:35.552702 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:35.554308 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:35.554736 [debug] [MainThread]: On master: BEGIN
[0m06:02:35.555156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:35.555926 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:35.556363 [debug] [MainThread]: On master: COMMIT
[0m06:02:35.556741 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:35.557128 [debug] [MainThread]: On master: COMMIT
[0m06:02:35.557707 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:35.558150 [debug] [MainThread]: On master: Close
[0m06:02:35.558801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:35.559197 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:35.559610 [info ] [MainThread]: 
[0m06:02:35.560120 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.11 seconds (8.11s).
[0m06:02:35.561074 [debug] [MainThread]: Command end result
[0m06:02:35.588312 [info ] [MainThread]: 
[0m06:02:35.588992 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:35.589538 [info ] [MainThread]: 
[0m06:02:35.590083 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:35.591132 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.168383, "process_user_time": 5.337455, "process_kernel_time": 0.317562, "process_mem_max_rss": "338188", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:35.591698 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:35.591577 after 10.17 seconds
[0m06:02:35.592177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4fe9d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4b8676b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc11993ce0>]}
[0m06:02:35.592616 [debug] [MainThread]: Flushing usage events
[0m06:02:37.649781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68d9c4260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68d9c6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68edf4440>]}


============================== 06:02:37.653122 | 4654d2b0-cf32-4b81-86c6-438f2dd7779c ==============================
[0m06:02:37.653122 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:37.653831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:37.764971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4654d2b0-cf32-4b81-86c6-438f2dd7779c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68de08320>]}
[0m06:02:37.784047 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1852455, "process_user_time": 1.416641, "process_kernel_time": 0.127967, "process_mem_max_rss": "100500", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:37.784650 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:37.784539 after 0.19 seconds
[0m06:02:37.785152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68d82cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb691102c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68de08320>]}
[0m06:02:37.785601 [debug] [MainThread]: Flushing usage events
[0m14:06:12.771340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02926154f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029307aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0292d08740>]}


============================== 14:06:12.846677 | 5cd226cc-24ff-4d9d-ae25-edea5105c4b0 ==============================
[0m14:06:12.846677 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:12.847347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:13.096479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cd226cc-24ff-4d9d-ae25-edea5105c4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02928f9220>]}
[0m14:06:13.111807 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lujts28c'
[0m14:06:13.112295 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:13.239607 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:13.240463 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:13.258944 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:13.262935 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:13.401211 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:13.401824 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:06:13.402387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5cd226cc-24ff-4d9d-ae25-edea5105c4b0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029239ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02928abd70>]}
[0m14:06:13.402865 [info ] [MainThread]: 
[0m14:06:13.403366 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:13.431575 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.70944023, "process_user_time": 1.581547, "process_kernel_time": 0.124515, "process_mem_max_rss": "101468", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m14:06:13.432173 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:13.432065 after 0.71 seconds
[0m14:06:13.432613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02926154f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02924e87a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02928f9700>]}
[0m14:06:13.433072 [debug] [MainThread]: Flushing usage events
[0m14:06:15.081625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae9db06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae9bc5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aea787a10>]}


============================== 14:06:15.084742 | 26ddecb7-7de1-4f83-82e1-bb180e7fd0d5 ==============================
[0m14:06:15.084742 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:15.085381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:15.287403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae94b17c0>]}
[0m14:06:15.345488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aeb6dd3a0>]}
[0m14:06:15.348088 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:06:15.439262 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:15.439980 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:15.440507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae97913a0>]}
[0m14:06:16.736637 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:16.737333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae53ed340>]}
[0m14:06:16.970097 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:16.975527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae95e7aa0>]}
[0m14:06:17.079193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae534be00>]}
[0m14:06:17.079726 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:06:17.080237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae9973140>]}
[0m14:06:17.082108 [info ] [MainThread]: 
[0m14:06:17.082820 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:17.087621 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:17.122493 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:17.122950 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:17.123343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:17.610583 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.612454 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:17.613724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:17.614407 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:17.622947 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.623374 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:17.623750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:17.624724 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.626089 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.626478 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:17.627038 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.627421 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.627788 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:17.628404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.629340 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:17.629733 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.630119 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:17.630649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.631065 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:17.632334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:17.638136 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:17.638629 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:17.639018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:17.639629 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.640044 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:17.640418 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:17.650387 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.651810 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:17.653054 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:17.653444 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:17.655676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae531bd10>]}
[0m14:06:17.656207 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:17.656584 [debug] [MainThread]: On master: BEGIN
[0m14:06:17.656970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:17.657583 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:17.657999 [debug] [MainThread]: On master: COMMIT
[0m14:06:17.658372 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:17.658727 [debug] [MainThread]: On master: COMMIT
[0m14:06:17.659258 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:17.659643 [debug] [MainThread]: On master: Close
[0m14:06:17.660196 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:17.660654 [info ] [MainThread]: 
[0m14:06:17.695031 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:17.695611 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:17.696191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:17.696625 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:17.723489 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:17.724286 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:17.760333 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:17.761219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:25.726531 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:25.727055 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:25.727688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.728159 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:25.728584 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:25.729280 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.732215 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:25.732657 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:25.733554 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.750283 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:25.750739 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:25.751178 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:25.753170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.758923 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:25.759378 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:25.760665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.763044 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:25.764578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa74775c0>]}
[0m14:06:25.765274 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.07s]
[0m14:06:25.766036 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:25.766964 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:25.767611 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:25.768202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:25.768639 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:25.773506 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:25.774163 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:25.810345 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.810844 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250718140625804320"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:25.811322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:25.819288 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.826989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.827447 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:25.828108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.828549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.829008 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250718140625804320'
      
      
      order by ordinal_position

  
[0m14:06:25.831185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.836473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.836968 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:25.839378 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.847846 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.848394 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:25.851400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.870528 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:25.871377 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.871858 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250718140625804320"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250718140625804320"
    )
  
[0m14:06:25.920112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.922213 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:25.922713 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.923167 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:25.931263 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.932198 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:25.933685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aac517740>]}
[0m14:06:25.934385 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:06:25.935153 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:25.936457 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:25.936863 [debug] [MainThread]: On master: BEGIN
[0m14:06:25.937273 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:25.937952 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:25.938365 [debug] [MainThread]: On master: COMMIT
[0m14:06:25.938735 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:25.939134 [debug] [MainThread]: On master: COMMIT
[0m14:06:25.939662 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:25.940096 [debug] [MainThread]: On master: Close
[0m14:06:25.940732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:25.941136 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:25.941536 [info ] [MainThread]: 
[0m14:06:25.942011 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.86 seconds (8.86s).
[0m14:06:25.942937 [debug] [MainThread]: Command end result
[0m14:06:25.968844 [info ] [MainThread]: 
[0m14:06:25.969412 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:25.969870 [info ] [MainThread]: 
[0m14:06:25.970353 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:25.971302 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.938773, "process_user_time": 5.171893, "process_kernel_time": 0.28283, "process_mem_max_rss": "340012", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m14:06:25.971848 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:25.971745 after 10.94 seconds
[0m14:06:25.972312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae9729c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa72fba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae3eb88f0>]}
[0m14:06:25.972737 [debug] [MainThread]: Flushing usage events
[0m14:06:27.844342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf55d73710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf54ce5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf54ce5940>]}


============================== 14:06:27.847427 | b1e019a4-74e5-4a2f-b5e4-1a0b1b706967 ==============================
[0m14:06:27.847427 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:27.848084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:06:27.955500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1e019a4-74e5-4a2f-b5e4-1a0b1b706967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5696f1a0>]}
[0m14:06:27.973182 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1778624, "process_user_time": 1.334248, "process_kernel_time": 0.103863, "process_mem_max_rss": "100620", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:27.973713 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:27.973607 after 0.18 seconds
[0m14:06:27.974162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf54dbf230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf54c35ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5696f1a0>]}
[0m14:06:27.974576 [debug] [MainThread]: Flushing usage events
[0m22:06:41.864383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9116934140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91159ad550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911482c950>]}


============================== 22:06:41.880597 | f9e8a115-19f7-4035-a3dd-d6a6da52a807 ==============================
[0m22:06:41.880597 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:41.881291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:42.019269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9e8a115-19f7-4035-a3dd-d6a6da52a807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9114689580>]}
[0m22:06:42.035174 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zudouaca'
[0m22:06:42.035685 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:42.149665 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:42.150413 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:42.167207 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:42.171208 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:42.231128 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:42.231736 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:42.232277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f9e8a115-19f7-4035-a3dd-d6a6da52a807', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911481faa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91159fc2c0>]}
[0m22:06:42.232726 [info ] [MainThread]: 
[0m22:06:42.233204 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:42.241361 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42785776, "process_user_time": 1.614882, "process_kernel_time": 0.158693, "process_mem_max_rss": "101784", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m22:06:42.241924 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:42.241821 after 0.43 seconds
[0m22:06:42.242379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9115214140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91145363f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91145362a0>]}
[0m22:06:42.242809 [debug] [MainThread]: Flushing usage events
[0m22:06:43.958049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac3987c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac4234da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac3987560>]}


============================== 22:06:43.961340 | c62d9da2-e299-45a1-ac5a-737d4c27451d ==============================
[0m22:06:43.961340 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:43.962037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:44.166990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac3645040>]}
[0m22:06:44.229274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac426b920>]}
[0m22:06:44.232146 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:44.255567 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:44.256378 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:44.256909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac366bdd0>]}
[0m22:06:45.639019 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:45.639670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abf7dbf20>]}
[0m22:06:45.882244 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:45.888152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac3a06c30>]}
[0m22:06:45.993651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abf5ccb60>]}
[0m22:06:45.994219 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:45.994705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abf6326f0>]}
[0m22:06:45.996640 [info ] [MainThread]: 
[0m22:06:45.997390 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:46.002299 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:46.037174 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:46.037630 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:46.038044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:46.568602 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:46.570833 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:46.572056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:46.572763 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:46.580565 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:46.581004 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:46.581389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:46.582630 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:46.584032 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:46.584420 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:46.584969 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:46.585370 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:46.585733 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:46.586318 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:46.587244 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:46.587634 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:46.588019 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:46.588548 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:46.588941 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:46.590309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:46.596490 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:46.596893 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:46.597279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:46.597929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:46.598341 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:46.598714 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:46.608389 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:46.610002 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:46.611305 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:46.611703 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:46.614031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abdf604d0>]}
[0m22:06:46.614551 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:46.614930 [debug] [MainThread]: On master: BEGIN
[0m22:06:46.615315 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:46.615952 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:46.616369 [debug] [MainThread]: On master: COMMIT
[0m22:06:46.616734 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:46.617113 [debug] [MainThread]: On master: COMMIT
[0m22:06:46.617655 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:46.618084 [debug] [MainThread]: On master: Close
[0m22:06:46.618620 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:46.619099 [info ] [MainThread]: 
[0m22:06:46.637485 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:46.638211 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:46.638862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:46.639350 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:46.668640 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:46.669463 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:46.707516 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:46.708307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:54.268773 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.269324 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:54.270050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.270489 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.270902 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:54.271635 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.274742 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.275206 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:54.276003 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.293079 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.293612 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.294057 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.295377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.301375 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.301834 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:54.303128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.305567 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:54.307147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abf7d9b50>]}
[0m22:06:54.307831 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.67s]
[0m22:06:54.308600 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:54.309534 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:54.310217 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:54.310825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:54.311302 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:54.316438 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:54.317117 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:54.354863 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.355509 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250718220654348565"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:54.355971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:54.364176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.372442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.372932 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:54.373651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.374111 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.374532 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250718220654348565'
      
      
      order by ordinal_position

  
[0m22:06:54.376934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.382487 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.382958 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.385566 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.393698 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.394195 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.396740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.415271 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:54.416135 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.416613 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250718220654348565"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250718220654348565"
    )
  
[0m22:06:54.463412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.465491 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.466003 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.466450 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.474781 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.475843 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:54.477503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8535ac00>]}
[0m22:06:54.478239 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:06:54.478990 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:54.480432 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:54.480840 [debug] [MainThread]: On master: BEGIN
[0m22:06:54.481255 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:54.482023 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:54.482424 [debug] [MainThread]: On master: COMMIT
[0m22:06:54.482789 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:54.483187 [debug] [MainThread]: On master: COMMIT
[0m22:06:54.483763 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:54.484194 [debug] [MainThread]: On master: Close
[0m22:06:54.484817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:54.485232 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:54.485636 [info ] [MainThread]: 
[0m22:06:54.486148 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.49 seconds (8.49s).
[0m22:06:54.487148 [debug] [MainThread]: Command end result
[0m22:06:54.514703 [info ] [MainThread]: 
[0m22:06:54.515392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:54.515882 [info ] [MainThread]: 
[0m22:06:54.516415 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:54.517456 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.611486, "process_user_time": 5.381557, "process_kernel_time": 0.286722, "process_mem_max_rss": "351044", "process_in_blocks": "1200", "process_out_blocks": "100144"}
[0m22:06:54.518056 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:54.517905 after 10.61 seconds
[0m22:06:54.518529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac3ca07a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac3d7ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a853ea420>]}
[0m22:06:54.518966 [debug] [MainThread]: Flushing usage events
[0m22:06:56.729686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b9ff0740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b9de86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b9f89400>]}


============================== 22:06:56.732952 | 4633864b-b66a-4740-9c6f-9f6daaa0c374 ==============================
[0m22:06:56.732952 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:56.733638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:56.849346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4633864b-b66a-4740-9c6f-9f6daaa0c374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b99e99a0>]}
[0m22:06:56.867438 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19145991, "process_user_time": 1.403833, "process_kernel_time": 0.106911, "process_mem_max_rss": "100512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:56.868003 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:56.867879 after 0.19 seconds
[0m22:06:56.868442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bac386e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bb619f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bc51df10>]}
[0m22:06:56.868857 [debug] [MainThread]: Flushing usage events
[0m06:02:12.706145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb14e0bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb133eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb0e89a60>]}


============================== 06:02:12.726430 | 8824977b-ac70-485b-8d8f-d683f5f8f728 ==============================
[0m06:02:12.726430 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.727120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.876498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8824977b-ac70-485b-8d8f-d683f5f8f728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb15fa9f0>]}
[0m06:02:12.891367 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hvyot6gu'
[0m06:02:12.891824 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:13.003811 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:13.004532 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:13.017442 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:13.021355 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:13.156749 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:13.157353 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:13.157878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8824977b-ac70-485b-8d8f-d683f5f8f728', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb0a39730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb0745400>]}
[0m06:02:13.158356 [info ] [MainThread]: 
[0m06:02:13.158826 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:13.189082 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5324954, "process_user_time": 1.540427, "process_kernel_time": 0.142316, "process_mem_max_rss": "101700", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m06:02:13.189699 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:13.189592 after 0.53 seconds
[0m06:02:13.190160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb0b57230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb089a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb0899c10>]}
[0m06:02:13.190587 [debug] [MainThread]: Flushing usage events
[0m06:02:14.887731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40653006e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4062d26990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4062d254c0>]}


============================== 06:02:14.890815 | f8f22515-10ee-4c69-b3c6-48e190e32336 ==============================
[0m06:02:14.890815 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.891518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:15.091280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406225e900>]}
[0m06:02:15.149353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e30c2c0>]}
[0m06:02:15.151983 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:15.203129 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:15.203850 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:15.204393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4062f660f0>]}
[0m06:02:16.493092 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:16.493696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e2cba40>]}
[0m06:02:16.725820 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:16.731406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40628b0d40>]}
[0m06:02:16.836617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e082a50>]}
[0m06:02:16.837201 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:16.837688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e14cc50>]}
[0m06:02:16.839534 [info ] [MainThread]: 
[0m06:02:16.840251 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:16.844992 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:16.879904 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:16.880381 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:16.880776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:17.349102 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.350896 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:17.351998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:17.352571 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:17.360586 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.361070 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:17.361475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.362426 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.363814 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.364282 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:17.364869 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.365320 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.365726 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:17.366411 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.367383 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.367830 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.368279 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.368943 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.369365 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:17.370692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:17.376310 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.376787 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:17.377170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.377748 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.378150 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.378516 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:17.388448 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.389859 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:17.391106 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:17.391496 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:17.393700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e18d850>]}
[0m06:02:17.394211 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.394589 [debug] [MainThread]: On master: BEGIN
[0m06:02:17.394959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:17.395576 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.395995 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.396357 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.396706 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.397248 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.397628 [debug] [MainThread]: On master: Close
[0m06:02:17.398155 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:17.398609 [info ] [MainThread]: 
[0m06:02:17.437159 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:17.437811 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:17.438448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:17.438900 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:17.465631 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:17.466421 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:17.501609 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:17.502387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:25.617075 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.617585 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:25.618298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.618742 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.619197 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:25.619937 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.622818 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.623282 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:25.624011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.640478 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:25.640958 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.641375 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:25.643627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.649246 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.649694 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:25.652665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.655000 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:25.656507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4064172570>]}
[0m06:02:25.657192 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.22s]
[0m06:02:25.658024 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:25.659041 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:25.659589 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:25.660207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:25.660638 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:25.665431 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:25.666061 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:25.701393 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.701913 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250719060225695434"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:25.702370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:25.710265 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.717786 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.718261 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:25.718862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.719320 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.719737 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250719060225695434'
      
      
      order by ordinal_position

  
[0m06:02:25.721829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.726866 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.727355 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:25.729372 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.736919 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.737368 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:25.739672 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.757519 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:25.758203 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.758650 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250719060225695434"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250719060225695434"
    )
  
[0m06:02:25.804872 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.806840 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:25.807316 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.807716 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:25.818264 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.819263 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:25.820620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e0f3ad0>]}
[0m06:02:25.821309 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:25.822054 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:25.823614 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.824060 [debug] [MainThread]: On master: BEGIN
[0m06:02:25.824430 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:25.825102 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.825495 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.825858 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.826274 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.826777 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.827214 [debug] [MainThread]: On master: Close
[0m06:02:25.827834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:25.828232 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:25.828624 [info ] [MainThread]: 
[0m06:02:25.829149 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.99 seconds (8.99s).
[0m06:02:25.830166 [debug] [MainThread]: Command end result
[0m06:02:25.855646 [info ] [MainThread]: 
[0m06:02:25.856253 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:25.856759 [info ] [MainThread]: 
[0m06:02:25.857295 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:25.858258 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.019019, "process_user_time": 5.089155, "process_kernel_time": 0.286459, "process_mem_max_rss": "334628", "process_in_blocks": "1200", "process_out_blocks": "100120"}
[0m06:02:25.858791 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:25.858691 after 11.02 seconds
[0m06:02:25.859247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40637f1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4024f762d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406286e420>]}
[0m06:02:25.859663 [debug] [MainThread]: Flushing usage events
[0m06:02:27.614610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe74457ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe734f8ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7543d2e0>]}


============================== 06:02:27.617633 | 4658c28d-14d7-42c8-a855-5a0ee76b5054 ==============================
[0m06:02:27.617633 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:27.618283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.724263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4658c28d-14d7-42c8-a855-5a0ee76b5054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe736edd00>]}
[0m06:02:27.743152 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1769502, "process_user_time": 1.321576, "process_kernel_time": 0.113877, "process_mem_max_rss": "100920", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:27.743663 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:27.743563 after 0.18 seconds
[0m06:02:27.744113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe73454980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe77502c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe736edd00>]}
[0m06:02:27.744514 [debug] [MainThread]: Flushing usage events
[0m14:05:10.264568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3c5ad280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3bed05c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3bed3980>]}


============================== 14:05:10.316700 | 90b7fe62-e867-49e0-bd10-c004fbe7f67b ==============================
[0m14:05:10.316700 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:10.317347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:10.456173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90b7fe62-e867-49e0-bd10-c004fbe7f67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3b2d32f0>]}
[0m14:05:10.471463 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-h041nggy'
[0m14:05:10.471934 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:10.630922 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:10.631653 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:10.654826 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:10.658618 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:10.780536 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:10.781128 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:10.781662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '90b7fe62-e867-49e0-bd10-c004fbe7f67b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3b465820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3b464890>]}
[0m14:05:10.782146 [info ] [MainThread]: 
[0m14:05:10.782630 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:10.795261 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5797381, "process_user_time": 1.589572, "process_kernel_time": 0.134709, "process_mem_max_rss": "101500", "process_in_blocks": "8744", "process_out_blocks": "5168"}
[0m14:05:10.795818 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:10.795714 after 0.58 seconds
[0m14:05:10.796267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3c5ad280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3b5be6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3bac5a00>]}
[0m14:05:10.796676 [debug] [MainThread]: Flushing usage events
[0m14:05:12.350692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51d65e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51e4c0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51da33a70>]}


============================== 14:05:12.353815 | 4665dab8-8b02-4f51-91a9-20828500dbe3 ==============================
[0m14:05:12.353815 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:12.354483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:12.559350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51cecb140>]}
[0m14:05:12.618937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51d03e9c0>]}
[0m14:05:12.621624 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:05:12.712652 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:12.713452 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:12.713974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd518f9cad0>]}
[0m14:05:14.001291 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:14.001906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd518b07740>]}
[0m14:05:14.236604 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:14.242284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd518a6b050>]}
[0m14:05:14.342738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd518a6ee70>]}
[0m14:05:14.343341 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:05:14.343858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51dc39640>]}
[0m14:05:14.345759 [info ] [MainThread]: 
[0m14:05:14.346504 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:14.351297 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:14.386253 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:14.386731 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:14.387142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:14.888484 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:14.890439 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:14.891645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:14.892349 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:14.900461 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.900896 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:14.901297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:14.902363 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.903730 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.904141 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:14.904682 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.905088 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.905472 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:14.906048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.906988 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:14.907398 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.907764 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:14.908377 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.908773 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:14.910179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:14.916191 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:14.916592 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:14.916953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:14.917641 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.918022 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:14.918428 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:14.928109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.929562 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:14.930820 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:14.931261 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:14.933707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd518a97950>]}
[0m14:05:14.934231 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:14.934612 [debug] [MainThread]: On master: BEGIN
[0m14:05:14.934969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:14.935616 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:14.936009 [debug] [MainThread]: On master: COMMIT
[0m14:05:14.936415 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:14.936772 [debug] [MainThread]: On master: COMMIT
[0m14:05:14.937318 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:14.937705 [debug] [MainThread]: On master: Close
[0m14:05:14.938249 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:14.938706 [info ] [MainThread]: 
[0m14:05:14.971701 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:14.972363 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:14.972957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:14.973420 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:15.000636 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:15.001423 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:15.036959 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:15.037763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:26.649026 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.649548 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:26.650204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.650650 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.651089 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:26.651836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.654750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.655230 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:26.655941 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.672665 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:26.673146 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.673572 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:26.675415 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.681112 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.681565 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:05:26.682767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.685170 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:26.686691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51ed76150>]}
[0m14:05:26.687383 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.71s]
[0m14:05:26.688158 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:26.689130 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:26.689705 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:26.690307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:26.690739 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:26.695674 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:26.696347 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:26.732758 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.733304 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250719140526726675"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:26.733761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:26.741671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.749455 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.749908 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:26.750551 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.750983 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.751430 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250719140526726675'
      
      
      order by ordinal_position

  
[0m14:05:26.754295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.759494 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.759948 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:26.762401 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.770068 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.770532 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:26.773224 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.791367 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:26.792084 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.792546 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250719140526726675"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250719140526726675"
    )
  
[0m14:05:26.841935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.843950 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:26.844415 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.844825 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:26.851505 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.852422 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:26.853825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4dabe3ef0>]}
[0m14:05:26.854510 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:05:26.855318 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:26.856594 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.856998 [debug] [MainThread]: On master: BEGIN
[0m14:05:26.857409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:26.858039 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.858464 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.858831 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.859235 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.859755 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.860174 [debug] [MainThread]: On master: Close
[0m14:05:26.860775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:26.861159 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:26.861557 [info ] [MainThread]: 
[0m14:05:26.862035 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.52 seconds (12.52s).
[0m14:05:26.863048 [debug] [MainThread]: Command end result
[0m14:05:26.889242 [info ] [MainThread]: 
[0m14:05:26.889864 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:26.890396 [info ] [MainThread]: 
[0m14:05:26.890917 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:26.891932 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.590472, "process_user_time": 5.157003, "process_kernel_time": 0.294885, "process_mem_max_rss": "332040", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m14:05:26.892521 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:26.892415 after 14.59 seconds
[0m14:05:26.892963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51d14d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4db546e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51dd99580>]}
[0m14:05:26.893426 [debug] [MainThread]: Flushing usage events
[0m14:05:28.643404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde116c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde2408dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde2ef1370>]}


============================== 14:05:28.646571 | 1828eeed-bcf6-4bf5-a87b-dfa59a804b66 ==============================
[0m14:05:28.646571 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:28.647231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:28.757158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1828eeed-bcf6-4bf5-a87b-dfa59a804b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde0dc81a0>]}
[0m14:05:28.775079 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18121606, "process_user_time": 1.361948, "process_kernel_time": 0.096066, "process_mem_max_rss": "100716", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:28.775615 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:28.775513 after 0.18 seconds
[0m14:05:28.776038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde06eed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde03e49e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde14ddbb0>]}
[0m14:05:28.776480 [debug] [MainThread]: Flushing usage events
[0m22:06:24.014864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1153a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde115cf560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1153b1a0>]}


============================== 22:06:24.033883 | 73c249ee-4d06-4818-8499-971c65101fb9 ==============================
[0m22:06:24.033883 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:24.034516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:24.176821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73c249ee-4d06-4818-8499-971c65101fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde12100da0>]}
[0m22:06:24.191986 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_4sc_z2e'
[0m22:06:24.192445 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:24.364100 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:24.364859 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:24.418814 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:24.422845 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:24.556356 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:24.556989 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:24.557596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '73c249ee-4d06-4818-8499-971c65101fb9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde10f72ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1113dd60>]}
[0m22:06:24.558054 [info ] [MainThread]: 
[0m22:06:24.558553 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:24.572923 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6074552, "process_user_time": 1.589422, "process_kernel_time": 0.139861, "process_mem_max_rss": "101580", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m22:06:24.573605 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:24.573469 after 0.61 seconds
[0m22:06:24.574070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde156d38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde11531070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde115cf5f0>]}
[0m22:06:24.574518 [debug] [MainThread]: Flushing usage events
[0m22:06:26.159861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed3326300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed385ed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed5e4d700>]}


============================== 22:06:26.163043 | b8835d8d-62a4-456e-9edb-f9938525552a ==============================
[0m22:06:26.163043 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:26.163703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:26.366678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecf101220>]}
[0m22:06:26.425910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed3b254c0>]}
[0m22:06:26.428753 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:26.503785 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:26.504548 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:26.505084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed30d7f50>]}
[0m22:06:27.809994 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:27.810656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecec709b0>]}
[0m22:06:28.048280 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:28.053789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed36e7560>]}
[0m22:06:28.162515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecec983e0>]}
[0m22:06:28.163104 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:28.163638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eced08860>]}
[0m22:06:28.165492 [info ] [MainThread]: 
[0m22:06:28.166218 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:28.170975 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:28.206508 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:28.207051 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:28.207450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:28.668298 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.670236 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:28.671367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:28.672146 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:28.680979 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:28.681472 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:28.681941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:28.683003 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.684514 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:28.684936 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:28.685503 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.685917 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:28.686284 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:28.686860 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.687780 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:28.688179 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:28.688542 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:28.689090 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.689481 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:28.690721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:28.696377 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:28.696894 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:28.697254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:28.697910 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.698302 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:28.698701 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:28.708842 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.710359 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:28.711631 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:28.712027 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:28.714287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ececd9c70>]}
[0m22:06:28.714821 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:28.715196 [debug] [MainThread]: On master: BEGIN
[0m22:06:28.715547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:28.716181 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:28.716593 [debug] [MainThread]: On master: COMMIT
[0m22:06:28.716983 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:28.717338 [debug] [MainThread]: On master: COMMIT
[0m22:06:28.717884 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:28.718277 [debug] [MainThread]: On master: Close
[0m22:06:28.718833 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:28.719319 [info ] [MainThread]: 
[0m22:06:28.744311 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:28.744986 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:28.745697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:28.746144 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:28.773503 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:28.774323 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:28.810112 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:28.811033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:37.749615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.750110 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:37.750781 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.751222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.751665 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:37.752373 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.755272 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.755729 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:37.756394 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.772978 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:37.773445 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.773888 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:37.776500 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.782147 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.782629 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:37.784041 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.786387 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:37.787940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed3cbc800>]}
[0m22:06:37.788644 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.04s]
[0m22:06:37.789449 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:37.790247 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:37.790824 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:37.791479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:37.791954 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:37.796927 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:37.797706 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:37.833584 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.834104 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250719220637827611"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:37.834562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:37.842484 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.849992 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.850485 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:37.851109 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.851541 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.851992 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250719220637827611'
      
      
      order by ordinal_position

  
[0m22:06:37.854153 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.859229 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.859702 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:37.861816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.869342 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.869813 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:37.872824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.890844 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:37.891546 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.892019 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250719220637827611"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250719220637827611"
    )
  
[0m22:06:37.940530 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.942489 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:37.942946 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.943355 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:37.950798 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.951693 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:37.953121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e95a19ca0>]}
[0m22:06:37.953810 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:06:37.954532 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:37.956132 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:37.956545 [debug] [MainThread]: On master: BEGIN
[0m22:06:37.956965 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:37.957632 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:37.958037 [debug] [MainThread]: On master: COMMIT
[0m22:06:37.958406 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:37.958810 [debug] [MainThread]: On master: COMMIT
[0m22:06:37.959323 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:37.959750 [debug] [MainThread]: On master: Close
[0m22:06:37.960324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:37.960718 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:37.961116 [info ] [MainThread]: 
[0m22:06:37.961591 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.80 seconds (9.80s).
[0m22:06:37.962532 [debug] [MainThread]: Command end result
[0m22:06:37.988234 [info ] [MainThread]: 
[0m22:06:37.988813 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:37.989262 [info ] [MainThread]: 
[0m22:06:37.989749 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:37.990686 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.880354, "process_user_time": 5.128582, "process_kernel_time": 0.283866, "process_mem_max_rss": "332004", "process_in_blocks": "1200", "process_out_blocks": "100144"}
[0m22:06:37.991226 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:37.991124 after 11.88 seconds
[0m22:06:37.991688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed323cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecefd47a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecec47e90>]}
[0m22:06:37.992127 [debug] [MainThread]: Flushing usage events
[0m22:06:39.806811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ad011eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68adbfdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ad013800>]}


============================== 22:06:39.809880 | 7bc49c46-d569-40e6-8673-de9fe6900624 ==============================
[0m22:06:39.809880 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:39.810538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:39.918459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bc49c46-d569-40e6-8673-de9fe6900624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68acf328a0>]}
[0m22:06:39.936205 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17889763, "process_user_time": 1.324481, "process_kernel_time": 0.111956, "process_mem_max_rss": "100644", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:39.936765 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:39.936660 after 0.18 seconds
[0m22:06:39.937188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68add68c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68b1103c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68acec9910>]}
[0m22:06:39.937628 [debug] [MainThread]: Flushing usage events
[0m06:02:27.287073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06c6adcb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06c5c8c2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06c4ef63f0>]}


============================== 06:02:27.301760 | 19451af1-8dda-4daa-b682-156b1bf15528 ==============================
[0m06:02:27.301760 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:27.302467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.457433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19451af1-8dda-4daa-b682-156b1bf15528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06c4937c20>]}
[0m06:02:27.472522 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tkl9655f'
[0m06:02:27.472991 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:27.598952 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:27.599558 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:27.622095 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:27.625928 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:27.699505 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:27.700090 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:27.700648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '19451af1-8dda-4daa-b682-156b1bf15528', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06c53da330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06c5b08200>]}
[0m06:02:27.701090 [info ] [MainThread]: 
[0m06:02:27.701603 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:27.710559 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47508118, "process_user_time": 1.584294, "process_kernel_time": 0.133687, "process_mem_max_rss": "101840", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m06:02:27.711132 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:27.711027 after 0.48 seconds
[0m06:02:27.711551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06c4ed8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06c4805940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06c48058b0>]}
[0m06:02:27.711991 [debug] [MainThread]: Flushing usage events
[0m06:02:29.243618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb947a33e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb947bc81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb947bc8350>]}


============================== 06:02:29.246645 | c4f87814-05f9-41a5-b8bc-86134e6d7121 ==============================
[0m06:02:29.246645 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:29.247292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:29.448711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb946fbcb30>]}
[0m06:02:29.510395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb946fe4590>]}
[0m06:02:29.512985 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:29.555061 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:29.555779 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:29.556290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb946e4a480>]}
[0m06:02:30.851878 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:30.852514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb942dfb680>]}
[0m06:02:31.083016 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:31.088536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb948119370>]}
[0m06:02:31.190026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb942e99be0>]}
[0m06:02:31.190524 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:31.191021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb942ed4470>]}
[0m06:02:31.192807 [info ] [MainThread]: 
[0m06:02:31.193449 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:31.198018 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:31.232494 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:31.232943 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:31.233321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:31.726839 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.729033 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:31.730290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:31.731078 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:31.739049 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.739462 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:31.739867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:31.740951 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.742283 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.742702 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:31.743255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.743667 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.744034 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:31.744633 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.745624 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:31.746011 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.746370 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:31.746910 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.747318 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:31.748541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:31.754183 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:31.754603 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:31.754973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:31.755594 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.755986 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:31.756355 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:31.766209 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.767668 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:31.768904 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:31.769307 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:31.771370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb948edd010>]}
[0m06:02:31.771897 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:31.772271 [debug] [MainThread]: On master: BEGIN
[0m06:02:31.772651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:31.773250 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:31.773677 [debug] [MainThread]: On master: COMMIT
[0m06:02:31.774043 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:31.774393 [debug] [MainThread]: On master: COMMIT
[0m06:02:31.774926 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:31.775303 [debug] [MainThread]: On master: Close
[0m06:02:31.775842 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:31.776293 [info ] [MainThread]: 
[0m06:02:31.793713 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:31.794293 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:31.794870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:31.795294 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:31.825120 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:31.825897 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:31.862750 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:31.863491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:38.938105 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.938623 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:38.939279 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.939745 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.940163 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:38.940932 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.943878 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.944314 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:38.945006 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.961548 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.962045 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.962458 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.965140 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.970913 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.971361 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:38.973013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.975312 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:38.976867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9418cbbc0>]}
[0m06:02:38.977540 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.18s]
[0m06:02:38.978286 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:38.979268 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:38.979839 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:38.980386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:38.980841 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:38.985726 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:38.986338 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:39.021829 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.022324 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250720060239015822"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:39.022809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:39.030674 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.038331 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.038825 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:39.039437 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.039923 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.040356 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250720060239015822'
      
      
      order by ordinal_position

  
[0m06:02:39.042528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.047633 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.048089 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:39.050515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.058064 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.058518 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:39.060651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.078780 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:39.079481 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.079958 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250720060239015822"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250720060239015822"
    )
  
[0m06:02:39.129700 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.131694 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:39.132158 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.132606 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:39.139926 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.140821 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:39.142217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb908cc4d40>]}
[0m06:02:39.142945 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:39.143714 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:39.145228 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:39.145657 [debug] [MainThread]: On master: BEGIN
[0m06:02:39.146032 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:39.146653 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:39.147042 [debug] [MainThread]: On master: COMMIT
[0m06:02:39.147412 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:39.147814 [debug] [MainThread]: On master: COMMIT
[0m06:02:39.148341 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:39.148760 [debug] [MainThread]: On master: Close
[0m06:02:39.149329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:39.149717 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:39.150108 [info ] [MainThread]: 
[0m06:02:39.150553 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.96 seconds (7.96s).
[0m06:02:39.151471 [debug] [MainThread]: Command end result
[0m06:02:39.176998 [info ] [MainThread]: 
[0m06:02:39.177539 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:39.178012 [info ] [MainThread]: 
[0m06:02:39.178469 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:39.179371 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.984565, "process_user_time": 5.072741, "process_kernel_time": 0.311229, "process_mem_max_rss": "335656", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:39.179936 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:39.179834 after 9.99 seconds
[0m06:02:39.180354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb947a33e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb908cc4d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb947579fa0>]}
[0m06:02:39.180794 [debug] [MainThread]: Flushing usage events
[0m06:02:40.985197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a9c1a4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a8ef0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80aa9392b0>]}


============================== 06:02:40.988248 | ca9364bb-1798-471d-9063-a79657b48aad ==============================
[0m06:02:40.988248 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:40.988966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:41.097775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca9364bb-1798-471d-9063-a79657b48aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80aa5772c0>]}
[0m06:02:41.116079 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18037224, "process_user_time": 1.392083, "process_kernel_time": 0.094937, "process_mem_max_rss": "100688", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:41.116659 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:41.116521 after 0.18 seconds
[0m06:02:41.117088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a8d2c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a8863080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80aa7d43b0>]}
[0m06:02:41.117515 [debug] [MainThread]: Flushing usage events
[0m14:05:24.209425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d1be25700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d198a5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d198a7ce0>]}


============================== 14:05:24.259199 | 22c50b9a-d17a-40ec-bdfc-aa4bd101c44d ==============================
[0m14:05:24.259199 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:24.259866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:24.420966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22c50b9a-d17a-40ec-bdfc-aa4bd101c44d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d1a200980>]}
[0m14:05:24.436231 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4runmtv1'
[0m14:05:24.436704 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:24.645437 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:24.646202 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:24.779281 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:24.783248 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:24.994516 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:24.995121 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:24.995672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '22c50b9a-d17a-40ec-bdfc-aa4bd101c44d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d18fa4680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d196f0350>]}
[0m14:05:24.996171 [info ] [MainThread]: 
[0m14:05:24.996657 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:25.026882 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.86659926, "process_user_time": 1.565227, "process_kernel_time": 0.156022, "process_mem_max_rss": "101740", "process_in_blocks": "8744", "process_out_blocks": "5168"}
[0m14:05:25.027563 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:25.027447 after 0.87 seconds
[0m14:05:25.028012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d1cfcf0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d196cff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d19d41160>]}
[0m14:05:25.028473 [debug] [MainThread]: Flushing usage events
[0m14:05:26.727849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c36d13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c396f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c2cb1c40>]}


============================== 14:05:26.730979 | a086fa8c-2ebc-4401-a2df-0636ca270fd2 ==============================
[0m14:05:26.730979 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:26.731664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:26.936557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c2e566c0>]}
[0m14:05:26.995988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c45cce90>]}
[0m14:05:26.998727 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:05:27.094527 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:27.095304 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:27.095835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7be716330>]}
[0m14:05:28.383281 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:28.383958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c26cccb0>]}
[0m14:05:28.616151 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:28.621570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c32b6450>]}
[0m14:05:28.725564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7be23e030>]}
[0m14:05:28.726152 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:05:28.726662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7be238ad0>]}
[0m14:05:28.728530 [info ] [MainThread]: 
[0m14:05:28.729260 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:28.733881 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:28.768713 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:28.769203 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:28.769597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:29.360538 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:29.362607 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:29.363816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:29.364674 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:29.374646 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:29.375066 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:29.375486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:29.376377 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:29.377703 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:29.378105 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:29.378652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:29.379037 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:29.379429 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:29.380038 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:29.380981 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:29.381391 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:29.381753 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:29.382295 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:29.382688 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:29.384060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:29.389803 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:29.390311 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:29.390669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:29.391268 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:29.391651 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:29.392022 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:29.401722 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:29.403178 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:29.404401 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:29.404792 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:29.407122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c2d21760>]}
[0m14:05:29.407633 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:29.408014 [debug] [MainThread]: On master: BEGIN
[0m14:05:29.408403 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:29.409006 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:29.409429 [debug] [MainThread]: On master: COMMIT
[0m14:05:29.409799 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:29.410178 [debug] [MainThread]: On master: COMMIT
[0m14:05:29.410755 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:29.411180 [debug] [MainThread]: On master: Close
[0m14:05:29.411711 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:29.412206 [info ] [MainThread]: 
[0m14:05:29.471075 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:29.471719 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:29.472406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:29.472853 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:29.499737 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:29.500498 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:29.535489 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:29.536237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:38.926777 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.927323 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:38.928009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.928479 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.928899 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:38.929674 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.932756 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.933216 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:38.933951 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.950699 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:38.951211 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.951638 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:38.953666 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.959558 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.960020 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:05:38.961384 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.963830 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:38.965400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bd017500>]}
[0m14:05:38.966106 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.49s]
[0m14:05:38.966937 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:38.967929 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:38.968532 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:38.969138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:38.969585 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:38.974779 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:38.975473 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:39.012323 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.012887 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250720140539006209"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:39.013373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:39.021475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.029553 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.030022 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:39.030690 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.031142 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.031573 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250720140539006209'
      
      
      order by ordinal_position

  
[0m14:05:39.033844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.039128 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.039588 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:39.041718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.049496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.049955 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:39.052794 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.070794 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:39.071530 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.071981 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250720140539006209"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250720140539006209"
    )
  
[0m14:05:39.119964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.122002 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:39.122474 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.122893 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:39.130227 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.131144 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:39.132588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa784a64230>]}
[0m14:05:39.133278 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:05:39.134009 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:39.135389 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.135805 [debug] [MainThread]: On master: BEGIN
[0m14:05:39.136219 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:39.136868 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.137308 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.137679 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.138035 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.138591 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.138975 [debug] [MainThread]: On master: Close
[0m14:05:39.139676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:39.140042 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:39.140491 [info ] [MainThread]: 
[0m14:05:39.140983 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.41 seconds (10.41s).
[0m14:05:39.141970 [debug] [MainThread]: Command end result
[0m14:05:39.168055 [info ] [MainThread]: 
[0m14:05:39.168714 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:39.169239 [info ] [MainThread]: 
[0m14:05:39.169738 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:39.170750 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.491492, "process_user_time": 5.229597, "process_kernel_time": 0.302074, "process_mem_max_rss": "340760", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m14:05:39.171337 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:39.171227 after 12.49 seconds
[0m14:05:39.171779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c36d13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ac064f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c2cdec30>]}
[0m14:05:39.172237 [debug] [MainThread]: Flushing usage events
[0m14:05:41.023760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e8509d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e8d254c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e8509cd0>]}


============================== 14:05:41.026938 | 11f0bb56-716b-400a-9f6a-1d1d17da6ae9 ==============================
[0m14:05:41.026938 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:41.027593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:41.134900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11f0bb56-716b-400a-9f6a-1d1d17da6ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44eb00d670>]}
[0m14:05:41.152705 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17842655, "process_user_time": 1.336077, "process_kernel_time": 0.116919, "process_mem_max_rss": "100544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:41.153299 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:41.153192 after 0.18 seconds
[0m14:05:41.153727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44ec7bb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e831b080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44eb00d670>]}
[0m14:05:41.154171 [debug] [MainThread]: Flushing usage events
[0m22:06:18.231855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7049fff830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704ab00f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704a93cc20>]}


============================== 22:06:18.246790 | 3a684d8d-3dda-4f70-9ae4-b746c2829900 ==============================
[0m22:06:18.246790 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:18.247468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:18.403763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a684d8d-3dda-4f70-9ae4-b746c2829900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7049fa7710>]}
[0m22:06:18.419244 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6989n0_6'
[0m22:06:18.419733 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:18.513878 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:18.514509 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:18.543285 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:18.547150 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:18.615357 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:18.615931 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:18.616436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3a684d8d-3dda-4f70-9ae4-b746c2829900', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7049d5c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7049e56630>]}
[0m22:06:18.616906 [info ] [MainThread]: 
[0m22:06:18.617360 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:18.624911 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44209832, "process_user_time": 1.570802, "process_kernel_time": 0.137507, "process_mem_max_rss": "101580", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m22:06:18.625459 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:18.625350 after 0.44 seconds
[0m22:06:18.625898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704a131f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704a161700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7049e303e0>]}
[0m22:06:18.626305 [debug] [MainThread]: Flushing usage events
[0m22:06:20.185059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07af192960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07af003800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07aeae9bb0>]}


============================== 22:06:20.188180 | a6da7761-422b-4435-a900-42ffcb640fe3 ==============================
[0m22:06:20.188180 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:20.188831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:20.389212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ae71c710>]}
[0m22:06:20.447996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ae566cc0>]}
[0m22:06:20.450744 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:20.473589 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:20.474346 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:20.474880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ae4e33b0>]}
[0m22:06:21.769261 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:21.769900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07aa3f6f90>]}
[0m22:06:22.000876 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:22.006491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07aa35f230>]}
[0m22:06:22.102406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07aa3f4e30>]}
[0m22:06:22.102990 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:22.103469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07aa3c7c80>]}
[0m22:06:22.105307 [info ] [MainThread]: 
[0m22:06:22.106013 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:22.110728 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:22.145363 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:22.145813 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:22.146200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:22.656047 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:22.657732 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:22.658686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:22.659273 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:22.666839 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:22.667258 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:22.667628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:22.668596 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:22.670273 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:22.670680 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:22.671228 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:22.671602 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:22.671989 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:22.672593 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:22.673518 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:22.673924 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:22.674282 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:22.674819 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:22.675210 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:22.676464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:22.682282 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:22.682789 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:22.683149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:22.683757 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:22.684141 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:22.684510 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:22.694241 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:22.695701 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:22.696972 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:22.697364 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:22.699546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07aa456f00>]}
[0m22:06:22.700065 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:22.700433 [debug] [MainThread]: On master: BEGIN
[0m22:06:22.700810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:22.701397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:22.701819 [debug] [MainThread]: On master: COMMIT
[0m22:06:22.702177 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:22.702524 [debug] [MainThread]: On master: COMMIT
[0m22:06:22.703043 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:22.703421 [debug] [MainThread]: On master: Close
[0m22:06:22.703944 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:22.704399 [info ] [MainThread]: 
[0m22:06:22.721934 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:22.722514 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:22.723090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:22.723513 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:22.750117 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:22.750869 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:22.786116 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:22.786865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:30.362657 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.363182 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:30.363821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.364249 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.364657 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:30.365412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.368329 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.368785 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:30.369481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.386047 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:30.386510 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.386954 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:30.388445 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.394045 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.394490 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:30.395656 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.398003 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:30.399529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b045a510>]}
[0m22:06:30.400207 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.68s]
[0m22:06:30.400952 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:30.401773 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:30.402340 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:30.403160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:30.403614 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:30.408491 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:30.409160 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:30.445181 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.445689 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250720220630439218"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:30.446145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:30.454060 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.461610 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.462085 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:30.462687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.463119 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.463528 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250720220630439218'
      
      
      order by ordinal_position

  
[0m22:06:30.465739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.470869 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.471323 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:30.473564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.481152 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.481603 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:30.484480 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.502865 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:30.503606 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.504088 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250720220630439218"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250720220630439218"
    )
  
[0m22:06:30.552198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.554205 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:30.554646 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.555078 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:30.561853 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.562758 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:30.564295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f076bf45be0>]}
[0m22:06:30.564993 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:06:30.565742 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:30.567397 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:30.567840 [debug] [MainThread]: On master: BEGIN
[0m22:06:30.568212 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:30.568856 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:30.569249 [debug] [MainThread]: On master: COMMIT
[0m22:06:30.569614 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:30.570022 [debug] [MainThread]: On master: COMMIT
[0m22:06:30.570536 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:30.570953 [debug] [MainThread]: On master: Close
[0m22:06:30.571503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:30.571900 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:30.572290 [info ] [MainThread]: 
[0m22:06:30.572805 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.47 seconds (8.47s).
[0m22:06:30.573801 [debug] [MainThread]: Command end result
[0m22:06:30.599805 [info ] [MainThread]: 
[0m22:06:30.600420 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:30.600948 [info ] [MainThread]: 
[0m22:06:30.601473 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:30.602471 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.466354, "process_user_time": 5.130023, "process_kernel_time": 0.284333, "process_mem_max_rss": "338804", "process_in_blocks": "1200", "process_out_blocks": "100144"}
[0m22:06:30.603036 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:30.602932 after 10.47 seconds
[0m22:06:30.603461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07af444470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07af9c1520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07aeb72a80>]}
[0m22:06:30.603910 [debug] [MainThread]: Flushing usage events
[0m22:06:32.419361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86b6a8e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86b271bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86b271b50>]}


============================== 22:06:32.422632 | 72687c22-f956-48e3-aa3b-a15afbf0e61e ==============================
[0m22:06:32.422632 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:32.423334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:32.531634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72687c22-f956-48e3-aa3b-a15afbf0e61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86b05d550>]}
[0m22:06:32.550228 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18074957, "process_user_time": 1.362476, "process_kernel_time": 0.106958, "process_mem_max_rss": "100788", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:32.550802 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:32.550692 after 0.18 seconds
[0m22:06:32.551249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86b63aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86b5c3b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86b102d50>]}
[0m22:06:32.551699 [debug] [MainThread]: Flushing usage events
[0m06:02:41.497685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3f687c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3f2aa060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3f2a9fd0>]}


============================== 06:02:41.506069 | 18e76510-15f8-45bc-a310-cbcde51bc8d8 ==============================
[0m06:02:41.506069 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:41.506756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:41.641031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18e76510-15f8-45bc-a310-cbcde51bc8d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3f0d2d50>]}
[0m06:02:41.655487 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-27c66375'
[0m06:02:41.655917 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:41.692589 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:41.693173 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:41.705314 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:41.709088 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:41.761653 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:41.762153 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:41.762672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '18e76510-15f8-45bc-a310-cbcde51bc8d8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3f4a0b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3f28c740>]}
[0m06:02:41.763092 [info ] [MainThread]: 
[0m06:02:41.763577 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:41.774258 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3253592, "process_user_time": 1.534808, "process_kernel_time": 0.140165, "process_mem_max_rss": "101460", "process_in_blocks": "8744", "process_out_blocks": "5168"}
[0m06:02:41.774813 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:41.774711 after 0.33 seconds
[0m06:02:41.775213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e40e35100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3f2ed670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3f2ed820>]}
[0m06:02:41.775660 [debug] [MainThread]: Flushing usage events
[0m06:02:43.298749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f7add4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f77758e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f7775850>]}


============================== 06:02:43.301791 | c1bbb735-86af-4f32-9864-c086c853bb63 ==============================
[0m06:02:43.301791 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:43.302446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:43.504846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f754aff0>]}
[0m06:02:43.564026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f76f3140>]}
[0m06:02:43.566544 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:43.582218 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:43.582945 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:43.583484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f74d4800>]}
[0m06:02:44.872565 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:44.873183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f354dac0>]}
[0m06:02:45.099044 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:45.104404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0fb52a630>]}
[0m06:02:45.203957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f33edf10>]}
[0m06:02:45.204460 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:45.204936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f34db470>]}
[0m06:02:45.206739 [info ] [MainThread]: 
[0m06:02:45.207391 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:45.215018 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:45.249498 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:45.249926 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:45.250301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:45.732310 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:45.733955 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:45.735007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:45.735586 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:45.743068 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:45.743506 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:45.743885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:45.744935 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:45.746265 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:45.746671 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:45.747239 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:45.747639 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:45.747999 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:45.748605 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:45.749530 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:45.749918 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:45.750278 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:45.750878 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:45.751270 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:45.752508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:45.758258 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:45.758766 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:45.759125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:45.759730 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:45.760112 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:45.760502 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:45.770634 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:45.772062 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:45.773290 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:45.773700 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:45.775913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f94c9460>]}
[0m06:02:45.776407 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:45.776827 [debug] [MainThread]: On master: BEGIN
[0m06:02:45.777187 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:45.777814 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:45.778208 [debug] [MainThread]: On master: COMMIT
[0m06:02:45.778616 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:45.778977 [debug] [MainThread]: On master: COMMIT
[0m06:02:45.779515 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:45.779905 [debug] [MainThread]: On master: Close
[0m06:02:45.780415 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:45.780928 [info ] [MainThread]: 
[0m06:02:45.800453 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:45.801024 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:45.801656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:45.802086 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:45.828279 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:45.829020 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:45.864183 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:45.864915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:53.124735 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:53.125215 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:53.125894 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.126320 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:53.126771 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:53.127509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.130375 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:53.130830 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:53.131520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.148173 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:53.148664 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:53.149080 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:53.150201 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.155817 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:53.156266 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:53.157521 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.159826 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:53.161339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f1ec12e0>]}
[0m06:02:53.162036 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.36s]
[0m06:02:53.162791 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:53.163602 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:53.164318 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:53.164997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:53.165462 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:53.170336 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:53.170984 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:53.207116 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:53.207616 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250721060253200984"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:53.208062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:53.215798 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.223188 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:53.223688 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:53.224292 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.224755 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:53.225173 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250721060253200984'
      
      
      order by ordinal_position

  
[0m06:02:53.227294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.232374 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:53.232847 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:53.235750 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.243321 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:53.243801 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:53.246470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.264588 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:53.265232 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:53.265705 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250721060253200984"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250721060253200984"
    )
  
[0m06:02:53.315764 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.317801 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:53.318263 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:53.318697 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:53.325587 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.326483 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:53.327887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b8e83380>]}
[0m06:02:53.328584 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:53.329376 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:53.330970 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:53.331388 [debug] [MainThread]: On master: BEGIN
[0m06:02:53.331810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:53.332489 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:53.332890 [debug] [MainThread]: On master: COMMIT
[0m06:02:53.333255 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:53.333653 [debug] [MainThread]: On master: COMMIT
[0m06:02:53.334178 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:53.334598 [debug] [MainThread]: On master: Close
[0m06:02:53.335170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:53.335571 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:53.335977 [info ] [MainThread]: 
[0m06:02:53.336470 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.13 seconds (8.13s).
[0m06:02:53.337397 [debug] [MainThread]: Command end result
[0m06:02:53.364252 [info ] [MainThread]: 
[0m06:02:53.364830 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:53.365299 [info ] [MainThread]: 
[0m06:02:53.365809 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:53.366779 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.117566, "process_user_time": 5.074878, "process_kernel_time": 0.279378, "process_mem_max_rss": "336576", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m06:02:53.367310 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:53.367209 after 10.12 seconds
[0m06:02:53.367761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f7777950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f339a300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f3346a50>]}
[0m06:02:53.368180 [debug] [MainThread]: Flushing usage events
[0m06:02:55.068138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eff8d80b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f01825100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f00d39190>]}


============================== 06:02:55.071172 | 98959fd1-3017-4535-a022-9c0ae4afc61e ==============================
[0m06:02:55.071172 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:55.071885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:55.178805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98959fd1-3017-4535-a022-9c0ae4afc61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9effdd32f0>]}
[0m06:02:55.196291 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17687203, "process_user_time": 1.298605, "process_kernel_time": 0.126961, "process_mem_max_rss": "100700", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:55.196813 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:55.196714 after 0.18 seconds
[0m06:02:55.197214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eff8d80b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9efebc16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9efea77ec0>]}
[0m06:02:55.197650 [debug] [MainThread]: Flushing usage events
[0m14:06:56.518104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748e238800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7490340500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7490343e30>]}


============================== 14:06:56.532831 | 72255d6d-6a4a-4ca0-95dd-bb07934956dd ==============================
[0m14:06:56.532831 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:56.533455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:56.668856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72255d6d-6a4a-4ca0-95dd-bb07934956dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748f4597c0>]}
[0m14:06:56.683847 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0n904i0j'
[0m14:06:56.684318 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:56.790742 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:56.791356 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:56.803823 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:56.807657 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:56.865739 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:56.866230 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:06:56.866762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '72255d6d-6a4a-4ca0-95dd-bb07934956dd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748df466c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748df455b0>]}
[0m14:06:56.867205 [info ] [MainThread]: 
[0m14:06:56.867686 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:56.875398 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40629652, "process_user_time": 1.539808, "process_kernel_time": 0.139617, "process_mem_max_rss": "101524", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m14:06:56.875972 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:56.875869 after 0.41 seconds
[0m14:06:56.876388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74925bb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7490340500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748e1e7410>]}
[0m14:06:56.876818 [debug] [MainThread]: Flushing usage events
[0m14:06:58.438052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c25ecb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bfe64b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bfaacd40>]}


============================== 14:06:58.441186 | 2d8f9390-0d22-4252-8bea-09ea28a0afff ==============================
[0m14:06:58.441186 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:58.441859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:58.643196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bfe64560>]}
[0m14:06:58.702323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bfaad5b0>]}
[0m14:06:58.704948 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:06:58.727440 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:58.728161 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:58.728692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bf846db0>]}
[0m14:07:00.015161 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:07:00.015911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bb9f0890>]}
[0m14:07:00.245430 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:07:00.250857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c27ab680>]}
[0m14:07:00.348097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bb633920>]}
[0m14:07:00.348649 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:07:00.349156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c03328a0>]}
[0m14:07:00.350962 [info ] [MainThread]: 
[0m14:07:00.351667 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:07:00.356335 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:07:00.390840 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:07:00.391271 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:07:00.391678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:00.686905 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.688789 [debug] [ThreadPool]: On list_petro: Close
[0m14:07:00.689880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:07:00.690589 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:07:00.699129 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:00.699569 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:07:00.699952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:00.700844 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.702152 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:00.702563 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:07:00.703172 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.703575 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:00.703949 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:07:00.704506 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.705430 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:00.705831 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:00.706192 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:00.706754 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.707151 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:07:00.708378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:07:00.714085 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:00.714484 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:07:00.714879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:00.715459 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.715872 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:00.716243 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:07:00.725885 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.727299 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:07:00.728540 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:07:00.728931 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:07:00.731049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85ba1bb950>]}
[0m14:07:00.731554 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:00.731938 [debug] [MainThread]: On master: BEGIN
[0m14:07:00.732289 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:00.732914 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:00.733306 [debug] [MainThread]: On master: COMMIT
[0m14:07:00.733695 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:00.734051 [debug] [MainThread]: On master: COMMIT
[0m14:07:00.734574 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:00.734958 [debug] [MainThread]: On master: Close
[0m14:07:00.735474 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:07:00.735960 [info ] [MainThread]: 
[0m14:07:00.754673 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:07:00.755256 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:07:00.755827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:07:00.756258 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:07:00.782761 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:07:00.783491 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:07:00.818740 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:07:00.819469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:07.479817 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:07.480297 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:07:07.480980 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.481415 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:07.481858 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:07:07.482749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.485661 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:07.486102 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:07:07.486843 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.503569 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:07.504038 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:07.504462 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:07.506383 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.512053 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:07.512508 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:07:07.513721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.516089 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:07:07.517648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c176a510>]}
[0m14:07:07.518321 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.76s]
[0m14:07:07.519156 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:07:07.519970 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:07:07.520553 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:07:07.521129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:07:07.521599 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:07:07.526555 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:07:07.527343 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:07:07.562884 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:07.563372 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250721140707556877"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:07:07.563858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:07.571597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.579064 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:07.579513 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:07:07.580124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.580621 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:07.581050 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250721140707556877'
      
      
      order by ordinal_position

  
[0m14:07:07.583133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.588218 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:07.588721 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:07.590847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.598462 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:07.598945 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:07.601804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.619890 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:07:07.620586 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:07.621036 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250721140707556877"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250721140707556877"
    )
  
[0m14:07:07.667079 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.669109 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:07.669570 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:07.669990 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:07.677479 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.678389 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:07:07.679867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8581562300>]}
[0m14:07:07.680563 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:07:07.681290 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:07:07.682781 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:07.683191 [debug] [MainThread]: On master: BEGIN
[0m14:07:07.683586 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:07.684220 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:07.684643 [debug] [MainThread]: On master: COMMIT
[0m14:07:07.685019 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:07.685375 [debug] [MainThread]: On master: COMMIT
[0m14:07:07.685957 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:07.686358 [debug] [MainThread]: On master: Close
[0m14:07:07.687051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:07.687434 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:07:07.687851 [info ] [MainThread]: 
[0m14:07:07.688368 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.34 seconds (7.34s).
[0m14:07:07.689363 [debug] [MainThread]: Command end result
[0m14:07:07.715044 [info ] [MainThread]: 
[0m14:07:07.715650 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:07.716165 [info ] [MainThread]: 
[0m14:07:07.716707 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:07:07.717700 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.328408, "process_user_time": 4.907365, "process_kernel_time": 0.266748, "process_mem_max_rss": "337044", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m14:07:07.718237 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:07.718135 after 9.33 seconds
[0m14:07:07.718699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c25ecb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bf9cbbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bb6db080>]}
[0m14:07:07.719137 [debug] [MainThread]: Flushing usage events
[0m14:07:09.526930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4223055b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb421379280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb422d9d7c0>]}


============================== 14:07:09.530136 | cfbebc33-324d-48ac-99f2-559c4d4a3d0c ==============================
[0m14:07:09.530136 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:09.530827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:07:09.638151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfbebc33-324d-48ac-99f2-559c4d4a3d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb420191220>]}
[0m14:07:09.656071 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17862368, "process_user_time": 1.356323, "process_kernel_time": 0.113943, "process_mem_max_rss": "100800", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:07:09.656629 [debug] [MainThread]: Command `dbt clean` succeeded at 14:07:09.656505 after 0.18 seconds
[0m14:07:09.657053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4207f2a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4202bf5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb422b043b0>]}
[0m14:07:09.657468 [debug] [MainThread]: Flushing usage events
[0m22:06:55.890704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ebde5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7eb794c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ebd7b5f0>]}


============================== 22:06:55.908920 | 2561b5ee-4deb-45ae-9fbb-d985842769a7 ==============================
[0m22:06:55.908920 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:55.909585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:56.051310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2561b5ee-4deb-45ae-9fbb-d985842769a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7eb1e32f0>]}
[0m22:06:56.066597 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-gut2vasg'
[0m22:06:56.067095 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:56.250232 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:56.250959 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:56.272650 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:56.276446 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:56.360499 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:56.361069 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:56.361608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2561b5ee-4deb-45ae-9fbb-d985842769a7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7eb35b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7eb3b74d0>]}
[0m22:06:56.362068 [info ] [MainThread]: 
[0m22:06:56.362558 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:56.376002 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5358914, "process_user_time": 1.583091, "process_kernel_time": 0.137354, "process_mem_max_rss": "101432", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m22:06:56.376569 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:56.376464 after 0.54 seconds
[0m22:06:56.377002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7eb5655b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7eb0ab080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ef0cf0b0>]}
[0m22:06:56.377436 [debug] [MainThread]: Flushing usage events
[0m22:06:57.948208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe009bcca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00a96c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00b9f8260>]}


============================== 22:06:57.951303 | bec8f2c9-156a-4825-8ee4-4fecc2792119 ==============================
[0m22:06:57.951303 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:57.952011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:58.154490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0098aee70>]}
[0m22:06:58.214232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe009b2a120>]}
[0m22:06:58.216933 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:58.243118 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:58.243874 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:58.244422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0098af8f0>]}
[0m22:06:59.540522 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:59.541177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0098a8c50>]}
[0m22:06:59.773179 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:59.778906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00574baa0>]}
[0m22:06:59.887451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0057e5c40>]}
[0m22:06:59.888026 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:59.888531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0058ddbb0>]}
[0m22:06:59.890411 [info ] [MainThread]: 
[0m22:06:59.891086 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:59.895955 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:59.931782 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:59.932295 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:59.932711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:00.436576 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:07:00.438701 [debug] [ThreadPool]: On list_petro: Close
[0m22:07:00.440001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:07:00.440704 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:07:00.448943 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:00.449420 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:07:00.449852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:00.450908 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:00.452417 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:00.452869 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:07:00.453583 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:00.454058 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:00.454449 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:07:00.455035 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:00.455995 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:00.456409 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:00.456890 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:00.457626 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:00.458133 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:07:00.459654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:07:00.465569 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:00.466062 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:07:00.466448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:00.467094 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:00.467519 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:00.467895 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:07:00.477867 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:00.479352 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:07:00.480619 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:07:00.481017 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:07:00.483189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0057d6330>]}
[0m22:07:00.483711 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:00.484085 [debug] [MainThread]: On master: BEGIN
[0m22:07:00.484462 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:00.485070 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:00.485487 [debug] [MainThread]: On master: COMMIT
[0m22:07:00.485858 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:00.486213 [debug] [MainThread]: On master: COMMIT
[0m22:07:00.486770 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:00.487152 [debug] [MainThread]: On master: Close
[0m22:07:00.487698 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:07:00.488187 [info ] [MainThread]: 
[0m22:07:00.526254 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:07:00.526934 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:07:00.527636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:07:00.528079 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:07:00.554903 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:07:00.555744 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:07:00.590752 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:07:00.591634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:08.651904 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:08.652433 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:08.653093 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.653562 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:08.653976 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:08.654710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.657637 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:08.658082 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:08.658766 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.675419 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:08.675884 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:08.676303 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:08.677861 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.683495 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:08.683947 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:08.685178 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.687532 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:08.689066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00b87e120>]}
[0m22:07:08.689844 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.16s]
[0m22:07:08.690675 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:08.691654 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:08.692203 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:08.692851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:08.693285 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:08.698202 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:08.698887 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:08.734404 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:08.734945 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250721220708728355"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:08.735417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:08.743275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.750949 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:08.751422 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:08.752063 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.752525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:08.752959 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250721220708728355'
      
      
      order by ordinal_position

  
[0m22:07:08.755187 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.760402 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:08.760858 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:08.763227 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.770857 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:08.771314 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:08.773368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.791407 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:08.792109 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:08.792577 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250721220708728355"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250721220708728355"
    )
  
[0m22:07:08.841040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.843036 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:08.843494 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:08.843912 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:08.851687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.852612 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:08.854141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfc7043650>]}
[0m22:07:08.854832 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:07:08.855648 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:08.856923 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:08.857331 [debug] [MainThread]: On master: BEGIN
[0m22:07:08.857739 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:08.858408 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:08.858806 [debug] [MainThread]: On master: COMMIT
[0m22:07:08.859172 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:08.859567 [debug] [MainThread]: On master: COMMIT
[0m22:07:08.860109 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:08.860548 [debug] [MainThread]: On master: Close
[0m22:07:08.861144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:08.861554 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:08.861953 [info ] [MainThread]: 
[0m22:07:08.862482 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.97 seconds (8.97s).
[0m22:07:08.863496 [debug] [MainThread]: Command end result
[0m22:07:08.889121 [info ] [MainThread]: 
[0m22:07:08.889765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:08.890271 [info ] [MainThread]: 
[0m22:07:08.890805 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:08.891800 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.992664, "process_user_time": 4.675354, "process_kernel_time": 0.280802, "process_mem_max_rss": "324900", "process_in_blocks": "1200", "process_out_blocks": "100144"}
[0m22:07:08.892337 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:08.892234 after 10.99 seconds
[0m22:07:08.892827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00a5c8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfc777c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfc7867440>]}
[0m22:07:08.893243 [debug] [MainThread]: Flushing usage events
[0m22:07:10.702630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f068528ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06847ac530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0686d592e0>]}


============================== 22:07:10.705778 | 2acc9ac6-492b-45f0-87ee-3dc4783ab4c1 ==============================
[0m22:07:10.705778 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:10.706457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:07:10.814704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2acc9ac6-492b-45f0-87ee-3dc4783ab4c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06852db2f0>]}
[0m22:07:10.832532 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17904042, "process_user_time": 1.314296, "process_kernel_time": 0.13503, "process_mem_max_rss": "100528", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:10.833077 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:10.832975 after 0.18 seconds
[0m22:07:10.833519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06841c8f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0683ff7ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06841f3170>]}
[0m22:07:10.833946 [debug] [MainThread]: Flushing usage events
[0m06:02:31.766742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7975bf71a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79755b5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79755b06e0>]}


============================== 06:02:31.874329 | c79d59d2-42e0-4699-8456-1260c136396f ==============================
[0m06:02:31.874329 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:31.875042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:32.044847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c79d59d2-42e0-4699-8456-1260c136396f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79765089e0>]}
[0m06:02:32.060016 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6nzrg5s4'
[0m06:02:32.060470 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:32.158892 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:32.159512 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:32.171025 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:32.174861 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:32.227373 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:32.227925 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:32.228469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c79d59d2-42e0-4699-8456-1260c136396f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7975405580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7976508140>]}
[0m06:02:32.228976 [info ] [MainThread]: 
[0m06:02:32.229482 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:32.239107 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5225104, "process_user_time": 1.55435, "process_kernel_time": 0.147222, "process_mem_max_rss": "101748", "process_in_blocks": "8744", "process_out_blocks": "5168"}
[0m06:02:32.239655 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:32.239553 after 0.52 seconds
[0m06:02:32.240113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f797813d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7975973bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7975970f20>]}
[0m06:02:32.240540 [debug] [MainThread]: Flushing usage events
[0m06:02:33.817926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae67994260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6822d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6a4ed460>]}


============================== 06:02:33.821027 | 065cb3e8-3116-4240-9ef6-dc5aa086386b ==============================
[0m06:02:33.821027 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:33.821688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:34.022389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae67778620>]}
[0m06:02:34.081554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6838f7d0>]}
[0m06:02:34.084143 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:34.107905 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:34.108603 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:34.109144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6770e690>]}
[0m06:02:35.400040 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:35.400650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae636c5100>]}
[0m06:02:35.629748 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:35.635110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6779c5f0>]}
[0m06:02:35.733576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae635505c0>]}
[0m06:02:35.734101 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:35.734574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae635c39e0>]}
[0m06:02:35.736454 [info ] [MainThread]: 
[0m06:02:35.737156 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:35.741846 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:35.776201 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:35.776633 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:35.777045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:36.243615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.245464 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:36.246696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:36.247401 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:36.256975 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.257515 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:36.258052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:36.259180 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.260474 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.260881 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:36.261444 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.261851 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.262217 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:36.262796 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.263688 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:36.264096 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.264454 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:36.264998 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.265387 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:36.266582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:36.272286 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:36.272808 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:36.273172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:36.273819 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.274211 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:36.274594 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:36.284492 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.285933 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:36.287172 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:36.287567 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:36.289884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae696d9280>]}
[0m06:02:36.290396 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:36.290817 [debug] [MainThread]: On master: BEGIN
[0m06:02:36.291179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:36.291803 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:36.292203 [debug] [MainThread]: On master: COMMIT
[0m06:02:36.292569 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:36.292948 [debug] [MainThread]: On master: COMMIT
[0m06:02:36.293457 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:36.293874 [debug] [MainThread]: On master: Close
[0m06:02:36.294391 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:36.294906 [info ] [MainThread]: 
[0m06:02:36.313323 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:36.313924 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:36.314555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:36.315022 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:36.342354 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:36.343115 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:36.378950 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:36.379811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:42.882540 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:42.883071 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:42.883744 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.884204 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:42.884621 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:42.885346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.888296 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:42.888774 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:42.889522 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.906587 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:42.907080 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:42.907539 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:42.908605 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.914338 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:42.914815 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:42.915925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.918319 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:42.919874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae620c9d60>]}
[0m06:02:42.920555 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.60s]
[0m06:02:42.921324 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:42.922111 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:42.922680 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:42.923336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:42.923804 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:42.928763 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:42.929569 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:42.966005 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:42.966505 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250722060242959908"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:42.966989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:42.974724 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.982287 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:42.982766 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:42.983365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.983835 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:42.984263 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250722060242959908'
      
      
      order by ordinal_position

  
[0m06:02:42.986425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.991618 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:42.992105 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:42.994184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:43.002289 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:43.002791 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:43.005578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:43.023987 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:43.024647 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:43.025127 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250722060242959908"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250722060242959908"
    )
  
[0m06:02:43.076191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:43.078259 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:43.078722 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:43.079147 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:43.085879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:43.086813 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:43.088297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae29353a40>]}
[0m06:02:43.088997 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:43.089750 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:43.091107 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:43.091525 [debug] [MainThread]: On master: BEGIN
[0m06:02:43.091940 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:43.092583 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:43.093015 [debug] [MainThread]: On master: COMMIT
[0m06:02:43.093380 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:43.093778 [debug] [MainThread]: On master: COMMIT
[0m06:02:43.094309 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:43.094693 [debug] [MainThread]: On master: Close
[0m06:02:43.095304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:43.095672 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:43.096098 [info ] [MainThread]: 
[0m06:02:43.096552 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.36 seconds (7.36s).
[0m06:02:43.097479 [debug] [MainThread]: Command end result
[0m06:02:43.123497 [info ] [MainThread]: 
[0m06:02:43.124064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:43.124513 [info ] [MainThread]: 
[0m06:02:43.124993 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:43.125925 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.357054, "process_user_time": 5.102255, "process_kernel_time": 0.288957, "process_mem_max_rss": "342488", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m06:02:43.126461 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:43.126359 after 9.36 seconds
[0m06:02:43.126911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae678ea180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae29aae4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6354d100>]}
[0m06:02:43.127339 [debug] [MainThread]: Flushing usage events
[0m06:02:44.917736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac71361cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac71d673e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac71e91a90>]}


============================== 06:02:44.922232 | cb491749-7221-484e-8833-b76ac55cec07 ==============================
[0m06:02:44.922232 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:44.923135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:45.047095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb491749-7221-484e-8833-b76ac55cec07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7116b200>]}
[0m06:02:45.064863 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20209853, "process_user_time": 1.357964, "process_kernel_time": 0.100997, "process_mem_max_rss": "100704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:45.065392 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:45.065292 after 0.20 seconds
[0m06:02:45.065832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac71361cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac73303c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac6f711a00>]}
[0m06:02:45.066243 [debug] [MainThread]: Flushing usage events
[0m14:07:20.895836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f439313c620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4391ad9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4391ad9550>]}


============================== 14:07:20.911653 | 0a4366a0-ca75-4de0-9ebc-34707a9dfa23 ==============================
[0m14:07:20.911653 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:20.912385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:07:21.043162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a4366a0-ca75-4de0-9ebc-34707a9dfa23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f439114d220>]}
[0m14:07:21.059767 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-613_sft0'
[0m14:07:21.060292 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:07:21.177006 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:07:21.177798 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:07:21.199611 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:07:21.203545 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:07:21.276277 [info ] [MainThread]: Installed from version 1.2.0
[0m14:07:21.276860 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:07:21.277382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0a4366a0-ca75-4de0-9ebc-34707a9dfa23', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4390eba3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4390eb97c0>]}
[0m14:07:21.277821 [info ] [MainThread]: 
[0m14:07:21.278279 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:07:21.286831 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4423959, "process_user_time": 1.610632, "process_kernel_time": 0.156158, "process_mem_max_rss": "101756", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m14:07:21.287403 [debug] [MainThread]: Command `dbt deps` succeeded at 14:07:21.287296 after 0.44 seconds
[0m14:07:21.287826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43916a7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4391ada270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4391adb680>]}
[0m14:07:21.288264 [debug] [MainThread]: Flushing usage events
[0m14:07:22.938152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04cdab56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04cd43ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04cfbd6270>]}


============================== 14:07:22.941500 | 392012bf-2f5c-41f5-a310-7b000ca4f89d ==============================
[0m14:07:22.941500 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:22.942123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:07:23.146742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ccf972c0>]}
[0m14:07:23.207644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ccec1370>]}
[0m14:07:23.210433 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:07:23.233469 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:07:23.234175 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:07:23.234706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ccf3f1d0>]}
[0m14:07:24.543664 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:07:24.544404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c8af2030>]}
[0m14:07:24.791636 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:07:24.797598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c8a64a40>]}
[0m14:07:24.895900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c8b00b30>]}
[0m14:07:24.896522 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:07:24.897005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c8ae78f0>]}
[0m14:07:24.898959 [info ] [MainThread]: 
[0m14:07:24.899725 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:07:24.904571 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:07:24.940266 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:07:24.940814 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:07:24.941383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:26.644575 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:07:26.646426 [debug] [ThreadPool]: On list_petro: Close
[0m14:07:26.647550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:07:26.648173 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:07:26.657623 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:26.658217 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:07:26.658719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:26.660263 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:26.661705 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:26.662092 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:07:26.662677 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:26.663056 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:26.663467 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:07:26.664042 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:26.664993 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:26.665403 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:26.665765 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:26.666320 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:26.666723 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:07:26.668098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:07:26.674345 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:26.674753 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:07:26.675115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:26.675776 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:26.676159 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:26.676558 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:07:26.686309 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:26.687924 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:07:26.689254 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:07:26.689681 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:07:26.692080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c76389e0>]}
[0m14:07:26.692654 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:26.693038 [debug] [MainThread]: On master: BEGIN
[0m14:07:26.693428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:26.694150 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:26.694589 [debug] [MainThread]: On master: COMMIT
[0m14:07:26.694963 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:26.695370 [debug] [MainThread]: On master: COMMIT
[0m14:07:26.695935 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:26.696368 [debug] [MainThread]: On master: Close
[0m14:07:26.696923 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:07:26.697413 [info ] [MainThread]: 
[0m14:07:26.715952 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:07:26.716644 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:07:26.717275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:07:26.717711 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:07:26.745354 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:07:26.746288 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:07:26.783623 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:07:26.784601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:34.578553 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:34.579133 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:07:34.580027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.580512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:34.580923 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:07:34.581713 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.585092 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:34.585604 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:07:34.586362 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.603762 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:34.604348 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:34.604777 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:34.607188 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.613479 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:34.613980 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:07:34.615523 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.618123 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:07:34.619730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c77aef00>]}
[0m14:07:34.620471 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.90s]
[0m14:07:34.621210 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:07:34.622161 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:07:34.622757 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:07:34.623446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:07:34.623881 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:07:34.629179 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:07:34.629864 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:07:34.667363 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:34.667946 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250722140734661103"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:07:34.668432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:34.676760 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.685186 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:34.685723 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:07:34.686489 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.686931 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:34.687378 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250722140734661103'
      
      
      order by ordinal_position

  
[0m14:07:34.689768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.695534 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:34.696008 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:34.698532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.706651 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:34.707131 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:34.709913 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.728775 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:07:34.729618 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:34.730126 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250722140734661103"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250722140734661103"
    )
  
[0m14:07:34.780270 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.782338 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:34.782854 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:34.783340 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:34.790920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.792005 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:07:34.793609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f048a56b7a0>]}
[0m14:07:34.794357 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:07:34.795119 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:07:34.796815 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:34.797250 [debug] [MainThread]: On master: BEGIN
[0m14:07:34.797636 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:34.798355 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:34.798752 [debug] [MainThread]: On master: COMMIT
[0m14:07:34.799116 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:34.799504 [debug] [MainThread]: On master: COMMIT
[0m14:07:34.800048 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:34.800474 [debug] [MainThread]: On master: Close
[0m14:07:34.801096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:34.801511 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:07:34.801915 [info ] [MainThread]: 
[0m14:07:34.802412 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.90 seconds (9.90s).
[0m14:07:34.803376 [debug] [MainThread]: Command end result
[0m14:07:34.830088 [info ] [MainThread]: 
[0m14:07:34.830763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:34.831216 [info ] [MainThread]: 
[0m14:07:34.831728 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:07:34.832738 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.945209, "process_user_time": 6.507942, "process_kernel_time": 0.287439, "process_mem_max_rss": "341112", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m14:07:34.833321 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:34.833185 after 11.95 seconds
[0m14:07:34.833782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04cd0376b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04cedcd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f048b68aba0>]}
[0m14:07:34.834243 [debug] [MainThread]: Flushing usage events
[0m14:07:36.791925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd63279b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd7ac9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd6e77860>]}


============================== 14:07:36.795170 | dbca273d-0cbd-49fc-9e63-b4720f44b7a6 ==============================
[0m14:07:36.795170 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:36.795861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:07:36.906243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbca273d-0cbd-49fc-9e63-b4720f44b7a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd5ee8e60>]}
[0m14:07:36.924239 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18189058, "process_user_time": 1.391312, "process_kernel_time": 0.096952, "process_mem_max_rss": "100608", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:07:36.924783 [debug] [MainThread]: Command `dbt clean` succeeded at 14:07:36.924679 after 0.18 seconds
[0m14:07:36.925203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd7e2d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd61ab080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd5d100b0>]}
[0m14:07:36.925660 [debug] [MainThread]: Flushing usage events
[0m22:06:50.364171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe446aadcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe447d4f620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe446eaa060>]}


============================== 22:06:50.379200 | 2b3398c7-1038-4146-b171-b36df63aca59 ==============================
[0m22:06:50.379200 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:50.379888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:50.542166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b3398c7-1038-4146-b171-b36df63aca59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe446a539e0>]}
[0m22:06:50.557500 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-uwg9ty24'
[0m22:06:50.557965 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:50.718668 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:50.719345 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:50.758431 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:50.762431 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:50.937176 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:50.937771 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:50.938283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2b3398c7-1038-4146-b171-b36df63aca59', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe446bc49b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4467a63f0>]}
[0m22:06:50.938757 [info ] [MainThread]: 
[0m22:06:50.939222 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:50.947070 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6363378, "process_user_time": 1.617516, "process_kernel_time": 0.128677, "process_mem_max_rss": "101496", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m22:06:50.947633 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:50.947528 after 0.64 seconds
[0m22:06:50.948052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe446e651c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe446be5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe449651400>]}
[0m22:06:50.948479 [debug] [MainThread]: Flushing usage events
[0m22:06:52.601067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42811c8500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4281cb4200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4281cb6420>]}


============================== 22:06:52.604369 | 6b2b1cd1-d429-4a63-8a82-12caf6fa95b9 ==============================
[0m22:06:52.604369 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:52.605131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:52.809066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4281667c20>]}
[0m22:06:52.867764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4282fcce00>]}
[0m22:06:52.870311 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:52.892725 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:52.893446 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:52.893960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427d1a7e00>]}
[0m22:06:54.188306 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:54.188952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427ceb4e30>]}
[0m22:06:54.428005 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:54.433625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42812f2030>]}
[0m22:06:54.534153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427cee8050>]}
[0m22:06:54.534713 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:54.535174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427cf61520>]}
[0m22:06:54.536976 [info ] [MainThread]: 
[0m22:06:54.537659 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:54.542331 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:54.576552 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:54.576991 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:54.577368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:55.216989 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:55.218930 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:55.220208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:55.220902 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:55.229175 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:55.229649 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:55.230029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:55.231208 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:55.232616 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:55.233011 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:55.233643 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:55.234035 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:55.234427 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:55.235044 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:55.235986 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:55.236373 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:55.236758 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:55.237299 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:55.237729 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:55.239103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:55.245249 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:55.245689 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:55.246057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:55.246824 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:55.247214 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:55.247625 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:55.257519 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:55.259249 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:55.260568 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:55.260968 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:55.263407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427b8486b0>]}
[0m22:06:55.263929 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:55.264308 [debug] [MainThread]: On master: BEGIN
[0m22:06:55.264688 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:55.265404 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:55.265798 [debug] [MainThread]: On master: COMMIT
[0m22:06:55.266165 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:55.266539 [debug] [MainThread]: On master: COMMIT
[0m22:06:55.267052 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:55.267456 [debug] [MainThread]: On master: Close
[0m22:06:55.268016 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:55.268502 [info ] [MainThread]: 
[0m22:06:55.288242 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:55.288942 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:55.289636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:55.290079 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:55.317325 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:55.318228 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:55.353853 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:55.354772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:05.173302 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.173820 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:05.174487 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.174925 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.175359 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:05.176111 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.178982 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.179439 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:05.180103 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.196669 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:05.197136 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.197586 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:05.199435 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.205042 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.205508 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:05.206645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.208991 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:05.210542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427d0a1130>]}
[0m22:07:05.211220 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.92s]
[0m22:07:05.211983 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:05.212801 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:05.213553 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:05.214137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:05.214633 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:05.219517 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:05.220154 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:05.255669 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.256183 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250722220705249537"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:05.256653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:05.265194 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.272750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.273193 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:05.273821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.274249 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.274694 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250722220705249537'
      
      
      order by ordinal_position

  
[0m22:07:05.277064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.282186 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.282665 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:05.285366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.292909 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.293371 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:05.296002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.314008 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:05.314711 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.315156 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250722220705249537"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250722220705249537"
    )
  
[0m22:07:05.362010 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.364025 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:05.364484 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.364892 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:05.371726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.372622 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:05.374052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f423ee30b60>]}
[0m22:07:05.374742 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:07:05.375483 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:05.376865 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:05.377285 [debug] [MainThread]: On master: BEGIN
[0m22:07:05.377699 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:05.378334 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:05.378759 [debug] [MainThread]: On master: COMMIT
[0m22:07:05.379125 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:05.379514 [debug] [MainThread]: On master: COMMIT
[0m22:07:05.380017 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:05.380431 [debug] [MainThread]: On master: Close
[0m22:07:05.381024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:05.381412 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:05.381823 [info ] [MainThread]: 
[0m22:07:05.382301 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.84 seconds (10.84s).
[0m22:07:05.383257 [debug] [MainThread]: Command end result
[0m22:07:05.408869 [info ] [MainThread]: 
[0m22:07:05.409463 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:05.409946 [info ] [MainThread]: 
[0m22:07:05.410447 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:05.411445 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.860291, "process_user_time": 4.702354, "process_kernel_time": 0.272949, "process_mem_max_rss": "326452", "process_in_blocks": "1200", "process_out_blocks": "100136"}
[0m22:07:05.411986 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:05.411883 after 12.86 seconds
[0m22:07:05.412434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4284fcf0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4283d78c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f425a7bdd90>]}
[0m22:07:05.412857 [debug] [MainThread]: Flushing usage events
[0m22:07:07.308643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7041b3d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703f9b5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703f9b59a0>]}


============================== 22:07:07.311683 | 4cea2b1f-25a3-49f7-bf38-15dc81e3b5f2 ==============================
[0m22:07:07.311683 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:07.312300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:07.420164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cea2b1f-25a3-49f7-bf38-15dc81e3b5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703fbbb680>]}
[0m22:07:07.437840 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1777596, "process_user_time": 1.346972, "process_kernel_time": 0.097925, "process_mem_max_rss": "100784", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:07.438370 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:07.438268 after 0.18 seconds
[0m22:07:07.438819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7041b3d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703f913320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703f9d3110>]}
[0m22:07:07.439228 [debug] [MainThread]: Flushing usage events
[0m06:02:36.472259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3744095730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3744096420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37461b9340>]}


============================== 06:02:36.515791 | 19e8ed0f-c980-4182-aaec-48019be46fc9 ==============================
[0m06:02:36.515791 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:36.516495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:36.626822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19e8ed0f-c980-4182-aaec-48019be46fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374356b890>]}
[0m06:02:36.641590 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-udaga3dd'
[0m06:02:36.642051 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:36.828356 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:36.829010 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:36.885251 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:36.889012 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:37.023731 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:37.024338 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:37.024907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '19e8ed0f-c980-4182-aaec-48019be46fc9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3743281610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374339d820>]}
[0m06:02:37.025387 [info ] [MainThread]: 
[0m06:02:37.025892 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:37.055350 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6326236, "process_user_time": 1.578078, "process_kernel_time": 0.138655, "process_mem_max_rss": "101396", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m06:02:37.056016 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:37.055891 after 0.63 seconds
[0m06:02:37.056482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374397f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37436f1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3747bbb8f0>]}
[0m06:02:37.056908 [debug] [MainThread]: Flushing usage events
[0m06:02:38.676556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12dd9439b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12de0beab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12de0bcb00>]}


============================== 06:02:38.679616 | 0ee1797e-52e8-4f02-8a1d-7e0494000d12 ==============================
[0m06:02:38.679616 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:38.680268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:38.882391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d9510590>]}
[0m06:02:38.941561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12dd461ac0>]}
[0m06:02:38.944112 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:38.971852 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:38.972589 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:38.973115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12dd4629c0>]}
[0m06:02:40.281153 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:40.281783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d92f2810>]}
[0m06:02:40.509591 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:40.515053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12dd48eb70>]}
[0m06:02:40.619539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d92ba1e0>]}
[0m06:02:40.620099 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:40.620601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12df3d4b60>]}
[0m06:02:40.622446 [info ] [MainThread]: 
[0m06:02:40.623120 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:40.627858 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:40.663210 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:40.663659 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:40.664063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:41.136637 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:41.138826 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:41.140121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:41.140917 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:41.149093 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:41.149504 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:41.149877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:41.150830 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:41.152153 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:41.152539 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:41.153107 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:41.153484 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:41.153840 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:41.154451 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:41.155380 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:41.155767 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:41.156152 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:41.156676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:41.157098 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:41.158343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:41.163984 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:41.164486 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:41.164841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:41.165440 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:41.165816 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:41.166209 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:41.176583 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:41.178021 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:41.179264 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:41.179652 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:41.181825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d93dc2f0>]}
[0m06:02:41.182337 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:41.182705 [debug] [MainThread]: On master: BEGIN
[0m06:02:41.183073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:41.183674 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:41.184085 [debug] [MainThread]: On master: COMMIT
[0m06:02:41.184454 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:41.184803 [debug] [MainThread]: On master: COMMIT
[0m06:02:41.185353 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:41.185738 [debug] [MainThread]: On master: Close
[0m06:02:41.186270 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:41.186719 [info ] [MainThread]: 
[0m06:02:41.218722 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:41.219334 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:41.219898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:41.220355 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:41.247445 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:41.248195 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:41.283893 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:41.284638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:50.208489 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:50.208969 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:50.209633 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.210083 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:50.210500 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:50.211201 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.214079 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:50.214521 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:50.215186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.231999 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:50.232471 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:50.232884 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:50.234827 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.240533 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:50.240983 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:50.242204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.244549 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:50.246128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129b3d75c0>]}
[0m06:02:50.246792 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.03s]
[0m06:02:50.247620 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:50.248577 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:50.249152 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:50.249729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:50.250198 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:50.254998 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:50.255638 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:50.291764 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:50.292273 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250723060250285679"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:50.292721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:50.300541 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.308211 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:50.308663 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:50.309273 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.309703 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:50.310136 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250723060250285679'
      
      
      order by ordinal_position

  
[0m06:02:50.312206 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.317307 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:50.317755 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:50.320805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.328360 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:50.328815 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:50.331473 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.349502 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:50.350193 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:50.350639 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250723060250285679"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250723060250285679"
    )
  
[0m06:02:50.401692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.403644 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:50.404102 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:50.404513 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:50.412327 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.413227 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:50.414689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129b17a4e0>]}
[0m06:02:50.415367 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:50.416101 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:50.417681 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:50.418123 [debug] [MainThread]: On master: BEGIN
[0m06:02:50.418505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:50.419160 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:50.419553 [debug] [MainThread]: On master: COMMIT
[0m06:02:50.419917 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:50.420324 [debug] [MainThread]: On master: COMMIT
[0m06:02:50.420876 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:50.421316 [debug] [MainThread]: On master: Close
[0m06:02:50.421874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:50.422256 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:50.422643 [info ] [MainThread]: 
[0m06:02:50.423125 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.80 seconds (9.80s).
[0m06:02:50.424019 [debug] [MainThread]: Command end result
[0m06:02:50.449547 [info ] [MainThread]: 
[0m06:02:50.450111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:50.450563 [info ] [MainThread]: 
[0m06:02:50.451016 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:50.451931 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.824217, "process_user_time": 5.125092, "process_kernel_time": 0.285172, "process_mem_max_rss": "340624", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:50.452518 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:50.452404 after 11.82 seconds
[0m06:02:50.452948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12dd5d3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d92b9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12dda6e2d0>]}
[0m06:02:50.453404 [debug] [MainThread]: Flushing usage events
[0m06:02:52.296335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ffa03d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ff8b85340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ff8c24d40>]}


============================== 06:02:52.299396 | 47531cf3-7f42-4374-971d-ae379373a9e5 ==============================
[0m06:02:52.299396 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:52.300078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:52.407075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47531cf3-7f42-4374-971d-ae379373a9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ff7f403e0>]}
[0m06:02:52.424595 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17734756, "process_user_time": 1.346114, "process_kernel_time": 0.097008, "process_mem_max_rss": "100464", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:52.425146 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:52.425026 after 0.18 seconds
[0m06:02:52.425560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ff8469070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ff7f8dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ff7f43ec0>]}
[0m06:02:52.425984 [debug] [MainThread]: Flushing usage events
[0m14:07:18.915250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514ffca540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514fce77a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5150f53380>]}


============================== 14:07:18.923302 | ba93f765-6ffd-4af8-81a3-64bd1fcb152d ==============================
[0m14:07:18.923302 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:18.923985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:19.072110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba93f765-6ffd-4af8-81a3-64bd1fcb152d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514fd39220>]}
[0m14:07:19.087489 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1vapll7a'
[0m14:07:19.087970 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:07:19.282903 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:07:19.283672 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:07:19.307687 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:07:19.311592 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:07:19.382771 [info ] [MainThread]: Installed from version 1.2.0
[0m14:07:19.383290 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:07:19.383796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ba93f765-6ffd-4af8-81a3-64bd1fcb152d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514f90b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514f90b350>]}
[0m14:07:19.384259 [info ] [MainThread]: 
[0m14:07:19.384733 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:07:19.386127 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.52021575, "process_user_time": 1.588072, "process_kernel_time": 0.116005, "process_mem_max_rss": "101600", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m14:07:19.386713 [debug] [MainThread]: Command `dbt deps` succeeded at 14:07:19.386599 after 0.52 seconds
[0m14:07:19.387128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51502406e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514fd39220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5150b60f20>]}
[0m14:07:19.387569 [debug] [MainThread]: Flushing usage events
[0m14:07:21.008220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd742ae05c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd742c23ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd743087410>]}


============================== 14:07:21.011375 | 5ce67fc7-a5f5-4014-a037-4a42df48db11 ==============================
[0m14:07:21.011375 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:21.012004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:21.215237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74476eff0>]}
[0m14:07:21.274549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7438d0740>]}
[0m14:07:21.277218 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:07:21.293000 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:07:21.293712 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:07:21.294245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd743e3b680>]}
[0m14:07:22.593742 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:07:22.594407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd73e4fef60>]}
[0m14:07:22.830470 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:07:22.836094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd73e42f8c0>]}
[0m14:07:22.981606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd73e7fd010>]}
[0m14:07:22.982181 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:07:22.982733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7469b81a0>]}
[0m14:07:22.984636 [info ] [MainThread]: 
[0m14:07:22.985383 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:07:22.990182 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:07:23.025557 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:07:23.026032 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:07:23.026445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:23.537955 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:07:23.539914 [debug] [ThreadPool]: On list_petro: Close
[0m14:07:23.540924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:07:23.541515 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:07:23.548846 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:23.549301 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:07:23.549685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:23.550601 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:23.551936 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:23.552370 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:07:23.552954 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:23.553397 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:23.553767 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:07:23.554405 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:23.555357 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:23.555748 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:23.556110 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:23.556655 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:23.557047 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:07:23.558366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:07:23.564351 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:23.564745 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:07:23.565098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:23.565828 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:23.566232 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:23.566606 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:07:23.575730 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:23.577170 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:07:23.578406 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:07:23.578795 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:07:23.581104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7447cd010>]}
[0m14:07:23.581644 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:23.582029 [debug] [MainThread]: On master: BEGIN
[0m14:07:23.582436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:23.583046 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:23.583488 [debug] [MainThread]: On master: COMMIT
[0m14:07:23.583875 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:23.584260 [debug] [MainThread]: On master: COMMIT
[0m14:07:23.584823 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:23.585261 [debug] [MainThread]: On master: Close
[0m14:07:23.585789 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:07:23.586282 [info ] [MainThread]: 
[0m14:07:23.597473 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:07:23.598052 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:07:23.598699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:07:23.599135 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:07:23.626219 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:07:23.626959 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:07:23.662378 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:07:23.663168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:32.527777 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:32.528333 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:07:32.528978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.529438 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:32.529851 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:07:32.530602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.533537 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:32.533972 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:07:32.534655 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.551272 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:32.551726 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:32.552139 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:32.553917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.559604 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:32.560053 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:07:32.561231 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.563561 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:07:32.565081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7434b4950>]}
[0m14:07:32.565780 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.97s]
[0m14:07:32.566538 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:07:32.567433 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:07:32.568078 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:07:32.568695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:07:32.569124 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:07:32.574122 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:07:32.574795 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:07:32.610572 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:32.611056 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250723140732604568"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:07:32.611520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:32.619523 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.626980 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:32.627451 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:07:32.628041 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.628492 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:32.628916 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250723140732604568'
      
      
      order by ordinal_position

  
[0m14:07:32.631691 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.636785 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:32.637251 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:32.639432 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.647062 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:32.647534 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:32.649625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.667488 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:07:32.668158 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:32.668630 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250723140732604568"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250723140732604568"
    )
  
[0m14:07:32.718557 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.720597 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:32.721061 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:32.721493 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:32.729130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.730063 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:07:32.731561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd70451dc10>]}
[0m14:07:32.732259 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:07:32.733047 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:07:32.734679 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:32.735099 [debug] [MainThread]: On master: BEGIN
[0m14:07:32.735521 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:32.736244 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:32.736648 [debug] [MainThread]: On master: COMMIT
[0m14:07:32.737028 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:32.737435 [debug] [MainThread]: On master: COMMIT
[0m14:07:32.737991 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:32.738423 [debug] [MainThread]: On master: Close
[0m14:07:32.739021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:32.739432 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:07:32.739838 [info ] [MainThread]: 
[0m14:07:32.740360 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.75 seconds (9.75s).
[0m14:07:32.741383 [debug] [MainThread]: Command end result
[0m14:07:32.769012 [info ] [MainThread]: 
[0m14:07:32.769668 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:32.770174 [info ] [MainThread]: 
[0m14:07:32.770725 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:07:32.771728 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.812803, "process_user_time": 4.657773, "process_kernel_time": 0.277867, "process_mem_max_rss": "329464", "process_in_blocks": "1200", "process_out_blocks": "100096"}
[0m14:07:32.772300 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:32.772169 after 11.81 seconds
[0m14:07:32.772751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7435931a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd742a15e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd743a4e240>]}
[0m14:07:32.773182 [debug] [MainThread]: Flushing usage events
[0m14:07:34.662934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f558516eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55856efa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5585de9220>]}


============================== 14:07:34.666709 | e49ec558-db68-4218-bb75-a43307d5d2c5 ==============================
[0m14:07:34.666709 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:34.667407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:34.777590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e49ec558-db68-4218-bb75-a43307d5d2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5584c87950>]}
[0m14:07:34.797447 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18545283, "process_user_time": 1.386899, "process_kernel_time": 0.109912, "process_mem_max_rss": "100492", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:07:34.798045 [debug] [MainThread]: Command `dbt clean` succeeded at 14:07:34.797936 after 0.19 seconds
[0m14:07:34.798560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5584fa4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5584a6f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5584a6c140>]}
[0m14:07:34.799007 [debug] [MainThread]: Flushing usage events
[0m22:06:35.931638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d443f0da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d43a17560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d43a49310>]}


============================== 22:06:35.956929 | e08714fe-6057-4b5c-9b79-11ffe9bac998 ==============================
[0m22:06:35.956929 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:35.957587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:36.086489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e08714fe-6057-4b5c-9b79-11ffe9bac998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d438ddd90>]}
[0m22:06:36.101913 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-paa5t2ek'
[0m22:06:36.102390 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:36.173200 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:36.173874 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:36.187038 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:36.190915 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:36.414584 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:36.415204 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:36.415759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e08714fe-6057-4b5c-9b79-11ffe9bac998', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d436f8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d44914380>]}
[0m22:06:36.416247 [info ] [MainThread]: 
[0m22:06:36.416745 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:36.421988 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5406629, "process_user_time": 1.567968, "process_kernel_time": 0.14847, "process_mem_max_rss": "101628", "process_in_blocks": "8496", "process_out_blocks": "5168"}
[0m22:06:36.422541 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:36.422437 after 0.54 seconds
[0m22:06:36.423017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d43a94f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d43d774a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d436341a0>]}
[0m22:06:36.423478 [debug] [MainThread]: Flushing usage events
[0m22:06:38.330726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46982b4ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4698f43620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4698f405f0>]}


============================== 22:06:38.333935 | 4cea4784-ab65-48ba-a2eb-8ee439206eac ==============================
[0m22:06:38.333935 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:38.334616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:38.539185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46982b4560>]}
[0m22:06:38.598887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46980dd460>]}
[0m22:06:38.601672 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:38.663868 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:38.664613 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:38.665164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46980621b0>]}
[0m22:06:39.961670 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:39.962325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46941b1ac0>]}
[0m22:06:40.195257 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:40.200826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46993d19d0>]}
[0m22:06:40.316271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4693ee5610>]}
[0m22:06:40.316876 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:40.317356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4693edbbf0>]}
[0m22:06:40.319246 [info ] [MainThread]: 
[0m22:06:40.319957 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:40.324769 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:40.360130 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:40.360622 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:40.361037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:40.870754 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:40.872776 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:40.873839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:40.874489 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:40.883271 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:40.883803 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:40.884302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:40.885519 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:40.887130 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:40.887605 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:40.888289 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:40.888693 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:40.889066 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:40.889713 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:40.890710 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:40.891166 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:40.891532 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:40.892090 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:40.892485 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:40.893714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:40.899325 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:40.899831 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:40.900190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:40.900792 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:40.901182 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:40.901554 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:40.911788 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:40.913281 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:40.914550 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:40.914982 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:40.917167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4699fd5070>]}
[0m22:06:40.917689 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:40.918076 [debug] [MainThread]: On master: BEGIN
[0m22:06:40.918428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:40.919083 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:40.919471 [debug] [MainThread]: On master: COMMIT
[0m22:06:40.919883 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:40.920235 [debug] [MainThread]: On master: COMMIT
[0m22:06:40.920764 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:40.921148 [debug] [MainThread]: On master: Close
[0m22:06:40.921692 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:40.922166 [info ] [MainThread]: 
[0m22:06:40.953767 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:40.954432 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:40.955135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:40.955576 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:40.982863 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:40.983629 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:41.019485 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:41.020438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:51.915889 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:51.916424 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:51.917156 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:51.917604 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:51.918065 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:51.918881 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:51.922003 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:51.922445 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:51.923169 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:51.940233 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:51.940837 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:51.941277 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:51.944113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:51.950402 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:51.950892 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:51.952749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:51.955334 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:51.956999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4699f76240>]}
[0m22:06:51.957759 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.00s]
[0m22:06:51.958603 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:51.959587 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:51.960230 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:51.960932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:51.961385 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:51.966817 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:51.967595 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:52.005185 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:52.005796 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250723220651998935"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:52.006294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:52.014614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:52.022715 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:52.023189 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:52.023848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:52.024295 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:52.024742 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250723220651998935'
      
      
      order by ordinal_position

  
[0m22:06:52.027071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:52.032424 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:52.032918 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:52.035102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:52.042945 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:52.043417 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:52.045891 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:52.064131 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:52.064857 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:52.065320 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250723220651998935"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250723220651998935"
    )
  
[0m22:06:52.112778 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:52.114786 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:52.115268 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:52.115703 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:52.123612 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:52.124551 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:52.126137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4659bcd7c0>]}
[0m22:06:52.126859 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:06:52.127687 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:52.129051 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:52.129464 [debug] [MainThread]: On master: BEGIN
[0m22:06:52.129869 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:52.130572 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:52.130999 [debug] [MainThread]: On master: COMMIT
[0m22:06:52.131381 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:52.131783 [debug] [MainThread]: On master: COMMIT
[0m22:06:52.132379 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:52.132819 [debug] [MainThread]: On master: Close
[0m22:06:52.133490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:52.133883 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:52.134282 [info ] [MainThread]: 
[0m22:06:52.134818 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.81 seconds (11.81s).
[0m22:06:52.135864 [debug] [MainThread]: Command end result
[0m22:06:52.162111 [info ] [MainThread]: 
[0m22:06:52.162750 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:52.163266 [info ] [MainThread]: 
[0m22:06:52.163809 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:52.164846 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.883757, "process_user_time": 5.191595, "process_kernel_time": 0.296262, "process_mem_max_rss": "342048", "process_in_blocks": "1200", "process_out_blocks": "100152"}
[0m22:06:52.165406 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:52.165299 after 13.88 seconds
[0m22:06:52.165871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4698278440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46982dd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46988106b0>]}
[0m22:06:52.166298 [debug] [MainThread]: Flushing usage events
[0m22:06:54.300218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b7875c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b7c67560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ba3511f0>]}


============================== 22:06:54.303441 | 78fca6ee-acd7-4c2e-8799-b2b2c137f74c ==============================
[0m22:06:54.303441 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:54.304118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:54.413776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78fca6ee-acd7-4c2e-8799-b2b2c137f74c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b8065340>]}
[0m22:06:54.433292 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1826777, "process_user_time": 1.334405, "process_kernel_time": 0.114948, "process_mem_max_rss": "100512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:54.433856 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:54.433749 after 0.18 seconds
[0m22:06:54.434276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b7db6f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b8065340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b8042a80>]}
[0m22:06:54.434727 [debug] [MainThread]: Flushing usage events
[0m06:02:22.327774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7aeab0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7b894530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7aea8560>]}


============================== 06:02:22.353533 | 35c78dfb-569b-4f37-ba9c-d270de0496fd ==============================
[0m06:02:22.353533 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:22.354242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:22.467671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35c78dfb-569b-4f37-ba9c-d270de0496fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7a8c3ef0>]}
[0m06:02:22.483678 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-86l25xi5'
[0m06:02:22.484195 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:22.561715 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:22.562477 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:22.575230 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:22.579401 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:22.714316 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:22.715049 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:22.715728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '35c78dfb-569b-4f37-ba9c-d270de0496fd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7aa4b560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7a8d33e0>]}
[0m06:02:22.716228 [info ] [MainThread]: 
[0m06:02:22.716786 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:22.723447 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44766167, "process_user_time": 1.640229, "process_kernel_time": 0.152113, "process_mem_max_rss": "101368", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m06:02:22.724032 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:22.723918 after 0.45 seconds
[0m06:02:22.724496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7b894530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7aef5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7b414140>]}
[0m06:02:22.724936 [debug] [MainThread]: Flushing usage events
[0m06:02:24.485306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fdc82d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fd2dd670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fe4be300>]}


============================== 06:02:24.488530 | dcb821ab-1570-4426-baa8-61cd464eb64f ==============================
[0m06:02:24.488530 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.489196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.694797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f910c3e0>]}
[0m06:02:24.755478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fd1fb4a0>]}
[0m06:02:24.758382 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:24.788698 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:24.789521 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:24.790075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f91178f0>]}
[0m06:02:26.124195 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:26.124878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f8e26f90>]}
[0m06:02:26.381778 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:26.388159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f8e55520>]}
[0m06:02:26.506077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f8ec17f0>]}
[0m06:02:26.506701 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:26.507196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f8fc7d40>]}
[0m06:02:26.509238 [info ] [MainThread]: 
[0m06:02:26.509975 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:26.515182 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:26.551207 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:26.551750 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:26.552135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:26.871165 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.873107 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:26.874303 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:26.874973 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:26.884734 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.885165 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:26.885591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:26.886984 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.888384 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.888794 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:26.889464 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.889849 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.890216 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:26.890842 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.891803 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:26.892193 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.892587 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:26.893117 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.893567 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:26.894917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:26.901028 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:26.901571 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:26.901940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:26.902618 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.903011 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:26.903380 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:26.913492 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.915236 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:26.916548 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:26.916936 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:26.919230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f90c14f0>]}
[0m06:02:26.919765 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.920146 [debug] [MainThread]: On master: BEGIN
[0m06:02:26.920527 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:26.921201 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.921633 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.922007 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.922360 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.922902 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.923291 [debug] [MainThread]: On master: Close
[0m06:02:26.923874 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:26.924338 [info ] [MainThread]: 
[0m06:02:26.958998 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:26.959731 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:26.960372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:26.960840 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:26.988371 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:26.989319 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:27.025756 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:27.026723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:35.753617 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.754148 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:35.754878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.755310 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.755748 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:35.756532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.759663 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.760109 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:35.760900 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.778061 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:35.778636 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.779059 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:35.781079 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.787208 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.787688 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:35.789090 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.791586 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:35.793225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77bad65730>]}
[0m06:02:35.793966 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.83s]
[0m06:02:35.794754 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:35.795690 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:35.796361 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:35.797064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:35.797526 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:35.802939 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:35.803657 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:35.853049 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.853954 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250724060235843763"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:35.854702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:35.866162 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.876547 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.877050 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:35.877809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.878251 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.878713 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250724060235843763'
      
      
      order by ordinal_position

  
[0m06:02:35.881137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.886881 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.887367 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:35.890307 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.898647 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.899140 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:35.901657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.920612 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:35.921442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.921908 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250724060235843763"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250724060235843763"
    )
  
[0m06:02:35.968717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.970753 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:35.971194 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.971624 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:35.980717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.981786 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:35.983384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77bbdab530>]}
[0m06:02:35.984100 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.19s]
[0m06:02:35.984928 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:35.986315 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:35.986775 [debug] [MainThread]: On master: BEGIN
[0m06:02:35.987152 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:35.987904 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:35.988301 [debug] [MainThread]: On master: COMMIT
[0m06:02:35.988704 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:35.989066 [debug] [MainThread]: On master: COMMIT
[0m06:02:35.989633 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:35.990026 [debug] [MainThread]: On master: Close
[0m06:02:35.990635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:35.991010 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:35.991453 [info ] [MainThread]: 
[0m06:02:35.991960 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.48 seconds (9.48s).
[0m06:02:35.992930 [debug] [MainThread]: Command end result
[0m06:02:36.019911 [info ] [MainThread]: 
[0m06:02:36.020588 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:36.021067 [info ] [MainThread]: 
[0m06:02:36.021581 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:36.022662 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.588552, "process_user_time": 5.18894, "process_kernel_time": 0.291108, "process_mem_max_rss": "341296", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:36.023205 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:36.023102 after 11.59 seconds
[0m06:02:36.023680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fdc82d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77bbdab530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f8f8dd60>]}
[0m06:02:36.024107 [debug] [MainThread]: Flushing usage events
[0m06:02:38.069624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09def1c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09def12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09de701d0>]}


============================== 06:02:38.072857 | 7d69c830-c446-4dc7-b93b-1dac0f0085f7 ==============================
[0m06:02:38.072857 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:38.073569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:38.182728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d69c830-c446-4dc7-b93b-1dac0f0085f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09efc81a0>]}
[0m06:02:38.201238 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1813607, "process_user_time": 1.378889, "process_kernel_time": 0.117905, "process_mem_max_rss": "100648", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:38.201842 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:38.201736 after 0.18 seconds
[0m06:02:38.202278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09e3dfdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09e191070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09dc7fec0>]}
[0m06:02:38.202735 [debug] [MainThread]: Flushing usage events
[0m14:07:02.178089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e2f9efe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e2fbb43e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e2fbb6cc0>]}


============================== 14:07:02.236828 | 28717da5-7b7e-4a88-95dd-404cec5330be ==============================
[0m14:07:02.236828 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:02.237568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:02.361410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28717da5-7b7e-4a88-95dd-404cec5330be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e2ecc5550>]}
[0m14:07:02.377908 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-b4rm277v'
[0m14:07:02.378446 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:07:02.496980 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:07:02.497744 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:07:02.521325 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:07:02.525342 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:07:02.598143 [info ] [MainThread]: Installed from version 1.2.0
[0m14:07:02.598739 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:07:02.599362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '28717da5-7b7e-4a88-95dd-404cec5330be', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e2ff10500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e30b0a7b0>]}
[0m14:07:02.599862 [info ] [MainThread]: 
[0m14:07:02.600385 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:07:02.606410 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47777846, "process_user_time": 1.5529, "process_kernel_time": 0.157888, "process_mem_max_rss": "101876", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m14:07:02.606995 [debug] [MainThread]: Command `dbt deps` succeeded at 14:07:02.606885 after 0.48 seconds
[0m14:07:02.607428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e2fd67bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e331d4800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e2fbb6cc0>]}
[0m14:07:02.607877 [debug] [MainThread]: Flushing usage events
[0m14:07:04.268576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93ce1823f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93ce14af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93ce14b890>]}


============================== 14:07:04.271833 | c46a9e90-31b7-45f5-b2f4-e705e97070e1 ==============================
[0m14:07:04.271833 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:04.272582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:04.476466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cd3eec30>]}
[0m14:07:04.536025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cf4b1100>]}
[0m14:07:04.538678 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:07:04.563857 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:07:04.564567 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:07:04.565095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cd579df0>]}
[0m14:07:05.869658 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:07:05.870319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93c93636e0>]}
[0m14:07:06.106635 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:07:06.112225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93d0477980>]}
[0m14:07:06.228525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93c93f53d0>]}
[0m14:07:06.229114 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:07:06.229629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93d15b81a0>]}
[0m14:07:06.231523 [info ] [MainThread]: 
[0m14:07:06.232256 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:07:06.236976 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:07:06.272582 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:07:06.273108 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:07:06.273534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:06.627099 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:06.628947 [debug] [ThreadPool]: On list_petro: Close
[0m14:07:06.630117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:07:06.630734 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:07:06.639010 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:06.639492 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:07:06.639930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:06.640986 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:06.642768 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:06.643288 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:07:06.644249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:06.644649 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:06.645062 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:07:06.645680 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:06.646786 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:06.647406 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:06.647975 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:06.648748 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:06.649331 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:07:06.650786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:07:06.656968 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:06.657378 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:07:06.657753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:06.658420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:06.658810 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:06.659226 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:07:06.669254 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:06.670714 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:07:06.671966 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:07:06.672367 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:07:06.674635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93c7d6e4e0>]}
[0m14:07:06.675151 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:06.675524 [debug] [MainThread]: On master: BEGIN
[0m14:07:06.675897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:06.676498 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:06.676924 [debug] [MainThread]: On master: COMMIT
[0m14:07:06.677297 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:06.677672 [debug] [MainThread]: On master: COMMIT
[0m14:07:06.678257 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:06.678646 [debug] [MainThread]: On master: Close
[0m14:07:06.679204 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:07:06.679699 [info ] [MainThread]: 
[0m14:07:06.699916 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:07:06.700505 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:07:06.701152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:07:06.701596 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:07:06.728410 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:07:06.729175 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:07:06.764510 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:07:06.765280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:13.115154 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:13.115646 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:07:13.116330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.116769 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:13.117221 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:07:13.117917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.120808 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:13.121270 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:07:13.121980 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.138825 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:13.139305 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:13.139731 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:13.141025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.146714 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:13.147187 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:07:13.148336 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.150694 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:07:13.152280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93c93198e0>]}
[0m14:07:13.152989 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.45s]
[0m14:07:13.153743 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:07:13.154698 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:07:13.155277 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:07:13.155899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:07:13.156341 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:07:13.161271 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:07:13.161930 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:07:13.197986 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:13.198504 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250724140713191810"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:07:13.198981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:13.207172 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.215162 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:13.215627 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:07:13.216301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.216737 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:13.217202 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250724140713191810'
      
      
      order by ordinal_position

  
[0m14:07:13.219507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.224767 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:13.225252 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:13.227701 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.235780 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:13.236346 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:13.238570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.257050 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:07:13.257761 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:13.258235 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250724140713191810"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250724140713191810"
    )
  
[0m14:07:13.308139 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.310248 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:13.310747 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:13.311216 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:13.319088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.320122 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:07:13.321671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938b2d1520>]}
[0m14:07:13.322397 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:07:13.323174 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:07:13.324721 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:13.325172 [debug] [MainThread]: On master: BEGIN
[0m14:07:13.325543 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:13.326303 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:13.326696 [debug] [MainThread]: On master: COMMIT
[0m14:07:13.327106 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:13.327464 [debug] [MainThread]: On master: COMMIT
[0m14:07:13.327991 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:13.328384 [debug] [MainThread]: On master: Close
[0m14:07:13.329003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:13.329377 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:07:13.329778 [info ] [MainThread]: 
[0m14:07:13.330277 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.10 seconds (7.10s).
[0m14:07:13.331230 [debug] [MainThread]: Command end result
[0m14:07:13.358817 [info ] [MainThread]: 
[0m14:07:13.359559 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:13.360146 [info ] [MainThread]: 
[0m14:07:13.360684 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:07:13.361752 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.143076, "process_user_time": 4.694747, "process_kernel_time": 0.286289, "process_mem_max_rss": "325044", "process_in_blocks": "1200", "process_out_blocks": "100096"}
[0m14:07:13.362345 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:13.362235 after 9.14 seconds
[0m14:07:13.362798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cd7bd5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938b281430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cd77a3c0>]}
[0m14:07:13.363265 [debug] [MainThread]: Flushing usage events
[0m14:07:15.283879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd7b3335f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd7ad8b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd7b6591c0>]}


============================== 14:07:15.287111 | 79268778-ad0f-4a60-bb66-983daa7d1555 ==============================
[0m14:07:15.287111 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:15.287757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:15.396610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79268778-ad0f-4a60-bb66-983daa7d1555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd7a8c7980>]}
[0m14:07:15.415007 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18095037, "process_user_time": 1.359756, "process_kernel_time": 0.11098, "process_mem_max_rss": "100488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:07:15.415548 [debug] [MainThread]: Command `dbt clean` succeeded at 14:07:15.415444 after 0.18 seconds
[0m14:07:15.416004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd7b4b6a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd7c76b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd7a922120>]}
[0m14:07:15.416427 [debug] [MainThread]: Flushing usage events
