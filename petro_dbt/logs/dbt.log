[0m06:02:09.649918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92fad8e7b0>]}
[0m06:02:09.651722 [info ] [MainThread]: 
[0m06:02:09.652425 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:09.657165 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:09.692544 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:09.693029 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:09.693441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:10.261445 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:10.263007 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:10.265159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:10.265719 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:10.272928 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.273363 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:10.273763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.280185 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.281687 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.282088 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:10.282625 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.283017 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.283390 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:10.283977 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.284929 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.285331 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.285703 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.286238 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.286642 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:10.288539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:10.295660 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.296071 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:10.296485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.302644 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.303059 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.303459 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:10.327573 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.329185 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:10.330451 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:10.330870 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:10.334493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9303b80dd0>]}
[0m06:02:10.335038 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.335437 [debug] [MainThread]: On master: BEGIN
[0m06:02:10.335813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:10.342252 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.342680 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.343067 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.343443 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.343976 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.344414 [debug] [MainThread]: On master: Close
[0m06:02:10.345736 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:10.346281 [info ] [MainThread]: 
[0m06:02:10.372933 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:10.373536 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:10.374273 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:10.374721 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:10.400593 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:10.401345 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:10.436877 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:10.437661 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:18.192676 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.193188 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:18.193857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.194307 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.194739 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:18.195442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.198374 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.198855 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:18.199531 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.220328 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:18.220827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.221263 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:18.223188 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.228133 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.228625 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:18.229823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.232119 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:18.261362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93034fe930>]}
[0m06:02:18.262116 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.89s]
[0m06:02:18.262874 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:18.263886 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:18.264490 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:18.265076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:18.265531 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:18.270840 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:18.271496 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:18.305170 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.305686 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241027060218299187"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:18.306159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:18.320021 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.327426 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.327886 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:18.328570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.329034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.329476 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241027060218299187'
      
      
      order by ordinal_position

  
[0m06:02:18.349766 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.356284 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.356796 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:18.360937 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.368443 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.368929 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:18.371629 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.389509 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:18.390200 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.390664 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241027060218299187"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241027060218299187"
    )
  
[0m06:02:18.422636 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.424602 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:18.425070 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.425492 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:18.433663 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.434559 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:18.626046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92b79650d0>]}
[0m06:02:18.626860 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m06:02:18.627614 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:18.629128 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.629594 [debug] [MainThread]: On master: BEGIN
[0m06:02:18.630015 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:18.637134 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.637802 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.638440 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.639067 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.639938 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.640626 [debug] [MainThread]: On master: Close
[0m06:02:18.642446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:18.642881 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:18.643278 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:18.643731 [info ] [MainThread]: 
[0m06:02:18.644274 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.99 seconds (8.99s).
[0m06:02:18.645340 [debug] [MainThread]: Command end result
[0m06:02:18.673207 [info ] [MainThread]: 
[0m06:02:18.673854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:18.674389 [info ] [MainThread]: 
[0m06:02:18.674937 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:18.675949 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.988357, "process_user_time": 5.635993, "process_kernel_time": 0.319999, "process_mem_max_rss": "291348", "process_in_blocks": "3808", "process_out_blocks": "116200"}
[0m06:02:18.676626 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:18.676515 after 10.99 seconds
[0m06:02:18.677137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9303398590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92fad60f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9302a747d0>]}
[0m06:02:18.677620 [debug] [MainThread]: Flushing usage events
[0m06:02:20.358883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b792570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97c0c0a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97c0c3b60>]}


============================== 06:02:20.361679 | 4262b812-ebd9-4f29-9045-c1575eadd653 ==============================
[0m06:02:20.361679 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:20.362399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:20.503733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4262b812-ebd9-4f29-9045-c1575eadd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b6f6b40>]}
[0m06:02:20.520439 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20978114, "process_user_time": 1.4195, "process_kernel_time": 0.087969, "process_mem_max_rss": "92276", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:20.521010 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:20.520908 after 0.21 seconds
[0m06:02:20.521433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97ba5f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b5b2960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b5b1070>]}
[0m06:02:20.521850 [debug] [MainThread]: Flushing usage events
[0m14:05:16.133926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa339460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa45a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa33bf20>]}


============================== 14:05:16.141725 | 78023bc8-b36b-4e15-8dbb-9e1204979c39 ==============================
[0m14:05:16.141725 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:16.142500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:16.286222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78023bc8-b36b-4e15-8dbb-9e1204979c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa00b260>]}
[0m14:05:16.299845 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-099ghjmk'
[0m14:05:16.300322 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:16.326602 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:16.327230 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:16.338031 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:16.341870 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:16.557757 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:16.558339 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:16.558902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '78023bc8-b36b-4e15-8dbb-9e1204979c39', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa1a2c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ea9f03d10>]}
[0m14:05:16.559370 [info ] [MainThread]: 
[0m14:05:16.559857 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:16.561652 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47698292, "process_user_time": 1.583668, "process_kernel_time": 0.134611, "process_mem_max_rss": "93512", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:16.562249 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:16.562145 after 0.48 seconds
[0m14:05:16.562742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa3371d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa1dc500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eab1b6b40>]}
[0m14:05:16.563165 [debug] [MainThread]: Flushing usage events
[0m14:05:18.540090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f6a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f7320>]}


============================== 14:05:18.543201 | cefd4d58-25b2-4a5b-9398-c93bead4f291 ==============================
[0m14:05:18.543201 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:18.543966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:18.793095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2298e660>]}
[0m14:05:18.853624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e29865af0>]}
[0m14:05:18.856407 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:18.931958 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:18.932772 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:18.933327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e298b3800>]}
[0m14:05:20.175385 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:20.176098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e227d0350>]}
[0m14:05:20.363487 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:20.369172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e227331d0>]}
[0m14:05:20.510975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2218fb90>]}
[0m14:05:20.511585 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:20.512131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e222e19a0>]}
[0m14:05:20.514002 [info ] [MainThread]: 
[0m14:05:20.514805 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:20.519774 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:20.556651 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:20.557188 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:20.557627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:21.007736 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.009411 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:21.011778 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:21.012363 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:21.019736 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.020177 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:21.020622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:21.027359 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.028853 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.029264 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:21.029826 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.030221 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.030640 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:21.031213 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.032133 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:21.032551 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.032925 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:21.033465 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.033873 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:21.036016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:21.043578 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:21.043991 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:21.044366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:21.050268 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.050726 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:21.051125 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:21.075283 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.077179 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:21.078596 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:21.079048 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:21.083255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2bf11340>]}
[0m14:05:21.083816 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.084226 [debug] [MainThread]: On master: BEGIN
[0m14:05:21.084617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:21.091686 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.092129 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.092543 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.092930 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.093567 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.093987 [debug] [MainThread]: On master: Close
[0m14:05:21.095895 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:21.096411 [info ] [MainThread]: 
[0m14:05:21.106564 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:21.107237 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:21.107981 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:21.108445 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:21.135946 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:21.136902 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:21.174126 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:21.175093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:30.068868 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.069469 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:30.070311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.070822 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.071273 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:30.072130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.075574 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.076049 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:30.076828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.100428 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.101171 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.101686 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.114045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.120552 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.121056 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:30.145156 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.149021 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:30.208242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e221b8a70>]}
[0m14:05:30.209234 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.10s]
[0m14:05:30.210238 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:30.211494 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:30.212410 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:30.213314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:30.213879 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:30.223198 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:30.224161 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:30.268421 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.269063 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241027140530261605"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:30.269580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:30.287902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.296323 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.296837 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:30.297567 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.298034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.298505 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241027140530261605'
      
      
      order by ordinal_position

  
[0m14:05:30.323366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.334147 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.334937 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.339807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.351373 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.351860 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.354832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.373289 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:30.374027 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.374561 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241027140530261605"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241027140530261605"
    )
  
[0m14:05:30.411051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.413283 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.413799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.414246 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.561348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.562508 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:30.754709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de2d56b40>]}
[0m14:05:30.755538 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.54s]
[0m14:05:30.756296 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:30.757739 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:30.758217 [debug] [MainThread]: On master: BEGIN
[0m14:05:30.758757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:30.765582 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:30.766063 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.766542 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:30.766967 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.767586 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:30.768038 [debug] [MainThread]: On master: Close
[0m14:05:30.769509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:30.769940 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:30.770339 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:30.770884 [info ] [MainThread]: 
[0m14:05:30.771481 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.26 seconds (10.26s).
[0m14:05:30.772614 [debug] [MainThread]: Command end result
[0m14:05:30.801005 [info ] [MainThread]: 
[0m14:05:30.801753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:30.802365 [info ] [MainThread]: 
[0m14:05:30.803009 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:30.804135 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.313357, "process_user_time": 5.773754, "process_kernel_time": 0.323874, "process_mem_max_rss": "302296", "process_in_blocks": "3808", "process_out_blocks": "116696"}
[0m14:05:30.804785 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:30.804673 after 12.31 seconds
[0m14:05:30.805288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e29eb4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de2d9f7a0>]}
[0m14:05:30.805783 [debug] [MainThread]: Flushing usage events
[0m14:05:32.764828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f962e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f9610d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f962660>]}


============================== 14:05:32.767764 | 71eccba0-e1bc-4284-8aef-e2ee42a7aeeb ==============================
[0m14:05:32.767764 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:32.768481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:32.908977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71eccba0-e1bc-4284-8aef-e2ee42a7aeeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573fb3b200>]}
[0m14:05:32.925760 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20939516, "process_user_time": 1.402786, "process_kernel_time": 0.107906, "process_mem_max_rss": "92196", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:32.926347 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:32.926246 after 0.21 seconds
[0m14:05:32.926826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57406c8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573fa0fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f9aa060>]}
[0m14:05:32.927248 [debug] [MainThread]: Flushing usage events
[0m22:06:37.818970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd1479340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd185d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd3822270>]}


============================== 22:06:37.826466 | 90ac5466-6416-4b1c-85b1-1e85a1d0e0ad ==============================
[0m22:06:37.826466 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:37.827200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:37.979993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90ac5466-6416-4b1c-85b1-1e85a1d0e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd147bd40>]}
[0m22:06:37.994808 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mnavaskj'
[0m22:06:37.995340 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:38.062625 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:38.063472 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:38.098596 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:38.102810 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:38.462267 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:38.462926 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:38.463490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '90ac5466-6416-4b1c-85b1-1e85a1d0e0ad', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd12afc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd12ac3e0>]}
[0m22:06:38.463984 [info ] [MainThread]: 
[0m22:06:38.464510 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:38.466498 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6955928, "process_user_time": 1.603294, "process_kernel_time": 0.140288, "process_mem_max_rss": "93640", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:06:38.467094 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:38.466989 after 0.70 seconds
[0m22:06:38.467535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd18ea360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd11efe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd117e7e0>]}
[0m22:06:38.467969 [debug] [MainThread]: Flushing usage events
[0m22:06:40.277643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3219afef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3219cb590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3219af6b0>]}


============================== 22:06:40.280812 | 33dad61b-4949-4309-8e77-a24b0795d7a0 ==============================
[0m22:06:40.280812 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:40.281603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:40.546518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa320ef8410>]}
[0m22:06:40.609342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa321abfef0>]}
[0m22:06:40.612131 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:06:40.632020 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:40.632875 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:40.633460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa321c05af0>]}
[0m22:06:41.875403 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:41.876121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31987a000>]}
[0m22:06:42.059627 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:42.065035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa319f3ad80>]}
[0m22:06:42.193864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3197a8440>]}
[0m22:06:42.194451 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:42.194931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa319817ce0>]}
[0m22:06:42.196701 [info ] [MainThread]: 
[0m22:06:42.197466 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:42.202403 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:42.238996 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:42.239516 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:42.239922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:42.932482 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:42.934054 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:42.936259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:42.936887 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:42.944032 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.944502 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:42.944898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.951491 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.953061 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.953476 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:42.954021 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.954423 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.954799 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:42.955418 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.956386 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.956786 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.957159 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.957699 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.958106 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:42.960208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:42.967557 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.967981 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:42.968397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.974563 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.974999 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.975403 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:42.999698 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:43.001525 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:43.002845 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:43.003264 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:43.007359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3215ff860>]}
[0m22:06:43.007903 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:43.008343 [debug] [MainThread]: On master: BEGIN
[0m22:06:43.008740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:43.016047 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:43.016639 [debug] [MainThread]: On master: COMMIT
[0m22:06:43.017044 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:43.017436 [debug] [MainThread]: On master: COMMIT
[0m22:06:43.018005 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:43.018436 [debug] [MainThread]: On master: Close
[0m22:06:43.020478 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:43.021041 [info ] [MainThread]: 
[0m22:06:43.030895 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:43.031554 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:43.032269 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:43.032768 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:43.060219 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:43.061163 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:43.098459 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:43.099537 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:54.141664 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.142226 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:54.142945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.143402 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.143843 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:54.144705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.147879 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.148383 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:54.149198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.171129 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.171738 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.172198 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.175132 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.180832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.181370 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:54.182898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.185439 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:54.216838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31970bb00>]}
[0m22:06:54.217685 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.18s]
[0m22:06:54.218484 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:54.219513 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:54.220082 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:54.220817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:54.221283 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:54.226786 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:54.227500 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:54.262615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.263238 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241027220654256372"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:54.263725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:54.279952 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.288496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.289063 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:54.289882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.290335 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.290781 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241027220654256372'
      
      
      order by ordinal_position

  
[0m22:06:54.312563 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.319878 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.320447 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.323597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.331691 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.332216 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.335620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.354596 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:54.355433 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.355923 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241027220654256372"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241027220654256372"
    )
  
[0m22:06:54.389710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.391779 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.392246 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.392704 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.402481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.403507 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:55.415250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2de439610>]}
[0m22:06:55.416103 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 1.19s]
[0m22:06:55.416903 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:55.418423 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:55.418930 [debug] [MainThread]: On master: BEGIN
[0m22:06:55.419397 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:55.426669 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:55.427244 [debug] [MainThread]: On master: COMMIT
[0m22:06:55.427692 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:55.428122 [debug] [MainThread]: On master: COMMIT
[0m22:06:55.428761 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:55.429217 [debug] [MainThread]: On master: Close
[0m22:06:55.430946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:55.431384 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:55.431787 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:55.432256 [info ] [MainThread]: 
[0m22:06:55.432907 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.23 seconds (13.23s).
[0m22:06:55.434057 [debug] [MainThread]: Command end result
[0m22:06:55.462748 [info ] [MainThread]: 
[0m22:06:55.463515 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:55.464121 [info ] [MainThread]: 
[0m22:06:55.464761 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:55.465895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.238665, "process_user_time": 6.932973, "process_kernel_time": 0.301608, "process_mem_max_rss": "356188", "process_in_blocks": "3808", "process_out_blocks": "130560"}
[0m22:06:55.466559 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:55.466442 after 15.24 seconds
[0m22:06:55.467080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3214d7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa32160c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2de4d2f60>]}
[0m22:06:55.467567 [debug] [MainThread]: Flushing usage events
[0m22:06:57.437108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e375e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3348140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e375f860>]}


============================== 22:06:57.440420 | f3b777d2-4608-4fbe-ac6d-442a18d0d0d2 ==============================
[0m22:06:57.440420 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:57.441225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:57.601557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3b777d2-4608-4fbe-ac6d-442a18d0d0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e2c5f710>]}
[0m22:06:57.619386 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23291159, "process_user_time": 1.489889, "process_kernel_time": 0.100126, "process_mem_max_rss": "91996", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:57.620025 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:57.619911 after 0.23 seconds
[0m22:06:57.620553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3348140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e32497f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e31f3980>]}
[0m22:06:57.621025 [debug] [MainThread]: Flushing usage events
[0m06:02:18.359027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1569605d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15695a1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1567f94fe0>]}


============================== 06:02:18.367875 | c20095a7-de61-4d0b-86b7-e546f68a3dc1 ==============================
[0m06:02:18.367875 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:18.368546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:18.506673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c20095a7-de61-4d0b-86b7-e546f68a3dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f156704ae70>]}
[0m06:02:18.520055 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8g6ssrag'
[0m06:02:18.520511 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:18.585227 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:18.585906 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:18.609355 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:18.613273 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:18.686458 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:18.686971 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:18.687480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c20095a7-de61-4d0b-86b7-e546f68a3dc1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1566f04e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1567235280>]}
[0m06:02:18.687964 [info ] [MainThread]: 
[0m06:02:18.688445 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:18.712703 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4020372, "process_user_time": 1.556321, "process_kernel_time": 0.132709, "process_mem_max_rss": "93536", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:18.713299 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:18.713195 after 0.40 seconds
[0m06:02:18.713734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f156761d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f156709fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15673b4a70>]}
[0m06:02:18.714163 [debug] [MainThread]: Flushing usage events
[0m06:02:20.269689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108b2ee120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10898fdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10898fcb00>]}


============================== 06:02:20.272646 | 73826b8e-2dee-4ff6-966e-395ab8ee36d9 ==============================
[0m06:02:20.272646 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:20.273297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:20.510547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1088d69880>]}
[0m06:02:20.569138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10892c8320>]}
[0m06:02:20.571617 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:20.593170 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:20.593909 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:20.594447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1081d2fb90>]}
[0m06:02:21.818318 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:21.818975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1088df49b0>]}
[0m06:02:21.998149 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:22.003079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1081bf06e0>]}
[0m06:02:22.133076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10816a3200>]}
[0m06:02:22.133654 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:22.134137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108172ba70>]}
[0m06:02:22.135823 [info ] [MainThread]: 
[0m06:02:22.136482 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:22.141288 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:22.176435 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:22.176876 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:22.177277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:22.540197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.541832 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:22.544257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:22.544854 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:22.552162 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.552602 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:22.552993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:22.559537 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.561020 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.561434 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:22.561976 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.562368 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.562746 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:22.563306 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.564247 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:22.564653 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.565029 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:22.565550 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.565956 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:22.568074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:22.574509 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.574922 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:22.575292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:22.581009 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.581414 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.581804 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:22.603795 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.605251 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:22.606439 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:22.606838 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:22.610088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108c4268a0>]}
[0m06:02:22.610603 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.610991 [debug] [MainThread]: On master: BEGIN
[0m06:02:22.611358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:22.617832 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.618254 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.618652 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.619028 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.619553 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.620001 [debug] [MainThread]: On master: Close
[0m06:02:22.621406 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:22.621949 [info ] [MainThread]: 
[0m06:02:22.636945 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:22.637537 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:22.638262 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:22.638716 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:22.665045 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:22.665809 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:22.701619 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:22.702361 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:29.756974 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.757477 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:29.758127 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.758592 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.759029 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:29.759760 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.762599 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.763053 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:29.763755 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.784649 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:29.785127 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.785568 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:29.787100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.792068 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.792535 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:29.793668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.795986 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:29.825065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1088cc2060>]}
[0m06:02:29.825768 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.19s]
[0m06:02:29.826537 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:29.827490 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:29.828079 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:29.828652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:29.829115 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:29.834081 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:29.834728 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:29.868053 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.868559 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241028060229862204"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:29.869037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:29.883587 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.890959 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.891434 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:29.892079 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.892520 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.892970 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241028060229862204'
      
      
      order by ordinal_position

  
[0m06:02:29.915824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.921889 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.922385 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.925185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.932645 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.933121 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.936011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.953642 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:29.954335 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.954797 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241028060229862204"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241028060229862204"
    )
  
[0m06:02:29.984503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.986490 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.986946 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.987370 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.995603 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.996522 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:30.136153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10422ec8c0>]}
[0m06:02:30.136968 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m06:02:30.137720 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:30.139189 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.139666 [debug] [MainThread]: On master: BEGIN
[0m06:02:30.140141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:30.146992 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.147469 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.147950 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.148377 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.148956 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.149409 [debug] [MainThread]: On master: Close
[0m06:02:30.150854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:30.151291 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:30.151743 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:30.152241 [info ] [MainThread]: 
[0m06:02:30.152753 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.02 seconds (8.02s).
[0m06:02:30.153745 [debug] [MainThread]: Command end result
[0m06:02:30.181928 [info ] [MainThread]: 
[0m06:02:30.182587 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:30.183093 [info ] [MainThread]: 
[0m06:02:30.183612 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:30.184681 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.96344, "process_user_time": 4.969685, "process_kernel_time": 0.314839, "process_mem_max_rss": "297320", "process_in_blocks": "3808", "process_out_blocks": "112624"}
[0m06:02:30.185331 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:30.185219 after 9.96 seconds
[0m06:02:30.185826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108b2ee120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1088f3a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104214e510>]}
[0m06:02:30.186313 [debug] [MainThread]: Flushing usage events
[0m06:02:31.831184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5e627140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5e6269c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5d7d2570>]}


============================== 06:02:31.834361 | 2ee77072-d821-4900-9789-821437692a7a ==============================
[0m06:02:31.834361 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:31.835114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:31.993074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ee77072-d821-4900-9789-821437692a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5d562240>]}
[0m06:02:32.009945 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22726344, "process_user_time": 1.442231, "process_kernel_time": 0.095882, "process_mem_max_rss": "92276", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:32.010536 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:32.010433 after 0.23 seconds
[0m06:02:32.010980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d611bbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5d57bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5e5c5070>]}
[0m06:02:32.011409 [debug] [MainThread]: Flushing usage events
[0m14:05:43.781127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d9c3620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333e491160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333dc9c770>]}


============================== 14:05:43.799641 | 454ab71b-5d52-4fe9-a35a-634712aa6b74 ==============================
[0m14:05:43.799641 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:43.800427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:43.961611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '454ab71b-5d52-4fe9-a35a-634712aa6b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d3e8230>]}
[0m14:05:43.976818 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wktfb13p'
[0m14:05:43.977353 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:44.104878 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:44.105759 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:44.179463 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:44.183914 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:44.360156 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:44.360838 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:44.361424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '454ab71b-5d52-4fe9-a35a-634712aa6b74', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d3e8f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d54bdd0>]}
[0m14:05:44.361927 [info ] [MainThread]: 
[0m14:05:44.362433 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:44.390756 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.661077, "process_user_time": 1.735637, "process_kernel_time": 0.107977, "process_mem_max_rss": "93768", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:44.391570 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:44.391446 after 0.66 seconds
[0m14:05:44.392072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333ec21640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d8c9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d861730>]}
[0m14:05:44.392542 [debug] [MainThread]: Flushing usage events
[0m14:05:46.156727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e6426540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e6e3e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e8795d00>]}


============================== 14:05:46.159939 | ca1f2f26-aca7-4c38-9221-1bfdeee532f7 ==============================
[0m14:05:46.159939 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:46.160693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:46.425161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e61f8aa0>]}
[0m14:05:46.487802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e64f26c0>]}
[0m14:05:46.490644 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:46.516229 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:46.517081 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:46.517629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df342b40>]}
[0m14:05:47.829796 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:47.830516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77dedb0b60>]}
[0m14:05:48.026393 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:48.032360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ded3e660>]}
[0m14:05:48.199016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77deb6c7a0>]}
[0m14:05:48.199639 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:48.200193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77dec256a0>]}
[0m14:05:48.202160 [info ] [MainThread]: 
[0m14:05:48.202970 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:48.208117 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:48.247755 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:48.248342 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:48.248820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:48.768037 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:48.769813 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:48.772266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:48.772943 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:48.780676 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.781206 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:48.781624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:48.788873 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.790570 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.790992 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:48.791579 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.791981 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.792396 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:48.793019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.794009 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:48.794436 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.794828 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:48.795396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.795823 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:48.798396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:48.806394 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:48.806841 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:48.807246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:48.814053 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.814530 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:48.814952 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:48.839235 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.841053 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:48.842431 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:48.842878 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:48.847005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e6d6c6e0>]}
[0m14:05:48.847601 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:48.848029 [debug] [MainThread]: On master: BEGIN
[0m14:05:48.848428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:48.855524 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:48.856006 [debug] [MainThread]: On master: COMMIT
[0m14:05:48.856417 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:48.856869 [debug] [MainThread]: On master: COMMIT
[0m14:05:48.857473 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:48.857912 [debug] [MainThread]: On master: Close
[0m14:05:48.859999 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:48.860565 [info ] [MainThread]: 
[0m14:05:48.879979 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:48.880705 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:48.881552 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:48.882035 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:48.909454 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:48.910364 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:48.948134 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:48.949183 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:56.930571 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.931174 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:56.932051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.932549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.933060 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:56.933960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.937499 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.937981 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:56.938789 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.961034 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:56.961640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.962109 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:56.963776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.969644 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.970155 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:56.971552 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.974183 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:57.006216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77decc08c0>]}
[0m14:05:57.007157 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.12s]
[0m14:05:57.007987 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:57.009092 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:57.009714 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:57.010389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:57.010883 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:57.016725 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:57.017547 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:57.053973 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.054602 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241028140557047475"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:57.055105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:57.071428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.079986 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.080502 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:57.081243 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.081711 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.082157 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241028140557047475'
      
      
      order by ordinal_position

  
[0m14:05:57.105092 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.112743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.113364 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:57.117315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.126028 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.126562 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:57.129934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.149054 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:57.149908 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.150420 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241028140557047475"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241028140557047475"
    )
  
[0m14:05:57.183889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.186207 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:57.186761 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.187250 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:57.196562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.197629 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:57.337692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f779b420d40>]}
[0m14:05:57.338585 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m14:05:57.339395 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:57.340971 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:57.341583 [debug] [MainThread]: On master: BEGIN
[0m14:05:57.342121 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:57.349793 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:57.350375 [debug] [MainThread]: On master: COMMIT
[0m14:05:57.350839 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:57.351288 [debug] [MainThread]: On master: COMMIT
[0m14:05:57.351913 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:57.352399 [debug] [MainThread]: On master: Close
[0m14:05:57.354457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:57.354918 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:57.355341 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:57.355854 [info ] [MainThread]: 
[0m14:05:57.356484 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.15 seconds (9.15s).
[0m14:05:57.357739 [debug] [MainThread]: Command end result
[0m14:05:57.388195 [info ] [MainThread]: 
[0m14:05:57.389036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:57.389584 [info ] [MainThread]: 
[0m14:05:57.390138 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:57.391288 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.286792, "process_user_time": 5.839365, "process_kernel_time": 0.391421, "process_mem_max_rss": "281868", "process_in_blocks": "3808", "process_out_blocks": "112616"}
[0m14:05:57.391992 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:57.391870 after 11.29 seconds
[0m14:05:57.392522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e69639e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e69a21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e61f8560>]}
[0m14:05:57.393075 [debug] [MainThread]: Flushing usage events
[0m14:05:59.320466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fd5ffec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fda0bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fda0a870>]}


============================== 14:05:59.323774 | 46d2110e-44fd-4b6b-8cbf-c6fa57daab8a ==============================
[0m14:05:59.323774 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:59.324510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:59.488817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46d2110e-44fd-4b6b-8cbf-c6fa57daab8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fcf0bce0>]}
[0m14:05:59.507518 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23926263, "process_user_time": 1.571253, "process_kernel_time": 0.08396, "process_mem_max_rss": "92252", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:59.508167 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:59.508051 after 0.24 seconds
[0m14:05:59.508643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fcf5f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fce5f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fcef2ed0>]}
[0m14:05:59.509163 [debug] [MainThread]: Flushing usage events
[0m22:05:38.658088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54406d3a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5441648440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544073f830>]}


============================== 22:05:38.665394 | b1329918-f83e-4a5d-bf4e-a180b24ce659 ==============================
[0m22:05:38.665394 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:38.666087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:38.803293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1329918-f83e-4a5d-bf4e-a180b24ce659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543fbbae70>]}
[0m22:05:38.816893 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-u8ddbmzd'
[0m22:05:38.817357 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:38.869130 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:38.869807 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:38.892432 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:38.896331 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:38.994011 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:38.994622 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:38.995248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b1329918-f83e-4a5d-bf4e-a180b24ce659', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543fb4b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543fa4d6d0>]}
[0m22:05:38.995751 [info ] [MainThread]: 
[0m22:05:38.996285 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:38.998117 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3881039, "process_user_time": 1.530194, "process_kernel_time": 0.149385, "process_mem_max_rss": "93508", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m22:05:38.998722 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:38.998618 after 0.39 seconds
[0m22:05:38.999162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544016c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5440af9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544073f830>]}
[0m22:05:38.999586 [debug] [MainThread]: Flushing usage events
[0m22:05:40.611452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9002fa97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9003e21910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9003e230e0>]}


============================== 22:05:40.614428 | edb8cd76-1e0e-46db-bcb7-e9820d35e989 ==============================
[0m22:05:40.614428 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:40.615175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:40.853051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9002da64b0>]}
[0m22:05:40.912515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9002e45370>]}
[0m22:05:40.915132 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:40.937314 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:40.938057 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:40.938576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90039b6de0>]}
[0m22:05:42.172007 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:42.172654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb8f35c0>]}
[0m22:05:42.352392 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:42.357589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb92b020>]}
[0m22:05:42.481000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb8d83b0>]}
[0m22:05:42.481565 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:42.482071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb6920c0>]}
[0m22:05:42.483770 [info ] [MainThread]: 
[0m22:05:42.484453 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:42.489232 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:42.524802 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:42.525271 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:42.525668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:43.138197 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:43.139806 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:43.141963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:43.142515 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:43.149724 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.150154 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:43.150544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:43.157071 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.158565 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.158965 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:43.159582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.160003 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.160381 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:43.160952 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.161880 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:43.162288 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.162663 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:43.163199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.163603 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:43.165716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:43.173081 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:43.173502 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:43.173870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:43.180152 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.180561 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:43.180958 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:43.204925 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.206515 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:43.207763 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:43.208166 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:43.212047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb7dbdd0>]}
[0m22:05:43.212590 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:43.212990 [debug] [MainThread]: On master: BEGIN
[0m22:05:43.213368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:43.219974 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:43.220406 [debug] [MainThread]: On master: COMMIT
[0m22:05:43.220800 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:43.221173 [debug] [MainThread]: On master: COMMIT
[0m22:05:43.221712 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:43.222119 [debug] [MainThread]: On master: Close
[0m22:05:43.223732 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:43.224229 [info ] [MainThread]: 
[0m22:05:43.233892 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:43.234510 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:43.235146 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:43.235585 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:43.261552 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:43.262395 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:43.297929 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:43.298749 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:50.066806 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.067328 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:50.068038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.068496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.068943 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:50.069651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.072575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.073034 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:50.073717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.094460 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:50.094943 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.095388 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:50.097609 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.102648 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.103115 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:50.104532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.106880 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:50.137412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900445a150>]}
[0m22:05:50.138216 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.90s]
[0m22:05:50.138984 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:50.139990 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:50.140560 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:50.141139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:50.141598 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:50.146942 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:50.147619 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:50.181636 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.182168 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241028220550175642"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:50.182641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:50.198174 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.206275 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.206756 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:50.207427 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.207917 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.208361 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241028220550175642'
      
      
      order by ordinal_position

  
[0m22:05:50.229210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.235641 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.236176 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:50.239370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.247207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.247684 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:50.250561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.268531 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:50.269300 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.269774 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241028220550175642"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241028220550175642"
    )
  
[0m22:05:50.298689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.300704 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:50.301159 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.301580 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:50.309703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.310596 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:50.451578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc12d0200>]}
[0m22:05:50.452426 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m22:05:50.453170 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:50.454649 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:50.455117 [debug] [MainThread]: On master: BEGIN
[0m22:05:50.455545 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:50.462423 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:50.462901 [debug] [MainThread]: On master: COMMIT
[0m22:05:50.463328 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:50.463776 [debug] [MainThread]: On master: COMMIT
[0m22:05:50.464359 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:50.464799 [debug] [MainThread]: On master: Close
[0m22:05:50.466280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:50.466715 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:50.467117 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:50.467569 [info ] [MainThread]: 
[0m22:05:50.468189 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.98 seconds (7.98s).
[0m22:05:50.469276 [debug] [MainThread]: Command end result
[0m22:05:50.496958 [info ] [MainThread]: 
[0m22:05:50.497662 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:50.498267 [info ] [MainThread]: 
[0m22:05:50.498858 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:50.499994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.936945, "process_user_time": 5.479856, "process_kernel_time": 0.311991, "process_mem_max_rss": "287164", "process_in_blocks": "3808", "process_out_blocks": "113160"}
[0m22:05:50.500666 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:50.500553 after 9.94 seconds
[0m22:05:50.501161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90038fc7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc0216090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffa4807a0>]}
[0m22:05:50.501664 [debug] [MainThread]: Flushing usage events
[0m22:05:52.196621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d254ca900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2539fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d26915550>]}


============================== 22:05:52.199505 | e335a262-b8c2-4cbc-974f-c79ee515e094 ==============================
[0m22:05:52.199505 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:52.200259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:52.348253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e335a262-b8c2-4cbc-974f-c79ee515e094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d251026c0>]}
[0m22:05:52.365379 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21789801, "process_user_time": 1.404242, "process_kernel_time": 0.136023, "process_mem_max_rss": "92388", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:52.365981 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:52.365877 after 0.22 seconds
[0m22:05:52.366432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d251026c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d24d4b1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d24e5cc50>]}
[0m22:05:52.366873 [debug] [MainThread]: Flushing usage events
[0m06:02:05.874699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb618a92420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb618a90e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61874de20>]}


============================== 06:02:05.893234 | 1fc0631d-75df-47e4-9d2e-ae5618b5a5d6 ==============================
[0m06:02:05.893234 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:05.893872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:06.033358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fc0631d-75df-47e4-9d2e-ae5618b5a5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61831d580>]}
[0m06:02:06.047041 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_msqsnw1'
[0m06:02:06.047532 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:06.108637 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:06.109380 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:06.119567 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:06.123504 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:06.170299 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:06.170888 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:06.171461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1fc0631d-75df-47e4-9d2e-ae5618b5a5d6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61808bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61808bbf0>]}
[0m06:02:06.171932 [info ] [MainThread]: 
[0m06:02:06.172387 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:06.179134 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.35275716, "process_user_time": 1.568156, "process_kernel_time": 0.130002, "process_mem_max_rss": "93900", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:06.179878 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:06.179770 after 0.35 seconds
[0m06:02:06.180319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb618d545c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb618587bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6197d06e0>]}
[0m06:02:06.180753 [debug] [MainThread]: Flushing usage events
[0m06:02:07.742006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6470265a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f8ec380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f8ed2b0>]}


============================== 06:02:07.744856 | b76403ca-1e77-4730-8cf1-a90ddf729293 ==============================
[0m06:02:07.744856 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:07.745555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.977242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f63b590>]}
[0m06:02:08.036224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6470adbec0>]}
[0m06:02:08.038637 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:08.074822 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:08.075554 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:08.076085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f692e70>]}
[0m06:02:09.311566 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:09.312222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f63afc0>]}
[0m06:02:09.493636 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:09.498648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64682e9d60>]}
[0m06:02:09.617822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64680588c0>]}
[0m06:02:09.618375 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:09.618874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64682cb470>]}
[0m06:02:09.620603 [info ] [MainThread]: 
[0m06:02:09.621293 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:09.626211 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:09.661656 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:09.662104 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:09.662508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:10.226649 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:10.228280 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:10.230511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:10.231101 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:10.238472 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.238909 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:10.239334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.245839 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.247352 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.247765 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:10.248324 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.248721 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.249098 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:10.249676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.250597 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.250999 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.251405 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.251946 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.252352 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:10.254399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:10.261642 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.262062 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:10.262437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.268396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.268819 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.269280 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:10.294420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.296101 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:10.297382 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:10.297807 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:10.301642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6468041250>]}
[0m06:02:10.302177 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.302582 [debug] [MainThread]: On master: BEGIN
[0m06:02:10.302961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:10.309589 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.310030 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.310424 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.310805 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.311367 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.311778 [debug] [MainThread]: On master: Close
[0m06:02:10.313471 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:10.313965 [info ] [MainThread]: 
[0m06:02:10.329825 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:10.330458 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:10.331130 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:10.331634 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:10.358185 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:10.359029 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:10.396225 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:10.397147 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:19.112879 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.113397 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:19.114027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.114478 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.114914 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:19.115747 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.118575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.119026 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:19.119820 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.140907 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:19.141441 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.141882 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:19.143101 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.148206 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.148679 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:19.150171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.152637 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:19.182112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6470d2f920>]}
[0m06:02:19.182869 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.85s]
[0m06:02:19.183673 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:19.184677 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:19.185242 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:19.185807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:19.186260 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:19.191587 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:19.192257 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:19.226190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.226699 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241029060219220278"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:19.227186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:19.241483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.249053 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.249520 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:19.250117 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.250569 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.251006 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241029060219220278'
      
      
      order by ordinal_position

  
[0m06:02:19.271620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.277827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.278304 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:19.281510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.290225 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.290913 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:19.295071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.320612 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:19.321525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.322196 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241029060219220278"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241029060219220278"
    )
  
[0m06:02:19.361662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.364610 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:19.365231 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.365863 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:19.374679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.375971 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:19.524689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64248bf920>]}
[0m06:02:19.525518 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m06:02:19.526258 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:19.527631 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.528104 [debug] [MainThread]: On master: BEGIN
[0m06:02:19.528529 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:19.535183 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.535692 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.536133 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.536557 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.537150 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.537609 [debug] [MainThread]: On master: Close
[0m06:02:19.538946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:19.539438 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:19.539848 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:19.540305 [info ] [MainThread]: 
[0m06:02:19.540816 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.92 seconds (9.92s).
[0m06:02:19.541815 [debug] [MainThread]: Command end result
[0m06:02:19.570216 [info ] [MainThread]: 
[0m06:02:19.570846 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:19.571401 [info ] [MainThread]: 
[0m06:02:19.571939 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:19.572962 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.879456, "process_user_time": 5.548978, "process_kernel_time": 0.387509, "process_mem_max_rss": "291988", "process_in_blocks": "3808", "process_out_blocks": "114152"}
[0m06:02:19.573638 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:19.573523 after 11.88 seconds
[0m06:02:19.574145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6471bd8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646fd3c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f8a76b0>]}
[0m06:02:19.574643 [debug] [MainThread]: Flushing usage events
[0m06:02:21.187484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539ccce570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539cccdeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539ccce3f0>]}


============================== 06:02:21.190278 | 1b9b4c32-9f56-4c57-9946-8b2f5078bbad ==============================
[0m06:02:21.190278 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:21.191018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:21.335199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b9b4c32-9f56-4c57-9946-8b2f5078bbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539ccfef60>]}
[0m06:02:21.351940 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21317771, "process_user_time": 1.417532, "process_kernel_time": 0.099826, "process_mem_max_rss": "92252", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:21.352514 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:21.352410 after 0.21 seconds
[0m06:02:21.352952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539cca58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539ca5fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539c97ae10>]}
[0m06:02:21.353369 [debug] [MainThread]: Flushing usage events
[0m14:05:10.367174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae49f647d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae4a3334d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae4a332ba0>]}


============================== 14:05:10.451220 | 292209e1-b5ab-4cce-9172-a518335c84bd ==============================
[0m14:05:10.451220 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:10.451882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:10.600081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '292209e1-b5ab-4cce-9172-a518335c84bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae4a57dd60>]}
[0m14:05:10.614301 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-pa36i0j9'
[0m14:05:10.614790 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:10.668567 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:10.669285 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:10.683746 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:10.687715 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:10.741294 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:10.741936 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:10.742547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '292209e1-b5ab-4cce-9172-a518335c84bd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae498acc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae498ac5c0>]}
[0m14:05:10.743008 [info ] [MainThread]: 
[0m14:05:10.743523 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:10.753908 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43490958, "process_user_time": 1.555751, "process_kernel_time": 0.154387, "process_mem_max_rss": "93584", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:10.754633 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:10.754508 after 0.44 seconds
[0m14:05:10.755088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae49cc61e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae4ab5e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae4a8f9fa0>]}
[0m14:05:10.755517 [debug] [MainThread]: Flushing usage events
[0m14:05:12.355713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60e8fca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60dfb2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60e3cfe00>]}


============================== 14:05:12.358735 | fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd ==============================
[0m14:05:12.358735 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:12.359404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:12.598903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60dcb7740>]}
[0m14:05:12.659096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60ddf55e0>]}
[0m14:05:12.661748 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:12.688183 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:12.688919 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:12.689445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6113e20f0>]}
[0m14:05:13.949441 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:13.950152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa606df2b40>]}
[0m14:05:14.134732 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:14.140036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60680a6f0>]}
[0m14:05:14.297145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60688aab0>]}
[0m14:05:14.297773 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:14.298269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa606603740>]}
[0m14:05:14.300008 [info ] [MainThread]: 
[0m14:05:14.300725 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:14.305735 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:14.342693 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:14.343190 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:14.343600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:14.986012 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:14.987583 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:14.989812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:14.990369 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:14.997462 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.997923 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:14.998316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:15.004695 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.006227 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.006642 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:15.007194 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.007586 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.007958 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:15.008517 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.009431 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:15.009878 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.010257 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:15.010794 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.011209 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:15.013263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:15.020534 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:15.020948 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:15.021324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:15.028039 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.028459 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:15.028853 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:15.052772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.054443 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:15.055705 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:15.056121 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:15.059729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa606730c20>]}
[0m14:05:15.060280 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:15.060676 [debug] [MainThread]: On master: BEGIN
[0m14:05:15.061074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:15.067638 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:15.068068 [debug] [MainThread]: On master: COMMIT
[0m14:05:15.068458 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:15.068834 [debug] [MainThread]: On master: COMMIT
[0m14:05:15.069414 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:15.069870 [debug] [MainThread]: On master: Close
[0m14:05:15.071293 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:15.071829 [info ] [MainThread]: 
[0m14:05:15.087772 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:15.088393 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:15.089135 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:15.089610 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:15.115770 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:15.116579 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:15.152099 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:15.152921 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:22.230115 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.230647 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:22.231293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.231740 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.232177 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:22.232904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.235896 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.236351 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:22.237141 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.258084 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:22.258584 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.259032 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:22.260280 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.265344 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.265829 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:22.267171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.269533 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:22.300366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa606691eb0>]}
[0m14:05:22.301208 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.21s]
[0m14:05:22.302130 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:22.303163 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:22.303731 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:22.304417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:22.304877 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:22.310315 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:22.310997 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:22.344927 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.345495 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241029140522338961"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:22.346002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:22.363044 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.371204 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.371692 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:22.372368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.372812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.373243 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241029140522338961'
      
      
      order by ordinal_position

  
[0m14:05:22.394917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.402421 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.402957 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:22.406005 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.413906 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.414393 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:22.417309 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.435559 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:22.436339 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.436818 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241029140522338961"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241029140522338961"
    )
  
[0m14:05:22.471605 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.473776 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:22.474292 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.474743 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:22.483075 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.484011 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:22.639918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bf18a870>]}
[0m14:05:22.640804 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m14:05:22.641779 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:22.643471 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.643952 [debug] [MainThread]: On master: BEGIN
[0m14:05:22.644386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:22.651501 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.652000 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.652436 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.652851 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.653459 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.653958 [debug] [MainThread]: On master: Close
[0m14:05:22.655819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:22.656257 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:22.656661 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:22.657124 [info ] [MainThread]: 
[0m14:05:22.657749 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.36 seconds (8.36s).
[0m14:05:22.658894 [debug] [MainThread]: Command end result
[0m14:05:22.687959 [info ] [MainThread]: 
[0m14:05:22.688675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:22.689275 [info ] [MainThread]: 
[0m14:05:22.689903 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:22.691037 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.384087, "process_user_time": 5.714859, "process_kernel_time": 0.401391, "process_mem_max_rss": "294364", "process_in_blocks": "3808", "process_out_blocks": "114152"}
[0m14:05:22.691689 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:22.691574 after 10.38 seconds
[0m14:05:22.692197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60df49f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60efaa570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60f3534a0>]}
[0m14:05:22.692687 [debug] [MainThread]: Flushing usage events
[0m14:05:24.418543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cb815610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cc2f5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47ca8fc7d0>]}


============================== 14:05:24.421379 | 4fd3362d-e9d3-472c-a9cb-212b66df31cc ==============================
[0m14:05:24.421379 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:24.422053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:24.564935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fd3362d-e9d3-472c-a9cb-212b66df31cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9fad580>]}
[0m14:05:24.581814 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21180631, "process_user_time": 1.422238, "process_kernel_time": 0.087891, "process_mem_max_rss": "91988", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:24.582399 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:24.582296 after 0.21 seconds
[0m14:05:24.582837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9fd21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9d62b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9d7bfe0>]}
[0m14:05:24.583273 [debug] [MainThread]: Flushing usage events
[0m22:05:57.746303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12f22bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12ef7f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12f9c8140>]}


============================== 22:05:57.772972 | 25706527-9c62-458e-9755-fb3b7007d402 ==============================
[0m22:05:57.772972 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:57.773618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:57.913991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25706527-9c62-458e-9755-fb3b7007d402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12ed95fd0>]}
[0m22:05:57.927147 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2bglhr2j'
[0m22:05:57.927603 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:58.029304 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:58.029996 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:58.062140 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:58.066049 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:58.449277 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:58.449838 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:58.450371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '25706527-9c62-458e-9755-fb3b7007d402', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12ecc3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12ed06e70>]}
[0m22:05:58.450858 [info ] [MainThread]: 
[0m22:05:58.451336 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:58.470990 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.77256787, "process_user_time": 1.507564, "process_kernel_time": 0.183946, "process_mem_max_rss": "93800", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m22:05:58.471681 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:58.471577 after 0.77 seconds
[0m22:05:58.472119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12f22bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12efc5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12ee25b50>]}
[0m22:05:58.472550 [debug] [MainThread]: Flushing usage events
[0m22:06:00.193745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf3451f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf290e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf290d3d0>]}


============================== 22:06:00.196518 | cdb16e28-fbc7-4be0-8730-f3c8f8873f08 ==============================
[0m22:06:00.196518 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:00.197220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:00.428046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf299faa0>]}
[0m22:06:00.486932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf29ab770>]}
[0m22:06:00.489358 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:06:00.531852 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:00.532567 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:00.533102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf290fa40>]}
[0m22:06:01.754999 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:01.755671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf2894230>]}
[0m22:06:01.936875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:01.941954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf3f57290>]}
[0m22:06:02.060270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdeb2bf260>]}
[0m22:06:02.060822 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:02.061367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdeb3e9040>]}
[0m22:06:02.063134 [info ] [MainThread]: 
[0m22:06:02.063850 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:02.068770 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:02.103990 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:02.104437 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:02.104834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:03.431608 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:03.433174 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:03.435366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:03.435930 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:03.443130 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:03.443562 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:03.443952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:03.450291 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.451743 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:03.452145 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:03.452693 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.453089 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:03.453465 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:03.454040 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.455004 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:03.455423 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:03.455800 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:03.456328 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.456728 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:03.458574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:03.465594 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:03.466006 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:03.466373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:03.472197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.472615 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:03.473007 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:03.496246 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.497674 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:03.498880 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:03.499284 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:03.502422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdeb3e8a70>]}
[0m22:06:03.502973 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:03.503362 [debug] [MainThread]: On master: BEGIN
[0m22:06:03.503726 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:03.509965 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:03.510387 [debug] [MainThread]: On master: COMMIT
[0m22:06:03.510811 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:03.511184 [debug] [MainThread]: On master: COMMIT
[0m22:06:03.511711 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:03.512107 [debug] [MainThread]: On master: Close
[0m22:06:03.513560 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:03.514073 [info ] [MainThread]: 
[0m22:06:03.534610 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:03.535257 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:03.535915 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:03.536356 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:03.562357 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:03.563141 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:03.598710 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:03.599446 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:16.244279 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.244797 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:16.245426 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.245886 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.246322 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:16.247094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.249980 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.250433 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:16.251128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.271958 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:16.272437 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.272871 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:16.274123 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.279058 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.279519 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:16.281142 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.283479 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:16.316156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdace13680>]}
[0m22:06:16.316871 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.78s]
[0m22:06:16.317746 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:16.318735 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:16.319310 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:16.319981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:16.320440 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:16.325682 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:16.326327 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:16.359941 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.360452 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241029220616353997"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:16.360915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:16.375828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.383734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.384218 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:16.384933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.385382 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.385817 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241029220616353997'
      
      
      order by ordinal_position

  
[0m22:06:16.406606 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.413028 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.413520 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:16.416559 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.424050 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.424520 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:16.427361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.445234 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:16.445927 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.446397 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241029220616353997"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241029220616353997"
    )
  
[0m22:06:16.476121 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.478088 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:16.478551 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.479023 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:16.488004 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.488891 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:16.641202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efda7fc45c0>]}
[0m22:06:16.641963 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m22:06:16.642858 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:16.644383 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:16.644853 [debug] [MainThread]: On master: BEGIN
[0m22:06:16.645282 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:16.652138 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:16.652615 [debug] [MainThread]: On master: COMMIT
[0m22:06:16.653050 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:16.653472 [debug] [MainThread]: On master: COMMIT
[0m22:06:16.654057 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:16.654518 [debug] [MainThread]: On master: Close
[0m22:06:16.655998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:16.656439 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:16.656840 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:16.657315 [info ] [MainThread]: 
[0m22:06:16.657902 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.59 seconds (14.59s).
[0m22:06:16.659053 [debug] [MainThread]: Command end result
[0m22:06:16.686672 [info ] [MainThread]: 
[0m22:06:16.687362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:16.687956 [info ] [MainThread]: 
[0m22:06:16.688556 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:16.689650 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.543995, "process_user_time": 6.293094, "process_kernel_time": 0.307272, "process_mem_max_rss": "280620", "process_in_blocks": "3808", "process_out_blocks": "114176"}
[0m22:06:16.690297 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:16.690186 after 16.54 seconds
[0m22:06:16.690818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf2ae2c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf290f5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdacf0acf0>]}
[0m22:06:16.691318 [debug] [MainThread]: Flushing usage events
[0m22:06:18.560099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b2435670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b14997c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b4913410>]}


============================== 22:06:18.562811 | 14f338cd-18cf-44db-bf88-63698db3d5d7 ==============================
[0m22:06:18.562811 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:18.563527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:18.698287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14f338cd-18cf-44db-bf88-63698db3d5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b2b0b260>]}
[0m22:06:18.714595 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20253853, "process_user_time": 1.419757, "process_kernel_time": 0.096254, "process_mem_max_rss": "92260", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:18.715201 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:18.715098 after 0.20 seconds
[0m22:06:18.715639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b1db6960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b12d2f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b1a1e480>]}
[0m22:06:18.716057 [debug] [MainThread]: Flushing usage events
[0m07:11:15.198521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c4f2b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c3cd6cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c6001a00>]}


============================== 07:11:15.233989 | 87a3f4fb-973d-4c9c-85fa-8639e458323e ==============================
[0m07:11:15.233989 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:11:15.234689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:11:15.380805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87a3f4fb-973d-4c9c-85fa-8639e458323e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c45c9c40>]}
[0m07:11:15.394188 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-34hfxtla'
[0m07:11:15.394651 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m07:11:15.428105 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m07:11:15.428817 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m07:11:15.439299 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m07:11:15.443124 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:11:15.669528 [info ] [MainThread]: Installed from version 1.2.0
[0m07:11:15.670134 [info ] [MainThread]: Updated version available: 1.3.0
[0m07:11:15.670682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '87a3f4fb-973d-4c9c-85fa-8639e458323e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c3e3d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c39c44a0>]}
[0m07:11:15.671143 [info ] [MainThread]: 
[0m07:11:15.671630 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m07:11:15.684543 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5342621, "process_user_time": 1.596632, "process_kernel_time": 0.113754, "process_mem_max_rss": "93684", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m07:11:15.685218 [debug] [MainThread]: Command `dbt deps` succeeded at 07:11:15.685110 after 0.54 seconds
[0m07:11:15.685654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c4491640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c4492840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c45c9c40>]}
[0m07:11:15.686082 [debug] [MainThread]: Flushing usage events
[0m07:11:17.473514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d8bd4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d8bd47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d8541d30>]}


============================== 07:11:17.476323 | cdf66772-a414-4a00-9847-d689f5777c4d ==============================
[0m07:11:17.476323 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:11:17.476985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:11:17.711988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d1320f80>]}
[0m07:11:17.771175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d82797f0>]}
[0m07:11:17.773668 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m07:11:17.825154 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:11:17.825872 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:11:17.826410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d1226900>]}
[0m07:11:19.047705 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m07:11:19.048374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d1254b90>]}
[0m07:11:19.231174 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m07:11:19.236418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d0b194f0>]}
[0m07:11:19.358842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d0de5310>]}
[0m07:11:19.359415 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m07:11:19.359942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d0c04a70>]}
[0m07:11:19.361723 [info ] [MainThread]: 
[0m07:11:19.362460 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:11:19.367372 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m07:11:19.403287 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m07:11:19.403747 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m07:11:19.404146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:11:19.783536 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.785139 [debug] [ThreadPool]: On list_petro: Close
[0m07:11:19.787306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m07:11:19.787867 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m07:11:19.795096 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:11:19.795535 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m07:11:19.795929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:11:19.802298 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.803832 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:11:19.804248 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m07:11:19.804837 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.805239 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:11:19.805623 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m07:11:19.806200 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.807137 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m07:11:19.807541 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:11:19.807920 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m07:11:19.808478 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.808942 [debug] [ThreadPool]: On create_petro_main: Close
[0m07:11:19.811193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m07:11:19.818616 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m07:11:19.819033 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m07:11:19.819414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:11:19.825556 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.825980 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m07:11:19.826379 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m07:11:19.849803 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.851395 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m07:11:19.852684 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m07:11:19.853104 [debug] [ThreadPool]: On list_petro_main: Close
[0m07:11:19.856694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d0df8ad0>]}
[0m07:11:19.857240 [debug] [MainThread]: Using duckdb connection "master"
[0m07:11:19.857639 [debug] [MainThread]: On master: BEGIN
[0m07:11:19.858015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:11:19.864509 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:11:19.864978 [debug] [MainThread]: On master: COMMIT
[0m07:11:19.865380 [debug] [MainThread]: Using duckdb connection "master"
[0m07:11:19.865763 [debug] [MainThread]: On master: COMMIT
[0m07:11:19.866313 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:11:19.866728 [debug] [MainThread]: On master: Close
[0m07:11:19.868271 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m07:11:19.868832 [info ] [MainThread]: 
[0m07:11:19.885848 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m07:11:19.886469 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m07:11:19.887156 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m07:11:19.887596 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m07:11:19.913624 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m07:11:19.914496 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m07:11:19.950443 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m07:11:19.951242 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:11:29.906241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:11:29.906767 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m07:11:29.907428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:29.907885 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:11:29.908327 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m07:11:29.909293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:29.912242 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:11:29.912731 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m07:11:29.913417 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:29.934306 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m07:11:29.934811 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:11:29.935261 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m07:11:29.936658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:29.941710 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:11:29.942182 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m07:11:29.943387 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:29.945769 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m07:11:29.976502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d08bbb60>]}
[0m07:11:29.977340 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.09s]
[0m07:11:29.978104 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m07:11:29.979135 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m07:11:29.979699 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m07:11:29.980277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m07:11:29.980754 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m07:11:29.986109 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m07:11:29.986766 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m07:11:30.020860 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.021385 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241030071130014858"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m07:11:30.021870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:11:30.036782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.044877 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.045373 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m07:11:30.046028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.046482 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.046915 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241030071130014858'
      
      
      order by ordinal_position

  
[0m07:11:30.067865 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.074853 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.075361 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m07:11:30.078576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.086296 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.086778 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m07:11:30.089657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.107669 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m07:11:30.108438 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.108941 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241030071130014858"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241030071130014858"
    )
  
[0m07:11:30.139863 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.141962 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m07:11:30.142438 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.142880 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m07:11:30.151647 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.152600 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m07:11:30.318028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18923cba70>]}
[0m07:11:30.318847 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m07:11:30.319603 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m07:11:30.321078 [debug] [MainThread]: Using duckdb connection "master"
[0m07:11:30.321557 [debug] [MainThread]: On master: BEGIN
[0m07:11:30.321989 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:11:30.328838 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:11:30.329323 [debug] [MainThread]: On master: COMMIT
[0m07:11:30.329761 [debug] [MainThread]: Using duckdb connection "master"
[0m07:11:30.330182 [debug] [MainThread]: On master: COMMIT
[0m07:11:30.330761 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:11:30.331210 [debug] [MainThread]: On master: Close
[0m07:11:30.332805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:11:30.333243 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m07:11:30.333648 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m07:11:30.334118 [info ] [MainThread]: 
[0m07:11:30.334720 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.97 seconds (10.97s).
[0m07:11:30.335857 [debug] [MainThread]: Command end result
[0m07:11:30.363905 [info ] [MainThread]: 
[0m07:11:30.364618 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:11:30.365263 [info ] [MainThread]: 
[0m07:11:30.365871 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:11:30.366969 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.94198, "process_user_time": 5.388263, "process_kernel_time": 0.358412, "process_mem_max_rss": "297756", "process_in_blocks": "3808", "process_out_blocks": "114672"}
[0m07:11:30.367625 [debug] [MainThread]: Command `dbt run` succeeded at 07:11:30.367511 after 12.94 seconds
[0m07:11:30.368149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18dc167d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1891ac92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d88a3e00>]}
[0m07:11:30.368673 [debug] [MainThread]: Flushing usage events
[0m07:11:32.303395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f02202d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f01d79640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f022011f0>]}


============================== 07:11:32.306376 | 2f9347f4-2d38-4d45-b71f-73cb8db84ab3 ==============================
[0m07:11:32.306376 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:11:32.307044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:11:32.446961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f9347f4-2d38-4d45-b71f-73cb8db84ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f02b37f20>]}
[0m07:11:32.463275 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20883814, "process_user_time": 1.457047, "process_kernel_time": 0.06387, "process_mem_max_rss": "92156", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:11:32.463856 [debug] [MainThread]: Command `dbt clean` succeeded at 07:11:32.463754 after 0.21 seconds
[0m07:11:32.464288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f01daa360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0198aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0244e240>]}
[0m07:11:32.464747 [debug] [MainThread]: Flushing usage events
[0m14:05:31.318715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e931f84a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e93c41c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e91a6d070>]}


============================== 14:05:31.337988 | 772986b1-c385-433d-a285-388cd31a4cd3 ==============================
[0m14:05:31.337988 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:31.338724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:31.483950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '772986b1-c385-433d-a285-388cd31a4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e919317c0>]}
[0m14:05:31.502058 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x1q6uvtx'
[0m14:05:31.502768 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:31.575977 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:31.576884 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:31.605729 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:31.610171 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:31.685858 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:31.686514 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:31.687173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '772986b1-c385-433d-a285-388cd31a4cd3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e91620d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e91622a80>]}
[0m14:05:31.687652 [info ] [MainThread]: 
[0m14:05:31.688137 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:31.736188 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46638042, "process_user_time": 1.566557, "process_kernel_time": 0.165538, "process_mem_max_rss": "93772", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:31.736965 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:31.736853 after 0.47 seconds
[0m14:05:31.737451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e91b9a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e93c41c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e919317c0>]}
[0m14:05:31.738137 [debug] [MainThread]: Flushing usage events
[0m14:05:33.321146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979cb66510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979b1d5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979b1d59a0>]}


============================== 14:05:33.323859 | 533fe736-a419-4f65-a286-321973f941b4 ==============================
[0m14:05:33.323859 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:33.324589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:33.555308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979bfbd280>]}
[0m14:05:33.614592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979b235580>]}
[0m14:05:33.617041 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:33.644784 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:33.645482 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:33.646043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979a8c4440>]}
[0m14:05:34.870868 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:34.871529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9793715a60>]}
[0m14:05:35.053715 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:35.059081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97932a83b0>]}
[0m14:05:35.193511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97933bfad0>]}
[0m14:05:35.194095 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:35.194601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979311daf0>]}
[0m14:05:35.196348 [info ] [MainThread]: 
[0m14:05:35.197080 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:35.201963 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:35.237376 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:35.237876 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:35.238281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:35.759731 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:35.761323 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:35.763475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:35.764058 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:35.771331 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:35.771780 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:35.772187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:35.778513 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.779962 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:35.780387 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:35.780993 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.781401 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:35.781822 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:35.782423 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.783343 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:35.783758 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:35.784144 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:35.784694 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.785119 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:35.787941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:35.794587 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:35.795007 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:35.795379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:35.801489 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.801942 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:35.802364 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:35.824658 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.826316 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:35.827567 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:35.827980 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:35.831554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97933f4e00>]}
[0m14:05:35.832078 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:35.832477 [debug] [MainThread]: On master: BEGIN
[0m14:05:35.832851 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:35.839372 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:35.839804 [debug] [MainThread]: On master: COMMIT
[0m14:05:35.840202 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:35.840578 [debug] [MainThread]: On master: COMMIT
[0m14:05:35.841112 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:35.841517 [debug] [MainThread]: On master: Close
[0m14:05:35.842899 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:35.843408 [info ] [MainThread]: 
[0m14:05:35.875738 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:35.876351 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:35.877026 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:35.877481 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:35.903921 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:35.904693 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:35.940700 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:35.941474 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:43.507498 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.508036 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:43.508738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.509190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.509661 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:43.510509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.513489 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.513978 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:43.514686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.535678 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:43.536212 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.536675 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:43.538839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.544191 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.544672 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:43.546018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.548455 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:43.578943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97753affb0>]}
[0m14:05:43.579818 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.70s]
[0m14:05:43.580611 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:43.581649 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:43.582234 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:43.582851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:43.583327 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:43.588748 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:43.589459 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:43.623802 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.624397 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241030140543617789"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:43.624876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:43.639954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.648077 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.648589 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:43.649254 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.649737 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.650189 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241030140543617789'
      
      
      order by ordinal_position

  
[0m14:05:43.671578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.678654 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.679177 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:43.682513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.690591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.691091 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:43.694278 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.712758 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:43.713591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.714122 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241030140543617789"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241030140543617789"
    )
  
[0m14:05:43.744897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.746998 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:43.747478 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.747907 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:43.757025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.758054 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:43.934847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975c249340>]}
[0m14:05:43.935672 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m14:05:43.936519 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:43.938240 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:43.938720 [debug] [MainThread]: On master: BEGIN
[0m14:05:43.939156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:43.946303 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:43.946830 [debug] [MainThread]: On master: COMMIT
[0m14:05:43.947279 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:43.947710 [debug] [MainThread]: On master: COMMIT
[0m14:05:43.948314 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:43.948770 [debug] [MainThread]: On master: Close
[0m14:05:43.950524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:43.950965 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:43.951383 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:43.951876 [info ] [MainThread]: 
[0m14:05:43.952430 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.75 seconds (8.75s).
[0m14:05:43.953484 [debug] [MainThread]: Command end result
[0m14:05:43.981922 [info ] [MainThread]: 
[0m14:05:43.982651 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:43.983205 [info ] [MainThread]: 
[0m14:05:43.983771 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:43.984841 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.711764, "process_user_time": 5.053734, "process_kernel_time": 0.341146, "process_mem_max_rss": "293228", "process_in_blocks": "3808", "process_out_blocks": "114664"}
[0m14:05:43.985499 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:43.985384 after 10.71 seconds
[0m14:05:43.986058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979aad5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97931c36b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9793778ce0>]}
[0m14:05:43.986555 [debug] [MainThread]: Flushing usage events
[0m14:05:45.767052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8dcb3e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8dcb3f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8dcb3f3e0>]}


============================== 14:05:45.770041 | 0a2fed02-361e-46a6-b20a-3f32bd5c472e ==============================
[0m14:05:45.770041 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:45.770721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:45.924937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a2fed02-361e-46a6-b20a-3f32bd5c472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8de063140>]}
[0m14:05:45.942147 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22490598, "process_user_time": 1.439913, "process_kernel_time": 0.135991, "process_mem_max_rss": "92392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:45.942761 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:45.942652 after 0.23 seconds
[0m14:05:45.943225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e05bbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8dc9f78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8dc983650>]}
[0m14:05:45.943667 [debug] [MainThread]: Flushing usage events
[0m22:05:32.794375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2d4e74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2d8e5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2d8e7770>]}


============================== 22:05:32.801468 | a933c01e-a343-4572-b32d-fd2451372a03 ==============================
[0m22:05:32.801468 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:32.802123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:32.939746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a933c01e-a343-4572-b32d-fd2451372a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2ce0ba10>]}
[0m22:05:32.952884 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qzgos0nv'
[0m22:05:32.953334 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:33.061691 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:33.062296 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:33.085334 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:33.089129 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:33.159277 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:33.159851 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:33.160354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a933c01e-a343-4572-b32d-fd2451372a03', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2cefbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2cf535c0>]}
[0m22:05:33.160790 [info ] [MainThread]: 
[0m22:05:33.161247 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:33.162867 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41637897, "process_user_time": 1.548966, "process_kernel_time": 0.116072, "process_mem_max_rss": "93764", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:05:33.163482 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:33.163375 after 0.42 seconds
[0m22:05:33.163909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c30dbbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2ce949e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2cefbd40>]}
[0m22:05:33.164323 [debug] [MainThread]: Flushing usage events
[0m22:05:34.748591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6608b05d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6608ec0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6608136930>]}


============================== 22:05:34.751354 | 57ca03ca-2167-4b8c-8d10-a26d604438f3 ==============================
[0m22:05:34.751354 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:34.752057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:34.985796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6608000ef0>]}
[0m22:05:35.045579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6607fe6090>]}
[0m22:05:35.048225 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:35.079159 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:35.079927 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:35.080466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6607ec7860>]}
[0m22:05:36.320608 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:36.321298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6607e50c50>]}
[0m22:05:36.505043 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:36.510331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f660083c830>]}
[0m22:05:36.632646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f660089cd40>]}
[0m22:05:36.633190 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:36.633669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6600891f40>]}
[0m22:05:36.635367 [info ] [MainThread]: 
[0m22:05:36.636038 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:36.640869 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:36.675557 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:36.675999 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:36.676458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:37.229363 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:37.230861 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:37.232848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:37.233393 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:37.240440 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:37.240870 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:37.241256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:37.247813 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.249236 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:37.249640 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:37.250182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.250597 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:37.250969 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:37.251571 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.252479 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:37.252875 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:37.253246 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:37.253791 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.254198 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:37.256121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:37.262653 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:37.263068 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:37.263502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:37.269467 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.269877 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:37.270271 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:37.292316 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.293817 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:37.295009 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:37.295439 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:37.298745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6600891340>]}
[0m22:05:37.299251 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:37.299681 [debug] [MainThread]: On master: BEGIN
[0m22:05:37.300048 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:37.306271 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:37.306697 [debug] [MainThread]: On master: COMMIT
[0m22:05:37.307083 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:37.307505 [debug] [MainThread]: On master: COMMIT
[0m22:05:37.308032 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:37.308441 [debug] [MainThread]: On master: Close
[0m22:05:37.309909 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:37.310442 [info ] [MainThread]: 
[0m22:05:37.319718 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:37.320305 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:37.321022 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:37.321464 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:37.347257 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:37.348018 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:37.383655 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:37.384385 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:44.510440 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:44.510952 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:44.511604 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.512060 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:44.512500 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:44.513219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.516091 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:44.516549 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:44.517237 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.538239 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:44.538728 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:44.539164 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:44.541283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.546241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:44.546714 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:44.548312 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.550613 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:44.580629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c1c8f710>]}
[0m22:05:44.581334 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.26s]
[0m22:05:44.582203 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:44.583143 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:44.583741 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:44.584401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:44.584854 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:44.589850 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:44.590498 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:44.623987 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.624488 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241030220544618078"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:44.624962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:44.639291 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.646688 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.647152 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:44.647777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.648229 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.648666 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241030220544618078'
      
      
      order by ordinal_position

  
[0m22:05:44.669402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.675536 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.676032 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:44.679631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.687186 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.687703 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:44.690459 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.708090 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:44.708772 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.709314 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241030220544618078"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241030220544618078"
    )
  
[0m22:05:44.741712 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.743723 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:44.744185 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.744614 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:44.756578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.757481 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:44.926557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c143bf80>]}
[0m22:05:44.927389 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m22:05:44.928256 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:44.929783 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:44.930263 [debug] [MainThread]: On master: BEGIN
[0m22:05:44.930689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:44.937543 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:44.938010 [debug] [MainThread]: On master: COMMIT
[0m22:05:44.938443 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:44.938859 [debug] [MainThread]: On master: COMMIT
[0m22:05:44.939458 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:44.939912 [debug] [MainThread]: On master: Close
[0m22:05:44.941338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:44.941767 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:44.942170 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:44.942623 [info ] [MainThread]: 
[0m22:05:44.943168 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.31 seconds (8.31s).
[0m22:05:44.944227 [debug] [MainThread]: Command end result
[0m22:05:44.971878 [info ] [MainThread]: 
[0m22:05:44.972508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:44.973045 [info ] [MainThread]: 
[0m22:05:44.973596 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:44.974614 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.27466, "process_user_time": 5.08905, "process_kernel_time": 0.2689, "process_mem_max_rss": "286544", "process_in_blocks": "3808", "process_out_blocks": "114696"}
[0m22:05:44.975261 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:44.975150 after 10.28 seconds
[0m22:05:44.975778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66081370b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c142ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6600b31370>]}
[0m22:05:44.976263 [debug] [MainThread]: Flushing usage events
[0m22:05:46.584643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034b3e8200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034a1f2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034a1f2510>]}


============================== 22:05:46.587402 | e7756a84-6256-4e5b-acf6-d96d48fd696b ==============================
[0m22:05:46.587402 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:46.588064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:46.725969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7756a84-6256-4e5b-acf6-d96d48fd696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034b20d940>]}
[0m22:05:46.741959 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2059205, "process_user_time": 1.385844, "process_kernel_time": 0.112474, "process_mem_max_rss": "92012", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:46.742524 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:46.742421 after 0.21 seconds
[0m22:05:46.742967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034b3e8200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034a107ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034dfbbd10>]}
[0m22:05:46.743419 [debug] [MainThread]: Flushing usage events
[0m06:02:01.986404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0825b244d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08243dd280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08243dd310>]}


============================== 06:02:02.006284 | 35459be1-507c-48e0-9371-9a69039d33f6 ==============================
[0m06:02:02.006284 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:02.006904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:02.142201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35459be1-507c-48e0-9371-9a69039d33f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0827bbbd10>]}
[0m06:02:02.155510 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ft1eyf1u'
[0m06:02:02.155979 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:02.277965 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:02.278582 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:02.304997 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:02.308819 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:02.382360 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:02.382851 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:02.383340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '35459be1-507c-48e0-9371-9a69039d33f6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0823f6d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0823f6f9e0>]}
[0m06:02:02.383771 [info ] [MainThread]: 
[0m06:02:02.384216 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:02.390664 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45213374, "process_user_time": 1.483572, "process_kernel_time": 0.184943, "process_mem_max_rss": "93608", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:02.391248 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:02.391145 after 0.45 seconds
[0m06:02:02.391677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08243dd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0824b5ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08245c9bb0>]}
[0m06:02:02.392099 [debug] [MainThread]: Flushing usage events
[0m06:02:03.943982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1519e5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb150439640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1501424b0>]}


============================== 06:02:03.946672 | aa4d2281-1e50-4130-9028-1638e6de0f08 ==============================
[0m06:02:03.946672 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:03.947334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:04.183135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14fe2fe90>]}
[0m06:02:04.242109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1532a0560>]}
[0m06:02:04.244554 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:04.269189 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:04.269902 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:04.270440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14fdd4ad0>]}
[0m06:02:05.490512 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:05.491191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb148b59bb0>]}
[0m06:02:05.670467 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:05.675383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb148988ce0>]}
[0m06:02:05.795687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1488a0260>]}
[0m06:02:05.796224 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:05.796734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14892f590>]}
[0m06:02:05.798413 [info ] [MainThread]: 
[0m06:02:05.799091 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:05.804012 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:05.838929 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:05.839369 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:05.839759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:06.360715 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:06.362322 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:06.364431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:06.365038 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:06.372167 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.372598 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:06.373025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:06.379354 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.380811 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.381257 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:06.381852 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.382241 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.382612 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:06.383231 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.384138 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:06.384538 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.384949 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:06.385486 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.385883 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:06.387824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:06.394942 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:06.395351 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:06.395715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:06.401660 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.402063 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:06.402447 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:06.425850 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.427285 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:06.428484 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:06.428935 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:06.432240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb148ad2e70>]}
[0m06:02:06.432743 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.433167 [debug] [MainThread]: On master: BEGIN
[0m06:02:06.433533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:06.439796 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.440215 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.440599 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.441063 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.441624 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.442021 [debug] [MainThread]: On master: Close
[0m06:02:06.443450 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:06.443947 [info ] [MainThread]: 
[0m06:02:06.458742 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:06.459329 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:06.459975 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:06.460402 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:06.485959 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:06.486678 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:06.521833 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:06.522572 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:14.879463 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.879979 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:14.880613 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.881095 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.881525 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:14.882220 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.885071 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.885532 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:14.886211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.907127 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:14.907601 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.908032 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:14.909447 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.914291 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.914749 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:14.916342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.918669 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:14.948431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb109452390>]}
[0m06:02:14.949170 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.49s]
[0m06:02:14.949935 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:14.950920 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:14.951546 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:14.952215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:14.952667 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:14.957734 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:14.958376 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:14.991704 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:14.992197 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241031060214985881"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:14.992666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:15.006712 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.013936 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.014402 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:15.014984 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.015426 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.015858 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241031060214985881'
      
      
      order by ordinal_position

  
[0m06:02:15.036555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.042846 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.043335 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:15.046386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.053911 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.054386 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:15.057337 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.075043 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:15.075717 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.076178 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241031060214985881"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241031060214985881"
    )
  
[0m06:02:15.108527 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.110499 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:15.110954 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.111374 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:15.119452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.120328 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:15.300105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1093946e0>]}
[0m06:02:15.300899 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m06:02:15.301757 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:15.303195 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.303659 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.304085 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:15.310875 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.311338 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.311771 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.312191 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.312832 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.313319 [debug] [MainThread]: On master: Close
[0m06:02:15.314710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:15.315137 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:15.315530 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:15.315976 [info ] [MainThread]: 
[0m06:02:15.316555 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.52 seconds (9.52s).
[0m06:02:15.317692 [debug] [MainThread]: Command end result
[0m06:02:15.345269 [info ] [MainThread]: 
[0m06:02:15.345900 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:15.346431 [info ] [MainThread]: 
[0m06:02:15.346978 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:15.347988 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.452166, "process_user_time": 5.543529, "process_kernel_time": 0.299758, "process_mem_max_rss": "299564", "process_in_blocks": "3808", "process_out_blocks": "115184"}
[0m06:02:15.348630 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:15.348510 after 11.45 seconds
[0m06:02:15.349198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb150b286b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1405874d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1093811f0>]}
[0m06:02:15.349678 [debug] [MainThread]: Flushing usage events
[0m06:02:16.970623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d85f85e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d862fcd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d85ee7140>]}


============================== 06:02:16.973353 | c4d4a696-e598-4cba-9999-7b567f7ee9dd ==============================
[0m06:02:16.973353 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:16.973984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.108624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4d4a696-e598-4cba-9999-7b567f7ee9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d85bbd580>]}
[0m06:02:17.124601 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20221986, "process_user_time": 1.383761, "process_kernel_time": 0.108294, "process_mem_max_rss": "92376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:17.125200 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:17.125097 after 0.20 seconds
[0m06:02:17.125626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d8631f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d8705b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d8609bc80>]}
[0m06:02:17.126045 [debug] [MainThread]: Flushing usage events
[0m14:05:12.585509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee23681f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee22098c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee220987a0>]}


============================== 14:05:12.592857 | cb83d02c-2efc-4e50-93da-4ebfb92ac636 ==============================
[0m14:05:12.592857 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:12.593570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:12.734086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb83d02c-2efc-4e50-93da-4ebfb92ac636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2136a690>]}
[0m14:05:12.747329 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ffqantpp'
[0m14:05:12.747778 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:12.794977 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:12.795628 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:12.828058 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:12.832045 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:13.046322 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:13.046896 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:13.047428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cb83d02c-2efc-4e50-93da-4ebfb92ac636', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee21058770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee21050740>]}
[0m14:05:13.047891 [info ] [MainThread]: 
[0m14:05:13.048362 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:13.049963 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5126817, "process_user_time": 1.559167, "process_kernel_time": 0.148683, "process_mem_max_rss": "93780", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m14:05:13.050565 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:13.050459 after 0.51 seconds
[0m14:05:13.051005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee23681f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee210738c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee215c7bf0>]}
[0m14:05:13.051444 [debug] [MainThread]: Flushing usage events
[0m14:05:14.896621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a13ec7e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a14e214c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a142c4bf0>]}


============================== 14:05:14.899523 | bf2d6929-e44b-4a94-b22b-c4285fb0f905 ==============================
[0m14:05:14.899523 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:14.900163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:15.139888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a1328ddc0>]}
[0m14:05:15.199482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a1350a030>]}
[0m14:05:15.202119 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:15.235901 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:15.236665 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:15.237294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a132ba990>]}
[0m14:05:16.461048 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:16.461721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a07d9e750>]}
[0m14:05:16.642721 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:16.647935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a13ff4770>]}
[0m14:05:16.793510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a0c1adeb0>]}
[0m14:05:16.794098 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:16.794624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a07d23d10>]}
[0m14:05:16.796380 [info ] [MainThread]: 
[0m14:05:16.797119 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:16.802119 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:16.838024 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:16.838507 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:16.838966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:17.257459 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.259013 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:17.261257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:17.261874 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:17.269008 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:17.269475 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:17.269885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:17.276417 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.277975 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:17.278382 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:17.278970 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.279367 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:17.279746 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:17.280323 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.281245 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:17.281683 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:17.282055 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:17.282593 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.282997 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:17.285098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:17.292487 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:17.292915 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:17.293289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:17.299650 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.300118 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:17.300523 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:17.324251 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.325967 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:17.327228 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:17.327638 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:17.331422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a07de8110>]}
[0m14:05:17.331950 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:17.332354 [debug] [MainThread]: On master: BEGIN
[0m14:05:17.332731 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:17.339425 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:17.339871 [debug] [MainThread]: On master: COMMIT
[0m14:05:17.340265 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:17.340644 [debug] [MainThread]: On master: COMMIT
[0m14:05:17.341174 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:17.341634 [debug] [MainThread]: On master: Close
[0m14:05:17.343134 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:17.343631 [info ] [MainThread]: 
[0m14:05:17.353212 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:17.353879 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:17.354580 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:17.355016 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:17.381433 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:17.382306 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:17.418959 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:17.419883 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:25.631404 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.631956 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:25.632625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.633091 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.633568 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:25.634297 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.637324 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.637831 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:25.638545 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.659588 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:25.660083 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.660536 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:25.662832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.667908 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.668372 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:25.669730 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.672090 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:25.702279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a07d3bb00>]}
[0m14:05:25.703073 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.35s]
[0m14:05:25.703979 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:25.705005 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:25.705612 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:25.706299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:25.706755 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:25.712102 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:25.712784 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:25.746943 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.747469 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241031140525740986"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:25.747949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:25.764752 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.772632 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.773118 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:25.773755 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.774201 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.774633 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241031140525740986'
      
      
      order by ordinal_position

  
[0m14:05:25.795579 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.802228 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.802720 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:25.805904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.813619 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.814104 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:25.816955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.834985 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:25.835722 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.836200 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241031140525740986"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241031140525740986"
    )
  
[0m14:05:25.868880 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.870949 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:25.871418 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.871849 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:25.880608 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.881580 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:26.062825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d0816510>]}
[0m14:05:26.063692 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m14:05:26.064582 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:26.066105 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.066586 [debug] [MainThread]: On master: BEGIN
[0m14:05:26.067014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:26.074362 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.074869 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.075307 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.075730 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.076326 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.076783 [debug] [MainThread]: On master: Close
[0m14:05:26.078698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:26.079134 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:26.079536 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:26.080006 [info ] [MainThread]: 
[0m14:05:26.080597 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.28 seconds (9.28s).
[0m14:05:26.081803 [debug] [MainThread]: Command end result
[0m14:05:26.110722 [info ] [MainThread]: 
[0m14:05:26.111448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:26.112040 [info ] [MainThread]: 
[0m14:05:26.112639 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:26.113773 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.26582, "process_user_time": 5.358878, "process_kernel_time": 0.324174, "process_mem_max_rss": "292860", "process_in_blocks": "3808", "process_out_blocks": "115168"}
[0m14:05:26.114427 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:26.114315 after 11.27 seconds
[0m14:05:26.114923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a13abbfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a13841bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a0c1eb830>]}
[0m14:05:26.115410 [debug] [MainThread]: Flushing usage events
[0m14:05:28.063396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2602cd460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe262215910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe26027bf80>]}


============================== 14:05:28.066329 | 1f7360ab-b46d-477c-9cfb-b51f8446c6ec ==============================
[0m14:05:28.066329 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:28.066990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:28.207716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f7360ab-b46d-477c-9cfb-b51f8446c6ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe25fe364b0>]}
[0m14:05:28.224098 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20950903, "process_user_time": 1.40454, "process_kernel_time": 0.128049, "process_mem_max_rss": "92328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:28.224702 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:28.224597 after 0.21 seconds
[0m14:05:28.225158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe261387590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe25fca7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe262215910>]}
[0m14:05:28.225634 [debug] [MainThread]: Flushing usage events
[0m22:05:50.547394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cabc9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cab85340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cb336ab0>]}


============================== 22:05:50.555050 | 896cb817-78f7-4e3c-9afc-9303f170ab11 ==============================
[0m22:05:50.555050 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:50.555747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:50.690793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '896cb817-78f7-4e3c-9afc-9303f170ab11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ca857800>]}
[0m22:05:50.703982 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-71b2j33o'
[0m22:05:50.704422 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:50.791180 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:50.791782 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:50.802869 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:50.806665 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:50.979886 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:50.980385 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:50.980888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '896cb817-78f7-4e3c-9afc-9303f170ab11', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ca90e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ca90f2c0>]}
[0m22:05:50.981365 [info ] [MainThread]: 
[0m22:05:50.981836 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:50.983609 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48344803, "process_user_time": 1.596709, "process_kernel_time": 0.112049, "process_mem_max_rss": "93812", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:05:50.984180 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:50.984081 after 0.48 seconds
[0m22:05:50.984603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52caf8fef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cdfe5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cb6ff530>]}
[0m22:05:50.985015 [debug] [MainThread]: Flushing usage events
[0m22:05:52.688488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce1101d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce2015610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce0bcaf90>]}


============================== 22:05:52.691204 | 2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93 ==============================
[0m22:05:52.691204 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:52.691839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:52.921719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce057f860>]}
[0m22:05:52.980437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce05616d0>]}
[0m22:05:52.983002 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:52.999221 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:52.999980 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:53.000514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce047a1b0>]}
[0m22:05:54.235856 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:54.236849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd912e900>]}
[0m22:05:54.416701 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:54.421806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd8fda180>]}
[0m22:05:54.541379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd8e01fd0>]}
[0m22:05:54.541933 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:54.542428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd8ea3410>]}
[0m22:05:54.544137 [info ] [MainThread]: 
[0m22:05:54.544857 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:54.549760 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:54.585012 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:54.585480 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:54.585877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:55.085357 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.086992 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:55.089326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:55.089916 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:55.097309 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.097748 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:55.098160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:55.104581 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.106102 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.106515 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:55.107064 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.107460 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.107841 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:55.108450 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.109414 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:55.109824 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.110205 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:55.110759 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.111164 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:55.113144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:55.120446 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:55.120860 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:55.121265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:55.127175 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.127590 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:55.127987 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:55.151447 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.152912 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:55.154166 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:55.154571 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:55.157964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce1ca4e30>]}
[0m22:05:55.158506 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.158897 [debug] [MainThread]: On master: BEGIN
[0m22:05:55.159270 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:55.165585 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.166009 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.166401 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.166776 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.167314 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.167716 [debug] [MainThread]: On master: Close
[0m22:05:55.169219 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:55.169755 [info ] [MainThread]: 
[0m22:05:55.179060 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:55.179654 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:55.180379 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:55.180831 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:55.206934 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:55.207688 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:55.243703 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:55.244432 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:02.881780 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:02.882313 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:02.882945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.883403 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:02.883860 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:02.884583 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.887553 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:02.888011 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:02.888702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.909748 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:02.910235 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:02.910677 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:02.912512 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.917504 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:02.917977 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:02.919106 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.921429 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:02.951395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd8e01280>]}
[0m22:06:02.952144 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.77s]
[0m22:06:02.952908 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:02.953941 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:02.954515 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:02.955096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:02.955548 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:02.960698 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:02.961403 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:02.995306 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:02.995818 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241031220602989380"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:02.996307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:03.010495 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.018043 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.018518 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:03.019125 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.019578 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.020017 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241031220602989380'
      
      
      order by ordinal_position

  
[0m22:06:03.041815 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.048007 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.048499 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:03.051540 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.059123 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.059607 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:03.062429 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.080486 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:03.081203 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.081682 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241031220602989380"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241031220602989380"
    )
  
[0m22:06:03.112576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.114746 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:03.115249 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.115688 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:03.124226 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.125148 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:03.322167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c99a25940>]}
[0m22:06:03.322988 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m22:06:03.323745 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:03.325246 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:03.325734 [debug] [MainThread]: On master: BEGIN
[0m22:06:03.326178 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:03.333008 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:03.333557 [debug] [MainThread]: On master: COMMIT
[0m22:06:03.333996 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:03.334418 [debug] [MainThread]: On master: COMMIT
[0m22:06:03.335003 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:03.335457 [debug] [MainThread]: On master: Close
[0m22:06:03.336860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:03.337339 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:03.337753 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:03.338216 [info ] [MainThread]: 
[0m22:06:03.338810 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.79 seconds (8.79s).
[0m22:06:03.339915 [debug] [MainThread]: Command end result
[0m22:06:03.369171 [info ] [MainThread]: 
[0m22:06:03.369999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:03.370651 [info ] [MainThread]: 
[0m22:06:03.371319 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:03.372444 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.732155, "process_user_time": 5.594649, "process_kernel_time": 0.303276, "process_mem_max_rss": "299264", "process_in_blocks": "3808", "process_out_blocks": "116744"}
[0m22:06:03.373084 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:03.372974 after 10.73 seconds
[0m22:06:03.373611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce41bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce0802690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd90a0350>]}
[0m22:06:03.374094 [debug] [MainThread]: Flushing usage events
[0m22:06:05.124654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81959d63c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8195cea6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81959d6390>]}


============================== 22:06:05.128356 | e32a2e0d-9351-43a4-be55-5e36bfad6a5e ==============================
[0m22:06:05.128356 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:05.129195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:05.275400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e32a2e0d-9351-43a4-be55-5e36bfad6a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8198d13410>]}
[0m22:06:05.291799 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23422936, "process_user_time": 1.426607, "process_kernel_time": 0.123879, "process_mem_max_rss": "91956", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:05.292360 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:05.292259 after 0.23 seconds
[0m22:06:05.292789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81959d6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8195ab2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8198d13410>]}
[0m22:06:05.293236 [debug] [MainThread]: Flushing usage events
[0m06:02:04.993052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a04473c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a055046e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a044713d0>]}


============================== 06:02:05.000317 | 69dd1be5-e3d3-455a-9ffd-bf5bd6f4a8e0 ==============================
[0m06:02:05.000317 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:05.000922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:05.140503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69dd1be5-e3d3-455a-9ffd-bf5bd6f4a8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a048e1e80>]}
[0m06:02:05.154002 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-972_4mpt'
[0m06:02:05.154464 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:05.314249 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:05.314946 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:05.324576 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:05.328536 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:05.371412 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:05.371996 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:05.372594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '69dd1be5-e3d3-455a-9ffd-bf5bd6f4a8e0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a043168a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a04c75970>]}
[0m06:02:05.373208 [info ] [MainThread]: 
[0m06:02:05.373743 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:05.375448 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43069765, "process_user_time": 1.564496, "process_kernel_time": 0.141491, "process_mem_max_rss": "93540", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:05.376075 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:05.375968 after 0.43 seconds
[0m06:02:05.376514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a04c260c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a04858770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a04d87530>]}
[0m06:02:05.376942 [debug] [MainThread]: Flushing usage events
[0m06:02:06.927941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079d2c47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079d101a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079cf05b50>]}


============================== 06:02:06.930959 | b5f6ec7f-4054-438d-a628-8c3493bafe55 ==============================
[0m06:02:06.930959 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:06.931719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.170972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079c303590>]}
[0m06:02:07.231571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079c3873e0>]}
[0m06:02:07.234233 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:07.270207 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:07.270970 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:07.271505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079c2c6060>]}
[0m06:02:08.514687 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:08.515383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07953132f0>]}
[0m06:02:08.699580 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:08.705094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0794d72270>]}
[0m06:02:08.866522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0794ca87d0>]}
[0m06:02:08.867122 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:08.867652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0794c0d6a0>]}
[0m06:02:08.869472 [info ] [MainThread]: 
[0m06:02:08.870216 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:08.875178 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:08.911466 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:08.912010 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:08.912417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:09.416364 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:09.417919 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:09.420165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:09.420722 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:09.427938 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.428366 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:09.428758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:09.435010 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.436462 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.436868 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:09.437396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.437788 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.438162 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:09.438715 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.439622 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:09.440072 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.440456 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:09.441008 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.441425 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:09.443335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:09.450397 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:09.450812 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:09.451191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:09.457126 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.457545 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:09.457941 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:09.481142 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.482612 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:09.483822 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:09.484268 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:09.487625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07951acd40>]}
[0m06:02:09.488176 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:09.488579 [debug] [MainThread]: On master: BEGIN
[0m06:02:09.488962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:09.495141 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:09.495565 [debug] [MainThread]: On master: COMMIT
[0m06:02:09.496011 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:09.496389 [debug] [MainThread]: On master: COMMIT
[0m06:02:09.496922 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:09.497330 [debug] [MainThread]: On master: Close
[0m06:02:09.498617 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:09.499114 [info ] [MainThread]: 
[0m06:02:09.508468 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:09.509069 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:09.509729 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:09.510172 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:09.536755 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:09.537521 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:09.573846 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:09.574598 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:15.403486 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.404014 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:15.404644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.405090 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.405520 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:15.406204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.409094 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.409551 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:15.410234 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.431128 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:15.431608 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.432080 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:15.433506 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.438423 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.438893 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:15.440044 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.442370 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:15.472469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0755781100>]}
[0m06:02:15.473223 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 5.96s]
[0m06:02:15.474097 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:15.475084 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:15.475643 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:15.476352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:15.476842 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:15.482053 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:15.482709 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:15.516714 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.517223 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241101060215510750"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:15.517695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:15.532942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.540542 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.541021 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:15.541626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.542071 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.542511 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241101060215510750'
      
      
      order by ordinal_position

  
[0m06:02:15.563990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.570192 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.570680 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:15.575213 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.582750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.583230 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:15.587424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.605900 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:15.606618 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.607093 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241101060215510750"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241101060215510750"
    )
  
[0m06:02:15.638292 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.640380 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:15.640843 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.641271 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:15.649177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.650144 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:15.850414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f075552a930>]}
[0m06:02:15.851264 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m06:02:15.852180 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:15.853601 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.854071 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.854497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:15.861398 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.861879 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.862317 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.862743 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.863326 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.863787 [debug] [MainThread]: On master: Close
[0m06:02:15.865260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:15.865702 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:15.866103 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:15.866569 [info ] [MainThread]: 
[0m06:02:15.867163 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.00 seconds (7.00s).
[0m06:02:15.868320 [debug] [MainThread]: Command end result
[0m06:02:15.896956 [info ] [MainThread]: 
[0m06:02:15.897647 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:15.898236 [info ] [MainThread]: 
[0m06:02:15.898845 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:15.899975 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.021043, "process_user_time": 5.706056, "process_kernel_time": 0.281681, "process_mem_max_rss": "301804", "process_in_blocks": "3808", "process_out_blocks": "116720"}
[0m06:02:15.900626 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:15.900513 after 9.02 seconds
[0m06:02:15.901117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079c5b2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07949a17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079c9d7e00>]}
[0m06:02:15.901611 [debug] [MainThread]: Flushing usage events
[0m06:02:17.628215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452c33da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f845226ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f845226e8a0>]}


============================== 06:02:17.631022 | 32bee49d-3509-4c81-9b35-2dbab30d16ea ==============================
[0m06:02:17.631022 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:17.631698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.771062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32bee49d-3509-4c81-9b35-2dbab30d16ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8451ade6f0>]}
[0m06:02:17.787571 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20873599, "process_user_time": 1.400191, "process_kernel_time": 0.116015, "process_mem_max_rss": "92160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:17.788206 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:17.788099 after 0.21 seconds
[0m06:02:17.788657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452c33da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f845224f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8453e21d00>]}
[0m06:02:17.789089 [debug] [MainThread]: Flushing usage events
[0m14:05:05.291813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a48b2ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a49238e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a48627830>]}


============================== 14:05:05.299424 | 745946be-bb89-43aa-bf37-4278c0a7748d ==============================
[0m14:05:05.299424 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:05.300223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:05.446470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '745946be-bb89-43aa-bf37-4278c0a7748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a4804dfa0>]}
[0m14:05:05.460507 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-y0rizk24'
[0m14:05:05.461061 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:05.498907 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:05.499668 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:05.511187 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:05.515260 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:05.725801 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:05.726494 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:05.727211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '745946be-bb89-43aa-bf37-4278c0a7748d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a481e7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a481e7c80>]}
[0m14:05:05.727746 [info ] [MainThread]: 
[0m14:05:05.728300 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:05.730197 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4872031, "process_user_time": 1.611376, "process_kernel_time": 0.112515, "process_mem_max_rss": "93596", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m14:05:05.730823 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:05.730710 after 0.49 seconds
[0m14:05:05.731287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a48173350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a48b2ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a48b2ede0>]}
[0m14:05:05.731743 [debug] [MainThread]: Flushing usage events
[0m14:05:07.588077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61fd21550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e88fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e3fac30>]}


============================== 14:05:07.591124 | 49f7080f-8fb1-4611-9f8b-b26c5584d473 ==============================
[0m14:05:07.591124 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:07.591894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:07.833700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e2b7aa0>]}
[0m14:05:07.892764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61f4aed50>]}
[0m14:05:07.895414 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:07.911356 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:07.912099 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:07.912639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6172302f0>]}
[0m14:05:09.148575 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:09.149309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e2b72f0>]}
[0m14:05:09.333538 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:09.338696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa616b40860>]}
[0m14:05:09.464655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e6fc7a0>]}
[0m14:05:09.465245 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:09.465758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa616bae840>]}
[0m14:05:09.467452 [info ] [MainThread]: 
[0m14:05:09.468157 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:09.472850 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:09.507949 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:09.508409 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:09.508871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:10.138564 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:10.140177 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:10.142555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:10.143151 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:10.150534 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:10.150988 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:10.151394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:10.157811 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:10.159311 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:10.159733 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:10.160456 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:10.160891 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:10.161296 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:10.161959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:10.162881 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:10.163283 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:10.163664 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:10.164265 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:10.164676 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:10.166734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:10.174091 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:10.174540 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:10.174913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:10.181450 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:10.181907 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:10.182307 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:10.207452 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:10.209153 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:10.210434 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:10.210853 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:10.214788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61f9119a0>]}
[0m14:05:10.215379 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:10.215790 [debug] [MainThread]: On master: BEGIN
[0m14:05:10.216165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:10.222884 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:10.223322 [debug] [MainThread]: On master: COMMIT
[0m14:05:10.223718 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:10.224098 [debug] [MainThread]: On master: COMMIT
[0m14:05:10.224671 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:10.225129 [debug] [MainThread]: On master: Close
[0m14:05:10.226677 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:10.227188 [info ] [MainThread]: 
[0m14:05:10.236730 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:10.237391 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:10.238050 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:10.238490 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:10.265137 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:10.266030 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:10.302603 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:10.303557 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:20.860589 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.861140 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:20.861791 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.862241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.862673 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:20.863392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.866346 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.866806 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:20.867503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.888297 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:20.888855 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.889296 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:20.901520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.906827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.907296 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:20.908910 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.911353 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:20.942575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa616df7830>]}
[0m14:05:20.943387 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.70s]
[0m14:05:20.944179 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:20.945202 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:20.945781 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:20.946393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:20.946855 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:20.952172 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:20.952866 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:20.986754 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:20.987316 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241101140520980721"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:20.987796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:21.003735 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.011824 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.012313 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:21.012967 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.013418 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.013851 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241101140520980721'
      
      
      order by ordinal_position

  
[0m14:05:21.034686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.041432 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.041925 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:21.044715 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.052389 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.052887 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:21.055996 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.074142 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:21.074920 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.075408 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241101140520980721"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241101140520980721"
    )
  
[0m14:05:21.108384 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.110461 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:21.110951 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.111388 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:21.121425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.122361 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:21.771691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d74674a0>]}
[0m14:05:21.772515 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.83s]
[0m14:05:21.773408 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:21.774864 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.775340 [debug] [MainThread]: On master: BEGIN
[0m14:05:21.775773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:21.782546 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.783035 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.783473 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.783896 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.784482 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.784991 [debug] [MainThread]: On master: Close
[0m14:05:21.786464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:21.786897 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:21.787299 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:21.787758 [info ] [MainThread]: 
[0m14:05:21.788357 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.32 seconds (12.32s).
[0m14:05:21.789518 [debug] [MainThread]: Command end result
[0m14:05:21.817232 [info ] [MainThread]: 
[0m14:05:21.817931 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:21.818528 [info ] [MainThread]: 
[0m14:05:21.819120 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:21.820214 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.280946, "process_user_time": 6.644992, "process_kernel_time": 0.36673, "process_mem_max_rss": "363868", "process_in_blocks": "3808", "process_out_blocks": "131536"}
[0m14:05:21.820888 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:21.820747 after 14.28 seconds
[0m14:05:21.821384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e494bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e21e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d7457c80>]}
[0m14:05:21.821873 [debug] [MainThread]: Flushing usage events
[0m14:05:23.752115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752ab5fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752aafaf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752b8f8260>]}


============================== 14:05:23.755023 | 61fbd707-4de4-44f4-a33c-00e585185648 ==============================
[0m14:05:23.755023 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.755656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:23.912025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61fbd707-4de4-44f4-a33c-00e585185648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752bfc8650>]}
[0m14:05:23.928866 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22524585, "process_user_time": 1.440011, "process_kernel_time": 0.084, "process_mem_max_rss": "92128", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:23.929458 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:23.929358 after 0.23 seconds
[0m14:05:23.929893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752b8f8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752a61ad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752a618fe0>]}
[0m14:05:23.930325 [debug] [MainThread]: Flushing usage events
[0m22:05:42.232615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd834fc13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83716dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd835ee5100>]}


============================== 22:05:42.240308 | 2cb9c6a7-8d64-4bfe-a41a-c8206efeb61b ==============================
[0m22:05:42.240308 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:42.241054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:42.383012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cb9c6a7-8d64-4bfe-a41a-c8206efeb61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd836315760>]}
[0m22:05:42.396685 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-re6v8gi2'
[0m22:05:42.397151 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:42.430559 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:42.431271 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:42.440645 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:42.444515 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:42.647989 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:42.648633 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:42.649328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2cb9c6a7-8d64-4bfe-a41a-c8206efeb61b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd834c911f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd834c93050>]}
[0m22:05:42.649789 [info ] [MainThread]: 
[0m22:05:42.650303 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:42.651909 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46755692, "process_user_time": 1.5731, "process_kernel_time": 0.136095, "process_mem_max_rss": "93736", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:05:42.652543 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:42.652438 after 0.47 seconds
[0m22:05:42.652980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd835aa8770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd834b03f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8353945c0>]}
[0m22:05:42.653398 [debug] [MainThread]: Flushing usage events
[0m22:05:44.518340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90be0a4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90be1706b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90be3bae40>]}


============================== 22:05:44.521201 | dac8e806-ee3c-45c8-b95e-abb1e46c0c53 ==============================
[0m22:05:44.521201 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:44.521923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:44.757152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90bdec5100>]}
[0m22:05:44.816305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b6f21880>]}
[0m22:05:44.818918 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:44.834670 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:44.835391 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:44.835923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b6e5a780>]}
[0m22:05:46.063951 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:46.064614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b685e510>]}
[0m22:05:46.245913 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:46.251353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b68f5bb0>]}
[0m22:05:46.383865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b67edb80>]}
[0m22:05:46.384474 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:46.384992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b687b7d0>]}
[0m22:05:46.386773 [info ] [MainThread]: 
[0m22:05:46.387522 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:46.392487 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:46.428594 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:46.429103 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:46.429503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:46.876662 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.878208 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:46.880633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:46.881188 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:46.888393 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.888828 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:46.889221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:46.895622 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.897099 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.897512 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:46.898108 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.898517 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.898901 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:46.899504 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.900460 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:46.900879 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.901264 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:46.901802 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.902215 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:46.904088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:46.911157 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:46.911574 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:46.911949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:46.917929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.918346 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:46.918741 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:46.942315 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.943935 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:46.945232 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:46.945639 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:46.949475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90bf5b9400>]}
[0m22:05:46.950013 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:46.950406 [debug] [MainThread]: On master: BEGIN
[0m22:05:46.950780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:46.957380 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:46.957820 [debug] [MainThread]: On master: COMMIT
[0m22:05:46.958213 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:46.958601 [debug] [MainThread]: On master: COMMIT
[0m22:05:46.959129 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:46.959542 [debug] [MainThread]: On master: Close
[0m22:05:46.960985 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:46.961492 [info ] [MainThread]: 
[0m22:05:46.971519 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:46.972205 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:46.972898 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:46.973339 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:46.999473 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:47.000323 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:47.036218 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:47.037077 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:55.562160 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.562685 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:55.563341 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.563813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.564275 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:55.564997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.567879 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.568394 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:55.569081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.589735 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:55.590236 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.590685 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:55.592170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.597188 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.597655 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:55.598962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.601348 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:55.631410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90732809e0>]}
[0m22:05:55.632289 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.66s]
[0m22:05:55.633069 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:55.634058 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:55.634623 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:55.635209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:55.635665 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:55.641083 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:55.641761 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:55.675538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.676122 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241101220555669595"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:55.676627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:55.692356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.700164 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.700638 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:55.701262 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.701712 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.702145 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241101220555669595'
      
      
      order by ordinal_position

  
[0m22:05:55.723138 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.729685 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.730183 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:55.734761 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.742536 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.743013 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:55.745956 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.764000 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:55.764774 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.765246 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241101220555669595"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241101220555669595"
    )
  
[0m22:05:55.795718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.797812 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:55.798277 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.798711 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:55.808281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.809228 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:55.968891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b69707a0>]}
[0m22:05:55.969759 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m22:05:55.970519 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:55.972140 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.972623 [debug] [MainThread]: On master: BEGIN
[0m22:05:55.973055 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:55.980146 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.980653 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.981088 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.981516 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.982108 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.982563 [debug] [MainThread]: On master: Close
[0m22:05:55.984351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:55.984793 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:55.985196 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:55.985675 [info ] [MainThread]: 
[0m22:05:55.986220 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.60 seconds (9.60s).
[0m22:05:55.987247 [debug] [MainThread]: Command end result
[0m22:05:56.015540 [info ] [MainThread]: 
[0m22:05:56.016254 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:56.016774 [info ] [MainThread]: 
[0m22:05:56.017292 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:56.018337 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.547948, "process_user_time": 5.506517, "process_kernel_time": 0.306581, "process_mem_max_rss": "278320", "process_in_blocks": "3808", "process_out_blocks": "114176"}
[0m22:05:56.018987 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:56.018875 after 11.55 seconds
[0m22:05:56.019493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90be3ba2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a5f3f500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90be4c80e0>]}
[0m22:05:56.019984 [debug] [MainThread]: Flushing usage events
[0m22:05:57.997255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec656acf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec66f1d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6567e5a0>]}


============================== 22:05:58.000315 | 1de55447-30d0-4e4c-a4fe-a57c1c4f56a9 ==============================
[0m22:05:58.000315 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:58.001064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:58.151679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1de55447-30d0-4e4c-a4fe-a57c1c4f56a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec654b4ce0>]}
[0m22:05:58.168353 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22000042, "process_user_time": 1.448446, "process_kernel_time": 0.108033, "process_mem_max_rss": "92212", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:58.168945 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:58.168841 after 0.22 seconds
[0m22:05:58.169381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec66208140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6549f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6575a300>]}
[0m22:05:58.169820 [debug] [MainThread]: Flushing usage events
[0m06:02:09.929212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f4879cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f485ba780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f4879de80>]}


============================== 06:02:09.936338 | 785e5a75-c4b0-4128-b9d4-86c53d4f39ff ==============================
[0m06:02:09.936338 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.936990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.071983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '785e5a75-c4b0-4128-b9d4-86c53d4f39ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f486ba720>]}
[0m06:02:10.085115 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-k6v538hr'
[0m06:02:10.085581 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.168308 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.168988 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.180181 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.184185 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.233548 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.234099 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:10.234686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '785e5a75-c4b0-4128-b9d4-86c53d4f39ff', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f47d5b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f47b93e60>]}
[0m06:02:10.235135 [info ] [MainThread]: 
[0m06:02:10.235663 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:10.237281 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.35559773, "process_user_time": 1.542609, "process_kernel_time": 0.139873, "process_mem_max_rss": "93696", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m06:02:10.237867 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:10.237766 after 0.36 seconds
[0m06:02:10.238296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f48166840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f48deac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f47d5b230>]}
[0m06:02:10.238717 [debug] [MainThread]: Flushing usage events
[0m06:02:11.771254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb454fe2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb454fe3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb454fe2b10>]}


============================== 06:02:11.773919 | de4c2218-d05e-42d4-942d-a1f4f3e337d6 ==============================
[0m06:02:11.773919 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:11.774550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.007521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb454ea8530>]}
[0m06:02:12.066105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb45604fec0>]}
[0m06:02:12.068485 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:12.116495 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:12.117307 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:12.117948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44dfbdd60>]}
[0m06:02:13.329823 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:13.330474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44d85f380>]}
[0m06:02:13.509895 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:13.514899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44ddec9e0>]}
[0m06:02:13.633800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44d809d00>]}
[0m06:02:13.634344 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:13.634874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44d8e43e0>]}
[0m06:02:13.636534 [info ] [MainThread]: 
[0m06:02:13.637271 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:13.641907 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:13.676295 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:13.676741 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:13.677170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:14.151735 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.153350 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:14.155534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:14.156094 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:14.163234 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.163666 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:14.164057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.170514 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.171958 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.172373 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:14.172977 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.173422 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.173805 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:14.174399 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.175323 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.175722 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.176102 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.176652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.177057 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:14.179000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:14.185934 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.186341 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:14.186714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.192375 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.192790 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.193226 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:14.216471 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.217920 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:14.219126 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:14.219530 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:14.222715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44d70e840>]}
[0m06:02:14.223226 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.223620 [debug] [MainThread]: On master: BEGIN
[0m06:02:14.223990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:14.230397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.230823 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.231265 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.231645 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.232235 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.232640 [debug] [MainThread]: On master: Close
[0m06:02:14.234248 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:14.234748 [info ] [MainThread]: 
[0m06:02:14.243661 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:14.244247 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:14.244877 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:14.245359 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:14.270754 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:14.271491 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:14.306665 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:14.307388 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:20.563749 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.564250 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:20.564877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.565365 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.565802 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:20.566509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.569345 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.569799 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:20.570483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.591083 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.591559 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.592002 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.593238 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.598143 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.598608 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:20.600029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.602328 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:20.631606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44d9c4380>]}
[0m06:02:20.632299 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.39s]
[0m06:02:20.633060 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:20.634053 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:20.634610 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:20.635207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:20.635665 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:20.640581 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:20.641266 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:20.674368 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.674866 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241102060220668525"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:20.675331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:20.689776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.697208 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.697676 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:20.698303 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.698748 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.699178 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241102060220668525'
      
      
      order by ordinal_position

  
[0m06:02:20.721198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.727198 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.727677 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:20.730492 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.737955 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.738423 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:20.741115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.758817 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:20.759492 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.759969 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241102060220668525"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241102060220668525"
    )
  
[0m06:02:20.789962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.791855 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:20.792319 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.792747 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:20.801082 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.801998 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:20.960186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44df847a0>]}
[0m06:02:20.960940 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m06:02:20.961842 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:20.963200 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.963668 [debug] [MainThread]: On master: BEGIN
[0m06:02:20.964105 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:20.970817 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.971290 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.971726 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.972141 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.972743 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.973228 [debug] [MainThread]: On master: Close
[0m06:02:20.974736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:20.975166 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:20.975568 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:20.976027 [info ] [MainThread]: 
[0m06:02:20.976569 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.34 seconds (7.34s).
[0m06:02:20.977621 [debug] [MainThread]: Command end result
[0m06:02:21.005344 [info ] [MainThread]: 
[0m06:02:21.005981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:21.006514 [info ] [MainThread]: 
[0m06:02:21.007061 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:21.008065 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.284931, "process_user_time": 5.409922, "process_kernel_time": 0.322208, "process_mem_max_rss": "294952", "process_in_blocks": "3808", "process_out_blocks": "114648"}
[0m06:02:21.008704 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:21.008592 after 9.29 seconds
[0m06:02:21.009208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb45507fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb454fe2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4122c8830>]}
[0m06:02:21.009690 [debug] [MainThread]: Flushing usage events
[0m06:02:22.613335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58a2bdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58ab67080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58a2bdd30>]}


============================== 06:02:22.616015 | d98ad81c-143f-4b53-aa0d-07964270d717 ==============================
[0m06:02:22.616015 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:22.616732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:22.751854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd98ad81c-143f-4b53-aa0d-07964270d717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5899cad50>]}
[0m06:02:22.768078 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20298095, "process_user_time": 1.381521, "process_kernel_time": 0.123777, "process_mem_max_rss": "92196", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:22.768640 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:22.768537 after 0.20 seconds
[0m06:02:22.769076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc589808c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58a48b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5897cc7a0>]}
[0m06:02:22.769547 [debug] [MainThread]: Flushing usage events
[0m14:04:51.675244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0d769250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0b182cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0ca28860>]}


============================== 14:04:51.682616 | 6b5feb64-1a56-4aec-ad7d-7c565a8298d4 ==============================
[0m14:04:51.682616 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:51.683291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:51.821889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b5feb64-1a56-4aec-ad7d-7c565a8298d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0b139400>]}
[0m14:04:51.835063 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r2ef8ipp'
[0m14:04:51.835518 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:51.897474 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:51.898059 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:51.907735 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:51.911537 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:52.117431 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:52.117988 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:52.118512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6b5feb64-1a56-4aec-ad7d-7c565a8298d4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0ae7a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0ae7a720>]}
[0m14:04:52.118966 [info ] [MainThread]: 
[0m14:04:52.119432 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:52.125278 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49795356, "process_user_time": 1.5226, "process_kernel_time": 0.162569, "process_mem_max_rss": "93508", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:04:52.125865 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:52.125763 after 0.50 seconds
[0m14:04:52.126290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0af2fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0afa3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0b543890>]}
[0m14:04:52.126703 [debug] [MainThread]: Flushing usage events
[0m14:04:53.893055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200f358890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200ee1b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200f359bb0>]}


============================== 14:04:53.895872 | b090d282-05c8-4230-b986-1233940ce519 ==============================
[0m14:04:53.895872 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:53.896600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:54.136053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200e864e60>]}
[0m14:04:54.196393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200f190620>]}
[0m14:04:54.198921 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:04:54.214532 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:54.215243 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:54.215776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200ea56270>]}
[0m14:04:55.447626 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:55.448290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200738abd0>]}
[0m14:04:55.629886 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:55.635069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2007761580>]}
[0m14:04:55.756378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2007102750>]}
[0m14:04:55.756933 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:55.757481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2007279fd0>]}
[0m14:04:55.759209 [info ] [MainThread]: 
[0m14:04:55.759937 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:55.764712 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:55.800203 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:55.800675 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:55.801070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:56.400450 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:56.402014 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:56.404047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:56.404614 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:56.411747 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:56.412174 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:56.412566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:56.419273 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:56.420666 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:56.421065 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:56.421660 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:56.422052 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:56.422431 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:56.423021 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:56.423931 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:56.424327 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:56.424697 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:56.425245 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:56.425644 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:56.427436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:56.434409 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:56.434819 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:56.435186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:56.441127 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:56.441577 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:56.441972 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:56.465054 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:56.466514 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:56.467695 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:56.468124 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:56.471345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2005fa28d0>]}
[0m14:04:56.471861 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:56.472259 [debug] [MainThread]: On master: BEGIN
[0m14:04:56.472634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:56.478810 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:56.479239 [debug] [MainThread]: On master: COMMIT
[0m14:04:56.479626 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:56.480010 [debug] [MainThread]: On master: COMMIT
[0m14:04:56.480543 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:56.480948 [debug] [MainThread]: On master: Close
[0m14:04:56.482558 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:56.483082 [info ] [MainThread]: 
[0m14:04:56.492661 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:56.493281 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:56.493937 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:56.494380 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:56.520280 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:56.521032 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:56.557052 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:56.557833 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:06.895637 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:06.896148 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:06.896777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:06.897259 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:06.897707 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:06.898446 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:06.901969 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:06.902590 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:06.903422 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:06.929564 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:06.930221 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:06.930770 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:06.932021 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:06.936932 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:06.937432 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:06.938607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:06.940922 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:06.970671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200ff06240>]}
[0m14:05:06.971433 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.48s]
[0m14:05:06.972384 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:06.973606 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:06.974185 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:06.974879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:06.975336 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:06.980652 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:06.981347 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:07.015942 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.016456 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241102140507009980"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:07.016940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:07.032256 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.040221 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.040695 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:07.041353 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.041800 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.042233 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241102140507009980'
      
      
      order by ordinal_position

  
[0m14:05:07.063383 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.069969 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.070461 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:07.073528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.081197 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.081683 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:07.084411 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.102439 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:07.103151 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.103628 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241102140507009980"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241102140507009980"
    )
  
[0m14:05:07.134902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.136857 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:07.137365 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.137817 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:07.145513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.146415 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:07.310585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fc3b7c8f0>]}
[0m14:05:07.311409 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m14:05:07.312174 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:07.313671 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:07.314162 [debug] [MainThread]: On master: BEGIN
[0m14:05:07.314602 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:07.321290 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:07.321768 [debug] [MainThread]: On master: COMMIT
[0m14:05:07.322213 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:07.322640 [debug] [MainThread]: On master: COMMIT
[0m14:05:07.323237 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:07.323696 [debug] [MainThread]: On master: Close
[0m14:05:07.325014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:07.325510 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:07.325930 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:07.326398 [info ] [MainThread]: 
[0m14:05:07.326947 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.57 seconds (11.57s).
[0m14:05:07.327982 [debug] [MainThread]: Command end result
[0m14:05:07.356488 [info ] [MainThread]: 
[0m14:05:07.357167 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:07.357717 [info ] [MainThread]: 
[0m14:05:07.358272 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:07.359305 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.515763, "process_user_time": 5.674154, "process_kernel_time": 0.28471, "process_mem_max_rss": "291952", "process_in_blocks": "3808", "process_out_blocks": "114640"}
[0m14:05:07.359969 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:07.359857 after 13.52 seconds
[0m14:05:07.360467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200ffbc470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fc811ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20073dd940>]}
[0m14:05:07.360962 [debug] [MainThread]: Flushing usage events
[0m14:05:09.227647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d7d64b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772e628f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d7b2540>]}


============================== 14:05:09.230512 | 4376a041-977e-4c72-8442-5e24e84b13e9 ==============================
[0m14:05:09.230512 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:09.231319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:09.402820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4376a041-977e-4c72-8442-5e24e84b13e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772e104a10>]}
[0m14:05:09.419209 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.24267696, "process_user_time": 1.404137, "process_kernel_time": 0.135626, "process_mem_max_rss": "92156", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:09.419787 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:09.419678 after 0.24 seconds
[0m14:05:09.420217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772df93860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772e104a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d7b0560>]}
[0m14:05:09.420647 [debug] [MainThread]: Flushing usage events
[0m22:06:20.006241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc06148d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc063668440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc06148d400>]}


============================== 22:06:20.013622 | 35c5634e-10bd-4a4a-86aa-2a36a90c453c ==============================
[0m22:06:20.013622 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:20.014286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:20.152981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35c5634e-10bd-4a4a-86aa-2a36a90c453c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0614b03e0>]}
[0m22:06:20.166336 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xbrengfd'
[0m22:06:20.166820 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:20.256328 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:20.256940 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:20.279108 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:20.282976 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:20.352894 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:20.353407 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:20.353937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '35c5634e-10bd-4a4a-86aa-2a36a90c453c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc06107bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc06103f680>]}
[0m22:06:20.354383 [info ] [MainThread]: 
[0m22:06:20.354858 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:20.356397 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3983425, "process_user_time": 1.611859, "process_kernel_time": 0.073081, "process_mem_max_rss": "93680", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:06:20.356965 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:20.356863 after 0.40 seconds
[0m22:06:20.357388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc061aad160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0618686e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0614b03e0>]}
[0m22:06:20.357805 [debug] [MainThread]: Flushing usage events
[0m22:06:21.960411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d32ec7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d6213410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d2f96570>]}


============================== 22:06:21.963156 | 912133c3-7dac-409e-ab03-c2c3f5c562d9 ==============================
[0m22:06:21.963156 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:21.963829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:22.194966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d2db5100>]}
[0m22:06:22.253988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d6213410>]}
[0m22:06:22.256406 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:06:22.341631 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:22.342361 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:22.342905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d2c38470>]}
[0m22:06:23.570235 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:23.570918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38cbdc3470>]}
[0m22:06:23.751047 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:23.756027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38cb7064e0>]}
[0m22:06:23.874893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38cb7e10a0>]}
[0m22:06:23.875446 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:23.875954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38cb71ca40>]}
[0m22:06:23.877618 [info ] [MainThread]: 
[0m22:06:23.878295 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:23.883132 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:23.919653 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:23.920100 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:23.920499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:24.407723 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.409268 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:24.411564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:24.412131 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:24.419272 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.419708 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:24.420104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:24.426303 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.427738 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.428152 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:24.428689 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.429082 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.429460 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:24.430024 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.430978 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:24.431387 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.431778 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:24.432311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.432713 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:24.434532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:24.441551 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:24.441963 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:24.442344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:24.448058 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.448474 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:24.448874 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:24.472018 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.473517 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:24.474778 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:24.475184 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:24.478568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d34c9730>]}
[0m22:06:24.479129 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:24.479526 [debug] [MainThread]: On master: BEGIN
[0m22:06:24.479900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:24.486196 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:24.486663 [debug] [MainThread]: On master: COMMIT
[0m22:06:24.487066 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:24.487447 [debug] [MainThread]: On master: COMMIT
[0m22:06:24.488003 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:24.488416 [debug] [MainThread]: On master: Close
[0m22:06:24.489917 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:24.490406 [info ] [MainThread]: 
[0m22:06:24.500428 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:24.501409 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:24.502388 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:24.502935 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:24.528863 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:24.529625 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:24.565220 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:24.565951 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:30.832527 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.833077 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:30.833704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.834158 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.834595 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:30.835377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.838185 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.838673 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:30.839350 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.860182 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:30.860665 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.861106 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:30.863077 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.867993 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.868461 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:30.869595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.871918 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:30.901085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388c2c1a00>]}
[0m22:06:30.901800 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.40s]
[0m22:06:30.902721 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:30.903695 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:30.904263 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:30.904928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:30.905387 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:30.910345 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:30.911025 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:30.944746 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.945264 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241102220630938766"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:30.945738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:30.960021 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.967507 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.967971 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:30.968558 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.969004 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.969449 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241102220630938766'
      
      
      order by ordinal_position

  
[0m22:06:30.989683 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.995728 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.996214 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:30.999360 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.006810 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.007282 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:31.009945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.027858 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:31.028536 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.029009 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241102220630938766"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241102220630938766"
    )
  
[0m22:06:31.059190 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.061179 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:31.061638 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.062066 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:31.071293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.072233 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:31.241388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388c243cb0>]}
[0m22:06:31.242194 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m22:06:31.242979 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:31.244434 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.244934 [debug] [MainThread]: On master: BEGIN
[0m22:06:31.245596 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:31.252390 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.252867 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.253306 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.253740 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.254318 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.254819 [debug] [MainThread]: On master: Close
[0m22:06:31.256285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:31.256729 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:31.257139 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:31.257604 [info ] [MainThread]: 
[0m22:06:31.258142 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.38 seconds (7.38s).
[0m22:06:31.259177 [debug] [MainThread]: Command end result
[0m22:06:31.287299 [info ] [MainThread]: 
[0m22:06:31.287919 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:31.288426 [info ] [MainThread]: 
[0m22:06:31.288945 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:31.289936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.377785, "process_user_time": 5.462315, "process_kernel_time": 0.342639, "process_mem_max_rss": "290648", "process_in_blocks": "3808", "process_out_blocks": "114672"}
[0m22:06:31.290581 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:31.290471 after 9.38 seconds
[0m22:06:31.291121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d2f96480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a5916540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a59f94c0>]}
[0m22:06:31.291604 [debug] [MainThread]: Flushing usage events
[0m22:06:32.914970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9d9e5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9ca71e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9ca71d30>]}


============================== 22:06:32.917689 | 7ee3cd1d-106d-47a1-bc73-17cf6ccb94c1 ==============================
[0m22:06:32.917689 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:32.918425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:33.055249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ee3cd1d-106d-47a1-bc73-17cf6ccb94c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9d01c0b0>]}
[0m22:06:33.071740 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20546384, "process_user_time": 1.398796, "process_kernel_time": 0.095917, "process_mem_max_rss": "92180", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:33.072310 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:33.072207 after 0.21 seconds
[0m22:06:33.072745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9c170f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9d1c9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9c11c500>]}
[0m22:06:33.073176 [debug] [MainThread]: Flushing usage events
[0m06:02:13.091116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342a81460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342bce1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342edb0e0>]}


============================== 06:02:13.098493 | 52aede50-c798-4277-9122-14f1a7110e1b ==============================
[0m06:02:13.098493 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:13.099155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.242479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52aede50-c798-4277-9122-14f1a7110e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342e957f0>]}
[0m06:02:13.256349 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3czfyp_v'
[0m06:02:13.256827 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:13.298178 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:13.298909 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:13.309948 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:13.313788 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:13.542158 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:13.542761 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:13.543311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '52aede50-c798-4277-9122-14f1a7110e1b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3428b4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34287b4d0>]}
[0m06:02:13.543782 [info ] [MainThread]: 
[0m06:02:13.544233 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:13.545799 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.50323534, "process_user_time": 1.592267, "process_kernel_time": 0.104279, "process_mem_max_rss": "93768", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m06:02:13.546393 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:13.546290 after 0.50 seconds
[0m06:02:13.546837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342e8ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3432bc140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342e957f0>]}
[0m06:02:13.547312 [debug] [MainThread]: Flushing usage events
[0m06:02:15.367547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cab37500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cab36ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cab36f30>]}


============================== 06:02:15.370432 | fcd65862-d22f-44ea-969e-3bc4a9e41c7f ==============================
[0m06:02:15.370432 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:15.371105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:15.607972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cba2a870>]}
[0m06:02:15.667730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cbbc4590>]}
[0m06:02:15.670391 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:15.686594 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:15.687385 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:15.687925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ca8b0140>]}
[0m06:02:16.921508 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:16.922227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c34da000>]}
[0m06:02:17.103353 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:17.108634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c34bf140>]}
[0m06:02:17.238989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c34858b0>]}
[0m06:02:17.239578 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:17.240079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c3294380>]}
[0m06:02:17.241802 [info ] [MainThread]: 
[0m06:02:17.242512 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:17.247468 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:17.283611 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:17.284104 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:17.284515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:17.768683 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.770292 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:17.772632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:17.773251 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:17.780689 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.781140 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:17.781547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.788099 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.789605 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.790014 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:17.790562 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.790960 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.791376 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:17.791948 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.792882 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.793285 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.793667 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.794207 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.794619 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:17.796794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:17.803579 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.803993 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:17.804371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.810607 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.811021 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.811446 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:17.833329 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.834946 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:17.836270 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:17.836678 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:17.840296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c218ca40>]}
[0m06:02:17.840821 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.841214 [debug] [MainThread]: On master: BEGIN
[0m06:02:17.841589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:17.848162 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.848601 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.848995 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.849375 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.849909 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.850325 [debug] [MainThread]: On master: Close
[0m06:02:17.851812 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:17.852310 [info ] [MainThread]: 
[0m06:02:17.861912 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:17.862558 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:17.863268 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:17.863713 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:17.890240 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:17.890988 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:17.927312 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:17.928135 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:29.057568 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.058124 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:29.058826 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.059328 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.059766 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:29.060500 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.063480 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.063941 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:29.064625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.085762 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:29.086243 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.086682 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:29.087925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.092989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.093457 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:29.094825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.097221 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:29.126837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c33fcf80>]}
[0m06:02:29.127647 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.26s]
[0m06:02:29.128430 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:29.129413 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:29.129977 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:29.130549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:29.131012 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:29.136419 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:29.137098 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:29.171643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.172196 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241103060229165603"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:29.172688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:29.188257 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.196389 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.196896 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:29.197568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.198026 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.198479 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241103060229165603'
      
      
      order by ordinal_position

  
[0m06:02:29.220364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.226995 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.227515 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.230770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.238642 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.239125 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.242116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.260321 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:29.261043 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.261516 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241103060229165603"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241103060229165603"
    )
  
[0m06:02:29.294029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.296130 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.296631 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.297074 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.306458 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.307436 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:29.491387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe080159490>]}
[0m06:02:29.492220 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m06:02:29.492972 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:29.494485 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.494969 [debug] [MainThread]: On master: BEGIN
[0m06:02:29.495451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:29.502454 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.502939 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.503431 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.503862 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.504506 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.504961 [debug] [MainThread]: On master: Close
[0m06:02:29.506479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:29.506921 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:29.507367 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:29.507834 [info ] [MainThread]: 
[0m06:02:29.508372 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.27 seconds (12.27s).
[0m06:02:29.509370 [debug] [MainThread]: Command end result
[0m06:02:29.537185 [info ] [MainThread]: 
[0m06:02:29.537906 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:29.538500 [info ] [MainThread]: 
[0m06:02:29.539094 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:29.540217 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.220985, "process_user_time": 5.122275, "process_kernel_time": 0.346799, "process_mem_max_rss": "293356", "process_in_blocks": "3808", "process_out_blocks": "115152"}
[0m06:02:29.540859 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:29.540748 after 14.22 seconds
[0m06:02:29.541375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ce5bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe081341940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cb4cb680>]}
[0m06:02:29.541865 [debug] [MainThread]: Flushing usage events
[0m06:02:31.455312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b4e67620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b5075ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b4e66690>]}


============================== 06:02:31.458261 | 142e5287-c8c6-4cfe-a17a-edc6976be168 ==============================
[0m06:02:31.458261 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:31.458974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:31.603338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '142e5287-c8c6-4cfe-a17a-edc6976be168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b53d26f0>]}
[0m06:02:31.620244 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21368173, "process_user_time": 1.417774, "process_kernel_time": 0.10783, "process_mem_max_rss": "92228", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:31.620828 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:31.620725 after 0.21 seconds
[0m06:02:31.621266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b5e2c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b4e66510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b6462f30>]}
[0m06:02:31.621692 [debug] [MainThread]: Flushing usage events
[0m14:04:47.087650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d357d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d3827e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d3965070>]}


============================== 14:04:47.095216 | ac2919ac-830a-4970-bb66-1542c1b40a12 ==============================
[0m14:04:47.095216 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:47.095957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:47.241029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac2919ac-830a-4970-bb66-1542c1b40a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d357f7a0>]}
[0m14:04:47.255273 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7avzfb1s'
[0m14:04:47.255742 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:47.365785 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:47.366551 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:47.397157 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:47.401146 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:47.763042 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:47.763608 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:47.764220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ac2919ac-830a-4970-bb66-1542c1b40a12', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d33028d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d3302cc0>]}
[0m14:04:47.764673 [info ] [MainThread]: 
[0m14:04:47.765185 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:47.789317 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7526818, "process_user_time": 1.661102, "process_kernel_time": 0.100308, "process_mem_max_rss": "93620", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:04:47.789997 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:47.789893 after 0.75 seconds
[0m14:04:47.790504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d35c2660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d324f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d324df70>]}
[0m14:04:47.790969 [debug] [MainThread]: Flushing usage events
[0m14:04:49.674098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526da01ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526f4259d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526d109640>]}


============================== 14:04:49.677085 | 5cc27099-a5ff-4a04-900a-4b7330874407 ==============================
[0m14:04:49.677085 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:49.677846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:49.924176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526d03ed80>]}
[0m14:04:49.988258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5265f11b20>]}
[0m14:04:49.991003 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:04:50.007350 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:50.008086 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:50.008633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526cefbb60>]}
[0m14:04:51.254831 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:51.255505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5265d37380>]}
[0m14:04:51.450535 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:51.456000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52658ebb60>]}
[0m14:04:51.582181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52659d5dc0>]}
[0m14:04:51.582774 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:51.583316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52657b32c0>]}
[0m14:04:51.585050 [info ] [MainThread]: 
[0m14:04:51.585781 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:51.590584 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:51.626928 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:51.627396 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:51.627816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:52.190992 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:52.192610 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:52.194864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:52.195456 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:52.202868 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.203302 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:52.203703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:52.210131 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.211643 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.212047 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:52.212659 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.213057 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.213433 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:52.214000 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.214954 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:52.215366 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.215748 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:52.216276 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.216682 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:52.218634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:52.225745 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:52.226156 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:52.226559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:52.232175 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.232598 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:52.233001 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:52.256225 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.257652 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:52.258895 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:52.259306 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:52.262548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526e5ace30>]}
[0m14:04:52.263076 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:52.263470 [debug] [MainThread]: On master: BEGIN
[0m14:04:52.263842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:52.270184 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:52.270647 [debug] [MainThread]: On master: COMMIT
[0m14:04:52.271037 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:52.271415 [debug] [MainThread]: On master: COMMIT
[0m14:04:52.271985 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:52.272390 [debug] [MainThread]: On master: Close
[0m14:04:52.273997 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:52.274536 [info ] [MainThread]: 
[0m14:04:52.283898 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:52.284508 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:52.285189 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:52.285644 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:52.312622 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:52.313388 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:52.350629 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:52.351372 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:05.238268 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.238824 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:05.239483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.239952 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.240407 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:05.241113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.243975 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.244433 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:05.245107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.266979 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:05.267480 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.267953 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:05.269409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.274498 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.274985 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:05.276352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.278709 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:05.307874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f522a30f9e0>]}
[0m14:05:05.308663 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 13.02s]
[0m14:05:05.309574 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:05.310586 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:05.311150 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:05.311807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:05.312259 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:05.317221 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:05.317874 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:05.351512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.352041 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241103140505345535"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:05.352532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:05.367068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.374581 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.375049 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:05.375645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.376090 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.376527 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241103140505345535'
      
      
      order by ordinal_position

  
[0m14:05:05.397248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.403588 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.404084 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:05.407519 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.415004 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.415478 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:05.418219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.436909 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:05.437613 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.438086 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241103140505345535"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241103140505345535"
    )
  
[0m14:05:05.470477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.472447 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:05.472911 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.473334 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:05.482096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.483026 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:05.668595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f522a36e2a0>]}
[0m14:05:05.669446 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m14:05:05.670213 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:05.671660 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:05.672185 [debug] [MainThread]: On master: BEGIN
[0m14:05:05.672637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:05.679330 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:05.679790 [debug] [MainThread]: On master: COMMIT
[0m14:05:05.680219 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:05.680634 [debug] [MainThread]: On master: COMMIT
[0m14:05:05.681201 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:05.681650 [debug] [MainThread]: On master: Close
[0m14:05:05.683028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:05.683463 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:05.683912 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:05.684367 [info ] [MainThread]: 
[0m14:05:05.684897 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.10 seconds (14.10s).
[0m14:05:05.685887 [debug] [MainThread]: Command end result
[0m14:05:05.713938 [info ] [MainThread]: 
[0m14:05:05.714577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:05.715099 [info ] [MainThread]: 
[0m14:05:05.715630 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:05.716635 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.094795, "process_user_time": 5.616873, "process_kernel_time": 0.299194, "process_mem_max_rss": "297624", "process_in_blocks": "3808", "process_out_blocks": "115152"}
[0m14:05:05.717293 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:05.717179 after 16.10 seconds
[0m14:05:05.717792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526f4259d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526d4fc860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526580c2c0>]}
[0m14:05:05.718281 [debug] [MainThread]: Flushing usage events
[0m14:05:07.676126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c544620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c3371a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c4aa450>]}


============================== 14:05:07.678901 | f4fdb7f4-ddc7-4b89-9ee0-b88436b70c0d ==============================
[0m14:05:07.678901 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:07.679534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:07.821418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4fdb7f4-ddc7-4b89-9ee0-b88436b70c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c2e2e70>]}
[0m14:05:07.838175 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21326722, "process_user_time": 1.44353, "process_kernel_time": 0.124303, "process_mem_max_rss": "91996", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:07.838809 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:07.838701 after 0.21 seconds
[0m14:05:07.839257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c7bf260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c3369c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53db61e80>]}
[0m14:05:07.839696 [debug] [MainThread]: Flushing usage events
[0m22:06:02.406512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00e83e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f013b6b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00cb2540>]}


============================== 22:06:02.427473 | 45b4c90b-ac99-4044-86a8-cea3e0e25a53 ==============================
[0m22:06:02.427473 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:02.428204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:02.577784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45b4c90b-ac99-4044-86a8-cea3e0e25a53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00439190>]}
[0m22:06:02.591810 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hc86e2ec'
[0m22:06:02.592307 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:02.782126 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:02.782957 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:02.851506 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:02.855723 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:03.240764 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:03.241393 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:03.241959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '45b4c90b-ac99-4044-86a8-cea3e0e25a53', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00174b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00198a10>]}
[0m22:06:03.242434 [info ] [MainThread]: 
[0m22:06:03.242950 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:03.276993 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.92011005, "process_user_time": 1.659421, "process_kernel_time": 0.126733, "process_mem_max_rss": "93272", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:06:03.277732 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:03.277609 after 0.92 seconds
[0m22:06:03.278218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00e83e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00174b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00176240>]}
[0m22:06:03.278693 [debug] [MainThread]: Flushing usage events
[0m22:06:05.225739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6273a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb63b1a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6273a600>]}


============================== 22:06:05.228696 | 5f3375ed-83f4-4373-8016-5b1343c314d8 ==============================
[0m22:06:05.228696 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:05.229451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:05.473803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb624feb40>]}
[0m22:06:05.534994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6273b170>]}
[0m22:06:05.537659 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:06:05.605719 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:05.606503 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:05.607076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5b50ff50>]}
[0m22:06:06.863239 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:06.863946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5b08a300>]}
[0m22:06:07.050814 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:07.056373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5ae026f0>]}
[0m22:06:07.196455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5ae03260>]}
[0m22:06:07.197065 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:07.197595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5ae389e0>]}
[0m22:06:07.199460 [info ] [MainThread]: 
[0m22:06:07.200183 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:07.205286 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:07.241836 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:07.242361 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:07.242790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:07.895967 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:07.897504 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:07.899727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:07.900292 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:07.907517 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:07.907997 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:07.908395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:07.914885 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:07.916444 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:07.916848 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:07.917445 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:07.917879 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:07.918259 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:07.918879 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:07.919814 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:07.920213 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:07.920589 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:07.921183 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:07.921605 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:07.923832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:07.931202 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:07.931637 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:07.932013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:07.938230 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:07.938648 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:07.939100 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:07.962285 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:07.963966 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:07.965255 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:07.965689 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:07.969465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5ae87c50>]}
[0m22:06:07.970010 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:07.970405 [debug] [MainThread]: On master: BEGIN
[0m22:06:07.970811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:07.977241 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:07.977697 [debug] [MainThread]: On master: COMMIT
[0m22:06:07.978089 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:07.978466 [debug] [MainThread]: On master: COMMIT
[0m22:06:07.979112 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:07.979533 [debug] [MainThread]: On master: Close
[0m22:06:07.981049 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:07.981562 [info ] [MainThread]: 
[0m22:06:07.995018 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:07.995685 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:07.996373 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:07.996833 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:08.023487 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:08.024342 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:08.061049 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:08.061958 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:23.413181 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:23.413703 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:23.414371 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.414840 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:23.415275 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:23.415999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.419036 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:23.419492 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:23.420224 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.441575 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:23.442166 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:23.442624 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:23.445131 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.450794 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:23.451317 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:23.452986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.455485 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:23.485518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5b0a6ab0>]}
[0m22:06:23.486327 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 15.49s]
[0m22:06:23.487233 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:23.488269 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:23.488835 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:23.489515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:23.489974 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:23.495378 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:23.496052 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:23.530640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.531263 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241103220623524547"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:23.531740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:23.546317 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.554357 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.554877 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:23.555579 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.556033 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.556475 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241103220623524547'
      
      
      order by ordinal_position

  
[0m22:06:23.577414 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.585073 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.585681 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:23.589240 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.598029 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.598653 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:23.602027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.620788 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:23.621598 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.622109 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241103220623524547"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241103220623524547"
    )
  
[0m22:06:23.653143 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.655353 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:23.655892 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.656377 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:23.666385 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.667565 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:23.856255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb13900590>]}
[0m22:06:23.857162 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m22:06:23.858077 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:23.859758 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:23.860276 [debug] [MainThread]: On master: BEGIN
[0m22:06:23.860705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:23.867783 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:23.868317 [debug] [MainThread]: On master: COMMIT
[0m22:06:23.868752 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:23.869170 [debug] [MainThread]: On master: COMMIT
[0m22:06:23.869847 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:23.870302 [debug] [MainThread]: On master: Close
[0m22:06:23.872084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:23.872519 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:23.872933 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:23.873402 [info ] [MainThread]: 
[0m22:06:23.873930 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 16.67 seconds (16.67s).
[0m22:06:23.874976 [debug] [MainThread]: Command end result
[0m22:06:23.903641 [info ] [MainThread]: 
[0m22:06:23.904355 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:23.904869 [info ] [MainThread]: 
[0m22:06:23.905384 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:23.906412 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.73013, "process_user_time": 5.888711, "process_kernel_time": 0.342181, "process_mem_max_rss": "295324", "process_in_blocks": "3808", "process_out_blocks": "116720"}
[0m22:06:23.907089 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:23.906975 after 18.73 seconds
[0m22:06:23.907594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb661bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb182664e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5b0a4e60>]}
[0m22:06:23.908080 [debug] [MainThread]: Flushing usage events
[0m22:06:25.916681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d42bab950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d433a8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d43309280>]}


============================== 22:06:25.919635 | 0a9b469d-6bb7-467e-a409-cce609170678 ==============================
[0m22:06:25.919635 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:25.920373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:26.066211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a9b469d-6bb7-467e-a409-cce609170678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d4266f980>]}
[0m22:06:26.083405 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2158262, "process_user_time": 1.431461, "process_kernel_time": 0.119954, "process_mem_max_rss": "92376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:26.084004 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:26.083898 after 0.22 seconds
[0m22:06:26.084444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d44c15dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d438d2a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d426fdbe0>]}
[0m22:06:26.084875 [debug] [MainThread]: Flushing usage events
[0m06:02:12.614348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750da867b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750d4e7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750d48eb70>]}


============================== 06:02:12.622064 | 1ae96c92-0028-4679-bbdf-87e0d01fd870 ==============================
[0m06:02:12.622064 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.622849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.771297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ae96c92-0028-4679-bbdf-87e0d01fd870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750ce9a750>]}
[0m06:02:12.785239 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6n__ac87'
[0m06:02:12.785728 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:12.831023 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:12.831672 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:12.843184 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:12.847088 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:12.997740 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:12.998389 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:12.999091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1ae96c92-0028-4679-bbdf-87e0d01fd870', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750cc4bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750cc4bc20>]}
[0m06:02:12.999572 [info ] [MainThread]: 
[0m06:02:13.000111 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:13.001866 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4384962, "process_user_time": 1.594374, "process_kernel_time": 0.142779, "process_mem_max_rss": "93576", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:13.002477 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:13.002371 after 0.44 seconds
[0m06:02:13.002956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750d9dfa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750d23b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750d2391f0>]}
[0m06:02:13.003394 [debug] [MainThread]: Flushing usage events
[0m06:02:14.696480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84da55dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84da55ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84da55d5b0>]}


============================== 06:02:14.699547 | 6e0b30ee-2e98-44e5-964d-c2a2f6d6392a ==============================
[0m06:02:14.699547 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.700206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.940562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d2b34b90>]}
[0m06:02:15.000258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d9a370e0>]}
[0m06:02:15.002993 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:15.018783 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:15.019546 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:15.020070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d9b7aff0>]}
[0m06:02:16.247075 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:16.247700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d25df380>]}
[0m06:02:16.430705 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:16.436093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d291ac00>]}
[0m06:02:16.564426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d24b9460>]}
[0m06:02:16.564994 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:16.565474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d234bbf0>]}
[0m06:02:16.567211 [info ] [MainThread]: 
[0m06:02:16.567915 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:16.572603 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:16.608708 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:16.609195 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:16.609608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:17.057181 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.058790 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:17.061049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:17.061599 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:17.068758 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.069188 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:17.069576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.076075 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.077541 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.077945 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:17.078498 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.078936 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.079313 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:17.079880 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.080800 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.081192 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.081560 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.082157 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.082574 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:17.084672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:17.091923 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.092333 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:17.092703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.098841 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.099250 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.099639 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:17.123144 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.124714 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:17.125932 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:17.126327 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:17.129844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d2423a10>]}
[0m06:02:17.130360 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.130781 [debug] [MainThread]: On master: BEGIN
[0m06:02:17.131166 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:17.137620 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.138059 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.138445 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.138857 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.139447 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.139851 [debug] [MainThread]: On master: Close
[0m06:02:17.141452 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:17.141947 [info ] [MainThread]: 
[0m06:02:17.151928 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:17.152542 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:17.153206 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:17.153641 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:17.179537 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:17.180310 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:17.216113 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:17.216905 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:24.655862 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.656384 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:24.657031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.657487 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.657919 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:24.658625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.661512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.661963 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:24.662734 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.683556 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:24.684035 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.684468 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:24.685777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.690721 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.691208 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:24.692352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.694672 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:24.724142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84933c1cd0>]}
[0m06:02:24.724902 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.57s]
[0m06:02:24.725779 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:24.726809 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:24.727438 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:24.728113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:24.728563 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:24.733762 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:24.734420 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:24.768270 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.768835 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241104060224762235"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:24.769305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:24.786556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.794614 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.795129 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:24.795767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.796209 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.796639 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241104060224762235'
      
      
      order by ordinal_position

  
[0m06:02:24.822978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.829673 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.830168 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:24.833158 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.840892 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.841383 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:24.844396 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.862541 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:24.863351 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.863835 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241104060224762235"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241104060224762235"
    )
  
[0m06:02:24.897188 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.899272 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:24.899727 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.900147 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:24.909483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.910379 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:25.103326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8492e46b10>]}
[0m06:02:25.104403 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m06:02:25.105381 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:25.106850 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.107316 [debug] [MainThread]: On master: BEGIN
[0m06:02:25.107750 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:25.114779 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.115263 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.115695 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.116109 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.116725 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.117174 [debug] [MainThread]: On master: Close
[0m06:02:25.118794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:25.119229 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:25.119628 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:25.120082 [info ] [MainThread]: 
[0m06:02:25.120665 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.55 seconds (8.55s).
[0m06:02:25.121776 [debug] [MainThread]: Command end result
[0m06:02:25.149997 [info ] [MainThread]: 
[0m06:02:25.150784 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:25.151378 [info ] [MainThread]: 
[0m06:02:25.151973 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:25.153085 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.5054865, "process_user_time": 5.537707, "process_kernel_time": 0.376115, "process_mem_max_rss": "301460", "process_in_blocks": "3808", "process_out_blocks": "116696"}
[0m06:02:25.153729 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:25.153616 after 10.51 seconds
[0m06:02:25.154224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84dbf7dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84da03c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d25bd1c0>]}
[0m06:02:25.154713 [debug] [MainThread]: Flushing usage events
[0m06:02:26.940397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4326709220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4325c1e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4325c1c860>]}


============================== 06:02:26.943338 | 7253273c-a5ea-4a00-97f3-65cd194a0604 ==============================
[0m06:02:26.943338 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:26.944085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.090336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7253273c-a5ea-4a00-97f3-65cd194a0604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f432575fc20>]}
[0m06:02:27.107697 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21862893, "process_user_time": 1.466848, "process_kernel_time": 0.095924, "process_mem_max_rss": "92152", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:27.108311 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:27.108195 after 0.22 seconds
[0m06:02:27.108770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43287bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4324ec0cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4324beb290>]}
[0m06:02:27.109213 [debug] [MainThread]: Flushing usage events
[0m14:05:18.773590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978e49a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978ce3c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978ce3cf80>]}


============================== 14:05:18.790519 | f3de81ee-c081-45d9-a940-1fbe67adde03 ==============================
[0m14:05:18.790519 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:18.791279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:18.927918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3de81ee-c081-45d9-a940-1fbe67adde03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978ce94d70>]}
[0m14:05:18.941414 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-f_mcs2p2'
[0m14:05:18.941870 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:19.039840 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:19.040488 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:19.064011 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:19.067801 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:19.140852 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:19.141356 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:19.141875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3de81ee-c081-45d9-a940-1fbe67adde03', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978da07830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978c28fb00>]}
[0m14:05:19.142328 [info ] [MainThread]: 
[0m14:05:19.142797 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:19.151455 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42592555, "process_user_time": 1.5428, "process_kernel_time": 0.149825, "process_mem_max_rss": "93792", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:19.152132 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:19.152028 after 0.43 seconds
[0m14:05:19.152586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978c66a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97901bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97901bbd40>]}
[0m14:05:19.153002 [debug] [MainThread]: Flushing usage events
[0m14:05:20.742051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff8c55850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff8f48b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff8c57c50>]}


============================== 14:05:20.744880 | 83d04a3e-2fc7-413b-bf01-8b87665c6015 ==============================
[0m14:05:20.744880 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:20.745608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:20.985014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff1b94080>]}
[0m14:05:21.043771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ffa7d7920>]}
[0m14:05:21.046264 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:21.073215 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:21.073980 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:21.074503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff1a12120>]}
[0m14:05:22.303560 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:22.304215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff148ee40>]}
[0m14:05:22.483350 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:22.488458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff196b710>]}
[0m14:05:22.612192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff13bc710>]}
[0m14:05:22.612728 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:22.613206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff137caa0>]}
[0m14:05:22.614860 [info ] [MainThread]: 
[0m14:05:22.615536 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:22.620264 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:22.655348 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:22.655789 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:22.656213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:23.357105 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:23.358648 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:23.360840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:23.361430 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:23.368650 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:23.369085 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:23.369480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:23.375651 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.377135 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:23.377545 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:23.378084 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.378475 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:23.378850 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:23.379419 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.380373 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:23.380782 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:23.381163 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:23.381701 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.382103 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:23.384075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:23.390684 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:23.391111 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:23.391501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:23.397415 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.397825 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:23.398223 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:23.419972 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.421470 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:23.422687 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:23.423094 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:23.426355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff130baa0>]}
[0m14:05:23.426863 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:23.427252 [debug] [MainThread]: On master: BEGIN
[0m14:05:23.427614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:23.433794 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:23.434217 [debug] [MainThread]: On master: COMMIT
[0m14:05:23.434615 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:23.434987 [debug] [MainThread]: On master: COMMIT
[0m14:05:23.435507 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:23.435906 [debug] [MainThread]: On master: Close
[0m14:05:23.437271 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:23.437760 [info ] [MainThread]: 
[0m14:05:23.452761 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:23.453357 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:23.454013 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:23.454446 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:23.480247 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:23.480989 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:23.517243 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:23.518054 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:30.730358 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.730877 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:30.731504 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.731957 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.732433 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:30.733136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.735981 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.736462 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:30.737133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.757920 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.758401 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.758844 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.761097 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.766027 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.766503 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:30.768346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.770651 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:30.802733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fadf0c290>]}
[0m14:05:30.803447 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.35s]
[0m14:05:30.804245 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:30.805236 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:30.805817 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:30.806388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:30.806841 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:30.811890 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:30.812573 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:30.846704 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.847224 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241104140530840770"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:30.847699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:30.861879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.869570 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.870032 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:30.870624 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.871068 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.871499 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241104140530840770'
      
      
      order by ordinal_position

  
[0m14:05:30.891972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.898223 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.898709 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.901542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.909136 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.909612 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.912671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.930760 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:30.931451 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.931932 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241104140530840770"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241104140530840770"
    )
  
[0m14:05:30.963534 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.965544 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.966017 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.966447 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.976400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.977303 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:31.649384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fadf101d0>]}
[0m14:05:31.650233 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.84s]
[0m14:05:31.651033 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:31.652507 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:31.652985 [debug] [MainThread]: On master: BEGIN
[0m14:05:31.653417 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:31.659987 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:31.660499 [debug] [MainThread]: On master: COMMIT
[0m14:05:31.660939 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:31.661375 [debug] [MainThread]: On master: COMMIT
[0m14:05:31.661953 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:31.662404 [debug] [MainThread]: On master: Close
[0m14:05:31.663965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:31.664451 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:31.664861 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:31.665333 [info ] [MainThread]: 
[0m14:05:31.665875 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.05 seconds (9.05s).
[0m14:05:31.666910 [debug] [MainThread]: Command end result
[0m14:05:31.694894 [info ] [MainThread]: 
[0m14:05:31.695579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:31.696193 [info ] [MainThread]: 
[0m14:05:31.696800 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:31.697897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.004663, "process_user_time": 5.943849, "process_kernel_time": 0.3893, "process_mem_max_rss": "358632", "process_in_blocks": "3808", "process_out_blocks": "132656"}
[0m14:05:31.698539 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:31.698427 after 11.01 seconds
[0m14:05:31.699029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff8c55850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff13881a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1faebec710>]}
[0m14:05:31.699509 [debug] [MainThread]: Flushing usage events
[0m14:05:33.350566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83b1980e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83bec8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83b96c2f0>]}


============================== 14:05:33.353441 | f7e8d24d-c08b-4f0e-b167-4559fa1e2f51 ==============================
[0m14:05:33.353441 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:33.354160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:33.496572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7e8d24d-c08b-4f0e-b167-4559fa1e2f51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83af02900>]}
[0m14:05:33.513656 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21192129, "process_user_time": 1.417222, "process_kernel_time": 0.099804, "process_mem_max_rss": "92120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:33.514250 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:33.514145 after 0.21 seconds
[0m14:05:33.514684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83b237c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83af27ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83af43890>]}
[0m14:05:33.515112 [debug] [MainThread]: Flushing usage events
[0m22:05:35.092821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddd931f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddd32f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddd2fd070>]}


============================== 22:05:35.153181 | 285d845e-7a49-4900-8f66-4ac27f9495c6 ==============================
[0m22:05:35.153181 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:35.153857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:35.296748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '285d845e-7a49-4900-8f66-4ac27f9495c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddd1792b0>]}
[0m22:05:35.310198 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ojz9cll9'
[0m22:05:35.310669 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:35.408302 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:35.408952 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:35.422877 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:35.426762 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:35.600707 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:35.601353 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:35.601978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '285d845e-7a49-4900-8f66-4ac27f9495c6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddcf3ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddcf3fe60>]}
[0m22:05:35.602445 [info ] [MainThread]: 
[0m22:05:35.602994 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:35.613089 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.56825286, "process_user_time": 1.595094, "process_kernel_time": 0.100194, "process_mem_max_rss": "93748", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m22:05:35.613776 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:35.613671 after 0.57 seconds
[0m22:05:35.614228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddd299ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddd983d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddcf3fe60>]}
[0m22:05:35.614658 [debug] [MainThread]: Flushing usage events
[0m22:05:37.272038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb660d7e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66034e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66034e5d0>]}


============================== 22:05:37.274862 | d6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e ==============================
[0m22:05:37.274862 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:37.275597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:37.516818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65ffeb590>]}
[0m22:05:37.576767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65ffbf290>]}
[0m22:05:37.579373 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:37.629812 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:37.630569 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:37.631164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6615c7830>]}
[0m22:05:38.874651 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:38.875330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6591b1a60>]}
[0m22:05:39.062331 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:39.067797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb658b6de50>]}
[0m22:05:39.250231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb658a9c8f0>]}
[0m22:05:39.250869 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:39.251390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb658bd1130>]}
[0m22:05:39.253174 [info ] [MainThread]: 
[0m22:05:39.253883 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:39.259030 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:39.295992 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:39.296522 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:39.296949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:39.909140 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:39.910738 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:39.913178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:39.913780 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:39.921250 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.921697 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:39.922106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:39.928475 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.929981 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.930406 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:39.931050 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.931454 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.931835 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:39.932461 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.933403 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:39.933804 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.934177 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:39.934706 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.935169 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:39.937292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:39.944674 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:39.945094 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:39.945472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:39.951642 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.952057 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:39.952456 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:39.975837 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.977394 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:39.978634 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:39.979100 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:39.982738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6618810a0>]}
[0m22:05:39.983305 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:39.983704 [debug] [MainThread]: On master: BEGIN
[0m22:05:39.984086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:39.990526 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:39.990992 [debug] [MainThread]: On master: COMMIT
[0m22:05:39.991396 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:39.991780 [debug] [MainThread]: On master: COMMIT
[0m22:05:39.992371 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:39.992786 [debug] [MainThread]: On master: Close
[0m22:05:39.994370 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:39.994922 [info ] [MainThread]: 
[0m22:05:40.036115 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:40.036794 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:40.037513 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:40.037959 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:40.063877 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:40.064734 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:40.102956 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:40.104080 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:48.524199 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.524721 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:48.525413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.525874 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.526311 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:48.527071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.530000 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.530458 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:48.531184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.552110 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:48.552603 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.553131 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:48.554918 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.559956 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.560427 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:48.561970 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.564373 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:48.595259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb661836240>]}
[0m22:05:48.596086 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.56s]
[0m22:05:48.596893 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:48.597924 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:48.598502 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:48.599149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:48.599609 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:48.604996 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:48.605654 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:48.639851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.640420 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241104220548633884"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:48.640900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:48.655503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.663444 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.663934 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:48.664569 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.665021 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.665465 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241104220548633884'
      
      
      order by ordinal_position

  
[0m22:05:48.686539 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.693284 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.693789 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:48.697181 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.704918 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.705400 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:48.708405 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.726371 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:48.727143 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.727623 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241104220548633884"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241104220548633884"
    )
  
[0m22:05:48.757973 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.760131 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:48.760640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.761094 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:48.771154 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.772207 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:48.945571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6155e6300>]}
[0m22:05:48.946407 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m22:05:48.947213 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:48.948814 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:48.949295 [debug] [MainThread]: On master: BEGIN
[0m22:05:48.949730 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:48.956659 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:48.957142 [debug] [MainThread]: On master: COMMIT
[0m22:05:48.957584 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:48.958012 [debug] [MainThread]: On master: COMMIT
[0m22:05:48.958601 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:48.959100 [debug] [MainThread]: On master: Close
[0m22:05:48.960903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:48.961342 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:48.961755 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:48.962227 [info ] [MainThread]: 
[0m22:05:48.962780 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.71 seconds (9.71s).
[0m22:05:48.963871 [debug] [MainThread]: Command end result
[0m22:05:48.992353 [info ] [MainThread]: 
[0m22:05:48.993044 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:48.993604 [info ] [MainThread]: 
[0m22:05:48.994166 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:48.995272 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.772239, "process_user_time": 5.767354, "process_kernel_time": 0.332193, "process_mem_max_rss": "294664", "process_in_blocks": "3808", "process_out_blocks": "114760"}
[0m22:05:48.995933 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:48.995818 after 11.77 seconds
[0m22:05:48.996450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb660d7e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6618809e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66002d280>]}
[0m22:05:48.996950 [debug] [MainThread]: Flushing usage events
[0m22:05:50.779321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea3c54980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea206d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea3c1e300>]}


============================== 22:05:50.782297 | 1284abb4-7818-4c0e-8978-9a75e0d5201c ==============================
[0m22:05:50.782297 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:50.783010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:50.949320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1284abb4-7818-4c0e-8978-9a75e0d5201c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea18b79e0>]}
[0m22:05:50.966227 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23743306, "process_user_time": 1.485748, "process_kernel_time": 0.076089, "process_mem_max_rss": "92388", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:50.966819 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:50.966715 after 0.24 seconds
[0m22:05:50.967302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea3c54980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea1cd86b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea1cd9730>]}
[0m22:05:50.967737 [debug] [MainThread]: Flushing usage events
[0m06:02:11.348815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4462e68da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4462e8d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4462e68500>]}


============================== 06:02:11.356424 | fed73414-93e1-4e3b-9949-138817aff127 ==============================
[0m06:02:11.356424 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:11.357110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:11.505756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fed73414-93e1-4e3b-9949-138817aff127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44624f1280>]}
[0m06:02:11.519788 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-037hb3to'
[0m06:02:11.520252 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:11.592707 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:11.593342 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:11.604639 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:11.608520 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:11.657363 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:11.657872 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:11.658391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fed73414-93e1-4e3b-9949-138817aff127', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f446224fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f446224ffe0>]}
[0m06:02:11.658842 [info ] [MainThread]: 
[0m06:02:11.659322 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:11.662917 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3746829, "process_user_time": 1.613286, "process_kernel_time": 0.135771, "process_mem_max_rss": "93648", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:11.663527 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:11.663424 after 0.38 seconds
[0m06:02:11.664006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4462e39f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f446252cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4462bf5ca0>]}
[0m06:02:11.664428 [debug] [MainThread]: Flushing usage events
[0m06:02:13.295087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452a16540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452d0a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452cc2540>]}


============================== 06:02:13.297936 | 4b681688-2b1b-45d5-b609-69665da476b7 ==============================
[0m06:02:13.297936 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:13.298682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.538091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844b930c80>]}
[0m06:02:13.600172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84532ac830>]}
[0m06:02:13.602686 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:13.622700 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:13.623419 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:13.623990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8453aa1280>]}
[0m06:02:14.851237 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:14.851916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452a9e840>]}
[0m06:02:15.031493 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:15.036472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844b378f50>]}
[0m06:02:15.158448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844b35f6e0>]}
[0m06:02:15.158984 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:15.159488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844b294920>]}
[0m06:02:15.161168 [info ] [MainThread]: 
[0m06:02:15.161941 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:15.166618 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:15.202275 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:15.202733 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:15.203148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:15.680119 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.681697 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:15.683966 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:15.684547 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:15.691759 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.692198 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:15.692584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.698811 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.700323 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.700725 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:15.701261 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.701650 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.702025 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:15.702605 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.703512 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.703957 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.704332 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.704866 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.705269 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:15.707077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:15.714208 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.714626 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:15.715001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.720853 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.721260 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.721649 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:15.745089 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.746655 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:15.747899 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:15.748312 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:15.751779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844b2ba5d0>]}
[0m06:02:15.752300 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.752696 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.753066 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:15.759392 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.759857 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.760248 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.760622 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.761172 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.761577 [debug] [MainThread]: On master: Close
[0m06:02:15.762881 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:15.763412 [info ] [MainThread]: 
[0m06:02:15.773242 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:15.773852 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:15.774585 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:15.775030 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:15.801147 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:15.801897 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:15.837620 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:15.838381 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:23.464202 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.464716 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:23.465379 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.465836 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.466263 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:23.467025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.469990 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.470443 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:23.471122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.491620 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.492112 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.492542 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.494703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.499663 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.500125 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:23.501442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.503770 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:23.532921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84208d2ae0>]}
[0m06:02:23.533693 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.76s]
[0m06:02:23.534464 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:23.535465 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:23.536064 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:23.536648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:23.537104 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:23.542335 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:23.542995 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:23.576768 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.577310 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241105060223570864"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:23.577798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:23.592657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.600402 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.600870 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:23.601477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.601919 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.602355 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241105060223570864'
      
      
      order by ordinal_position

  
[0m06:02:23.623295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.629744 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.630224 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.633072 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.640694 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.641170 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.643998 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.661942 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:23.662657 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.663124 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241105060223570864"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241105060223570864"
    )
  
[0m06:02:23.694185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.696246 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:23.696708 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.697133 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:23.706572 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.707535 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:23.887598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840bbf67b0>]}
[0m06:02:23.888448 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m06:02:23.889216 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:23.890621 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.891104 [debug] [MainThread]: On master: BEGIN
[0m06:02:23.891541 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:23.898364 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.898841 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.899279 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.899734 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.900323 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.900776 [debug] [MainThread]: On master: Close
[0m06:02:23.902328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:23.902764 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:23.903165 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:23.903625 [info ] [MainThread]: 
[0m06:02:23.904274 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.74 seconds (8.74s).
[0m06:02:23.905417 [debug] [MainThread]: Command end result
[0m06:02:23.934314 [info ] [MainThread]: 
[0m06:02:23.935060 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:23.935673 [info ] [MainThread]: 
[0m06:02:23.936275 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:23.937379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.692699, "process_user_time": 5.507336, "process_kernel_time": 0.375137, "process_mem_max_rss": "297000", "process_in_blocks": "3808", "process_out_blocks": "115256"}
[0m06:02:23.938048 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:23.937935 after 10.69 seconds
[0m06:02:23.938545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452d0a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8440f537a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452e3c4a0>]}
[0m06:02:23.939034 [debug] [MainThread]: Flushing usage events
[0m06:02:25.608459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a620064e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a616fbe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a63999b50>]}


============================== 06:02:25.611334 | 17908328-82f3-490a-ab5d-45f8ee3bef09 ==============================
[0m06:02:25.611334 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.612096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:25.758420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17908328-82f3-490a-ab5d-45f8ee3bef09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a61b83170>]}
[0m06:02:25.775715 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21762906, "process_user_time": 1.391092, "process_kernel_time": 0.148329, "process_mem_max_rss": "91872", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:25.776307 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:25.776202 after 0.22 seconds
[0m06:02:25.776745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a615f1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a61e86b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a62b0da60>]}
[0m06:02:25.777170 [debug] [MainThread]: Flushing usage events
[0m14:05:14.536027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9af2cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9af2db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9af2dc10>]}


============================== 14:05:14.573405 | 262606af-4a34-4d76-9ae1-27c56102b9e5 ==============================
[0m14:05:14.573405 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:14.574116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:14.717796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '262606af-4a34-4d76-9ae1-27c56102b9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9aff6840>]}
[0m14:05:14.731708 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5r9e4o4a'
[0m14:05:14.732188 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:14.772428 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:14.773155 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:14.798831 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:14.802831 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:14.894164 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:14.894896 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:14.895559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '262606af-4a34-4d76-9ae1-27c56102b9e5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a56b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a5dec60>]}
[0m14:05:14.896068 [info ] [MainThread]: 
[0m14:05:14.896604 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:14.898744 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41106024, "process_user_time": 1.586378, "process_kernel_time": 0.139857, "process_mem_max_rss": "93764", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:14.899362 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:14.899254 after 0.41 seconds
[0m14:05:14.899819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a8c5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a56b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9abe7bc0>]}
[0m14:05:14.900265 [debug] [MainThread]: Flushing usage events
[0m14:05:16.585832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3287e02c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3295821e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd329582e40>]}


============================== 14:05:16.588878 | 96fbab98-9525-4d6e-8e9a-f6721b8d98fb ==============================
[0m14:05:16.588878 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:16.589533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:16.833092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd321511400>]}
[0m14:05:16.892480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3284f97c0>]}
[0m14:05:16.895065 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:17.004678 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:17.005507 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:17.006084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd321434ce0>]}
[0m14:05:18.249057 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:18.249812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320e61100>]}
[0m14:05:18.436493 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:18.441862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd32144ade0>]}
[0m14:05:18.681548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320fd45f0>]}
[0m14:05:18.682139 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:18.682726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320ee6a80>]}
[0m14:05:18.684480 [info ] [MainThread]: 
[0m14:05:18.685218 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:18.690359 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:18.726627 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:18.727129 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:18.727531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:19.259998 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:19.261547 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:19.263607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:19.264250 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:19.271356 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:19.271786 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:19.272176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:19.278519 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.280006 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:19.280442 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:19.280991 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.281389 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:19.281771 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:19.282414 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.283327 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:19.283730 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:19.284100 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:19.284704 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.285117 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:19.287104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:19.294231 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:19.294699 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:19.295077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:19.301000 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.301410 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:19.301802 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:19.325269 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.326897 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:19.328137 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:19.328544 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:19.332201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320d9aff0>]}
[0m14:05:19.332758 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:19.333160 [debug] [MainThread]: On master: BEGIN
[0m14:05:19.333541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:19.340305 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:19.340749 [debug] [MainThread]: On master: COMMIT
[0m14:05:19.341141 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:19.341517 [debug] [MainThread]: On master: COMMIT
[0m14:05:19.342051 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:19.342501 [debug] [MainThread]: On master: Close
[0m14:05:19.343925 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:19.344434 [info ] [MainThread]: 
[0m14:05:19.388071 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:19.388751 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:19.389465 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:19.389907 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:19.416144 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:19.416894 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:19.453255 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:19.454151 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:26.224003 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.224543 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:26.225275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.225739 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.226184 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:26.227041 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.230169 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.230676 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:26.231454 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.252311 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:26.252807 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.253255 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:26.255642 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.260759 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.261244 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:26.262659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.265039 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:26.295312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2e15ff9e0>]}
[0m14:05:26.296107 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.90s]
[0m14:05:26.296899 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:26.297881 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:26.298484 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:26.299092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:26.299546 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:26.304957 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:26.305660 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:26.340011 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.340544 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241105140526334003"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:26.341027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:26.356330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.364213 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.364693 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:26.365320 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.365777 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.366222 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241105140526334003'
      
      
      order by ordinal_position

  
[0m14:05:26.387581 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.394862 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.395401 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:26.398398 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.406364 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.406911 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:26.409997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.428447 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:26.429203 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.429684 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241105140526334003"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241105140526334003"
    )
  
[0m14:05:26.466012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.468069 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:26.468535 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.468964 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:26.477447 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.478397 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:26.671301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2e16403e0>]}
[0m14:05:26.672135 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m14:05:26.673007 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:26.674502 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.674981 [debug] [MainThread]: On master: BEGIN
[0m14:05:26.675413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:26.682243 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.682775 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.683217 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.683649 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.684221 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.684671 [debug] [MainThread]: On master: Close
[0m14:05:26.686324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:26.686805 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:26.687212 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:26.687677 [info ] [MainThread]: 
[0m14:05:26.688232 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.00 seconds (8.00s).
[0m14:05:26.689280 [debug] [MainThread]: Command end result
[0m14:05:26.717501 [info ] [MainThread]: 
[0m14:05:26.718204 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:26.718776 [info ] [MainThread]: 
[0m14:05:26.719332 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:26.720407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.183106, "process_user_time": 5.700784, "process_kernel_time": 0.312701, "process_mem_max_rss": "297680", "process_in_blocks": "3808", "process_out_blocks": "115760"}
[0m14:05:26.721078 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:26.720955 after 10.18 seconds
[0m14:05:26.721583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2e15fbc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd328afc620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd328467530>]}
[0m14:05:26.722069 [debug] [MainThread]: Flushing usage events
[0m14:05:28.404737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd7b4a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd48e3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd4814fe0>]}


============================== 14:05:28.407660 | 0dba4e3c-45dd-4478-b028-296cf15c1ed2 ==============================
[0m14:05:28.407660 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:28.408374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:28.562931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dba4e3c-45dd-4478-b028-296cf15c1ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd53a7fb0>]}
[0m14:05:28.579854 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22388662, "process_user_time": 1.430672, "process_kernel_time": 0.103903, "process_mem_max_rss": "92120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:28.580473 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:28.580364 after 0.22 seconds
[0m14:05:28.580923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd81bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd44e7500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd45e9d00>]}
[0m14:05:28.581370 [debug] [MainThread]: Flushing usage events
[0m22:05:54.149361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48651c3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4865eda060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4865343b30>]}


============================== 22:05:54.157295 | 3fde295f-1b91-4f70-9c8f-773c2248c5a3 ==============================
[0m22:05:54.157295 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:54.157962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:54.297740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fde295f-1b91-4f70-9c8f-773c2248c5a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4865c99dc0>]}
[0m22:05:54.310949 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-skspxlxs'
[0m22:05:54.311383 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:54.452348 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:54.453015 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:54.485167 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:54.489012 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:54.826834 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:54.827377 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:54.827887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3fde295f-1b91-4f70-9c8f-773c2248c5a3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4864ae49e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4864ae7c50>]}
[0m22:05:54.828344 [info ] [MainThread]: 
[0m22:05:54.828842 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:54.830468 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7293067, "process_user_time": 1.552266, "process_kernel_time": 0.108297, "process_mem_max_rss": "93680", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m22:05:54.831048 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:54.830947 after 0.73 seconds
[0m22:05:54.831483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48687bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48651a2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4865219bb0>]}
[0m22:05:54.831883 [debug] [MainThread]: Flushing usage events
[0m22:05:56.528629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079ec7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079ec7fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079ec5c70>]}


============================== 22:05:56.531334 | c2c8c150-3144-4779-8307-0ebd15f36244 ==============================
[0m22:05:56.531334 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:56.531997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:56.759343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079423590>]}
[0m22:05:56.817806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90793d93d0>]}
[0m22:05:56.820355 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:56.836494 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:56.837266 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:56.837797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90792bf830>]}
[0m22:05:58.064305 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:58.064949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9072192090>]}
[0m22:05:58.244835 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:58.249981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9071d2db20>]}
[0m22:05:58.368748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9071c489e0>]}
[0m22:05:58.369304 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:58.369781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9071de9d30>]}
[0m22:05:58.371450 [info ] [MainThread]: 
[0m22:05:58.372124 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:58.376872 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:58.412455 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:58.412962 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:58.413371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:59.042620 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:59.044089 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:59.046201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:59.046764 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:59.053648 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.054040 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:59.054397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:59.060606 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.062010 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.062412 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:59.062955 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.063358 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.063736 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:59.064304 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.065249 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:59.065651 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.066021 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:59.066551 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.066951 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:59.068932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:59.075904 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:59.076320 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:59.076727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:59.082571 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.083025 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:59.083423 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:59.106917 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.108393 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:59.109658 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:59.110061 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:59.113456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907234ae70>]}
[0m22:05:59.113985 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:59.114380 [debug] [MainThread]: On master: BEGIN
[0m22:05:59.114748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:59.121310 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:59.121731 [debug] [MainThread]: On master: COMMIT
[0m22:05:59.122122 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:59.122497 [debug] [MainThread]: On master: COMMIT
[0m22:05:59.123020 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:59.123419 [debug] [MainThread]: On master: Close
[0m22:05:59.125109 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:59.125603 [info ] [MainThread]: 
[0m22:05:59.135206 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:59.135897 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:59.136572 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:59.137029 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:59.163113 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:59.163868 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:59.199563 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:59.200300 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:12.311499 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:12.312034 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:12.312748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.313201 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:12.313690 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:12.314489 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.317542 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:12.318004 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:12.318688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.339424 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:12.339909 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:12.340343 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:12.341621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.346684 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:12.347143 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:12.348357 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.350763 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:12.380469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079ec6540>]}
[0m22:06:12.381355 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 13.24s]
[0m22:06:12.382179 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:12.383202 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:12.383774 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:12.384398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:12.384893 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:12.390347 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:12.391025 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:12.424747 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.425316 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241105220612418769"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:12.425786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:12.441173 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.448910 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.449385 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:12.450002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.450447 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.450881 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241105220612418769'
      
      
      order by ordinal_position

  
[0m22:06:12.472017 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.478779 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.479282 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:12.482650 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.490463 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.490940 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:12.494070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.511950 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:12.512725 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.513211 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241105220612418769"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241105220612418769"
    )
  
[0m22:06:12.547069 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.549189 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:12.549665 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.550098 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:12.558397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.559329 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:12.785807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90327e90a0>]}
[0m22:06:12.786721 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.40s]
[0m22:06:12.787601 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:12.789391 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:12.789900 [debug] [MainThread]: On master: BEGIN
[0m22:06:12.790413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:12.798075 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:12.798609 [debug] [MainThread]: On master: COMMIT
[0m22:06:12.799065 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:12.799535 [debug] [MainThread]: On master: COMMIT
[0m22:06:12.800142 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:12.800678 [debug] [MainThread]: On master: Close
[0m22:06:12.802459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:12.802907 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:12.803309 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:12.803896 [info ] [MainThread]: 
[0m22:06:12.804700 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.43 seconds (14.43s).
[0m22:06:12.806316 [debug] [MainThread]: Command end result
[0m22:06:12.857781 [info ] [MainThread]: 
[0m22:06:12.858516 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:12.859147 [info ] [MainThread]: 
[0m22:06:12.859711 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:12.861082 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.380198, "process_user_time": 5.677478, "process_kernel_time": 0.363582, "process_mem_max_rss": "294552", "process_in_blocks": "3808", "process_out_blocks": "116816"}
[0m22:06:12.861735 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:12.861619 after 16.38 seconds
[0m22:06:12.862306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907998ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907950dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90794fa5d0>]}
[0m22:06:12.863004 [debug] [MainThread]: Flushing usage events
[0m22:06:14.898577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82fd062780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82fd965e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82fd062810>]}


============================== 22:06:14.901449 | e1b4e3d8-5a47-4988-8bc8-0bcde87c0d9f ==============================
[0m22:06:14.901449 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:14.902097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:15.046388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1b4e3d8-5a47-4988-8bc8-0bcde87c0d9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8300bbbd10>]}
[0m22:06:15.062937 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21310821, "process_user_time": 1.416649, "process_kernel_time": 0.115726, "process_mem_max_rss": "92164", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:15.063523 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:15.063419 after 0.21 seconds
[0m22:06:15.063955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82fd1adee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82fcfabbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82fdb007d0>]}
[0m22:06:15.064370 [debug] [MainThread]: Flushing usage events
[0m06:02:25.118227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde38628470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde3752ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde3752dc40>]}


============================== 06:02:25.125710 | 66f8a0fe-2865-42fb-8d52-02182d002859 ==============================
[0m06:02:25.125710 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.126372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:25.267404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66f8a0fe-2865-42fb-8d52-02182d002859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde379e05f0>]}
[0m06:02:25.281258 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-an1o0rai'
[0m06:02:25.281753 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:25.404893 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:25.405616 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:25.418293 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:25.422230 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:25.637285 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:25.637873 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:25.638409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '66f8a0fe-2865-42fb-8d52-02182d002859', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde36dc1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde36a4cd70>]}
[0m06:02:25.638878 [info ] [MainThread]: 
[0m06:02:25.639364 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:25.641089 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.571136, "process_user_time": 1.598108, "process_kernel_time": 0.139834, "process_mem_max_rss": "93720", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:25.641682 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:25.641579 after 0.57 seconds
[0m06:02:25.642135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde37186b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde36dc1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde36be7890>]}
[0m06:02:25.642555 [debug] [MainThread]: Flushing usage events
[0m06:02:27.412753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ef1a55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0efe87bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ef301a30>]}


============================== 06:02:27.415513 | b9c75bd4-c779-4d14-8ffc-8f2178b9db36 ==============================
[0m06:02:27.415513 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:27.416180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.650850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ee6bcef0>]}
[0m06:02:27.709893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ee6bf2f0>]}
[0m06:02:27.712372 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:27.728344 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:27.729055 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:27.729592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e7717b90>]}
[0m06:02:28.989420 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:28.990090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e73623f0>]}
[0m06:02:29.171153 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:29.176401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e717f5c0>]}
[0m06:02:29.296861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e70b0560>]}
[0m06:02:29.297406 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:29.297885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e708fa10>]}
[0m06:02:29.299577 [info ] [MainThread]: 
[0m06:02:29.300268 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:29.305044 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:29.340649 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:29.341133 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:29.341538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:29.952645 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:29.954217 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:29.956413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:29.956972 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:29.964120 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.964568 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:29.964967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.971127 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.972577 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.972990 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:29.973529 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.973925 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.974303 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:29.974895 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.975811 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.976276 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.976655 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.977209 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.977610 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:29.979440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:29.986452 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.986871 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:29.987244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.993198 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.993609 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.994014 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:30.017487 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:30.019026 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:30.020289 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:30.020700 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:30.024169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ef7a6b70>]}
[0m06:02:30.024704 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.025101 [debug] [MainThread]: On master: BEGIN
[0m06:02:30.025476 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:30.031855 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.032316 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.032704 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.033082 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.033640 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.034044 [debug] [MainThread]: On master: Close
[0m06:02:30.035521 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:30.036067 [info ] [MainThread]: 
[0m06:02:30.045760 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:30.046358 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:30.047097 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:30.047540 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:30.073322 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:30.074101 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:30.109678 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:30.110417 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:38.537997 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.538538 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:38.539267 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.539736 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.540216 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:38.540947 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.543935 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.544432 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:38.545203 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.566253 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.566732 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.567170 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.568749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.573724 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.574193 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:38.575404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.577778 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:38.607673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0efe5a300>]}
[0m06:02:38.608531 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.56s]
[0m06:02:38.609312 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:38.610334 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:38.610905 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:38.611494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:38.611956 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:38.617327 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:38.617997 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:38.651468 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.651988 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241106060238645552"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:38.652504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:38.667222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.674618 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.675087 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:38.675694 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.676163 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.676603 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241106060238645552'
      
      
      order by ordinal_position

  
[0m06:02:38.697623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.704176 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.704673 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:38.707514 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.715460 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.715940 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:38.718809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.736720 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:38.737439 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.737910 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241106060238645552"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241106060238645552"
    )
  
[0m06:02:38.771652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.773714 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:38.774207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.774644 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:38.783509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.784481 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:38.976995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a3b7c650>]}
[0m06:02:38.977825 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m06:02:38.978575 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:38.980060 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:38.980563 [debug] [MainThread]: On master: BEGIN
[0m06:02:38.981003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:38.987888 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:38.988413 [debug] [MainThread]: On master: COMMIT
[0m06:02:38.988852 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:38.989273 [debug] [MainThread]: On master: COMMIT
[0m06:02:38.989850 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:38.990325 [debug] [MainThread]: On master: Close
[0m06:02:38.991841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:38.992323 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:38.992724 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:38.993175 [info ] [MainThread]: 
[0m06:02:38.993766 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.69 seconds (9.69s).
[0m06:02:38.994887 [debug] [MainThread]: Command end result
[0m06:02:39.023175 [info ] [MainThread]: 
[0m06:02:39.023851 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:39.024467 [info ] [MainThread]: 
[0m06:02:39.025077 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:39.026154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.661576, "process_user_time": 5.544053, "process_kernel_time": 0.312906, "process_mem_max_rss": "294832", "process_in_blocks": "3808", "process_out_blocks": "116792"}
[0m06:02:39.026795 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:39.026686 after 11.66 seconds
[0m06:02:39.027283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ef3fd730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e7100890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e7100b60>]}
[0m06:02:39.027764 [debug] [MainThread]: Flushing usage events
[0m06:02:40.931510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50c2cff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50b9c6e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50b9c5970>]}


============================== 06:02:40.934368 | 42db5966-42ba-4e3d-948e-79fa91632c3a ==============================
[0m06:02:40.934368 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:40.935093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:41.078186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42db5966-42ba-4e3d-948e-79fa91632c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50bceefc0>]}
[0m06:02:41.094411 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21129295, "process_user_time": 1.438648, "process_kernel_time": 0.091913, "process_mem_max_rss": "92132", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:41.094990 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:41.094887 after 0.21 seconds
[0m06:02:41.095461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50ba62720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50f5bbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50c2cc680>]}
[0m06:02:41.095901 [debug] [MainThread]: Flushing usage events
[0m14:05:15.825078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f56853d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f5aea0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f5685400>]}


============================== 14:05:15.842729 | 33e25c7e-3f8a-428b-bd38-81a5fbab4214 ==============================
[0m14:05:15.842729 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:15.843428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:15.986484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33e25c7e-3f8a-428b-bd38-81a5fbab4214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f5ab4c20>]}
[0m14:05:15.999931 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-cordz5z4'
[0m14:05:16.000392 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:16.017748 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:16.018393 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:16.031184 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:16.034991 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:16.084597 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:16.085108 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:16.085606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '33e25c7e-3f8a-428b-bd38-81a5fbab4214', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f55289b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f53dfb60>]}
[0m14:05:16.086054 [info ] [MainThread]: 
[0m14:05:16.086512 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:16.118012 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.34073734, "process_user_time": 1.5602, "process_kernel_time": 0.138142, "process_mem_max_rss": "93920", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:05:16.118717 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:16.118614 after 0.34 seconds
[0m14:05:16.119202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f56853d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f54efad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f53dfb60>]}
[0m14:05:16.119643 [debug] [MainThread]: Flushing usage events
[0m14:05:17.706808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0e9d62a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0e94d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0ea726f0>]}


============================== 14:05:17.709661 | 24172f70-c997-40a7-9995-c516096820b7 ==============================
[0m14:05:17.709661 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:17.710335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:17.947926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0e64d2e0>]}
[0m14:05:18.007260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0e64eb10>]}
[0m14:05:18.009854 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:18.096102 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:18.096886 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:18.097425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0e7f5070>]}
[0m14:05:19.322271 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:19.322934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd072a8080>]}
[0m14:05:19.505102 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:19.510170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0703d220>]}
[0m14:05:19.733004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0703d580>]}
[0m14:05:19.733596 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:19.734102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd07087170>]}
[0m14:05:19.735806 [info ] [MainThread]: 
[0m14:05:19.736538 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:19.741428 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:19.777529 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:19.778023 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:19.778430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:20.346178 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:20.347768 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:20.349979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:20.350567 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:20.357925 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:20.358367 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:20.358762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:20.364985 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:20.366450 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:20.366853 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:20.367394 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:20.367785 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:20.368159 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:20.368801 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:20.369730 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:20.370136 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:20.370522 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:20.371066 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:20.371476 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:20.374172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:20.381005 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:20.381426 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:20.381800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:20.388220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:20.388666 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:20.389065 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:20.412391 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:20.413955 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:20.415172 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:20.415581 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:20.418958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0716d640>]}
[0m14:05:20.419474 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:20.419857 [debug] [MainThread]: On master: BEGIN
[0m14:05:20.420224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:20.426444 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:20.426863 [debug] [MainThread]: On master: COMMIT
[0m14:05:20.427245 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:20.427615 [debug] [MainThread]: On master: COMMIT
[0m14:05:20.428139 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:20.428532 [debug] [MainThread]: On master: Close
[0m14:05:20.429957 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:20.430454 [info ] [MainThread]: 
[0m14:05:20.466258 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:20.466873 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:20.467519 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:20.467953 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:20.493744 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:20.494531 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:20.530509 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:20.531268 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:28.066491 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.067002 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:28.067650 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.068101 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.068531 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:28.069296 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.072164 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.072653 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:28.073329 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.094011 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:28.094488 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.094925 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:28.096150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.101134 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.101598 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:28.102846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.105199 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:28.134453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc4d262d0>]}
[0m14:05:28.135204 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.67s]
[0m14:05:28.136084 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:28.137078 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:28.137642 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:28.138320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:28.138781 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:28.144029 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:28.144728 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:28.178019 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.178530 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241106140528172194"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:28.178998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:28.193821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.201381 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.201852 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:28.202438 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.202877 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.203305 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241106140528172194'
      
      
      order by ordinal_position

  
[0m14:05:28.223907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.230156 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.230642 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:28.233593 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.241148 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.241628 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:28.244628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.262547 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:28.263241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.263710 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241106140528172194"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241106140528172194"
    )
  
[0m14:05:28.297403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.299453 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:28.299907 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.300332 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:28.310582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.311515 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:29.145768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcbfb9d790>]}
[0m14:05:29.146606 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 1.01s]
[0m14:05:29.147473 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:29.149090 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:29.149568 [debug] [MainThread]: On master: BEGIN
[0m14:05:29.149996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:29.156951 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:29.157425 [debug] [MainThread]: On master: COMMIT
[0m14:05:29.157858 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:29.158277 [debug] [MainThread]: On master: COMMIT
[0m14:05:29.158857 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:29.159306 [debug] [MainThread]: On master: Close
[0m14:05:29.160925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:29.161361 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:29.161764 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:29.162227 [info ] [MainThread]: 
[0m14:05:29.162773 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.43 seconds (9.43s).
[0m14:05:29.163816 [debug] [MainThread]: Command end result
[0m14:05:29.191820 [info ] [MainThread]: 
[0m14:05:29.192457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:29.193016 [info ] [MainThread]: 
[0m14:05:29.193563 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:29.194597 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.536099, "process_user_time": 6.094646, "process_kernel_time": 0.371673, "process_mem_max_rss": "365744", "process_in_blocks": "3808", "process_out_blocks": "133680"}
[0m14:05:29.195253 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:29.195141 after 11.54 seconds
[0m14:05:29.195745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0712d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0ecea540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc4af4e60>]}
[0m14:05:29.196230 [debug] [MainThread]: Flushing usage events
[0m14:05:30.872968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb706186690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb706636270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb705e00920>]}


============================== 14:05:30.875854 | 440c7741-2344-4658-b3d4-743037d571a8 ==============================
[0m14:05:30.875854 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:30.876624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:31.021011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '440c7741-2344-4658-b3d4-743037d571a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb706aa4d10>]}
[0m14:05:31.037844 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21315528, "process_user_time": 1.429201, "process_kernel_time": 0.08407, "process_mem_max_rss": "92268", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:31.038428 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:31.038324 after 0.21 seconds
[0m14:05:31.038864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb705d64710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb705e008c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb705e00920>]}
[0m14:05:31.039299 [debug] [MainThread]: Flushing usage events
