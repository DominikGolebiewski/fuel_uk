[0m06:02:09.649918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92fad8e7b0>]}
[0m06:02:09.651722 [info ] [MainThread]: 
[0m06:02:09.652425 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:09.657165 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:09.692544 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:09.693029 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:09.693441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:10.261445 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:10.263007 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:10.265159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:10.265719 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:10.272928 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.273363 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:10.273763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.280185 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.281687 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.282088 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:10.282625 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.283017 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.283390 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:10.283977 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.284929 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.285331 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.285703 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.286238 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.286642 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:10.288539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:10.295660 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.296071 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:10.296485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.302644 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.303059 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.303459 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:10.327573 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.329185 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:10.330451 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:10.330870 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:10.334493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9303b80dd0>]}
[0m06:02:10.335038 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.335437 [debug] [MainThread]: On master: BEGIN
[0m06:02:10.335813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:10.342252 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.342680 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.343067 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.343443 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.343976 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.344414 [debug] [MainThread]: On master: Close
[0m06:02:10.345736 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:10.346281 [info ] [MainThread]: 
[0m06:02:10.372933 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:10.373536 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:10.374273 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:10.374721 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:10.400593 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:10.401345 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:10.436877 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:10.437661 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:18.192676 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.193188 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:18.193857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.194307 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.194739 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:18.195442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.198374 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.198855 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:18.199531 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.220328 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:18.220827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.221263 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:18.223188 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.228133 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.228625 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:18.229823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.232119 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:18.261362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93034fe930>]}
[0m06:02:18.262116 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.89s]
[0m06:02:18.262874 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:18.263886 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:18.264490 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:18.265076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:18.265531 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:18.270840 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:18.271496 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:18.305170 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.305686 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241027060218299187"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:18.306159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:18.320021 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.327426 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.327886 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:18.328570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.329034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.329476 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241027060218299187'
      
      
      order by ordinal_position

  
[0m06:02:18.349766 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.356284 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.356796 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:18.360937 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.368443 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.368929 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:18.371629 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.389509 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:18.390200 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.390664 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241027060218299187"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241027060218299187"
    )
  
[0m06:02:18.422636 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.424602 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:18.425070 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.425492 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:18.433663 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.434559 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:18.626046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92b79650d0>]}
[0m06:02:18.626860 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m06:02:18.627614 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:18.629128 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.629594 [debug] [MainThread]: On master: BEGIN
[0m06:02:18.630015 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:18.637134 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.637802 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.638440 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.639067 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.639938 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.640626 [debug] [MainThread]: On master: Close
[0m06:02:18.642446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:18.642881 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:18.643278 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:18.643731 [info ] [MainThread]: 
[0m06:02:18.644274 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.99 seconds (8.99s).
[0m06:02:18.645340 [debug] [MainThread]: Command end result
[0m06:02:18.673207 [info ] [MainThread]: 
[0m06:02:18.673854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:18.674389 [info ] [MainThread]: 
[0m06:02:18.674937 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:18.675949 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.988357, "process_user_time": 5.635993, "process_kernel_time": 0.319999, "process_mem_max_rss": "291348", "process_in_blocks": "3808", "process_out_blocks": "116200"}
[0m06:02:18.676626 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:18.676515 after 10.99 seconds
[0m06:02:18.677137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9303398590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92fad60f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9302a747d0>]}
[0m06:02:18.677620 [debug] [MainThread]: Flushing usage events
[0m06:02:20.358883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b792570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97c0c0a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97c0c3b60>]}


============================== 06:02:20.361679 | 4262b812-ebd9-4f29-9045-c1575eadd653 ==============================
[0m06:02:20.361679 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:20.362399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:20.503733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4262b812-ebd9-4f29-9045-c1575eadd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b6f6b40>]}
[0m06:02:20.520439 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20978114, "process_user_time": 1.4195, "process_kernel_time": 0.087969, "process_mem_max_rss": "92276", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:20.521010 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:20.520908 after 0.21 seconds
[0m06:02:20.521433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97ba5f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b5b2960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b5b1070>]}
[0m06:02:20.521850 [debug] [MainThread]: Flushing usage events
[0m14:05:16.133926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa339460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa45a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa33bf20>]}


============================== 14:05:16.141725 | 78023bc8-b36b-4e15-8dbb-9e1204979c39 ==============================
[0m14:05:16.141725 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:16.142500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:16.286222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78023bc8-b36b-4e15-8dbb-9e1204979c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa00b260>]}
[0m14:05:16.299845 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-099ghjmk'
[0m14:05:16.300322 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:16.326602 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:16.327230 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:16.338031 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:16.341870 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:16.557757 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:16.558339 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:16.558902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '78023bc8-b36b-4e15-8dbb-9e1204979c39', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa1a2c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ea9f03d10>]}
[0m14:05:16.559370 [info ] [MainThread]: 
[0m14:05:16.559857 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:16.561652 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47698292, "process_user_time": 1.583668, "process_kernel_time": 0.134611, "process_mem_max_rss": "93512", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:16.562249 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:16.562145 after 0.48 seconds
[0m14:05:16.562742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa3371d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa1dc500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eab1b6b40>]}
[0m14:05:16.563165 [debug] [MainThread]: Flushing usage events
[0m14:05:18.540090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f6a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f7320>]}


============================== 14:05:18.543201 | cefd4d58-25b2-4a5b-9398-c93bead4f291 ==============================
[0m14:05:18.543201 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:18.543966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:18.793095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2298e660>]}
[0m14:05:18.853624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e29865af0>]}
[0m14:05:18.856407 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:18.931958 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:18.932772 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:18.933327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e298b3800>]}
[0m14:05:20.175385 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:20.176098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e227d0350>]}
[0m14:05:20.363487 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:20.369172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e227331d0>]}
[0m14:05:20.510975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2218fb90>]}
[0m14:05:20.511585 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:20.512131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e222e19a0>]}
[0m14:05:20.514002 [info ] [MainThread]: 
[0m14:05:20.514805 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:20.519774 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:20.556651 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:20.557188 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:20.557627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:21.007736 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.009411 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:21.011778 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:21.012363 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:21.019736 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.020177 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:21.020622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:21.027359 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.028853 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.029264 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:21.029826 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.030221 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.030640 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:21.031213 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.032133 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:21.032551 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.032925 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:21.033465 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.033873 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:21.036016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:21.043578 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:21.043991 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:21.044366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:21.050268 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.050726 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:21.051125 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:21.075283 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.077179 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:21.078596 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:21.079048 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:21.083255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2bf11340>]}
[0m14:05:21.083816 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.084226 [debug] [MainThread]: On master: BEGIN
[0m14:05:21.084617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:21.091686 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.092129 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.092543 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.092930 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.093567 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.093987 [debug] [MainThread]: On master: Close
[0m14:05:21.095895 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:21.096411 [info ] [MainThread]: 
[0m14:05:21.106564 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:21.107237 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:21.107981 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:21.108445 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:21.135946 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:21.136902 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:21.174126 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:21.175093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:30.068868 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.069469 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:30.070311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.070822 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.071273 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:30.072130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.075574 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.076049 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:30.076828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.100428 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.101171 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.101686 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.114045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.120552 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.121056 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:30.145156 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.149021 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:30.208242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e221b8a70>]}
[0m14:05:30.209234 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.10s]
[0m14:05:30.210238 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:30.211494 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:30.212410 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:30.213314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:30.213879 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:30.223198 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:30.224161 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:30.268421 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.269063 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241027140530261605"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:30.269580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:30.287902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.296323 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.296837 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:30.297567 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.298034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.298505 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241027140530261605'
      
      
      order by ordinal_position

  
[0m14:05:30.323366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.334147 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.334937 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.339807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.351373 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.351860 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.354832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.373289 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:30.374027 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.374561 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241027140530261605"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241027140530261605"
    )
  
[0m14:05:30.411051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.413283 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.413799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.414246 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.561348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.562508 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:30.754709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de2d56b40>]}
[0m14:05:30.755538 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.54s]
[0m14:05:30.756296 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:30.757739 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:30.758217 [debug] [MainThread]: On master: BEGIN
[0m14:05:30.758757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:30.765582 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:30.766063 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.766542 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:30.766967 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.767586 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:30.768038 [debug] [MainThread]: On master: Close
[0m14:05:30.769509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:30.769940 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:30.770339 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:30.770884 [info ] [MainThread]: 
[0m14:05:30.771481 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.26 seconds (10.26s).
[0m14:05:30.772614 [debug] [MainThread]: Command end result
[0m14:05:30.801005 [info ] [MainThread]: 
[0m14:05:30.801753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:30.802365 [info ] [MainThread]: 
[0m14:05:30.803009 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:30.804135 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.313357, "process_user_time": 5.773754, "process_kernel_time": 0.323874, "process_mem_max_rss": "302296", "process_in_blocks": "3808", "process_out_blocks": "116696"}
[0m14:05:30.804785 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:30.804673 after 12.31 seconds
[0m14:05:30.805288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e29eb4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de2d9f7a0>]}
[0m14:05:30.805783 [debug] [MainThread]: Flushing usage events
[0m14:05:32.764828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f962e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f9610d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f962660>]}


============================== 14:05:32.767764 | 71eccba0-e1bc-4284-8aef-e2ee42a7aeeb ==============================
[0m14:05:32.767764 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:32.768481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:32.908977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71eccba0-e1bc-4284-8aef-e2ee42a7aeeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573fb3b200>]}
[0m14:05:32.925760 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20939516, "process_user_time": 1.402786, "process_kernel_time": 0.107906, "process_mem_max_rss": "92196", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:32.926347 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:32.926246 after 0.21 seconds
[0m14:05:32.926826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57406c8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573fa0fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f9aa060>]}
[0m14:05:32.927248 [debug] [MainThread]: Flushing usage events
[0m22:06:37.818970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd1479340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd185d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd3822270>]}


============================== 22:06:37.826466 | 90ac5466-6416-4b1c-85b1-1e85a1d0e0ad ==============================
[0m22:06:37.826466 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:37.827200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:37.979993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90ac5466-6416-4b1c-85b1-1e85a1d0e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd147bd40>]}
[0m22:06:37.994808 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mnavaskj'
[0m22:06:37.995340 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:38.062625 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:38.063472 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:38.098596 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:38.102810 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:38.462267 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:38.462926 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:38.463490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '90ac5466-6416-4b1c-85b1-1e85a1d0e0ad', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd12afc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd12ac3e0>]}
[0m22:06:38.463984 [info ] [MainThread]: 
[0m22:06:38.464510 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:38.466498 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6955928, "process_user_time": 1.603294, "process_kernel_time": 0.140288, "process_mem_max_rss": "93640", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:06:38.467094 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:38.466989 after 0.70 seconds
[0m22:06:38.467535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd18ea360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd11efe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd117e7e0>]}
[0m22:06:38.467969 [debug] [MainThread]: Flushing usage events
[0m22:06:40.277643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3219afef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3219cb590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3219af6b0>]}


============================== 22:06:40.280812 | 33dad61b-4949-4309-8e77-a24b0795d7a0 ==============================
[0m22:06:40.280812 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:40.281603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:40.546518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa320ef8410>]}
[0m22:06:40.609342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa321abfef0>]}
[0m22:06:40.612131 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:06:40.632020 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:40.632875 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:40.633460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa321c05af0>]}
[0m22:06:41.875403 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:41.876121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31987a000>]}
[0m22:06:42.059627 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:42.065035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa319f3ad80>]}
[0m22:06:42.193864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3197a8440>]}
[0m22:06:42.194451 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:42.194931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa319817ce0>]}
[0m22:06:42.196701 [info ] [MainThread]: 
[0m22:06:42.197466 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:42.202403 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:42.238996 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:42.239516 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:42.239922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:42.932482 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:42.934054 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:42.936259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:42.936887 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:42.944032 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.944502 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:42.944898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.951491 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.953061 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.953476 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:42.954021 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.954423 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.954799 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:42.955418 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.956386 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.956786 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.957159 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.957699 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.958106 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:42.960208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:42.967557 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.967981 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:42.968397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.974563 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.974999 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.975403 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:42.999698 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:43.001525 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:43.002845 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:43.003264 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:43.007359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3215ff860>]}
[0m22:06:43.007903 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:43.008343 [debug] [MainThread]: On master: BEGIN
[0m22:06:43.008740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:43.016047 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:43.016639 [debug] [MainThread]: On master: COMMIT
[0m22:06:43.017044 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:43.017436 [debug] [MainThread]: On master: COMMIT
[0m22:06:43.018005 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:43.018436 [debug] [MainThread]: On master: Close
[0m22:06:43.020478 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:43.021041 [info ] [MainThread]: 
[0m22:06:43.030895 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:43.031554 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:43.032269 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:43.032768 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:43.060219 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:43.061163 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:43.098459 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:43.099537 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:54.141664 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.142226 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:54.142945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.143402 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.143843 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:54.144705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.147879 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.148383 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:54.149198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.171129 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.171738 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.172198 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.175132 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.180832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.181370 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:54.182898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.185439 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:54.216838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31970bb00>]}
[0m22:06:54.217685 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.18s]
[0m22:06:54.218484 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:54.219513 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:54.220082 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:54.220817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:54.221283 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:54.226786 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:54.227500 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:54.262615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.263238 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241027220654256372"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:54.263725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:54.279952 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.288496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.289063 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:54.289882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.290335 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.290781 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241027220654256372'
      
      
      order by ordinal_position

  
[0m22:06:54.312563 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.319878 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.320447 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.323597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.331691 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.332216 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.335620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.354596 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:54.355433 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.355923 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241027220654256372"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241027220654256372"
    )
  
[0m22:06:54.389710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.391779 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.392246 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.392704 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.402481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.403507 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:55.415250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2de439610>]}
[0m22:06:55.416103 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 1.19s]
[0m22:06:55.416903 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:55.418423 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:55.418930 [debug] [MainThread]: On master: BEGIN
[0m22:06:55.419397 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:55.426669 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:55.427244 [debug] [MainThread]: On master: COMMIT
[0m22:06:55.427692 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:55.428122 [debug] [MainThread]: On master: COMMIT
[0m22:06:55.428761 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:55.429217 [debug] [MainThread]: On master: Close
[0m22:06:55.430946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:55.431384 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:55.431787 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:55.432256 [info ] [MainThread]: 
[0m22:06:55.432907 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.23 seconds (13.23s).
[0m22:06:55.434057 [debug] [MainThread]: Command end result
[0m22:06:55.462748 [info ] [MainThread]: 
[0m22:06:55.463515 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:55.464121 [info ] [MainThread]: 
[0m22:06:55.464761 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:55.465895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.238665, "process_user_time": 6.932973, "process_kernel_time": 0.301608, "process_mem_max_rss": "356188", "process_in_blocks": "3808", "process_out_blocks": "130560"}
[0m22:06:55.466559 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:55.466442 after 15.24 seconds
[0m22:06:55.467080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3214d7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa32160c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2de4d2f60>]}
[0m22:06:55.467567 [debug] [MainThread]: Flushing usage events
[0m22:06:57.437108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e375e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3348140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e375f860>]}


============================== 22:06:57.440420 | f3b777d2-4608-4fbe-ac6d-442a18d0d0d2 ==============================
[0m22:06:57.440420 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:57.441225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:57.601557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3b777d2-4608-4fbe-ac6d-442a18d0d0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e2c5f710>]}
[0m22:06:57.619386 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23291159, "process_user_time": 1.489889, "process_kernel_time": 0.100126, "process_mem_max_rss": "91996", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:57.620025 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:57.619911 after 0.23 seconds
[0m22:06:57.620553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3348140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e32497f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e31f3980>]}
[0m22:06:57.621025 [debug] [MainThread]: Flushing usage events
[0m06:02:18.359027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1569605d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15695a1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1567f94fe0>]}


============================== 06:02:18.367875 | c20095a7-de61-4d0b-86b7-e546f68a3dc1 ==============================
[0m06:02:18.367875 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:18.368546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:18.506673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c20095a7-de61-4d0b-86b7-e546f68a3dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f156704ae70>]}
[0m06:02:18.520055 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8g6ssrag'
[0m06:02:18.520511 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:18.585227 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:18.585906 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:18.609355 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:18.613273 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:18.686458 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:18.686971 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:18.687480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c20095a7-de61-4d0b-86b7-e546f68a3dc1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1566f04e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1567235280>]}
[0m06:02:18.687964 [info ] [MainThread]: 
[0m06:02:18.688445 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:18.712703 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4020372, "process_user_time": 1.556321, "process_kernel_time": 0.132709, "process_mem_max_rss": "93536", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:18.713299 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:18.713195 after 0.40 seconds
[0m06:02:18.713734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f156761d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f156709fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15673b4a70>]}
[0m06:02:18.714163 [debug] [MainThread]: Flushing usage events
[0m06:02:20.269689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108b2ee120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10898fdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10898fcb00>]}


============================== 06:02:20.272646 | 73826b8e-2dee-4ff6-966e-395ab8ee36d9 ==============================
[0m06:02:20.272646 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:20.273297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:20.510547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1088d69880>]}
[0m06:02:20.569138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10892c8320>]}
[0m06:02:20.571617 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:20.593170 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:20.593909 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:20.594447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1081d2fb90>]}
[0m06:02:21.818318 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:21.818975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1088df49b0>]}
[0m06:02:21.998149 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:22.003079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1081bf06e0>]}
[0m06:02:22.133076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10816a3200>]}
[0m06:02:22.133654 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:22.134137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108172ba70>]}
[0m06:02:22.135823 [info ] [MainThread]: 
[0m06:02:22.136482 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:22.141288 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:22.176435 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:22.176876 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:22.177277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:22.540197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.541832 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:22.544257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:22.544854 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:22.552162 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.552602 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:22.552993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:22.559537 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.561020 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.561434 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:22.561976 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.562368 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.562746 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:22.563306 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.564247 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:22.564653 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.565029 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:22.565550 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.565956 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:22.568074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:22.574509 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.574922 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:22.575292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:22.581009 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.581414 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.581804 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:22.603795 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.605251 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:22.606439 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:22.606838 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:22.610088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108c4268a0>]}
[0m06:02:22.610603 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.610991 [debug] [MainThread]: On master: BEGIN
[0m06:02:22.611358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:22.617832 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.618254 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.618652 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.619028 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.619553 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.620001 [debug] [MainThread]: On master: Close
[0m06:02:22.621406 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:22.621949 [info ] [MainThread]: 
[0m06:02:22.636945 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:22.637537 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:22.638262 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:22.638716 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:22.665045 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:22.665809 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:22.701619 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:22.702361 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:29.756974 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.757477 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:29.758127 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.758592 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.759029 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:29.759760 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.762599 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.763053 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:29.763755 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.784649 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:29.785127 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.785568 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:29.787100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.792068 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.792535 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:29.793668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.795986 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:29.825065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1088cc2060>]}
[0m06:02:29.825768 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.19s]
[0m06:02:29.826537 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:29.827490 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:29.828079 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:29.828652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:29.829115 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:29.834081 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:29.834728 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:29.868053 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.868559 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241028060229862204"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:29.869037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:29.883587 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.890959 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.891434 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:29.892079 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.892520 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.892970 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241028060229862204'
      
      
      order by ordinal_position

  
[0m06:02:29.915824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.921889 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.922385 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.925185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.932645 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.933121 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.936011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.953642 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:29.954335 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.954797 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241028060229862204"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241028060229862204"
    )
  
[0m06:02:29.984503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.986490 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.986946 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.987370 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.995603 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.996522 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:30.136153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10422ec8c0>]}
[0m06:02:30.136968 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m06:02:30.137720 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:30.139189 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.139666 [debug] [MainThread]: On master: BEGIN
[0m06:02:30.140141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:30.146992 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.147469 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.147950 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.148377 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.148956 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.149409 [debug] [MainThread]: On master: Close
[0m06:02:30.150854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:30.151291 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:30.151743 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:30.152241 [info ] [MainThread]: 
[0m06:02:30.152753 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.02 seconds (8.02s).
[0m06:02:30.153745 [debug] [MainThread]: Command end result
[0m06:02:30.181928 [info ] [MainThread]: 
[0m06:02:30.182587 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:30.183093 [info ] [MainThread]: 
[0m06:02:30.183612 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:30.184681 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.96344, "process_user_time": 4.969685, "process_kernel_time": 0.314839, "process_mem_max_rss": "297320", "process_in_blocks": "3808", "process_out_blocks": "112624"}
[0m06:02:30.185331 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:30.185219 after 9.96 seconds
[0m06:02:30.185826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108b2ee120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1088f3a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104214e510>]}
[0m06:02:30.186313 [debug] [MainThread]: Flushing usage events
[0m06:02:31.831184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5e627140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5e6269c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5d7d2570>]}


============================== 06:02:31.834361 | 2ee77072-d821-4900-9789-821437692a7a ==============================
[0m06:02:31.834361 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:31.835114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:31.993074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ee77072-d821-4900-9789-821437692a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5d562240>]}
[0m06:02:32.009945 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22726344, "process_user_time": 1.442231, "process_kernel_time": 0.095882, "process_mem_max_rss": "92276", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:32.010536 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:32.010433 after 0.23 seconds
[0m06:02:32.010980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d611bbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5d57bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5e5c5070>]}
[0m06:02:32.011409 [debug] [MainThread]: Flushing usage events
[0m14:05:43.781127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d9c3620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333e491160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333dc9c770>]}


============================== 14:05:43.799641 | 454ab71b-5d52-4fe9-a35a-634712aa6b74 ==============================
[0m14:05:43.799641 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:43.800427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:43.961611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '454ab71b-5d52-4fe9-a35a-634712aa6b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d3e8230>]}
[0m14:05:43.976818 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wktfb13p'
[0m14:05:43.977353 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:44.104878 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:44.105759 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:44.179463 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:44.183914 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:44.360156 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:44.360838 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:44.361424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '454ab71b-5d52-4fe9-a35a-634712aa6b74', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d3e8f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d54bdd0>]}
[0m14:05:44.361927 [info ] [MainThread]: 
[0m14:05:44.362433 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:44.390756 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.661077, "process_user_time": 1.735637, "process_kernel_time": 0.107977, "process_mem_max_rss": "93768", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:44.391570 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:44.391446 after 0.66 seconds
[0m14:05:44.392072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333ec21640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d8c9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d861730>]}
[0m14:05:44.392542 [debug] [MainThread]: Flushing usage events
[0m14:05:46.156727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e6426540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e6e3e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e8795d00>]}


============================== 14:05:46.159939 | ca1f2f26-aca7-4c38-9221-1bfdeee532f7 ==============================
[0m14:05:46.159939 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:46.160693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:46.425161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e61f8aa0>]}
[0m14:05:46.487802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e64f26c0>]}
[0m14:05:46.490644 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:46.516229 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:46.517081 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:46.517629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df342b40>]}
[0m14:05:47.829796 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:47.830516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77dedb0b60>]}
[0m14:05:48.026393 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:48.032360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ded3e660>]}
[0m14:05:48.199016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77deb6c7a0>]}
[0m14:05:48.199639 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:48.200193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77dec256a0>]}
[0m14:05:48.202160 [info ] [MainThread]: 
[0m14:05:48.202970 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:48.208117 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:48.247755 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:48.248342 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:48.248820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:48.768037 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:48.769813 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:48.772266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:48.772943 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:48.780676 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.781206 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:48.781624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:48.788873 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.790570 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.790992 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:48.791579 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.791981 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.792396 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:48.793019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.794009 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:48.794436 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.794828 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:48.795396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.795823 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:48.798396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:48.806394 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:48.806841 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:48.807246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:48.814053 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.814530 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:48.814952 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:48.839235 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.841053 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:48.842431 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:48.842878 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:48.847005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e6d6c6e0>]}
[0m14:05:48.847601 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:48.848029 [debug] [MainThread]: On master: BEGIN
[0m14:05:48.848428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:48.855524 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:48.856006 [debug] [MainThread]: On master: COMMIT
[0m14:05:48.856417 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:48.856869 [debug] [MainThread]: On master: COMMIT
[0m14:05:48.857473 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:48.857912 [debug] [MainThread]: On master: Close
[0m14:05:48.859999 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:48.860565 [info ] [MainThread]: 
[0m14:05:48.879979 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:48.880705 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:48.881552 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:48.882035 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:48.909454 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:48.910364 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:48.948134 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:48.949183 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:56.930571 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.931174 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:56.932051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.932549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.933060 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:56.933960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.937499 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.937981 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:56.938789 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.961034 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:56.961640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.962109 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:56.963776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.969644 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.970155 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:56.971552 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.974183 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:57.006216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77decc08c0>]}
[0m14:05:57.007157 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.12s]
[0m14:05:57.007987 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:57.009092 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:57.009714 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:57.010389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:57.010883 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:57.016725 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:57.017547 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:57.053973 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.054602 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241028140557047475"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:57.055105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:57.071428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.079986 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.080502 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:57.081243 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.081711 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.082157 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241028140557047475'
      
      
      order by ordinal_position

  
[0m14:05:57.105092 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.112743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.113364 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:57.117315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.126028 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.126562 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:57.129934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.149054 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:57.149908 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.150420 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241028140557047475"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241028140557047475"
    )
  
[0m14:05:57.183889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.186207 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:57.186761 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.187250 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:57.196562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.197629 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:57.337692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f779b420d40>]}
[0m14:05:57.338585 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m14:05:57.339395 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:57.340971 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:57.341583 [debug] [MainThread]: On master: BEGIN
[0m14:05:57.342121 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:57.349793 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:57.350375 [debug] [MainThread]: On master: COMMIT
[0m14:05:57.350839 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:57.351288 [debug] [MainThread]: On master: COMMIT
[0m14:05:57.351913 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:57.352399 [debug] [MainThread]: On master: Close
[0m14:05:57.354457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:57.354918 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:57.355341 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:57.355854 [info ] [MainThread]: 
[0m14:05:57.356484 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.15 seconds (9.15s).
[0m14:05:57.357739 [debug] [MainThread]: Command end result
[0m14:05:57.388195 [info ] [MainThread]: 
[0m14:05:57.389036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:57.389584 [info ] [MainThread]: 
[0m14:05:57.390138 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:57.391288 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.286792, "process_user_time": 5.839365, "process_kernel_time": 0.391421, "process_mem_max_rss": "281868", "process_in_blocks": "3808", "process_out_blocks": "112616"}
[0m14:05:57.391992 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:57.391870 after 11.29 seconds
[0m14:05:57.392522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e69639e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e69a21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e61f8560>]}
[0m14:05:57.393075 [debug] [MainThread]: Flushing usage events
[0m14:05:59.320466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fd5ffec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fda0bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fda0a870>]}


============================== 14:05:59.323774 | 46d2110e-44fd-4b6b-8cbf-c6fa57daab8a ==============================
[0m14:05:59.323774 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:59.324510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:59.488817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46d2110e-44fd-4b6b-8cbf-c6fa57daab8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fcf0bce0>]}
[0m14:05:59.507518 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23926263, "process_user_time": 1.571253, "process_kernel_time": 0.08396, "process_mem_max_rss": "92252", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:59.508167 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:59.508051 after 0.24 seconds
[0m14:05:59.508643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fcf5f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fce5f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fcef2ed0>]}
[0m14:05:59.509163 [debug] [MainThread]: Flushing usage events
[0m22:05:38.658088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54406d3a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5441648440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544073f830>]}


============================== 22:05:38.665394 | b1329918-f83e-4a5d-bf4e-a180b24ce659 ==============================
[0m22:05:38.665394 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:38.666087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:38.803293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1329918-f83e-4a5d-bf4e-a180b24ce659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543fbbae70>]}
[0m22:05:38.816893 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-u8ddbmzd'
[0m22:05:38.817357 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:38.869130 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:38.869807 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:38.892432 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:38.896331 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:38.994011 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:38.994622 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:38.995248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b1329918-f83e-4a5d-bf4e-a180b24ce659', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543fb4b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543fa4d6d0>]}
[0m22:05:38.995751 [info ] [MainThread]: 
[0m22:05:38.996285 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:38.998117 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3881039, "process_user_time": 1.530194, "process_kernel_time": 0.149385, "process_mem_max_rss": "93508", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m22:05:38.998722 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:38.998618 after 0.39 seconds
[0m22:05:38.999162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544016c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5440af9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544073f830>]}
[0m22:05:38.999586 [debug] [MainThread]: Flushing usage events
[0m22:05:40.611452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9002fa97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9003e21910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9003e230e0>]}


============================== 22:05:40.614428 | edb8cd76-1e0e-46db-bcb7-e9820d35e989 ==============================
[0m22:05:40.614428 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:40.615175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:40.853051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9002da64b0>]}
[0m22:05:40.912515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9002e45370>]}
[0m22:05:40.915132 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:40.937314 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:40.938057 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:40.938576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90039b6de0>]}
[0m22:05:42.172007 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:42.172654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb8f35c0>]}
[0m22:05:42.352392 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:42.357589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb92b020>]}
[0m22:05:42.481000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb8d83b0>]}
[0m22:05:42.481565 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:42.482071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb6920c0>]}
[0m22:05:42.483770 [info ] [MainThread]: 
[0m22:05:42.484453 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:42.489232 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:42.524802 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:42.525271 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:42.525668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:43.138197 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:43.139806 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:43.141963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:43.142515 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:43.149724 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.150154 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:43.150544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:43.157071 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.158565 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.158965 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:43.159582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.160003 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.160381 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:43.160952 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.161880 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:43.162288 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.162663 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:43.163199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.163603 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:43.165716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:43.173081 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:43.173502 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:43.173870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:43.180152 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.180561 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:43.180958 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:43.204925 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.206515 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:43.207763 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:43.208166 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:43.212047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb7dbdd0>]}
[0m22:05:43.212590 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:43.212990 [debug] [MainThread]: On master: BEGIN
[0m22:05:43.213368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:43.219974 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:43.220406 [debug] [MainThread]: On master: COMMIT
[0m22:05:43.220800 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:43.221173 [debug] [MainThread]: On master: COMMIT
[0m22:05:43.221712 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:43.222119 [debug] [MainThread]: On master: Close
[0m22:05:43.223732 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:43.224229 [info ] [MainThread]: 
[0m22:05:43.233892 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:43.234510 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:43.235146 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:43.235585 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:43.261552 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:43.262395 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:43.297929 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:43.298749 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:50.066806 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.067328 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:50.068038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.068496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.068943 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:50.069651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.072575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.073034 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:50.073717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.094460 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:50.094943 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.095388 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:50.097609 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.102648 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.103115 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:50.104532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.106880 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:50.137412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900445a150>]}
[0m22:05:50.138216 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.90s]
[0m22:05:50.138984 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:50.139990 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:50.140560 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:50.141139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:50.141598 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:50.146942 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:50.147619 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:50.181636 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.182168 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241028220550175642"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:50.182641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:50.198174 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.206275 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.206756 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:50.207427 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.207917 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.208361 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241028220550175642'
      
      
      order by ordinal_position

  
[0m22:05:50.229210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.235641 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.236176 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:50.239370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.247207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.247684 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:50.250561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.268531 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:50.269300 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.269774 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241028220550175642"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241028220550175642"
    )
  
[0m22:05:50.298689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.300704 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:50.301159 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.301580 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:50.309703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.310596 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:50.451578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc12d0200>]}
[0m22:05:50.452426 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m22:05:50.453170 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:50.454649 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:50.455117 [debug] [MainThread]: On master: BEGIN
[0m22:05:50.455545 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:50.462423 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:50.462901 [debug] [MainThread]: On master: COMMIT
[0m22:05:50.463328 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:50.463776 [debug] [MainThread]: On master: COMMIT
[0m22:05:50.464359 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:50.464799 [debug] [MainThread]: On master: Close
[0m22:05:50.466280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:50.466715 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:50.467117 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:50.467569 [info ] [MainThread]: 
[0m22:05:50.468189 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.98 seconds (7.98s).
[0m22:05:50.469276 [debug] [MainThread]: Command end result
[0m22:05:50.496958 [info ] [MainThread]: 
[0m22:05:50.497662 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:50.498267 [info ] [MainThread]: 
[0m22:05:50.498858 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:50.499994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.936945, "process_user_time": 5.479856, "process_kernel_time": 0.311991, "process_mem_max_rss": "287164", "process_in_blocks": "3808", "process_out_blocks": "113160"}
[0m22:05:50.500666 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:50.500553 after 9.94 seconds
[0m22:05:50.501161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90038fc7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc0216090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffa4807a0>]}
[0m22:05:50.501664 [debug] [MainThread]: Flushing usage events
[0m22:05:52.196621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d254ca900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2539fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d26915550>]}


============================== 22:05:52.199505 | e335a262-b8c2-4cbc-974f-c79ee515e094 ==============================
[0m22:05:52.199505 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:52.200259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:52.348253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e335a262-b8c2-4cbc-974f-c79ee515e094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d251026c0>]}
[0m22:05:52.365379 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21789801, "process_user_time": 1.404242, "process_kernel_time": 0.136023, "process_mem_max_rss": "92388", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:52.365981 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:52.365877 after 0.22 seconds
[0m22:05:52.366432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d251026c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d24d4b1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d24e5cc50>]}
[0m22:05:52.366873 [debug] [MainThread]: Flushing usage events
[0m06:02:05.874699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb618a92420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb618a90e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61874de20>]}


============================== 06:02:05.893234 | 1fc0631d-75df-47e4-9d2e-ae5618b5a5d6 ==============================
[0m06:02:05.893234 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:05.893872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:06.033358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fc0631d-75df-47e4-9d2e-ae5618b5a5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61831d580>]}
[0m06:02:06.047041 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_msqsnw1'
[0m06:02:06.047532 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:06.108637 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:06.109380 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:06.119567 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:06.123504 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:06.170299 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:06.170888 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:06.171461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1fc0631d-75df-47e4-9d2e-ae5618b5a5d6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61808bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61808bbf0>]}
[0m06:02:06.171932 [info ] [MainThread]: 
[0m06:02:06.172387 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:06.179134 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.35275716, "process_user_time": 1.568156, "process_kernel_time": 0.130002, "process_mem_max_rss": "93900", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:06.179878 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:06.179770 after 0.35 seconds
[0m06:02:06.180319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb618d545c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb618587bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6197d06e0>]}
[0m06:02:06.180753 [debug] [MainThread]: Flushing usage events
[0m06:02:07.742006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6470265a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f8ec380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f8ed2b0>]}


============================== 06:02:07.744856 | b76403ca-1e77-4730-8cf1-a90ddf729293 ==============================
[0m06:02:07.744856 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:07.745555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.977242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f63b590>]}
[0m06:02:08.036224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6470adbec0>]}
[0m06:02:08.038637 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:08.074822 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:08.075554 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:08.076085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f692e70>]}
[0m06:02:09.311566 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:09.312222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f63afc0>]}
[0m06:02:09.493636 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:09.498648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64682e9d60>]}
[0m06:02:09.617822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64680588c0>]}
[0m06:02:09.618375 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:09.618874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64682cb470>]}
[0m06:02:09.620603 [info ] [MainThread]: 
[0m06:02:09.621293 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:09.626211 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:09.661656 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:09.662104 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:09.662508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:10.226649 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:10.228280 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:10.230511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:10.231101 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:10.238472 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.238909 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:10.239334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.245839 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.247352 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.247765 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:10.248324 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.248721 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.249098 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:10.249676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.250597 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.250999 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.251405 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.251946 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.252352 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:10.254399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:10.261642 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.262062 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:10.262437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.268396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.268819 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.269280 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:10.294420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.296101 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:10.297382 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:10.297807 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:10.301642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6468041250>]}
[0m06:02:10.302177 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.302582 [debug] [MainThread]: On master: BEGIN
[0m06:02:10.302961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:10.309589 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.310030 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.310424 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.310805 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.311367 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.311778 [debug] [MainThread]: On master: Close
[0m06:02:10.313471 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:10.313965 [info ] [MainThread]: 
[0m06:02:10.329825 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:10.330458 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:10.331130 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:10.331634 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:10.358185 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:10.359029 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:10.396225 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:10.397147 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:19.112879 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.113397 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:19.114027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.114478 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.114914 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:19.115747 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.118575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.119026 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:19.119820 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.140907 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:19.141441 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.141882 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:19.143101 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.148206 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.148679 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:19.150171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.152637 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:19.182112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6470d2f920>]}
[0m06:02:19.182869 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.85s]
[0m06:02:19.183673 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:19.184677 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:19.185242 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:19.185807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:19.186260 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:19.191587 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:19.192257 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:19.226190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.226699 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241029060219220278"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:19.227186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:19.241483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.249053 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.249520 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:19.250117 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.250569 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.251006 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241029060219220278'
      
      
      order by ordinal_position

  
[0m06:02:19.271620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.277827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.278304 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:19.281510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.290225 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.290913 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:19.295071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.320612 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:19.321525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.322196 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241029060219220278"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241029060219220278"
    )
  
[0m06:02:19.361662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.364610 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:19.365231 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.365863 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:19.374679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.375971 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:19.524689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64248bf920>]}
[0m06:02:19.525518 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m06:02:19.526258 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:19.527631 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.528104 [debug] [MainThread]: On master: BEGIN
[0m06:02:19.528529 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:19.535183 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.535692 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.536133 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.536557 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.537150 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.537609 [debug] [MainThread]: On master: Close
[0m06:02:19.538946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:19.539438 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:19.539848 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:19.540305 [info ] [MainThread]: 
[0m06:02:19.540816 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.92 seconds (9.92s).
[0m06:02:19.541815 [debug] [MainThread]: Command end result
[0m06:02:19.570216 [info ] [MainThread]: 
[0m06:02:19.570846 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:19.571401 [info ] [MainThread]: 
[0m06:02:19.571939 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:19.572962 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.879456, "process_user_time": 5.548978, "process_kernel_time": 0.387509, "process_mem_max_rss": "291988", "process_in_blocks": "3808", "process_out_blocks": "114152"}
[0m06:02:19.573638 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:19.573523 after 11.88 seconds
[0m06:02:19.574145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6471bd8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646fd3c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f8a76b0>]}
[0m06:02:19.574643 [debug] [MainThread]: Flushing usage events
[0m06:02:21.187484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539ccce570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539cccdeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539ccce3f0>]}


============================== 06:02:21.190278 | 1b9b4c32-9f56-4c57-9946-8b2f5078bbad ==============================
[0m06:02:21.190278 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:21.191018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:21.335199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b9b4c32-9f56-4c57-9946-8b2f5078bbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539ccfef60>]}
[0m06:02:21.351940 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21317771, "process_user_time": 1.417532, "process_kernel_time": 0.099826, "process_mem_max_rss": "92252", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:21.352514 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:21.352410 after 0.21 seconds
[0m06:02:21.352952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539cca58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539ca5fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539c97ae10>]}
[0m06:02:21.353369 [debug] [MainThread]: Flushing usage events
