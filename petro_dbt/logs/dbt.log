[0m14:06:54.474287 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250715140654467815"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:54.474881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:54.482667 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.490110 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.490561 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:54.491169 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.491605 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.492058 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250715140654467815'
      
      
      order by ordinal_position

  
[0m14:06:54.494179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.499235 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.499683 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:54.501772 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.509308 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.509759 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:54.512134 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.530292 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:54.530949 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.531419 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250715140654467815"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250715140654467815"
    )
  
[0m14:06:54.579481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.581534 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:54.582021 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.582441 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:54.590003 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.590903 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:54.592487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09308d6d-edf1-4466-9431-a161911700cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e3732750>]}
[0m14:06:54.593182 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:06:54.593905 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:54.595517 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:54.595917 [debug] [MainThread]: On master: BEGIN
[0m14:06:54.596322 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:54.596956 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:54.597386 [debug] [MainThread]: On master: COMMIT
[0m14:06:54.597756 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:54.598158 [debug] [MainThread]: On master: COMMIT
[0m14:06:54.598668 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:54.599086 [debug] [MainThread]: On master: Close
[0m14:06:54.599708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:54.600097 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:54.600492 [info ] [MainThread]: 
[0m14:06:54.600953 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.52 seconds (8.52s).
[0m14:06:54.601884 [debug] [MainThread]: Command end result
[0m14:06:54.627801 [info ] [MainThread]: 
[0m14:06:54.628362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:54.628806 [info ] [MainThread]: 
[0m14:06:54.629278 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:54.630216 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.538381, "process_user_time": 4.943477, "process_kernel_time": 0.274693, "process_mem_max_rss": "339808", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m14:06:54.630746 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:54.630646 after 10.54 seconds
[0m14:06:54.631199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9255cf1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9273674d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9259f23f0>]}
[0m14:06:54.631617 [debug] [MainThread]: Flushing usage events
[0m14:06:56.430822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6768e135c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6769b84f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67670bdee0>]}


============================== 14:06:56.433947 | d676c5db-9b13-438b-99e5-6cbbd5564aef ==============================
[0m14:06:56.433947 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:56.434659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:56.542057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd676c5db-9b13-438b-99e5-6cbbd5564aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6766e4b2f0>]}
[0m14:06:56.559685 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17781195, "process_user_time": 1.342943, "process_kernel_time": 0.097922, "process_mem_max_rss": "100468", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:06:56.560259 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:56.560155 after 0.18 seconds
[0m14:06:56.560668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f676738af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f676703f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6766fde660>]}
[0m14:06:56.561099 [debug] [MainThread]: Flushing usage events
[0m22:06:37.212915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53bacdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53bacf980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53bacfd70>]}


============================== 22:06:37.228375 | aabb3fd5-bfb4-489e-8aa5-efc015182123 ==============================
[0m22:06:37.228375 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:37.229046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:37.362884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aabb3fd5-bfb4-489e-8aa5-efc015182123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53baec560>]}
[0m22:06:37.378224 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yj9vlmh4'
[0m22:06:37.378705 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:37.465005 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:37.465726 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:37.506004 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:37.509847 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:37.878680 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:37.879264 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:37.879792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'aabb3fd5-bfb4-489e-8aa5-efc015182123', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53b198980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53b1982c0>]}
[0m22:06:37.880251 [info ] [MainThread]: 
[0m22:06:37.880734 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:37.890962 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.72705317, "process_user_time": 1.53077, "process_kernel_time": 0.147073, "process_mem_max_rss": "101828", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m22:06:37.891525 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:37.891422 after 0.73 seconds
[0m22:06:37.891942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53b4377a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53b56cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53d7eb1a0>]}
[0m22:06:37.892375 [debug] [MainThread]: Flushing usage events
[0m22:06:39.668735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd92b512e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9080b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8ffcf950>]}


============================== 22:06:39.671802 | 07f61831-7c10-488c-aa9a-cde013106d34 ==============================
[0m22:06:39.671802 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:39.672440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:39.872747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8fe4ef90>]}
[0m22:06:39.931763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd91cdccb0>]}
[0m22:06:39.934306 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:39.958071 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:39.958785 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:39.959321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8fcb1c70>]}
[0m22:06:41.257700 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:41.258343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bddb350>]}
[0m22:06:41.489356 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:41.494798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bb78980>]}
[0m22:06:41.591409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bb19df0>]}
[0m22:06:41.591925 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:41.592464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bbdaa20>]}
[0m22:06:41.594279 [info ] [MainThread]: 
[0m22:06:41.594998 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:41.599646 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:41.633853 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:41.634300 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:41.634682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:42.118118 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.119955 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:42.121170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:42.121788 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:42.130250 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.130778 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:42.131309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.132436 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.134095 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.134645 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:42.135367 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.135779 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.136232 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:42.136884 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.137949 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.138387 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.138785 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.139363 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.139789 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:42.141166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:42.147512 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.148033 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:42.148480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.149180 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.149642 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.150062 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:42.161782 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.163266 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:42.164494 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:42.164891 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:42.167228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bbd6810>]}
[0m22:06:42.167738 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.168118 [debug] [MainThread]: On master: BEGIN
[0m22:06:42.168500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:42.169097 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.169524 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.169887 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.170259 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.170775 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.171193 [debug] [MainThread]: On master: Close
[0m22:06:42.171723 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:42.172235 [info ] [MainThread]: 
[0m22:06:42.191027 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:42.191623 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:42.192266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:42.192703 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:42.219858 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:42.220731 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:42.256835 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:42.257715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:54.131366 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.131853 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:54.132518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.132949 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.133387 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:54.134061 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.136969 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.137423 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:54.138080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.154671 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.155124 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.155565 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.157016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.162600 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.163055 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:54.165002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.167376 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:54.168886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8a725e20>]}
[0m22:06:54.169571 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.98s]
[0m22:06:54.170390 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:54.171241 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:54.171793 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:54.172577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:54.173012 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:54.177899 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:54.178541 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:54.214469 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.214953 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250715220654208490"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:54.215423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:54.223242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.230804 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.231350 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:54.232014 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.232552 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.232968 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250715220654208490'
      
      
      order by ordinal_position

  
[0m22:06:54.236007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.241188 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.241644 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.243783 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.251419 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.251872 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.254599 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.272778 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:54.273476 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.273936 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250715220654208490"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250715220654208490"
    )
  
[0m22:06:54.324834 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.326820 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.327295 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.327701 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.337283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.338165 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:54.339699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd51cff9e0>]}
[0m22:06:54.340384 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:06:54.341102 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:54.342474 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:54.342894 [debug] [MainThread]: On master: BEGIN
[0m22:06:54.343308 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:54.343940 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:54.344375 [debug] [MainThread]: On master: COMMIT
[0m22:06:54.344836 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:54.345226 [debug] [MainThread]: On master: COMMIT
[0m22:06:54.345741 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:54.346129 [debug] [MainThread]: On master: Close
[0m22:06:54.346829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:54.347233 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:54.347630 [info ] [MainThread]: 
[0m22:06:54.348156 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.75 seconds (12.75s).
[0m22:06:54.349167 [debug] [MainThread]: Command end result
[0m22:06:54.374556 [info ] [MainThread]: 
[0m22:06:54.375162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:54.375674 [info ] [MainThread]: 
[0m22:06:54.376203 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:54.377187 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.757243, "process_user_time": 5.138785, "process_kernel_time": 0.273935, "process_mem_max_rss": "338488", "process_in_blocks": "1200", "process_out_blocks": "100152"}
[0m22:06:54.377716 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:54.377615 after 14.76 seconds
[0m22:06:54.378175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd90be5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd900cc860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bb193d0>]}
[0m22:06:54.378597 [debug] [MainThread]: Flushing usage events
[0m22:06:56.323267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abf787680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abf07efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abf07ccb0>]}


============================== 22:06:56.326368 | 95fa7ffe-f6a5-4e22-86a0-17caea396030 ==============================
[0m22:06:56.326368 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:56.326999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:56.434372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95fa7ffe-f6a5-4e22-86a0-17caea396030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac0353440>]}
[0m22:06:56.451700 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1783122, "process_user_time": 1.325029, "process_kernel_time": 0.103923, "process_mem_max_rss": "100612", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:56.452240 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:56.452119 after 0.18 seconds
[0m22:06:56.452683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abebec500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abe9575f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abe905f70>]}
[0m22:06:56.453089 [debug] [MainThread]: Flushing usage events
[0m06:02:22.133185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef604d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef5ace3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef5acd9d0>]}


============================== 06:02:22.148970 | fe0263f7-afe7-4523-98b3-40ac2073f6c9 ==============================
[0m06:02:22.148970 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:22.149595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:22.282135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe0263f7-afe7-4523-98b3-40ac2073f6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef57e3c80>]}
[0m06:02:22.296398 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-c_151u01'
[0m06:02:22.296846 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:22.461089 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:22.461670 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:22.484325 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:22.488101 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:22.556772 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:22.557253 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:22.557780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fe0263f7-afe7-4523-98b3-40ac2073f6c9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef4ec3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef4ec36b0>]}
[0m06:02:22.558198 [info ] [MainThread]: 
[0m06:02:22.558651 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:22.566816 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4823665, "process_user_time": 1.539886, "process_kernel_time": 0.136078, "process_mem_max_rss": "101216", "process_in_blocks": "8744", "process_out_blocks": "5168"}
[0m06:02:22.567342 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:22.567241 after 0.48 seconds
[0m06:02:22.567766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef529c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef529f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef5185c40>]}
[0m06:02:22.568186 [debug] [MainThread]: Flushing usage events
[0m06:02:24.167576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e255910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e7eb770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e254680>]}


============================== 06:02:24.170612 | 8b2c16f7-faaf-4259-ba0e-97c5c525244b ==============================
[0m06:02:24.170612 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.171275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.370525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22a11a1b0>]}
[0m06:02:24.428430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22ffd8c80>]}
[0m06:02:24.430961 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:24.454388 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:24.455099 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:24.455606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22a119c70>]}
[0m06:02:25.753023 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:25.753550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22ffd8a70>]}
[0m06:02:25.970929 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:25.976275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e27d940>]}
[0m06:02:26.079676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe229e57cb0>]}
[0m06:02:26.080189 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:26.080703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe229ef1ee0>]}
[0m06:02:26.082479 [info ] [MainThread]: 
[0m06:02:26.083143 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:26.087686 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:26.121488 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:26.121930 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:26.122313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:26.611513 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.613913 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:26.615271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:26.616105 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:26.624951 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.625370 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:26.625768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:26.626708 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.628031 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.628419 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:26.628959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.629341 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.629703 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:26.630307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.631237 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:26.631624 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.632007 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:26.632556 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.632992 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:26.634193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:26.639837 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:26.640323 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:26.640690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:26.641303 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.641688 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:26.642084 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:26.651535 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.652979 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:26.654206 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:26.654607 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:26.656873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe229f683e0>]}
[0m06:02:26.657371 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.657775 [debug] [MainThread]: On master: BEGIN
[0m06:02:26.658134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:26.658717 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.659140 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.659504 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.659881 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.660451 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.660864 [debug] [MainThread]: On master: Close
[0m06:02:26.661364 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:26.661847 [info ] [MainThread]: 
[0m06:02:26.686022 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:26.686590 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:26.687183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:26.687608 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:26.713873 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:26.714599 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:26.749326 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:26.750048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:34.254565 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.255070 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:34.255741 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.256173 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.256589 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:34.257321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.260166 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.260601 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:34.261270 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.277667 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:34.278153 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.278572 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:34.279633 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.285167 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.285618 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:34.286763 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.289051 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:34.290530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2289c1e50>]}
[0m06:02:34.291216 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.60s]
[0m06:02:34.291982 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:34.292821 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:34.293377 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:34.294146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:34.294586 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:34.299405 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:34.300038 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:34.335622 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.336129 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250716060234329630"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:34.336577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:34.344074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.351394 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.351876 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:34.352467 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.352923 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.353336 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250716060234329630'
      
      
      order by ordinal_position

  
[0m06:02:34.355413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.360423 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.360896 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:34.362954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.370381 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.370850 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:34.373179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.391000 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:34.391637 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.392109 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250716060234329630"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250716060234329630"
    )
  
[0m06:02:34.441268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.443258 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:34.443704 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.444142 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:34.450907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.451814 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:34.453272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1f0fe3aa0>]}
[0m06:02:34.453958 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:34.454691 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:34.455986 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:34.456394 [debug] [MainThread]: On master: BEGIN
[0m06:02:34.456786 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:34.457409 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:34.457832 [debug] [MainThread]: On master: COMMIT
[0m06:02:34.458205 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:34.458565 [debug] [MainThread]: On master: COMMIT
[0m06:02:34.459117 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:34.459505 [debug] [MainThread]: On master: Close
[0m06:02:34.460195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:34.460576 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:34.461004 [info ] [MainThread]: 
[0m06:02:34.461462 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.38 seconds (8.38s).
[0m06:02:34.462400 [debug] [MainThread]: Command end result
[0m06:02:34.489060 [info ] [MainThread]: 
[0m06:02:34.489655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:34.490133 [info ] [MainThread]: 
[0m06:02:34.490586 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:34.491528 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.372398, "process_user_time": 5.058285, "process_kernel_time": 0.255115, "process_mem_max_rss": "340888", "process_in_blocks": "1200", "process_out_blocks": "99944"}
[0m06:02:34.492111 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:34.492008 after 10.37 seconds
[0m06:02:34.492548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22ec87f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e27d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e672630>]}
[0m06:02:34.492994 [debug] [MainThread]: Flushing usage events
[0m06:02:36.275928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda84dc41d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda847b8d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda84385910>]}


============================== 06:02:36.278785 | d7f03ad2-8ec7-4939-a39d-e05b19251acb ==============================
[0m06:02:36.278785 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:36.279404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:36.383775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7f03ad2-8ec7-4939-a39d-e05b19251acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda844032f0>]}
[0m06:02:36.401004 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17326723, "process_user_time": 1.278813, "process_kernel_time": 0.123885, "process_mem_max_rss": "100716", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:36.401505 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:36.401406 after 0.17 seconds
[0m06:02:36.401930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda84ffc980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda842d5ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda844f8e00>]}
[0m06:02:36.402326 [debug] [MainThread]: Flushing usage events
[0m14:06:12.632996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6c0285f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6abfb0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6a2b20f0>]}


============================== 14:06:12.648999 | 6603dc7b-2553-4b12-bc47-5a0d288b1481 ==============================
[0m14:06:12.648999 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:12.649624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:12.768487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6603dc7b-2553-4b12-bc47-5a0d288b1481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf69ebb2f0>]}
[0m14:06:12.783486 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fs0yalhe'
[0m14:06:12.783969 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:12.859521 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:12.860265 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:12.872290 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:12.876291 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:12.928017 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:12.928534 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:06:12.929066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6603dc7b-2553-4b12-bc47-5a0d288b1481', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf69bc7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6af080e0>]}
[0m14:06:12.929503 [info ] [MainThread]: 
[0m14:06:12.929964 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:12.935546 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3514694, "process_user_time": 1.558616, "process_kernel_time": 0.132052, "process_mem_max_rss": "101680", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m14:06:12.936109 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:12.936008 after 0.35 seconds
[0m14:06:12.936531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6a2d5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf69c28140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf69c28380>]}
[0m14:06:12.936979 [debug] [MainThread]: Flushing usage events
[0m14:06:14.546089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa1b64470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa1e80f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa19ff7d0>]}


============================== 14:06:14.549226 | e11eaf46-d5d0-4fb8-b904-6ba3366f0659 ==============================
[0m14:06:14.549226 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:14.549942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:14.752298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0a774d0>]}
[0m14:06:14.811297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0b871d0>]}
[0m14:06:14.814052 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:06:14.838777 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:14.839473 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:14.840004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0d30d10>]}
[0m14:06:16.119571 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:16.120228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0b0ac00>]}
[0m14:06:16.360569 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:16.366226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa293b680>]}
[0m14:06:16.469246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9c9f1190>]}
[0m14:06:16.469881 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:06:16.470409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9c9ddb50>]}
[0m14:06:16.472336 [info ] [MainThread]: 
[0m14:06:16.473068 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:16.477823 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:16.513560 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:16.514129 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:16.514558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:17.025084 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:06:17.027141 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:17.028323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:17.029066 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:17.037651 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.038109 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:17.038502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:17.039633 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.041032 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.041424 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:17.042029 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.042416 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.042811 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:17.043416 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.044370 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:17.044776 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.045142 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:17.045687 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.046130 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:17.047505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:17.053575 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:17.054103 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:17.054467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:17.055199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.055585 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:17.056009 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:17.066307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.068171 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:17.069567 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:17.070020 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:17.072428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9b3503e0>]}
[0m14:06:17.073030 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:17.073422 [debug] [MainThread]: On master: BEGIN
[0m14:06:17.073819 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:17.074600 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:17.075032 [debug] [MainThread]: On master: COMMIT
[0m14:06:17.075421 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:17.075803 [debug] [MainThread]: On master: COMMIT
[0m14:06:17.076369 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:17.076812 [debug] [MainThread]: On master: Close
[0m14:06:17.077409 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:17.077925 [info ] [MainThread]: 
[0m14:06:17.089903 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:17.090591 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:17.091254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:17.091697 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:17.119376 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:17.120338 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:17.156656 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:17.157611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:23.705359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.705901 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:23.706531 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.706995 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.707408 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:23.708116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.711197 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.711634 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:23.712322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.728979 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:23.729449 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.729889 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:23.731851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.737668 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.738144 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:23.740068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.742456 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:23.744010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5eba48f0>]}
[0m14:06:23.744679 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.65s]
[0m14:06:23.745508 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:23.746346 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:23.746979 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:23.747662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:23.748236 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:23.753206 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:23.753872 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:23.790247 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.790846 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250716140623784138"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:23.791321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:23.799614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.807744 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.808205 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:23.808882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.809314 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.809746 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250716140623784138'
      
      
      order by ordinal_position

  
[0m14:06:23.812285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.817467 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.817945 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:23.820897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.828580 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.829059 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:23.831808 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.849906 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:23.850594 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.851065 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250716140623784138"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250716140623784138"
    )
  
[0m14:06:23.897929 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.899989 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:23.900442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.900875 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:23.908342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.909246 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:23.910719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f900d6060>]}
[0m14:06:23.911410 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:06:23.912146 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:23.913493 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:23.913929 [debug] [MainThread]: On master: BEGIN
[0m14:06:23.914291 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:23.914929 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:23.915319 [debug] [MainThread]: On master: COMMIT
[0m14:06:23.915679 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:23.916070 [debug] [MainThread]: On master: COMMIT
[0m14:06:23.916581 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:23.916997 [debug] [MainThread]: On master: Close
[0m14:06:23.917589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:23.917997 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:23.918393 [info ] [MainThread]: 
[0m14:06:23.918885 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.45 seconds (7.45s).
[0m14:06:23.919836 [debug] [MainThread]: Command end result
[0m14:06:23.945858 [info ] [MainThread]: 
[0m14:06:23.946448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:23.946933 [info ] [MainThread]: 
[0m14:06:23.947416 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:23.948407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.451223, "process_user_time": 5.203976, "process_kernel_time": 0.292617, "process_mem_max_rss": "334352", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m14:06:23.948969 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:23.948863 after 9.45 seconds
[0m14:06:23.949395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa38ed1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0e135f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5e9d3560>]}
[0m14:06:23.949827 [debug] [MainThread]: Flushing usage events
[0m14:06:25.833688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff52914d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5297c4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5297c40e0>]}


============================== 14:06:25.836958 | 321da84a-e5c0-4a21-8797-f34a97dc65a2 ==============================
[0m14:06:25.836958 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:25.837591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:25.945080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '321da84a-e5c0-4a21-8797-f34a97dc65a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff528d02cf0>]}
[0m14:06:25.963382 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17884552, "process_user_time": 1.34691, "process_kernel_time": 0.11091, "process_mem_max_rss": "100768", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:06:25.963952 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:25.963846 after 0.18 seconds
[0m14:06:25.964372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5297c4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff529b64230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff528c16a20>]}
[0m14:06:25.964807 [debug] [MainThread]: Flushing usage events
[0m22:06:26.799923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02d195580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02dec3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02dbe7e60>]}


============================== 22:06:26.815508 | 151c28ef-8ade-4cd5-a1fe-d2d0b0fb68f4 ==============================
[0m22:06:26.815508 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:26.816194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:26.940088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '151c28ef-8ade-4cd5-a1fe-d2d0b0fb68f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02cf4b2f0>]}
[0m22:06:26.954701 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2n04ynic'
[0m22:06:26.955158 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:27.051671 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:27.052336 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:27.062519 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:27.066363 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:27.272176 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:27.272777 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:27.273360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '151c28ef-8ade-4cd5-a1fe-d2d0b0fb68f4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02cb100b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02dd10260>]}
[0m22:06:27.273847 [info ] [MainThread]: 
[0m22:06:27.274355 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:27.281412 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5302712, "process_user_time": 1.574517, "process_kernel_time": 0.132295, "process_mem_max_rss": "101436", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m22:06:27.281984 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:27.281881 after 0.53 seconds
[0m22:06:27.282402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02dec3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02d1b4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02cab9f40>]}
[0m22:06:27.282829 [debug] [MainThread]: Flushing usage events
[0m22:06:29.048671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a852a54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a858d86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a86d39580>]}


============================== 22:06:29.051667 | be82b3f8-3659-458c-9cdb-17cdf8fef51a ==============================
[0m22:06:29.051667 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:29.052370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:29.253262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a86973380>]}
[0m22:06:29.311481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a85dd0e60>]}
[0m22:06:29.314048 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:29.339324 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:29.340047 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:29.340560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a80b01df0>]}
[0m22:06:30.625685 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:30.626357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a80a7dac0>]}
[0m22:06:30.858309 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:30.863782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a84dc0b30>]}
[0m22:06:30.963484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8066a810>]}
[0m22:06:30.964123 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:30.964630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a80681520>]}
[0m22:06:30.966561 [info ] [MainThread]: 
[0m22:06:30.967297 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:30.972180 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:31.009706 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:31.010191 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:31.010585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:31.478929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.481216 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:31.482551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:31.483279 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:31.491985 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.492412 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:31.492813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:31.493733 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.495048 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.495439 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:31.496043 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.496427 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.496832 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:31.497427 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.498364 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:31.498779 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.499150 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:31.499762 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.500164 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:31.501424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:31.507151 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:31.507553 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:31.507937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:31.508656 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.509086 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:31.509462 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:31.518986 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.520418 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:31.521655 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:31.522073 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:31.524285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a869d5100>]}
[0m22:06:31.524812 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.525200 [debug] [MainThread]: On master: BEGIN
[0m22:06:31.525560 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:31.526178 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.526571 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.526986 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.527349 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.527874 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.528267 [debug] [MainThread]: On master: Close
[0m22:06:31.528807 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:31.529267 [info ] [MainThread]: 
[0m22:06:31.546808 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:31.547392 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:31.547983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:31.548425 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:31.574966 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:31.575705 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:31.610832 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:31.611601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:42.044049 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.044535 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:42.045212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.045645 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.046094 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:42.046842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.049732 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.050186 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:42.050889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.067404 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:42.067902 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.068324 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:42.069437 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.075042 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.075497 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:42.076675 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.079011 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:42.080529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7f26eb40>]}
[0m22:06:42.081235 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.53s]
[0m22:06:42.081998 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:42.082907 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:42.083561 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:42.084178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:42.084609 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:42.089490 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:42.090149 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:42.126115 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.126600 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250716220642120108"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:42.127071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:42.134800 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.142144 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.142594 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:42.143204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.143636 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.144087 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250716220642120108'
      
      
      order by ordinal_position

  
[0m22:06:42.146222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.151274 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.151757 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:42.153839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.161398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.161877 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:42.164237 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.182100 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:42.182775 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.183231 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250716220642120108"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250716220642120108"
    )
  
[0m22:06:42.230104 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.232103 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:42.232548 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.232984 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:42.239972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.240865 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:42.242388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a46367800>]}
[0m22:06:42.243076 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:06:42.243887 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:42.245220 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.245623 [debug] [MainThread]: On master: BEGIN
[0m22:06:42.246033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:42.246647 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.247072 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.247436 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.247832 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.248348 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.248756 [debug] [MainThread]: On master: Close
[0m22:06:42.249360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:42.249748 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:42.250158 [info ] [MainThread]: 
[0m22:06:42.250669 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.28 seconds (11.28s).
[0m22:06:42.251678 [debug] [MainThread]: Command end result
[0m22:06:42.277176 [info ] [MainThread]: 
[0m22:06:42.277785 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:42.278294 [info ] [MainThread]: 
[0m22:06:42.278828 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:42.279820 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.279617, "process_user_time": 5.06972, "process_kernel_time": 0.280371, "process_mem_max_rss": "345932", "process_in_blocks": "1200", "process_out_blocks": "100136"}
[0m22:06:42.280359 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:42.280257 after 13.28 seconds
[0m22:06:42.280810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a84d24b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a85da7a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a47492ab0>]}
[0m22:06:42.281240 [debug] [MainThread]: Flushing usage events
[0m22:06:44.312400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6c9755e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6ee57140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6eb3ff50>]}


============================== 22:06:44.315577 | a9494496-d521-4b29-ab8a-f33b906cb8bb ==============================
[0m22:06:44.315577 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:44.316283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:44.423630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9494496-d521-4b29-ab8a-f33b906cb8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6c657380>]}
[0m22:06:44.441652 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1781356, "process_user_time": 1.328535, "process_kernel_time": 0.109961, "process_mem_max_rss": "100620", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:44.442217 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:44.442111 after 0.18 seconds
[0m22:06:44.442640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6c8d1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6eb3ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6c38fe60>]}
[0m22:06:44.443087 [debug] [MainThread]: Flushing usage events
[0m06:02:24.765499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4167ee7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41670f3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41670a8920>]}


============================== 06:02:24.779884 | 8749df10-7965-4093-96de-f8ea67da9811 ==============================
[0m06:02:24.779884 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.780513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.890836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8749df10-7965-4093-96de-f8ea67da9811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41680009b0>]}
[0m06:02:24.905609 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ogvzcj7o'
[0m06:02:24.906075 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:25.068823 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:25.069585 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:25.111270 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:25.115282 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:25.324178 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:25.324763 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:25.325276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8749df10-7965-4093-96de-f8ea67da9811', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4166efe4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4166efd4f0>]}
[0m06:02:25.325752 [info ] [MainThread]: 
[0m06:02:25.326232 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:25.331134 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6152713, "process_user_time": 1.576581, "process_kernel_time": 0.125364, "process_mem_max_rss": "101292", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m06:02:25.331669 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:25.331568 after 0.62 seconds
[0m06:02:25.332117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41679a8f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4166e04380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4166e04350>]}
[0m06:02:25.332524 [debug] [MainThread]: Flushing usage events
[0m06:02:27.050657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4593a9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4593a9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4593a9b50>]}


============================== 06:02:27.053780 | b319958f-50c8-4358-97be-50c6f7f36638 ==============================
[0m06:02:27.053780 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:27.054456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.259267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4598a9220>]}
[0m06:02:27.318377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45927d250>]}
[0m06:02:27.320968 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:27.343863 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:27.344570 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:27.345112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4553a9df0>]}
[0m06:02:28.637748 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:28.638385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4552a14c0>]}
[0m06:02:28.867722 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:28.873115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4594f27e0>]}
[0m06:02:28.967594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4550d6570>]}
[0m06:02:28.968170 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:28.968666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4550b7d70>]}
[0m06:02:28.970515 [info ] [MainThread]: 
[0m06:02:28.971227 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:28.976032 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:29.010773 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:29.011206 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:29.011595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:29.476250 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.477908 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:29.479031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:29.479677 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:29.487564 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.488031 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:29.488410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.489514 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.490868 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.491260 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:29.491856 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.492254 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.492619 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:29.493220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.494145 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.494536 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.494924 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.495453 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.495871 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:29.497115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:29.502913 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.503401 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:29.503790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.504380 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.504785 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.505158 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:29.515346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.516817 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:29.518052 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:29.518442 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:29.520824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff455187dd0>]}
[0m06:02:29.521321 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.521752 [debug] [MainThread]: On master: BEGIN
[0m06:02:29.522125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:29.522759 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.523163 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.523544 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.523972 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.524498 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.524912 [debug] [MainThread]: On master: Close
[0m06:02:29.525427 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:29.525903 [info ] [MainThread]: 
[0m06:02:29.543799 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:29.544418 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:29.545022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:29.545461 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:29.572837 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:29.573575 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:29.609088 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:29.609840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:38.774023 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.774515 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:38.775162 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.775596 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.776038 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:38.776732 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.779648 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.780108 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:38.780773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.797465 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.797944 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.798362 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.800028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.805753 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.806206 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:38.807558 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.809911 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:38.811432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff453c24680>]}
[0m06:02:38.812123 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.27s]
[0m06:02:38.812951 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:38.813785 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:38.814355 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:38.814997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:38.815461 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:38.820553 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:38.821219 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:38.857666 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.858197 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250717060238851555"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:38.858653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:38.866702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.874630 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.875118 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:38.875773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.876207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.876622 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250717060238851555'
      
      
      order by ordinal_position

  
[0m06:02:38.878769 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.883956 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.884427 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:38.886908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.894612 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.895092 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:38.898048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.916282 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:38.916989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.917456 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250717060238851555"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250717060238851555"
    )
  
[0m06:02:38.967289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.969322 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:38.969814 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.970236 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:38.977017 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.977951 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:38.979473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff421d905c0>]}
[0m06:02:38.980184 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:38.981022 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:38.982365 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:38.982810 [debug] [MainThread]: On master: BEGIN
[0m06:02:38.983190 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:38.983867 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:38.984271 [debug] [MainThread]: On master: COMMIT
[0m06:02:38.984655 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:38.985065 [debug] [MainThread]: On master: COMMIT
[0m06:02:38.985614 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:38.986039 [debug] [MainThread]: On master: Close
[0m06:02:38.986635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:38.987039 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:38.987441 [info ] [MainThread]: 
[0m06:02:38.987981 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.02 seconds (10.02s).
[0m06:02:38.988994 [debug] [MainThread]: Command end result
[0m06:02:39.015121 [info ] [MainThread]: 
[0m06:02:39.015740 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:39.016255 [info ] [MainThread]: 
[0m06:02:39.016790 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:39.017806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.016199, "process_user_time": 5.101509, "process_kernel_time": 0.282415, "process_mem_max_rss": "339416", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:39.018345 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:39.018241 after 12.02 seconds
[0m06:02:39.018801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4593a9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff459866720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff417039fa0>]}
[0m06:02:39.019232 [debug] [MainThread]: Flushing usage events
[0m06:02:40.969133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd971f81a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd973082ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd973083a10>]}


============================== 06:02:40.972221 | 2bef1067-5902-4bc1-b9d9-144ac25d8a11 ==============================
[0m06:02:40.972221 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:40.972915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:41.081320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bef1067-5902-4bc1-b9d9-144ac25d8a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd972989dc0>]}
[0m06:02:41.099653 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17934872, "process_user_time": 1.349669, "process_kernel_time": 0.100975, "process_mem_max_rss": "100732", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:41.100212 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:41.100109 after 0.18 seconds
[0m06:02:41.100650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9764d38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd972989dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd971f03110>]}
[0m06:02:41.101107 [debug] [MainThread]: Flushing usage events
[0m14:05:08.056641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d3294350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d299efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d2c83350>]}


============================== 14:05:08.152161 | 931d3a87-7fd0-4172-8030-1e6df84bde61 ==============================
[0m14:05:08.152161 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:08.152857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:08.286345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '931d3a87-7fd0-4172-8030-1e6df84bde61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d39f8860>]}
[0m14:05:08.301554 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-i6zyxnzx'
[0m14:05:08.302027 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:08.375923 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:08.376745 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:08.388795 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:08.393052 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:08.441061 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:08.441616 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:08.442150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '931d3a87-7fd0-4172-8030-1e6df84bde61', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d252c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d39df710>]}
[0m14:05:08.442612 [info ] [MainThread]: 
[0m14:05:08.443093 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:08.472945 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46701247, "process_user_time": 1.625777, "process_kernel_time": 0.136812, "process_mem_max_rss": "101276", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m14:05:08.473690 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:08.473535 after 0.47 seconds
[0m14:05:08.474220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d30f34a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d27b6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d2ba6c00>]}
[0m14:05:08.474692 [debug] [MainThread]: Flushing usage events
[0m14:05:10.089785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4afc4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4aa69430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4afc46e0>]}


============================== 14:05:10.093189 | 0fda693f-2d26-4f04-91fc-3097f2c42bba ==============================
[0m14:05:10.093189 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:10.093857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:10.301729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4a9c4560>]}
[0m14:05:10.361375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4a545460>]}
[0m14:05:10.364271 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:05:10.460385 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:10.461276 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:10.461871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4a3d29f0>]}
[0m14:05:11.759115 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:11.759865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f463c69f0>]}
[0m14:05:12.002347 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:12.008092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4a5f19a0>]}
[0m14:05:12.106293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f461d5df0>]}
[0m14:05:12.106861 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:05:12.107367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f46153bf0>]}
[0m14:05:12.109294 [info ] [MainThread]: 
[0m14:05:12.110033 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:12.114837 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:12.150119 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:12.150549 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:12.150959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:12.625380 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.627550 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:12.628616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:12.629177 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:12.637068 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.637492 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:12.637900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:12.638741 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.640063 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.640451 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:12.641072 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.641452 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.641868 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:12.642485 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.643490 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:12.643913 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.644281 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:12.644833 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.645229 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:12.646552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:12.652259 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:12.652771 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:12.653133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:12.653761 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.654147 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:12.654526 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:12.665146 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.666575 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:12.667848 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:12.668238 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:12.670506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f46114ec0>]}
[0m14:05:12.671089 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:12.671468 [debug] [MainThread]: On master: BEGIN
[0m14:05:12.671854 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:12.672449 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:12.672872 [debug] [MainThread]: On master: COMMIT
[0m14:05:12.673244 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:12.673620 [debug] [MainThread]: On master: COMMIT
[0m14:05:12.674141 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:12.674524 [debug] [MainThread]: On master: Close
[0m14:05:12.675072 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:12.675544 [info ] [MainThread]: 
[0m14:05:12.692107 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:12.692704 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:12.693340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:12.693828 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:12.720771 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:12.721534 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:12.757128 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:12.757885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:19.627850 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:19.628346 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:19.629019 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.629458 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:19.629911 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:19.630619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.633476 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:19.633945 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:19.634615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.651346 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:19.651827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:19.652249 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:19.654246 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.659884 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:19.660339 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:05:19.661490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.663875 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:19.665408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4c27a000>]}
[0m14:05:19.666138 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.97s]
[0m14:05:19.666915 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:19.667892 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:19.668439 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:19.669076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:19.669524 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:19.674460 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:19.675118 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:19.711315 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.711821 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250717140519705231"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:19.712275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:19.720146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.727556 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.728048 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:19.728651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.729094 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.729520 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250717140519705231'
      
      
      order by ordinal_position

  
[0m14:05:19.731776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.736895 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.737354 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:19.739994 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.747645 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.748117 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:19.750244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.768492 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:19.769201 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.769677 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250717140519705231"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250717140519705231"
    )
  
[0m14:05:19.818838 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.821013 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:19.821468 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.821908 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:19.829262 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.830206 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:19.831775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f0c1ca900>]}
[0m14:05:19.832456 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:05:19.833209 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:19.834955 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:19.835359 [debug] [MainThread]: On master: BEGIN
[0m14:05:19.835766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:19.836403 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:19.836836 [debug] [MainThread]: On master: COMMIT
[0m14:05:19.837205 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:19.837562 [debug] [MainThread]: On master: COMMIT
[0m14:05:19.838155 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:19.838543 [debug] [MainThread]: On master: Close
[0m14:05:19.839156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:19.839528 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:19.839975 [info ] [MainThread]: 
[0m14:05:19.840451 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.73 seconds (7.73s).
[0m14:05:19.841409 [debug] [MainThread]: Command end result
[0m14:05:19.867626 [info ] [MainThread]: 
[0m14:05:19.868198 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:19.868690 [info ] [MainThread]: 
[0m14:05:19.869178 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:19.870174 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.830445, "process_user_time": 5.183729, "process_kernel_time": 0.30416, "process_mem_max_rss": "340812", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m14:05:19.870749 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:19.870643 after 9.83 seconds
[0m14:05:19.871187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4aa69430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4617cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f461434a0>]}
[0m14:05:19.871628 [debug] [MainThread]: Flushing usage events
[0m14:05:21.805470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08a0fba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0892f3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff089cefce0>]}


============================== 14:05:21.808648 | 531f34c9-259d-405e-b4c0-446614e77e36 ==============================
[0m14:05:21.808648 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:21.809284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:21.917800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '531f34c9-259d-405e-b4c0-446614e77e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0896d8380>]}
[0m14:05:21.935522 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17981568, "process_user_time": 1.351823, "process_kernel_time": 0.119984, "process_mem_max_rss": "100656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:21.936076 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:21.935968 after 0.18 seconds
[0m14:05:21.936487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0896d8380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0892ace30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0892adac0>]}
[0m14:05:21.936918 [debug] [MainThread]: Flushing usage events
[0m22:06:37.688362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0f1b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0b3fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e1cad340>]}


============================== 22:06:37.703009 | 55ccfe61-aebd-4131-9ccf-d42c867bad5b ==============================
[0m22:06:37.703009 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:37.703722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:37.833597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55ccfe61-aebd-4131-9ccf-d42c867bad5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0f18830>]}
[0m22:06:37.848621 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8czs9t6f'
[0m22:06:37.849082 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:37.987684 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:37.988416 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:38.011784 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:38.015656 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:38.097151 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:38.097702 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:38.098255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '55ccfe61-aebd-4131-9ccf-d42c867bad5b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0ce3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e11d8860>]}
[0m22:06:38.098729 [info ] [MainThread]: 
[0m22:06:38.099223 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:38.106792 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46789932, "process_user_time": 1.540341, "process_kernel_time": 0.141755, "process_mem_max_rss": "101444", "process_in_blocks": "8744", "process_out_blocks": "5168"}
[0m22:06:38.107331 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:38.107230 after 0.47 seconds
[0m22:06:38.107775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0ca5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e17fb770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e1bffbf0>]}
[0m22:06:38.108198 [debug] [MainThread]: Flushing usage events
[0m22:06:39.695347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729d511b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729db4ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729db4a360>]}


============================== 22:06:39.698625 | 93c2906c-261c-4428-9733-b1a42c9b6a69 ==============================
[0m22:06:39.698625 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:39.699319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:39.901254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729d1e74d0>]}
[0m22:06:39.959928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729f1fa240>]}
[0m22:06:39.962439 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:39.984500 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:39.985240 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:39.985761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729e2663f0>]}
[0m22:06:41.269687 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:41.270324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72993e1fa0>]}
[0m22:06:41.492580 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:41.497961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729e3e7d70>]}
[0m22:06:41.592582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72991211f0>]}
[0m22:06:41.593088 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:41.593632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7299117890>]}
[0m22:06:41.595391 [info ] [MainThread]: 
[0m22:06:41.596091 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:41.600732 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:41.634948 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:41.635371 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:41.635783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:42.153368 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:42.155333 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:42.156412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:42.157091 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:42.164747 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.165165 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:42.165561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.166424 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.167738 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.168126 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:42.168670 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.169054 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.169414 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:42.170044 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.170974 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.171364 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.171747 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.172257 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.172670 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:42.173907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:42.179626 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.180033 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:42.180393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.181012 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.181392 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.181801 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:42.191478 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.192926 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:42.194143 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:42.194562 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:42.196745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72992e4290>]}
[0m22:06:42.197239 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.197658 [debug] [MainThread]: On master: BEGIN
[0m22:06:42.198015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:42.198630 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.199021 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.199378 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.199766 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.200310 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.200717 [debug] [MainThread]: On master: Close
[0m22:06:42.201239 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:42.201719 [info ] [MainThread]: 
[0m22:06:42.218993 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:42.219592 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:42.220159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:42.220616 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:42.247371 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:42.248234 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:42.283711 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:42.284483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:49.289847 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:49.290332 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:49.290986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.291417 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:49.291860 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:49.292744 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.295705 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:49.296142 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:49.296820 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.313443 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:49.313930 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:49.314346 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:49.316207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.321973 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:49.322421 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:49.323703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.326032 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:49.327601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729f2767e0>]}
[0m22:06:49.328276 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.11s]
[0m22:06:49.329103 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:49.330047 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:49.330608 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:49.331227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:49.331700 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:49.336537 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:49.337176 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:49.373122 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.373621 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250717220649367133"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:49.374072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:49.381884 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.389303 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.389797 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:49.390395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.390849 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.391263 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250717220649367133'
      
      
      order by ordinal_position

  
[0m22:06:49.393400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.398532 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.398994 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:49.401235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.408813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.409265 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:49.411578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.429598 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:49.430260 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.430729 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250717220649367133"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250717220649367133"
    )
  
[0m22:06:49.479849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.481824 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:49.482258 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.482693 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:49.489277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.490150 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:49.491612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f725b130aa0>]}
[0m22:06:49.492273 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:06:49.493078 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:49.494388 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.494824 [debug] [MainThread]: On master: BEGIN
[0m22:06:49.495191 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:49.495809 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.496200 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.496589 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.496950 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.497495 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.497913 [debug] [MainThread]: On master: Close
[0m22:06:49.498490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:49.498887 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:49.499276 [info ] [MainThread]: 
[0m22:06:49.499785 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.90 seconds (7.90s).
[0m22:06:49.500741 [debug] [MainThread]: Command end result
[0m22:06:49.526243 [info ] [MainThread]: 
[0m22:06:49.526832 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:49.527315 [info ] [MainThread]: 
[0m22:06:49.527820 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:49.528793 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.883148, "process_user_time": 5.089763, "process_kernel_time": 0.286267, "process_mem_max_rss": "341320", "process_in_blocks": "1200", "process_out_blocks": "100144"}
[0m22:06:49.529333 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:49.529231 after 9.88 seconds
[0m22:06:49.529781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729db4a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7299117530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729d9128d0>]}
[0m22:06:49.530196 [debug] [MainThread]: Flushing usage events
[0m22:06:51.318826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b72613a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b77e73e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b77e5730>]}


============================== 22:06:51.321854 | 540f7f8c-94da-4d3d-b31e-021cf5ff666a ==============================
[0m22:06:51.321854 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:51.322471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:51.430858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '540f7f8c-94da-4d3d-b31e-021cf5ff666a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b7e64d40>]}
[0m22:06:51.448163 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17809294, "process_user_time": 1.309544, "process_kernel_time": 0.117048, "process_mem_max_rss": "100496", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:51.448739 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:51.448632 after 0.18 seconds
[0m22:06:51.449157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b73c7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b70975f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b7d27260>]}
[0m22:06:51.449582 [debug] [MainThread]: Flushing usage events
[0m06:02:23.258268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4ac61f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4a43fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4aae32f0>]}


============================== 06:02:23.274827 | 5812e736-3002-42a7-ad8e-5ade1c05b5c2 ==============================
[0m06:02:23.274827 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:23.275533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:23.413662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5812e736-3002-42a7-ad8e-5ade1c05b5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a49e732f0>]}
[0m06:02:23.429894 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x64oqzrk'
[0m06:02:23.430441 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:23.549303 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:23.550095 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:23.573791 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:23.577904 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:23.652174 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:23.652888 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:23.653522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5812e736-3002-42a7-ad8e-5ade1c05b5c2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a49e633b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a49e2ff50>]}
[0m06:02:23.654013 [info ] [MainThread]: 
[0m06:02:23.654529 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:23.664949 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45777413, "process_user_time": 1.654493, "process_kernel_time": 0.148595, "process_mem_max_rss": "101764", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m06:02:23.665622 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:23.665503 after 0.46 seconds
[0m06:02:23.666119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4a4dffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4a087620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4a414c80>]}
[0m06:02:23.666595 [debug] [MainThread]: Flushing usage events
[0m06:02:25.473645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc51ee9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc50107a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc50370170>]}


============================== 06:02:25.477240 | 1418e1cb-b4dd-4f68-a55c-e92e497b1091 ==============================
[0m06:02:25.477240 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.477925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:25.686803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc513553a0>]}
[0m06:02:25.747235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc508abd40>]}
[0m06:02:25.750066 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:25.778712 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:25.779524 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:25.780077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4fd713a0>]}
[0m06:02:27.080827 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:27.081542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4b8a24b0>]}
[0m06:02:27.338467 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:27.344390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc50158650>]}
[0m06:02:27.448386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4bbfde20>]}
[0m06:02:27.449030 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:27.449607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4b840920>]}
[0m06:02:27.451698 [info ] [MainThread]: 
[0m06:02:27.452480 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:27.457556 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:27.493639 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:27.494214 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:27.494656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:28.001694 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:28.003865 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:28.005176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:28.005841 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:28.015305 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:28.015768 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:28.016185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:28.017605 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.019337 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:28.019731 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:28.020323 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.020744 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:28.021364 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:28.022199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.023326 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:28.023776 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:28.024244 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:28.024892 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.025431 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:28.027013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:28.033238 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:28.033688 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:28.034070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:28.034828 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.035234 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:28.035604 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:28.045631 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.047428 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:28.048763 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:28.049186 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:28.051545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4a438560>]}
[0m06:02:28.052119 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:28.052512 [debug] [MainThread]: On master: BEGIN
[0m06:02:28.052879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:28.053698 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:28.054135 [debug] [MainThread]: On master: COMMIT
[0m06:02:28.054521 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:28.054898 [debug] [MainThread]: On master: COMMIT
[0m06:02:28.055532 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:28.055933 [debug] [MainThread]: On master: Close
[0m06:02:28.056562 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:28.057037 [info ] [MainThread]: 
[0m06:02:28.077108 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:28.077810 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:28.078469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:28.078924 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:28.106847 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:28.107791 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:28.144270 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:28.145219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:35.336813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.337378 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:35.338163 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.338608 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.339023 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:35.339805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.342982 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.343450 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:35.344205 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.361315 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:35.361874 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.362340 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:35.364416 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.370509 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.370976 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:35.372709 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.375231 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:35.376832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc51b2a4e0>]}
[0m06:02:35.377562 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.30s]
[0m06:02:35.378355 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:35.379204 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:35.379778 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:35.380435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:35.380884 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:35.386144 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:35.387144 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:35.424791 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.425400 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250718060235418436"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:35.425873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:35.434293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.442643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.443169 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:35.443893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.444359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.444787 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250718060235418436'
      
      
      order by ordinal_position

  
[0m06:02:35.447204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.452819 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.453319 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:35.456029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.464252 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.464761 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:35.467899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.486723 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:35.487538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.488018 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250718060235418436"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250718060235418436"
    )
  
[0m06:02:35.538040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.540122 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:35.540591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.541004 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:35.548586 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.549602 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:35.551196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc12af94c0>]}
[0m06:02:35.551907 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:02:35.552702 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:35.554308 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:35.554736 [debug] [MainThread]: On master: BEGIN
[0m06:02:35.555156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:35.555926 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:35.556363 [debug] [MainThread]: On master: COMMIT
[0m06:02:35.556741 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:35.557128 [debug] [MainThread]: On master: COMMIT
[0m06:02:35.557707 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:35.558150 [debug] [MainThread]: On master: Close
[0m06:02:35.558801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:35.559197 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:35.559610 [info ] [MainThread]: 
[0m06:02:35.560120 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.11 seconds (8.11s).
[0m06:02:35.561074 [debug] [MainThread]: Command end result
[0m06:02:35.588312 [info ] [MainThread]: 
[0m06:02:35.588992 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:35.589538 [info ] [MainThread]: 
[0m06:02:35.590083 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:35.591132 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.168383, "process_user_time": 5.337455, "process_kernel_time": 0.317562, "process_mem_max_rss": "338188", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:35.591698 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:35.591577 after 10.17 seconds
[0m06:02:35.592177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4fe9d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4b8676b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc11993ce0>]}
[0m06:02:35.592616 [debug] [MainThread]: Flushing usage events
[0m06:02:37.649781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68d9c4260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68d9c6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68edf4440>]}


============================== 06:02:37.653122 | 4654d2b0-cf32-4b81-86c6-438f2dd7779c ==============================
[0m06:02:37.653122 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:37.653831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:37.764971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4654d2b0-cf32-4b81-86c6-438f2dd7779c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68de08320>]}
[0m06:02:37.784047 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1852455, "process_user_time": 1.416641, "process_kernel_time": 0.127967, "process_mem_max_rss": "100500", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:37.784650 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:37.784539 after 0.19 seconds
[0m06:02:37.785152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68d82cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb691102c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68de08320>]}
[0m06:02:37.785601 [debug] [MainThread]: Flushing usage events
[0m14:06:12.771340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02926154f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029307aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0292d08740>]}


============================== 14:06:12.846677 | 5cd226cc-24ff-4d9d-ae25-edea5105c4b0 ==============================
[0m14:06:12.846677 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:12.847347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:13.096479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cd226cc-24ff-4d9d-ae25-edea5105c4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02928f9220>]}
[0m14:06:13.111807 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lujts28c'
[0m14:06:13.112295 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:13.239607 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:13.240463 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:13.258944 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:13.262935 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:13.401211 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:13.401824 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:06:13.402387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5cd226cc-24ff-4d9d-ae25-edea5105c4b0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029239ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02928abd70>]}
[0m14:06:13.402865 [info ] [MainThread]: 
[0m14:06:13.403366 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:13.431575 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.70944023, "process_user_time": 1.581547, "process_kernel_time": 0.124515, "process_mem_max_rss": "101468", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m14:06:13.432173 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:13.432065 after 0.71 seconds
[0m14:06:13.432613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02926154f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02924e87a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02928f9700>]}
[0m14:06:13.433072 [debug] [MainThread]: Flushing usage events
[0m14:06:15.081625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae9db06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae9bc5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aea787a10>]}


============================== 14:06:15.084742 | 26ddecb7-7de1-4f83-82e1-bb180e7fd0d5 ==============================
[0m14:06:15.084742 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:15.085381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:15.287403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae94b17c0>]}
[0m14:06:15.345488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aeb6dd3a0>]}
[0m14:06:15.348088 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:06:15.439262 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:15.439980 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:15.440507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae97913a0>]}
[0m14:06:16.736637 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:16.737333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae53ed340>]}
[0m14:06:16.970097 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:16.975527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae95e7aa0>]}
[0m14:06:17.079193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae534be00>]}
[0m14:06:17.079726 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:06:17.080237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae9973140>]}
[0m14:06:17.082108 [info ] [MainThread]: 
[0m14:06:17.082820 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:17.087621 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:17.122493 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:17.122950 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:17.123343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:17.610583 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.612454 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:17.613724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:17.614407 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:17.622947 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.623374 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:17.623750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:17.624724 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.626089 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.626478 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:17.627038 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.627421 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.627788 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:17.628404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.629340 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:17.629733 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.630119 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:17.630649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.631065 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:17.632334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:17.638136 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:17.638629 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:17.639018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:17.639629 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.640044 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:17.640418 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:17.650387 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.651810 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:17.653054 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:17.653444 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:17.655676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae531bd10>]}
[0m14:06:17.656207 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:17.656584 [debug] [MainThread]: On master: BEGIN
[0m14:06:17.656970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:17.657583 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:17.657999 [debug] [MainThread]: On master: COMMIT
[0m14:06:17.658372 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:17.658727 [debug] [MainThread]: On master: COMMIT
[0m14:06:17.659258 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:17.659643 [debug] [MainThread]: On master: Close
[0m14:06:17.660196 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:17.660654 [info ] [MainThread]: 
[0m14:06:17.695031 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:17.695611 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:17.696191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:17.696625 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:17.723489 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:17.724286 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:17.760333 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:17.761219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:25.726531 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:25.727055 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:25.727688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.728159 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:25.728584 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:25.729280 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.732215 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:25.732657 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:25.733554 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.750283 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:25.750739 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:25.751178 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:25.753170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.758923 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:25.759378 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:25.760665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.763044 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:25.764578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa74775c0>]}
[0m14:06:25.765274 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.07s]
[0m14:06:25.766036 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:25.766964 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:25.767611 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:25.768202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:25.768639 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:25.773506 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:25.774163 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:25.810345 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.810844 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250718140625804320"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:25.811322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:25.819288 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.826989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.827447 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:25.828108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.828549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.829008 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250718140625804320'
      
      
      order by ordinal_position

  
[0m14:06:25.831185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.836473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.836968 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:25.839378 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.847846 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.848394 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:25.851400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.870528 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:25.871377 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.871858 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250718140625804320"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250718140625804320"
    )
  
[0m14:06:25.920112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.922213 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:25.922713 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.923167 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:25.931263 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.932198 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:25.933685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aac517740>]}
[0m14:06:25.934385 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:06:25.935153 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:25.936457 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:25.936863 [debug] [MainThread]: On master: BEGIN
[0m14:06:25.937273 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:25.937952 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:25.938365 [debug] [MainThread]: On master: COMMIT
[0m14:06:25.938735 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:25.939134 [debug] [MainThread]: On master: COMMIT
[0m14:06:25.939662 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:25.940096 [debug] [MainThread]: On master: Close
[0m14:06:25.940732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:25.941136 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:25.941536 [info ] [MainThread]: 
[0m14:06:25.942011 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.86 seconds (8.86s).
[0m14:06:25.942937 [debug] [MainThread]: Command end result
[0m14:06:25.968844 [info ] [MainThread]: 
[0m14:06:25.969412 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:25.969870 [info ] [MainThread]: 
[0m14:06:25.970353 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:25.971302 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.938773, "process_user_time": 5.171893, "process_kernel_time": 0.28283, "process_mem_max_rss": "340012", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m14:06:25.971848 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:25.971745 after 10.94 seconds
[0m14:06:25.972312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae9729c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa72fba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae3eb88f0>]}
[0m14:06:25.972737 [debug] [MainThread]: Flushing usage events
[0m14:06:27.844342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf55d73710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf54ce5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf54ce5940>]}


============================== 14:06:27.847427 | b1e019a4-74e5-4a2f-b5e4-1a0b1b706967 ==============================
[0m14:06:27.847427 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:27.848084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:06:27.955500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1e019a4-74e5-4a2f-b5e4-1a0b1b706967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5696f1a0>]}
[0m14:06:27.973182 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1778624, "process_user_time": 1.334248, "process_kernel_time": 0.103863, "process_mem_max_rss": "100620", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:27.973713 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:27.973607 after 0.18 seconds
[0m14:06:27.974162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf54dbf230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf54c35ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5696f1a0>]}
[0m14:06:27.974576 [debug] [MainThread]: Flushing usage events
[0m22:06:41.864383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9116934140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91159ad550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911482c950>]}


============================== 22:06:41.880597 | f9e8a115-19f7-4035-a3dd-d6a6da52a807 ==============================
[0m22:06:41.880597 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:41.881291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:42.019269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9e8a115-19f7-4035-a3dd-d6a6da52a807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9114689580>]}
[0m22:06:42.035174 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zudouaca'
[0m22:06:42.035685 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:42.149665 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:42.150413 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:42.167207 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:42.171208 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:42.231128 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:42.231736 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:42.232277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f9e8a115-19f7-4035-a3dd-d6a6da52a807', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911481faa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91159fc2c0>]}
[0m22:06:42.232726 [info ] [MainThread]: 
[0m22:06:42.233204 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:42.241361 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42785776, "process_user_time": 1.614882, "process_kernel_time": 0.158693, "process_mem_max_rss": "101784", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m22:06:42.241924 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:42.241821 after 0.43 seconds
[0m22:06:42.242379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9115214140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91145363f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91145362a0>]}
[0m22:06:42.242809 [debug] [MainThread]: Flushing usage events
[0m22:06:43.958049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac3987c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac4234da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac3987560>]}


============================== 22:06:43.961340 | c62d9da2-e299-45a1-ac5a-737d4c27451d ==============================
[0m22:06:43.961340 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:43.962037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:44.166990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac3645040>]}
[0m22:06:44.229274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac426b920>]}
[0m22:06:44.232146 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:44.255567 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:44.256378 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:44.256909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac366bdd0>]}
[0m22:06:45.639019 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:45.639670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abf7dbf20>]}
[0m22:06:45.882244 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:45.888152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac3a06c30>]}
[0m22:06:45.993651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abf5ccb60>]}
[0m22:06:45.994219 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:45.994705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abf6326f0>]}
[0m22:06:45.996640 [info ] [MainThread]: 
[0m22:06:45.997390 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:46.002299 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:46.037174 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:46.037630 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:46.038044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:46.568602 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:46.570833 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:46.572056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:46.572763 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:46.580565 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:46.581004 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:46.581389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:46.582630 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:46.584032 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:46.584420 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:46.584969 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:46.585370 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:46.585733 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:46.586318 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:46.587244 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:46.587634 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:46.588019 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:46.588548 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:46.588941 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:46.590309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:46.596490 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:46.596893 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:46.597279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:46.597929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:46.598341 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:46.598714 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:46.608389 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:46.610002 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:46.611305 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:46.611703 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:46.614031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abdf604d0>]}
[0m22:06:46.614551 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:46.614930 [debug] [MainThread]: On master: BEGIN
[0m22:06:46.615315 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:46.615952 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:46.616369 [debug] [MainThread]: On master: COMMIT
[0m22:06:46.616734 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:46.617113 [debug] [MainThread]: On master: COMMIT
[0m22:06:46.617655 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:46.618084 [debug] [MainThread]: On master: Close
[0m22:06:46.618620 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:46.619099 [info ] [MainThread]: 
[0m22:06:46.637485 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:46.638211 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:46.638862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:46.639350 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:46.668640 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:46.669463 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:46.707516 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:46.708307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:54.268773 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.269324 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:54.270050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.270489 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.270902 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:54.271635 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.274742 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.275206 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:54.276003 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.293079 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.293612 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.294057 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.295377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.301375 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.301834 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:54.303128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.305567 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:54.307147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abf7d9b50>]}
[0m22:06:54.307831 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.67s]
[0m22:06:54.308600 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:54.309534 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:54.310217 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:54.310825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:54.311302 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:54.316438 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:54.317117 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:54.354863 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.355509 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250718220654348565"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:54.355971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:54.364176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.372442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.372932 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:54.373651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.374111 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.374532 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250718220654348565'
      
      
      order by ordinal_position

  
[0m22:06:54.376934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.382487 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.382958 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.385566 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.393698 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.394195 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.396740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.415271 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:54.416135 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.416613 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250718220654348565"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250718220654348565"
    )
  
[0m22:06:54.463412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.465491 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.466003 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.466450 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.474781 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.475843 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:54.477503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8535ac00>]}
[0m22:06:54.478239 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:06:54.478990 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:54.480432 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:54.480840 [debug] [MainThread]: On master: BEGIN
[0m22:06:54.481255 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:54.482023 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:54.482424 [debug] [MainThread]: On master: COMMIT
[0m22:06:54.482789 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:54.483187 [debug] [MainThread]: On master: COMMIT
[0m22:06:54.483763 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:54.484194 [debug] [MainThread]: On master: Close
[0m22:06:54.484817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:54.485232 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:54.485636 [info ] [MainThread]: 
[0m22:06:54.486148 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.49 seconds (8.49s).
[0m22:06:54.487148 [debug] [MainThread]: Command end result
[0m22:06:54.514703 [info ] [MainThread]: 
[0m22:06:54.515392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:54.515882 [info ] [MainThread]: 
[0m22:06:54.516415 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:54.517456 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.611486, "process_user_time": 5.381557, "process_kernel_time": 0.286722, "process_mem_max_rss": "351044", "process_in_blocks": "1200", "process_out_blocks": "100144"}
[0m22:06:54.518056 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:54.517905 after 10.61 seconds
[0m22:06:54.518529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac3ca07a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac3d7ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a853ea420>]}
[0m22:06:54.518966 [debug] [MainThread]: Flushing usage events
[0m22:06:56.729686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b9ff0740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b9de86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b9f89400>]}


============================== 22:06:56.732952 | 4633864b-b66a-4740-9c6f-9f6daaa0c374 ==============================
[0m22:06:56.732952 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:56.733638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:56.849346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4633864b-b66a-4740-9c6f-9f6daaa0c374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b99e99a0>]}
[0m22:06:56.867438 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19145991, "process_user_time": 1.403833, "process_kernel_time": 0.106911, "process_mem_max_rss": "100512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:56.868003 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:56.867879 after 0.19 seconds
[0m22:06:56.868442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bac386e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bb619f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bc51df10>]}
[0m22:06:56.868857 [debug] [MainThread]: Flushing usage events
[0m06:02:12.706145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb14e0bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb133eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb0e89a60>]}


============================== 06:02:12.726430 | 8824977b-ac70-485b-8d8f-d683f5f8f728 ==============================
[0m06:02:12.726430 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.727120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.876498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8824977b-ac70-485b-8d8f-d683f5f8f728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb15fa9f0>]}
[0m06:02:12.891367 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hvyot6gu'
[0m06:02:12.891824 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:13.003811 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:13.004532 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:13.017442 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:13.021355 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:13.156749 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:13.157353 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:13.157878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8824977b-ac70-485b-8d8f-d683f5f8f728', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb0a39730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb0745400>]}
[0m06:02:13.158356 [info ] [MainThread]: 
[0m06:02:13.158826 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:13.189082 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5324954, "process_user_time": 1.540427, "process_kernel_time": 0.142316, "process_mem_max_rss": "101700", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m06:02:13.189699 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:13.189592 after 0.53 seconds
[0m06:02:13.190160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb0b57230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb089a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb0899c10>]}
[0m06:02:13.190587 [debug] [MainThread]: Flushing usage events
[0m06:02:14.887731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40653006e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4062d26990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4062d254c0>]}


============================== 06:02:14.890815 | f8f22515-10ee-4c69-b3c6-48e190e32336 ==============================
[0m06:02:14.890815 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.891518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:15.091280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406225e900>]}
[0m06:02:15.149353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e30c2c0>]}
[0m06:02:15.151983 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:15.203129 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:15.203850 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:15.204393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4062f660f0>]}
[0m06:02:16.493092 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:16.493696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e2cba40>]}
[0m06:02:16.725820 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:16.731406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40628b0d40>]}
[0m06:02:16.836617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e082a50>]}
[0m06:02:16.837201 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:16.837688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e14cc50>]}
[0m06:02:16.839534 [info ] [MainThread]: 
[0m06:02:16.840251 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:16.844992 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:16.879904 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:16.880381 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:16.880776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:17.349102 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.350896 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:17.351998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:17.352571 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:17.360586 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.361070 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:17.361475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.362426 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.363814 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.364282 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:17.364869 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.365320 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.365726 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:17.366411 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.367383 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.367830 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.368279 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.368943 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.369365 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:17.370692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:17.376310 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.376787 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:17.377170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.377748 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.378150 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.378516 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:17.388448 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.389859 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:17.391106 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:17.391496 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:17.393700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e18d850>]}
[0m06:02:17.394211 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.394589 [debug] [MainThread]: On master: BEGIN
[0m06:02:17.394959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:17.395576 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.395995 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.396357 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.396706 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.397248 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.397628 [debug] [MainThread]: On master: Close
[0m06:02:17.398155 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:17.398609 [info ] [MainThread]: 
[0m06:02:17.437159 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:17.437811 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:17.438448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:17.438900 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:17.465631 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:17.466421 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:17.501609 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:17.502387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:25.617075 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.617585 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:25.618298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.618742 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.619197 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:25.619937 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.622818 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.623282 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:25.624011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.640478 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:25.640958 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.641375 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:25.643627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.649246 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.649694 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:25.652665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.655000 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:25.656507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4064172570>]}
[0m06:02:25.657192 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.22s]
[0m06:02:25.658024 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:25.659041 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:25.659589 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:25.660207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:25.660638 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:25.665431 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:25.666061 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:25.701393 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.701913 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250719060225695434"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:25.702370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:25.710265 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.717786 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.718261 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:25.718862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.719320 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.719737 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250719060225695434'
      
      
      order by ordinal_position

  
[0m06:02:25.721829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.726866 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.727355 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:25.729372 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.736919 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.737368 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:25.739672 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.757519 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:25.758203 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.758650 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250719060225695434"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250719060225695434"
    )
  
[0m06:02:25.804872 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.806840 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:25.807316 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.807716 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:25.818264 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.819263 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:25.820620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e0f3ad0>]}
[0m06:02:25.821309 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:25.822054 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:25.823614 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.824060 [debug] [MainThread]: On master: BEGIN
[0m06:02:25.824430 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:25.825102 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.825495 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.825858 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.826274 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.826777 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.827214 [debug] [MainThread]: On master: Close
[0m06:02:25.827834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:25.828232 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:25.828624 [info ] [MainThread]: 
[0m06:02:25.829149 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.99 seconds (8.99s).
[0m06:02:25.830166 [debug] [MainThread]: Command end result
[0m06:02:25.855646 [info ] [MainThread]: 
[0m06:02:25.856253 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:25.856759 [info ] [MainThread]: 
[0m06:02:25.857295 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:25.858258 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.019019, "process_user_time": 5.089155, "process_kernel_time": 0.286459, "process_mem_max_rss": "334628", "process_in_blocks": "1200", "process_out_blocks": "100120"}
[0m06:02:25.858791 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:25.858691 after 11.02 seconds
[0m06:02:25.859247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40637f1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4024f762d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406286e420>]}
[0m06:02:25.859663 [debug] [MainThread]: Flushing usage events
[0m06:02:27.614610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe74457ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe734f8ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7543d2e0>]}


============================== 06:02:27.617633 | 4658c28d-14d7-42c8-a855-5a0ee76b5054 ==============================
[0m06:02:27.617633 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:27.618283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.724263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4658c28d-14d7-42c8-a855-5a0ee76b5054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe736edd00>]}
[0m06:02:27.743152 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1769502, "process_user_time": 1.321576, "process_kernel_time": 0.113877, "process_mem_max_rss": "100920", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:27.743663 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:27.743563 after 0.18 seconds
[0m06:02:27.744113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe73454980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe77502c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe736edd00>]}
[0m06:02:27.744514 [debug] [MainThread]: Flushing usage events
[0m14:05:10.264568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3c5ad280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3bed05c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3bed3980>]}


============================== 14:05:10.316700 | 90b7fe62-e867-49e0-bd10-c004fbe7f67b ==============================
[0m14:05:10.316700 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:10.317347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:10.456173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90b7fe62-e867-49e0-bd10-c004fbe7f67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3b2d32f0>]}
[0m14:05:10.471463 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-h041nggy'
[0m14:05:10.471934 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:10.630922 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:10.631653 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:10.654826 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:10.658618 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:10.780536 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:10.781128 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:10.781662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '90b7fe62-e867-49e0-bd10-c004fbe7f67b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3b465820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3b464890>]}
[0m14:05:10.782146 [info ] [MainThread]: 
[0m14:05:10.782630 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:10.795261 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5797381, "process_user_time": 1.589572, "process_kernel_time": 0.134709, "process_mem_max_rss": "101500", "process_in_blocks": "8744", "process_out_blocks": "5168"}
[0m14:05:10.795818 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:10.795714 after 0.58 seconds
[0m14:05:10.796267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3c5ad280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3b5be6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3bac5a00>]}
[0m14:05:10.796676 [debug] [MainThread]: Flushing usage events
[0m14:05:12.350692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51d65e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51e4c0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51da33a70>]}


============================== 14:05:12.353815 | 4665dab8-8b02-4f51-91a9-20828500dbe3 ==============================
[0m14:05:12.353815 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:12.354483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:12.559350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51cecb140>]}
[0m14:05:12.618937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51d03e9c0>]}
[0m14:05:12.621624 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:05:12.712652 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:12.713452 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:12.713974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd518f9cad0>]}
[0m14:05:14.001291 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:14.001906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd518b07740>]}
[0m14:05:14.236604 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:14.242284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd518a6b050>]}
[0m14:05:14.342738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd518a6ee70>]}
[0m14:05:14.343341 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:05:14.343858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51dc39640>]}
[0m14:05:14.345759 [info ] [MainThread]: 
[0m14:05:14.346504 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:14.351297 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:14.386253 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:14.386731 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:14.387142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:14.888484 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:14.890439 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:14.891645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:14.892349 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:14.900461 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.900896 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:14.901297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:14.902363 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.903730 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.904141 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:14.904682 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.905088 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.905472 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:14.906048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.906988 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:14.907398 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.907764 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:14.908377 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.908773 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:14.910179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:14.916191 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:14.916592 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:14.916953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:14.917641 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.918022 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:14.918428 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:14.928109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.929562 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:14.930820 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:14.931261 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:14.933707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd518a97950>]}
[0m14:05:14.934231 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:14.934612 [debug] [MainThread]: On master: BEGIN
[0m14:05:14.934969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:14.935616 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:14.936009 [debug] [MainThread]: On master: COMMIT
[0m14:05:14.936415 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:14.936772 [debug] [MainThread]: On master: COMMIT
[0m14:05:14.937318 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:14.937705 [debug] [MainThread]: On master: Close
[0m14:05:14.938249 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:14.938706 [info ] [MainThread]: 
[0m14:05:14.971701 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:14.972363 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:14.972957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:14.973420 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:15.000636 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:15.001423 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:15.036959 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:15.037763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:26.649026 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.649548 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:26.650204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.650650 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.651089 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:26.651836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.654750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.655230 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:26.655941 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.672665 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:26.673146 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.673572 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:26.675415 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.681112 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.681565 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:05:26.682767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.685170 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:26.686691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51ed76150>]}
[0m14:05:26.687383 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.71s]
[0m14:05:26.688158 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:26.689130 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:26.689705 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:26.690307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:26.690739 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:26.695674 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:26.696347 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:26.732758 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.733304 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250719140526726675"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:26.733761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:26.741671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.749455 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.749908 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:26.750551 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.750983 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.751430 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250719140526726675'
      
      
      order by ordinal_position

  
[0m14:05:26.754295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.759494 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.759948 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:26.762401 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.770068 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.770532 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:26.773224 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.791367 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:26.792084 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.792546 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250719140526726675"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250719140526726675"
    )
  
[0m14:05:26.841935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.843950 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:26.844415 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.844825 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:26.851505 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.852422 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:26.853825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4dabe3ef0>]}
[0m14:05:26.854510 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:05:26.855318 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:26.856594 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.856998 [debug] [MainThread]: On master: BEGIN
[0m14:05:26.857409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:26.858039 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.858464 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.858831 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.859235 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.859755 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.860174 [debug] [MainThread]: On master: Close
[0m14:05:26.860775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:26.861159 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:26.861557 [info ] [MainThread]: 
[0m14:05:26.862035 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.52 seconds (12.52s).
[0m14:05:26.863048 [debug] [MainThread]: Command end result
[0m14:05:26.889242 [info ] [MainThread]: 
[0m14:05:26.889864 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:26.890396 [info ] [MainThread]: 
[0m14:05:26.890917 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:26.891932 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.590472, "process_user_time": 5.157003, "process_kernel_time": 0.294885, "process_mem_max_rss": "332040", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m14:05:26.892521 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:26.892415 after 14.59 seconds
[0m14:05:26.892963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51d14d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4db546e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51dd99580>]}
[0m14:05:26.893426 [debug] [MainThread]: Flushing usage events
[0m14:05:28.643404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde116c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde2408dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde2ef1370>]}


============================== 14:05:28.646571 | 1828eeed-bcf6-4bf5-a87b-dfa59a804b66 ==============================
[0m14:05:28.646571 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:28.647231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:28.757158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1828eeed-bcf6-4bf5-a87b-dfa59a804b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde0dc81a0>]}
[0m14:05:28.775079 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18121606, "process_user_time": 1.361948, "process_kernel_time": 0.096066, "process_mem_max_rss": "100716", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:28.775615 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:28.775513 after 0.18 seconds
[0m14:05:28.776038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde06eed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde03e49e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde14ddbb0>]}
[0m14:05:28.776480 [debug] [MainThread]: Flushing usage events
