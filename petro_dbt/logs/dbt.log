[0m22:06:04.797210 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:04.798255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b990b678-e881-4827-9de1-fe6d6245efaa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1697b82270>]}
[0m22:06:04.998859 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:05.005577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b990b678-e881-4827-9de1-fe6d6245efaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16939ffe30>]}
[0m22:06:05.169119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b990b678-e881-4827-9de1-fe6d6245efaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1693823200>]}
[0m22:06:05.169758 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:06:05.170273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b990b678-e881-4827-9de1-fe6d6245efaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1693851070>]}
[0m22:06:05.172239 [info ] [MainThread]: 
[0m22:06:05.173046 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:05.178490 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:05.218183 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:05.218788 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:05.219207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:05.688569 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.690714 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:05.691916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:05.692536 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:05.700417 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:05.700964 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:05.701384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:05.702796 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.704509 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:05.704927 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:05.705575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.705977 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:05.706391 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:05.707030 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.708042 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:05.708478 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:05.708871 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:05.709497 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.709933 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:05.711414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:05.717903 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:05.718434 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:05.718819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:05.719701 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.720110 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:05.720524 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:05.735024 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.736874 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:05.738202 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:05.738653 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:05.741100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b990b678-e881-4827-9de1-fe6d6245efaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16938adf70>]}
[0m22:06:05.741703 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:05.742106 [debug] [MainThread]: On master: BEGIN
[0m22:06:05.742520 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:05.743359 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:05.743778 [debug] [MainThread]: On master: COMMIT
[0m22:06:05.744166 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:05.744563 [debug] [MainThread]: On master: COMMIT
[0m22:06:05.745203 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:05.745661 [debug] [MainThread]: On master: Close
[0m22:06:05.746283 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:05.746800 [info ] [MainThread]: 
[0m22:06:05.759242 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:05.759971 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:05.760643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:05.761090 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:05.790308 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:05.791328 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:05.831592 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:05.832619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:15.763548 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:15.764156 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:15.765024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.765501 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:15.765932 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:15.766959 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.770497 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:15.770962 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:15.771791 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.791558 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:15.792207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:15.792765 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:15.794773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.800805 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:15.801376 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:15.803096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.806024 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:15.807994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b990b678-e881-4827-9de1-fe6d6245efaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168bf458b0>]}
[0m22:06:15.808845 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.05s]
[0m22:06:15.809805 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:15.810971 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:15.811646 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:15.812415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:15.812901 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:15.820131 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:15.820907 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:15.859735 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.860410 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250305220615852953"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:15.860943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:15.869983 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.878936 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.879585 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:15.880492 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.880975 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.881452 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250305220615852953'
      
      
      order by ordinal_position

  
[0m22:06:15.886759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.892995 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.893563 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:15.896541 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.906384 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.906983 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:15.910056 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.931262 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:15.932186 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.932738 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250305220615852953"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250305220615852953"
    )
  
[0m22:06:15.981324 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.983413 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:15.983906 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.984354 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:15.992964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.994251 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:15.996129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b990b678-e881-4827-9de1-fe6d6245efaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16683cf9b0>]}
[0m22:06:15.996908 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m22:06:15.997748 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:15.999248 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:15.999725 [debug] [MainThread]: On master: BEGIN
[0m22:06:16.000118 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:16.001012 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:16.001481 [debug] [MainThread]: On master: COMMIT
[0m22:06:16.001872 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:16.002254 [debug] [MainThread]: On master: COMMIT
[0m22:06:16.002896 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:16.003377 [debug] [MainThread]: On master: Close
[0m22:06:16.004251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:16.004664 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:16.005104 [info ] [MainThread]: 
[0m22:06:16.005651 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.83 seconds (10.83s).
[0m22:06:16.006633 [debug] [MainThread]: Command end result
[0m22:06:16.034707 [info ] [MainThread]: 
[0m22:06:16.035468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:16.035952 [info ] [MainThread]: 
[0m22:06:16.036464 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:16.037515 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.999849, "process_user_time": 5.582571, "process_kernel_time": 0.315484, "process_mem_max_rss": "301120", "process_in_blocks": "3816", "process_out_blocks": "95536"}
[0m22:06:16.038058 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:16.037954 after 13.00 seconds
[0m22:06:16.038555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169383ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1697a09220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1693822c00>]}
[0m22:06:16.039009 [debug] [MainThread]: Flushing usage events
[0m22:06:18.273125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70dabd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70cf0e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70cc3e9f0>]}


============================== 22:06:18.276307 | ce50ca55-d1ac-453c-b98a-a661a4d4b964 ==============================
[0m22:06:18.276307 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:18.276993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:18.443389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce50ca55-d1ac-453c-b98a-a661a4d4b964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70ccd7a40>]}
[0m22:06:18.461107 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23889945, "process_user_time": 1.416967, "process_kernel_time": 0.115997, "process_mem_max_rss": "92628", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:18.461697 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:18.461589 after 0.24 seconds
[0m22:06:18.462160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70cd759d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70ccd7a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70cf8b590>]}
[0m22:06:18.462651 [debug] [MainThread]: Flushing usage events
[0m06:02:14.477639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b75adeb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b754f0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b753c5b50>]}


============================== 06:02:14.490433 | ed58e1c3-70f9-460d-8499-9dfbfc584fda ==============================
[0m06:02:14.490433 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.491153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.634097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed58e1c3-70f9-460d-8499-9dfbfc584fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7610d1f0>]}
[0m06:02:14.647599 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r00z_156'
[0m06:02:14.648084 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:14.695745 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:14.696425 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:14.705608 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:14.709558 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:14.754325 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:14.754828 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:14.755385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ed58e1c3-70f9-460d-8499-9dfbfc584fda', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b750ade50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7560da30>]}
[0m06:02:14.755837 [info ] [MainThread]: 
[0m06:02:14.756350 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:14.763167 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.33450562, "process_user_time": 1.508166, "process_kernel_time": 0.128014, "process_mem_max_rss": "94480", "process_in_blocks": "5760", "process_out_blocks": "4008"}
[0m06:02:14.763690 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:14.763590 after 0.34 seconds
[0m06:02:14.764179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7529b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7610d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b753c5b20>]}
[0m06:02:14.764612 [debug] [MainThread]: Flushing usage events
[0m06:02:16.289899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7d0a1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7d8df440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7d8de780>]}


============================== 06:02:16.293004 | 5147eab5-0a1c-4525-8927-695e1f77ccf1 ==============================
[0m06:02:16.293004 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:16.293661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:16.533399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7e6840e0>]}
[0m06:02:16.593115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7d69af00>]}
[0m06:02:16.595771 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:16.702243 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:16.703051 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:16.703582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7cd81d60>]}
[0m06:02:17.995566 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:17.996250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe78c58da0>]}
[0m06:02:18.181547 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:18.187067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe78de02f0>]}
[0m06:02:18.323630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe78c06ab0>]}
[0m06:02:18.324208 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:18.324721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe78c0ed80>]}
[0m06:02:18.326516 [info ] [MainThread]: 
[0m06:02:18.327256 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:18.332133 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:18.367161 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:18.367621 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:18.368047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:18.866720 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.868331 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:18.869375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:18.869937 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:18.877223 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.877655 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:18.878071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:18.879021 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.880530 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.880941 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:18.881628 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.882050 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.882428 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:18.883048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.883989 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:18.884392 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.884768 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:18.885334 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.885738 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:18.886982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:18.892758 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:18.893189 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:18.893569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:18.894229 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.894637 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:18.895056 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:18.908656 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.910144 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:18.911357 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:18.911767 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:18.913933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7ce1e870>]}
[0m06:02:18.914481 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.914870 [debug] [MainThread]: On master: BEGIN
[0m06:02:18.915278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:18.915897 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.916341 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.916722 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.917127 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.917660 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.918096 [debug] [MainThread]: On master: Close
[0m06:02:18.918627 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:18.919133 [info ] [MainThread]: 
[0m06:02:18.939349 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:18.939976 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:18.940624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:18.941091 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:18.967813 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:18.968575 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:19.004168 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:19.004974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:09.104118 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:09.104636 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:09.105345 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.105791 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:09.106265 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:09.106995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.109886 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:09.110369 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:09.111053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.127653 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:09.128146 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:09.128588 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:09.130012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.135097 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:09.135562 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:09.137069 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.139428 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:09.140986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe5816bb60>]}
[0m06:07:09.141677 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 290.20s]
[0m06:07:09.142473 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:09.143322 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:09.143900 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:09.144552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:09.145036 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:09.150838 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:09.151684 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:09.186939 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:09.187493 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250306060709180663"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:09.187976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:09.196102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.203813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:09.204295 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:09.205002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.205453 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:09.205883 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250306060709180663'
      
      
      order by ordinal_position

  
[0m06:07:09.210799 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.215917 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:09.216408 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:09.218870 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.226409 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:09.226882 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:09.229300 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.247414 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:09.248167 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:09.248644 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250306060709180663"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250306060709180663"
    )
  
[0m06:07:09.298207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.300233 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:09.300692 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:09.301142 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:09.309140 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.310054 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:09.311496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe58053590>]}
[0m06:07:09.312191 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:07:09.313039 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:09.314348 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:09.314767 [debug] [MainThread]: On master: BEGIN
[0m06:07:09.315196 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:09.315871 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:09.316320 [debug] [MainThread]: On master: COMMIT
[0m06:07:09.316702 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:09.317108 [debug] [MainThread]: On master: COMMIT
[0m06:07:09.317655 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:09.318084 [debug] [MainThread]: On master: Close
[0m06:07:09.318715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:09.319136 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:09.319541 [info ] [MainThread]: 
[0m06:07:09.320088 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 50.99 seconds (290.99s).
[0m06:07:09.321122 [debug] [MainThread]: Command end result
[0m06:07:09.346493 [info ] [MainThread]: 
[0m06:07:09.347165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:09.347697 [info ] [MainThread]: 
[0m06:07:09.348254 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:09.349284 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 293.1094, "process_user_time": 4.759081, "process_kernel_time": 0.281708, "process_mem_max_rss": "283256", "process_in_blocks": "3816", "process_out_blocks": "95528"}
[0m06:07:09.349814 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:09.349714 after 293.11 seconds
[0m06:07:09.350322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7ce1fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe6ffe9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7d4d5310>]}
[0m06:07:09.350773 [debug] [MainThread]: Flushing usage events
[0m06:07:11.182058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda61eae6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda61aa3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda61aa3140>]}


============================== 06:07:11.185067 | 5f3a9981-b9e9-40c9-aeb1-6c174645f1df ==============================
[0m06:07:11.185067 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:11.185749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:07:11.331758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f3a9981-b9e9-40c9-aeb1-6c174645f1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda6305bb90>]}
[0m06:07:11.350047 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21775787, "process_user_time": 1.332776, "process_kernel_time": 0.103982, "process_mem_max_rss": "92704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:07:11.350576 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:11.350477 after 0.22 seconds
[0m06:07:11.351043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda61eaecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda655d7bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda6305bb90>]}
[0m06:07:11.351490 [debug] [MainThread]: Flushing usage events
[0m14:05:26.635785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd331f6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd331f7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd331f6540>]}


============================== 14:05:26.647516 | 18bdf2b5-3c22-4069-b896-37858792d9db ==============================
[0m14:05:26.647516 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:26.648156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:26.792988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18bdf2b5-3c22-4069-b896-37858792d9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd32813fb0>]}
[0m14:05:26.806875 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jo3jk3b4'
[0m14:05:26.807379 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:26.867188 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:26.868037 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:26.892299 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:26.896455 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:26.973561 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:26.974233 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:26.974864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '18bdf2b5-3c22-4069-b896-37858792d9db', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd326eda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3263e6c0>]}
[0m14:05:26.975373 [info ] [MainThread]: 
[0m14:05:26.975865 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:26.981629 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.39509267, "process_user_time": 1.491036, "process_kernel_time": 0.13345, "process_mem_max_rss": "94252", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m14:05:26.982163 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:26.982061 after 0.40 seconds
[0m14:05:26.982633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd331f6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd32d3e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd32d3d370>]}
[0m14:05:26.983071 [debug] [MainThread]: Flushing usage events
[0m14:05:28.559080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14025b7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f140252fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1403011730>]}


============================== 14:05:28.562877 | 8275f0a8-7a84-4ecd-abff-e1cbed44d355 ==============================
[0m14:05:28.562877 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:28.563679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:28.851087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fe5b8e60>]}
[0m14:05:28.915761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1403207770>]}
[0m14:05:28.918519 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:29.111211 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:29.112098 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:29.112689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fe5e8560>]}
[0m14:05:30.453924 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:30.454577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fe1387a0>]}
[0m14:05:30.652590 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:30.659816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fe5eb1a0>]}
[0m14:05:30.848401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fe115100>]}
[0m14:05:30.848999 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:30.849510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fe139670>]}
[0m14:05:30.851337 [info ] [MainThread]: 
[0m14:05:30.852148 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:30.858372 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:30.895924 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:30.896467 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:30.896881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:31.426581 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:31.428399 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:31.429434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:31.430035 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:31.437710 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:31.438151 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:31.438571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:31.439805 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.441388 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:31.441814 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:31.442446 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.442856 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:31.443236 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:31.443866 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.444839 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:31.445249 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:31.445653 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:31.446182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.446626 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:31.447958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:31.454073 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:31.454514 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:31.454890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:31.455563 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.455969 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:31.456391 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:31.470350 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.471902 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:31.473178 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:31.473634 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:31.475884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fe1cdb80>]}
[0m14:05:31.476434 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:31.476825 [debug] [MainThread]: On master: BEGIN
[0m14:05:31.477187 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:31.477823 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:31.478230 [debug] [MainThread]: On master: COMMIT
[0m14:05:31.478642 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:31.479012 [debug] [MainThread]: On master: COMMIT
[0m14:05:31.479561 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:31.479964 [debug] [MainThread]: On master: Close
[0m14:05:31.480514 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:31.480987 [info ] [MainThread]: 
[0m14:05:31.511448 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:31.512076 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:31.512687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:31.513135 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:31.540191 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:31.541091 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:31.577297 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:31.578098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:23.397729 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:23.398371 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:23.399332 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.399812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:23.400270 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:23.401250 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.404889 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:23.405391 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:23.406345 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.423964 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:23.424611 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:23.425056 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:23.426871 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.432748 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:23.433244 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:23.435081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.437761 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:23.439450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fcb9cc20>]}
[0m14:10:23.440213 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 291.93s]
[0m14:10:23.441051 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:23.441951 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:23.442737 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:23.443458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:23.443971 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:23.450803 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:23.451647 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:23.489331 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:23.489957 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250306141023482950"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:23.490467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:23.499443 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.508369 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:23.508938 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:23.509819 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.510282 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:23.510723 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250306141023482950'
      
      
      order by ordinal_position

  
[0m14:10:23.515815 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.521961 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:23.522492 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:23.525509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.534296 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:23.534875 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:23.538472 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.558005 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:23.559022 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:23.559557 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250306141023482950"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250306141023482950"
    )
  
[0m14:10:23.614215 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.616372 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:23.616836 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:23.617269 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:23.624989 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.626050 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:23.627827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e0011160>]}
[0m14:10:23.628538 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m14:10:23.629323 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:23.630730 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:23.631170 [debug] [MainThread]: On master: BEGIN
[0m14:10:23.631607 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:23.632454 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:23.632870 [debug] [MainThread]: On master: COMMIT
[0m14:10:23.633279 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:23.633678 [debug] [MainThread]: On master: COMMIT
[0m14:10:23.634223 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:23.634683 [debug] [MainThread]: On master: Close
[0m14:10:23.635392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:23.635781 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:23.636214 [info ] [MainThread]: 
[0m14:10:23.636776 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 52.78 seconds (292.78s).
[0m14:10:23.637825 [debug] [MainThread]: Command end result
[0m14:10:23.665789 [info ] [MainThread]: 
[0m14:10:23.666541 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:23.667083 [info ] [MainThread]: 
[0m14:10:23.667679 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:23.668805 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 295.16995, "process_user_time": 5.445172, "process_kernel_time": 0.31347, "process_mem_max_rss": "302808", "process_in_blocks": "3816", "process_out_blocks": "95528"}
[0m14:10:23.669391 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:23.669245 after 295.17 seconds
[0m14:10:23.669868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f140323d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1403baa2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ea9be060>]}
[0m14:10:23.670346 [debug] [MainThread]: Flushing usage events
[0m14:10:25.669350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d7dd4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d6c29730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d707a630>]}


============================== 14:10:25.672686 | 3dbcacdb-25d9-4dec-8bc9-56d942d6b9d6 ==============================
[0m14:10:25.672686 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:25.673371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:25.836124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3dbcacdb-25d9-4dec-8bc9-56d942d6b9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d6a7bb00>]}
[0m14:10:25.854430 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23671605, "process_user_time": 1.403238, "process_kernel_time": 0.112019, "process_mem_max_rss": "92816", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:10:25.854972 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:25.854872 after 0.24 seconds
[0m14:10:25.855435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d6ce0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d6fbc620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d6a7bb00>]}
[0m14:10:25.855879 [debug] [MainThread]: Flushing usage events
[0m22:05:54.705428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61c01f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61b7c3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61c01fdd0>]}


============================== 22:05:54.713411 | 47b5885a-72c2-4ba9-8427-2a46fde47168 ==============================
[0m22:05:54.713411 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:54.714092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:54.857190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47b5885a-72c2-4ba9-8427-2a46fde47168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61b5783e0>]}
[0m22:05:54.870541 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3zq48n60'
[0m22:05:54.871031 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:54.903458 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:54.904117 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:54.914253 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:54.918201 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:55.147894 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:55.148469 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:55.149048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '47b5885a-72c2-4ba9-8427-2a46fde47168', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61bc0e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61bb11ac0>]}
[0m22:05:55.149518 [info ] [MainThread]: 
[0m22:05:55.150034 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:55.152085 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49578744, "process_user_time": 1.505654, "process_kernel_time": 0.104697, "process_mem_max_rss": "94252", "process_in_blocks": "5760", "process_out_blocks": "4024"}
[0m22:05:55.152648 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:55.152513 after 0.50 seconds
[0m22:05:55.153092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61b8a56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61f3bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61b8e1a60>]}
[0m22:05:55.153523 [debug] [MainThread]: Flushing usage events
[0m22:05:56.937431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbaa0f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbaa0d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbc7626f0>]}


============================== 22:05:56.940379 | 5ae1878b-6da1-474a-b13f-14e5ad2091c2 ==============================
[0m22:05:56.940379 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:56.941084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:57.172759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db9e25670>]}
[0m22:05:57.231917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db9f53ad0>]}
[0m22:05:57.234414 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:57.271212 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:57.271939 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:57.272469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db5e4ff80>]}
[0m22:05:58.550723 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:58.551406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db5b83d10>]}
[0m22:05:58.736035 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:58.741486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db5d57fe0>]}
[0m22:05:58.866977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db5cfc7a0>]}
[0m22:05:58.867520 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:58.868054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db5b3c860>]}
[0m22:05:58.869812 [info ] [MainThread]: 
[0m22:05:58.870530 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:58.875359 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:58.910552 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:58.911029 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:58.911427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:59.860931 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:59.862786 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:59.864019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:59.864747 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:59.872098 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.872525 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:59.872941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:59.873866 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.875283 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.875713 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:59.876311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.876727 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.877118 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:59.877728 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.878661 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:59.879066 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.879442 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:59.880019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.880429 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:59.881667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:59.887339 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:59.887786 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:59.888158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:59.888780 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.889179 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:59.889584 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:59.902925 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.904379 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:59.905606 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:59.906015 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:59.908275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db5b05580>]}
[0m22:05:59.908803 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:59.909192 [debug] [MainThread]: On master: BEGIN
[0m22:05:59.909561 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:59.910181 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:59.910591 [debug] [MainThread]: On master: COMMIT
[0m22:05:59.910976 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:59.911339 [debug] [MainThread]: On master: COMMIT
[0m22:05:59.911898 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:59.912292 [debug] [MainThread]: On master: Close
[0m22:05:59.912845 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:59.913330 [info ] [MainThread]: 
[0m22:05:59.924320 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:59.924936 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:59.925592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:59.926041 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:59.952178 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:59.952930 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:59.988259 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:59.989006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:53.083062 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:53.083592 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:17:53.084240 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.084701 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:53.085129 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:17:53.085837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.088703 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:53.089152 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:17:53.089894 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.106216 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:17:53.106706 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:53.107138 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:17:53.108643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.113585 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:53.114054 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:17:53.115321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.117639 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:17:53.119137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d89f76f00>]}
[0m22:17:53.119834 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 713.19s]
[0m22:17:53.120612 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:17:53.121549 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:17:53.122138 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:17:53.122808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:17:53.123250 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:17:53.129005 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:17:53.129685 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:17:53.164426 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:53.164940 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250306221753158446"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:17:53.165402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:53.173303 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.180715 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:53.181176 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:17:53.181809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.182248 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:53.182705 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250306221753158446'
      
      
      order by ordinal_position

  
[0m22:17:53.187329 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.192349 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:53.192834 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:17:53.195316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.202776 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:53.203244 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:17:53.205762 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.223775 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:17:53.224445 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:53.224944 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250306221753158446"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250306221753158446"
    )
  
[0m22:17:53.273128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.275123 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:17:53.275595 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:53.276027 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:17:53.283699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.284589 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:17:53.286300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d89fdd460>]}
[0m22:17:53.286996 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:17:53.287749 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:17:53.289120 [debug] [MainThread]: Using duckdb connection "master"
[0m22:17:53.289532 [debug] [MainThread]: On master: BEGIN
[0m22:17:53.289948 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:17:53.290618 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:17:53.291027 [debug] [MainThread]: On master: COMMIT
[0m22:17:53.291402 [debug] [MainThread]: Using duckdb connection "master"
[0m22:17:53.291824 [debug] [MainThread]: On master: COMMIT
[0m22:17:53.292352 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:17:53.292787 [debug] [MainThread]: On master: Close
[0m22:17:53.293404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:53.293831 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:17:53.294237 [info ] [MainThread]: 
[0m22:17:53.294749 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 11 minutes and 54.42 seconds (714.42s).
[0m22:17:53.295729 [debug] [MainThread]: Command end result
[0m22:17:53.321157 [info ] [MainThread]: 
[0m22:17:53.321764 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:17:53.322257 [info ] [MainThread]: 
[0m22:17:53.322780 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:17:53.323789 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 716.43567, "process_user_time": 4.68402, "process_kernel_time": 0.264944, "process_mem_max_rss": "285332", "process_in_blocks": "3816", "process_out_blocks": "95552"}
[0m22:17:53.324302 [debug] [MainThread]: Command `dbt run` succeeded at 22:17:53.324203 after 716.44 seconds
[0m22:17:53.324759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db9fb56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbb60ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db5cff740>]}
[0m22:17:53.325197 [debug] [MainThread]: Flushing usage events
[0m22:17:55.323325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eb3772180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eb55d1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eb3536240>]}


============================== 22:17:55.326322 | e3650275-cbbb-44c6-acf4-a98b4ab8ca4a ==============================
[0m22:17:55.326322 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:17:55.327005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:17:55.469331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3650275-cbbb-44c6-acf4-a98b4ab8ca4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eb32e1f70>]}
[0m22:17:55.487400 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2136196, "process_user_time": 1.333641, "process_kernel_time": 0.101972, "process_mem_max_rss": "92816", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:17:55.487932 [debug] [MainThread]: Command `dbt clean` succeeded at 22:17:55.487834 after 0.21 seconds
[0m22:17:55.488375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eb3bb3e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eb3fe7bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eb2e3ab10>]}
[0m22:17:55.488822 [debug] [MainThread]: Flushing usage events
[0m06:02:06.802650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb150e4bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb151a11c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb150e8bf50>]}


============================== 06:02:06.810415 | 635b83f3-95e7-4e73-89be-6fb7ee991bab ==============================
[0m06:02:06.810415 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:06.811103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:06.957627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '635b83f3-95e7-4e73-89be-6fb7ee991bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb152e26d20>]}
[0m06:02:06.971721 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-951yiqsf'
[0m06:02:06.972210 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:07.176206 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:07.176844 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:07.207446 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:07.211396 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:07.598018 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:07.598534 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:07.599066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '635b83f3-95e7-4e73-89be-6fb7ee991bab', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1507db6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb150812150>]}
[0m06:02:07.599526 [info ] [MainThread]: 
[0m06:02:07.600025 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:07.606001 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8552159, "process_user_time": 1.48846, "process_kernel_time": 0.12487, "process_mem_max_rss": "94488", "process_in_blocks": "5760", "process_out_blocks": "4024"}
[0m06:02:07.606523 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:07.606422 after 0.86 seconds
[0m06:02:07.606948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb150c01ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb150899070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1508986b0>]}
[0m06:02:07.607393 [debug] [MainThread]: Flushing usage events
[0m06:02:09.383168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ce0f41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d04ddeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ce8c2990>]}


============================== 06:02:09.386226 | de22f904-47c6-4252-aeba-f0f77a1242ec ==============================
[0m06:02:09.386226 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.386906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:09.622545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6cdec44d0>]}
[0m06:02:09.684694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ce143950>]}
[0m06:02:09.687209 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:09.711515 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:09.712249 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:09.712781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6cdd23e90>]}
[0m06:02:11.085466 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:11.086112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c9e3afc0>]}
[0m06:02:11.277807 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:11.283312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6cdd56ae0>]}
[0m06:02:11.412431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ce143950>]}
[0m06:02:11.413034 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:11.413562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6cdfd79b0>]}
[0m06:02:11.415360 [info ] [MainThread]: 
[0m06:02:11.416099 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:11.421156 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:11.457492 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:11.457993 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:11.458433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:12.380536 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:12.382167 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:12.383203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:12.383751 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:12.391253 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.391700 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:12.392130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.393040 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.394447 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.394851 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:12.395465 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.395860 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.396274 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:12.396846 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.397776 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.398198 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.398580 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.399139 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.399548 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:12.400730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:12.406646 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.407096 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:12.407487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.408146 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.408566 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.408992 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:12.423128 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.424565 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:12.425751 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:12.426176 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:12.428495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6cdfd79b0>]}
[0m06:02:12.429049 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.429467 [debug] [MainThread]: On master: BEGIN
[0m06:02:12.429855 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:12.430495 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.430924 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.431372 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.431773 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.432357 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.432783 [debug] [MainThread]: On master: Close
[0m06:02:12.433358 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:12.433846 [info ] [MainThread]: 
[0m06:02:12.455794 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:12.456422 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:12.457079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:12.457524 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:12.485133 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:12.485888 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:12.523064 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:12.523813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:05.380824 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:05.381337 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:05.381950 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.382423 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:05.382850 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:05.383555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.386391 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:05.386839 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:05.387513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.404295 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:05.404785 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:05.405254 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:05.406410 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.411552 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:05.412093 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:05.413359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.415666 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:05.417178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c876e450>]}
[0m06:07:05.417859 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 292.96s]
[0m06:07:05.418650 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:05.419607 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:05.420185 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:05.420787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:05.421284 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:05.427067 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:05.427722 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:05.464353 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.464870 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250307060705458013"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:05.465380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:05.473210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.480890 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.481384 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:05.482009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.482477 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.482924 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250307060705458013'
      
      
      order by ordinal_position

  
[0m06:07:05.487301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.492273 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.492740 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:05.495066 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.502484 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.502982 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:05.506248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.525104 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:05.525794 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.526296 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250307060705458013"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250307060705458013"
    )
  
[0m06:07:05.575426 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.577499 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:05.577996 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.578458 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:05.586602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.587573 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:05.589070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6af5cb380>]}
[0m06:07:05.589775 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:07:05.590563 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:05.591852 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:05.592314 [debug] [MainThread]: On master: BEGIN
[0m06:07:05.592708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:05.593385 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:05.593799 [debug] [MainThread]: On master: COMMIT
[0m06:07:05.594222 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:05.594605 [debug] [MainThread]: On master: COMMIT
[0m06:07:05.595170 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:05.595577 [debug] [MainThread]: On master: Close
[0m06:07:05.596237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:05.596639 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:05.597085 [info ] [MainThread]: 
[0m06:07:05.597588 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 54.18 seconds (294.18s).
[0m06:07:05.598562 [debug] [MainThread]: Command end result
[0m06:07:05.623986 [info ] [MainThread]: 
[0m06:07:05.624602 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:05.625126 [info ] [MainThread]: 
[0m06:07:05.625634 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:05.626630 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 296.2952, "process_user_time": 4.839207, "process_kernel_time": 0.259493, "process_mem_max_rss": "287496", "process_in_blocks": "3816", "process_out_blocks": "95528"}
[0m06:07:05.627186 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:05.627082 after 296.30 seconds
[0m06:07:05.627632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d04ddeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6a0188b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ce0f4350>]}
[0m06:07:05.628101 [debug] [MainThread]: Flushing usage events
[0m06:07:07.649412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe384eee2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe383cf3200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe383be3290>]}


============================== 06:07:07.652294 | 06ace2c9-bb2f-4547-9af2-537bef8cb1ac ==============================
[0m06:07:07.652294 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:07.652945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:07:07.795021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06ace2c9-bb2f-4547-9af2-537bef8cb1ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe383682de0>]}
[0m06:07:07.813252 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21529639, "process_user_time": 1.332462, "process_kernel_time": 0.110955, "process_mem_max_rss": "92708", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:07:07.813766 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:07.813664 after 0.22 seconds
[0m06:07:07.814237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe383928170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe383977170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3836b7bc0>]}
[0m06:07:07.814674 [debug] [MainThread]: Flushing usage events
[0m14:05:07.863429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df326e630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df3378770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df32b8320>]}


============================== 14:05:07.871889 | e97ff69c-64a4-48a9-a2a6-06e6c2283ea2 ==============================
[0m14:05:07.871889 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:07.872562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:08.022368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e97ff69c-64a4-48a9-a2a6-06e6c2283ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df3070530>]}
[0m14:05:08.036048 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7qbb11vx'
[0m14:05:08.036529 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:08.162281 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:08.163076 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:08.217422 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:08.221580 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:08.353548 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:08.354187 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:08.354734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e97ff69c-64a4-48a9-a2a6-06e6c2283ea2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df3b448c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df3011040>]}
[0m14:05:08.355234 [info ] [MainThread]: 
[0m14:05:08.355712 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:08.371725 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.55808336, "process_user_time": 1.514059, "process_kernel_time": 0.133828, "process_mem_max_rss": "94144", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m14:05:08.372358 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:08.372254 after 0.56 seconds
[0m14:05:08.372870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df40ad4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df38ad130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df38ae120>]}
[0m14:05:08.373325 [debug] [MainThread]: Flushing usage events
[0m14:05:09.934907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3366a738c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33674ce900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33674cda00>]}


============================== 14:05:09.937969 | 4ff086ea-93dd-4365-ae41-fa567b93d906 ==============================
[0m14:05:09.937969 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:09.938659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:10.185963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3366935d00>]}
[0m14:05:10.245854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3367a48680>]}
[0m14:05:10.248537 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:10.518806 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:10.519573 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:10.520137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f336672a810>]}
[0m14:05:11.913213 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:11.913862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33626257c0>]}
[0m14:05:12.122232 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:12.128084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f336267a600>]}
[0m14:05:12.390310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33627def60>]}
[0m14:05:12.390923 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:12.391455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33669347a0>]}
[0m14:05:12.393262 [info ] [MainThread]: 
[0m14:05:12.394018 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:12.398939 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:12.434917 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:12.435401 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:12.435820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:12.962853 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:12.964593 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:12.965595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:12.966244 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:12.973814 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.974247 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:12.974639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:12.975564 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.977018 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.977421 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:12.977996 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.978392 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.978766 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:12.979362 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.980296 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:12.980709 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.981114 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:12.981656 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.982095 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:12.983317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:12.989032 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:12.989448 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:12.989840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:12.990458 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.990890 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:12.991288 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:13.004941 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:13.006446 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:13.007678 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:13.008120 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:13.010412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3362624230>]}
[0m14:05:13.010941 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:13.011328 [debug] [MainThread]: On master: BEGIN
[0m14:05:13.011693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:13.012351 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:13.012749 [debug] [MainThread]: On master: COMMIT
[0m14:05:13.013150 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:13.013515 [debug] [MainThread]: On master: COMMIT
[0m14:05:13.014063 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:13.014453 [debug] [MainThread]: On master: Close
[0m14:05:13.014992 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:13.015499 [info ] [MainThread]: 
[0m14:05:13.041870 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:13.042506 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:13.043200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:13.043651 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:13.070770 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:13.071603 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:13.107744 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:13.108640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:11.517437 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:11.518001 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:11.518811 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.519279 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:11.519715 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:11.520511 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.523640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:11.524111 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:11.524853 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.541589 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:11.542130 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:11.542563 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:11.544157 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.549403 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:11.549881 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:11.551158 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.553556 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:11.555099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3361173200>]}
[0m14:10:11.555780 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 298.51s]
[0m14:10:11.556550 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:11.557573 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:11.558154 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:11.558743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:11.559206 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:11.565196 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:11.565887 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:11.601481 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:11.602093 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250307141011595310"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:11.602561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:11.611623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.619953 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:11.620498 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:11.621280 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.621740 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:11.622198 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250307141011595310'
      
      
      order by ordinal_position

  
[0m14:10:11.627025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.632504 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:11.633003 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:11.635599 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.643538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:11.644042 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:11.646510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.664778 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:11.665582 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:11.666101 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250307141011595310"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250307141011595310"
    )
  
[0m14:10:11.715545 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.717574 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:11.718056 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:11.718478 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:11.727481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.728554 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:11.730527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33627559a0>]}
[0m14:10:11.731241 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:10:11.732071 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:11.733441 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:11.733897 [debug] [MainThread]: On master: BEGIN
[0m14:10:11.734296 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:11.735049 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:11.735457 [debug] [MainThread]: On master: COMMIT
[0m14:10:11.735871 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:11.736252 [debug] [MainThread]: On master: COMMIT
[0m14:10:11.736808 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:11.737219 [debug] [MainThread]: On master: Close
[0m14:10:11.737859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:11.738242 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:11.738646 [info ] [MainThread]: 
[0m14:10:11.739149 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 59.34 seconds (299.34s).
[0m14:10:11.740062 [debug] [MainThread]: Command end result
[0m14:10:11.766422 [info ] [MainThread]: 
[0m14:10:11.767101 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:11.767563 [info ] [MainThread]: 
[0m14:10:11.768047 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:11.769037 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 301.88406, "process_user_time": 5.427041, "process_kernel_time": 0.280622, "process_mem_max_rss": "307284", "process_in_blocks": "3816", "process_out_blocks": "95520"}
[0m14:10:11.769567 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:11.769465 after 301.88 seconds
[0m14:10:11.770041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3344382240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33440af0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33627b2e70>]}
[0m14:10:11.770488 [debug] [MainThread]: Flushing usage events
[0m14:10:14.244873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89832b7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89832b5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89832b7860>]}


============================== 14:10:14.248114 | ed183672-e469-436b-944e-4e38d06da5ab ==============================
[0m14:10:14.248114 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:14.248807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:10:14.401776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed183672-e469-436b-944e-4e38d06da5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8983057ce0>]}
[0m14:10:14.421003 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22653587, "process_user_time": 1.365372, "process_kernel_time": 0.118945, "process_mem_max_rss": "92716", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:14.421554 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:14.421449 after 0.23 seconds
[0m14:10:14.422030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89871bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8983326ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89830b1e20>]}
[0m14:10:14.422490 [debug] [MainThread]: Flushing usage events
[0m22:05:20.474579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e4cc1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e4e07c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e4cc8320>]}


============================== 22:05:20.482664 | 1c6e1450-3184-4774-97e4-e2d4425d5aab ==============================
[0m22:05:20.482664 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:20.483370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:05:20.629950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c6e1450-3184-4774-97e4-e2d4425d5aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e55254c0>]}
[0m22:05:20.643734 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-f2rps4il'
[0m22:05:20.644225 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:20.756477 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:20.757294 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:20.789794 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:20.793819 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:21.153734 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:21.154314 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:21.154903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1c6e1450-3184-4774-97e4-e2d4425d5aab', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e49c31d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e49c1940>]}
[0m22:05:21.155363 [info ] [MainThread]: 
[0m22:05:21.155871 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:21.158839 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.73375016, "process_user_time": 1.504548, "process_kernel_time": 0.126297, "process_mem_max_rss": "94272", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m22:05:21.159366 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:21.159264 after 0.73 seconds
[0m22:05:21.159826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e49fbef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e4d8d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e49ecbf0>]}
[0m22:05:21.160252 [debug] [MainThread]: Flushing usage events
[0m22:05:22.945395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f718661e9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7185c6d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7186dd08f0>]}


============================== 22:05:22.948474 | 0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5 ==============================
[0m22:05:22.948474 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:22.949188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:23.182936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7185b2ebd0>]}
[0m22:05:23.241927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7185aa5160>]}
[0m22:05:23.244549 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:23.266666 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:23.267376 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:23.267928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71859c11f0>]}
[0m22:05:24.559376 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:24.560066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71818808c0>]}
[0m22:05:24.745551 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:24.751222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7181b62600>]}
[0m22:05:24.882899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71818178f0>]}
[0m22:05:24.883468 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:24.883999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f718199ef00>]}
[0m22:05:24.885812 [info ] [MainThread]: 
[0m22:05:24.886571 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:24.891650 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:24.927961 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:24.928472 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:24.928898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:25.557539 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:25.559267 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:25.560350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:25.560972 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:25.569003 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:25.569507 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:25.569964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:25.571151 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:25.572861 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:25.573295 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:25.573942 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:25.574378 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:25.574850 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:25.575544 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:25.576603 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:25.577028 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:25.577433 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:25.578116 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:25.578688 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:25.580241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:25.586365 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:25.586799 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:25.587175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:25.587821 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:25.588221 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:25.588633 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:25.602404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:25.603962 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:25.605206 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:25.605636 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:25.608091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7185fdaed0>]}
[0m22:05:25.608642 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:25.609043 [debug] [MainThread]: On master: BEGIN
[0m22:05:25.609416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:25.610090 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:25.610514 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.610904 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:25.611273 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.611842 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:25.612243 [debug] [MainThread]: On master: Close
[0m22:05:25.612837 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:25.613327 [info ] [MainThread]: 
[0m22:05:25.629561 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:25.630182 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:25.630795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:25.631240 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:25.658598 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:25.659468 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:25.695762 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:25.696644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:20.801033 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:20.801573 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:20.802257 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.802735 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:20.803171 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:20.803898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.806738 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:20.807191 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:20.807875 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.824345 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:20.824836 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:20.825274 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:20.826669 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.831622 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:20.832086 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:20.833520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.835844 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:20.837357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7187247020>]}
[0m22:10:20.838058 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 295.21s]
[0m22:10:20.838909 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:20.839762 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:20.840430 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:20.841135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:20.841614 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:20.847558 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:20.848235 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:20.883753 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:20.884339 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250307221020877578"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:20.884830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:20.893873 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.901959 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:20.902462 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:20.903199 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.903664 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:20.904095 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250307221020877578'
      
      
      order by ordinal_position

  
[0m22:10:20.908857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.914407 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:20.914907 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:20.917427 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.925306 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:20.925846 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:20.928613 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.947024 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:20.947843 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:20.948321 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250307221020877578"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250307221020877578"
    )
  
[0m22:10:20.997785 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.999773 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:21.000231 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:21.000684 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:21.009080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:21.010043 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:21.011665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715c3c72c0>]}
[0m22:10:21.012344 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:21.013100 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:21.014647 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:21.015068 [debug] [MainThread]: On master: BEGIN
[0m22:10:21.015451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:21.016203 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:21.016644 [debug] [MainThread]: On master: COMMIT
[0m22:10:21.017088 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:21.017475 [debug] [MainThread]: On master: COMMIT
[0m22:10:21.018114 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:21.018550 [debug] [MainThread]: On master: Close
[0m22:10:21.019156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:21.019560 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:21.019971 [info ] [MainThread]: 
[0m22:10:21.020463 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 56.13 seconds (296.13s).
[0m22:10:21.021425 [debug] [MainThread]: Command end result
[0m22:10:21.047423 [info ] [MainThread]: 
[0m22:10:21.048105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:21.048621 [info ] [MainThread]: 
[0m22:10:21.049121 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:21.050140 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 298.15405, "process_user_time": 5.305818, "process_kernel_time": 0.324111, "process_mem_max_rss": "305792", "process_in_blocks": "3816", "process_out_blocks": "95544"}
[0m22:10:21.050705 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:21.050597 after 298.15 seconds
[0m22:10:21.051165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7189bbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71818cf9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f716dabda00>]}
[0m22:10:21.051631 [debug] [MainThread]: Flushing usage events
[0m22:10:23.271902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3a987770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3ac2c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3a913230>]}


============================== 22:10:23.274999 | 0a84a8de-e594-4486-8a6f-a4cd531d201d ==============================
[0m22:10:23.274999 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:23.275660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:10:23.425227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a84a8de-e594-4486-8a6f-a4cd531d201d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3cae96a0>]}
[0m22:10:23.443434 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22124603, "process_user_time": 1.351509, "process_kernel_time": 0.106882, "process_mem_max_rss": "92972", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:10:23.443981 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:23.443881 after 0.22 seconds
[0m22:10:23.444414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3ac8e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3cae96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3a7de600>]}
[0m22:10:23.444881 [debug] [MainThread]: Flushing usage events
[0m06:02:02.045711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddf12a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddf27b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de135e450>]}


============================== 06:02:02.061334 | 0792ce28-d713-47d5-8c0f-e0fa7707bade ==============================
[0m06:02:02.061334 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:02.061996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:02.200259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0792ce28-d713-47d5-8c0f-e0fa7707bade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddecdeed0>]}
[0m06:02:02.213481 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-l8gupxip'
[0m06:02:02.213932 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:02.280254 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:02.280875 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:02.293381 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:02.297407 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:02.438773 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:02.439295 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:02.439841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0792ce28-d713-47d5-8c0f-e0fa7707bade', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddeec5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddfe5c200>]}
[0m06:02:02.440398 [info ] [MainThread]: 
[0m06:02:02.441152 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:02.442908 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44636616, "process_user_time": 1.536309, "process_kernel_time": 0.1332, "process_mem_max_rss": "93992", "process_in_blocks": "5760", "process_out_blocks": "4024"}
[0m06:02:02.443450 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:02.443350 after 0.45 seconds
[0m06:02:02.443869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddec84710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddef90fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de04262d0>]}
[0m06:02:02.444315 [debug] [MainThread]: Flushing usage events
[0m06:02:04.029812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63bbda5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63b3b7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63b3b5160>]}


============================== 06:02:04.032683 | fb31c210-5298-46d0-949c-d1b9e55a2d8a ==============================
[0m06:02:04.032683 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:04.033384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:04.265827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63b16d250>]}
[0m06:02:04.324797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63735d310>]}
[0m06:02:04.327159 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:04.365736 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:04.366438 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:04.366958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd637332cc0>]}
[0m06:02:05.652773 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:05.653427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd636f93230>]}
[0m06:02:05.843851 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:05.849119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63709f9b0>]}
[0m06:02:05.986374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63ef96d80>]}
[0m06:02:05.986917 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:05.987476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63b789280>]}
[0m06:02:05.989203 [info ] [MainThread]: 
[0m06:02:05.989913 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:05.994618 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:06.030557 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:06.031020 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:06.031477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:06.572454 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:06.573979 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:06.574934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:06.575517 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:06.582737 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.583189 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:06.583576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:06.584549 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.586007 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.586440 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:06.586994 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.587410 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.587781 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:06.588371 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.589295 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:06.589694 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.590090 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:06.590642 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.591069 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:06.592299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:06.598060 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:06.598477 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:06.598848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:06.599489 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.599881 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:06.600303 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:06.614720 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.616167 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:06.617365 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:06.617765 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:06.620098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63bc091f0>]}
[0m06:02:06.620600 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.620989 [debug] [MainThread]: On master: BEGIN
[0m06:02:06.621406 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:06.621993 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.622430 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.622811 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.623206 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.623740 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.624185 [debug] [MainThread]: On master: Close
[0m06:02:06.624707 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:06.625216 [info ] [MainThread]: 
[0m06:02:06.647117 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:06.647690 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:06.648328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:06.648771 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:06.675110 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:06.675837 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:06.711304 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:06.712019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:59.381005 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.381511 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:06:59.382144 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.382589 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.383016 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:06:59.383716 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.386510 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.386955 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:06:59.387630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.403991 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:06:59.404475 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.404903 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:06:59.406105 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.410989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.411465 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:06:59.412655 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.414922 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:06:59.416415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6359a00e0>]}
[0m06:06:59.417099 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 292.77s]
[0m06:06:59.417845 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:06:59.418657 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:06:59.419241 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:06:59.420059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:06:59.420515 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:06:59.426009 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:06:59.426649 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:06:59.461125 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.461620 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250308060659455196"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:06:59.462111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:59.469748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.476954 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.477424 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:06:59.478024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.478494 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.478916 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250308060659455196'
      
      
      order by ordinal_position

  
[0m06:06:59.483203 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.488115 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.488580 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:06:59.490911 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.498369 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.498834 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:06:59.501023 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.518795 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:06:59.519444 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.519907 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250308060659455196"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250308060659455196"
    )
  
[0m06:06:59.567754 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.569728 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:06:59.570223 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.570656 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:06:59.578822 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.579717 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:06:59.581396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd624922cc0>]}
[0m06:06:59.582086 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:06:59.582888 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:06:59.584220 [debug] [MainThread]: Using duckdb connection "master"
[0m06:06:59.584647 [debug] [MainThread]: On master: BEGIN
[0m06:06:59.585031 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:06:59.585699 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:06:59.586142 [debug] [MainThread]: On master: COMMIT
[0m06:06:59.586531 [debug] [MainThread]: Using duckdb connection "master"
[0m06:06:59.586904 [debug] [MainThread]: On master: COMMIT
[0m06:06:59.587483 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:06:59.587880 [debug] [MainThread]: On master: Close
[0m06:06:59.588485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:06:59.588860 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:06:59.589289 [info ] [MainThread]: 
[0m06:06:59.589759 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 53.60 seconds (293.60s).
[0m06:06:59.590688 [debug] [MainThread]: Command end result
[0m06:06:59.616489 [info ] [MainThread]: 
[0m06:06:59.617057 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:06:59.617528 [info ] [MainThread]: 
[0m06:06:59.618002 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:06:59.618934 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 295.64246, "process_user_time": 4.68442, "process_kernel_time": 0.233469, "process_mem_max_rss": "290844", "process_in_blocks": "3816", "process_out_blocks": "95536"}
[0m06:06:59.619482 [debug] [MainThread]: Command `dbt run` succeeded at 06:06:59.619382 after 295.64 seconds
[0m06:06:59.619913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd610045b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63b37ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63ebb4590>]}
[0m06:06:59.620370 [debug] [MainThread]: Flushing usage events
[0m06:07:01.420092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874b7b9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874bae1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874c0955e0>]}


============================== 06:07:01.423017 | 738408cb-60ce-47d1-bbc1-4dade8afcd58 ==============================
[0m06:07:01.423017 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:01.423749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:07:01.570670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '738408cb-60ce-47d1-bbc1-4dade8afcd58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874c1503e0>]}
[0m06:07:01.588740 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2209975, "process_user_time": 1.372704, "process_kernel_time": 0.086981, "process_mem_max_rss": "92836", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:07:01.589288 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:01.589182 after 0.22 seconds
[0m06:07:01.589718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874bae1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874bbcb5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874bbca630>]}
[0m06:07:01.590168 [debug] [MainThread]: Flushing usage events
[0m14:04:38.553529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc137b5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc13739640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc137b7140>]}


============================== 14:04:38.561143 | aafb068c-969c-42c3-828f-73e85c553b1c ==============================
[0m14:04:38.561143 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:38.561852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:38.705932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aafb068c-969c-42c3-828f-73e85c553b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc13c7a480>]}
[0m14:04:38.719293 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-c4d0duva'
[0m14:04:38.719769 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:38.832919 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:38.833602 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:38.844418 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:38.848431 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:39.057896 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:39.058518 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:39.059105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'aafb068c-969c-42c3-828f-73e85c553b1c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc13794b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc14329c70>]}
[0m14:04:39.059609 [info ] [MainThread]: 
[0m14:04:39.060144 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:39.071129 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5665494, "process_user_time": 1.533139, "process_kernel_time": 0.126838, "process_mem_max_rss": "94176", "process_in_blocks": "5728", "process_out_blocks": "4008"}
[0m14:04:39.071683 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:39.071581 after 0.57 seconds
[0m14:04:39.072121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc13739640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc13794e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc13794b60>]}
[0m14:04:39.072567 [debug] [MainThread]: Flushing usage events
[0m14:04:40.791325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c15977830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c159777d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c159779e0>]}


============================== 14:04:40.794364 | 5abb2805-8464-4f61-affb-a439083e249c ==============================
[0m14:04:40.794364 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:40.795021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:41.026324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c16950650>]}
[0m14:04:41.085605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c16638620>]}
[0m14:04:41.088189 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:04:41.114366 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:41.115101 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:41.115670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c15977950>]}
[0m14:04:42.405893 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:42.406530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c15d52a50>]}
[0m14:04:42.590189 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:42.595622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c115a5b20>]}
[0m14:04:42.719319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c11581310>]}
[0m14:04:42.719868 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:04:42.720402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c1154ade0>]}
[0m14:04:42.722136 [info ] [MainThread]: 
[0m14:04:42.722871 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:42.727705 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:42.762813 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:42.763288 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:42.763690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:43.331482 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:43.333416 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:43.334371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:43.334923 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:43.342074 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:43.342519 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:43.342902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:43.343987 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:43.345408 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:43.345810 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:43.346368 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:43.346764 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:43.347137 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:43.347733 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:43.348657 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:43.349055 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:43.349449 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:43.349979 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:43.350405 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:43.351585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:43.357269 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:43.357685 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:43.358059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:43.358720 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:43.359126 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:43.359554 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:43.372837 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:43.374286 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:43.375492 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:43.375896 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:43.378137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c11527c50>]}
[0m14:04:43.378650 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:43.379038 [debug] [MainThread]: On master: BEGIN
[0m14:04:43.379430 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:43.380020 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:43.380438 [debug] [MainThread]: On master: COMMIT
[0m14:04:43.380820 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:43.381182 [debug] [MainThread]: On master: COMMIT
[0m14:04:43.381717 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:43.382105 [debug] [MainThread]: On master: Close
[0m14:04:43.382643 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:43.383118 [info ] [MainThread]: 
[0m14:04:43.398701 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:43.399335 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:43.399909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:04:43.400379 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:43.427004 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:43.427769 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:43.463531 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:43.464288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:38.528564 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:38.529055 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:09:38.529694 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.530137 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:38.530591 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:09:38.531319 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.534139 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:38.534605 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:09:38.535289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.551710 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:38.552190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:38.552643 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:38.553850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.558745 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:38.559202 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:09:38.560513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.562794 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:09:38.564292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bec1137d0>]}
[0m14:09:38.564974 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 295.16s]
[0m14:09:38.565757 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:09:38.566670 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:09:38.567218 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:09:38.567804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:09:38.568257 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:09:38.573799 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:09:38.574449 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:09:38.609268 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:38.609771 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250308140938603163"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:09:38.610230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:38.617921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.625271 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:38.625731 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:09:38.626335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.626775 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:38.627202 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250308140938603163'
      
      
      order by ordinal_position

  
[0m14:09:38.631666 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.636670 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:38.637148 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:38.640235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.647644 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:38.648106 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:38.651145 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.668953 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:09:38.669628 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:38.670089 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250308140938603163"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250308140938603163"
    )
  
[0m14:09:38.722708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.724654 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:38.725102 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:38.725549 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:38.734595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.735492 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:09:38.737161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bedfb3380>]}
[0m14:09:38.737868 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:09:38.738635 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:09:38.739910 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:38.740357 [debug] [MainThread]: On master: BEGIN
[0m14:09:38.740743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:38.741358 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:38.741761 [debug] [MainThread]: On master: COMMIT
[0m14:09:38.742142 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:38.742558 [debug] [MainThread]: On master: COMMIT
[0m14:09:38.743100 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:38.743567 [debug] [MainThread]: On master: Close
[0m14:09:38.744171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:38.744581 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:09:38.744983 [info ] [MainThread]: 
[0m14:09:38.745478 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 56.02 seconds (296.02s).
[0m14:09:38.746405 [debug] [MainThread]: Command end result
[0m14:09:38.771515 [info ] [MainThread]: 
[0m14:09:38.772065 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:09:38.772541 [info ] [MainThread]: 
[0m14:09:38.773009 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:09:38.773910 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 298.0325, "process_user_time": 4.696336, "process_kernel_time": 0.251876, "process_mem_max_rss": "286260", "process_in_blocks": "3816", "process_out_blocks": "95528"}
[0m14:09:38.774464 [debug] [MainThread]: Command `dbt run` succeeded at 14:09:38.774358 after 298.03 seconds
[0m14:09:38.774897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c158efcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c159779e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c17d11100>]}
[0m14:09:38.775356 [debug] [MainThread]: Flushing usage events
[0m14:09:40.763017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36f1ec6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ef9bb860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ef9bb8f0>]}


============================== 14:09:40.765945 | 24005778-db28-44fd-89ac-73e04cf9b1cb ==============================
[0m14:09:40.765945 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:09:40.766611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:09:40.908329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24005778-db28-44fd-89ac-73e04cf9b1cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ef84e600>]}
[0m14:09:40.926117 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21269411, "process_user_time": 1.31064, "process_kernel_time": 0.111969, "process_mem_max_rss": "92756", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:09:40.926651 [debug] [MainThread]: Command `dbt clean` succeeded at 14:09:40.926551 after 0.21 seconds
[0m14:09:40.927084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ef7e0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ef7e1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ef7e00e0>]}
[0m14:09:40.927529 [debug] [MainThread]: Flushing usage events
