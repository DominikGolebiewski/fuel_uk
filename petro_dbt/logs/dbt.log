[0m14:06:54.474287 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250715140654467815"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:54.474881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:54.482667 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.490110 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.490561 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:54.491169 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.491605 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.492058 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250715140654467815'
      
      
      order by ordinal_position

  
[0m14:06:54.494179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.499235 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.499683 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:54.501772 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.509308 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.509759 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:54.512134 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.530292 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:54.530949 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.531419 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250715140654467815"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250715140654467815"
    )
  
[0m14:06:54.579481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.581534 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:54.582021 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.582441 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:54.590003 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.590903 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:54.592487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09308d6d-edf1-4466-9431-a161911700cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e3732750>]}
[0m14:06:54.593182 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:06:54.593905 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:54.595517 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:54.595917 [debug] [MainThread]: On master: BEGIN
[0m14:06:54.596322 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:54.596956 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:54.597386 [debug] [MainThread]: On master: COMMIT
[0m14:06:54.597756 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:54.598158 [debug] [MainThread]: On master: COMMIT
[0m14:06:54.598668 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:54.599086 [debug] [MainThread]: On master: Close
[0m14:06:54.599708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:54.600097 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:54.600492 [info ] [MainThread]: 
[0m14:06:54.600953 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.52 seconds (8.52s).
[0m14:06:54.601884 [debug] [MainThread]: Command end result
[0m14:06:54.627801 [info ] [MainThread]: 
[0m14:06:54.628362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:54.628806 [info ] [MainThread]: 
[0m14:06:54.629278 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:54.630216 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.538381, "process_user_time": 4.943477, "process_kernel_time": 0.274693, "process_mem_max_rss": "339808", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m14:06:54.630746 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:54.630646 after 10.54 seconds
[0m14:06:54.631199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9255cf1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9273674d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9259f23f0>]}
[0m14:06:54.631617 [debug] [MainThread]: Flushing usage events
[0m14:06:56.430822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6768e135c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6769b84f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67670bdee0>]}


============================== 14:06:56.433947 | d676c5db-9b13-438b-99e5-6cbbd5564aef ==============================
[0m14:06:56.433947 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:56.434659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:56.542057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd676c5db-9b13-438b-99e5-6cbbd5564aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6766e4b2f0>]}
[0m14:06:56.559685 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17781195, "process_user_time": 1.342943, "process_kernel_time": 0.097922, "process_mem_max_rss": "100468", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:06:56.560259 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:56.560155 after 0.18 seconds
[0m14:06:56.560668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f676738af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f676703f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6766fde660>]}
[0m14:06:56.561099 [debug] [MainThread]: Flushing usage events
[0m22:06:37.212915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53bacdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53bacf980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53bacfd70>]}


============================== 22:06:37.228375 | aabb3fd5-bfb4-489e-8aa5-efc015182123 ==============================
[0m22:06:37.228375 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:37.229046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:37.362884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aabb3fd5-bfb4-489e-8aa5-efc015182123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53baec560>]}
[0m22:06:37.378224 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yj9vlmh4'
[0m22:06:37.378705 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:37.465005 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:37.465726 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:37.506004 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:37.509847 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:37.878680 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:37.879264 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:37.879792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'aabb3fd5-bfb4-489e-8aa5-efc015182123', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53b198980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53b1982c0>]}
[0m22:06:37.880251 [info ] [MainThread]: 
[0m22:06:37.880734 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:37.890962 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.72705317, "process_user_time": 1.53077, "process_kernel_time": 0.147073, "process_mem_max_rss": "101828", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m22:06:37.891525 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:37.891422 after 0.73 seconds
[0m22:06:37.891942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53b4377a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53b56cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53d7eb1a0>]}
[0m22:06:37.892375 [debug] [MainThread]: Flushing usage events
[0m22:06:39.668735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd92b512e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9080b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8ffcf950>]}


============================== 22:06:39.671802 | 07f61831-7c10-488c-aa9a-cde013106d34 ==============================
[0m22:06:39.671802 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:39.672440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:39.872747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8fe4ef90>]}
[0m22:06:39.931763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd91cdccb0>]}
[0m22:06:39.934306 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:39.958071 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:39.958785 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:39.959321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8fcb1c70>]}
[0m22:06:41.257700 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:41.258343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bddb350>]}
[0m22:06:41.489356 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:41.494798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bb78980>]}
[0m22:06:41.591409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bb19df0>]}
[0m22:06:41.591925 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:41.592464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bbdaa20>]}
[0m22:06:41.594279 [info ] [MainThread]: 
[0m22:06:41.594998 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:41.599646 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:41.633853 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:41.634300 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:41.634682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:42.118118 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.119955 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:42.121170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:42.121788 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:42.130250 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.130778 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:42.131309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.132436 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.134095 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.134645 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:42.135367 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.135779 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.136232 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:42.136884 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.137949 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.138387 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.138785 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.139363 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.139789 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:42.141166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:42.147512 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.148033 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:42.148480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.149180 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.149642 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.150062 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:42.161782 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.163266 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:42.164494 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:42.164891 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:42.167228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bbd6810>]}
[0m22:06:42.167738 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.168118 [debug] [MainThread]: On master: BEGIN
[0m22:06:42.168500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:42.169097 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.169524 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.169887 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.170259 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.170775 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.171193 [debug] [MainThread]: On master: Close
[0m22:06:42.171723 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:42.172235 [info ] [MainThread]: 
[0m22:06:42.191027 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:42.191623 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:42.192266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:42.192703 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:42.219858 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:42.220731 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:42.256835 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:42.257715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:54.131366 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.131853 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:54.132518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.132949 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.133387 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:54.134061 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.136969 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.137423 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:54.138080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.154671 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.155124 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.155565 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.157016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.162600 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.163055 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:54.165002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.167376 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:54.168886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8a725e20>]}
[0m22:06:54.169571 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.98s]
[0m22:06:54.170390 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:54.171241 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:54.171793 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:54.172577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:54.173012 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:54.177899 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:54.178541 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:54.214469 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.214953 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250715220654208490"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:54.215423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:54.223242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.230804 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.231350 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:54.232014 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.232552 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.232968 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250715220654208490'
      
      
      order by ordinal_position

  
[0m22:06:54.236007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.241188 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.241644 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.243783 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.251419 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.251872 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.254599 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.272778 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:54.273476 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.273936 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250715220654208490"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250715220654208490"
    )
  
[0m22:06:54.324834 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.326820 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.327295 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.327701 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.337283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.338165 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:54.339699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd51cff9e0>]}
[0m22:06:54.340384 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:06:54.341102 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:54.342474 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:54.342894 [debug] [MainThread]: On master: BEGIN
[0m22:06:54.343308 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:54.343940 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:54.344375 [debug] [MainThread]: On master: COMMIT
[0m22:06:54.344836 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:54.345226 [debug] [MainThread]: On master: COMMIT
[0m22:06:54.345741 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:54.346129 [debug] [MainThread]: On master: Close
[0m22:06:54.346829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:54.347233 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:54.347630 [info ] [MainThread]: 
[0m22:06:54.348156 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.75 seconds (12.75s).
[0m22:06:54.349167 [debug] [MainThread]: Command end result
[0m22:06:54.374556 [info ] [MainThread]: 
[0m22:06:54.375162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:54.375674 [info ] [MainThread]: 
[0m22:06:54.376203 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:54.377187 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.757243, "process_user_time": 5.138785, "process_kernel_time": 0.273935, "process_mem_max_rss": "338488", "process_in_blocks": "1200", "process_out_blocks": "100152"}
[0m22:06:54.377716 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:54.377615 after 14.76 seconds
[0m22:06:54.378175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd90be5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd900cc860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bb193d0>]}
[0m22:06:54.378597 [debug] [MainThread]: Flushing usage events
[0m22:06:56.323267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abf787680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abf07efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abf07ccb0>]}


============================== 22:06:56.326368 | 95fa7ffe-f6a5-4e22-86a0-17caea396030 ==============================
[0m22:06:56.326368 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:56.326999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:56.434372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95fa7ffe-f6a5-4e22-86a0-17caea396030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac0353440>]}
[0m22:06:56.451700 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1783122, "process_user_time": 1.325029, "process_kernel_time": 0.103923, "process_mem_max_rss": "100612", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:56.452240 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:56.452119 after 0.18 seconds
[0m22:06:56.452683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abebec500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abe9575f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abe905f70>]}
[0m22:06:56.453089 [debug] [MainThread]: Flushing usage events
[0m06:02:22.133185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef604d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef5ace3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef5acd9d0>]}


============================== 06:02:22.148970 | fe0263f7-afe7-4523-98b3-40ac2073f6c9 ==============================
[0m06:02:22.148970 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:22.149595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:22.282135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe0263f7-afe7-4523-98b3-40ac2073f6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef57e3c80>]}
[0m06:02:22.296398 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-c_151u01'
[0m06:02:22.296846 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:22.461089 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:22.461670 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:22.484325 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:22.488101 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:22.556772 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:22.557253 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:22.557780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fe0263f7-afe7-4523-98b3-40ac2073f6c9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef4ec3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef4ec36b0>]}
[0m06:02:22.558198 [info ] [MainThread]: 
[0m06:02:22.558651 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:22.566816 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4823665, "process_user_time": 1.539886, "process_kernel_time": 0.136078, "process_mem_max_rss": "101216", "process_in_blocks": "8744", "process_out_blocks": "5168"}
[0m06:02:22.567342 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:22.567241 after 0.48 seconds
[0m06:02:22.567766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef529c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef529f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef5185c40>]}
[0m06:02:22.568186 [debug] [MainThread]: Flushing usage events
[0m06:02:24.167576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e255910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e7eb770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e254680>]}


============================== 06:02:24.170612 | 8b2c16f7-faaf-4259-ba0e-97c5c525244b ==============================
[0m06:02:24.170612 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.171275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.370525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22a11a1b0>]}
[0m06:02:24.428430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22ffd8c80>]}
[0m06:02:24.430961 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:24.454388 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:24.455099 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:24.455606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22a119c70>]}
[0m06:02:25.753023 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:25.753550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22ffd8a70>]}
[0m06:02:25.970929 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:25.976275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e27d940>]}
[0m06:02:26.079676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe229e57cb0>]}
[0m06:02:26.080189 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:26.080703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe229ef1ee0>]}
[0m06:02:26.082479 [info ] [MainThread]: 
[0m06:02:26.083143 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:26.087686 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:26.121488 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:26.121930 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:26.122313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:26.611513 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.613913 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:26.615271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:26.616105 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:26.624951 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.625370 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:26.625768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:26.626708 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.628031 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.628419 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:26.628959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.629341 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.629703 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:26.630307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.631237 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:26.631624 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.632007 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:26.632556 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.632992 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:26.634193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:26.639837 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:26.640323 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:26.640690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:26.641303 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.641688 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:26.642084 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:26.651535 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.652979 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:26.654206 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:26.654607 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:26.656873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe229f683e0>]}
[0m06:02:26.657371 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.657775 [debug] [MainThread]: On master: BEGIN
[0m06:02:26.658134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:26.658717 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.659140 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.659504 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.659881 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.660451 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.660864 [debug] [MainThread]: On master: Close
[0m06:02:26.661364 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:26.661847 [info ] [MainThread]: 
[0m06:02:26.686022 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:26.686590 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:26.687183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:26.687608 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:26.713873 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:26.714599 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:26.749326 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:26.750048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:34.254565 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.255070 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:34.255741 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.256173 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.256589 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:34.257321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.260166 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.260601 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:34.261270 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.277667 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:34.278153 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.278572 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:34.279633 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.285167 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.285618 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:34.286763 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.289051 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:34.290530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2289c1e50>]}
[0m06:02:34.291216 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.60s]
[0m06:02:34.291982 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:34.292821 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:34.293377 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:34.294146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:34.294586 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:34.299405 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:34.300038 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:34.335622 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.336129 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250716060234329630"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:34.336577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:34.344074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.351394 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.351876 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:34.352467 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.352923 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.353336 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250716060234329630'
      
      
      order by ordinal_position

  
[0m06:02:34.355413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.360423 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.360896 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:34.362954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.370381 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.370850 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:34.373179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.391000 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:34.391637 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.392109 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250716060234329630"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250716060234329630"
    )
  
[0m06:02:34.441268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.443258 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:34.443704 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.444142 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:34.450907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.451814 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:34.453272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1f0fe3aa0>]}
[0m06:02:34.453958 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:34.454691 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:34.455986 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:34.456394 [debug] [MainThread]: On master: BEGIN
[0m06:02:34.456786 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:34.457409 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:34.457832 [debug] [MainThread]: On master: COMMIT
[0m06:02:34.458205 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:34.458565 [debug] [MainThread]: On master: COMMIT
[0m06:02:34.459117 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:34.459505 [debug] [MainThread]: On master: Close
[0m06:02:34.460195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:34.460576 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:34.461004 [info ] [MainThread]: 
[0m06:02:34.461462 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.38 seconds (8.38s).
[0m06:02:34.462400 [debug] [MainThread]: Command end result
[0m06:02:34.489060 [info ] [MainThread]: 
[0m06:02:34.489655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:34.490133 [info ] [MainThread]: 
[0m06:02:34.490586 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:34.491528 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.372398, "process_user_time": 5.058285, "process_kernel_time": 0.255115, "process_mem_max_rss": "340888", "process_in_blocks": "1200", "process_out_blocks": "99944"}
[0m06:02:34.492111 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:34.492008 after 10.37 seconds
[0m06:02:34.492548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22ec87f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e27d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e672630>]}
[0m06:02:34.492994 [debug] [MainThread]: Flushing usage events
[0m06:02:36.275928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda84dc41d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda847b8d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda84385910>]}


============================== 06:02:36.278785 | d7f03ad2-8ec7-4939-a39d-e05b19251acb ==============================
[0m06:02:36.278785 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:36.279404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:36.383775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7f03ad2-8ec7-4939-a39d-e05b19251acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda844032f0>]}
[0m06:02:36.401004 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17326723, "process_user_time": 1.278813, "process_kernel_time": 0.123885, "process_mem_max_rss": "100716", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:36.401505 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:36.401406 after 0.17 seconds
[0m06:02:36.401930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda84ffc980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda842d5ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda844f8e00>]}
[0m06:02:36.402326 [debug] [MainThread]: Flushing usage events
[0m14:06:12.632996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6c0285f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6abfb0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6a2b20f0>]}


============================== 14:06:12.648999 | 6603dc7b-2553-4b12-bc47-5a0d288b1481 ==============================
[0m14:06:12.648999 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:12.649624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:12.768487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6603dc7b-2553-4b12-bc47-5a0d288b1481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf69ebb2f0>]}
[0m14:06:12.783486 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fs0yalhe'
[0m14:06:12.783969 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:12.859521 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:12.860265 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:12.872290 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:12.876291 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:12.928017 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:12.928534 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:06:12.929066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6603dc7b-2553-4b12-bc47-5a0d288b1481', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf69bc7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6af080e0>]}
[0m14:06:12.929503 [info ] [MainThread]: 
[0m14:06:12.929964 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:12.935546 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3514694, "process_user_time": 1.558616, "process_kernel_time": 0.132052, "process_mem_max_rss": "101680", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m14:06:12.936109 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:12.936008 after 0.35 seconds
[0m14:06:12.936531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6a2d5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf69c28140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf69c28380>]}
[0m14:06:12.936979 [debug] [MainThread]: Flushing usage events
[0m14:06:14.546089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa1b64470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa1e80f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa19ff7d0>]}


============================== 14:06:14.549226 | e11eaf46-d5d0-4fb8-b904-6ba3366f0659 ==============================
[0m14:06:14.549226 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:14.549942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:14.752298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0a774d0>]}
[0m14:06:14.811297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0b871d0>]}
[0m14:06:14.814052 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:06:14.838777 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:14.839473 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:14.840004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0d30d10>]}
[0m14:06:16.119571 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:16.120228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0b0ac00>]}
[0m14:06:16.360569 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:16.366226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa293b680>]}
[0m14:06:16.469246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9c9f1190>]}
[0m14:06:16.469881 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:06:16.470409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9c9ddb50>]}
[0m14:06:16.472336 [info ] [MainThread]: 
[0m14:06:16.473068 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:16.477823 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:16.513560 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:16.514129 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:16.514558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:17.025084 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:06:17.027141 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:17.028323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:17.029066 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:17.037651 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.038109 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:17.038502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:17.039633 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.041032 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.041424 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:17.042029 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.042416 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.042811 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:17.043416 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.044370 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:17.044776 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.045142 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:17.045687 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.046130 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:17.047505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:17.053575 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:17.054103 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:17.054467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:17.055199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.055585 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:17.056009 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:17.066307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.068171 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:17.069567 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:17.070020 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:17.072428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9b3503e0>]}
[0m14:06:17.073030 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:17.073422 [debug] [MainThread]: On master: BEGIN
[0m14:06:17.073819 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:17.074600 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:17.075032 [debug] [MainThread]: On master: COMMIT
[0m14:06:17.075421 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:17.075803 [debug] [MainThread]: On master: COMMIT
[0m14:06:17.076369 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:17.076812 [debug] [MainThread]: On master: Close
[0m14:06:17.077409 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:17.077925 [info ] [MainThread]: 
[0m14:06:17.089903 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:17.090591 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:17.091254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:17.091697 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:17.119376 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:17.120338 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:17.156656 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:17.157611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:23.705359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.705901 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:23.706531 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.706995 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.707408 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:23.708116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.711197 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.711634 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:23.712322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.728979 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:23.729449 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.729889 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:23.731851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.737668 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.738144 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:23.740068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.742456 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:23.744010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5eba48f0>]}
[0m14:06:23.744679 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.65s]
[0m14:06:23.745508 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:23.746346 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:23.746979 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:23.747662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:23.748236 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:23.753206 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:23.753872 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:23.790247 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.790846 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250716140623784138"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:23.791321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:23.799614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.807744 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.808205 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:23.808882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.809314 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.809746 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250716140623784138'
      
      
      order by ordinal_position

  
[0m14:06:23.812285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.817467 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.817945 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:23.820897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.828580 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.829059 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:23.831808 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.849906 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:23.850594 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.851065 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250716140623784138"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250716140623784138"
    )
  
[0m14:06:23.897929 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.899989 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:23.900442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.900875 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:23.908342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.909246 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:23.910719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f900d6060>]}
[0m14:06:23.911410 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:06:23.912146 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:23.913493 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:23.913929 [debug] [MainThread]: On master: BEGIN
[0m14:06:23.914291 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:23.914929 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:23.915319 [debug] [MainThread]: On master: COMMIT
[0m14:06:23.915679 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:23.916070 [debug] [MainThread]: On master: COMMIT
[0m14:06:23.916581 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:23.916997 [debug] [MainThread]: On master: Close
[0m14:06:23.917589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:23.917997 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:23.918393 [info ] [MainThread]: 
[0m14:06:23.918885 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.45 seconds (7.45s).
[0m14:06:23.919836 [debug] [MainThread]: Command end result
[0m14:06:23.945858 [info ] [MainThread]: 
[0m14:06:23.946448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:23.946933 [info ] [MainThread]: 
[0m14:06:23.947416 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:23.948407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.451223, "process_user_time": 5.203976, "process_kernel_time": 0.292617, "process_mem_max_rss": "334352", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m14:06:23.948969 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:23.948863 after 9.45 seconds
[0m14:06:23.949395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa38ed1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0e135f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5e9d3560>]}
[0m14:06:23.949827 [debug] [MainThread]: Flushing usage events
[0m14:06:25.833688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff52914d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5297c4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5297c40e0>]}


============================== 14:06:25.836958 | 321da84a-e5c0-4a21-8797-f34a97dc65a2 ==============================
[0m14:06:25.836958 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:25.837591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:25.945080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '321da84a-e5c0-4a21-8797-f34a97dc65a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff528d02cf0>]}
[0m14:06:25.963382 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17884552, "process_user_time": 1.34691, "process_kernel_time": 0.11091, "process_mem_max_rss": "100768", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:06:25.963952 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:25.963846 after 0.18 seconds
[0m14:06:25.964372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5297c4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff529b64230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff528c16a20>]}
[0m14:06:25.964807 [debug] [MainThread]: Flushing usage events
[0m22:06:26.799923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02d195580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02dec3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02dbe7e60>]}


============================== 22:06:26.815508 | 151c28ef-8ade-4cd5-a1fe-d2d0b0fb68f4 ==============================
[0m22:06:26.815508 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:26.816194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:26.940088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '151c28ef-8ade-4cd5-a1fe-d2d0b0fb68f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02cf4b2f0>]}
[0m22:06:26.954701 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2n04ynic'
[0m22:06:26.955158 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:27.051671 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:27.052336 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:27.062519 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:27.066363 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:27.272176 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:27.272777 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:27.273360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '151c28ef-8ade-4cd5-a1fe-d2d0b0fb68f4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02cb100b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02dd10260>]}
[0m22:06:27.273847 [info ] [MainThread]: 
[0m22:06:27.274355 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:27.281412 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5302712, "process_user_time": 1.574517, "process_kernel_time": 0.132295, "process_mem_max_rss": "101436", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m22:06:27.281984 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:27.281881 after 0.53 seconds
[0m22:06:27.282402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02dec3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02d1b4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02cab9f40>]}
[0m22:06:27.282829 [debug] [MainThread]: Flushing usage events
[0m22:06:29.048671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a852a54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a858d86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a86d39580>]}


============================== 22:06:29.051667 | be82b3f8-3659-458c-9cdb-17cdf8fef51a ==============================
[0m22:06:29.051667 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:29.052370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:29.253262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a86973380>]}
[0m22:06:29.311481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a85dd0e60>]}
[0m22:06:29.314048 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:29.339324 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:29.340047 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:29.340560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a80b01df0>]}
[0m22:06:30.625685 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:30.626357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a80a7dac0>]}
[0m22:06:30.858309 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:30.863782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a84dc0b30>]}
[0m22:06:30.963484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8066a810>]}
[0m22:06:30.964123 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:30.964630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a80681520>]}
[0m22:06:30.966561 [info ] [MainThread]: 
[0m22:06:30.967297 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:30.972180 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:31.009706 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:31.010191 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:31.010585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:31.478929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.481216 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:31.482551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:31.483279 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:31.491985 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.492412 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:31.492813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:31.493733 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.495048 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.495439 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:31.496043 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.496427 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.496832 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:31.497427 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.498364 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:31.498779 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.499150 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:31.499762 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.500164 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:31.501424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:31.507151 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:31.507553 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:31.507937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:31.508656 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.509086 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:31.509462 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:31.518986 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.520418 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:31.521655 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:31.522073 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:31.524285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a869d5100>]}
[0m22:06:31.524812 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.525200 [debug] [MainThread]: On master: BEGIN
[0m22:06:31.525560 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:31.526178 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.526571 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.526986 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.527349 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.527874 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.528267 [debug] [MainThread]: On master: Close
[0m22:06:31.528807 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:31.529267 [info ] [MainThread]: 
[0m22:06:31.546808 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:31.547392 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:31.547983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:31.548425 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:31.574966 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:31.575705 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:31.610832 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:31.611601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:42.044049 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.044535 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:42.045212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.045645 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.046094 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:42.046842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.049732 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.050186 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:42.050889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.067404 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:42.067902 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.068324 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:42.069437 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.075042 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.075497 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:42.076675 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.079011 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:42.080529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7f26eb40>]}
[0m22:06:42.081235 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.53s]
[0m22:06:42.081998 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:42.082907 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:42.083561 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:42.084178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:42.084609 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:42.089490 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:42.090149 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:42.126115 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.126600 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250716220642120108"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:42.127071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:42.134800 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.142144 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.142594 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:42.143204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.143636 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.144087 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250716220642120108'
      
      
      order by ordinal_position

  
[0m22:06:42.146222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.151274 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.151757 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:42.153839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.161398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.161877 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:42.164237 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.182100 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:42.182775 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.183231 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250716220642120108"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250716220642120108"
    )
  
[0m22:06:42.230104 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.232103 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:42.232548 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.232984 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:42.239972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.240865 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:42.242388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a46367800>]}
[0m22:06:42.243076 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:06:42.243887 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:42.245220 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.245623 [debug] [MainThread]: On master: BEGIN
[0m22:06:42.246033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:42.246647 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.247072 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.247436 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.247832 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.248348 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.248756 [debug] [MainThread]: On master: Close
[0m22:06:42.249360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:42.249748 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:42.250158 [info ] [MainThread]: 
[0m22:06:42.250669 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.28 seconds (11.28s).
[0m22:06:42.251678 [debug] [MainThread]: Command end result
[0m22:06:42.277176 [info ] [MainThread]: 
[0m22:06:42.277785 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:42.278294 [info ] [MainThread]: 
[0m22:06:42.278828 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:42.279820 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.279617, "process_user_time": 5.06972, "process_kernel_time": 0.280371, "process_mem_max_rss": "345932", "process_in_blocks": "1200", "process_out_blocks": "100136"}
[0m22:06:42.280359 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:42.280257 after 13.28 seconds
[0m22:06:42.280810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a84d24b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a85da7a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a47492ab0>]}
[0m22:06:42.281240 [debug] [MainThread]: Flushing usage events
[0m22:06:44.312400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6c9755e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6ee57140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6eb3ff50>]}


============================== 22:06:44.315577 | a9494496-d521-4b29-ab8a-f33b906cb8bb ==============================
[0m22:06:44.315577 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:44.316283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:44.423630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9494496-d521-4b29-ab8a-f33b906cb8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6c657380>]}
[0m22:06:44.441652 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1781356, "process_user_time": 1.328535, "process_kernel_time": 0.109961, "process_mem_max_rss": "100620", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:44.442217 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:44.442111 after 0.18 seconds
[0m22:06:44.442640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6c8d1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6eb3ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6c38fe60>]}
[0m22:06:44.443087 [debug] [MainThread]: Flushing usage events
[0m06:02:24.765499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4167ee7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41670f3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41670a8920>]}


============================== 06:02:24.779884 | 8749df10-7965-4093-96de-f8ea67da9811 ==============================
[0m06:02:24.779884 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.780513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.890836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8749df10-7965-4093-96de-f8ea67da9811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41680009b0>]}
[0m06:02:24.905609 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ogvzcj7o'
[0m06:02:24.906075 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:25.068823 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:25.069585 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:25.111270 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:25.115282 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:25.324178 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:25.324763 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:25.325276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8749df10-7965-4093-96de-f8ea67da9811', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4166efe4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4166efd4f0>]}
[0m06:02:25.325752 [info ] [MainThread]: 
[0m06:02:25.326232 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:25.331134 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6152713, "process_user_time": 1.576581, "process_kernel_time": 0.125364, "process_mem_max_rss": "101292", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m06:02:25.331669 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:25.331568 after 0.62 seconds
[0m06:02:25.332117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41679a8f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4166e04380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4166e04350>]}
[0m06:02:25.332524 [debug] [MainThread]: Flushing usage events
[0m06:02:27.050657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4593a9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4593a9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4593a9b50>]}


============================== 06:02:27.053780 | b319958f-50c8-4358-97be-50c6f7f36638 ==============================
[0m06:02:27.053780 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:27.054456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.259267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4598a9220>]}
[0m06:02:27.318377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45927d250>]}
[0m06:02:27.320968 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:27.343863 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:27.344570 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:27.345112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4553a9df0>]}
[0m06:02:28.637748 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:28.638385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4552a14c0>]}
[0m06:02:28.867722 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:28.873115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4594f27e0>]}
[0m06:02:28.967594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4550d6570>]}
[0m06:02:28.968170 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:28.968666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4550b7d70>]}
[0m06:02:28.970515 [info ] [MainThread]: 
[0m06:02:28.971227 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:28.976032 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:29.010773 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:29.011206 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:29.011595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:29.476250 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.477908 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:29.479031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:29.479677 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:29.487564 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.488031 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:29.488410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.489514 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.490868 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.491260 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:29.491856 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.492254 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.492619 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:29.493220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.494145 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.494536 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.494924 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.495453 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.495871 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:29.497115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:29.502913 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.503401 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:29.503790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.504380 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.504785 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.505158 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:29.515346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.516817 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:29.518052 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:29.518442 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:29.520824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff455187dd0>]}
[0m06:02:29.521321 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.521752 [debug] [MainThread]: On master: BEGIN
[0m06:02:29.522125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:29.522759 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.523163 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.523544 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.523972 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.524498 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.524912 [debug] [MainThread]: On master: Close
[0m06:02:29.525427 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:29.525903 [info ] [MainThread]: 
[0m06:02:29.543799 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:29.544418 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:29.545022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:29.545461 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:29.572837 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:29.573575 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:29.609088 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:29.609840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:38.774023 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.774515 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:38.775162 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.775596 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.776038 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:38.776732 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.779648 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.780108 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:38.780773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.797465 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.797944 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.798362 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.800028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.805753 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.806206 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:38.807558 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.809911 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:38.811432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff453c24680>]}
[0m06:02:38.812123 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.27s]
[0m06:02:38.812951 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:38.813785 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:38.814355 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:38.814997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:38.815461 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:38.820553 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:38.821219 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:38.857666 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.858197 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250717060238851555"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:38.858653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:38.866702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.874630 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.875118 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:38.875773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.876207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.876622 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250717060238851555'
      
      
      order by ordinal_position

  
[0m06:02:38.878769 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.883956 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.884427 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:38.886908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.894612 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.895092 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:38.898048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.916282 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:38.916989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.917456 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250717060238851555"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250717060238851555"
    )
  
[0m06:02:38.967289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.969322 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:38.969814 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.970236 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:38.977017 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.977951 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:38.979473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff421d905c0>]}
[0m06:02:38.980184 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:38.981022 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:38.982365 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:38.982810 [debug] [MainThread]: On master: BEGIN
[0m06:02:38.983190 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:38.983867 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:38.984271 [debug] [MainThread]: On master: COMMIT
[0m06:02:38.984655 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:38.985065 [debug] [MainThread]: On master: COMMIT
[0m06:02:38.985614 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:38.986039 [debug] [MainThread]: On master: Close
[0m06:02:38.986635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:38.987039 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:38.987441 [info ] [MainThread]: 
[0m06:02:38.987981 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.02 seconds (10.02s).
[0m06:02:38.988994 [debug] [MainThread]: Command end result
[0m06:02:39.015121 [info ] [MainThread]: 
[0m06:02:39.015740 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:39.016255 [info ] [MainThread]: 
[0m06:02:39.016790 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:39.017806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.016199, "process_user_time": 5.101509, "process_kernel_time": 0.282415, "process_mem_max_rss": "339416", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:39.018345 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:39.018241 after 12.02 seconds
[0m06:02:39.018801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4593a9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff459866720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff417039fa0>]}
[0m06:02:39.019232 [debug] [MainThread]: Flushing usage events
[0m06:02:40.969133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd971f81a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd973082ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd973083a10>]}


============================== 06:02:40.972221 | 2bef1067-5902-4bc1-b9d9-144ac25d8a11 ==============================
[0m06:02:40.972221 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:40.972915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:41.081320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bef1067-5902-4bc1-b9d9-144ac25d8a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd972989dc0>]}
[0m06:02:41.099653 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17934872, "process_user_time": 1.349669, "process_kernel_time": 0.100975, "process_mem_max_rss": "100732", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:41.100212 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:41.100109 after 0.18 seconds
[0m06:02:41.100650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9764d38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd972989dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd971f03110>]}
[0m06:02:41.101107 [debug] [MainThread]: Flushing usage events
[0m14:05:08.056641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d3294350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d299efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d2c83350>]}


============================== 14:05:08.152161 | 931d3a87-7fd0-4172-8030-1e6df84bde61 ==============================
[0m14:05:08.152161 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:08.152857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:08.286345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '931d3a87-7fd0-4172-8030-1e6df84bde61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d39f8860>]}
[0m14:05:08.301554 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-i6zyxnzx'
[0m14:05:08.302027 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:08.375923 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:08.376745 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:08.388795 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:08.393052 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:08.441061 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:08.441616 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:08.442150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '931d3a87-7fd0-4172-8030-1e6df84bde61', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d252c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d39df710>]}
[0m14:05:08.442612 [info ] [MainThread]: 
[0m14:05:08.443093 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:08.472945 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46701247, "process_user_time": 1.625777, "process_kernel_time": 0.136812, "process_mem_max_rss": "101276", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m14:05:08.473690 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:08.473535 after 0.47 seconds
[0m14:05:08.474220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d30f34a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d27b6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d2ba6c00>]}
[0m14:05:08.474692 [debug] [MainThread]: Flushing usage events
[0m14:05:10.089785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4afc4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4aa69430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4afc46e0>]}


============================== 14:05:10.093189 | 0fda693f-2d26-4f04-91fc-3097f2c42bba ==============================
[0m14:05:10.093189 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:10.093857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:10.301729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4a9c4560>]}
[0m14:05:10.361375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4a545460>]}
[0m14:05:10.364271 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:05:10.460385 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:10.461276 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:10.461871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4a3d29f0>]}
[0m14:05:11.759115 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:11.759865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f463c69f0>]}
[0m14:05:12.002347 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:12.008092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4a5f19a0>]}
[0m14:05:12.106293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f461d5df0>]}
[0m14:05:12.106861 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:05:12.107367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f46153bf0>]}
[0m14:05:12.109294 [info ] [MainThread]: 
[0m14:05:12.110033 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:12.114837 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:12.150119 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:12.150549 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:12.150959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:12.625380 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.627550 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:12.628616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:12.629177 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:12.637068 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.637492 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:12.637900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:12.638741 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.640063 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.640451 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:12.641072 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.641452 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.641868 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:12.642485 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.643490 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:12.643913 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.644281 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:12.644833 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.645229 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:12.646552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:12.652259 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:12.652771 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:12.653133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:12.653761 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.654147 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:12.654526 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:12.665146 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.666575 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:12.667848 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:12.668238 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:12.670506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f46114ec0>]}
[0m14:05:12.671089 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:12.671468 [debug] [MainThread]: On master: BEGIN
[0m14:05:12.671854 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:12.672449 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:12.672872 [debug] [MainThread]: On master: COMMIT
[0m14:05:12.673244 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:12.673620 [debug] [MainThread]: On master: COMMIT
[0m14:05:12.674141 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:12.674524 [debug] [MainThread]: On master: Close
[0m14:05:12.675072 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:12.675544 [info ] [MainThread]: 
[0m14:05:12.692107 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:12.692704 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:12.693340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:12.693828 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:12.720771 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:12.721534 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:12.757128 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:12.757885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:19.627850 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:19.628346 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:19.629019 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.629458 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:19.629911 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:19.630619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.633476 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:19.633945 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:19.634615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.651346 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:19.651827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:19.652249 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:19.654246 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.659884 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:19.660339 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:05:19.661490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.663875 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:19.665408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4c27a000>]}
[0m14:05:19.666138 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.97s]
[0m14:05:19.666915 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:19.667892 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:19.668439 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:19.669076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:19.669524 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:19.674460 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:19.675118 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:19.711315 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.711821 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250717140519705231"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:19.712275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:19.720146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.727556 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.728048 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:19.728651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.729094 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.729520 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250717140519705231'
      
      
      order by ordinal_position

  
[0m14:05:19.731776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.736895 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.737354 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:19.739994 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.747645 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.748117 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:19.750244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.768492 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:19.769201 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.769677 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250717140519705231"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250717140519705231"
    )
  
[0m14:05:19.818838 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.821013 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:19.821468 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:19.821908 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:19.829262 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:19.830206 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:19.831775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fda693f-2d26-4f04-91fc-3097f2c42bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f0c1ca900>]}
[0m14:05:19.832456 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:05:19.833209 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:19.834955 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:19.835359 [debug] [MainThread]: On master: BEGIN
[0m14:05:19.835766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:19.836403 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:19.836836 [debug] [MainThread]: On master: COMMIT
[0m14:05:19.837205 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:19.837562 [debug] [MainThread]: On master: COMMIT
[0m14:05:19.838155 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:19.838543 [debug] [MainThread]: On master: Close
[0m14:05:19.839156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:19.839528 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:19.839975 [info ] [MainThread]: 
[0m14:05:19.840451 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.73 seconds (7.73s).
[0m14:05:19.841409 [debug] [MainThread]: Command end result
[0m14:05:19.867626 [info ] [MainThread]: 
[0m14:05:19.868198 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:19.868690 [info ] [MainThread]: 
[0m14:05:19.869178 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:19.870174 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.830445, "process_user_time": 5.183729, "process_kernel_time": 0.30416, "process_mem_max_rss": "340812", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m14:05:19.870749 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:19.870643 after 9.83 seconds
[0m14:05:19.871187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4aa69430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f4617cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f461434a0>]}
[0m14:05:19.871628 [debug] [MainThread]: Flushing usage events
[0m14:05:21.805470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08a0fba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0892f3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff089cefce0>]}


============================== 14:05:21.808648 | 531f34c9-259d-405e-b4c0-446614e77e36 ==============================
[0m14:05:21.808648 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:21.809284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:21.917800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '531f34c9-259d-405e-b4c0-446614e77e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0896d8380>]}
[0m14:05:21.935522 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17981568, "process_user_time": 1.351823, "process_kernel_time": 0.119984, "process_mem_max_rss": "100656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:21.936076 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:21.935968 after 0.18 seconds
[0m14:05:21.936487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0896d8380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0892ace30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0892adac0>]}
[0m14:05:21.936918 [debug] [MainThread]: Flushing usage events
[0m22:06:37.688362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0f1b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0b3fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e1cad340>]}


============================== 22:06:37.703009 | 55ccfe61-aebd-4131-9ccf-d42c867bad5b ==============================
[0m22:06:37.703009 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:37.703722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:37.833597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55ccfe61-aebd-4131-9ccf-d42c867bad5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0f18830>]}
[0m22:06:37.848621 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8czs9t6f'
[0m22:06:37.849082 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:37.987684 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:37.988416 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:38.011784 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:38.015656 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:38.097151 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:38.097702 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:38.098255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '55ccfe61-aebd-4131-9ccf-d42c867bad5b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0ce3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e11d8860>]}
[0m22:06:38.098729 [info ] [MainThread]: 
[0m22:06:38.099223 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:38.106792 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46789932, "process_user_time": 1.540341, "process_kernel_time": 0.141755, "process_mem_max_rss": "101444", "process_in_blocks": "8744", "process_out_blocks": "5168"}
[0m22:06:38.107331 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:38.107230 after 0.47 seconds
[0m22:06:38.107775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0ca5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e17fb770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e1bffbf0>]}
[0m22:06:38.108198 [debug] [MainThread]: Flushing usage events
[0m22:06:39.695347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729d511b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729db4ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729db4a360>]}


============================== 22:06:39.698625 | 93c2906c-261c-4428-9733-b1a42c9b6a69 ==============================
[0m22:06:39.698625 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:39.699319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:39.901254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729d1e74d0>]}
[0m22:06:39.959928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729f1fa240>]}
[0m22:06:39.962439 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:39.984500 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:39.985240 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:39.985761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729e2663f0>]}
[0m22:06:41.269687 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:41.270324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72993e1fa0>]}
[0m22:06:41.492580 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:41.497961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729e3e7d70>]}
[0m22:06:41.592582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72991211f0>]}
[0m22:06:41.593088 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:41.593632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7299117890>]}
[0m22:06:41.595391 [info ] [MainThread]: 
[0m22:06:41.596091 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:41.600732 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:41.634948 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:41.635371 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:41.635783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:42.153368 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:42.155333 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:42.156412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:42.157091 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:42.164747 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.165165 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:42.165561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.166424 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.167738 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.168126 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:42.168670 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.169054 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.169414 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:42.170044 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.170974 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.171364 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.171747 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.172257 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.172670 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:42.173907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:42.179626 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.180033 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:42.180393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.181012 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.181392 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.181801 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:42.191478 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.192926 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:42.194143 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:42.194562 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:42.196745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72992e4290>]}
[0m22:06:42.197239 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.197658 [debug] [MainThread]: On master: BEGIN
[0m22:06:42.198015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:42.198630 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.199021 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.199378 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.199766 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.200310 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.200717 [debug] [MainThread]: On master: Close
[0m22:06:42.201239 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:42.201719 [info ] [MainThread]: 
[0m22:06:42.218993 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:42.219592 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:42.220159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:42.220616 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:42.247371 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:42.248234 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:42.283711 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:42.284483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:49.289847 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:49.290332 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:49.290986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.291417 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:49.291860 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:49.292744 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.295705 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:49.296142 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:49.296820 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.313443 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:49.313930 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:49.314346 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:49.316207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.321973 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:49.322421 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:49.323703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.326032 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:49.327601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729f2767e0>]}
[0m22:06:49.328276 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.11s]
[0m22:06:49.329103 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:49.330047 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:49.330608 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:49.331227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:49.331700 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:49.336537 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:49.337176 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:49.373122 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.373621 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250717220649367133"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:49.374072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:49.381884 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.389303 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.389797 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:49.390395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.390849 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.391263 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250717220649367133'
      
      
      order by ordinal_position

  
[0m22:06:49.393400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.398532 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.398994 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:49.401235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.408813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.409265 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:49.411578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.429598 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:49.430260 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.430729 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250717220649367133"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250717220649367133"
    )
  
[0m22:06:49.479849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.481824 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:49.482258 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.482693 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:49.489277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.490150 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:49.491612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93c2906c-261c-4428-9733-b1a42c9b6a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f725b130aa0>]}
[0m22:06:49.492273 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:06:49.493078 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:49.494388 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.494824 [debug] [MainThread]: On master: BEGIN
[0m22:06:49.495191 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:49.495809 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.496200 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.496589 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.496950 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.497495 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.497913 [debug] [MainThread]: On master: Close
[0m22:06:49.498490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:49.498887 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:49.499276 [info ] [MainThread]: 
[0m22:06:49.499785 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.90 seconds (7.90s).
[0m22:06:49.500741 [debug] [MainThread]: Command end result
[0m22:06:49.526243 [info ] [MainThread]: 
[0m22:06:49.526832 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:49.527315 [info ] [MainThread]: 
[0m22:06:49.527820 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:49.528793 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.883148, "process_user_time": 5.089763, "process_kernel_time": 0.286267, "process_mem_max_rss": "341320", "process_in_blocks": "1200", "process_out_blocks": "100144"}
[0m22:06:49.529333 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:49.529231 after 9.88 seconds
[0m22:06:49.529781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729db4a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7299117530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729d9128d0>]}
[0m22:06:49.530196 [debug] [MainThread]: Flushing usage events
[0m22:06:51.318826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b72613a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b77e73e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b77e5730>]}


============================== 22:06:51.321854 | 540f7f8c-94da-4d3d-b31e-021cf5ff666a ==============================
[0m22:06:51.321854 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:51.322471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:51.430858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '540f7f8c-94da-4d3d-b31e-021cf5ff666a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b7e64d40>]}
[0m22:06:51.448163 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17809294, "process_user_time": 1.309544, "process_kernel_time": 0.117048, "process_mem_max_rss": "100496", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:51.448739 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:51.448632 after 0.18 seconds
[0m22:06:51.449157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b73c7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b70975f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b7d27260>]}
[0m22:06:51.449582 [debug] [MainThread]: Flushing usage events
[0m06:02:23.258268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4ac61f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4a43fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4aae32f0>]}


============================== 06:02:23.274827 | 5812e736-3002-42a7-ad8e-5ade1c05b5c2 ==============================
[0m06:02:23.274827 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:23.275533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:23.413662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5812e736-3002-42a7-ad8e-5ade1c05b5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a49e732f0>]}
[0m06:02:23.429894 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x64oqzrk'
[0m06:02:23.430441 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:23.549303 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:23.550095 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:23.573791 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:23.577904 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:23.652174 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:23.652888 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:23.653522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5812e736-3002-42a7-ad8e-5ade1c05b5c2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a49e633b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a49e2ff50>]}
[0m06:02:23.654013 [info ] [MainThread]: 
[0m06:02:23.654529 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:23.664949 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45777413, "process_user_time": 1.654493, "process_kernel_time": 0.148595, "process_mem_max_rss": "101764", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m06:02:23.665622 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:23.665503 after 0.46 seconds
[0m06:02:23.666119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4a4dffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4a087620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4a414c80>]}
[0m06:02:23.666595 [debug] [MainThread]: Flushing usage events
[0m06:02:25.473645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc51ee9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc50107a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc50370170>]}


============================== 06:02:25.477240 | 1418e1cb-b4dd-4f68-a55c-e92e497b1091 ==============================
[0m06:02:25.477240 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.477925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:25.686803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc513553a0>]}
[0m06:02:25.747235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc508abd40>]}
[0m06:02:25.750066 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:25.778712 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:25.779524 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:25.780077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4fd713a0>]}
[0m06:02:27.080827 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:27.081542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4b8a24b0>]}
[0m06:02:27.338467 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:27.344390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc50158650>]}
[0m06:02:27.448386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4bbfde20>]}
[0m06:02:27.449030 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:27.449607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4b840920>]}
[0m06:02:27.451698 [info ] [MainThread]: 
[0m06:02:27.452480 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:27.457556 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:27.493639 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:27.494214 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:27.494656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:28.001694 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:28.003865 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:28.005176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:28.005841 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:28.015305 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:28.015768 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:28.016185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:28.017605 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.019337 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:28.019731 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:28.020323 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.020744 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:28.021364 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:28.022199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.023326 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:28.023776 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:28.024244 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:28.024892 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.025431 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:28.027013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:28.033238 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:28.033688 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:28.034070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:28.034828 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.035234 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:28.035604 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:28.045631 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.047428 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:28.048763 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:28.049186 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:28.051545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4a438560>]}
[0m06:02:28.052119 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:28.052512 [debug] [MainThread]: On master: BEGIN
[0m06:02:28.052879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:28.053698 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:28.054135 [debug] [MainThread]: On master: COMMIT
[0m06:02:28.054521 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:28.054898 [debug] [MainThread]: On master: COMMIT
[0m06:02:28.055532 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:28.055933 [debug] [MainThread]: On master: Close
[0m06:02:28.056562 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:28.057037 [info ] [MainThread]: 
[0m06:02:28.077108 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:28.077810 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:28.078469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:28.078924 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:28.106847 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:28.107791 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:28.144270 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:28.145219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:35.336813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.337378 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:35.338163 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.338608 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.339023 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:35.339805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.342982 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.343450 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:35.344205 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.361315 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:35.361874 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.362340 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:35.364416 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.370509 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.370976 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:35.372709 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.375231 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:35.376832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc51b2a4e0>]}
[0m06:02:35.377562 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.30s]
[0m06:02:35.378355 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:35.379204 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:35.379778 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:35.380435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:35.380884 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:35.386144 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:35.387144 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:35.424791 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.425400 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250718060235418436"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:35.425873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:35.434293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.442643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.443169 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:35.443893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.444359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.444787 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250718060235418436'
      
      
      order by ordinal_position

  
[0m06:02:35.447204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.452819 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.453319 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:35.456029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.464252 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.464761 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:35.467899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.486723 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:35.487538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.488018 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250718060235418436"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250718060235418436"
    )
  
[0m06:02:35.538040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.540122 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:35.540591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.541004 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:35.548586 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.549602 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:35.551196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1418e1cb-b4dd-4f68-a55c-e92e497b1091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc12af94c0>]}
[0m06:02:35.551907 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:02:35.552702 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:35.554308 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:35.554736 [debug] [MainThread]: On master: BEGIN
[0m06:02:35.555156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:35.555926 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:35.556363 [debug] [MainThread]: On master: COMMIT
[0m06:02:35.556741 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:35.557128 [debug] [MainThread]: On master: COMMIT
[0m06:02:35.557707 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:35.558150 [debug] [MainThread]: On master: Close
[0m06:02:35.558801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:35.559197 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:35.559610 [info ] [MainThread]: 
[0m06:02:35.560120 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.11 seconds (8.11s).
[0m06:02:35.561074 [debug] [MainThread]: Command end result
[0m06:02:35.588312 [info ] [MainThread]: 
[0m06:02:35.588992 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:35.589538 [info ] [MainThread]: 
[0m06:02:35.590083 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:35.591132 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.168383, "process_user_time": 5.337455, "process_kernel_time": 0.317562, "process_mem_max_rss": "338188", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:35.591698 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:35.591577 after 10.17 seconds
[0m06:02:35.592177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4fe9d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4b8676b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc11993ce0>]}
[0m06:02:35.592616 [debug] [MainThread]: Flushing usage events
[0m06:02:37.649781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68d9c4260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68d9c6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68edf4440>]}


============================== 06:02:37.653122 | 4654d2b0-cf32-4b81-86c6-438f2dd7779c ==============================
[0m06:02:37.653122 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:37.653831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:37.764971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4654d2b0-cf32-4b81-86c6-438f2dd7779c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68de08320>]}
[0m06:02:37.784047 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1852455, "process_user_time": 1.416641, "process_kernel_time": 0.127967, "process_mem_max_rss": "100500", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:37.784650 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:37.784539 after 0.19 seconds
[0m06:02:37.785152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68d82cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb691102c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68de08320>]}
[0m06:02:37.785601 [debug] [MainThread]: Flushing usage events
[0m14:06:12.771340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02926154f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029307aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0292d08740>]}


============================== 14:06:12.846677 | 5cd226cc-24ff-4d9d-ae25-edea5105c4b0 ==============================
[0m14:06:12.846677 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:12.847347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:13.096479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cd226cc-24ff-4d9d-ae25-edea5105c4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02928f9220>]}
[0m14:06:13.111807 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lujts28c'
[0m14:06:13.112295 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:13.239607 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:13.240463 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:13.258944 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:13.262935 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:13.401211 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:13.401824 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:06:13.402387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5cd226cc-24ff-4d9d-ae25-edea5105c4b0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029239ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02928abd70>]}
[0m14:06:13.402865 [info ] [MainThread]: 
[0m14:06:13.403366 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:13.431575 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.70944023, "process_user_time": 1.581547, "process_kernel_time": 0.124515, "process_mem_max_rss": "101468", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m14:06:13.432173 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:13.432065 after 0.71 seconds
[0m14:06:13.432613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02926154f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02924e87a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02928f9700>]}
[0m14:06:13.433072 [debug] [MainThread]: Flushing usage events
[0m14:06:15.081625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae9db06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae9bc5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aea787a10>]}


============================== 14:06:15.084742 | 26ddecb7-7de1-4f83-82e1-bb180e7fd0d5 ==============================
[0m14:06:15.084742 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:15.085381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:15.287403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae94b17c0>]}
[0m14:06:15.345488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aeb6dd3a0>]}
[0m14:06:15.348088 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:06:15.439262 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:15.439980 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:15.440507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae97913a0>]}
[0m14:06:16.736637 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:16.737333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae53ed340>]}
[0m14:06:16.970097 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:16.975527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae95e7aa0>]}
[0m14:06:17.079193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae534be00>]}
[0m14:06:17.079726 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:06:17.080237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae9973140>]}
[0m14:06:17.082108 [info ] [MainThread]: 
[0m14:06:17.082820 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:17.087621 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:17.122493 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:17.122950 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:17.123343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:17.610583 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.612454 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:17.613724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:17.614407 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:17.622947 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.623374 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:17.623750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:17.624724 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.626089 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.626478 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:17.627038 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.627421 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.627788 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:17.628404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.629340 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:17.629733 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.630119 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:17.630649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.631065 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:17.632334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:17.638136 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:17.638629 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:17.639018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:17.639629 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.640044 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:17.640418 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:17.650387 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.651810 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:17.653054 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:17.653444 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:17.655676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae531bd10>]}
[0m14:06:17.656207 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:17.656584 [debug] [MainThread]: On master: BEGIN
[0m14:06:17.656970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:17.657583 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:17.657999 [debug] [MainThread]: On master: COMMIT
[0m14:06:17.658372 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:17.658727 [debug] [MainThread]: On master: COMMIT
[0m14:06:17.659258 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:17.659643 [debug] [MainThread]: On master: Close
[0m14:06:17.660196 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:17.660654 [info ] [MainThread]: 
[0m14:06:17.695031 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:17.695611 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:17.696191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:17.696625 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:17.723489 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:17.724286 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:17.760333 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:17.761219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:25.726531 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:25.727055 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:25.727688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.728159 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:25.728584 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:25.729280 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.732215 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:25.732657 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:25.733554 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.750283 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:25.750739 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:25.751178 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:25.753170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.758923 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:25.759378 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:25.760665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.763044 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:25.764578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa74775c0>]}
[0m14:06:25.765274 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.07s]
[0m14:06:25.766036 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:25.766964 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:25.767611 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:25.768202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:25.768639 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:25.773506 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:25.774163 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:25.810345 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.810844 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250718140625804320"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:25.811322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:25.819288 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.826989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.827447 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:25.828108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.828549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.829008 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250718140625804320'
      
      
      order by ordinal_position

  
[0m14:06:25.831185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.836473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.836968 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:25.839378 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.847846 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.848394 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:25.851400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.870528 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:25.871377 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.871858 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250718140625804320"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250718140625804320"
    )
  
[0m14:06:25.920112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.922213 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:25.922713 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:25.923167 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:25.931263 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:25.932198 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:25.933685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26ddecb7-7de1-4f83-82e1-bb180e7fd0d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aac517740>]}
[0m14:06:25.934385 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:06:25.935153 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:25.936457 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:25.936863 [debug] [MainThread]: On master: BEGIN
[0m14:06:25.937273 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:25.937952 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:25.938365 [debug] [MainThread]: On master: COMMIT
[0m14:06:25.938735 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:25.939134 [debug] [MainThread]: On master: COMMIT
[0m14:06:25.939662 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:25.940096 [debug] [MainThread]: On master: Close
[0m14:06:25.940732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:25.941136 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:25.941536 [info ] [MainThread]: 
[0m14:06:25.942011 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.86 seconds (8.86s).
[0m14:06:25.942937 [debug] [MainThread]: Command end result
[0m14:06:25.968844 [info ] [MainThread]: 
[0m14:06:25.969412 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:25.969870 [info ] [MainThread]: 
[0m14:06:25.970353 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:25.971302 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.938773, "process_user_time": 5.171893, "process_kernel_time": 0.28283, "process_mem_max_rss": "340012", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m14:06:25.971848 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:25.971745 after 10.94 seconds
[0m14:06:25.972312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae9729c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa72fba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ae3eb88f0>]}
[0m14:06:25.972737 [debug] [MainThread]: Flushing usage events
[0m14:06:27.844342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf55d73710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf54ce5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf54ce5940>]}


============================== 14:06:27.847427 | b1e019a4-74e5-4a2f-b5e4-1a0b1b706967 ==============================
[0m14:06:27.847427 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:27.848084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:06:27.955500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1e019a4-74e5-4a2f-b5e4-1a0b1b706967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5696f1a0>]}
[0m14:06:27.973182 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1778624, "process_user_time": 1.334248, "process_kernel_time": 0.103863, "process_mem_max_rss": "100620", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:27.973713 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:27.973607 after 0.18 seconds
[0m14:06:27.974162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf54dbf230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf54c35ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5696f1a0>]}
[0m14:06:27.974576 [debug] [MainThread]: Flushing usage events
[0m22:06:41.864383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9116934140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91159ad550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911482c950>]}


============================== 22:06:41.880597 | f9e8a115-19f7-4035-a3dd-d6a6da52a807 ==============================
[0m22:06:41.880597 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:41.881291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:42.019269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9e8a115-19f7-4035-a3dd-d6a6da52a807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9114689580>]}
[0m22:06:42.035174 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zudouaca'
[0m22:06:42.035685 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:42.149665 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:42.150413 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:42.167207 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:42.171208 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:42.231128 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:42.231736 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:42.232277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f9e8a115-19f7-4035-a3dd-d6a6da52a807', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911481faa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91159fc2c0>]}
[0m22:06:42.232726 [info ] [MainThread]: 
[0m22:06:42.233204 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:42.241361 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42785776, "process_user_time": 1.614882, "process_kernel_time": 0.158693, "process_mem_max_rss": "101784", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m22:06:42.241924 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:42.241821 after 0.43 seconds
[0m22:06:42.242379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9115214140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91145363f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91145362a0>]}
[0m22:06:42.242809 [debug] [MainThread]: Flushing usage events
[0m22:06:43.958049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac3987c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac4234da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac3987560>]}


============================== 22:06:43.961340 | c62d9da2-e299-45a1-ac5a-737d4c27451d ==============================
[0m22:06:43.961340 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:43.962037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:44.166990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac3645040>]}
[0m22:06:44.229274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac426b920>]}
[0m22:06:44.232146 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:44.255567 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:44.256378 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:44.256909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac366bdd0>]}
[0m22:06:45.639019 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:45.639670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abf7dbf20>]}
[0m22:06:45.882244 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:45.888152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac3a06c30>]}
[0m22:06:45.993651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abf5ccb60>]}
[0m22:06:45.994219 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:45.994705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abf6326f0>]}
[0m22:06:45.996640 [info ] [MainThread]: 
[0m22:06:45.997390 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:46.002299 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:46.037174 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:46.037630 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:46.038044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:46.568602 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:46.570833 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:46.572056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:46.572763 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:46.580565 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:46.581004 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:46.581389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:46.582630 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:46.584032 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:46.584420 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:46.584969 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:46.585370 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:46.585733 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:46.586318 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:46.587244 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:46.587634 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:46.588019 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:46.588548 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:46.588941 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:46.590309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:46.596490 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:46.596893 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:46.597279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:46.597929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:46.598341 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:46.598714 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:46.608389 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:46.610002 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:46.611305 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:46.611703 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:46.614031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abdf604d0>]}
[0m22:06:46.614551 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:46.614930 [debug] [MainThread]: On master: BEGIN
[0m22:06:46.615315 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:46.615952 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:46.616369 [debug] [MainThread]: On master: COMMIT
[0m22:06:46.616734 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:46.617113 [debug] [MainThread]: On master: COMMIT
[0m22:06:46.617655 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:46.618084 [debug] [MainThread]: On master: Close
[0m22:06:46.618620 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:46.619099 [info ] [MainThread]: 
[0m22:06:46.637485 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:46.638211 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:46.638862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:46.639350 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:46.668640 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:46.669463 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:46.707516 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:46.708307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:54.268773 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.269324 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:54.270050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.270489 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.270902 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:54.271635 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.274742 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.275206 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:54.276003 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.293079 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.293612 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.294057 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.295377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.301375 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.301834 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:54.303128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.305567 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:54.307147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abf7d9b50>]}
[0m22:06:54.307831 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.67s]
[0m22:06:54.308600 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:54.309534 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:54.310217 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:54.310825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:54.311302 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:54.316438 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:54.317117 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:54.354863 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.355509 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250718220654348565"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:54.355971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:54.364176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.372442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.372932 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:54.373651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.374111 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.374532 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250718220654348565'
      
      
      order by ordinal_position

  
[0m22:06:54.376934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.382487 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.382958 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.385566 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.393698 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.394195 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.396740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.415271 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:54.416135 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.416613 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250718220654348565"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250718220654348565"
    )
  
[0m22:06:54.463412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.465491 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.466003 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.466450 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.474781 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.475843 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:54.477503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62d9da2-e299-45a1-ac5a-737d4c27451d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8535ac00>]}
[0m22:06:54.478239 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:06:54.478990 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:54.480432 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:54.480840 [debug] [MainThread]: On master: BEGIN
[0m22:06:54.481255 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:54.482023 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:54.482424 [debug] [MainThread]: On master: COMMIT
[0m22:06:54.482789 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:54.483187 [debug] [MainThread]: On master: COMMIT
[0m22:06:54.483763 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:54.484194 [debug] [MainThread]: On master: Close
[0m22:06:54.484817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:54.485232 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:54.485636 [info ] [MainThread]: 
[0m22:06:54.486148 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.49 seconds (8.49s).
[0m22:06:54.487148 [debug] [MainThread]: Command end result
[0m22:06:54.514703 [info ] [MainThread]: 
[0m22:06:54.515392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:54.515882 [info ] [MainThread]: 
[0m22:06:54.516415 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:54.517456 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.611486, "process_user_time": 5.381557, "process_kernel_time": 0.286722, "process_mem_max_rss": "351044", "process_in_blocks": "1200", "process_out_blocks": "100144"}
[0m22:06:54.518056 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:54.517905 after 10.61 seconds
[0m22:06:54.518529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac3ca07a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac3d7ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a853ea420>]}
[0m22:06:54.518966 [debug] [MainThread]: Flushing usage events
[0m22:06:56.729686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b9ff0740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b9de86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b9f89400>]}


============================== 22:06:56.732952 | 4633864b-b66a-4740-9c6f-9f6daaa0c374 ==============================
[0m22:06:56.732952 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:56.733638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:56.849346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4633864b-b66a-4740-9c6f-9f6daaa0c374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b99e99a0>]}
[0m22:06:56.867438 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19145991, "process_user_time": 1.403833, "process_kernel_time": 0.106911, "process_mem_max_rss": "100512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:56.868003 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:56.867879 after 0.19 seconds
[0m22:06:56.868442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bac386e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bb619f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bc51df10>]}
[0m22:06:56.868857 [debug] [MainThread]: Flushing usage events
[0m06:02:12.706145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb14e0bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb133eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb0e89a60>]}


============================== 06:02:12.726430 | 8824977b-ac70-485b-8d8f-d683f5f8f728 ==============================
[0m06:02:12.726430 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.727120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.876498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8824977b-ac70-485b-8d8f-d683f5f8f728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb15fa9f0>]}
[0m06:02:12.891367 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hvyot6gu'
[0m06:02:12.891824 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:13.003811 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:13.004532 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:13.017442 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:13.021355 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:13.156749 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:13.157353 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:13.157878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8824977b-ac70-485b-8d8f-d683f5f8f728', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb0a39730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb0745400>]}
[0m06:02:13.158356 [info ] [MainThread]: 
[0m06:02:13.158826 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:13.189082 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5324954, "process_user_time": 1.540427, "process_kernel_time": 0.142316, "process_mem_max_rss": "101700", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m06:02:13.189699 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:13.189592 after 0.53 seconds
[0m06:02:13.190160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb0b57230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb089a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb0899c10>]}
[0m06:02:13.190587 [debug] [MainThread]: Flushing usage events
[0m06:02:14.887731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40653006e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4062d26990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4062d254c0>]}


============================== 06:02:14.890815 | f8f22515-10ee-4c69-b3c6-48e190e32336 ==============================
[0m06:02:14.890815 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.891518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:15.091280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406225e900>]}
[0m06:02:15.149353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e30c2c0>]}
[0m06:02:15.151983 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:15.203129 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:15.203850 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:15.204393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4062f660f0>]}
[0m06:02:16.493092 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:16.493696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e2cba40>]}
[0m06:02:16.725820 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:16.731406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40628b0d40>]}
[0m06:02:16.836617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e082a50>]}
[0m06:02:16.837201 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:16.837688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e14cc50>]}
[0m06:02:16.839534 [info ] [MainThread]: 
[0m06:02:16.840251 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:16.844992 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:16.879904 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:16.880381 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:16.880776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:17.349102 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.350896 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:17.351998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:17.352571 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:17.360586 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.361070 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:17.361475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.362426 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.363814 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.364282 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:17.364869 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.365320 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.365726 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:17.366411 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.367383 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.367830 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.368279 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.368943 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.369365 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:17.370692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:17.376310 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.376787 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:17.377170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.377748 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.378150 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.378516 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:17.388448 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.389859 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:17.391106 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:17.391496 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:17.393700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e18d850>]}
[0m06:02:17.394211 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.394589 [debug] [MainThread]: On master: BEGIN
[0m06:02:17.394959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:17.395576 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.395995 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.396357 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.396706 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.397248 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.397628 [debug] [MainThread]: On master: Close
[0m06:02:17.398155 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:17.398609 [info ] [MainThread]: 
[0m06:02:17.437159 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:17.437811 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:17.438448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:17.438900 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:17.465631 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:17.466421 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:17.501609 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:17.502387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:25.617075 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.617585 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:25.618298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.618742 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.619197 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:25.619937 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.622818 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.623282 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:25.624011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.640478 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:25.640958 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.641375 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:25.643627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.649246 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.649694 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:25.652665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.655000 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:25.656507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4064172570>]}
[0m06:02:25.657192 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.22s]
[0m06:02:25.658024 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:25.659041 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:25.659589 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:25.660207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:25.660638 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:25.665431 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:25.666061 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:25.701393 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.701913 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250719060225695434"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:25.702370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:25.710265 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.717786 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.718261 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:25.718862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.719320 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.719737 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250719060225695434'
      
      
      order by ordinal_position

  
[0m06:02:25.721829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.726866 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.727355 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:25.729372 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.736919 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.737368 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:25.739672 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.757519 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:25.758203 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.758650 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250719060225695434"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250719060225695434"
    )
  
[0m06:02:25.804872 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.806840 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:25.807316 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.807716 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:25.818264 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.819263 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:25.820620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8f22515-10ee-4c69-b3c6-48e190e32336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e0f3ad0>]}
[0m06:02:25.821309 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:25.822054 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:25.823614 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.824060 [debug] [MainThread]: On master: BEGIN
[0m06:02:25.824430 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:25.825102 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.825495 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.825858 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.826274 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.826777 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.827214 [debug] [MainThread]: On master: Close
[0m06:02:25.827834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:25.828232 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:25.828624 [info ] [MainThread]: 
[0m06:02:25.829149 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.99 seconds (8.99s).
[0m06:02:25.830166 [debug] [MainThread]: Command end result
[0m06:02:25.855646 [info ] [MainThread]: 
[0m06:02:25.856253 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:25.856759 [info ] [MainThread]: 
[0m06:02:25.857295 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:25.858258 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.019019, "process_user_time": 5.089155, "process_kernel_time": 0.286459, "process_mem_max_rss": "334628", "process_in_blocks": "1200", "process_out_blocks": "100120"}
[0m06:02:25.858791 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:25.858691 after 11.02 seconds
[0m06:02:25.859247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40637f1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4024f762d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406286e420>]}
[0m06:02:25.859663 [debug] [MainThread]: Flushing usage events
[0m06:02:27.614610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe74457ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe734f8ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7543d2e0>]}


============================== 06:02:27.617633 | 4658c28d-14d7-42c8-a855-5a0ee76b5054 ==============================
[0m06:02:27.617633 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:27.618283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.724263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4658c28d-14d7-42c8-a855-5a0ee76b5054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe736edd00>]}
[0m06:02:27.743152 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1769502, "process_user_time": 1.321576, "process_kernel_time": 0.113877, "process_mem_max_rss": "100920", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:27.743663 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:27.743563 after 0.18 seconds
[0m06:02:27.744113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe73454980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe77502c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe736edd00>]}
[0m06:02:27.744514 [debug] [MainThread]: Flushing usage events
[0m14:05:10.264568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3c5ad280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3bed05c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3bed3980>]}


============================== 14:05:10.316700 | 90b7fe62-e867-49e0-bd10-c004fbe7f67b ==============================
[0m14:05:10.316700 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:10.317347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:10.456173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90b7fe62-e867-49e0-bd10-c004fbe7f67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3b2d32f0>]}
[0m14:05:10.471463 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-h041nggy'
[0m14:05:10.471934 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:10.630922 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:10.631653 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:10.654826 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:10.658618 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:10.780536 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:10.781128 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:10.781662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '90b7fe62-e867-49e0-bd10-c004fbe7f67b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3b465820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3b464890>]}
[0m14:05:10.782146 [info ] [MainThread]: 
[0m14:05:10.782630 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:10.795261 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5797381, "process_user_time": 1.589572, "process_kernel_time": 0.134709, "process_mem_max_rss": "101500", "process_in_blocks": "8744", "process_out_blocks": "5168"}
[0m14:05:10.795818 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:10.795714 after 0.58 seconds
[0m14:05:10.796267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3c5ad280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3b5be6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3bac5a00>]}
[0m14:05:10.796676 [debug] [MainThread]: Flushing usage events
[0m14:05:12.350692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51d65e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51e4c0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51da33a70>]}


============================== 14:05:12.353815 | 4665dab8-8b02-4f51-91a9-20828500dbe3 ==============================
[0m14:05:12.353815 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:12.354483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:12.559350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51cecb140>]}
[0m14:05:12.618937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51d03e9c0>]}
[0m14:05:12.621624 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:05:12.712652 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:12.713452 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:12.713974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd518f9cad0>]}
[0m14:05:14.001291 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:14.001906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd518b07740>]}
[0m14:05:14.236604 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:14.242284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd518a6b050>]}
[0m14:05:14.342738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd518a6ee70>]}
[0m14:05:14.343341 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:05:14.343858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51dc39640>]}
[0m14:05:14.345759 [info ] [MainThread]: 
[0m14:05:14.346504 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:14.351297 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:14.386253 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:14.386731 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:14.387142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:14.888484 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:14.890439 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:14.891645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:14.892349 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:14.900461 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.900896 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:14.901297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:14.902363 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.903730 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.904141 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:14.904682 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.905088 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.905472 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:14.906048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.906988 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:14.907398 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.907764 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:14.908377 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.908773 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:14.910179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:14.916191 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:14.916592 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:14.916953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:14.917641 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.918022 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:14.918428 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:14.928109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.929562 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:14.930820 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:14.931261 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:14.933707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd518a97950>]}
[0m14:05:14.934231 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:14.934612 [debug] [MainThread]: On master: BEGIN
[0m14:05:14.934969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:14.935616 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:14.936009 [debug] [MainThread]: On master: COMMIT
[0m14:05:14.936415 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:14.936772 [debug] [MainThread]: On master: COMMIT
[0m14:05:14.937318 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:14.937705 [debug] [MainThread]: On master: Close
[0m14:05:14.938249 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:14.938706 [info ] [MainThread]: 
[0m14:05:14.971701 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:14.972363 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:14.972957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:14.973420 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:15.000636 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:15.001423 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:15.036959 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:15.037763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:26.649026 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.649548 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:26.650204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.650650 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.651089 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:26.651836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.654750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.655230 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:26.655941 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.672665 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:26.673146 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.673572 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:26.675415 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.681112 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.681565 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:05:26.682767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.685170 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:26.686691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51ed76150>]}
[0m14:05:26.687383 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.71s]
[0m14:05:26.688158 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:26.689130 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:26.689705 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:26.690307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:26.690739 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:26.695674 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:26.696347 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:26.732758 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.733304 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250719140526726675"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:26.733761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:26.741671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.749455 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.749908 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:26.750551 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.750983 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.751430 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250719140526726675'
      
      
      order by ordinal_position

  
[0m14:05:26.754295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.759494 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.759948 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:26.762401 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.770068 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.770532 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:26.773224 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.791367 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:26.792084 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.792546 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250719140526726675"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250719140526726675"
    )
  
[0m14:05:26.841935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.843950 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:26.844415 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.844825 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:26.851505 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.852422 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:26.853825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4665dab8-8b02-4f51-91a9-20828500dbe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4dabe3ef0>]}
[0m14:05:26.854510 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:05:26.855318 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:26.856594 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.856998 [debug] [MainThread]: On master: BEGIN
[0m14:05:26.857409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:26.858039 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.858464 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.858831 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.859235 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.859755 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.860174 [debug] [MainThread]: On master: Close
[0m14:05:26.860775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:26.861159 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:26.861557 [info ] [MainThread]: 
[0m14:05:26.862035 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.52 seconds (12.52s).
[0m14:05:26.863048 [debug] [MainThread]: Command end result
[0m14:05:26.889242 [info ] [MainThread]: 
[0m14:05:26.889864 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:26.890396 [info ] [MainThread]: 
[0m14:05:26.890917 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:26.891932 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.590472, "process_user_time": 5.157003, "process_kernel_time": 0.294885, "process_mem_max_rss": "332040", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m14:05:26.892521 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:26.892415 after 14.59 seconds
[0m14:05:26.892963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51d14d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4db546e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51dd99580>]}
[0m14:05:26.893426 [debug] [MainThread]: Flushing usage events
[0m14:05:28.643404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde116c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde2408dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde2ef1370>]}


============================== 14:05:28.646571 | 1828eeed-bcf6-4bf5-a87b-dfa59a804b66 ==============================
[0m14:05:28.646571 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:28.647231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:28.757158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1828eeed-bcf6-4bf5-a87b-dfa59a804b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde0dc81a0>]}
[0m14:05:28.775079 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18121606, "process_user_time": 1.361948, "process_kernel_time": 0.096066, "process_mem_max_rss": "100716", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:28.775615 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:28.775513 after 0.18 seconds
[0m14:05:28.776038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde06eed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde03e49e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde14ddbb0>]}
[0m14:05:28.776480 [debug] [MainThread]: Flushing usage events
[0m22:06:24.014864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1153a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde115cf560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1153b1a0>]}


============================== 22:06:24.033883 | 73c249ee-4d06-4818-8499-971c65101fb9 ==============================
[0m22:06:24.033883 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:24.034516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:24.176821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73c249ee-4d06-4818-8499-971c65101fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde12100da0>]}
[0m22:06:24.191986 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_4sc_z2e'
[0m22:06:24.192445 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:24.364100 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:24.364859 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:24.418814 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:24.422845 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:24.556356 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:24.556989 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:24.557596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '73c249ee-4d06-4818-8499-971c65101fb9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde10f72ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1113dd60>]}
[0m22:06:24.558054 [info ] [MainThread]: 
[0m22:06:24.558553 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:24.572923 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6074552, "process_user_time": 1.589422, "process_kernel_time": 0.139861, "process_mem_max_rss": "101580", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m22:06:24.573605 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:24.573469 after 0.61 seconds
[0m22:06:24.574070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde156d38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde11531070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde115cf5f0>]}
[0m22:06:24.574518 [debug] [MainThread]: Flushing usage events
[0m22:06:26.159861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed3326300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed385ed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed5e4d700>]}


============================== 22:06:26.163043 | b8835d8d-62a4-456e-9edb-f9938525552a ==============================
[0m22:06:26.163043 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:26.163703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:26.366678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecf101220>]}
[0m22:06:26.425910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed3b254c0>]}
[0m22:06:26.428753 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:26.503785 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:26.504548 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:26.505084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed30d7f50>]}
[0m22:06:27.809994 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:27.810656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecec709b0>]}
[0m22:06:28.048280 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:28.053789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed36e7560>]}
[0m22:06:28.162515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecec983e0>]}
[0m22:06:28.163104 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:28.163638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eced08860>]}
[0m22:06:28.165492 [info ] [MainThread]: 
[0m22:06:28.166218 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:28.170975 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:28.206508 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:28.207051 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:28.207450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:28.668298 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.670236 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:28.671367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:28.672146 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:28.680979 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:28.681472 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:28.681941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:28.683003 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.684514 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:28.684936 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:28.685503 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.685917 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:28.686284 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:28.686860 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.687780 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:28.688179 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:28.688542 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:28.689090 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.689481 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:28.690721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:28.696377 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:28.696894 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:28.697254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:28.697910 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.698302 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:28.698701 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:28.708842 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.710359 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:28.711631 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:28.712027 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:28.714287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ececd9c70>]}
[0m22:06:28.714821 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:28.715196 [debug] [MainThread]: On master: BEGIN
[0m22:06:28.715547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:28.716181 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:28.716593 [debug] [MainThread]: On master: COMMIT
[0m22:06:28.716983 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:28.717338 [debug] [MainThread]: On master: COMMIT
[0m22:06:28.717884 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:28.718277 [debug] [MainThread]: On master: Close
[0m22:06:28.718833 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:28.719319 [info ] [MainThread]: 
[0m22:06:28.744311 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:28.744986 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:28.745697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:28.746144 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:28.773503 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:28.774323 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:28.810112 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:28.811033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:37.749615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.750110 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:37.750781 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.751222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.751665 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:37.752373 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.755272 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.755729 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:37.756394 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.772978 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:37.773445 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.773888 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:37.776500 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.782147 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.782629 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:37.784041 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.786387 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:37.787940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed3cbc800>]}
[0m22:06:37.788644 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.04s]
[0m22:06:37.789449 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:37.790247 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:37.790824 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:37.791479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:37.791954 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:37.796927 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:37.797706 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:37.833584 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.834104 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250719220637827611"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:37.834562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:37.842484 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.849992 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.850485 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:37.851109 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.851541 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.851992 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250719220637827611'
      
      
      order by ordinal_position

  
[0m22:06:37.854153 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.859229 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.859702 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:37.861816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.869342 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.869813 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:37.872824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.890844 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:37.891546 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.892019 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250719220637827611"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250719220637827611"
    )
  
[0m22:06:37.940530 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.942489 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:37.942946 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.943355 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:37.950798 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.951693 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:37.953121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8835d8d-62a4-456e-9edb-f9938525552a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e95a19ca0>]}
[0m22:06:37.953810 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:06:37.954532 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:37.956132 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:37.956545 [debug] [MainThread]: On master: BEGIN
[0m22:06:37.956965 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:37.957632 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:37.958037 [debug] [MainThread]: On master: COMMIT
[0m22:06:37.958406 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:37.958810 [debug] [MainThread]: On master: COMMIT
[0m22:06:37.959323 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:37.959750 [debug] [MainThread]: On master: Close
[0m22:06:37.960324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:37.960718 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:37.961116 [info ] [MainThread]: 
[0m22:06:37.961591 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.80 seconds (9.80s).
[0m22:06:37.962532 [debug] [MainThread]: Command end result
[0m22:06:37.988234 [info ] [MainThread]: 
[0m22:06:37.988813 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:37.989262 [info ] [MainThread]: 
[0m22:06:37.989749 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:37.990686 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.880354, "process_user_time": 5.128582, "process_kernel_time": 0.283866, "process_mem_max_rss": "332004", "process_in_blocks": "1200", "process_out_blocks": "100144"}
[0m22:06:37.991226 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:37.991124 after 11.88 seconds
[0m22:06:37.991688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed323cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecefd47a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecec47e90>]}
[0m22:06:37.992127 [debug] [MainThread]: Flushing usage events
[0m22:06:39.806811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ad011eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68adbfdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ad013800>]}


============================== 22:06:39.809880 | 7bc49c46-d569-40e6-8673-de9fe6900624 ==============================
[0m22:06:39.809880 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:39.810538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:39.918459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bc49c46-d569-40e6-8673-de9fe6900624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68acf328a0>]}
[0m22:06:39.936205 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17889763, "process_user_time": 1.324481, "process_kernel_time": 0.111956, "process_mem_max_rss": "100644", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:39.936765 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:39.936660 after 0.18 seconds
[0m22:06:39.937188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68add68c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68b1103c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68acec9910>]}
[0m22:06:39.937628 [debug] [MainThread]: Flushing usage events
[0m06:02:27.287073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06c6adcb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06c5c8c2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06c4ef63f0>]}


============================== 06:02:27.301760 | 19451af1-8dda-4daa-b682-156b1bf15528 ==============================
[0m06:02:27.301760 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:27.302467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.457433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19451af1-8dda-4daa-b682-156b1bf15528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06c4937c20>]}
[0m06:02:27.472522 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tkl9655f'
[0m06:02:27.472991 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:27.598952 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:27.599558 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:27.622095 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:27.625928 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:27.699505 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:27.700090 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:27.700648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '19451af1-8dda-4daa-b682-156b1bf15528', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06c53da330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06c5b08200>]}
[0m06:02:27.701090 [info ] [MainThread]: 
[0m06:02:27.701603 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:27.710559 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47508118, "process_user_time": 1.584294, "process_kernel_time": 0.133687, "process_mem_max_rss": "101840", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m06:02:27.711132 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:27.711027 after 0.48 seconds
[0m06:02:27.711551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06c4ed8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06c4805940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06c48058b0>]}
[0m06:02:27.711991 [debug] [MainThread]: Flushing usage events
[0m06:02:29.243618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb947a33e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb947bc81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb947bc8350>]}


============================== 06:02:29.246645 | c4f87814-05f9-41a5-b8bc-86134e6d7121 ==============================
[0m06:02:29.246645 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:29.247292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:29.448711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb946fbcb30>]}
[0m06:02:29.510395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb946fe4590>]}
[0m06:02:29.512985 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:29.555061 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:29.555779 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:29.556290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb946e4a480>]}
[0m06:02:30.851878 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:30.852514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb942dfb680>]}
[0m06:02:31.083016 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:31.088536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb948119370>]}
[0m06:02:31.190026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb942e99be0>]}
[0m06:02:31.190524 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:31.191021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb942ed4470>]}
[0m06:02:31.192807 [info ] [MainThread]: 
[0m06:02:31.193449 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:31.198018 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:31.232494 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:31.232943 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:31.233321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:31.726839 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.729033 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:31.730290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:31.731078 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:31.739049 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.739462 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:31.739867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:31.740951 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.742283 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.742702 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:31.743255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.743667 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.744034 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:31.744633 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.745624 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:31.746011 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.746370 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:31.746910 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.747318 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:31.748541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:31.754183 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:31.754603 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:31.754973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:31.755594 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.755986 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:31.756355 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:31.766209 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.767668 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:31.768904 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:31.769307 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:31.771370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb948edd010>]}
[0m06:02:31.771897 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:31.772271 [debug] [MainThread]: On master: BEGIN
[0m06:02:31.772651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:31.773250 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:31.773677 [debug] [MainThread]: On master: COMMIT
[0m06:02:31.774043 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:31.774393 [debug] [MainThread]: On master: COMMIT
[0m06:02:31.774926 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:31.775303 [debug] [MainThread]: On master: Close
[0m06:02:31.775842 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:31.776293 [info ] [MainThread]: 
[0m06:02:31.793713 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:31.794293 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:31.794870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:31.795294 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:31.825120 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:31.825897 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:31.862750 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:31.863491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:38.938105 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.938623 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:38.939279 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.939745 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.940163 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:38.940932 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.943878 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.944314 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:38.945006 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.961548 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.962045 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.962458 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.965140 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.970913 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.971361 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:38.973013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.975312 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:38.976867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9418cbbc0>]}
[0m06:02:38.977540 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.18s]
[0m06:02:38.978286 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:38.979268 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:38.979839 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:38.980386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:38.980841 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:38.985726 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:38.986338 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:39.021829 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.022324 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250720060239015822"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:39.022809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:39.030674 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.038331 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.038825 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:39.039437 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.039923 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.040356 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250720060239015822'
      
      
      order by ordinal_position

  
[0m06:02:39.042528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.047633 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.048089 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:39.050515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.058064 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.058518 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:39.060651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.078780 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:39.079481 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.079958 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250720060239015822"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250720060239015822"
    )
  
[0m06:02:39.129700 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.131694 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:39.132158 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.132606 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:39.139926 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.140821 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:39.142217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4f87814-05f9-41a5-b8bc-86134e6d7121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb908cc4d40>]}
[0m06:02:39.142945 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:39.143714 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:39.145228 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:39.145657 [debug] [MainThread]: On master: BEGIN
[0m06:02:39.146032 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:39.146653 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:39.147042 [debug] [MainThread]: On master: COMMIT
[0m06:02:39.147412 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:39.147814 [debug] [MainThread]: On master: COMMIT
[0m06:02:39.148341 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:39.148760 [debug] [MainThread]: On master: Close
[0m06:02:39.149329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:39.149717 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:39.150108 [info ] [MainThread]: 
[0m06:02:39.150553 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.96 seconds (7.96s).
[0m06:02:39.151471 [debug] [MainThread]: Command end result
[0m06:02:39.176998 [info ] [MainThread]: 
[0m06:02:39.177539 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:39.178012 [info ] [MainThread]: 
[0m06:02:39.178469 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:39.179371 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.984565, "process_user_time": 5.072741, "process_kernel_time": 0.311229, "process_mem_max_rss": "335656", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:39.179936 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:39.179834 after 9.99 seconds
[0m06:02:39.180354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb947a33e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb908cc4d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb947579fa0>]}
[0m06:02:39.180794 [debug] [MainThread]: Flushing usage events
[0m06:02:40.985197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a9c1a4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a8ef0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80aa9392b0>]}


============================== 06:02:40.988248 | ca9364bb-1798-471d-9063-a79657b48aad ==============================
[0m06:02:40.988248 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:40.988966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:41.097775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca9364bb-1798-471d-9063-a79657b48aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80aa5772c0>]}
[0m06:02:41.116079 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18037224, "process_user_time": 1.392083, "process_kernel_time": 0.094937, "process_mem_max_rss": "100688", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:41.116659 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:41.116521 after 0.18 seconds
[0m06:02:41.117088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a8d2c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a8863080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80aa7d43b0>]}
[0m06:02:41.117515 [debug] [MainThread]: Flushing usage events
[0m14:05:24.209425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d1be25700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d198a5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d198a7ce0>]}


============================== 14:05:24.259199 | 22c50b9a-d17a-40ec-bdfc-aa4bd101c44d ==============================
[0m14:05:24.259199 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:24.259866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:24.420966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22c50b9a-d17a-40ec-bdfc-aa4bd101c44d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d1a200980>]}
[0m14:05:24.436231 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4runmtv1'
[0m14:05:24.436704 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:24.645437 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:24.646202 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:24.779281 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:24.783248 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:24.994516 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:24.995121 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:24.995672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '22c50b9a-d17a-40ec-bdfc-aa4bd101c44d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d18fa4680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d196f0350>]}
[0m14:05:24.996171 [info ] [MainThread]: 
[0m14:05:24.996657 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:25.026882 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.86659926, "process_user_time": 1.565227, "process_kernel_time": 0.156022, "process_mem_max_rss": "101740", "process_in_blocks": "8744", "process_out_blocks": "5168"}
[0m14:05:25.027563 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:25.027447 after 0.87 seconds
[0m14:05:25.028012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d1cfcf0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d196cff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d19d41160>]}
[0m14:05:25.028473 [debug] [MainThread]: Flushing usage events
[0m14:05:26.727849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c36d13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c396f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c2cb1c40>]}


============================== 14:05:26.730979 | a086fa8c-2ebc-4401-a2df-0636ca270fd2 ==============================
[0m14:05:26.730979 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:26.731664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:26.936557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c2e566c0>]}
[0m14:05:26.995988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c45cce90>]}
[0m14:05:26.998727 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:05:27.094527 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:27.095304 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:27.095835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7be716330>]}
[0m14:05:28.383281 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:28.383958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c26cccb0>]}
[0m14:05:28.616151 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:28.621570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c32b6450>]}
[0m14:05:28.725564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7be23e030>]}
[0m14:05:28.726152 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:05:28.726662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7be238ad0>]}
[0m14:05:28.728530 [info ] [MainThread]: 
[0m14:05:28.729260 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:28.733881 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:28.768713 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:28.769203 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:28.769597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:29.360538 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:29.362607 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:29.363816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:29.364674 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:29.374646 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:29.375066 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:29.375486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:29.376377 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:29.377703 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:29.378105 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:29.378652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:29.379037 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:29.379429 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:29.380038 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:29.380981 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:29.381391 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:29.381753 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:29.382295 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:29.382688 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:29.384060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:29.389803 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:29.390311 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:29.390669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:29.391268 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:29.391651 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:29.392022 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:29.401722 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:29.403178 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:29.404401 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:29.404792 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:29.407122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c2d21760>]}
[0m14:05:29.407633 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:29.408014 [debug] [MainThread]: On master: BEGIN
[0m14:05:29.408403 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:29.409006 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:29.409429 [debug] [MainThread]: On master: COMMIT
[0m14:05:29.409799 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:29.410178 [debug] [MainThread]: On master: COMMIT
[0m14:05:29.410755 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:29.411180 [debug] [MainThread]: On master: Close
[0m14:05:29.411711 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:29.412206 [info ] [MainThread]: 
[0m14:05:29.471075 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:29.471719 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:29.472406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:29.472853 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:29.499737 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:29.500498 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:29.535489 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:29.536237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:38.926777 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.927323 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:38.928009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.928479 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.928899 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:38.929674 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.932756 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.933216 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:38.933951 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.950699 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:38.951211 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.951638 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:38.953666 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.959558 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.960020 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:05:38.961384 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.963830 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:38.965400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bd017500>]}
[0m14:05:38.966106 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.49s]
[0m14:05:38.966937 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:38.967929 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:38.968532 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:38.969138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:38.969585 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:38.974779 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:38.975473 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:39.012323 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.012887 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250720140539006209"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:39.013373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:39.021475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.029553 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.030022 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:39.030690 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.031142 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.031573 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250720140539006209'
      
      
      order by ordinal_position

  
[0m14:05:39.033844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.039128 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.039588 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:39.041718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.049496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.049955 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:39.052794 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.070794 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:39.071530 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.071981 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250720140539006209"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250720140539006209"
    )
  
[0m14:05:39.119964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.122002 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:39.122474 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.122893 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:39.130227 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.131144 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:39.132588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a086fa8c-2ebc-4401-a2df-0636ca270fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa784a64230>]}
[0m14:05:39.133278 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:05:39.134009 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:39.135389 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.135805 [debug] [MainThread]: On master: BEGIN
[0m14:05:39.136219 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:39.136868 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.137308 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.137679 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.138035 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.138591 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.138975 [debug] [MainThread]: On master: Close
[0m14:05:39.139676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:39.140042 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:39.140491 [info ] [MainThread]: 
[0m14:05:39.140983 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.41 seconds (10.41s).
[0m14:05:39.141970 [debug] [MainThread]: Command end result
[0m14:05:39.168055 [info ] [MainThread]: 
[0m14:05:39.168714 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:39.169239 [info ] [MainThread]: 
[0m14:05:39.169738 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:39.170750 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.491492, "process_user_time": 5.229597, "process_kernel_time": 0.302074, "process_mem_max_rss": "340760", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m14:05:39.171337 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:39.171227 after 12.49 seconds
[0m14:05:39.171779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c36d13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ac064f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c2cdec30>]}
[0m14:05:39.172237 [debug] [MainThread]: Flushing usage events
[0m14:05:41.023760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e8509d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e8d254c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e8509cd0>]}


============================== 14:05:41.026938 | 11f0bb56-716b-400a-9f6a-1d1d17da6ae9 ==============================
[0m14:05:41.026938 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:41.027593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:41.134900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11f0bb56-716b-400a-9f6a-1d1d17da6ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44eb00d670>]}
[0m14:05:41.152705 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17842655, "process_user_time": 1.336077, "process_kernel_time": 0.116919, "process_mem_max_rss": "100544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:41.153299 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:41.153192 after 0.18 seconds
[0m14:05:41.153727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44ec7bb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e831b080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44eb00d670>]}
[0m14:05:41.154171 [debug] [MainThread]: Flushing usage events
[0m22:06:18.231855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7049fff830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704ab00f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704a93cc20>]}


============================== 22:06:18.246790 | 3a684d8d-3dda-4f70-9ae4-b746c2829900 ==============================
[0m22:06:18.246790 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:18.247468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:18.403763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a684d8d-3dda-4f70-9ae4-b746c2829900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7049fa7710>]}
[0m22:06:18.419244 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6989n0_6'
[0m22:06:18.419733 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:18.513878 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:18.514509 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:18.543285 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:18.547150 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:18.615357 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:18.615931 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:18.616436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3a684d8d-3dda-4f70-9ae4-b746c2829900', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7049d5c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7049e56630>]}
[0m22:06:18.616906 [info ] [MainThread]: 
[0m22:06:18.617360 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:18.624911 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44209832, "process_user_time": 1.570802, "process_kernel_time": 0.137507, "process_mem_max_rss": "101580", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m22:06:18.625459 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:18.625350 after 0.44 seconds
[0m22:06:18.625898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704a131f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704a161700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7049e303e0>]}
[0m22:06:18.626305 [debug] [MainThread]: Flushing usage events
[0m22:06:20.185059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07af192960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07af003800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07aeae9bb0>]}


============================== 22:06:20.188180 | a6da7761-422b-4435-a900-42ffcb640fe3 ==============================
[0m22:06:20.188180 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:20.188831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:20.389212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ae71c710>]}
[0m22:06:20.447996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ae566cc0>]}
[0m22:06:20.450744 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:20.473589 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:20.474346 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:20.474880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ae4e33b0>]}
[0m22:06:21.769261 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:21.769900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07aa3f6f90>]}
[0m22:06:22.000876 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:22.006491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07aa35f230>]}
[0m22:06:22.102406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07aa3f4e30>]}
[0m22:06:22.102990 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:22.103469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07aa3c7c80>]}
[0m22:06:22.105307 [info ] [MainThread]: 
[0m22:06:22.106013 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:22.110728 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:22.145363 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:22.145813 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:22.146200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:22.656047 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:22.657732 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:22.658686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:22.659273 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:22.666839 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:22.667258 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:22.667628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:22.668596 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:22.670273 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:22.670680 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:22.671228 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:22.671602 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:22.671989 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:22.672593 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:22.673518 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:22.673924 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:22.674282 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:22.674819 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:22.675210 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:22.676464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:22.682282 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:22.682789 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:22.683149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:22.683757 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:22.684141 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:22.684510 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:22.694241 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:22.695701 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:22.696972 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:22.697364 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:22.699546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07aa456f00>]}
[0m22:06:22.700065 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:22.700433 [debug] [MainThread]: On master: BEGIN
[0m22:06:22.700810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:22.701397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:22.701819 [debug] [MainThread]: On master: COMMIT
[0m22:06:22.702177 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:22.702524 [debug] [MainThread]: On master: COMMIT
[0m22:06:22.703043 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:22.703421 [debug] [MainThread]: On master: Close
[0m22:06:22.703944 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:22.704399 [info ] [MainThread]: 
[0m22:06:22.721934 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:22.722514 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:22.723090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:22.723513 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:22.750117 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:22.750869 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:22.786116 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:22.786865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:30.362657 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.363182 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:30.363821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.364249 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.364657 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:30.365412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.368329 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.368785 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:30.369481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.386047 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:30.386510 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.386954 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:30.388445 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.394045 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.394490 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:30.395656 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.398003 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:30.399529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b045a510>]}
[0m22:06:30.400207 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.68s]
[0m22:06:30.400952 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:30.401773 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:30.402340 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:30.403160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:30.403614 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:30.408491 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:30.409160 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:30.445181 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.445689 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250720220630439218"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:30.446145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:30.454060 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.461610 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.462085 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:30.462687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.463119 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.463528 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250720220630439218'
      
      
      order by ordinal_position

  
[0m22:06:30.465739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.470869 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.471323 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:30.473564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.481152 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.481603 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:30.484480 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.502865 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:30.503606 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.504088 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250720220630439218"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250720220630439218"
    )
  
[0m22:06:30.552198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.554205 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:30.554646 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.555078 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:30.561853 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.562758 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:30.564295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6da7761-422b-4435-a900-42ffcb640fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f076bf45be0>]}
[0m22:06:30.564993 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:06:30.565742 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:30.567397 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:30.567840 [debug] [MainThread]: On master: BEGIN
[0m22:06:30.568212 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:30.568856 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:30.569249 [debug] [MainThread]: On master: COMMIT
[0m22:06:30.569614 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:30.570022 [debug] [MainThread]: On master: COMMIT
[0m22:06:30.570536 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:30.570953 [debug] [MainThread]: On master: Close
[0m22:06:30.571503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:30.571900 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:30.572290 [info ] [MainThread]: 
[0m22:06:30.572805 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.47 seconds (8.47s).
[0m22:06:30.573801 [debug] [MainThread]: Command end result
[0m22:06:30.599805 [info ] [MainThread]: 
[0m22:06:30.600420 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:30.600948 [info ] [MainThread]: 
[0m22:06:30.601473 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:30.602471 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.466354, "process_user_time": 5.130023, "process_kernel_time": 0.284333, "process_mem_max_rss": "338804", "process_in_blocks": "1200", "process_out_blocks": "100144"}
[0m22:06:30.603036 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:30.602932 after 10.47 seconds
[0m22:06:30.603461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07af444470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07af9c1520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07aeb72a80>]}
[0m22:06:30.603910 [debug] [MainThread]: Flushing usage events
[0m22:06:32.419361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86b6a8e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86b271bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86b271b50>]}


============================== 22:06:32.422632 | 72687c22-f956-48e3-aa3b-a15afbf0e61e ==============================
[0m22:06:32.422632 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:32.423334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:32.531634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72687c22-f956-48e3-aa3b-a15afbf0e61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86b05d550>]}
[0m22:06:32.550228 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18074957, "process_user_time": 1.362476, "process_kernel_time": 0.106958, "process_mem_max_rss": "100788", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:32.550802 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:32.550692 after 0.18 seconds
[0m22:06:32.551249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86b63aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86b5c3b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86b102d50>]}
[0m22:06:32.551699 [debug] [MainThread]: Flushing usage events
[0m06:02:41.497685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3f687c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3f2aa060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3f2a9fd0>]}


============================== 06:02:41.506069 | 18e76510-15f8-45bc-a310-cbcde51bc8d8 ==============================
[0m06:02:41.506069 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:41.506756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:41.641031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18e76510-15f8-45bc-a310-cbcde51bc8d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3f0d2d50>]}
[0m06:02:41.655487 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-27c66375'
[0m06:02:41.655917 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:41.692589 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:41.693173 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:41.705314 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:41.709088 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:41.761653 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:41.762153 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:41.762672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '18e76510-15f8-45bc-a310-cbcde51bc8d8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3f4a0b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3f28c740>]}
[0m06:02:41.763092 [info ] [MainThread]: 
[0m06:02:41.763577 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:41.774258 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3253592, "process_user_time": 1.534808, "process_kernel_time": 0.140165, "process_mem_max_rss": "101460", "process_in_blocks": "8744", "process_out_blocks": "5168"}
[0m06:02:41.774813 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:41.774711 after 0.33 seconds
[0m06:02:41.775213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e40e35100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3f2ed670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3f2ed820>]}
[0m06:02:41.775660 [debug] [MainThread]: Flushing usage events
[0m06:02:43.298749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f7add4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f77758e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f7775850>]}


============================== 06:02:43.301791 | c1bbb735-86af-4f32-9864-c086c853bb63 ==============================
[0m06:02:43.301791 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:43.302446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:43.504846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f754aff0>]}
[0m06:02:43.564026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f76f3140>]}
[0m06:02:43.566544 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:43.582218 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:43.582945 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:43.583484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f74d4800>]}
[0m06:02:44.872565 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:44.873183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f354dac0>]}
[0m06:02:45.099044 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:45.104404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0fb52a630>]}
[0m06:02:45.203957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f33edf10>]}
[0m06:02:45.204460 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:45.204936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f34db470>]}
[0m06:02:45.206739 [info ] [MainThread]: 
[0m06:02:45.207391 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:45.215018 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:45.249498 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:45.249926 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:45.250301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:45.732310 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:45.733955 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:45.735007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:45.735586 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:45.743068 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:45.743506 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:45.743885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:45.744935 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:45.746265 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:45.746671 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:45.747239 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:45.747639 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:45.747999 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:45.748605 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:45.749530 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:45.749918 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:45.750278 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:45.750878 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:45.751270 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:45.752508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:45.758258 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:45.758766 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:45.759125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:45.759730 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:45.760112 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:45.760502 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:45.770634 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:45.772062 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:45.773290 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:45.773700 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:45.775913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f94c9460>]}
[0m06:02:45.776407 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:45.776827 [debug] [MainThread]: On master: BEGIN
[0m06:02:45.777187 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:45.777814 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:45.778208 [debug] [MainThread]: On master: COMMIT
[0m06:02:45.778616 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:45.778977 [debug] [MainThread]: On master: COMMIT
[0m06:02:45.779515 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:45.779905 [debug] [MainThread]: On master: Close
[0m06:02:45.780415 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:45.780928 [info ] [MainThread]: 
[0m06:02:45.800453 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:45.801024 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:45.801656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:45.802086 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:45.828279 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:45.829020 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:45.864183 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:45.864915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:53.124735 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:53.125215 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:53.125894 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.126320 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:53.126771 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:53.127509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.130375 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:53.130830 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:53.131520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.148173 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:53.148664 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:53.149080 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:53.150201 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.155817 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:53.156266 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:53.157521 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.159826 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:53.161339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f1ec12e0>]}
[0m06:02:53.162036 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.36s]
[0m06:02:53.162791 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:53.163602 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:53.164318 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:53.164997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:53.165462 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:53.170336 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:53.170984 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:53.207116 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:53.207616 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250721060253200984"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:53.208062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:53.215798 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.223188 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:53.223688 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:53.224292 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.224755 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:53.225173 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250721060253200984'
      
      
      order by ordinal_position

  
[0m06:02:53.227294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.232374 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:53.232847 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:53.235750 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.243321 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:53.243801 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:53.246470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.264588 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:53.265232 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:53.265705 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250721060253200984"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250721060253200984"
    )
  
[0m06:02:53.315764 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.317801 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:53.318263 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:53.318697 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:53.325587 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:53.326483 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:53.327887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1bbb735-86af-4f32-9864-c086c853bb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b8e83380>]}
[0m06:02:53.328584 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:53.329376 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:53.330970 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:53.331388 [debug] [MainThread]: On master: BEGIN
[0m06:02:53.331810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:53.332489 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:53.332890 [debug] [MainThread]: On master: COMMIT
[0m06:02:53.333255 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:53.333653 [debug] [MainThread]: On master: COMMIT
[0m06:02:53.334178 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:53.334598 [debug] [MainThread]: On master: Close
[0m06:02:53.335170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:53.335571 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:53.335977 [info ] [MainThread]: 
[0m06:02:53.336470 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.13 seconds (8.13s).
[0m06:02:53.337397 [debug] [MainThread]: Command end result
[0m06:02:53.364252 [info ] [MainThread]: 
[0m06:02:53.364830 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:53.365299 [info ] [MainThread]: 
[0m06:02:53.365809 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:53.366779 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.117566, "process_user_time": 5.074878, "process_kernel_time": 0.279378, "process_mem_max_rss": "336576", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m06:02:53.367310 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:53.367209 after 10.12 seconds
[0m06:02:53.367761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f7777950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f339a300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f3346a50>]}
[0m06:02:53.368180 [debug] [MainThread]: Flushing usage events
[0m06:02:55.068138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eff8d80b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f01825100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f00d39190>]}


============================== 06:02:55.071172 | 98959fd1-3017-4535-a022-9c0ae4afc61e ==============================
[0m06:02:55.071172 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:55.071885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:55.178805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98959fd1-3017-4535-a022-9c0ae4afc61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9effdd32f0>]}
[0m06:02:55.196291 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17687203, "process_user_time": 1.298605, "process_kernel_time": 0.126961, "process_mem_max_rss": "100700", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:55.196813 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:55.196714 after 0.18 seconds
[0m06:02:55.197214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eff8d80b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9efebc16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9efea77ec0>]}
[0m06:02:55.197650 [debug] [MainThread]: Flushing usage events
[0m14:06:56.518104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748e238800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7490340500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7490343e30>]}


============================== 14:06:56.532831 | 72255d6d-6a4a-4ca0-95dd-bb07934956dd ==============================
[0m14:06:56.532831 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:56.533455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:56.668856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72255d6d-6a4a-4ca0-95dd-bb07934956dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748f4597c0>]}
[0m14:06:56.683847 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0n904i0j'
[0m14:06:56.684318 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:56.790742 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:56.791356 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:56.803823 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:56.807657 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:56.865739 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:56.866230 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:06:56.866762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '72255d6d-6a4a-4ca0-95dd-bb07934956dd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748df466c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748df455b0>]}
[0m14:06:56.867205 [info ] [MainThread]: 
[0m14:06:56.867686 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:56.875398 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40629652, "process_user_time": 1.539808, "process_kernel_time": 0.139617, "process_mem_max_rss": "101524", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m14:06:56.875972 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:56.875869 after 0.41 seconds
[0m14:06:56.876388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74925bb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7490340500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748e1e7410>]}
[0m14:06:56.876818 [debug] [MainThread]: Flushing usage events
[0m14:06:58.438052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c25ecb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bfe64b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bfaacd40>]}


============================== 14:06:58.441186 | 2d8f9390-0d22-4252-8bea-09ea28a0afff ==============================
[0m14:06:58.441186 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:58.441859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:58.643196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bfe64560>]}
[0m14:06:58.702323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bfaad5b0>]}
[0m14:06:58.704948 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:06:58.727440 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:58.728161 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:58.728692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bf846db0>]}
[0m14:07:00.015161 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:07:00.015911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bb9f0890>]}
[0m14:07:00.245430 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:07:00.250857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c27ab680>]}
[0m14:07:00.348097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bb633920>]}
[0m14:07:00.348649 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:07:00.349156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c03328a0>]}
[0m14:07:00.350962 [info ] [MainThread]: 
[0m14:07:00.351667 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:07:00.356335 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:07:00.390840 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:07:00.391271 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:07:00.391678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:00.686905 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.688789 [debug] [ThreadPool]: On list_petro: Close
[0m14:07:00.689880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:07:00.690589 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:07:00.699129 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:00.699569 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:07:00.699952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:00.700844 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.702152 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:00.702563 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:07:00.703172 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.703575 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:00.703949 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:07:00.704506 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.705430 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:00.705831 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:00.706192 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:00.706754 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.707151 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:07:00.708378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:07:00.714085 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:00.714484 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:07:00.714879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:00.715459 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.715872 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:00.716243 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:07:00.725885 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.727299 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:07:00.728540 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:07:00.728931 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:07:00.731049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85ba1bb950>]}
[0m14:07:00.731554 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:00.731938 [debug] [MainThread]: On master: BEGIN
[0m14:07:00.732289 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:00.732914 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:00.733306 [debug] [MainThread]: On master: COMMIT
[0m14:07:00.733695 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:00.734051 [debug] [MainThread]: On master: COMMIT
[0m14:07:00.734574 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:00.734958 [debug] [MainThread]: On master: Close
[0m14:07:00.735474 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:07:00.735960 [info ] [MainThread]: 
[0m14:07:00.754673 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:07:00.755256 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:07:00.755827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:07:00.756258 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:07:00.782761 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:07:00.783491 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:07:00.818740 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:07:00.819469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:07.479817 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:07.480297 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:07:07.480980 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.481415 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:07.481858 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:07:07.482749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.485661 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:07.486102 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:07:07.486843 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.503569 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:07.504038 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:07.504462 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:07.506383 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.512053 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:07.512508 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:07:07.513721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.516089 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:07:07.517648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c176a510>]}
[0m14:07:07.518321 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.76s]
[0m14:07:07.519156 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:07:07.519970 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:07:07.520553 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:07:07.521129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:07:07.521599 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:07:07.526555 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:07:07.527343 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:07:07.562884 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:07.563372 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250721140707556877"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:07:07.563858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:07.571597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.579064 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:07.579513 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:07:07.580124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.580621 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:07.581050 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250721140707556877'
      
      
      order by ordinal_position

  
[0m14:07:07.583133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.588218 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:07.588721 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:07.590847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.598462 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:07.598945 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:07.601804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.619890 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:07:07.620586 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:07.621036 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250721140707556877"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250721140707556877"
    )
  
[0m14:07:07.667079 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.669109 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:07.669570 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:07.669990 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:07.677479 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:07.678389 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:07:07.679867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d8f9390-0d22-4252-8bea-09ea28a0afff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8581562300>]}
[0m14:07:07.680563 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:07:07.681290 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:07:07.682781 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:07.683191 [debug] [MainThread]: On master: BEGIN
[0m14:07:07.683586 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:07.684220 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:07.684643 [debug] [MainThread]: On master: COMMIT
[0m14:07:07.685019 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:07.685375 [debug] [MainThread]: On master: COMMIT
[0m14:07:07.685957 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:07.686358 [debug] [MainThread]: On master: Close
[0m14:07:07.687051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:07.687434 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:07:07.687851 [info ] [MainThread]: 
[0m14:07:07.688368 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.34 seconds (7.34s).
[0m14:07:07.689363 [debug] [MainThread]: Command end result
[0m14:07:07.715044 [info ] [MainThread]: 
[0m14:07:07.715650 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:07.716165 [info ] [MainThread]: 
[0m14:07:07.716707 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:07:07.717700 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.328408, "process_user_time": 4.907365, "process_kernel_time": 0.266748, "process_mem_max_rss": "337044", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m14:07:07.718237 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:07.718135 after 9.33 seconds
[0m14:07:07.718699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c25ecb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bf9cbbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bb6db080>]}
[0m14:07:07.719137 [debug] [MainThread]: Flushing usage events
[0m14:07:09.526930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4223055b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb421379280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb422d9d7c0>]}


============================== 14:07:09.530136 | cfbebc33-324d-48ac-99f2-559c4d4a3d0c ==============================
[0m14:07:09.530136 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:09.530827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:07:09.638151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfbebc33-324d-48ac-99f2-559c4d4a3d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb420191220>]}
[0m14:07:09.656071 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17862368, "process_user_time": 1.356323, "process_kernel_time": 0.113943, "process_mem_max_rss": "100800", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:07:09.656629 [debug] [MainThread]: Command `dbt clean` succeeded at 14:07:09.656505 after 0.18 seconds
[0m14:07:09.657053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4207f2a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4202bf5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb422b043b0>]}
[0m14:07:09.657468 [debug] [MainThread]: Flushing usage events
[0m22:06:55.890704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ebde5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7eb794c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ebd7b5f0>]}


============================== 22:06:55.908920 | 2561b5ee-4deb-45ae-9fbb-d985842769a7 ==============================
[0m22:06:55.908920 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:55.909585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:56.051310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2561b5ee-4deb-45ae-9fbb-d985842769a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7eb1e32f0>]}
[0m22:06:56.066597 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-gut2vasg'
[0m22:06:56.067095 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:56.250232 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:56.250959 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:56.272650 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:56.276446 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:56.360499 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:56.361069 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:56.361608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2561b5ee-4deb-45ae-9fbb-d985842769a7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7eb35b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7eb3b74d0>]}
[0m22:06:56.362068 [info ] [MainThread]: 
[0m22:06:56.362558 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:56.376002 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5358914, "process_user_time": 1.583091, "process_kernel_time": 0.137354, "process_mem_max_rss": "101432", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m22:06:56.376569 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:56.376464 after 0.54 seconds
[0m22:06:56.377002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7eb5655b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7eb0ab080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ef0cf0b0>]}
[0m22:06:56.377436 [debug] [MainThread]: Flushing usage events
[0m22:06:57.948208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe009bcca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00a96c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00b9f8260>]}


============================== 22:06:57.951303 | bec8f2c9-156a-4825-8ee4-4fecc2792119 ==============================
[0m22:06:57.951303 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:57.952011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:58.154490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0098aee70>]}
[0m22:06:58.214232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe009b2a120>]}
[0m22:06:58.216933 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:58.243118 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:58.243874 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:58.244422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0098af8f0>]}
[0m22:06:59.540522 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:59.541177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0098a8c50>]}
[0m22:06:59.773179 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:59.778906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00574baa0>]}
[0m22:06:59.887451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0057e5c40>]}
[0m22:06:59.888026 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:59.888531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0058ddbb0>]}
[0m22:06:59.890411 [info ] [MainThread]: 
[0m22:06:59.891086 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:59.895955 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:59.931782 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:59.932295 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:59.932711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:00.436576 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:07:00.438701 [debug] [ThreadPool]: On list_petro: Close
[0m22:07:00.440001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:07:00.440704 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:07:00.448943 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:00.449420 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:07:00.449852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:00.450908 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:00.452417 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:00.452869 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:07:00.453583 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:00.454058 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:00.454449 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:07:00.455035 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:00.455995 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:00.456409 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:00.456890 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:00.457626 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:00.458133 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:07:00.459654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:07:00.465569 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:00.466062 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:07:00.466448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:00.467094 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:00.467519 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:00.467895 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:07:00.477867 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:00.479352 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:07:00.480619 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:07:00.481017 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:07:00.483189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0057d6330>]}
[0m22:07:00.483711 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:00.484085 [debug] [MainThread]: On master: BEGIN
[0m22:07:00.484462 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:00.485070 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:00.485487 [debug] [MainThread]: On master: COMMIT
[0m22:07:00.485858 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:00.486213 [debug] [MainThread]: On master: COMMIT
[0m22:07:00.486770 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:00.487152 [debug] [MainThread]: On master: Close
[0m22:07:00.487698 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:07:00.488187 [info ] [MainThread]: 
[0m22:07:00.526254 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:07:00.526934 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:07:00.527636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:07:00.528079 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:07:00.554903 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:07:00.555744 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:07:00.590752 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:07:00.591634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:08.651904 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:08.652433 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:08.653093 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.653562 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:08.653976 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:08.654710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.657637 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:08.658082 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:08.658766 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.675419 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:08.675884 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:08.676303 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:08.677861 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.683495 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:08.683947 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:08.685178 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.687532 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:08.689066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00b87e120>]}
[0m22:07:08.689844 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.16s]
[0m22:07:08.690675 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:08.691654 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:08.692203 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:08.692851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:08.693285 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:08.698202 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:08.698887 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:08.734404 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:08.734945 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250721220708728355"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:08.735417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:08.743275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.750949 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:08.751422 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:08.752063 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.752525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:08.752959 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250721220708728355'
      
      
      order by ordinal_position

  
[0m22:07:08.755187 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.760402 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:08.760858 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:08.763227 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.770857 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:08.771314 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:08.773368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.791407 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:08.792109 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:08.792577 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250721220708728355"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250721220708728355"
    )
  
[0m22:07:08.841040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.843036 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:08.843494 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:08.843912 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:08.851687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.852612 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:08.854141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bec8f2c9-156a-4825-8ee4-4fecc2792119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfc7043650>]}
[0m22:07:08.854832 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:07:08.855648 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:08.856923 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:08.857331 [debug] [MainThread]: On master: BEGIN
[0m22:07:08.857739 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:08.858408 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:08.858806 [debug] [MainThread]: On master: COMMIT
[0m22:07:08.859172 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:08.859567 [debug] [MainThread]: On master: COMMIT
[0m22:07:08.860109 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:08.860548 [debug] [MainThread]: On master: Close
[0m22:07:08.861144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:08.861554 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:08.861953 [info ] [MainThread]: 
[0m22:07:08.862482 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.97 seconds (8.97s).
[0m22:07:08.863496 [debug] [MainThread]: Command end result
[0m22:07:08.889121 [info ] [MainThread]: 
[0m22:07:08.889765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:08.890271 [info ] [MainThread]: 
[0m22:07:08.890805 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:08.891800 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.992664, "process_user_time": 4.675354, "process_kernel_time": 0.280802, "process_mem_max_rss": "324900", "process_in_blocks": "1200", "process_out_blocks": "100144"}
[0m22:07:08.892337 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:08.892234 after 10.99 seconds
[0m22:07:08.892827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00a5c8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfc777c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfc7867440>]}
[0m22:07:08.893243 [debug] [MainThread]: Flushing usage events
[0m22:07:10.702630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f068528ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06847ac530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0686d592e0>]}


============================== 22:07:10.705778 | 2acc9ac6-492b-45f0-87ee-3dc4783ab4c1 ==============================
[0m22:07:10.705778 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:10.706457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:07:10.814704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2acc9ac6-492b-45f0-87ee-3dc4783ab4c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06852db2f0>]}
[0m22:07:10.832532 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17904042, "process_user_time": 1.314296, "process_kernel_time": 0.13503, "process_mem_max_rss": "100528", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:10.833077 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:10.832975 after 0.18 seconds
[0m22:07:10.833519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06841c8f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0683ff7ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06841f3170>]}
[0m22:07:10.833946 [debug] [MainThread]: Flushing usage events
[0m06:02:31.766742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7975bf71a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79755b5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79755b06e0>]}


============================== 06:02:31.874329 | c79d59d2-42e0-4699-8456-1260c136396f ==============================
[0m06:02:31.874329 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:31.875042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:32.044847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c79d59d2-42e0-4699-8456-1260c136396f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79765089e0>]}
[0m06:02:32.060016 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6nzrg5s4'
[0m06:02:32.060470 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:32.158892 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:32.159512 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:32.171025 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:32.174861 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:32.227373 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:32.227925 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:32.228469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c79d59d2-42e0-4699-8456-1260c136396f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7975405580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7976508140>]}
[0m06:02:32.228976 [info ] [MainThread]: 
[0m06:02:32.229482 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:32.239107 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5225104, "process_user_time": 1.55435, "process_kernel_time": 0.147222, "process_mem_max_rss": "101748", "process_in_blocks": "8744", "process_out_blocks": "5168"}
[0m06:02:32.239655 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:32.239553 after 0.52 seconds
[0m06:02:32.240113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f797813d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7975973bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7975970f20>]}
[0m06:02:32.240540 [debug] [MainThread]: Flushing usage events
[0m06:02:33.817926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae67994260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6822d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6a4ed460>]}


============================== 06:02:33.821027 | 065cb3e8-3116-4240-9ef6-dc5aa086386b ==============================
[0m06:02:33.821027 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:33.821688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:34.022389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae67778620>]}
[0m06:02:34.081554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6838f7d0>]}
[0m06:02:34.084143 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:34.107905 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:34.108603 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:34.109144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6770e690>]}
[0m06:02:35.400040 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:35.400650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae636c5100>]}
[0m06:02:35.629748 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:35.635110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6779c5f0>]}
[0m06:02:35.733576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae635505c0>]}
[0m06:02:35.734101 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:35.734574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae635c39e0>]}
[0m06:02:35.736454 [info ] [MainThread]: 
[0m06:02:35.737156 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:35.741846 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:35.776201 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:35.776633 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:35.777045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:36.243615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.245464 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:36.246696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:36.247401 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:36.256975 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.257515 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:36.258052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:36.259180 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.260474 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.260881 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:36.261444 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.261851 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.262217 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:36.262796 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.263688 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:36.264096 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.264454 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:36.264998 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.265387 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:36.266582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:36.272286 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:36.272808 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:36.273172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:36.273819 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.274211 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:36.274594 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:36.284492 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.285933 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:36.287172 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:36.287567 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:36.289884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae696d9280>]}
[0m06:02:36.290396 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:36.290817 [debug] [MainThread]: On master: BEGIN
[0m06:02:36.291179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:36.291803 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:36.292203 [debug] [MainThread]: On master: COMMIT
[0m06:02:36.292569 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:36.292948 [debug] [MainThread]: On master: COMMIT
[0m06:02:36.293457 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:36.293874 [debug] [MainThread]: On master: Close
[0m06:02:36.294391 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:36.294906 [info ] [MainThread]: 
[0m06:02:36.313323 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:36.313924 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:36.314555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:36.315022 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:36.342354 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:36.343115 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:36.378950 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:36.379811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:42.882540 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:42.883071 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:42.883744 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.884204 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:42.884621 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:42.885346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.888296 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:42.888774 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:42.889522 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.906587 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:42.907080 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:42.907539 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:42.908605 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.914338 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:42.914815 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:42.915925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.918319 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:42.919874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae620c9d60>]}
[0m06:02:42.920555 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.60s]
[0m06:02:42.921324 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:42.922111 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:42.922680 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:42.923336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:42.923804 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:42.928763 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:42.929569 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:42.966005 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:42.966505 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250722060242959908"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:42.966989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:42.974724 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.982287 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:42.982766 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:42.983365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.983835 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:42.984263 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250722060242959908'
      
      
      order by ordinal_position

  
[0m06:02:42.986425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.991618 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:42.992105 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:42.994184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:43.002289 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:43.002791 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:43.005578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:43.023987 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:43.024647 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:43.025127 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250722060242959908"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250722060242959908"
    )
  
[0m06:02:43.076191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:43.078259 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:43.078722 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:43.079147 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:43.085879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:43.086813 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:43.088297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '065cb3e8-3116-4240-9ef6-dc5aa086386b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae29353a40>]}
[0m06:02:43.088997 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:43.089750 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:43.091107 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:43.091525 [debug] [MainThread]: On master: BEGIN
[0m06:02:43.091940 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:43.092583 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:43.093015 [debug] [MainThread]: On master: COMMIT
[0m06:02:43.093380 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:43.093778 [debug] [MainThread]: On master: COMMIT
[0m06:02:43.094309 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:43.094693 [debug] [MainThread]: On master: Close
[0m06:02:43.095304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:43.095672 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:43.096098 [info ] [MainThread]: 
[0m06:02:43.096552 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.36 seconds (7.36s).
[0m06:02:43.097479 [debug] [MainThread]: Command end result
[0m06:02:43.123497 [info ] [MainThread]: 
[0m06:02:43.124064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:43.124513 [info ] [MainThread]: 
[0m06:02:43.124993 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:43.125925 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.357054, "process_user_time": 5.102255, "process_kernel_time": 0.288957, "process_mem_max_rss": "342488", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m06:02:43.126461 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:43.126359 after 9.36 seconds
[0m06:02:43.126911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae678ea180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae29aae4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6354d100>]}
[0m06:02:43.127339 [debug] [MainThread]: Flushing usage events
[0m06:02:44.917736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac71361cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac71d673e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac71e91a90>]}


============================== 06:02:44.922232 | cb491749-7221-484e-8833-b76ac55cec07 ==============================
[0m06:02:44.922232 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:44.923135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:45.047095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb491749-7221-484e-8833-b76ac55cec07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7116b200>]}
[0m06:02:45.064863 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20209853, "process_user_time": 1.357964, "process_kernel_time": 0.100997, "process_mem_max_rss": "100704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:45.065392 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:45.065292 after 0.20 seconds
[0m06:02:45.065832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac71361cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac73303c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac6f711a00>]}
[0m06:02:45.066243 [debug] [MainThread]: Flushing usage events
[0m14:07:20.895836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f439313c620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4391ad9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4391ad9550>]}


============================== 14:07:20.911653 | 0a4366a0-ca75-4de0-9ebc-34707a9dfa23 ==============================
[0m14:07:20.911653 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:20.912385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:07:21.043162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a4366a0-ca75-4de0-9ebc-34707a9dfa23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f439114d220>]}
[0m14:07:21.059767 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-613_sft0'
[0m14:07:21.060292 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:07:21.177006 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:07:21.177798 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:07:21.199611 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:07:21.203545 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:07:21.276277 [info ] [MainThread]: Installed from version 1.2.0
[0m14:07:21.276860 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:07:21.277382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0a4366a0-ca75-4de0-9ebc-34707a9dfa23', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4390eba3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4390eb97c0>]}
[0m14:07:21.277821 [info ] [MainThread]: 
[0m14:07:21.278279 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:07:21.286831 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4423959, "process_user_time": 1.610632, "process_kernel_time": 0.156158, "process_mem_max_rss": "101756", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m14:07:21.287403 [debug] [MainThread]: Command `dbt deps` succeeded at 14:07:21.287296 after 0.44 seconds
[0m14:07:21.287826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43916a7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4391ada270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4391adb680>]}
[0m14:07:21.288264 [debug] [MainThread]: Flushing usage events
[0m14:07:22.938152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04cdab56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04cd43ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04cfbd6270>]}


============================== 14:07:22.941500 | 392012bf-2f5c-41f5-a310-7b000ca4f89d ==============================
[0m14:07:22.941500 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:22.942123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:07:23.146742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ccf972c0>]}
[0m14:07:23.207644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ccec1370>]}
[0m14:07:23.210433 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:07:23.233469 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:07:23.234175 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:07:23.234706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ccf3f1d0>]}
[0m14:07:24.543664 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:07:24.544404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c8af2030>]}
[0m14:07:24.791636 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:07:24.797598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c8a64a40>]}
[0m14:07:24.895900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c8b00b30>]}
[0m14:07:24.896522 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:07:24.897005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c8ae78f0>]}
[0m14:07:24.898959 [info ] [MainThread]: 
[0m14:07:24.899725 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:07:24.904571 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:07:24.940266 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:07:24.940814 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:07:24.941383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:26.644575 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:07:26.646426 [debug] [ThreadPool]: On list_petro: Close
[0m14:07:26.647550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:07:26.648173 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:07:26.657623 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:26.658217 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:07:26.658719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:26.660263 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:26.661705 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:26.662092 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:07:26.662677 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:26.663056 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:26.663467 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:07:26.664042 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:26.664993 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:26.665403 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:26.665765 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:26.666320 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:26.666723 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:07:26.668098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:07:26.674345 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:26.674753 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:07:26.675115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:26.675776 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:26.676159 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:26.676558 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:07:26.686309 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:26.687924 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:07:26.689254 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:07:26.689681 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:07:26.692080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c76389e0>]}
[0m14:07:26.692654 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:26.693038 [debug] [MainThread]: On master: BEGIN
[0m14:07:26.693428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:26.694150 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:26.694589 [debug] [MainThread]: On master: COMMIT
[0m14:07:26.694963 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:26.695370 [debug] [MainThread]: On master: COMMIT
[0m14:07:26.695935 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:26.696368 [debug] [MainThread]: On master: Close
[0m14:07:26.696923 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:07:26.697413 [info ] [MainThread]: 
[0m14:07:26.715952 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:07:26.716644 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:07:26.717275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:07:26.717711 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:07:26.745354 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:07:26.746288 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:07:26.783623 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:07:26.784601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:34.578553 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:34.579133 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:07:34.580027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.580512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:34.580923 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:07:34.581713 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.585092 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:34.585604 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:07:34.586362 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.603762 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:34.604348 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:34.604777 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:34.607188 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.613479 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:34.613980 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:07:34.615523 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.618123 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:07:34.619730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c77aef00>]}
[0m14:07:34.620471 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.90s]
[0m14:07:34.621210 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:07:34.622161 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:07:34.622757 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:07:34.623446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:07:34.623881 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:07:34.629179 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:07:34.629864 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:07:34.667363 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:34.667946 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250722140734661103"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:07:34.668432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:34.676760 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.685186 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:34.685723 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:07:34.686489 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.686931 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:34.687378 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250722140734661103'
      
      
      order by ordinal_position

  
[0m14:07:34.689768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.695534 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:34.696008 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:34.698532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.706651 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:34.707131 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:34.709913 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.728775 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:07:34.729618 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:34.730126 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250722140734661103"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250722140734661103"
    )
  
[0m14:07:34.780270 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.782338 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:34.782854 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:34.783340 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:34.790920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:34.792005 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:07:34.793609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392012bf-2f5c-41f5-a310-7b000ca4f89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f048a56b7a0>]}
[0m14:07:34.794357 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:07:34.795119 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:07:34.796815 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:34.797250 [debug] [MainThread]: On master: BEGIN
[0m14:07:34.797636 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:34.798355 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:34.798752 [debug] [MainThread]: On master: COMMIT
[0m14:07:34.799116 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:34.799504 [debug] [MainThread]: On master: COMMIT
[0m14:07:34.800048 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:34.800474 [debug] [MainThread]: On master: Close
[0m14:07:34.801096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:34.801511 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:07:34.801915 [info ] [MainThread]: 
[0m14:07:34.802412 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.90 seconds (9.90s).
[0m14:07:34.803376 [debug] [MainThread]: Command end result
[0m14:07:34.830088 [info ] [MainThread]: 
[0m14:07:34.830763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:34.831216 [info ] [MainThread]: 
[0m14:07:34.831728 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:07:34.832738 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.945209, "process_user_time": 6.507942, "process_kernel_time": 0.287439, "process_mem_max_rss": "341112", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m14:07:34.833321 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:34.833185 after 11.95 seconds
[0m14:07:34.833782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04cd0376b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04cedcd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f048b68aba0>]}
[0m14:07:34.834243 [debug] [MainThread]: Flushing usage events
[0m14:07:36.791925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd63279b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd7ac9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd6e77860>]}


============================== 14:07:36.795170 | dbca273d-0cbd-49fc-9e63-b4720f44b7a6 ==============================
[0m14:07:36.795170 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:36.795861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:07:36.906243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbca273d-0cbd-49fc-9e63-b4720f44b7a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd5ee8e60>]}
[0m14:07:36.924239 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18189058, "process_user_time": 1.391312, "process_kernel_time": 0.096952, "process_mem_max_rss": "100608", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:07:36.924783 [debug] [MainThread]: Command `dbt clean` succeeded at 14:07:36.924679 after 0.18 seconds
[0m14:07:36.925203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd7e2d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd61ab080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd5d100b0>]}
[0m14:07:36.925660 [debug] [MainThread]: Flushing usage events
[0m22:06:50.364171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe446aadcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe447d4f620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe446eaa060>]}


============================== 22:06:50.379200 | 2b3398c7-1038-4146-b171-b36df63aca59 ==============================
[0m22:06:50.379200 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:50.379888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:50.542166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b3398c7-1038-4146-b171-b36df63aca59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe446a539e0>]}
[0m22:06:50.557500 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-uwg9ty24'
[0m22:06:50.557965 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:50.718668 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:50.719345 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:50.758431 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:50.762431 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:50.937176 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:50.937771 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:50.938283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2b3398c7-1038-4146-b171-b36df63aca59', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe446bc49b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4467a63f0>]}
[0m22:06:50.938757 [info ] [MainThread]: 
[0m22:06:50.939222 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:50.947070 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6363378, "process_user_time": 1.617516, "process_kernel_time": 0.128677, "process_mem_max_rss": "101496", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m22:06:50.947633 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:50.947528 after 0.64 seconds
[0m22:06:50.948052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe446e651c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe446be5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe449651400>]}
[0m22:06:50.948479 [debug] [MainThread]: Flushing usage events
[0m22:06:52.601067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42811c8500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4281cb4200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4281cb6420>]}


============================== 22:06:52.604369 | 6b2b1cd1-d429-4a63-8a82-12caf6fa95b9 ==============================
[0m22:06:52.604369 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:52.605131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:52.809066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4281667c20>]}
[0m22:06:52.867764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4282fcce00>]}
[0m22:06:52.870311 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:52.892725 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:52.893446 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:52.893960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427d1a7e00>]}
[0m22:06:54.188306 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:54.188952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427ceb4e30>]}
[0m22:06:54.428005 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:54.433625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42812f2030>]}
[0m22:06:54.534153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427cee8050>]}
[0m22:06:54.534713 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:54.535174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427cf61520>]}
[0m22:06:54.536976 [info ] [MainThread]: 
[0m22:06:54.537659 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:54.542331 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:54.576552 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:54.576991 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:54.577368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:55.216989 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:55.218930 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:55.220208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:55.220902 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:55.229175 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:55.229649 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:55.230029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:55.231208 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:55.232616 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:55.233011 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:55.233643 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:55.234035 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:55.234427 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:55.235044 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:55.235986 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:55.236373 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:55.236758 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:55.237299 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:55.237729 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:55.239103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:55.245249 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:55.245689 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:55.246057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:55.246824 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:55.247214 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:55.247625 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:55.257519 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:55.259249 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:55.260568 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:55.260968 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:55.263407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427b8486b0>]}
[0m22:06:55.263929 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:55.264308 [debug] [MainThread]: On master: BEGIN
[0m22:06:55.264688 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:55.265404 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:55.265798 [debug] [MainThread]: On master: COMMIT
[0m22:06:55.266165 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:55.266539 [debug] [MainThread]: On master: COMMIT
[0m22:06:55.267052 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:55.267456 [debug] [MainThread]: On master: Close
[0m22:06:55.268016 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:55.268502 [info ] [MainThread]: 
[0m22:06:55.288242 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:55.288942 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:55.289636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:55.290079 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:55.317325 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:55.318228 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:55.353853 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:55.354772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:05.173302 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.173820 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:05.174487 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.174925 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.175359 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:05.176111 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.178982 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.179439 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:05.180103 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.196669 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:05.197136 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.197586 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:05.199435 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.205042 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.205508 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:05.206645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.208991 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:05.210542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427d0a1130>]}
[0m22:07:05.211220 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.92s]
[0m22:07:05.211983 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:05.212801 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:05.213553 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:05.214137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:05.214633 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:05.219517 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:05.220154 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:05.255669 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.256183 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250722220705249537"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:05.256653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:05.265194 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.272750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.273193 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:05.273821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.274249 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.274694 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250722220705249537'
      
      
      order by ordinal_position

  
[0m22:07:05.277064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.282186 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.282665 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:05.285366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.292909 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.293371 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:05.296002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.314008 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:05.314711 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.315156 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250722220705249537"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250722220705249537"
    )
  
[0m22:07:05.362010 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.364025 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:05.364484 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.364892 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:05.371726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.372622 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:05.374052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b2b1cd1-d429-4a63-8a82-12caf6fa95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f423ee30b60>]}
[0m22:07:05.374742 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:07:05.375483 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:05.376865 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:05.377285 [debug] [MainThread]: On master: BEGIN
[0m22:07:05.377699 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:05.378334 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:05.378759 [debug] [MainThread]: On master: COMMIT
[0m22:07:05.379125 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:05.379514 [debug] [MainThread]: On master: COMMIT
[0m22:07:05.380017 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:05.380431 [debug] [MainThread]: On master: Close
[0m22:07:05.381024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:05.381412 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:05.381823 [info ] [MainThread]: 
[0m22:07:05.382301 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.84 seconds (10.84s).
[0m22:07:05.383257 [debug] [MainThread]: Command end result
[0m22:07:05.408869 [info ] [MainThread]: 
[0m22:07:05.409463 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:05.409946 [info ] [MainThread]: 
[0m22:07:05.410447 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:05.411445 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.860291, "process_user_time": 4.702354, "process_kernel_time": 0.272949, "process_mem_max_rss": "326452", "process_in_blocks": "1200", "process_out_blocks": "100136"}
[0m22:07:05.411986 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:05.411883 after 12.86 seconds
[0m22:07:05.412434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4284fcf0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4283d78c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f425a7bdd90>]}
[0m22:07:05.412857 [debug] [MainThread]: Flushing usage events
[0m22:07:07.308643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7041b3d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703f9b5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703f9b59a0>]}


============================== 22:07:07.311683 | 4cea2b1f-25a3-49f7-bf38-15dc81e3b5f2 ==============================
[0m22:07:07.311683 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:07.312300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:07.420164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cea2b1f-25a3-49f7-bf38-15dc81e3b5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703fbbb680>]}
[0m22:07:07.437840 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1777596, "process_user_time": 1.346972, "process_kernel_time": 0.097925, "process_mem_max_rss": "100784", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:07.438370 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:07.438268 after 0.18 seconds
[0m22:07:07.438819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7041b3d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703f913320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703f9d3110>]}
[0m22:07:07.439228 [debug] [MainThread]: Flushing usage events
[0m06:02:36.472259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3744095730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3744096420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37461b9340>]}


============================== 06:02:36.515791 | 19e8ed0f-c980-4182-aaec-48019be46fc9 ==============================
[0m06:02:36.515791 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:36.516495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:36.626822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19e8ed0f-c980-4182-aaec-48019be46fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374356b890>]}
[0m06:02:36.641590 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-udaga3dd'
[0m06:02:36.642051 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:36.828356 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:36.829010 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:36.885251 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:36.889012 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:37.023731 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:37.024338 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:37.024907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '19e8ed0f-c980-4182-aaec-48019be46fc9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3743281610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374339d820>]}
[0m06:02:37.025387 [info ] [MainThread]: 
[0m06:02:37.025892 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:37.055350 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6326236, "process_user_time": 1.578078, "process_kernel_time": 0.138655, "process_mem_max_rss": "101396", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m06:02:37.056016 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:37.055891 after 0.63 seconds
[0m06:02:37.056482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374397f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37436f1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3747bbb8f0>]}
[0m06:02:37.056908 [debug] [MainThread]: Flushing usage events
[0m06:02:38.676556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12dd9439b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12de0beab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12de0bcb00>]}


============================== 06:02:38.679616 | 0ee1797e-52e8-4f02-8a1d-7e0494000d12 ==============================
[0m06:02:38.679616 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:38.680268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:38.882391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d9510590>]}
[0m06:02:38.941561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12dd461ac0>]}
[0m06:02:38.944112 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:38.971852 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:38.972589 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:38.973115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12dd4629c0>]}
[0m06:02:40.281153 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:40.281783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d92f2810>]}
[0m06:02:40.509591 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:40.515053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12dd48eb70>]}
[0m06:02:40.619539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d92ba1e0>]}
[0m06:02:40.620099 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:40.620601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12df3d4b60>]}
[0m06:02:40.622446 [info ] [MainThread]: 
[0m06:02:40.623120 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:40.627858 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:40.663210 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:40.663659 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:40.664063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:41.136637 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:41.138826 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:41.140121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:41.140917 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:41.149093 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:41.149504 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:41.149877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:41.150830 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:41.152153 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:41.152539 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:41.153107 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:41.153484 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:41.153840 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:41.154451 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:41.155380 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:41.155767 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:41.156152 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:41.156676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:41.157098 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:41.158343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:41.163984 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:41.164486 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:41.164841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:41.165440 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:41.165816 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:41.166209 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:41.176583 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:41.178021 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:41.179264 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:41.179652 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:41.181825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d93dc2f0>]}
[0m06:02:41.182337 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:41.182705 [debug] [MainThread]: On master: BEGIN
[0m06:02:41.183073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:41.183674 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:41.184085 [debug] [MainThread]: On master: COMMIT
[0m06:02:41.184454 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:41.184803 [debug] [MainThread]: On master: COMMIT
[0m06:02:41.185353 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:41.185738 [debug] [MainThread]: On master: Close
[0m06:02:41.186270 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:41.186719 [info ] [MainThread]: 
[0m06:02:41.218722 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:41.219334 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:41.219898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:41.220355 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:41.247445 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:41.248195 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:41.283893 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:41.284638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:50.208489 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:50.208969 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:50.209633 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.210083 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:50.210500 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:50.211201 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.214079 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:50.214521 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:50.215186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.231999 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:50.232471 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:50.232884 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:50.234827 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.240533 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:50.240983 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:50.242204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.244549 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:50.246128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129b3d75c0>]}
[0m06:02:50.246792 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.03s]
[0m06:02:50.247620 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:50.248577 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:50.249152 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:50.249729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:50.250198 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:50.254998 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:50.255638 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:50.291764 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:50.292273 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250723060250285679"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:50.292721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:50.300541 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.308211 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:50.308663 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:50.309273 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.309703 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:50.310136 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250723060250285679'
      
      
      order by ordinal_position

  
[0m06:02:50.312206 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.317307 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:50.317755 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:50.320805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.328360 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:50.328815 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:50.331473 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.349502 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:50.350193 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:50.350639 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250723060250285679"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250723060250285679"
    )
  
[0m06:02:50.401692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.403644 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:50.404102 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:50.404513 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:50.412327 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:50.413227 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:50.414689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ee1797e-52e8-4f02-8a1d-7e0494000d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129b17a4e0>]}
[0m06:02:50.415367 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:50.416101 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:50.417681 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:50.418123 [debug] [MainThread]: On master: BEGIN
[0m06:02:50.418505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:50.419160 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:50.419553 [debug] [MainThread]: On master: COMMIT
[0m06:02:50.419917 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:50.420324 [debug] [MainThread]: On master: COMMIT
[0m06:02:50.420876 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:50.421316 [debug] [MainThread]: On master: Close
[0m06:02:50.421874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:50.422256 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:50.422643 [info ] [MainThread]: 
[0m06:02:50.423125 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.80 seconds (9.80s).
[0m06:02:50.424019 [debug] [MainThread]: Command end result
[0m06:02:50.449547 [info ] [MainThread]: 
[0m06:02:50.450111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:50.450563 [info ] [MainThread]: 
[0m06:02:50.451016 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:50.451931 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.824217, "process_user_time": 5.125092, "process_kernel_time": 0.285172, "process_mem_max_rss": "340624", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:50.452518 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:50.452404 after 11.82 seconds
[0m06:02:50.452948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12dd5d3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d92b9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12dda6e2d0>]}
[0m06:02:50.453404 [debug] [MainThread]: Flushing usage events
[0m06:02:52.296335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ffa03d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ff8b85340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ff8c24d40>]}


============================== 06:02:52.299396 | 47531cf3-7f42-4374-971d-ae379373a9e5 ==============================
[0m06:02:52.299396 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:52.300078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:52.407075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47531cf3-7f42-4374-971d-ae379373a9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ff7f403e0>]}
[0m06:02:52.424595 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17734756, "process_user_time": 1.346114, "process_kernel_time": 0.097008, "process_mem_max_rss": "100464", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:52.425146 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:52.425026 after 0.18 seconds
[0m06:02:52.425560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ff8469070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ff7f8dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ff7f43ec0>]}
[0m06:02:52.425984 [debug] [MainThread]: Flushing usage events
[0m14:07:18.915250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514ffca540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514fce77a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5150f53380>]}


============================== 14:07:18.923302 | ba93f765-6ffd-4af8-81a3-64bd1fcb152d ==============================
[0m14:07:18.923302 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:18.923985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:19.072110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba93f765-6ffd-4af8-81a3-64bd1fcb152d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514fd39220>]}
[0m14:07:19.087489 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1vapll7a'
[0m14:07:19.087970 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:07:19.282903 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:07:19.283672 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:07:19.307687 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:07:19.311592 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:07:19.382771 [info ] [MainThread]: Installed from version 1.2.0
[0m14:07:19.383290 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:07:19.383796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ba93f765-6ffd-4af8-81a3-64bd1fcb152d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514f90b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514f90b350>]}
[0m14:07:19.384259 [info ] [MainThread]: 
[0m14:07:19.384733 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:07:19.386127 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.52021575, "process_user_time": 1.588072, "process_kernel_time": 0.116005, "process_mem_max_rss": "101600", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m14:07:19.386713 [debug] [MainThread]: Command `dbt deps` succeeded at 14:07:19.386599 after 0.52 seconds
[0m14:07:19.387128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51502406e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514fd39220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5150b60f20>]}
[0m14:07:19.387569 [debug] [MainThread]: Flushing usage events
[0m14:07:21.008220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd742ae05c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd742c23ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd743087410>]}


============================== 14:07:21.011375 | 5ce67fc7-a5f5-4014-a037-4a42df48db11 ==============================
[0m14:07:21.011375 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:21.012004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:21.215237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74476eff0>]}
[0m14:07:21.274549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7438d0740>]}
[0m14:07:21.277218 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:07:21.293000 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:07:21.293712 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:07:21.294245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd743e3b680>]}
[0m14:07:22.593742 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:07:22.594407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd73e4fef60>]}
[0m14:07:22.830470 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:07:22.836094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd73e42f8c0>]}
[0m14:07:22.981606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd73e7fd010>]}
[0m14:07:22.982181 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:07:22.982733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7469b81a0>]}
[0m14:07:22.984636 [info ] [MainThread]: 
[0m14:07:22.985383 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:07:22.990182 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:07:23.025557 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:07:23.026032 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:07:23.026445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:23.537955 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:07:23.539914 [debug] [ThreadPool]: On list_petro: Close
[0m14:07:23.540924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:07:23.541515 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:07:23.548846 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:23.549301 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:07:23.549685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:23.550601 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:23.551936 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:23.552370 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:07:23.552954 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:23.553397 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:23.553767 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:07:23.554405 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:23.555357 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:23.555748 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:23.556110 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:23.556655 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:23.557047 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:07:23.558366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:07:23.564351 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:23.564745 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:07:23.565098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:23.565828 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:23.566232 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:23.566606 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:07:23.575730 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:23.577170 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:07:23.578406 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:07:23.578795 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:07:23.581104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7447cd010>]}
[0m14:07:23.581644 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:23.582029 [debug] [MainThread]: On master: BEGIN
[0m14:07:23.582436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:23.583046 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:23.583488 [debug] [MainThread]: On master: COMMIT
[0m14:07:23.583875 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:23.584260 [debug] [MainThread]: On master: COMMIT
[0m14:07:23.584823 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:23.585261 [debug] [MainThread]: On master: Close
[0m14:07:23.585789 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:07:23.586282 [info ] [MainThread]: 
[0m14:07:23.597473 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:07:23.598052 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:07:23.598699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:07:23.599135 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:07:23.626219 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:07:23.626959 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:07:23.662378 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:07:23.663168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:32.527777 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:32.528333 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:07:32.528978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.529438 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:32.529851 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:07:32.530602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.533537 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:32.533972 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:07:32.534655 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.551272 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:32.551726 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:32.552139 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:32.553917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.559604 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:32.560053 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:07:32.561231 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.563561 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:07:32.565081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7434b4950>]}
[0m14:07:32.565780 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.97s]
[0m14:07:32.566538 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:07:32.567433 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:07:32.568078 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:07:32.568695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:07:32.569124 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:07:32.574122 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:07:32.574795 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:07:32.610572 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:32.611056 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250723140732604568"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:07:32.611520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:32.619523 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.626980 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:32.627451 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:07:32.628041 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.628492 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:32.628916 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250723140732604568'
      
      
      order by ordinal_position

  
[0m14:07:32.631691 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.636785 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:32.637251 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:32.639432 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.647062 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:32.647534 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:32.649625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.667488 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:07:32.668158 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:32.668630 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250723140732604568"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250723140732604568"
    )
  
[0m14:07:32.718557 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.720597 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:32.721061 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:32.721493 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:32.729130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:32.730063 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:07:32.731561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ce67fc7-a5f5-4014-a037-4a42df48db11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd70451dc10>]}
[0m14:07:32.732259 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:07:32.733047 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:07:32.734679 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:32.735099 [debug] [MainThread]: On master: BEGIN
[0m14:07:32.735521 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:32.736244 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:32.736648 [debug] [MainThread]: On master: COMMIT
[0m14:07:32.737028 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:32.737435 [debug] [MainThread]: On master: COMMIT
[0m14:07:32.737991 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:32.738423 [debug] [MainThread]: On master: Close
[0m14:07:32.739021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:32.739432 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:07:32.739838 [info ] [MainThread]: 
[0m14:07:32.740360 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.75 seconds (9.75s).
[0m14:07:32.741383 [debug] [MainThread]: Command end result
[0m14:07:32.769012 [info ] [MainThread]: 
[0m14:07:32.769668 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:32.770174 [info ] [MainThread]: 
[0m14:07:32.770725 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:07:32.771728 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.812803, "process_user_time": 4.657773, "process_kernel_time": 0.277867, "process_mem_max_rss": "329464", "process_in_blocks": "1200", "process_out_blocks": "100096"}
[0m14:07:32.772300 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:32.772169 after 11.81 seconds
[0m14:07:32.772751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7435931a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd742a15e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd743a4e240>]}
[0m14:07:32.773182 [debug] [MainThread]: Flushing usage events
[0m14:07:34.662934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f558516eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55856efa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5585de9220>]}


============================== 14:07:34.666709 | e49ec558-db68-4218-bb75-a43307d5d2c5 ==============================
[0m14:07:34.666709 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:34.667407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:34.777590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e49ec558-db68-4218-bb75-a43307d5d2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5584c87950>]}
[0m14:07:34.797447 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18545283, "process_user_time": 1.386899, "process_kernel_time": 0.109912, "process_mem_max_rss": "100492", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:07:34.798045 [debug] [MainThread]: Command `dbt clean` succeeded at 14:07:34.797936 after 0.19 seconds
[0m14:07:34.798560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5584fa4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5584a6f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5584a6c140>]}
[0m14:07:34.799007 [debug] [MainThread]: Flushing usage events
[0m22:06:35.931638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d443f0da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d43a17560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d43a49310>]}


============================== 22:06:35.956929 | e08714fe-6057-4b5c-9b79-11ffe9bac998 ==============================
[0m22:06:35.956929 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:35.957587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:36.086489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e08714fe-6057-4b5c-9b79-11ffe9bac998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d438ddd90>]}
[0m22:06:36.101913 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-paa5t2ek'
[0m22:06:36.102390 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:36.173200 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:36.173874 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:36.187038 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:36.190915 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:36.414584 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:36.415204 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:36.415759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e08714fe-6057-4b5c-9b79-11ffe9bac998', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d436f8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d44914380>]}
[0m22:06:36.416247 [info ] [MainThread]: 
[0m22:06:36.416745 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:36.421988 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5406629, "process_user_time": 1.567968, "process_kernel_time": 0.14847, "process_mem_max_rss": "101628", "process_in_blocks": "8496", "process_out_blocks": "5168"}
[0m22:06:36.422541 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:36.422437 after 0.54 seconds
[0m22:06:36.423017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d43a94f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d43d774a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d436341a0>]}
[0m22:06:36.423478 [debug] [MainThread]: Flushing usage events
[0m22:06:38.330726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46982b4ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4698f43620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4698f405f0>]}


============================== 22:06:38.333935 | 4cea4784-ab65-48ba-a2eb-8ee439206eac ==============================
[0m22:06:38.333935 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:38.334616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:38.539185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46982b4560>]}
[0m22:06:38.598887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46980dd460>]}
[0m22:06:38.601672 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:38.663868 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:38.664613 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:38.665164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46980621b0>]}
[0m22:06:39.961670 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:39.962325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46941b1ac0>]}
[0m22:06:40.195257 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:40.200826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46993d19d0>]}
[0m22:06:40.316271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4693ee5610>]}
[0m22:06:40.316876 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:40.317356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4693edbbf0>]}
[0m22:06:40.319246 [info ] [MainThread]: 
[0m22:06:40.319957 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:40.324769 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:40.360130 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:40.360622 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:40.361037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:40.870754 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:40.872776 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:40.873839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:40.874489 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:40.883271 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:40.883803 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:40.884302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:40.885519 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:40.887130 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:40.887605 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:40.888289 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:40.888693 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:40.889066 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:40.889713 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:40.890710 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:40.891166 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:40.891532 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:40.892090 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:40.892485 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:40.893714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:40.899325 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:40.899831 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:40.900190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:40.900792 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:40.901182 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:40.901554 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:40.911788 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:40.913281 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:40.914550 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:40.914982 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:40.917167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4699fd5070>]}
[0m22:06:40.917689 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:40.918076 [debug] [MainThread]: On master: BEGIN
[0m22:06:40.918428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:40.919083 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:40.919471 [debug] [MainThread]: On master: COMMIT
[0m22:06:40.919883 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:40.920235 [debug] [MainThread]: On master: COMMIT
[0m22:06:40.920764 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:40.921148 [debug] [MainThread]: On master: Close
[0m22:06:40.921692 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:40.922166 [info ] [MainThread]: 
[0m22:06:40.953767 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:40.954432 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:40.955135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:40.955576 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:40.982863 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:40.983629 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:41.019485 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:41.020438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:51.915889 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:51.916424 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:51.917156 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:51.917604 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:51.918065 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:51.918881 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:51.922003 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:51.922445 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:51.923169 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:51.940233 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:51.940837 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:51.941277 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:51.944113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:51.950402 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:51.950892 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:51.952749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:51.955334 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:51.956999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4699f76240>]}
[0m22:06:51.957759 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.00s]
[0m22:06:51.958603 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:51.959587 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:51.960230 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:51.960932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:51.961385 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:51.966817 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:51.967595 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:52.005185 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:52.005796 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250723220651998935"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:52.006294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:52.014614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:52.022715 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:52.023189 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:52.023848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:52.024295 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:52.024742 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250723220651998935'
      
      
      order by ordinal_position

  
[0m22:06:52.027071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:52.032424 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:52.032918 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:52.035102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:52.042945 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:52.043417 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:52.045891 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:52.064131 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:52.064857 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:52.065320 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250723220651998935"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250723220651998935"
    )
  
[0m22:06:52.112778 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:52.114786 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:52.115268 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:52.115703 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:52.123612 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:52.124551 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:52.126137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cea4784-ab65-48ba-a2eb-8ee439206eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4659bcd7c0>]}
[0m22:06:52.126859 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:06:52.127687 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:52.129051 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:52.129464 [debug] [MainThread]: On master: BEGIN
[0m22:06:52.129869 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:52.130572 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:52.130999 [debug] [MainThread]: On master: COMMIT
[0m22:06:52.131381 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:52.131783 [debug] [MainThread]: On master: COMMIT
[0m22:06:52.132379 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:52.132819 [debug] [MainThread]: On master: Close
[0m22:06:52.133490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:52.133883 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:52.134282 [info ] [MainThread]: 
[0m22:06:52.134818 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.81 seconds (11.81s).
[0m22:06:52.135864 [debug] [MainThread]: Command end result
[0m22:06:52.162111 [info ] [MainThread]: 
[0m22:06:52.162750 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:52.163266 [info ] [MainThread]: 
[0m22:06:52.163809 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:52.164846 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.883757, "process_user_time": 5.191595, "process_kernel_time": 0.296262, "process_mem_max_rss": "342048", "process_in_blocks": "1200", "process_out_blocks": "100152"}
[0m22:06:52.165406 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:52.165299 after 13.88 seconds
[0m22:06:52.165871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4698278440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46982dd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46988106b0>]}
[0m22:06:52.166298 [debug] [MainThread]: Flushing usage events
[0m22:06:54.300218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b7875c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b7c67560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ba3511f0>]}


============================== 22:06:54.303441 | 78fca6ee-acd7-4c2e-8799-b2b2c137f74c ==============================
[0m22:06:54.303441 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:54.304118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:54.413776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78fca6ee-acd7-4c2e-8799-b2b2c137f74c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b8065340>]}
[0m22:06:54.433292 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1826777, "process_user_time": 1.334405, "process_kernel_time": 0.114948, "process_mem_max_rss": "100512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:54.433856 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:54.433749 after 0.18 seconds
[0m22:06:54.434276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b7db6f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b8065340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b8042a80>]}
[0m22:06:54.434727 [debug] [MainThread]: Flushing usage events
[0m06:02:22.327774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7aeab0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7b894530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7aea8560>]}


============================== 06:02:22.353533 | 35c78dfb-569b-4f37-ba9c-d270de0496fd ==============================
[0m06:02:22.353533 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:22.354242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:22.467671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35c78dfb-569b-4f37-ba9c-d270de0496fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7a8c3ef0>]}
[0m06:02:22.483678 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-86l25xi5'
[0m06:02:22.484195 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:22.561715 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:22.562477 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:22.575230 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:22.579401 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:22.714316 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:22.715049 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:22.715728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '35c78dfb-569b-4f37-ba9c-d270de0496fd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7aa4b560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7a8d33e0>]}
[0m06:02:22.716228 [info ] [MainThread]: 
[0m06:02:22.716786 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:22.723447 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44766167, "process_user_time": 1.640229, "process_kernel_time": 0.152113, "process_mem_max_rss": "101368", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m06:02:22.724032 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:22.723918 after 0.45 seconds
[0m06:02:22.724496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7b894530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7aef5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7b414140>]}
[0m06:02:22.724936 [debug] [MainThread]: Flushing usage events
[0m06:02:24.485306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fdc82d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fd2dd670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fe4be300>]}


============================== 06:02:24.488530 | dcb821ab-1570-4426-baa8-61cd464eb64f ==============================
[0m06:02:24.488530 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.489196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.694797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f910c3e0>]}
[0m06:02:24.755478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fd1fb4a0>]}
[0m06:02:24.758382 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:24.788698 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:24.789521 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:24.790075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f91178f0>]}
[0m06:02:26.124195 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:26.124878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f8e26f90>]}
[0m06:02:26.381778 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:26.388159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f8e55520>]}
[0m06:02:26.506077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f8ec17f0>]}
[0m06:02:26.506701 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:26.507196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f8fc7d40>]}
[0m06:02:26.509238 [info ] [MainThread]: 
[0m06:02:26.509975 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:26.515182 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:26.551207 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:26.551750 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:26.552135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:26.871165 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.873107 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:26.874303 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:26.874973 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:26.884734 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.885165 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:26.885591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:26.886984 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.888384 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.888794 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:26.889464 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.889849 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.890216 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:26.890842 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.891803 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:26.892193 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.892587 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:26.893117 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.893567 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:26.894917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:26.901028 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:26.901571 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:26.901940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:26.902618 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.903011 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:26.903380 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:26.913492 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.915236 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:26.916548 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:26.916936 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:26.919230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f90c14f0>]}
[0m06:02:26.919765 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.920146 [debug] [MainThread]: On master: BEGIN
[0m06:02:26.920527 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:26.921201 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.921633 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.922007 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.922360 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.922902 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.923291 [debug] [MainThread]: On master: Close
[0m06:02:26.923874 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:26.924338 [info ] [MainThread]: 
[0m06:02:26.958998 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:26.959731 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:26.960372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:26.960840 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:26.988371 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:26.989319 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:27.025756 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:27.026723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:35.753617 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.754148 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:35.754878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.755310 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.755748 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:35.756532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.759663 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.760109 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:35.760900 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.778061 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:35.778636 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.779059 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:35.781079 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.787208 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.787688 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:35.789090 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.791586 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:35.793225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77bad65730>]}
[0m06:02:35.793966 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.83s]
[0m06:02:35.794754 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:35.795690 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:35.796361 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:35.797064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:35.797526 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:35.802939 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:35.803657 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:35.853049 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.853954 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250724060235843763"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:35.854702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:35.866162 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.876547 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.877050 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:35.877809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.878251 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.878713 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250724060235843763'
      
      
      order by ordinal_position

  
[0m06:02:35.881137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.886881 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.887367 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:35.890307 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.898647 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.899140 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:35.901657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.920612 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:35.921442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.921908 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250724060235843763"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250724060235843763"
    )
  
[0m06:02:35.968717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.970753 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:35.971194 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.971624 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:35.980717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.981786 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:35.983384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcb821ab-1570-4426-baa8-61cd464eb64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77bbdab530>]}
[0m06:02:35.984100 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.19s]
[0m06:02:35.984928 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:35.986315 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:35.986775 [debug] [MainThread]: On master: BEGIN
[0m06:02:35.987152 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:35.987904 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:35.988301 [debug] [MainThread]: On master: COMMIT
[0m06:02:35.988704 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:35.989066 [debug] [MainThread]: On master: COMMIT
[0m06:02:35.989633 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:35.990026 [debug] [MainThread]: On master: Close
[0m06:02:35.990635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:35.991010 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:35.991453 [info ] [MainThread]: 
[0m06:02:35.991960 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.48 seconds (9.48s).
[0m06:02:35.992930 [debug] [MainThread]: Command end result
[0m06:02:36.019911 [info ] [MainThread]: 
[0m06:02:36.020588 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:36.021067 [info ] [MainThread]: 
[0m06:02:36.021581 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:36.022662 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.588552, "process_user_time": 5.18894, "process_kernel_time": 0.291108, "process_mem_max_rss": "341296", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:36.023205 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:36.023102 after 11.59 seconds
[0m06:02:36.023680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fdc82d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77bbdab530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f8f8dd60>]}
[0m06:02:36.024107 [debug] [MainThread]: Flushing usage events
[0m06:02:38.069624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09def1c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09def12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09de701d0>]}


============================== 06:02:38.072857 | 7d69c830-c446-4dc7-b93b-1dac0f0085f7 ==============================
[0m06:02:38.072857 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:38.073569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:38.182728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d69c830-c446-4dc7-b93b-1dac0f0085f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09efc81a0>]}
[0m06:02:38.201238 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1813607, "process_user_time": 1.378889, "process_kernel_time": 0.117905, "process_mem_max_rss": "100648", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:38.201842 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:38.201736 after 0.18 seconds
[0m06:02:38.202278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09e3dfdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09e191070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09dc7fec0>]}
[0m06:02:38.202735 [debug] [MainThread]: Flushing usage events
[0m14:07:02.178089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e2f9efe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e2fbb43e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e2fbb6cc0>]}


============================== 14:07:02.236828 | 28717da5-7b7e-4a88-95dd-404cec5330be ==============================
[0m14:07:02.236828 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:02.237568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:02.361410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28717da5-7b7e-4a88-95dd-404cec5330be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e2ecc5550>]}
[0m14:07:02.377908 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-b4rm277v'
[0m14:07:02.378446 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:07:02.496980 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:07:02.497744 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:07:02.521325 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:07:02.525342 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:07:02.598143 [info ] [MainThread]: Installed from version 1.2.0
[0m14:07:02.598739 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:07:02.599362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '28717da5-7b7e-4a88-95dd-404cec5330be', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e2ff10500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e30b0a7b0>]}
[0m14:07:02.599862 [info ] [MainThread]: 
[0m14:07:02.600385 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:07:02.606410 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47777846, "process_user_time": 1.5529, "process_kernel_time": 0.157888, "process_mem_max_rss": "101876", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m14:07:02.606995 [debug] [MainThread]: Command `dbt deps` succeeded at 14:07:02.606885 after 0.48 seconds
[0m14:07:02.607428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e2fd67bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e331d4800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e2fbb6cc0>]}
[0m14:07:02.607877 [debug] [MainThread]: Flushing usage events
[0m14:07:04.268576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93ce1823f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93ce14af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93ce14b890>]}


============================== 14:07:04.271833 | c46a9e90-31b7-45f5-b2f4-e705e97070e1 ==============================
[0m14:07:04.271833 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:04.272582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:04.476466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cd3eec30>]}
[0m14:07:04.536025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cf4b1100>]}
[0m14:07:04.538678 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:07:04.563857 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:07:04.564567 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:07:04.565095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cd579df0>]}
[0m14:07:05.869658 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:07:05.870319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93c93636e0>]}
[0m14:07:06.106635 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:07:06.112225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93d0477980>]}
[0m14:07:06.228525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93c93f53d0>]}
[0m14:07:06.229114 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:07:06.229629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93d15b81a0>]}
[0m14:07:06.231523 [info ] [MainThread]: 
[0m14:07:06.232256 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:07:06.236976 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:07:06.272582 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:07:06.273108 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:07:06.273534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:06.627099 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:06.628947 [debug] [ThreadPool]: On list_petro: Close
[0m14:07:06.630117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:07:06.630734 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:07:06.639010 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:06.639492 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:07:06.639930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:06.640986 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:06.642768 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:06.643288 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:07:06.644249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:06.644649 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:06.645062 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:07:06.645680 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:06.646786 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:06.647406 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:06.647975 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:06.648748 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:06.649331 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:07:06.650786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:07:06.656968 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:06.657378 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:07:06.657753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:06.658420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:06.658810 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:06.659226 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:07:06.669254 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:06.670714 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:07:06.671966 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:07:06.672367 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:07:06.674635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93c7d6e4e0>]}
[0m14:07:06.675151 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:06.675524 [debug] [MainThread]: On master: BEGIN
[0m14:07:06.675897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:06.676498 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:06.676924 [debug] [MainThread]: On master: COMMIT
[0m14:07:06.677297 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:06.677672 [debug] [MainThread]: On master: COMMIT
[0m14:07:06.678257 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:06.678646 [debug] [MainThread]: On master: Close
[0m14:07:06.679204 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:07:06.679699 [info ] [MainThread]: 
[0m14:07:06.699916 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:07:06.700505 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:07:06.701152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:07:06.701596 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:07:06.728410 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:07:06.729175 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:07:06.764510 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:07:06.765280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:13.115154 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:13.115646 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:07:13.116330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.116769 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:13.117221 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:07:13.117917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.120808 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:13.121270 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:07:13.121980 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.138825 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:13.139305 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:13.139731 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:13.141025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.146714 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:13.147187 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:07:13.148336 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.150694 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:07:13.152280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93c93198e0>]}
[0m14:07:13.152989 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.45s]
[0m14:07:13.153743 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:07:13.154698 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:07:13.155277 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:07:13.155899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:07:13.156341 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:07:13.161271 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:07:13.161930 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:07:13.197986 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:13.198504 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250724140713191810"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:07:13.198981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:13.207172 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.215162 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:13.215627 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:07:13.216301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.216737 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:13.217202 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250724140713191810'
      
      
      order by ordinal_position

  
[0m14:07:13.219507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.224767 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:13.225252 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:13.227701 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.235780 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:13.236346 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:13.238570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.257050 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:07:13.257761 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:13.258235 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250724140713191810"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250724140713191810"
    )
  
[0m14:07:13.308139 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.310248 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:13.310747 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:13.311216 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:13.319088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:13.320122 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:07:13.321671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c46a9e90-31b7-45f5-b2f4-e705e97070e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938b2d1520>]}
[0m14:07:13.322397 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:07:13.323174 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:07:13.324721 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:13.325172 [debug] [MainThread]: On master: BEGIN
[0m14:07:13.325543 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:13.326303 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:13.326696 [debug] [MainThread]: On master: COMMIT
[0m14:07:13.327106 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:13.327464 [debug] [MainThread]: On master: COMMIT
[0m14:07:13.327991 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:13.328384 [debug] [MainThread]: On master: Close
[0m14:07:13.329003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:13.329377 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:07:13.329778 [info ] [MainThread]: 
[0m14:07:13.330277 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.10 seconds (7.10s).
[0m14:07:13.331230 [debug] [MainThread]: Command end result
[0m14:07:13.358817 [info ] [MainThread]: 
[0m14:07:13.359559 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:13.360146 [info ] [MainThread]: 
[0m14:07:13.360684 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:07:13.361752 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.143076, "process_user_time": 4.694747, "process_kernel_time": 0.286289, "process_mem_max_rss": "325044", "process_in_blocks": "1200", "process_out_blocks": "100096"}
[0m14:07:13.362345 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:13.362235 after 9.14 seconds
[0m14:07:13.362798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cd7bd5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938b281430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cd77a3c0>]}
[0m14:07:13.363265 [debug] [MainThread]: Flushing usage events
[0m14:07:15.283879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd7b3335f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd7ad8b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd7b6591c0>]}


============================== 14:07:15.287111 | 79268778-ad0f-4a60-bb66-983daa7d1555 ==============================
[0m14:07:15.287111 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:15.287757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:15.396610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79268778-ad0f-4a60-bb66-983daa7d1555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd7a8c7980>]}
[0m14:07:15.415007 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18095037, "process_user_time": 1.359756, "process_kernel_time": 0.11098, "process_mem_max_rss": "100488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:07:15.415548 [debug] [MainThread]: Command `dbt clean` succeeded at 14:07:15.415444 after 0.18 seconds
[0m14:07:15.416004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd7b4b6a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd7c76b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd7a922120>]}
[0m14:07:15.416427 [debug] [MainThread]: Flushing usage events
[0m22:07:06.619221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce3542120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce3542840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce35408f0>]}


============================== 22:07:06.627395 | 5d69615c-6701-4a2d-be20-f34f1bb86b2a ==============================
[0m22:07:06.627395 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:06.628080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:06.769529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d69615c-6701-4a2d-be20-f34f1bb86b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce4508ad0>]}
[0m22:07:06.784077 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fhsz6zek'
[0m22:07:06.784535 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:07:06.902098 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:07:06.902723 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:07:06.954771 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:07:06.958605 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:07:07.090506 [info ] [MainThread]: Installed from version 1.2.0
[0m22:07:07.091032 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:07:07.091571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5d69615c-6701-4a2d-be20-f34f1bb86b2a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce3fa3800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce46e7e00>]}
[0m22:07:07.091993 [info ] [MainThread]: 
[0m22:07:07.092501 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:07:07.104628 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5342723, "process_user_time": 1.531053, "process_kernel_time": 0.144193, "process_mem_max_rss": "101480", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m22:07:07.105175 [debug] [MainThread]: Command `dbt deps` succeeded at 22:07:07.105067 after 0.53 seconds
[0m22:07:07.105615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce7ad38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce6262240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdce34c0a10>]}
[0m22:07:07.106019 [debug] [MainThread]: Flushing usage events
[0m22:07:08.674148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d9b81970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d9b9b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d9b82c60>]}


============================== 22:07:08.677146 | a9c0a754-7260-4744-8b23-6a4343c971b6 ==============================
[0m22:07:08.677146 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:08.677841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:07:08.876490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9c0a754-7260-4744-8b23-6a4343c971b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d9dadc70>]}
[0m22:07:08.935190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9c0a754-7260-4744-8b23-6a4343c971b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d8838110>]}
[0m22:07:08.937729 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:07:08.973939 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:07:08.974639 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:07:08.975166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a9c0a754-7260-4744-8b23-6a4343c971b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d8996360>]}
[0m22:07:10.261205 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:07:10.261851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a9c0a754-7260-4744-8b23-6a4343c971b6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d4693020>]}
[0m22:07:10.493954 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:07:10.499483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9c0a754-7260-4744-8b23-6a4343c971b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d944ac30>]}
[0m22:07:10.636364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9c0a754-7260-4744-8b23-6a4343c971b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d46e2240>]}
[0m22:07:10.636962 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:07:10.637478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9c0a754-7260-4744-8b23-6a4343c971b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d46ddd00>]}
[0m22:07:10.639375 [info ] [MainThread]: 
[0m22:07:10.640133 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:07:10.644884 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:07:10.679876 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:07:10.680301 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:07:10.680716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:11.014549 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:11.016313 [debug] [ThreadPool]: On list_petro: Close
[0m22:07:11.017438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:07:11.018159 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:07:11.027489 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:11.027964 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:07:11.028365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:11.029362 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:11.030829 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:11.031293 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:07:11.031919 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:11.032422 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:11.032903 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:07:11.033548 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:11.034476 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:11.034868 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:11.035232 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:11.035759 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:11.036147 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:07:11.037361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:07:11.042970 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:11.043472 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:07:11.043847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:11.044477 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:11.044865 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:11.045235 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:07:11.054905 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:11.056333 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:07:11.057576 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:07:11.057973 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:07:11.060303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9c0a754-7260-4744-8b23-6a4343c971b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d4681ca0>]}
[0m22:07:11.060831 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:11.061206 [debug] [MainThread]: On master: BEGIN
[0m22:07:11.061590 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:11.062181 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:11.062603 [debug] [MainThread]: On master: COMMIT
[0m22:07:11.062973 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:11.063335 [debug] [MainThread]: On master: COMMIT
[0m22:07:11.063871 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:11.064250 [debug] [MainThread]: On master: Close
[0m22:07:11.064809 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:07:11.065302 [info ] [MainThread]: 
[0m22:07:11.081614 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:07:11.082203 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:07:11.082871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:07:11.083304 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:07:11.109837 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:07:11.110593 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:07:11.145606 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:07:11.146342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:21.400957 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:21.401491 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:21.402149 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:21.402602 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:21.403016 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:21.403737 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:21.406704 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:21.407144 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:21.407845 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:21.424441 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:21.424899 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:21.425316 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:21.426771 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:21.432393 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:21.432867 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:21.434175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:21.436519 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:21.438035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9c0a754-7260-4744-8b23-6a4343c971b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d31c9850>]}
[0m22:07:21.438727 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.35s]
[0m22:07:21.439566 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:21.440342 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:21.440921 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:21.441575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:21.442026 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:21.447035 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:21.447828 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:21.483601 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:21.484093 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250724220721477571"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:21.484566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:21.492455 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:21.500017 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:21.500491 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:21.501160 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:21.501629 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:21.502054 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250724220721477571'
      
      
      order by ordinal_position

  
[0m22:07:21.504172 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:21.510052 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:21.510544 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:21.513579 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:21.521147 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:21.521622 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:21.524257 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:21.542250 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:21.542947 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:21.543402 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250724220721477571"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250724220721477571"
    )
  
[0m22:07:21.593078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:21.595095 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:21.595581 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:21.595998 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:21.603506 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:21.604401 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:21.605735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9c0a754-7260-4744-8b23-6a4343c971b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5977f2570>]}
[0m22:07:21.606429 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:07:21.607238 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:21.608884 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:21.609303 [debug] [MainThread]: On master: BEGIN
[0m22:07:21.609724 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:21.610384 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:21.610813 [debug] [MainThread]: On master: COMMIT
[0m22:07:21.611179 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:21.611585 [debug] [MainThread]: On master: COMMIT
[0m22:07:21.612146 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:21.612586 [debug] [MainThread]: On master: Close
[0m22:07:21.613172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:21.613564 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:21.613963 [info ] [MainThread]: 
[0m22:07:21.614443 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.97 seconds (10.97s).
[0m22:07:21.615351 [debug] [MainThread]: Command end result
[0m22:07:21.641173 [info ] [MainThread]: 
[0m22:07:21.641734 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:21.642181 [info ] [MainThread]: 
[0m22:07:21.642648 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:21.643584 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.017995, "process_user_time": 4.924604, "process_kernel_time": 0.27958, "process_mem_max_rss": "334172", "process_in_blocks": "1200", "process_out_blocks": "100136"}
[0m22:07:21.644123 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:21.644021 after 13.02 seconds
[0m22:07:21.644577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d959bce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d8a7a480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd596d1a840>]}
[0m22:07:21.644998 [debug] [MainThread]: Flushing usage events
[0m22:07:23.533432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcceec485f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccefd7eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccefd7c890>]}


============================== 22:07:23.536551 | 767428ad-2f50-4c98-9e70-87e163029f05 ==============================
[0m22:07:23.536551 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:23.537181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:07:23.643990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '767428ad-2f50-4c98-9e70-87e163029f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcceedf0ce0>]}
[0m22:07:23.661763 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17707705, "process_user_time": 1.308409, "process_kernel_time": 0.112949, "process_mem_max_rss": "100728", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:07:23.662288 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:23.662189 after 0.18 seconds
[0m22:07:23.662727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccefd7e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcceebcdee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcceedf0ce0>]}
[0m22:07:23.663133 [debug] [MainThread]: Flushing usage events
[0m06:02:24.191764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2238d6a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22389f03e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f223aaf13a0>]}


============================== 06:02:24.206677 | 912863ff-46c3-4eea-b19c-617e39c5b180 ==============================
[0m06:02:24.206677 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.207314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.327995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '912863ff-46c3-4eea-b19c-617e39c5b180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2239c519d0>]}
[0m06:02:24.342398 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-o5wwv6ot'
[0m06:02:24.342849 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:24.487996 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:24.488583 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:24.538079 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:24.541813 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:24.733613 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:24.734111 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:24.734601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '912863ff-46c3-4eea-b19c-617e39c5b180', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f223ab84320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2238348b00>]}
[0m06:02:24.735047 [info ] [MainThread]: 
[0m06:02:24.735509 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:24.740532 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5977208, "process_user_time": 1.544534, "process_kernel_time": 0.14023, "process_mem_max_rss": "101612", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m06:02:24.741071 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:24.740970 after 0.60 seconds
[0m06:02:24.741472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2238080950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2237da58e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2237da6540>]}
[0m06:02:24.741914 [debug] [MainThread]: Flushing usage events
[0m06:02:26.372827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e15dbc260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e153e9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e17f71550>]}


============================== 06:02:26.375878 | 84e5d6c1-2eea-4108-921e-a9099c5f7e8c ==============================
[0m06:02:26.375878 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:26.376499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:26.575567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84e5d6c1-2eea-4108-921e-a9099c5f7e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e151f5040>]}
[0m06:02:26.634028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84e5d6c1-2eea-4108-921e-a9099c5f7e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e170d3140>]}
[0m06:02:26.636500 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:26.663993 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:26.664684 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:26.665211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '84e5d6c1-2eea-4108-921e-a9099c5f7e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e15f678f0>]}
[0m06:02:27.950271 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:27.950924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '84e5d6c1-2eea-4108-921e-a9099c5f7e8c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e10e0b350>]}
[0m06:02:28.176079 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:28.181466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84e5d6c1-2eea-4108-921e-a9099c5f7e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e10d37e60>]}
[0m06:02:28.304077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84e5d6c1-2eea-4108-921e-a9099c5f7e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e10e0adb0>]}
[0m06:02:28.304554 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:28.305062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84e5d6c1-2eea-4108-921e-a9099c5f7e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e10df4c20>]}
[0m06:02:28.306837 [info ] [MainThread]: 
[0m06:02:28.307490 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:28.312054 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:28.346002 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:28.346422 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:28.346823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:28.951817 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:28.953613 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:28.954710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:28.955354 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:28.964202 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:28.964683 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:28.965118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:28.966046 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.967349 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:28.967760 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:28.968336 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.968746 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:28.969120 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:28.969690 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.970608 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:28.971024 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:28.971389 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:28.971927 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.972319 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:28.973526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:28.979128 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:28.979615 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:28.980002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:28.980636 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.981044 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:28.981414 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:28.991484 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:28.992931 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:28.994170 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:28.994561 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:28.996868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84e5d6c1-2eea-4108-921e-a9099c5f7e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e0f952000>]}
[0m06:02:28.997360 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:28.997750 [debug] [MainThread]: On master: BEGIN
[0m06:02:28.998108 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:28.998701 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:28.999113 [debug] [MainThread]: On master: COMMIT
[0m06:02:28.999473 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:28.999844 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.000357 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.000757 [debug] [MainThread]: On master: Close
[0m06:02:29.001276 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:29.001741 [info ] [MainThread]: 
[0m06:02:29.013093 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:29.013665 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:29.014236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:29.014666 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:29.041033 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:29.041778 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:29.076629 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:29.077357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:37.633661 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:37.634165 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:37.634832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.635267 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:37.635683 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:37.636414 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.639293 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:37.639750 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:37.640603 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.657501 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:37.657975 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:37.658395 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:37.659499 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.665050 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:37.665504 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:37.666662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.668977 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:37.670484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e5d6c1-2eea-4108-921e-a9099c5f7e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e1706e5a0>]}
[0m06:02:37.671169 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.66s]
[0m06:02:37.671930 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:37.672903 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:37.673447 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:37.674013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:37.674440 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:37.679267 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:37.679897 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:37.716039 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.716517 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250725060237710017"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:37.716988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:37.724569 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.731923 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.732368 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:37.732978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.733414 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.733859 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250725060237710017'
      
      
      order by ordinal_position

  
[0m06:02:37.735968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.740976 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.741431 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:37.743446 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.750974 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.751431 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:37.754269 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.772262 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:37.772943 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.773394 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250725060237710017"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250725060237710017"
    )
  
[0m06:02:37.823224 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.825236 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:37.825683 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.826122 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:37.833548 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.834476 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:37.836049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e5d6c1-2eea-4108-921e-a9099c5f7e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e04591910>]}
[0m06:02:37.836753 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:37.837488 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:37.838871 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:37.839281 [debug] [MainThread]: On master: BEGIN
[0m06:02:37.839651 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:37.840323 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:37.840739 [debug] [MainThread]: On master: COMMIT
[0m06:02:37.841123 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:37.841480 [debug] [MainThread]: On master: COMMIT
[0m06:02:37.842020 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:37.842404 [debug] [MainThread]: On master: Close
[0m06:02:37.843006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:37.843372 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:37.843781 [info ] [MainThread]: 
[0m06:02:37.844236 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.54 seconds (9.54s).
[0m06:02:37.845151 [debug] [MainThread]: Command end result
[0m06:02:37.870538 [info ] [MainThread]: 
[0m06:02:37.871104 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:37.871549 [info ] [MainThread]: 
[0m06:02:37.872025 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:37.872936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.549038, "process_user_time": 5.175515, "process_kernel_time": 0.285028, "process_mem_max_rss": "349712", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:37.873469 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:37.873369 after 11.55 seconds
[0m06:02:37.873917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e174e1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e111b3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e157e6330>]}
[0m06:02:37.874330 [debug] [MainThread]: Flushing usage events
[0m06:02:40.115613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f42c1e2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f43156e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f42be6fc0>]}


============================== 06:02:40.118767 | 0876ed5e-4939-4ad3-a274-7c486d9a9043 ==============================
[0m06:02:40.118767 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:40.119461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:40.232305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0876ed5e-4939-4ad3-a274-7c486d9a9043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f43479220>]}
[0m06:02:40.250000 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18619837, "process_user_time": 1.328227, "process_kernel_time": 0.103939, "process_mem_max_rss": "100428", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:40.250513 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:40.250412 after 0.19 seconds
[0m06:02:40.250959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f429e75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f429c4200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f43479220>]}
[0m06:02:40.251367 [debug] [MainThread]: Flushing usage events
[0m14:06:39.031986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd9884b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd9e156d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd9e14470>]}


============================== 14:06:39.049709 | cfb2c60d-45b6-48b6-83d2-3a3308a3981b ==============================
[0m14:06:39.049709 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:39.050499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:39.185832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfb2c60d-45b6-48b6-83d2-3a3308a3981b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cda24dd90>]}
[0m14:06:39.201803 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-68n_s3ji'
[0m14:06:39.202350 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:39.338004 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:39.338778 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:39.362119 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:39.366016 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:39.477309 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:39.477939 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:06:39.478497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cfb2c60d-45b6-48b6-83d2-3a3308a3981b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd92ebf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd91a6000>]}
[0m14:06:39.478971 [info ] [MainThread]: 
[0m14:06:39.479455 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:39.485117 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5027931, "process_user_time": 1.568669, "process_kernel_time": 0.166434, "process_mem_max_rss": "101388", "process_in_blocks": "8496", "process_out_blocks": "5168"}
[0m14:06:39.485667 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:39.485562 after 0.50 seconds
[0m14:06:39.486123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd9fe89b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cda24dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cdb534590>]}
[0m14:06:39.486548 [debug] [MainThread]: Flushing usage events
[0m14:06:41.141043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee89082ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee8877f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee886b6360>]}


============================== 14:06:41.144382 | c6dc69f3-ff0c-4d9c-a8a2-25bd9f0b9f29 ==============================
[0m14:06:41.144382 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:41.145059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:41.350068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6dc69f3-ff0c-4d9c-a8a2-25bd9f0b9f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee885fb020>]}
[0m14:06:41.409153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6dc69f3-ff0c-4d9c-a8a2-25bd9f0b9f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee885fb140>]}
[0m14:06:41.411961 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:06:41.450296 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:41.451070 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:41.451583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c6dc69f3-ff0c-4d9c-a8a2-25bd9f0b9f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee84513440>]}
[0m14:06:42.747199 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:42.747854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c6dc69f3-ff0c-4d9c-a8a2-25bd9f0b9f29', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee844c9e80>]}
[0m14:06:42.987344 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:42.992960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6dc69f3-ff0c-4d9c-a8a2-25bd9f0b9f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee84293680>]}
[0m14:06:43.094895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6dc69f3-ff0c-4d9c-a8a2-25bd9f0b9f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee84257980>]}
[0m14:06:43.095524 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:06:43.096052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6dc69f3-ff0c-4d9c-a8a2-25bd9f0b9f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee84275bb0>]}
[0m14:06:43.097967 [info ] [MainThread]: 
[0m14:06:43.098679 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:43.103538 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:43.138741 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:43.139262 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:43.139649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:43.476271 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:43.478419 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:43.479682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:43.480385 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:43.489579 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:43.490011 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:43.490392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:43.491265 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:43.492564 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:43.492967 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:43.493535 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:43.493941 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:43.494315 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:43.494867 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:43.495809 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:43.496223 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:43.496583 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:43.497112 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:43.497503 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:43.498747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:43.504461 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:43.504978 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:43.505349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:43.505976 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:43.506361 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:43.506730 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:43.516420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:43.517991 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:43.519265 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:43.519662 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:43.521950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6dc69f3-ff0c-4d9c-a8a2-25bd9f0b9f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee82c62750>]}
[0m14:06:43.522466 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:43.522843 [debug] [MainThread]: On master: BEGIN
[0m14:06:43.523243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:43.523877 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:43.524298 [debug] [MainThread]: On master: COMMIT
[0m14:06:43.524664 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:43.525044 [debug] [MainThread]: On master: COMMIT
[0m14:06:43.525627 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:43.526059 [debug] [MainThread]: On master: Close
[0m14:06:43.526585 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:43.527109 [info ] [MainThread]: 
[0m14:06:43.542941 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:43.543599 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:43.544206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:43.544642 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:43.571677 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:43.572468 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:43.607792 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:43.608596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:51.986111 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:51.986640 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:51.987374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:51.987806 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:51.988271 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:51.989008 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:51.992063 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:51.992514 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:51.993190 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:52.010352 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:52.010964 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:52.011414 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:52.013658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:52.020126 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:52.020631 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:52.022331 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:52.024849 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:52.026487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6dc69f3-ff0c-4d9c-a8a2-25bd9f0b9f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee82dc4bf0>]}
[0m14:06:52.027202 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.48s]
[0m14:06:52.027981 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:52.028975 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:52.029528 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:52.030104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:52.030535 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:52.036038 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:52.036797 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:52.074199 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:52.074790 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250725140652067925"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:52.075266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:52.083438 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:52.091693 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:52.092196 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:52.092862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:52.093321 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:52.093739 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250725140652067925'
      
      
      order by ordinal_position

  
[0m14:06:52.096258 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:52.101710 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:52.102220 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:52.105236 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:52.113603 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:52.114123 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:52.116555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:52.135139 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:52.135918 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:52.136393 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250725140652067925"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250725140652067925"
    )
  
[0m14:06:52.183374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:52.185366 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:52.185834 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:52.186274 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:52.192935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:52.193840 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:52.195365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6dc69f3-ff0c-4d9c-a8a2-25bd9f0b9f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee4a80c950>]}
[0m14:06:52.196062 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:06:52.196795 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:52.198127 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:52.198546 [debug] [MainThread]: On master: BEGIN
[0m14:06:52.198941 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:52.199604 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:52.200042 [debug] [MainThread]: On master: COMMIT
[0m14:06:52.200414 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:52.200774 [debug] [MainThread]: On master: COMMIT
[0m14:06:52.201330 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:52.201718 [debug] [MainThread]: On master: Close
[0m14:06:52.202370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:52.202733 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:52.203164 [info ] [MainThread]: 
[0m14:06:52.203684 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.10 seconds (9.10s).
[0m14:06:52.204690 [debug] [MainThread]: Command end result
[0m14:06:52.230625 [info ] [MainThread]: 
[0m14:06:52.231274 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:52.231791 [info ] [MainThread]: 
[0m14:06:52.232333 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:52.233340 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.142082, "process_user_time": 5.015992, "process_kernel_time": 0.28975, "process_mem_max_rss": "341836", "process_in_blocks": "1200", "process_out_blocks": "100096"}
[0m14:06:52.233890 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:52.233785 after 11.14 seconds
[0m14:06:52.234366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee886b55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee8b2151c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee88a6e240>]}
[0m14:06:52.234794 [debug] [MainThread]: Flushing usage events
[0m14:06:54.121059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b2581a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b50dd2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b2bb63f0>]}


============================== 14:06:54.124286 | 5dd43cbb-9619-4fcc-889a-af95ab9dfdb7 ==============================
[0m14:06:54.124286 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:54.125074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:06:54.256392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dd43cbb-9619-4fcc-889a-af95ab9dfdb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b294b9b0>]}
[0m14:06:54.274646 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20377912, "process_user_time": 1.364794, "process_kernel_time": 0.112982, "process_mem_max_rss": "100796", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:54.275306 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:54.275198 after 0.20 seconds
[0m14:06:54.275740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b3032a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b294b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b3041370>]}
[0m14:06:54.276194 [debug] [MainThread]: Flushing usage events
[0m22:06:19.003703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cba4ef7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cba944530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cba4efdd0>]}


============================== 22:06:19.021137 | e5f4a359-30fb-4cd2-8dd1-6426cf237d12 ==============================
[0m22:06:19.021137 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:19.021848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:19.146875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5f4a359-30fb-4cd2-8dd1-6426cf237d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cbb508e00>]}
[0m22:06:19.161417 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-j152reee'
[0m22:06:19.161865 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:19.345528 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:19.346150 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:19.370603 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:19.374325 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:19.445875 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:19.446375 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:19.446944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e5f4a359-30fb-4cd2-8dd1-6426cf237d12', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cbabd8b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cba944980>]}
[0m22:06:19.447374 [info ] [MainThread]: 
[0m22:06:19.447891 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:19.449704 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49485487, "process_user_time": 1.535902, "process_kernel_time": 0.13981, "process_mem_max_rss": "101544", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m22:06:19.450261 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:19.450161 after 0.50 seconds
[0m22:06:19.450667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cba6b1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cba2a8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cba65b770>]}
[0m22:06:19.451101 [debug] [MainThread]: Flushing usage events
[0m22:06:21.060154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa014ed3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ff9f0b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ff57f980>]}


============================== 22:06:21.063203 | feab8278-5a81-4a75-a677-b891902fbc5b ==============================
[0m22:06:21.063203 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:21.063898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:21.266087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'feab8278-5a81-4a75-a677-b891902fbc5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ff211280>]}
[0m22:06:21.325122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'feab8278-5a81-4a75-a677-b891902fbc5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ff2a08c0>]}
[0m22:06:21.327711 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:21.344002 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:21.344683 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:21.345217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'feab8278-5a81-4a75-a677-b891902fbc5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9fb319df0>]}
[0m22:06:22.631581 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:22.632201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'feab8278-5a81-4a75-a677-b891902fbc5b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9fb3fc710>]}
[0m22:06:22.856882 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:22.862232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'feab8278-5a81-4a75-a677-b891902fbc5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9fb015c10>]}
[0m22:06:22.999719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'feab8278-5a81-4a75-a677-b891902fbc5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9fb0f2930>]}
[0m22:06:23.000233 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:23.000699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feab8278-5a81-4a75-a677-b891902fbc5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9fb16f8f0>]}
[0m22:06:23.002539 [info ] [MainThread]: 
[0m22:06:23.003228 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:23.007779 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:23.041640 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:23.042087 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:23.042465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:23.535414 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:23.537308 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:23.538446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:23.539107 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:23.547829 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:23.548314 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:23.548892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:23.550104 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:23.551545 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:23.551999 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:23.552645 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:23.553103 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:23.553497 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:23.554153 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:23.555309 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:23.555744 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:23.556246 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:23.556941 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:23.557404 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:23.558739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:23.564464 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:23.564888 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:23.565247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:23.565868 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:23.566254 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:23.566621 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:23.576539 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:23.577986 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:23.579211 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:23.579604 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:23.581714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feab8278-5a81-4a75-a677-b891902fbc5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa01188fe0>]}
[0m22:06:23.582248 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:23.582621 [debug] [MainThread]: On master: BEGIN
[0m22:06:23.583013 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:23.583613 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:23.584041 [debug] [MainThread]: On master: COMMIT
[0m22:06:23.584409 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:23.584791 [debug] [MainThread]: On master: COMMIT
[0m22:06:23.585343 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:23.585729 [debug] [MainThread]: On master: Close
[0m22:06:23.586289 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:23.586781 [info ] [MainThread]: 
[0m22:06:23.598117 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:23.598689 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:23.599338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:23.599788 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:23.626544 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:23.627307 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:23.662415 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:23.663152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:31.022549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:31.023045 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:31.023702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.024160 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:31.024569 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:31.025283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.028105 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:31.028533 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:31.029209 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.045633 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:31.046101 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:31.046510 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:31.048600 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.054156 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:31.054596 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:31.056173 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.058481 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:31.060009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feab8278-5a81-4a75-a677-b891902fbc5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c210bbf0>]}
[0m22:06:31.060676 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.46s]
[0m22:06:31.061435 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:31.062241 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:31.062917 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:31.063619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:31.064075 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:31.068886 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:31.069509 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:31.105345 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.105844 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250725220631099390"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:31.106297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:31.114414 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.121925 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.122370 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:31.122974 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.123412 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.123850 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250725220631099390'
      
      
      order by ordinal_position

  
[0m22:06:31.126253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.131337 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.131801 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:31.133903 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.141450 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.141915 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:31.144012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.161925 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:31.162601 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.163071 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250725220631099390"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250725220631099390"
    )
  
[0m22:06:31.213920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.215893 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:31.216328 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.216730 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:31.223715 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.224619 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:31.226176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feab8278-5a81-4a75-a677-b891902fbc5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f00ca0c0>]}
[0m22:06:31.226862 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:06:31.227574 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:31.229066 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.229466 [debug] [MainThread]: On master: BEGIN
[0m22:06:31.229864 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:31.230475 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.230902 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.231270 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.231623 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.232181 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.232566 [debug] [MainThread]: On master: Close
[0m22:06:31.233174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:31.233534 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:31.233944 [info ] [MainThread]: 
[0m22:06:31.234416 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.23 seconds (8.23s).
[0m22:06:31.235406 [debug] [MainThread]: Command end result
[0m22:06:31.261146 [info ] [MainThread]: 
[0m22:06:31.261847 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:31.262326 [info ] [MainThread]: 
[0m22:06:31.262826 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:31.263801 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.251911, "process_user_time": 5.068354, "process_kernel_time": 0.307839, "process_mem_max_rss": "338972", "process_in_blocks": "1200", "process_out_blocks": "100144"}
[0m22:06:31.264338 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:31.264237 after 10.25 seconds
[0m22:06:31.264789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa01f89340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0112a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c74b27b0>]}
[0m22:06:31.265214 [debug] [MainThread]: Flushing usage events
[0m22:06:33.059648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8283c11bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82854494f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82836a85f0>]}


============================== 22:06:33.062702 | 64f95532-cdb9-4fd8-8627-0e10ab712e12 ==============================
[0m22:06:33.062702 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:33.063350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:33.169502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64f95532-cdb9-4fd8-8627-0e10ab712e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82831974d0>]}
[0m22:06:33.187021 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17579474, "process_user_time": 1.304634, "process_kernel_time": 0.110883, "process_mem_max_rss": "100740", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:33.187532 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:33.187431 after 0.18 seconds
[0m22:06:33.187961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82833ec950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82840dea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8283e4a3c0>]}
[0m22:06:33.188383 [debug] [MainThread]: Flushing usage events
[0m06:02:20.103442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbd0cc770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dba4f9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbb689f40>]}


============================== 06:02:20.120889 | ba435fae-7045-4ffa-ac38-8e16f1064d52 ==============================
[0m06:02:20.120889 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:20.121582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:20.251533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba435fae-7045-4ffa-ac38-8e16f1064d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbb5009e0>]}
[0m06:02:20.266882 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jaeffff_'
[0m06:02:20.267393 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:20.373933 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:20.374696 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:20.424501 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:20.428389 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:20.654076 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:20.654708 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:20.655304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ba435fae-7045-4ffa-ac38-8e16f1064d52', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbab689e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dba53cec0>]}
[0m06:02:20.655756 [info ] [MainThread]: 
[0m06:02:20.656278 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:20.662359 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.61071265, "process_user_time": 1.602535, "process_kernel_time": 0.137045, "process_mem_max_rss": "101400", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m06:02:20.662897 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:20.662795 after 0.61 seconds
[0m06:02:20.663342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbab91d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dba25c260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbb918860>]}
[0m06:02:20.663747 [debug] [MainThread]: Flushing usage events
[0m06:02:22.446800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a98c7b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9854ec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a986e1f10>]}


============================== 06:02:22.450002 | 041da666-ff15-435d-9eca-d5e4272a079e ==============================
[0m06:02:22.450002 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:22.450679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:22.654952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '041da666-ff15-435d-9eca-d5e4272a079e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a97f34500>]}
[0m06:02:22.714437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '041da666-ff15-435d-9eca-d5e4272a079e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a998b0e00>]}
[0m06:02:22.717087 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:22.742455 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:22.743210 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:22.743728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '041da666-ff15-435d-9eca-d5e4272a079e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a97a75a30>]}
[0m06:02:24.041607 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:24.042282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '041da666-ff15-435d-9eca-d5e4272a079e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a977fc170>]}
[0m06:02:24.271010 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:24.276624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '041da666-ff15-435d-9eca-d5e4272a079e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a93760200>]}
[0m06:02:24.377642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '041da666-ff15-435d-9eca-d5e4272a079e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a97933170>]}
[0m06:02:24.378229 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:24.378728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '041da666-ff15-435d-9eca-d5e4272a079e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a937eb410>]}
[0m06:02:24.380613 [info ] [MainThread]: 
[0m06:02:24.381324 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:24.386079 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:24.421661 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:24.422253 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:24.422685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:25.013997 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:25.015695 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:25.016698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:25.017277 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:25.025098 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:25.025552 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:25.025932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:25.026862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.028239 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:25.028627 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:25.029200 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.029585 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:25.029955 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:25.030575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.031504 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:25.031893 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:25.032279 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:25.032818 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.033233 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:25.034682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:25.040643 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:25.041047 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:25.041432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:25.042028 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.042461 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:25.042833 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:25.052378 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.053828 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:25.055078 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:25.055500 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:25.057843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '041da666-ff15-435d-9eca-d5e4272a079e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a998b1040>]}
[0m06:02:25.058373 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.058758 [debug] [MainThread]: On master: BEGIN
[0m06:02:25.059116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:25.059746 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.060133 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.060546 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.060905 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.061485 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.061867 [debug] [MainThread]: On master: Close
[0m06:02:25.062408 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:25.062896 [info ] [MainThread]: 
[0m06:02:25.079609 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:25.080325 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:25.080972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:25.081478 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:25.108900 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:25.109722 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:25.145350 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:25.146104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:38.525430 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.525937 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:38.526634 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.527075 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.527596 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:38.528316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.531240 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.531682 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:38.532369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.549876 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.550360 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.550781 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.552527 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.558264 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.558724 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:38.560019 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.562421 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:38.563961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041da666-ff15-435d-9eca-d5e4272a079e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a922c08f0>]}
[0m06:02:38.564668 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 13.48s]
[0m06:02:38.565514 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:38.566337 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:38.566999 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:38.567750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:38.568228 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:38.573103 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:38.573762 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:38.610591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.611126 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250726060238604310"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:38.611608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:38.619544 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.627170 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.627628 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:38.628249 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.628687 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.629109 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250726060238604310'
      
      
      order by ordinal_position

  
[0m06:02:38.631286 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.636377 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.636842 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:38.638932 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.646569 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.647025 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:38.649244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.667601 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:38.668325 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.668777 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250726060238604310"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250726060238604310"
    )
  
[0m06:02:38.719589 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.721623 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:38.722070 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.722510 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:38.729689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.730603 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:38.731998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041da666-ff15-435d-9eca-d5e4272a079e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a595cad80>]}
[0m06:02:38.732696 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:38.733544 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:38.734902 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:38.735343 [debug] [MainThread]: On master: BEGIN
[0m06:02:38.735717 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:38.736385 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:38.736783 [debug] [MainThread]: On master: COMMIT
[0m06:02:38.737184 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:38.737556 [debug] [MainThread]: On master: COMMIT
[0m06:02:38.738095 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:38.738522 [debug] [MainThread]: On master: Close
[0m06:02:38.739137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:38.739548 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:38.739945 [info ] [MainThread]: 
[0m06:02:38.740483 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.36 seconds (14.36s).
[0m06:02:38.741492 [debug] [MainThread]: Command end result
[0m06:02:38.767703 [info ] [MainThread]: 
[0m06:02:38.768315 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:38.768792 [info ] [MainThread]: 
[0m06:02:38.769305 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:38.770302 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.37337, "process_user_time": 5.266992, "process_kernel_time": 0.279999, "process_mem_max_rss": "336084", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:38.770842 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:38.770738 after 16.37 seconds
[0m06:02:38.771301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a98c7b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a97eabb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a937eb380>]}
[0m06:02:38.771726 [debug] [MainThread]: Flushing usage events
[0m06:02:40.694418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ac9c2db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ac344530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ac081160>]}


============================== 06:02:40.697538 | 0c5d0a1f-6f62-4341-a3b9-ec535fc1de8a ==============================
[0m06:02:40.697538 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:40.698185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:40.806927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c5d0a1f-6f62-4341-a3b9-ec535fc1de8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14abfb9040>]}
[0m06:02:40.824743 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1799666, "process_user_time": 1.338272, "process_kernel_time": 0.120024, "process_mem_max_rss": "100852", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:40.825341 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:40.825223 after 0.18 seconds
[0m06:02:40.825776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ac3e7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ac081160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ac9c0110>]}
[0m06:02:40.826217 [debug] [MainThread]: Flushing usage events
[0m14:05:36.702061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175ec8ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175f0997f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175f098680>]}


============================== 14:05:36.719183 | b4974a95-ede5-4646-8b48-d6438607b4c2 ==============================
[0m14:05:36.719183 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:36.719863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:36.854659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4974a95-ede5-4646-8b48-d6438607b4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175f7de840>]}
[0m14:05:36.870301 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-egevn3gm'
[0m14:05:36.870842 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:36.938568 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:36.939283 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:36.951505 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:36.955475 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:37.162277 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:37.162870 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:37.163395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b4974a95-ede5-4646-8b48-d6438607b4c2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175e451820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175e4521b0>]}
[0m14:05:37.163884 [info ] [MainThread]: 
[0m14:05:37.164357 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:37.181401 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5284485, "process_user_time": 1.605081, "process_kernel_time": 0.140656, "process_mem_max_rss": "101664", "process_in_blocks": "8496", "process_out_blocks": "5168"}
[0m14:05:37.181997 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:37.181893 after 0.53 seconds
[0m14:05:37.182443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175e302810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175e2fb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175f031340>]}
[0m14:05:37.182866 [debug] [MainThread]: Flushing usage events
[0m14:05:39.053239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88b35a240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88a439430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88b3cd6a0>]}


============================== 14:05:39.056635 | e61e050f-7940-4184-b95a-ce1f54eda6db ==============================
[0m14:05:39.056635 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:39.057340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:39.261441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e61e050f-7940-4184-b95a-ce1f54eda6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8892b13a0>]}
[0m14:05:39.320772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e61e050f-7940-4184-b95a-ce1f54eda6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88933e4b0>]}
[0m14:05:39.323480 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:05:39.355685 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:39.356385 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:39.356925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e61e050f-7940-4184-b95a-ce1f54eda6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8894363f0>]}
[0m14:05:40.733984 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:40.734694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e61e050f-7940-4184-b95a-ce1f54eda6db', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8851f3080>]}
[0m14:05:40.982986 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:40.988782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e61e050f-7940-4184-b95a-ce1f54eda6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa884e7d370>]}
[0m14:05:41.103769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e61e050f-7940-4184-b95a-ce1f54eda6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa884f013d0>]}
[0m14:05:41.104366 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:05:41.104893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e61e050f-7940-4184-b95a-ce1f54eda6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8892ec860>]}
[0m14:05:41.106832 [info ] [MainThread]: 
[0m14:05:41.107570 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:41.112488 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:41.148074 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:41.148616 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:41.149007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:41.642395 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.644310 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:41.645495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:41.646162 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:41.654594 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:41.655052 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:41.655456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:41.656719 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.658130 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:41.658541 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:41.659133 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.659559 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:41.659934 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:41.660542 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.661513 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:41.661909 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:41.662282 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:41.662854 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.663260 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:41.664708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:41.670974 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:41.671406 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:41.671796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:41.672564 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.672957 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:41.673332 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:41.683255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.684993 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:41.686285 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:41.686710 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:41.689090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e61e050f-7940-4184-b95a-ce1f54eda6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88b1cd2e0>]}
[0m14:05:41.689649 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:41.690049 [debug] [MainThread]: On master: BEGIN
[0m14:05:41.690411 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:41.691096 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:41.691514 [debug] [MainThread]: On master: COMMIT
[0m14:05:41.691889 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:41.692247 [debug] [MainThread]: On master: COMMIT
[0m14:05:41.692829 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:41.693220 [debug] [MainThread]: On master: Close
[0m14:05:41.693819 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:41.694285 [info ] [MainThread]: 
[0m14:05:41.720031 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:41.720728 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:41.721352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:41.721818 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:41.749103 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:41.749996 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:41.785579 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:41.786519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:54.438376 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:54.438889 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:54.439563 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:54.440000 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:54.440414 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:54.441159 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:54.444077 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:54.444536 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:54.445239 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:54.461910 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:54.462370 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:54.462815 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:54.463941 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:54.469534 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:54.469987 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:05:54.471107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:54.473487 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:54.475015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61e050f-7940-4184-b95a-ce1f54eda6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa87004bc50>]}
[0m14:05:54.475714 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.75s]
[0m14:05:54.476479 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:54.477288 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:54.477867 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:54.478507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:54.478956 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:54.483824 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:54.484718 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:54.520143 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:54.520650 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250726140554514179"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:54.521098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:54.529007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:54.536573 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:54.537025 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:54.537625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:54.538058 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:54.538488 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250726140554514179'
      
      
      order by ordinal_position

  
[0m14:05:54.540644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:54.545761 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:54.546224 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:54.549016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:54.556625 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:54.557084 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:54.559702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:54.577722 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:54.578410 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:54.578887 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250726140554514179"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250726140554514179"
    )
  
[0m14:05:54.628766 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:54.630753 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:54.631193 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:54.631658 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:54.638685 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:54.639586 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:54.641129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61e050f-7940-4184-b95a-ce1f54eda6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa846d43cb0>]}
[0m14:05:54.641824 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:05:54.642627 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:54.644127 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:54.644578 [debug] [MainThread]: On master: BEGIN
[0m14:05:54.644958 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:54.645663 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:54.646066 [debug] [MainThread]: On master: COMMIT
[0m14:05:54.646463 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:54.646838 [debug] [MainThread]: On master: COMMIT
[0m14:05:54.647359 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:54.647780 [debug] [MainThread]: On master: Close
[0m14:05:54.648363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:54.648765 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:54.649159 [info ] [MainThread]: 
[0m14:05:54.649680 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.54 seconds (13.54s).
[0m14:05:54.650691 [debug] [MainThread]: Command end result
[0m14:05:54.676110 [info ] [MainThread]: 
[0m14:05:54.676714 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:54.677217 [info ] [MainThread]: 
[0m14:05:54.677751 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:54.678731 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.675079, "process_user_time": 4.759225, "process_kernel_time": 0.305206, "process_mem_max_rss": "309208", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m14:05:54.679260 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:54.679159 after 15.68 seconds
[0m14:05:54.679766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa889788ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa883d0ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8898de120>]}
[0m14:05:54.680196 [debug] [MainThread]: Flushing usage events
[0m14:05:56.734251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4438f89a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4437424530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44394dd220>]}


============================== 14:05:56.737327 | 2838932b-cb1c-4cd5-97a8-41f0d360c6e1 ==============================
[0m14:05:56.737327 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:56.737983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:56.845531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2838932b-cb1c-4cd5-97a8-41f0d360c6e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4436788290>]}
[0m14:05:56.863662 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1781128, "process_user_time": 1.339302, "process_kernel_time": 0.097021, "process_mem_max_rss": "100652", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:56.864208 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:56.864105 after 0.18 seconds
[0m14:05:56.864657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44369fd5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4436788290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f443678bec0>]}
[0m14:05:56.865084 [debug] [MainThread]: Flushing usage events
[0m22:06:19.543483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2af448560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2af96a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ad9deab0>]}


============================== 22:06:19.563841 | ed847480-22e7-4499-b052-28fd711a54ff ==============================
[0m22:06:19.563841 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:19.564543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:19.692558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed847480-22e7-4499-b052-28fd711a54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ad16f560>]}
[0m22:06:19.707786 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-74zrotnb'
[0m22:06:19.708275 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:19.885999 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:19.886783 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:19.896296 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:19.900171 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:19.949786 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:19.950436 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:19.951023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ed847480-22e7-4499-b052-28fd711a54ff', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ad38c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ad0a8770>]}
[0m22:06:19.951521 [info ] [MainThread]: 
[0m22:06:19.952024 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:19.960926 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46733162, "process_user_time": 1.581133, "process_kernel_time": 0.131593, "process_mem_max_rss": "101584", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m22:06:19.961538 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:19.961419 after 0.47 seconds
[0m22:06:19.961974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ad3455b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ad16f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ad049a30>]}
[0m22:06:19.962430 [debug] [MainThread]: Flushing usage events
[0m22:06:21.635624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23123d9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2311d85bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2311d59b50>]}


============================== 22:06:21.638782 | 3a16266b-7ca6-41be-9d38-c05532b559eb ==============================
[0m22:06:21.638782 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:21.639479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:21.845334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a16266b-7ca6-41be-9d38-c05532b559eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2312176c90>]}
[0m22:06:21.904344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a16266b-7ca6-41be-9d38-c05532b559eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2311be38f0>]}
[0m22:06:21.906974 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:21.934142 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:21.934870 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:21.935414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3a16266b-7ca6-41be-9d38-c05532b559eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2311b553a0>]}
[0m22:06:23.235174 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:23.235852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3a16266b-7ca6-41be-9d38-c05532b559eb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f230d93b380>]}
[0m22:06:23.470405 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:23.475932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a16266b-7ca6-41be-9d38-c05532b559eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f230d9637a0>]}
[0m22:06:23.579275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a16266b-7ca6-41be-9d38-c05532b559eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f230d9fab40>]}
[0m22:06:23.579849 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:23.580371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a16266b-7ca6-41be-9d38-c05532b559eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23121777a0>]}
[0m22:06:23.582300 [info ] [MainThread]: 
[0m22:06:23.583030 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:23.587928 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:23.623072 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:23.623547 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:23.623929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:24.093489 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.095087 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:24.096116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:24.096766 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:24.105467 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.105978 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:24.106424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:24.107522 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.109129 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.109620 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:24.110256 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.110713 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.111231 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:24.111949 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.113075 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:24.113617 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.114116 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:24.114667 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.115053 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:24.116311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:24.121958 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:24.122471 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:24.122836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:24.123468 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.123863 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:24.124260 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:24.134015 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.135494 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:24.136731 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:24.137129 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:24.139280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a16266b-7ca6-41be-9d38-c05532b559eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2313add190>]}
[0m22:06:24.139780 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:24.140156 [debug] [MainThread]: On master: BEGIN
[0m22:06:24.140559 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:24.141142 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:24.141577 [debug] [MainThread]: On master: COMMIT
[0m22:06:24.141949 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:24.142352 [debug] [MainThread]: On master: COMMIT
[0m22:06:24.142885 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:24.143313 [debug] [MainThread]: On master: Close
[0m22:06:24.143838 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:24.144355 [info ] [MainThread]: 
[0m22:06:24.161283 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:24.161867 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:24.162511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:24.162953 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:24.189571 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:24.190321 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:24.225974 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:24.226737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:31.718830 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:31.719371 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:31.720038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.720510 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:31.720929 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:31.721850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.724817 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:31.725301 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:31.725975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.742989 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:31.743478 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:31.743900 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:31.745889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.751707 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:31.752167 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:31.754053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.756456 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:31.758030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a16266b-7ca6-41be-9d38-c05532b559eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f230dbd9b80>]}
[0m22:06:31.758751 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.59s]
[0m22:06:31.759519 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:31.760334 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:31.760897 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:31.761621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:31.762079 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:31.767067 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:31.767824 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:31.805002 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.805612 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250726220631798751"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:31.806099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:31.814359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.822163 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.822664 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:31.823360 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.823805 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.824271 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250726220631798751'
      
      
      order by ordinal_position

  
[0m22:06:31.826515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.831820 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.832316 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:31.834455 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.842300 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.842769 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:31.845106 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.863247 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:31.863945 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.864424 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250726220631798751"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250726220631798751"
    )
  
[0m22:06:31.911823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.913901 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:31.914413 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.914862 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:31.921934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.922879 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:31.924294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a16266b-7ca6-41be-9d38-c05532b559eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2304ff7e60>]}
[0m22:06:31.924982 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:06:31.925800 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:31.927300 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.927713 [debug] [MainThread]: On master: BEGIN
[0m22:06:31.928079 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:31.928765 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.929162 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.929569 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.929926 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.930468 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.930862 [debug] [MainThread]: On master: Close
[0m22:06:31.931493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:31.931878 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:31.932297 [info ] [MainThread]: 
[0m22:06:31.932766 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.35 seconds (8.35s).
[0m22:06:31.933701 [debug] [MainThread]: Command end result
[0m22:06:31.959577 [info ] [MainThread]: 
[0m22:06:31.960213 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:31.960669 [info ] [MainThread]: 
[0m22:06:31.961126 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:31.962086 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.375789, "process_user_time": 5.143744, "process_kernel_time": 0.274986, "process_mem_max_rss": "303308", "process_in_blocks": "1200", "process_out_blocks": "100144"}
[0m22:06:31.962682 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:31.962577 after 10.38 seconds
[0m22:06:31.963126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2312b6c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2312049f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cfec45f0>]}
[0m22:06:31.963579 [debug] [MainThread]: Flushing usage events
[0m22:06:33.808394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a977b920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a868d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a870d610>]}


============================== 22:06:33.811557 | 90b46806-cb6e-4463-bd8d-9052edf17474 ==============================
[0m22:06:33.811557 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:33.812245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:33.919701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90b46806-cb6e-4463-bd8d-9052edf17474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a90c00e0>]}
[0m22:06:33.937662 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17834361, "process_user_time": 1.344661, "process_kernel_time": 0.100899, "process_mem_max_rss": "100772", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:33.938224 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:33.938094 after 0.18 seconds
[0m22:06:33.938653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a8667710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a94643b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a870d610>]}
[0m22:06:33.939068 [debug] [MainThread]: Flushing usage events
[0m06:02:18.476016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe050cceb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe050bb9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe050bb9f10>]}


============================== 06:02:18.491448 | 3fd090ba-e6ac-406d-bb0c-0615d554bcd4 ==============================
[0m06:02:18.491448 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:18.492102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:18.607328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fd090ba-e6ac-406d-bb0c-0615d554bcd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe051b0ca70>]}
[0m06:02:18.621938 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ax9yhtbo'
[0m06:02:18.622373 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:18.762399 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:18.763033 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:18.776592 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:18.780591 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:18.999392 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:18.999954 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:19.000492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3fd090ba-e6ac-406d-bb0c-0615d554bcd4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe051cebbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe051027800>]}
[0m06:02:19.000952 [info ] [MainThread]: 
[0m06:02:19.001452 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:19.023038 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5966778, "process_user_time": 1.545757, "process_kernel_time": 0.139158, "process_mem_max_rss": "101588", "process_in_blocks": "8760", "process_out_blocks": "5168"}
[0m06:02:19.023665 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:19.023537 after 0.60 seconds
[0m06:02:19.024093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0551bb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe051027800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe051009700>]}
[0m06:02:19.024500 [debug] [MainThread]: Flushing usage events
[0m06:02:20.769837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a0df1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a0ec8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a0df3410>]}


============================== 06:02:20.772914 | 26751951-8d21-4db7-b423-15093c17951f ==============================
[0m06:02:20.772914 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:20.773541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:20.975778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26751951-8d21-4db7-b423-15093c17951f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a2a7ef00>]}
[0m06:02:21.038702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26751951-8d21-4db7-b423-15093c17951f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a18dfe90>]}
[0m06:02:21.041312 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:21.110183 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:21.110891 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:21.111412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '26751951-8d21-4db7-b423-15093c17951f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a0aad7f0>]}
[0m06:02:22.482722 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:22.483362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '26751951-8d21-4db7-b423-15093c17951f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a0b5e9c0>]}
[0m06:02:22.720864 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:22.726424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26751951-8d21-4db7-b423-15093c17951f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a11ef410>]}
[0m06:02:22.840255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26751951-8d21-4db7-b423-15093c17951f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc39c7fecc0>]}
[0m06:02:22.840762 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:22.841227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26751951-8d21-4db7-b423-15093c17951f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc39ca5c170>]}
[0m06:02:22.843053 [info ] [MainThread]: 
[0m06:02:22.843724 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:22.848324 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:22.882433 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:22.882891 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:22.883271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:23.326096 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.327935 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:23.329044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:23.329761 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:23.337752 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:23.338176 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:23.338645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:23.339588 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.341142 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:23.341553 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:23.342120 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.342499 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:23.342884 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:23.343439 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.344387 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:23.344787 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:23.345209 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:23.345825 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.346244 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:23.347584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:23.353477 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:23.353896 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:23.354254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:23.354864 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.355252 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:23.355624 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:23.365109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.366534 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:23.367773 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:23.368165 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:23.370253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26751951-8d21-4db7-b423-15093c17951f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a2ad8e00>]}
[0m06:02:23.370774 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.371154 [debug] [MainThread]: On master: BEGIN
[0m06:02:23.371512 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:23.372135 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.372532 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.372936 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.373296 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.373838 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.374226 [debug] [MainThread]: On master: Close
[0m06:02:23.374761 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:23.375259 [info ] [MainThread]: 
[0m06:02:23.404108 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:23.404694 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:23.405322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:23.405779 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:23.432205 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:23.432955 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:23.468337 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:23.469086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:34.726773 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.727253 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:34.727884 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.728320 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.728756 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:34.729490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.732427 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.732890 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:34.733616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.750394 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:34.750901 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.751324 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:34.753117 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.758737 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.759188 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:34.760589 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.762937 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:34.764437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26751951-8d21-4db7-b423-15093c17951f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36a1bddf0>]}
[0m06:02:34.765127 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.36s]
[0m06:02:34.765888 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:34.766869 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:34.767415 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:34.768019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:34.768450 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:34.773313 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:34.773942 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:34.809915 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.810397 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250727060234803924"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:34.810876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:34.818488 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.825859 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.826309 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:34.826908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.827343 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.827784 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250727060234803924'
      
      
      order by ordinal_position

  
[0m06:02:34.829858 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.834915 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.835373 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:34.837533 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.845106 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.845562 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:34.847961 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.866042 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:34.866706 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.867158 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250727060234803924"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250727060234803924"
    )
  
[0m06:02:34.913901 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.915907 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:34.916354 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.916844 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:34.924093 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.924991 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:34.926361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26751951-8d21-4db7-b423-15093c17951f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35e901040>]}
[0m06:02:34.927049 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:34.927872 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:34.929184 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:34.929591 [debug] [MainThread]: On master: BEGIN
[0m06:02:34.930003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:34.930654 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:34.931051 [debug] [MainThread]: On master: COMMIT
[0m06:02:34.931424 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:34.931819 [debug] [MainThread]: On master: COMMIT
[0m06:02:34.932333 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:34.932749 [debug] [MainThread]: On master: Close
[0m06:02:34.933385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:34.933788 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:34.934180 [info ] [MainThread]: 
[0m06:02:34.934626 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.09 seconds (12.09s).
[0m06:02:34.935533 [debug] [MainThread]: Command end result
[0m06:02:34.962055 [info ] [MainThread]: 
[0m06:02:34.962608 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:34.963098 [info ] [MainThread]: 
[0m06:02:34.963603 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:34.964538 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.246926, "process_user_time": 5.09764, "process_kernel_time": 0.308038, "process_mem_max_rss": "337428", "process_in_blocks": "1456", "process_out_blocks": "100112"}
[0m06:02:34.965116 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:34.965011 after 14.25 seconds
[0m06:02:34.965551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a13d5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc39c76f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a11eeb10>]}
[0m06:02:34.966008 [debug] [MainThread]: Flushing usage events
[0m06:02:37.031471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810b2bdac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810c05c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810b365dc0>]}


============================== 06:02:37.034484 | 682fc0f4-1aa0-48ec-9fdb-8ed4f15a6e0e ==============================
[0m06:02:37.034484 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:37.035127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:37.142727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '682fc0f4-1aa0-48ec-9fdb-8ed4f15a6e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810b2830e0>]}
[0m06:02:37.160552 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17800513, "process_user_time": 1.356935, "process_kernel_time": 0.100995, "process_mem_max_rss": "100640", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:37.161104 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:37.160999 after 0.18 seconds
[0m06:02:37.161521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810bd615b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810bc4dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810b2830e0>]}
[0m06:02:37.161994 [debug] [MainThread]: Flushing usage events
[0m14:05:21.925522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab139b4ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1416bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab139b4c50>]}


============================== 14:05:21.977783 | 1f59a83a-b909-4b7e-949f-9f19cd8de763 ==============================
[0m14:05:21.977783 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:21.978470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:22.139614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f59a83a-b909-4b7e-949f-9f19cd8de763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1450cbf0>]}
[0m14:05:22.155335 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5cjo441d'
[0m14:05:22.155815 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:22.265560 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:22.266300 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:22.289676 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:22.293572 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:22.373208 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:22.373816 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:22.374443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1f59a83a-b909-4b7e-949f-9f19cd8de763', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab13430a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab135fe3f0>]}
[0m14:05:22.374906 [info ] [MainThread]: 
[0m14:05:22.375436 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:22.381310 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5062598, "process_user_time": 1.59653, "process_kernel_time": 0.154244, "process_mem_max_rss": "101340", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m14:05:22.381870 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:22.381764 after 0.51 seconds
[0m14:05:22.382326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1416bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1340a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1340a000>]}
[0m14:05:22.382757 [debug] [MainThread]: Flushing usage events
[0m14:05:24.068830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcece6c5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcecf60d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcecf60d100>]}


============================== 14:05:24.072065 | ae6a1448-9f7c-4847-813a-63919fb8d772 ==============================
[0m14:05:24.072065 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:24.072778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:24.280706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae6a1448-9f7c-4847-813a-63919fb8d772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced1185730>]}
[0m14:05:24.339605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae6a1448-9f7c-4847-813a-63919fb8d772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcece482960>]}
[0m14:05:24.342234 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:05:24.386610 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:24.387382 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:24.387888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ae6a1448-9f7c-4847-813a-63919fb8d772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcece4585c0>]}
[0m14:05:25.689431 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:25.690056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ae6a1448-9f7c-4847-813a-63919fb8d772', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceca10f4a0>]}
[0m14:05:25.932314 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:25.938204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae6a1448-9f7c-4847-813a-63919fb8d772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced0272030>]}
[0m14:05:26.045339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae6a1448-9f7c-4847-813a-63919fb8d772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceca0d6a20>]}
[0m14:05:26.045914 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:05:26.046405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae6a1448-9f7c-4847-813a-63919fb8d772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceca0fe210>]}
[0m14:05:26.048273 [info ] [MainThread]: 
[0m14:05:26.048983 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:26.053762 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:26.089182 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:26.089661 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:26.090050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:26.598800 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:26.600805 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:26.601927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:26.602678 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:26.611511 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:26.612029 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:26.612491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:26.613587 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.615182 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:26.615700 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:26.616425 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.616898 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:26.617420 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:26.618162 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.619283 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:26.619777 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:26.620180 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:26.620824 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.621220 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:26.622644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:26.628565 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:26.629064 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:26.629471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:26.630073 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.630491 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:26.630866 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:26.640364 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.641836 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:26.643096 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:26.643510 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:26.645930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae6a1448-9f7c-4847-813a-63919fb8d772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceca33c440>]}
[0m14:05:26.646456 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.646836 [debug] [MainThread]: On master: BEGIN
[0m14:05:26.647199 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:26.647836 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.648227 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.648622 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.648976 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.649522 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.649904 [debug] [MainThread]: On master: Close
[0m14:05:26.650448 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:26.650937 [info ] [MainThread]: 
[0m14:05:26.669946 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:26.670565 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:26.671155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:26.671633 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:26.699301 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:26.700147 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:26.735861 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:26.736754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:34.691654 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.692145 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:34.692800 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.693229 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.693665 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:34.694391 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.697299 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.697741 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:34.698412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.715056 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:34.715555 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.715977 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:34.717278 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.723091 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.723563 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:05:34.725189 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.727639 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:34.729185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae6a1448-9f7c-4847-813a-63919fb8d772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce90140350>]}
[0m14:05:34.729898 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.06s]
[0m14:05:34.730682 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:34.731509 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:34.732057 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:34.732701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:34.733142 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:34.738100 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:34.739018 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:34.774673 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.775152 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250727140534768647"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:34.775629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:34.783749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.791290 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.791739 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:34.792364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.792796 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.793208 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250727140534768647'
      
      
      order by ordinal_position

  
[0m14:05:34.795692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.800768 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.801221 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:34.804219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.811840 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.812310 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:34.814947 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.833096 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:34.833803 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.834247 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250727140534768647"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250727140534768647"
    )
  
[0m14:05:34.884562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.886675 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:34.887157 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.887625 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:34.895409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.896429 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:34.897929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae6a1448-9f7c-4847-813a-63919fb8d772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb89015e0>]}
[0m14:05:34.898641 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:05:34.899420 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:34.900797 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.901221 [debug] [MainThread]: On master: BEGIN
[0m14:05:34.901641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:34.902385 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.902794 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.903172 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.903583 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.904118 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.904547 [debug] [MainThread]: On master: Close
[0m14:05:34.905170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:34.905585 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:34.905989 [info ] [MainThread]: 
[0m14:05:34.906477 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.86 seconds (8.86s).
[0m14:05:34.907442 [debug] [MainThread]: Command end result
[0m14:05:34.933440 [info ] [MainThread]: 
[0m14:05:34.934053 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:34.934527 [info ] [MainThread]: 
[0m14:05:34.934987 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:34.935950 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.916923, "process_user_time": 4.756716, "process_kernel_time": 0.272155, "process_mem_max_rss": "324120", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m14:05:34.936523 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:34.936418 after 10.92 seconds
[0m14:05:34.936967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcecf16e4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced1185730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce901bcc20>]}
[0m14:05:34.937436 [debug] [MainThread]: Flushing usage events
[0m14:05:36.883148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25e0b39430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25df05f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25df05eab0>]}


============================== 14:05:36.886320 | e0a5e641-9cf7-4e8b-8303-7ad3293c7065 ==============================
[0m14:05:36.886320 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:36.887015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:36.995421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0a5e641-9cf7-4e8b-8303-7ad3293c7065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25dfb7ca10>]}
[0m14:05:37.013800 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18001334, "process_user_time": 1.367417, "process_kernel_time": 0.113951, "process_mem_max_rss": "100600", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:37.014365 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:37.014243 after 0.18 seconds
[0m14:05:37.014804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25dee11160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25e16395e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25dec978c0>]}
[0m14:05:37.015245 [debug] [MainThread]: Flushing usage events
[0m22:06:16.885676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b19e57800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b18ad7bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b180a4440>]}


============================== 22:06:16.904749 | dd6e3c4a-8d3f-46aa-a48e-b7e81cb52481 ==============================
[0m22:06:16.904749 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:16.905454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:17.044143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd6e3c4a-8d3f-46aa-a48e-b7e81cb52481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b18a9f4d0>]}
[0m22:06:17.059649 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_myr8c85'
[0m22:06:17.060165 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:17.160454 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:17.161206 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:17.171836 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:17.175726 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:17.369961 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:17.370579 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:17.371169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'dd6e3c4a-8d3f-46aa-a48e-b7e81cb52481', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b18da0260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b17ef59a0>]}
[0m22:06:17.371629 [info ] [MainThread]: 
[0m22:06:17.372129 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:17.378546 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5445941, "process_user_time": 1.608201, "process_kernel_time": 0.123938, "process_mem_max_rss": "101568", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m22:06:17.379145 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:17.379038 after 0.55 seconds
[0m22:06:17.379569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b180ea630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b18a9f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b186c8d70>]}
[0m22:06:17.380007 [debug] [MainThread]: Flushing usage events
[0m22:06:19.057458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced18377a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced1ac7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced1ac7650>]}


============================== 22:06:19.060695 | 21b64f5d-37df-4018-abdd-79ce1ec4cb24 ==============================
[0m22:06:19.060695 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:19.061410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:19.265293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21b64f5d-37df-4018-abdd-79ce1ec4cb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced12aebd0>]}
[0m22:06:19.324777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21b64f5d-37df-4018-abdd-79ce1ec4cb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced147c200>]}
[0m22:06:19.327502 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:19.360362 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:19.361140 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:19.361654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '21b64f5d-37df-4018-abdd-79ce1ec4cb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced1ac5d30>]}
[0m22:06:20.654310 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:20.654992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '21b64f5d-37df-4018-abdd-79ce1ec4cb24', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcecd2a3380>]}
[0m22:06:20.894132 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:20.899840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21b64f5d-37df-4018-abdd-79ce1ec4cb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced30be150>]}
[0m22:06:21.026802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21b64f5d-37df-4018-abdd-79ce1ec4cb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceccef0350>]}
[0m22:06:21.027399 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:21.027944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21b64f5d-37df-4018-abdd-79ce1ec4cb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceccf005f0>]}
[0m22:06:21.029862 [info ] [MainThread]: 
[0m22:06:21.030595 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:21.035409 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:21.070790 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:21.071277 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:21.071661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:21.580909 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:21.582865 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:21.583928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:21.584570 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:21.592572 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:21.593015 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:21.593403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:21.594531 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.595887 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:21.596279 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:21.596847 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.597235 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:21.597600 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:21.598238 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.599169 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:21.599568 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:21.599985 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:21.600520 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.600951 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:21.602160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:21.607876 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:21.608361 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:21.608718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:21.609350 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.609778 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:21.610163 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:21.620404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.621886 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:21.623122 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:21.623522 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:21.625878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21b64f5d-37df-4018-abdd-79ce1ec4cb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcecba387a0>]}
[0m22:06:21.626380 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:21.626780 [debug] [MainThread]: On master: BEGIN
[0m22:06:21.627145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:21.627763 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:21.628166 [debug] [MainThread]: On master: COMMIT
[0m22:06:21.628534 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:21.628922 [debug] [MainThread]: On master: COMMIT
[0m22:06:21.629442 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:21.629846 [debug] [MainThread]: On master: Close
[0m22:06:21.630366 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:21.630879 [info ] [MainThread]: 
[0m22:06:21.651768 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:21.652389 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:21.653063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:21.653508 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:21.680355 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:21.681155 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:21.716392 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:21.717168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:30.539232 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.539755 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:30.540411 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.540877 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.541299 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:30.542033 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.544913 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.545354 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:30.546048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.562600 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:30.563087 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.563509 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:30.565361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.570968 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.571419 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:30.572553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.574888 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:30.576400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21b64f5d-37df-4018-abdd-79ce1ec4cb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8efd4c50>]}
[0m22:06:30.577093 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.92s]
[0m22:06:30.577864 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:30.578639 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:30.579215 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:30.579896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:30.580343 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:30.585166 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:30.585995 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:30.620891 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.621375 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250727220630614869"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:30.621840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:30.629509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.638380 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.638865 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:30.639508 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.639965 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.640381 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250727220630614869'
      
      
      order by ordinal_position

  
[0m22:06:30.642671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.647890 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.648350 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:30.650620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.658279 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.658752 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:30.661779 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.679974 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:30.680692 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.681166 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250727220630614869"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250727220630614869"
    )
  
[0m22:06:30.731861 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.733875 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:30.734344 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.734779 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:30.741991 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.742897 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:30.744460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21b64f5d-37df-4018-abdd-79ce1ec4cb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8ef53650>]}
[0m22:06:30.745183 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:06:30.745949 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:30.747269 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:30.747683 [debug] [MainThread]: On master: BEGIN
[0m22:06:30.748104 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:30.748773 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:30.749186 [debug] [MainThread]: On master: COMMIT
[0m22:06:30.749558 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:30.749977 [debug] [MainThread]: On master: COMMIT
[0m22:06:30.750508 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:30.750932 [debug] [MainThread]: On master: Close
[0m22:06:30.751517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:30.751942 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:30.752344 [info ] [MainThread]: 
[0m22:06:30.752825 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.72 seconds (9.72s).
[0m22:06:30.753768 [debug] [MainThread]: Command end result
[0m22:06:30.779776 [info ] [MainThread]: 
[0m22:06:30.780341 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:30.780821 [info ] [MainThread]: 
[0m22:06:30.781286 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:30.782202 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.774368, "process_user_time": 5.145485, "process_kernel_time": 0.300028, "process_mem_max_rss": "308960", "process_in_blocks": "1200", "process_out_blocks": "99872"}
[0m22:06:30.782780 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:30.782640 after 11.77 seconds
[0m22:06:30.783226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced1a82f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced14b95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcecce9ae40>]}
[0m22:06:30.783653 [debug] [MainThread]: Flushing usage events
[0m22:06:32.744559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d95db4fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d96241160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d961caf00>]}


============================== 22:06:32.747773 | f7809354-3457-497a-900c-34c5dae38625 ==============================
[0m22:06:32.747773 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:32.748460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:32.857528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7809354-3457-497a-900c-34c5dae38625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d95db42c0>]}
[0m22:06:32.875608 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18102565, "process_user_time": 1.343848, "process_kernel_time": 0.120986, "process_mem_max_rss": "100712", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:32.876171 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:32.876068 after 0.18 seconds
[0m22:06:32.876596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d961caf00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d95db42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d95db46b0>]}
[0m22:06:32.877058 [debug] [MainThread]: Flushing usage events
[0m06:03:28.742526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dde469d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dde4d57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dde4d7ce0>]}


============================== 06:03:28.793863 | 7ea4f169-0c4c-4d70-acd0-7eec5dad61f4 ==============================
[0m06:03:28.793863 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:28.794507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:03:29.027028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ea4f169-0c4c-4d70-acd0-7eec5dad61f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ddf739a00>]}
[0m06:03:29.042310 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-20bvvv38'
[0m06:03:29.042782 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:03:29.159735 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:03:29.160429 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:03:29.169943 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:03:29.173784 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:03:29.222466 [info ] [MainThread]: Installed from version 1.2.0
[0m06:03:29.222979 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:03:29.223525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7ea4f169-0c4c-4d70-acd0-7eec5dad61f4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ddd8c0ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ddd7e3140>]}
[0m06:03:29.223975 [info ] [MainThread]: 
[0m06:03:29.224452 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:03:29.252937 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5594803, "process_user_time": 1.582261, "process_kernel_time": 0.121635, "process_mem_max_rss": "101356", "process_in_blocks": "8496", "process_out_blocks": "5168"}
[0m06:03:29.253660 [debug] [MainThread]: Command `dbt deps` succeeded at 06:03:29.253533 after 0.56 seconds
[0m06:03:29.254100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ddea64530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ddd8f5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ddd8f6750>]}
[0m06:03:29.254525 [debug] [MainThread]: Flushing usage events
[0m06:03:30.950468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f245b7d2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f245ad88620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f245acc1d90>]}


============================== 06:03:30.953523 | 4b4fb342-e09f-4093-86ea-bd94238f0385 ==============================
[0m06:03:30.953523 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:30.954155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:03:31.153772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b4fb342-e09f-4093-86ea-bd94238f0385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f245ca835f0>]}
[0m06:03:31.212228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b4fb342-e09f-4093-86ea-bd94238f0385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f245bee5220>]}
[0m06:03:31.214855 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:03:31.281552 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:03:31.282276 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:03:31.282778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b4fb342-e09f-4093-86ea-bd94238f0385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f245aa6ddf0>]}
[0m06:03:32.577219 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:03:32.577855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4b4fb342-e09f-4093-86ea-bd94238f0385', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2456964320>]}
[0m06:03:32.803502 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:03:32.808993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b4fb342-e09f-4093-86ea-bd94238f0385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24569959d0>]}
[0m06:03:32.924129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b4fb342-e09f-4093-86ea-bd94238f0385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2456af1fa0>]}
[0m06:03:32.924680 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:03:32.925150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b4fb342-e09f-4093-86ea-bd94238f0385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f245ad8a420>]}
[0m06:03:32.926950 [info ] [MainThread]: 
[0m06:03:32.927650 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:03:32.932337 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:03:32.967421 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:03:32.967876 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:03:32.968278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:33.450699 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:33.453216 [debug] [ThreadPool]: On list_petro: Close
[0m06:03:33.454626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:03:33.455521 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:03:33.464116 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:33.464526 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:03:33.464898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:33.465788 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:33.467096 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:33.467481 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:03:33.468086 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:33.468479 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:33.468837 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:03:33.469404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:33.470309 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:33.470689 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:33.471048 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:33.471622 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:33.472008 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:03:33.473306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:03:33.479568 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:33.480055 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:03:33.480455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:33.481082 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:33.481470 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:33.481840 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:03:33.492106 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:33.493560 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:03:33.494786 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:03:33.495197 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:03:33.497344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b4fb342-e09f-4093-86ea-bd94238f0385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2456631760>]}
[0m06:03:33.497843 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:33.498252 [debug] [MainThread]: On master: BEGIN
[0m06:03:33.498602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:33.499213 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:33.499599 [debug] [MainThread]: On master: COMMIT
[0m06:03:33.499956 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:33.500345 [debug] [MainThread]: On master: COMMIT
[0m06:03:33.500857 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:33.501265 [debug] [MainThread]: On master: Close
[0m06:03:33.501768 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:03:33.502237 [info ] [MainThread]: 
[0m06:03:33.519139 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:03:33.519740 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:03:33.520403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:03:33.520836 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:03:33.547435 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:03:33.548197 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:03:33.583235 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:03:33.583992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:40.329407 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:40.329911 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:40.330581 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:40.331017 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:40.331478 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:40.332192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:40.335090 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:40.335532 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:40.336203 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:40.352901 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:40.353407 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:40.353824 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:40.355666 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:40.361408 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:40.361857 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:40.363087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:40.365462 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:40.366988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b4fb342-e09f-4093-86ea-bd94238f0385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24554dcf80>]}
[0m06:03:40.367702 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.85s]
[0m06:03:40.368462 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:40.369430 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:40.369970 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:40.370581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:40.371005 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:40.376102 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:40.376735 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:40.413346 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:40.413876 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250728060340407256"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:40.414346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:40.422363 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:40.430158 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:40.430605 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:40.431243 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:40.431682 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:40.432128 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250728060340407256'
      
      
      order by ordinal_position

  
[0m06:03:40.434326 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:40.439454 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:40.439907 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:40.442957 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:40.450614 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:40.451081 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:40.453794 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:40.471875 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:40.472673 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:40.473146 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250728060340407256"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250728060340407256"
    )
  
[0m06:03:40.524094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:40.526095 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:40.526546 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:40.526954 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:40.536908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:40.537968 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:40.539419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b4fb342-e09f-4093-86ea-bd94238f0385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f241c693950>]}
[0m06:03:40.540128 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:03:40.540873 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:40.542376 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:40.542780 [debug] [MainThread]: On master: BEGIN
[0m06:03:40.543184 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:40.543920 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:40.544365 [debug] [MainThread]: On master: COMMIT
[0m06:03:40.544738 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:40.545131 [debug] [MainThread]: On master: COMMIT
[0m06:03:40.545675 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:40.546091 [debug] [MainThread]: On master: Close
[0m06:03:40.546691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:40.547053 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:40.547502 [info ] [MainThread]: 
[0m06:03:40.547982 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.62 seconds (7.62s).
[0m06:03:40.548947 [debug] [MainThread]: Command end result
[0m06:03:40.574996 [info ] [MainThread]: 
[0m06:03:40.575642 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:40.576138 [info ] [MainThread]: 
[0m06:03:40.576622 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:40.577626 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.676057, "process_user_time": 5.113529, "process_kernel_time": 0.263387, "process_mem_max_rss": "308860", "process_in_blocks": "1200", "process_out_blocks": "100008"}
[0m06:03:40.578200 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:40.578056 after 9.68 seconds
[0m06:03:40.578638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f245b64eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2456966330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2455384ad0>]}
[0m06:03:40.579085 [debug] [MainThread]: Flushing usage events
[0m06:03:42.462289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7edac568a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed908fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed9204ef0>]}


============================== 06:03:42.465367 | e0fd8f95-a61e-465f-b753-2a8748ae9a08 ==============================
[0m06:03:42.465367 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:42.466033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:42.573250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0fd8f95-a61e-465f-b753-2a8748ae9a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7edab6f170>]}
[0m06:03:42.590739 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17735885, "process_user_time": 1.338446, "process_kernel_time": 0.098959, "process_mem_max_rss": "100672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:03:42.591322 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:42.591216 after 0.18 seconds
[0m06:03:42.591732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed9cd2a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7edab6f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed8e30350>]}
[0m06:03:42.592173 [debug] [MainThread]: Flushing usage events
[0m14:07:43.101636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcac89760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fc84f74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fc84f63f0>]}


============================== 14:07:43.117647 | 2c9a3d42-cd0c-46e0-921a-07c90c1dfe31 ==============================
[0m14:07:43.117647 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:43.118302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:43.238882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c9a3d42-cd0c-46e0-921a-07c90c1dfe31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fc80c7080>]}
[0m14:07:43.254049 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hrkj1k3a'
[0m14:07:43.254528 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:07:43.380092 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:07:43.380740 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:07:43.430028 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:07:43.433770 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:07:43.647353 [info ] [MainThread]: Installed from version 1.2.0
[0m14:07:43.647878 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:07:43.648383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2c9a3d42-cd0c-46e0-921a-07c90c1dfe31', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fc7f59b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fc7f591f0>]}
[0m14:07:43.648855 [info ] [MainThread]: 
[0m14:07:43.649329 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:07:43.681731 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6296757, "process_user_time": 1.589971, "process_kernel_time": 0.12431, "process_mem_max_rss": "101784", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m14:07:43.682487 [debug] [MainThread]: Command `dbt deps` succeeded at 14:07:43.682355 after 0.63 seconds
[0m14:07:43.683068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fc82af230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fc7f36db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fc7f372c0>]}
[0m14:07:43.683507 [debug] [MainThread]: Flushing usage events
[0m14:07:45.385128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf21e86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf1fa0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf1fffce0>]}


============================== 14:07:45.388273 | 1205b853-3cc9-4371-b188-05186b28639e ==============================
[0m14:07:45.388273 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:45.388976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:45.591661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1205b853-3cc9-4371-b188-05186b28639e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf1a72cf0>]}
[0m14:07:45.651380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1205b853-3cc9-4371-b188-05186b28639e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf2ad7e60>]}
[0m14:07:45.653985 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:07:45.685255 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:07:45.685992 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:07:45.686510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1205b853-3cc9-4371-b188-05186b28639e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf1a0e150>]}
[0m14:07:46.980531 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:07:46.981216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1205b853-3cc9-4371-b188-05186b28639e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cedb09be0>]}
[0m14:07:47.211281 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:07:47.216819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1205b853-3cc9-4371-b188-05186b28639e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ced868200>]}
[0m14:07:47.357199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1205b853-3cc9-4371-b188-05186b28639e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ced8e9010>]}
[0m14:07:47.357735 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:07:47.358230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1205b853-3cc9-4371-b188-05186b28639e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf1d0b710>]}
[0m14:07:47.360091 [info ] [MainThread]: 
[0m14:07:47.360763 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:07:47.365436 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:07:47.400150 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:07:47.400581 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:07:47.400988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:47.984688 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:07:47.986888 [debug] [ThreadPool]: On list_petro: Close
[0m14:07:47.988077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:07:47.988849 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:07:47.997088 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:47.997516 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:07:47.997916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:47.998838 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:48.000121 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:48.000516 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:07:48.001076 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:48.001453 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:48.001841 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:07:48.002450 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:48.003367 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:48.003763 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:48.004150 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:48.004685 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:48.005105 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:07:48.006309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:07:48.011901 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:48.012381 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:07:48.012738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:48.013339 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:48.013731 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:48.014127 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:07:48.024351 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:48.025826 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:07:48.027053 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:07:48.027447 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:07:48.029825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1205b853-3cc9-4371-b188-05186b28639e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cec24c800>]}
[0m14:07:48.030326 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:48.030700 [debug] [MainThread]: On master: BEGIN
[0m14:07:48.031098 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:48.031686 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:48.032115 [debug] [MainThread]: On master: COMMIT
[0m14:07:48.032485 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:48.032862 [debug] [MainThread]: On master: COMMIT
[0m14:07:48.033409 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:48.033838 [debug] [MainThread]: On master: Close
[0m14:07:48.034376 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:07:48.034895 [info ] [MainThread]: 
[0m14:07:48.053607 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:07:48.054220 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:07:48.054862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:07:48.055302 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:07:48.082423 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:07:48.083207 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:07:48.119011 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:07:48.119817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:57.213439 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:57.213958 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:07:57.214612 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:57.215081 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:57.215498 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:07:57.216242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:57.219153 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:57.219597 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:07:57.220286 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:57.237047 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:57.237521 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:57.237965 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:57.239686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:57.245376 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:57.245855 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:07:57.247011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:57.249353 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:07:57.250895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1205b853-3cc9-4371-b188-05186b28639e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf392e090>]}
[0m14:07:57.251572 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.20s]
[0m14:07:57.252412 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:07:57.253224 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:07:57.253816 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:07:57.254614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:07:57.255098 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:07:57.259949 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:07:57.260579 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:07:57.296761 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:57.297263 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250728140757290619"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:07:57.297714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:57.305382 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:57.312840 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:57.313315 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:07:57.313935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:57.314366 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:57.314781 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250728140757290619'
      
      
      order by ordinal_position

  
[0m14:07:57.316921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:57.322007 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:57.322460 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:57.325514 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:57.333114 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:57.333574 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:57.336322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:57.354558 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:07:57.355265 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:57.355714 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250728140757290619"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250728140757290619"
    )
  
[0m14:07:57.406204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:57.408190 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:57.408629 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:57.409056 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:57.417015 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:57.417921 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:07:57.419376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1205b853-3cc9-4371-b188-05186b28639e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7caf6a77d0>]}
[0m14:07:57.420062 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:07:57.420780 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:07:57.422082 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:57.422494 [debug] [MainThread]: On master: BEGIN
[0m14:07:57.422892 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:57.423497 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:57.423914 [debug] [MainThread]: On master: COMMIT
[0m14:07:57.424280 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:57.424630 [debug] [MainThread]: On master: COMMIT
[0m14:07:57.425175 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:57.425560 [debug] [MainThread]: On master: Close
[0m14:07:57.426193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:57.426559 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:07:57.426983 [info ] [MainThread]: 
[0m14:07:57.427486 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.07 seconds (10.07s).
[0m14:07:57.428479 [debug] [MainThread]: Command end result
[0m14:07:57.453931 [info ] [MainThread]: 
[0m14:07:57.454524 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:57.455051 [info ] [MainThread]: 
[0m14:07:57.455564 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:07:57.456558 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.12115, "process_user_time": 5.244592, "process_kernel_time": 0.26939, "process_mem_max_rss": "305800", "process_in_blocks": "1200", "process_out_blocks": "100008"}
[0m14:07:57.457122 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:57.457018 after 12.12 seconds
[0m14:07:57.457551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf61bb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cec2f6570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf202ab10>]}
[0m14:07:57.457988 [debug] [MainThread]: Flushing usage events
[0m14:07:59.442520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f748d52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f73da0800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f7485cc80>]}


============================== 14:07:59.445605 | 7a62869c-3270-4dc0-a7cc-3b6b03c80048 ==============================
[0m14:07:59.445605 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:59.446283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:59.556873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a62869c-3270-4dc0-a7cc-3b6b03c80048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f77fbb8f0>]}
[0m14:07:59.574687 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18162817, "process_user_time": 1.337673, "process_kernel_time": 0.11997, "process_mem_max_rss": "100528", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:07:59.575245 [debug] [MainThread]: Command `dbt clean` succeeded at 14:07:59.575136 after 0.18 seconds
[0m14:07:59.575657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f748d52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f776cf0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f73a72f60>]}
[0m14:07:59.576093 [debug] [MainThread]: Flushing usage events
[0m22:06:52.271398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0da2bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0cff1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0dffd2b0>]}


============================== 22:06:52.287278 | 56912281-e082-4b73-a87e-008abca56826 ==============================
[0m22:06:52.287278 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:52.287927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:52.410011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56912281-e082-4b73-a87e-008abca56826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0cfb5250>]}
[0m22:06:52.424902 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-k59h8t15'
[0m22:06:52.425365 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:52.563133 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:52.563895 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:52.575461 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:52.579473 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:52.635015 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:52.635594 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:52.636123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '56912281-e082-4b73-a87e-008abca56826', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0ccf50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0d3e74a0>]}
[0m22:06:52.636591 [info ] [MainThread]: 
[0m22:06:52.637072 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:52.642633 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4209746, "process_user_time": 1.564206, "process_kernel_time": 0.137841, "process_mem_max_rss": "101564", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m22:06:52.643179 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:52.643076 after 0.42 seconds
[0m22:06:52.643612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0cfb6ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0cfb5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0ccf6330>]}
[0m22:06:52.644041 [debug] [MainThread]: Flushing usage events
[0m22:06:54.229510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d183e1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d1828ce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d18b9abd0>]}


============================== 22:06:54.232644 | 30dd6e54-aa8c-487e-9b3f-693be0b06f8f ==============================
[0m22:06:54.232644 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:54.233284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:54.445109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30dd6e54-aa8c-487e-9b3f-693be0b06f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d17eedc70>]}
[0m22:06:54.504872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30dd6e54-aa8c-487e-9b3f-693be0b06f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d17f11160>]}
[0m22:06:54.507588 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:54.561499 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:54.562239 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:54.562761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '30dd6e54-aa8c-487e-9b3f-693be0b06f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d17e489e0>]}
[0m22:06:55.971487 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:55.972182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '30dd6e54-aa8c-487e-9b3f-693be0b06f8f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d1814cbf0>]}
[0m22:06:56.209860 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:56.215338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30dd6e54-aa8c-487e-9b3f-693be0b06f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d192dc800>]}
[0m22:06:56.329354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30dd6e54-aa8c-487e-9b3f-693be0b06f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d13de0680>]}
[0m22:06:56.329886 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:56.330367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30dd6e54-aa8c-487e-9b3f-693be0b06f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d180acef0>]}
[0m22:06:56.332206 [info ] [MainThread]: 
[0m22:06:56.332913 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:56.337631 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:56.372584 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:56.373014 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:56.373396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:56.846384 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:56.848771 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:56.850094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:56.850886 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:56.858832 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:56.859245 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:56.859647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:56.860544 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:56.861839 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:56.862225 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:56.862822 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:56.863200 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:56.863584 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:56.864179 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:56.865095 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:56.865479 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:56.865874 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:56.866384 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:56.866795 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:56.868031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:56.873639 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:56.874120 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:56.874480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:56.875101 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:56.875480 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:56.875874 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:56.885410 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:56.886864 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:56.888100 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:56.888491 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:56.890763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30dd6e54-aa8c-487e-9b3f-693be0b06f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d12762600>]}
[0m22:06:56.891259 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:56.891683 [debug] [MainThread]: On master: BEGIN
[0m22:06:56.892040 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:56.892636 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:56.893032 [debug] [MainThread]: On master: COMMIT
[0m22:06:56.893399 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:56.893795 [debug] [MainThread]: On master: COMMIT
[0m22:06:56.894310 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:56.894716 [debug] [MainThread]: On master: Close
[0m22:06:56.895226 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:56.895729 [info ] [MainThread]: 
[0m22:06:56.907080 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:56.907671 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:56.908220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:56.908696 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:56.935471 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:56.936223 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:56.971545 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:56.972268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:05.221056 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.221576 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:05.222267 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.222732 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.223144 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:05.223837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.226734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.227235 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:05.227996 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.244762 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:05.245229 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.245682 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:05.246692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.252295 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.252773 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:05.253919 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.256286 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:05.257841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30dd6e54-aa8c-487e-9b3f-693be0b06f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd9c11970>]}
[0m22:07:05.258515 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.35s]
[0m22:07:05.259273 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:05.260073 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:05.260645 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:05.261243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:05.261723 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:05.266647 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:05.267484 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:05.303802 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.304290 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250728220705297773"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:05.304766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:05.312491 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.320092 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.320570 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:05.321169 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.321619 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.322040 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250728220705297773'
      
      
      order by ordinal_position

  
[0m22:07:05.324500 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.329657 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.330118 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:05.332304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.339902 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.340359 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:05.342967 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.361217 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:05.361913 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.362368 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250728220705297773"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250728220705297773"
    )
  
[0m22:07:05.412763 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.414790 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:05.415258 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.415699 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:05.422658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.423596 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:05.425100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30dd6e54-aa8c-487e-9b3f-693be0b06f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d127ebfe0>]}
[0m22:07:05.425799 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:07:05.426559 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:05.428099 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:05.428570 [debug] [MainThread]: On master: BEGIN
[0m22:07:05.428997 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:05.429672 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:05.430067 [debug] [MainThread]: On master: COMMIT
[0m22:07:05.430438 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:05.430842 [debug] [MainThread]: On master: COMMIT
[0m22:07:05.431368 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:05.431787 [debug] [MainThread]: On master: Close
[0m22:07:05.432371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:05.432767 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:05.433166 [info ] [MainThread]: 
[0m22:07:05.433698 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.10 seconds (9.10s).
[0m22:07:05.434734 [debug] [MainThread]: Command end result
[0m22:07:05.461099 [info ] [MainThread]: 
[0m22:07:05.461715 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:05.462225 [info ] [MainThread]: 
[0m22:07:05.462769 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:05.463778 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.287054, "process_user_time": 5.240936, "process_kernel_time": 0.293164, "process_mem_max_rss": "307340", "process_in_blocks": "1200", "process_out_blocks": "100040"}
[0m22:07:05.464321 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:05.464216 after 11.29 seconds
[0m22:07:05.464774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d180454c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d13a21f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d18512930>]}
[0m22:07:05.465192 [debug] [MainThread]: Flushing usage events
[0m22:07:07.255035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9e958680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9c9c4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9c9c4140>]}


============================== 22:07:07.258092 | 4576509b-d494-477d-a773-9f3ca446d25f ==============================
[0m22:07:07.258092 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:07.258808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:07:07.366984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4576509b-d494-477d-a773-9f3ca446d25f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9c430fe0>]}
[0m22:07:07.384428 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17903124, "process_user_time": 1.34134, "process_kernel_time": 0.098951, "process_mem_max_rss": "100536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:07.384985 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:07.384882 after 0.18 seconds
[0m22:07:07.385397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9fccf0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9c5ac860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9be32ab0>]}
[0m22:07:07.385825 [debug] [MainThread]: Flushing usage events
[0m06:02:58.850224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30051148f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30055a91f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f300506f7a0>]}


============================== 06:02:58.867595 | 232ba57d-5963-4011-bae2-0654bef5a979 ==============================
[0m06:02:58.867595 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:58.868267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:59.031777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '232ba57d-5963-4011-bae2-0654bef5a979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3004efc9b0>]}
[0m06:02:59.047696 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-32kl6io6'
[0m06:02:59.048190 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:59.116396 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:59.117060 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:59.127739 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:59.131599 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:59.340162 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:59.340726 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:59.341294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '232ba57d-5963-4011-bae2-0654bef5a979', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30059db3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3005f001a0>]}
[0m06:02:59.341738 [info ] [MainThread]: 
[0m06:02:59.342230 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:59.347949 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5476341, "process_user_time": 1.572417, "process_kernel_time": 0.128524, "process_mem_max_rss": "101140", "process_in_blocks": "8760", "process_out_blocks": "5176"}
[0m06:02:59.348504 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:59.348400 after 0.55 seconds
[0m06:02:59.348958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3004f33980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f300530e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3006938fe0>]}
[0m06:02:59.349368 [debug] [MainThread]: Flushing usage events
[0m06:03:01.141422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292bc554f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292c443860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292bd6ce60>]}


============================== 06:03:01.144464 | a062844b-b2fa-4bd8-9361-4e238880f0eb ==============================
[0m06:03:01.144464 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:01.145154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:01.347344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a062844b-b2fa-4bd8-9361-4e238880f0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292cf49be0>]}
[0m06:03:01.406516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a062844b-b2fa-4bd8-9361-4e238880f0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292c861ee0>]}
[0m06:03:01.409031 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:03:01.504001 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:03:01.504680 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:03:01.505232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a062844b-b2fa-4bd8-9361-4e238880f0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292b948dd0>]}
[0m06:03:02.804532 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:03:02.805172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a062844b-b2fa-4bd8-9361-4e238880f0eb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292798b410>]}
[0m06:03:03.031591 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:03:03.036988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a062844b-b2fa-4bd8-9361-4e238880f0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292c030aa0>]}
[0m06:03:03.164336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a062844b-b2fa-4bd8-9361-4e238880f0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2927774500>]}
[0m06:03:03.164831 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:03:03.165305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a062844b-b2fa-4bd8-9361-4e238880f0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29278d6b70>]}
[0m06:03:03.167122 [info ] [MainThread]: 
[0m06:03:03.167762 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:03:03.172341 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:03:03.206527 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:03:03.206972 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:03:03.207355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:03.623954 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:03.625912 [debug] [ThreadPool]: On list_petro: Close
[0m06:03:03.626966 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:03:03.627558 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:03:03.636352 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:03.636850 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:03:03.637240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:03.638236 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:03.639858 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:03.640343 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:03:03.641069 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:03.641587 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:03.642052 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:03:03.642748 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:03.643859 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:03.644389 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:03.644862 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:03.645513 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:03.646039 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:03:03.647447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:03:03.653318 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:03.653715 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:03:03.654109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:03.654684 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:03.655098 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:03.655469 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:03:03.665705 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:03.667155 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:03:03.668386 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:03:03.668782 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:03:03.671056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a062844b-b2fa-4bd8-9361-4e238880f0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29277c4920>]}
[0m06:03:03.671560 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:03.671989 [debug] [MainThread]: On master: BEGIN
[0m06:03:03.672355 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:03.672966 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:03.673370 [debug] [MainThread]: On master: COMMIT
[0m06:03:03.673737 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:03.674147 [debug] [MainThread]: On master: COMMIT
[0m06:03:03.674678 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:03.675099 [debug] [MainThread]: On master: Close
[0m06:03:03.675615 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:03:03.676135 [info ] [MainThread]: 
[0m06:03:03.691972 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:03:03.692550 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:03:03.693181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:03:03.693619 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:03:03.720074 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:03:03.720826 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:03:03.756226 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:03:03.756970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:13.115082 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:13.115563 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:13.116200 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:13.116637 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:13.117081 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:13.117754 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:13.120651 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:13.121111 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:13.121761 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:13.138427 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:13.138900 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:13.139320 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:13.141245 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:13.146853 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:13.147311 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:13.148409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:13.150714 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:13.152223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a062844b-b2fa-4bd8-9361-4e238880f0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2927771b20>]}
[0m06:03:13.152908 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.46s]
[0m06:03:13.153647 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:13.154435 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:13.155004 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:13.155741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:13.156251 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:13.161141 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:13.161761 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:13.197760 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:13.198266 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250729060313191693"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:13.198709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:13.206412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:13.213918 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:13.214365 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:13.214971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:13.215400 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:13.215832 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250729060313191693'
      
      
      order by ordinal_position

  
[0m06:03:13.218666 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:13.223734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:13.224208 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:13.226311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:13.233992 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:13.234448 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:13.236520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:13.254759 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:13.255461 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:13.255925 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250729060313191693"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250729060313191693"
    )
  
[0m06:03:13.305411 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:13.307429 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:13.307892 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:13.308308 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:13.315721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:13.316622 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:13.318044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a062844b-b2fa-4bd8-9361-4e238880f0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28ed5d98e0>]}
[0m06:03:13.318713 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:03:13.319468 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:13.320840 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:13.321261 [debug] [MainThread]: On master: BEGIN
[0m06:03:13.321631 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:13.322290 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:13.322678 [debug] [MainThread]: On master: COMMIT
[0m06:03:13.323076 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:13.323438 [debug] [MainThread]: On master: COMMIT
[0m06:03:13.323962 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:13.324352 [debug] [MainThread]: On master: Close
[0m06:03:13.324982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:13.325357 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:13.325756 [info ] [MainThread]: 
[0m06:03:13.326290 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.16 seconds (10.16s).
[0m06:03:13.327315 [debug] [MainThread]: Command end result
[0m06:03:13.352961 [info ] [MainThread]: 
[0m06:03:13.353557 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:13.354086 [info ] [MainThread]: 
[0m06:03:13.354601 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:13.355604 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.26539, "process_user_time": 5.052336, "process_kernel_time": 0.263965, "process_mem_max_rss": "307456", "process_in_blocks": "1456", "process_out_blocks": "100016"}
[0m06:03:13.356187 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:13.356080 after 12.27 seconds
[0m06:03:13.356616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292c9684a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28ee91bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291c0db500>]}
[0m06:03:13.357063 [debug] [MainThread]: Flushing usage events
[0m06:03:15.406498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a801fd580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a7eebecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a7f0ac560>]}


============================== 06:03:15.409659 | ceed6965-c7f3-4d54-8edc-f72e4622f494 ==============================
[0m06:03:15.409659 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:15.410348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:03:15.519285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ceed6965-c7f3-4d54-8edc-f72e4622f494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a7e3fac90>]}
[0m06:03:15.536860 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1800965, "process_user_time": 1.354433, "process_kernel_time": 0.097959, "process_mem_max_rss": "100756", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:03:15.537383 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:15.537280 after 0.18 seconds
[0m06:03:15.537805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a7ee8bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a7e3b16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a7e3fac90>]}
[0m06:03:15.538275 [debug] [MainThread]: Flushing usage events
[0m14:08:26.495315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab061d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab08b4cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab129c560>]}


============================== 14:08:26.513254 | c389142c-dba5-4a03-8903-931464ab0da6 ==============================
[0m14:08:26.513254 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:08:26.514002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:26.641570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c389142c-dba5-4a03-8903-931464ab0da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab2129e80>]}
[0m14:08:26.657437 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q4wz12vc'
[0m14:08:26.657916 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:08:26.672807 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:08:26.673522 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:08:26.683850 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:08:26.687829 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:08:26.824623 [info ] [MainThread]: Installed from version 1.2.0
[0m14:08:26.825198 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:08:26.825764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c389142c-dba5-4a03-8903-931464ab0da6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab01a94f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab0edfb60>]}
[0m14:08:26.826209 [info ] [MainThread]: 
[0m14:08:26.826702 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:08:26.832632 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38741362, "process_user_time": 1.57572, "process_kernel_time": 0.153264, "process_mem_max_rss": "101600", "process_in_blocks": "8760", "process_out_blocks": "5176"}
[0m14:08:26.833178 [debug] [MainThread]: Command `dbt deps` succeeded at 14:08:26.833076 after 0.39 seconds
[0m14:08:26.833628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab47bb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab2129e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab046eab0>]}
[0m14:08:26.834042 [debug] [MainThread]: Flushing usage events
[0m14:08:28.549408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dad8321b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dacdb79b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8daccddb20>]}


============================== 14:08:28.552527 | 11d6a7a5-0d1c-4d6e-bd6a-ccf60b9050e5 ==============================
[0m14:08:28.552527 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:08:28.553185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:08:28.756172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11d6a7a5-0d1c-4d6e-bd6a-ccf60b9050e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dacc7c830>]}
[0m14:08:28.815407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11d6a7a5-0d1c-4d6e-bd6a-ccf60b9050e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dacb16540>]}
[0m14:08:28.818021 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:08:28.848102 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:08:28.848828 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:08:28.849358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '11d6a7a5-0d1c-4d6e-bd6a-ccf60b9050e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dae935400>]}
[0m14:08:30.136435 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:08:30.137111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '11d6a7a5-0d1c-4d6e-bd6a-ccf60b9050e5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dacb99ac0>]}
[0m14:08:30.371542 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:08:30.376963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11d6a7a5-0d1c-4d6e-bd6a-ccf60b9050e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dad64b050>]}
[0m14:08:30.478749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11d6a7a5-0d1c-4d6e-bd6a-ccf60b9050e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da86e66c0>]}
[0m14:08:30.479313 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:08:30.479807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11d6a7a5-0d1c-4d6e-bd6a-ccf60b9050e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da894e8a0>]}
[0m14:08:30.481690 [info ] [MainThread]: 
[0m14:08:30.482389 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:08:30.487036 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:08:30.522047 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:08:30.522512 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:08:30.522891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:30.865471 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:30.867537 [debug] [ThreadPool]: On list_petro: Close
[0m14:08:30.868774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:08:30.869518 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:08:30.879138 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:08:30.879682 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:08:30.880181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:30.881174 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:30.882505 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:08:30.882889 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:08:30.883432 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:30.883808 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:08:30.884167 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:08:30.884805 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:30.885712 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:08:30.886102 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:08:30.886481 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:08:30.887016 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:30.887439 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:08:30.888649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:08:30.894244 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:08:30.894749 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:08:30.895103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:30.895748 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:30.896130 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:08:30.896527 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:08:30.905730 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:30.907163 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:08:30.908404 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:08:30.908802 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:08:30.910989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11d6a7a5-0d1c-4d6e-bd6a-ccf60b9050e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da8681670>]}
[0m14:08:30.911510 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:30.911883 [debug] [MainThread]: On master: BEGIN
[0m14:08:30.912231 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:30.912841 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:08:30.913225 [debug] [MainThread]: On master: COMMIT
[0m14:08:30.913619 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:30.913969 [debug] [MainThread]: On master: COMMIT
[0m14:08:30.914552 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:08:30.914941 [debug] [MainThread]: On master: Close
[0m14:08:30.915488 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:08:30.915953 [info ] [MainThread]: 
[0m14:08:30.935727 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:08:30.936289 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:08:30.936931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:08:30.937396 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:08:30.963942 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:08:30.964696 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:08:30.999668 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:08:31.000566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:44.361833 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:08:44.362359 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:08:44.363029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:44.363492 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:08:44.363910 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:08:44.364643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:44.367584 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:08:44.368020 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:08:44.368691 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:44.385236 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:08:44.385723 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:08:44.386137 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:08:44.387239 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:44.392838 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:08:44.393284 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:08:44.394671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:44.397022 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:08:44.398583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d6a7a5-0d1c-4d6e-bd6a-ccf60b9050e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d6ad0cad0>]}
[0m14:08:44.399260 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 13.46s]
[0m14:08:44.400093 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:08:44.400933 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:08:44.401612 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:08:44.402269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:08:44.402751 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:08:44.407621 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:08:44.408391 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:08:44.444234 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:44.444751 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250729140844438201"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:08:44.445194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:44.453212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:44.460926 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:44.461400 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:08:44.462019 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:44.462473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:44.462888 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250729140844438201'
      
      
      order by ordinal_position

  
[0m14:08:44.465061 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:44.470259 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:44.470730 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:08:44.472902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:44.480517 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:44.480971 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:08:44.483670 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:44.501868 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:08:44.502583 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:44.503033 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250729140844438201"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250729140844438201"
    )
  
[0m14:08:44.554729 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:44.556762 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:08:44.557209 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:44.557639 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:08:44.565666 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:44.566632 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:08:44.568047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d6a7a5-0d1c-4d6e-bd6a-ccf60b9050e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da41cb260>]}
[0m14:08:44.568731 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:08:44.569550 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:08:44.570978 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:44.571426 [debug] [MainThread]: On master: BEGIN
[0m14:08:44.571805 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:08:44.572492 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:08:44.572885 [debug] [MainThread]: On master: COMMIT
[0m14:08:44.573248 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:44.573639 [debug] [MainThread]: On master: COMMIT
[0m14:08:44.574154 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:08:44.574584 [debug] [MainThread]: On master: Close
[0m14:08:44.575175 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:44.575588 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:08:44.575985 [info ] [MainThread]: 
[0m14:08:44.576505 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.09 seconds (14.09s).
[0m14:08:44.577508 [debug] [MainThread]: Command end result
[0m14:08:44.603223 [info ] [MainThread]: 
[0m14:08:44.603857 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:08:44.604375 [info ] [MainThread]: 
[0m14:08:44.604890 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:08:44.605892 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.106508, "process_user_time": 4.644599, "process_kernel_time": 0.303104, "process_mem_max_rss": "312320", "process_in_blocks": "1456", "process_out_blocks": "100000"}
[0m14:08:44.606451 [debug] [MainThread]: Command `dbt run` succeeded at 14:08:44.606346 after 16.11 seconds
[0m14:08:44.606886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da89fe120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dad0b2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da41cade0>]}
[0m14:08:44.607308 [debug] [MainThread]: Flushing usage events
[0m14:08:46.905892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f5b3f1b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f5b3f1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f5bdc0050>]}


============================== 14:08:46.908958 | c45f2b86-a142-4341-84e3-5f33897a3c68 ==============================
[0m14:08:46.908958 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:08:46.909594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:08:47.016893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c45f2b86-a142-4341-84e3-5f33897a3c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f5b33d850>]}
[0m14:08:47.034645 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17781052, "process_user_time": 1.336862, "process_kernel_time": 0.112903, "process_mem_max_rss": "100580", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:08:47.035175 [debug] [MainThread]: Command `dbt clean` succeeded at 14:08:47.035075 after 0.18 seconds
[0m14:08:47.035629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f5b59b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f5f503c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f5b21c440>]}
[0m14:08:47.036034 [debug] [MainThread]: Flushing usage events
[0m22:06:52.815934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8b41f5ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8b463da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8b45e8c20>]}


============================== 22:06:52.834948 | 9f44e3fb-af30-4e53-a1a9-1c5a5d8230a6 ==============================
[0m22:06:52.834948 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:52.835623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:52.970954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f44e3fb-af30-4e53-a1a9-1c5a5d8230a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8b45ea3c0>]}
[0m22:06:52.985345 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-i34js_ep'
[0m22:06:52.985786 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:53.095344 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:53.095960 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:53.108166 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:53.111900 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:53.251253 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:53.251733 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:53.252251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9f44e3fb-af30-4e53-a1a9-1c5a5d8230a6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8b41bb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8b404dc40>]}
[0m22:06:53.252682 [info ] [MainThread]: 
[0m22:06:53.253162 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:53.259597 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49244928, "process_user_time": 1.556579, "process_kernel_time": 0.12813, "process_mem_max_rss": "101504", "process_in_blocks": "8496", "process_out_blocks": "5168"}
[0m22:06:53.260137 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:53.260037 after 0.49 seconds
[0m22:06:53.260538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8b4687530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8b419f6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8b5df5100>]}
[0m22:06:53.260970 [debug] [MainThread]: Flushing usage events
[0m22:06:54.918977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe07e86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe0270050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe0270260>]}


============================== 22:06:54.921992 | 898d862c-11c7-4d49-8660-1612bf7fa763 ==============================
[0m22:06:54.921992 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:54.922610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:55.122702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '898d862c-11c7-4d49-8660-1612bf7fa763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe01b6630>]}
[0m22:06:55.181021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '898d862c-11c7-4d49-8660-1612bf7fa763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe0308920>]}
[0m22:06:55.183486 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:55.216383 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:55.217091 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:55.217598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '898d862c-11c7-4d49-8660-1612bf7fa763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe0011f70>]}
[0m22:06:56.498335 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:56.498957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '898d862c-11c7-4d49-8660-1612bf7fa763', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fdc0bda00>]}
[0m22:06:56.724060 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:56.729437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '898d862c-11c7-4d49-8660-1612bf7fa763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fdbe561e0>]}
[0m22:06:56.850442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '898d862c-11c7-4d49-8660-1612bf7fa763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fdbe8dca0>]}
[0m22:06:56.850958 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:56.851470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '898d862c-11c7-4d49-8660-1612bf7fa763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fdbedfb30>]}
[0m22:06:56.853284 [info ] [MainThread]: 
[0m22:06:56.853979 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:56.858548 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:56.892588 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:56.893029 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:56.893409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:57.360998 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:57.362613 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:57.363659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:57.364229 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:57.371579 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:57.372020 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:57.372397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:57.373251 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:57.374542 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:57.374951 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:57.375495 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:57.375905 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:57.376275 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:57.376894 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:57.377853 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:57.378240 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:57.378601 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:57.379170 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:57.379563 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:57.380789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:57.386447 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:57.386873 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:57.387235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:57.387835 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:57.388224 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:57.388595 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:57.398645 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:57.400099 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:57.401329 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:57.401737 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:57.404002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '898d862c-11c7-4d49-8660-1612bf7fa763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fdbeee600>]}
[0m22:06:57.404495 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:57.404905 [debug] [MainThread]: On master: BEGIN
[0m22:06:57.405272 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:57.405914 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:57.406310 [debug] [MainThread]: On master: COMMIT
[0m22:06:57.406676 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:57.407078 [debug] [MainThread]: On master: COMMIT
[0m22:06:57.407595 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:57.408021 [debug] [MainThread]: On master: Close
[0m22:06:57.408539 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:57.409107 [info ] [MainThread]: 
[0m22:06:57.430952 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:57.431525 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:57.432120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:57.432551 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:57.459610 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:57.460361 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:57.495462 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:57.496190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:06.125326 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:06.125827 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:06.126464 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:06.126936 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:06.127355 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:06.128242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:06.131162 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:06.131604 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:06.132320 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:06.148879 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:06.149334 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:06.149744 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:06.150829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:06.157157 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:06.157608 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:06.158738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:06.161447 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:06.163461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '898d862c-11c7-4d49-8660-1612bf7fa763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe1f3a360>]}
[0m22:07:06.164368 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.73s]
[0m22:07:06.165150 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:06.166035 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:06.166587 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:06.167239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:06.167670 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:06.172584 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:06.173226 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:06.208935 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:06.209420 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250729220706202942"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:06.209889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:06.217520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:06.224889 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:06.225346 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:06.225964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:06.226406 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:06.226850 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250729220706202942'
      
      
      order by ordinal_position

  
[0m22:07:06.228947 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:06.233976 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:06.234435 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:06.236508 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:06.244037 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:06.244491 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:06.246816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:06.264762 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:06.265436 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:06.265909 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250729220706202942"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250729220706202942"
    )
  
[0m22:07:06.316451 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:06.318438 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:06.318895 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:06.319311 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:06.326851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:06.327727 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:06.329123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '898d862c-11c7-4d49-8660-1612bf7fa763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe0013920>]}
[0m22:07:06.329809 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:07:06.330547 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:06.332076 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:06.332471 [debug] [MainThread]: On master: BEGIN
[0m22:07:06.332868 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:06.333512 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:06.333941 [debug] [MainThread]: On master: COMMIT
[0m22:07:06.334312 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:06.334667 [debug] [MainThread]: On master: COMMIT
[0m22:07:06.335215 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:06.335601 [debug] [MainThread]: On master: Close
[0m22:07:06.336251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:06.336620 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:06.337061 [info ] [MainThread]: 
[0m22:07:06.337504 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.48 seconds (9.48s).
[0m22:07:06.338417 [debug] [MainThread]: Command end result
[0m22:07:06.364010 [info ] [MainThread]: 
[0m22:07:06.364545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:06.365005 [info ] [MainThread]: 
[0m22:07:06.365459 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:06.366382 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.4960375, "process_user_time": 4.9907, "process_kernel_time": 0.310607, "process_mem_max_rss": "303192", "process_in_blocks": "1200", "process_out_blocks": "100032"}
[0m22:07:06.366954 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:06.366847 after 11.50 seconds
[0m22:07:06.367389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe04ff980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fdbe8ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fa1da7530>]}
[0m22:07:06.367829 [debug] [MainThread]: Flushing usage events
[0m22:07:08.156111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2214b519a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22129c5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22129c6e40>]}


============================== 22:07:08.159144 | 29434060-a90d-4c50-b7ea-70cdae32a525 ==============================
[0m22:07:08.159144 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:08.159761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:07:08.266834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29434060-a90d-4c50-b7ea-70cdae32a525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2211f68260>]}
[0m22:07:08.284312 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17692384, "process_user_time": 1.304591, "process_kernel_time": 0.110965, "process_mem_max_rss": "100628", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:08.284835 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:08.284715 after 0.18 seconds
[0m22:07:08.285245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f221298bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2212bb4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22123c2a80>]}
[0m22:07:08.285658 [debug] [MainThread]: Flushing usage events
[0m06:03:06.474827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff38f783890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3922999a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff390a53590>]}


============================== 06:03:06.490649 | 9237548c-8097-4d6c-b5db-123942cc5222 ==============================
[0m06:03:06.490649 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:06.491345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:03:06.601482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9237548c-8097-4d6c-b5db-123942cc5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff38f597ec0>]}
[0m06:03:06.616317 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-y9vobrfi'
[0m06:03:06.616768 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:03:06.738424 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:03:06.739163 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:03:06.751229 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:03:06.755061 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:03:06.960014 [info ] [MainThread]: Installed from version 1.2.0
[0m06:03:06.960606 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:03:06.961201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9237548c-8097-4d6c-b5db-123942cc5222', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff38fb78350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff390700050>]}
[0m06:03:06.961650 [info ] [MainThread]: 
[0m06:03:06.962172 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:03:06.967944 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5426362, "process_user_time": 1.580429, "process_kernel_time": 0.120879, "process_mem_max_rss": "101528", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m06:03:06.968502 [debug] [MainThread]: Command `dbt deps` succeeded at 06:03:06.968401 after 0.54 seconds
[0m06:03:06.968921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff393cd38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3922999a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff39003f8f0>]}
[0m06:03:06.969384 [debug] [MainThread]: Flushing usage events
[0m06:03:08.776257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c5e849e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c58b4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c5e86a20>]}


============================== 06:03:08.779376 | 17b051cf-006e-45a9-afe6-124ff539b062 ==============================
[0m06:03:08.779376 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:08.780099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:08.982295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17b051cf-006e-45a9-afe6-124ff539b062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c4b5bcb0>]}
[0m06:03:09.040701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17b051cf-006e-45a9-afe6-124ff539b062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c5640b60>]}
[0m06:03:09.043341 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:03:09.071530 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:03:09.072280 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:03:09.072808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '17b051cf-006e-45a9-afe6-124ff539b062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c5942240>]}
[0m06:03:10.357850 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:03:10.358513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '17b051cf-006e-45a9-afe6-124ff539b062', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c0939310>]}
[0m06:03:10.595947 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:03:10.601379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17b051cf-006e-45a9-afe6-124ff539b062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c6937830>]}
[0m06:03:10.699673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17b051cf-006e-45a9-afe6-124ff539b062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c0935b20>]}
[0m06:03:10.700232 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:03:10.700705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17b051cf-006e-45a9-afe6-124ff539b062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c09ec5c0>]}
[0m06:03:10.702562 [info ] [MainThread]: 
[0m06:03:10.703256 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:03:10.708010 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:03:10.742298 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:03:10.742739 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:03:10.743148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:11.283242 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:03:11.285311 [debug] [ThreadPool]: On list_petro: Close
[0m06:03:11.286373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:03:11.287062 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:03:11.295922 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:11.296410 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:03:11.296792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:11.297766 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:11.299076 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:11.299460 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:03:11.300040 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:11.300428 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:11.300786 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:03:11.301362 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:11.302266 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:11.302652 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:11.303032 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:11.303564 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:11.303945 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:03:11.305187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:03:11.310708 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:11.311209 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:03:11.311563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:11.312201 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:11.312587 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:11.312975 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:03:11.323081 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:11.324499 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:03:11.325726 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:03:11.326143 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:03:11.328355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17b051cf-006e-45a9-afe6-124ff539b062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c0974f50>]}
[0m06:03:11.328842 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:11.329261 [debug] [MainThread]: On master: BEGIN
[0m06:03:11.329611 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:11.330247 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:11.330638 [debug] [MainThread]: On master: COMMIT
[0m06:03:11.331037 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:11.331401 [debug] [MainThread]: On master: COMMIT
[0m06:03:11.331909 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:11.332324 [debug] [MainThread]: On master: Close
[0m06:03:11.332832 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:03:11.333336 [info ] [MainThread]: 
[0m06:03:11.350579 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:03:11.351190 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:03:11.351817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:03:11.352293 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:03:11.379601 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:03:11.380502 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:03:11.415923 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:03:11.416701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:21.688305 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:21.688801 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:21.689446 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:21.689876 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:21.690318 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:21.691031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:21.693881 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:21.694339 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:21.695005 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:21.711576 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:21.712051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:21.712471 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:21.714415 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:21.720072 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:21.720521 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:21.721660 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:21.724062 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:21.725578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17b051cf-006e-45a9-afe6-124ff539b062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c6a727b0>]}
[0m06:03:21.726262 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.37s]
[0m06:03:21.727083 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:21.728030 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:21.728565 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:21.729191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:21.729616 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:21.734437 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:21.735092 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:21.770824 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:21.771325 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250730060321764832"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:21.771777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:21.779368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:21.786671 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:21.787143 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:21.787722 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:21.788170 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:21.788584 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250730060321764832'
      
      
      order by ordinal_position

  
[0m06:03:21.790718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:21.795779 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:21.796249 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:21.798348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:21.805797 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:21.806265 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:21.808661 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:21.826596 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:21.827292 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:21.827738 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250730060321764832"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250730060321764832"
    )
  
[0m06:03:21.876358 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:21.878349 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:21.878799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:21.879247 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:21.886579 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:21.887482 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:21.888920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17b051cf-006e-45a9-afe6-124ff539b062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb786272fc0>]}
[0m06:03:21.889599 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:03:21.890401 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:21.891837 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:21.892280 [debug] [MainThread]: On master: BEGIN
[0m06:03:21.892652 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:21.893307 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:21.893698 [debug] [MainThread]: On master: COMMIT
[0m06:03:21.894104 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:21.894484 [debug] [MainThread]: On master: COMMIT
[0m06:03:21.895021 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:21.895416 [debug] [MainThread]: On master: Close
[0m06:03:21.896046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:21.896414 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:21.896805 [info ] [MainThread]: 
[0m06:03:21.897345 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.19 seconds (11.19s).
[0m06:03:21.898337 [debug] [MainThread]: Command end result
[0m06:03:21.924323 [info ] [MainThread]: 
[0m06:03:21.924915 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:21.925471 [info ] [MainThread]: 
[0m06:03:21.926008 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:21.926992 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.199882, "process_user_time": 5.172008, "process_kernel_time": 0.272421, "process_mem_max_rss": "346332", "process_in_blocks": "1200", "process_out_blocks": "100016"}
[0m06:03:21.927526 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:21.927424 after 13.20 seconds
[0m06:03:21.927970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c531aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c5e86a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c09344a0>]}
[0m06:03:21.928401 [debug] [MainThread]: Flushing usage events
[0m06:03:24.055347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa53292210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa53292bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa54d415e0>]}


============================== 06:03:24.058411 | 19316806-ad20-4aba-b39b-7b944d29622e ==============================
[0m06:03:24.058411 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:24.059108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:03:24.167263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19316806-ad20-4aba-b39b-7b944d29622e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa530bd010>]}
[0m06:03:24.185163 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1791851, "process_user_time": 1.378093, "process_kernel_time": 0.119921, "process_mem_max_rss": "100488", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:03:24.185701 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:24.185599 after 0.18 seconds
[0m06:03:24.186141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa52259370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa52147860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa52146cf0>]}
[0m06:03:24.186547 [debug] [MainThread]: Flushing usage events
[0m14:07:44.992518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f788bcfbfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f788a4d7a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f788a4d58b0>]}


============================== 14:07:45.025673 | 06c1de90-5f79-4dc4-9666-b726dcf7a2f2 ==============================
[0m14:07:45.025673 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:45.026402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:45.214149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06c1de90-5f79-4dc4-9666-b726dcf7a2f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f788b7399d0>]}
[0m14:07:45.230136 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1ve1fkoc'
[0m14:07:45.230614 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:07:45.277634 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:07:45.278338 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:07:45.291997 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:07:45.295841 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:07:45.351669 [info ] [MainThread]: Installed from version 1.2.0
[0m14:07:45.352265 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:07:45.352845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '06c1de90-5f79-4dc4-9666-b726dcf7a2f2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f788977b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f788977b980>]}
[0m14:07:45.353300 [info ] [MainThread]: 
[0m14:07:45.353836 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:07:45.368614 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4267012, "process_user_time": 1.619624, "process_kernel_time": 0.145966, "process_mem_max_rss": "101428", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m14:07:45.369257 [debug] [MainThread]: Command `dbt deps` succeeded at 14:07:45.369153 after 0.43 seconds
[0m14:07:45.369724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78899dbef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f788b7399d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f788a71c140>]}
[0m14:07:45.370147 [debug] [MainThread]: Flushing usage events
[0m14:07:46.976759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fd5bc5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fd8461b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fe0bbda0>]}


============================== 14:07:46.979908 | 20892c10-6092-484a-8fd3-aa2adf0624d3 ==============================
[0m14:07:46.979908 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:46.980536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:47.186355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20892c10-6092-484a-8fd3-aa2adf0624d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fd4ff8c0>]}
[0m14:07:47.246538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20892c10-6092-484a-8fd3-aa2adf0624d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46ff2dd2b0>]}
[0m14:07:47.249453 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:07:47.291350 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:07:47.292155 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:07:47.292719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '20892c10-6092-484a-8fd3-aa2adf0624d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fd264f50>]}
[0m14:07:48.591179 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:07:48.591850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '20892c10-6092-484a-8fd3-aa2adf0624d3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46f911c320>]}
[0m14:07:48.834183 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:07:48.839820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20892c10-6092-484a-8fd3-aa2adf0624d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fdf3f680>]}
[0m14:07:48.968633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20892c10-6092-484a-8fd3-aa2adf0624d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46f91f9820>]}
[0m14:07:48.969214 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:07:48.969763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20892c10-6092-484a-8fd3-aa2adf0624d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46f91df350>]}
[0m14:07:48.971583 [info ] [MainThread]: 
[0m14:07:48.972300 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:07:48.976992 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:07:49.012372 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:07:49.012855 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:07:49.013245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:49.513497 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:07:49.515164 [debug] [ThreadPool]: On list_petro: Close
[0m14:07:49.516212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:07:49.516816 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:07:49.524340 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:49.524786 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:07:49.525164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:49.526075 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:49.527435 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:49.527846 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:07:49.528410 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:49.528814 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:49.529176 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:07:49.529817 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:49.530750 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:49.531145 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:49.531512 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:49.532070 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:49.532466 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:07:49.533799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:07:49.539701 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:49.540194 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:07:49.540551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:49.541204 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:49.541596 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:49.542010 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:07:49.552027 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:49.553471 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:07:49.554818 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:07:49.555206 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:07:49.557425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20892c10-6092-484a-8fd3-aa2adf0624d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46f7c35970>]}
[0m14:07:49.557963 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:49.558345 [debug] [MainThread]: On master: BEGIN
[0m14:07:49.558725 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:49.559326 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:49.559743 [debug] [MainThread]: On master: COMMIT
[0m14:07:49.560121 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:49.560481 [debug] [MainThread]: On master: COMMIT
[0m14:07:49.561080 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:49.561475 [debug] [MainThread]: On master: Close
[0m14:07:49.562037 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:07:49.562497 [info ] [MainThread]: 
[0m14:07:49.609304 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:07:49.609975 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:07:49.610570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:07:49.611046 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:07:49.638513 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:07:49.639293 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:07:49.674983 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:07:49.675754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:57.929102 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:57.929615 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:07:57.930287 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:57.930744 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:57.931168 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:07:57.931912 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:57.934876 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:57.935321 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:07:57.935998 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:57.952877 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:57.953336 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:57.953779 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:57.954846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:57.960471 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:57.960945 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:07:57.962095 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:57.964473 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:07:57.966021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20892c10-6092-484a-8fd3-aa2adf0624d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bb009f70>]}
[0m14:07:57.966724 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.35s]
[0m14:07:57.967457 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:07:57.968291 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:07:57.968878 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:07:57.969622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:07:57.970102 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:07:57.974984 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:07:57.975687 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:07:58.011615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:58.012135 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250730140758005460"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:07:58.012589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:58.020600 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:58.028305 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:58.028785 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:07:58.029399 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:58.029860 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:58.030284 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250730140758005460'
      
      
      order by ordinal_position

  
[0m14:07:58.032369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:58.037531 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:58.038006 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:58.040579 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:58.048459 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:58.048976 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:58.051746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:58.070324 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:07:58.071131 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:58.071595 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250730140758005460"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250730140758005460"
    )
  
[0m14:07:58.121346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:58.123438 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:58.123937 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:58.124352 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:58.131956 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:58.132886 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:07:58.134371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20892c10-6092-484a-8fd3-aa2adf0624d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bb00f350>]}
[0m14:07:58.135069 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:07:58.135892 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:07:58.137237 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:58.137675 [debug] [MainThread]: On master: BEGIN
[0m14:07:58.138065 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:58.138750 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:58.139156 [debug] [MainThread]: On master: COMMIT
[0m14:07:58.139520 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:58.139919 [debug] [MainThread]: On master: COMMIT
[0m14:07:58.140435 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:58.140849 [debug] [MainThread]: On master: Close
[0m14:07:58.141441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:58.141849 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:07:58.142255 [info ] [MainThread]: 
[0m14:07:58.142736 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.17 seconds (9.17s).
[0m14:07:58.143642 [debug] [MainThread]: Command end result
[0m14:07:58.169379 [info ] [MainThread]: 
[0m14:07:58.169954 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:58.170417 [info ] [MainThread]: 
[0m14:07:58.170899 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:07:58.171884 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.2448845, "process_user_time": 4.752987, "process_kernel_time": 0.269169, "process_mem_max_rss": "322900", "process_in_blocks": "1200", "process_out_blocks": "100096"}
[0m14:07:58.172426 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:58.172324 after 11.25 seconds
[0m14:07:58.172884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fdf3fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bb809850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c0137f20>]}
[0m14:07:58.173310 [debug] [MainThread]: Flushing usage events
[0m14:07:59.998960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45ea840830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45ecb514f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45eaa295b0>]}


============================== 14:08:00.002068 | fc78cfdd-49e3-48b8-a735-41ad6473889c ==============================
[0m14:08:00.002068 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:08:00.002774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:00.112952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc78cfdd-49e3-48b8-a735-41ad6473889c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45ebc7b3e0>]}
[0m14:08:00.131548 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18200739, "process_user_time": 1.358379, "process_kernel_time": 0.105029, "process_mem_max_rss": "100376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:08:00.132124 [debug] [MainThread]: Command `dbt clean` succeeded at 14:08:00.132009 after 0.18 seconds
[0m14:08:00.132549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45ea364f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45ea2c1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45ea3c29f0>]}
[0m14:08:00.133004 [debug] [MainThread]: Flushing usage events
[0m22:06:49.051295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f0d86000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52eef11130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ef0c1070>]}


============================== 22:06:49.070354 | 2847c391-3f18-4ec8-a83e-f23bca0a6593 ==============================
[0m22:06:49.070354 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:49.070990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:49.213454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2847c391-3f18-4ec8-a83e-f23bca0a6593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ee067fe0>]}
[0m22:06:49.227879 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ux7g0i1v'
[0m22:06:49.228310 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:49.337052 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:49.337645 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:49.348821 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:49.352593 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:49.406931 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:49.407420 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:49.407952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2847c391-3f18-4ec8-a83e-f23bca0a6593', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ee0547d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ef3dbb90>]}
[0m22:06:49.408377 [info ] [MainThread]: 
[0m22:06:49.408855 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:49.417628 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41561592, "process_user_time": 1.540833, "process_kernel_time": 0.140623, "process_mem_max_rss": "101612", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m22:06:49.418171 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:49.418071 after 0.42 seconds
[0m22:06:49.418566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f27bb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ee067fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ee88bc80>]}
[0m22:06:49.418990 [debug] [MainThread]: Flushing usage events
[0m22:06:51.028026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8769914f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8768e8f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa877204230>]}


============================== 22:06:51.031042 | fdb8ae4c-190d-480f-af48-9d04c4fe3a01 ==============================
[0m22:06:51.031042 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:51.031710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:51.233670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdb8ae4c-190d-480f-af48-9d04c4fe3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa87688f6e0>]}
[0m22:06:51.292512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdb8ae4c-190d-480f-af48-9d04c4fe3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa876f6dbb0>]}
[0m22:06:51.294979 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:51.329223 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:51.329937 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:51.330452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fdb8ae4c-190d-480f-af48-9d04c4fe3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa876846450>]}
[0m22:06:52.613271 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:52.613876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fdb8ae4c-190d-480f-af48-9d04c4fe3a01', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa87760d6a0>]}
[0m22:06:52.837531 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:52.842934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdb8ae4c-190d-480f-af48-9d04c4fe3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa872532630>]}
[0m22:06:52.945515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdb8ae4c-190d-480f-af48-9d04c4fe3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa87251cce0>]}
[0m22:06:52.946013 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:52.946525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdb8ae4c-190d-480f-af48-9d04c4fe3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa87257c3e0>]}
[0m22:06:52.948305 [info ] [MainThread]: 
[0m22:06:52.949000 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:52.953624 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:52.987863 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:52.988290 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:52.988697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:53.461744 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:53.464015 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:53.465368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:53.466179 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:53.474096 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:53.474514 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:53.474922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:53.475940 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:53.477279 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:53.477667 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:53.478240 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:53.478623 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:53.479027 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:53.479611 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:53.480548 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:53.480980 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:53.481349 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:53.481895 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:53.482292 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:53.483534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:53.489263 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:53.489776 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:53.490142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:53.490775 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:53.491167 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:53.491544 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:53.501583 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:53.503035 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:53.504264 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:53.504657 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:53.506984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdb8ae4c-190d-480f-af48-9d04c4fe3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa87257c050>]}
[0m22:06:53.507481 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:53.507912 [debug] [MainThread]: On master: BEGIN
[0m22:06:53.508275 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:53.508890 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:53.509286 [debug] [MainThread]: On master: COMMIT
[0m22:06:53.509667 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:53.510067 [debug] [MainThread]: On master: COMMIT
[0m22:06:53.510584 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:53.510991 [debug] [MainThread]: On master: Close
[0m22:06:53.511502 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:53.512023 [info ] [MainThread]: 
[0m22:06:53.530398 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:53.530995 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:53.531614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:53.532077 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:53.558480 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:53.559239 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:53.594417 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:53.595166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:00.926849 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:00.927337 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:00.927983 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.928420 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:00.928872 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:00.929630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.932650 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:00.933113 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:00.933882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.950578 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:00.951076 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:00.951502 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:00.953180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.958906 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:00.959358 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:00.960520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.962918 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:00.964451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdb8ae4c-190d-480f-af48-9d04c4fe3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa838431f10>]}
[0m22:07:00.965156 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.43s]
[0m22:07:00.965981 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:00.966908 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:00.967461 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:00.968115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:00.968548 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:00.973438 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:00.974079 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:01.009853 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:01.010340 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250730220701003861"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:01.010816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:01.018505 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:01.025903 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:01.026353 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:01.026958 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:01.027396 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:01.027841 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250730220701003861'
      
      
      order by ordinal_position

  
[0m22:07:01.030004 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:01.035150 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:01.035608 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:01.038696 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:01.046192 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:01.046649 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:01.049315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:01.067408 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:01.068084 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:01.068534 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250730220701003861"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250730220701003861"
    )
  
[0m22:07:01.117611 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:01.119587 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:01.120074 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:01.120490 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:01.127703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:01.128587 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:01.130074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdb8ae4c-190d-480f-af48-9d04c4fe3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa83840f650>]}
[0m22:07:01.130760 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:07:01.131552 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:01.133172 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:01.133580 [debug] [MainThread]: On master: BEGIN
[0m22:07:01.133995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:01.134639 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:01.135065 [debug] [MainThread]: On master: COMMIT
[0m22:07:01.135431 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:01.135829 [debug] [MainThread]: On master: COMMIT
[0m22:07:01.136362 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:01.136783 [debug] [MainThread]: On master: Close
[0m22:07:01.137360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:01.137751 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:01.138167 [info ] [MainThread]: 
[0m22:07:01.138704 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.19 seconds (8.19s).
[0m22:07:01.139731 [debug] [MainThread]: Command end result
[0m22:07:01.165286 [info ] [MainThread]: 
[0m22:07:01.165899 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:01.166412 [info ] [MainThread]: 
[0m22:07:01.166950 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:01.167949 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.188662, "process_user_time": 5.077759, "process_kernel_time": 0.253137, "process_mem_max_rss": "307944", "process_in_blocks": "1200", "process_out_blocks": "100136"}
[0m22:07:01.168484 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:01.168382 after 10.19 seconds
[0m22:07:01.168944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa876d50560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa876974500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa879470cb0>]}
[0m22:07:01.169367 [debug] [MainThread]: Flushing usage events
[0m22:07:02.988423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3802ba79b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38020cf590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38020cd730>]}


============================== 22:07:02.991472 | 18f01ac6-0c2d-4c58-981e-e3f19c9de483 ==============================
[0m22:07:02.991472 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:02.992165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:07:03.100581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18f01ac6-0c2d-4c58-981e-e3f19c9de483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3801b24d40>]}
[0m22:07:03.117934 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17867659, "process_user_time": 1.309112, "process_kernel_time": 0.122916, "process_mem_max_rss": "100596", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:07:03.118438 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:03.118337 after 0.18 seconds
[0m22:07:03.118866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f380298e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3801a1d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3801eb87a0>]}
[0m22:07:03.119271 [debug] [MainThread]: Flushing usage events
[0m06:02:32.310937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08ea1c3380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e9d30770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08ec975490>]}


============================== 06:02:32.327987 | 37a8eb91-8701-4bdc-a088-1745b7636859 ==============================
[0m06:02:32.327987 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:32.328678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:32.480249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37a8eb91-8701-4bdc-a088-1745b7636859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e9b7b2f0>]}
[0m06:02:32.497255 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lgfz4xtn'
[0m06:02:32.497833 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:32.748305 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:32.749304 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:32.778550 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:32.782636 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:32.841944 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:32.842569 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:32.843245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '37a8eb91-8701-4bdc-a088-1745b7636859', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08eafdaea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08eaedae40>]}
[0m06:02:32.843700 [info ] [MainThread]: 
[0m06:02:32.844222 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:32.850117 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5898285, "process_user_time": 1.587636, "process_kernel_time": 0.153964, "process_mem_max_rss": "101440", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m06:02:32.850690 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:32.850585 after 0.59 seconds
[0m06:02:32.851159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08ee3bb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08eafdaea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e9f256a0>]}
[0m06:02:32.851603 [debug] [MainThread]: Flushing usage events
[0m06:02:34.574448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952bd8ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952e804950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952b9f4590>]}


============================== 06:02:34.577523 | b8884d46-3b3f-4451-9d7e-78243a863e07 ==============================
[0m06:02:34.577523 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:34.578211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:34.777604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8884d46-3b3f-4451-9d7e-78243a863e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952b65b740>]}
[0m06:02:34.835940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8884d46-3b3f-4451-9d7e-78243a863e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952d6d8fb0>]}
[0m06:02:34.838507 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:34.867251 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:34.867992 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:34.868499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b8884d46-3b3f-4451-9d7e-78243a863e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952b6522d0>]}
[0m06:02:36.149845 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:36.150495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b8884d46-3b3f-4451-9d7e-78243a863e07', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9527798e00>]}
[0m06:02:36.378351 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:36.383764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8884d46-3b3f-4451-9d7e-78243a863e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95275bd1c0>]}
[0m06:02:36.480869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8884d46-3b3f-4451-9d7e-78243a863e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9527520c80>]}
[0m06:02:36.481367 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:36.481903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8884d46-3b3f-4451-9d7e-78243a863e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952c3c6420>]}
[0m06:02:36.483656 [info ] [MainThread]: 
[0m06:02:36.484352 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:36.488955 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:36.523442 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:36.523881 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:36.524265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:36.838156 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.840110 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:36.841294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:36.841980 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:36.850352 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.850769 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:36.851170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:36.852045 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.853350 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.853736 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:36.854354 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.854734 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.855122 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:36.855684 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.856617 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:36.857030 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.857388 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:36.857937 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.858331 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:36.859588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:36.865242 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:36.865727 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:36.866123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:36.866710 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.867113 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:36.867484 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:36.877041 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.878478 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:36.879742 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:36.880151 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:36.882206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8884d46-3b3f-4451-9d7e-78243a863e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952d6d92b0>]}
[0m06:02:36.882688 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:36.883087 [debug] [MainThread]: On master: BEGIN
[0m06:02:36.883439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:36.884040 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:36.884430 [debug] [MainThread]: On master: COMMIT
[0m06:02:36.884791 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:36.885169 [debug] [MainThread]: On master: COMMIT
[0m06:02:36.885674 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:36.886071 [debug] [MainThread]: On master: Close
[0m06:02:36.886574 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:36.887107 [info ] [MainThread]: 
[0m06:02:36.902274 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:36.902868 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:36.903505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:36.903961 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:36.930625 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:36.931376 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:36.966425 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:36.967160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:43.809551 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:43.810055 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:43.810677 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:43.811180 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:43.811600 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:43.812338 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:43.815242 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:43.815678 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:43.816359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:43.833015 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:43.833468 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:43.833906 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:43.835607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:43.841202 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:43.841651 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:43.842788 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:43.845157 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:43.846666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8884d46-3b3f-4451-9d7e-78243a863e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ed4ffd40>]}
[0m06:02:43.847374 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.94s]
[0m06:02:43.848201 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:43.849215 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:43.849762 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:43.850405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:43.850856 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:43.855673 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:43.856328 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:43.892740 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:43.893242 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250731060243886737"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:43.893689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:43.901416 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:43.908890 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:43.909338 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:43.909941 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:43.910381 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:43.910815 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250731060243886737'
      
      
      order by ordinal_position

  
[0m06:02:43.912877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:43.917902 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:43.918354 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:43.921400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:43.928998 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:43.929452 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:43.932124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:43.950026 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:43.950699 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:43.951167 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250731060243886737"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250731060243886737"
    )
  
[0m06:02:44.001365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:44.003332 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:44.003768 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:44.004201 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:44.011709 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:44.012614 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:44.014076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8884d46-3b3f-4451-9d7e-78243a863e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ed3b2c00>]}
[0m06:02:44.014733 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:44.015475 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:44.017080 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:44.017477 [debug] [MainThread]: On master: BEGIN
[0m06:02:44.017864 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:44.018487 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:44.018907 [debug] [MainThread]: On master: COMMIT
[0m06:02:44.019270 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:44.019623 [debug] [MainThread]: On master: COMMIT
[0m06:02:44.020175 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:44.020557 [debug] [MainThread]: On master: Close
[0m06:02:44.021144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:44.021497 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:44.021909 [info ] [MainThread]: 
[0m06:02:44.022383 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.54 seconds (7.54s).
[0m06:02:44.023308 [debug] [MainThread]: Command end result
[0m06:02:44.048749 [info ] [MainThread]: 
[0m06:02:44.049336 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:44.049842 [info ] [MainThread]: 
[0m06:02:44.050338 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:44.051314 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.525943, "process_user_time": 4.972474, "process_kernel_time": 0.262235, "process_mem_max_rss": "339832", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:44.051877 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:44.051745 after 9.53 seconds
[0m06:02:44.052307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952b8ebcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9527521ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9527543740>]}
[0m06:02:44.052724 [debug] [MainThread]: Flushing usage events
[0m06:02:45.860672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37e43f91c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37e21f5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37e21f5b80>]}


============================== 06:02:45.863925 | acab1fd3-f3d9-49a5-85d2-4a4ada97e16e ==============================
[0m06:02:45.863925 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:45.864563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:45.972665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acab1fd3-f3d9-49a5-85d2-4a4ada97e16e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37e21f5df0>]}
[0m06:02:45.996525 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18519776, "process_user_time": 1.347782, "process_kernel_time": 0.103906, "process_mem_max_rss": "100576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:45.997303 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:45.997173 after 0.19 seconds
[0m06:02:45.997957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37e2568e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37e6396f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37e1f835c0>]}
[0m06:02:45.998609 [debug] [MainThread]: Flushing usage events
[0m14:07:04.003038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79b6dd790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79b6dda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79b6dc4d0>]}


============================== 14:07:04.020213 | 837c1bde-d839-413b-b349-f4ee2d582291 ==============================
[0m14:07:04.020213 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:04.020872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:07:04.219673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '837c1bde-d839-413b-b349-f4ee2d582291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79bc04a40>]}
[0m14:07:04.235578 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-g3p4tadw'
[0m14:07:04.236077 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:07:04.328121 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:07:04.328864 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:07:04.351650 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:07:04.355647 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:07:04.424813 [info ] [MainThread]: Installed from version 1.2.0
[0m14:07:04.425325 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:07:04.425876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '837c1bde-d839-413b-b349-f4ee2d582291', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79a9dc680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79ac533b0>]}
[0m14:07:04.426331 [info ] [MainThread]: 
[0m14:07:04.426815 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:07:04.432968 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47954634, "process_user_time": 1.59079, "process_kernel_time": 0.149886, "process_mem_max_rss": "101520", "process_in_blocks": "8480", "process_out_blocks": "5168"}
[0m14:07:04.433556 [debug] [MainThread]: Command `dbt deps` succeeded at 14:07:04.433449 after 0.48 seconds
[0m14:07:04.433987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79aadb5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79aadb470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79aac96a0>]}
[0m14:07:04.434431 [debug] [MainThread]: Flushing usage events
[0m14:07:06.098743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9147f7e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91475848c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91475860f0>]}


============================== 14:07:06.102006 | 01073768-e423-42e5-80ff-47b6b3474888 ==============================
[0m14:07:06.102006 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:06.102731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:06.308805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01073768-e423-42e5-80ff-47b6b3474888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914798c9e0>]}
[0m14:07:06.367544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01073768-e423-42e5-80ff-47b6b3474888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91474a06b0>]}
[0m14:07:06.370243 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:07:06.398527 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:07:06.399260 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:07:06.399799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '01073768-e423-42e5-80ff-47b6b3474888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91472095b0>]}
[0m14:07:07.685575 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:07:07.686269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '01073768-e423-42e5-80ff-47b6b3474888', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9143149820>]}
[0m14:07:07.955621 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:07:07.961487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01073768-e423-42e5-80ff-47b6b3474888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9143128320>]}
[0m14:07:08.065751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01073768-e423-42e5-80ff-47b6b3474888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91431e49b0>]}
[0m14:07:08.066338 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:07:08.066843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01073768-e423-42e5-80ff-47b6b3474888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91475cade0>]}
[0m14:07:08.068779 [info ] [MainThread]: 
[0m14:07:08.069508 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:07:08.074219 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:07:08.110134 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:07:08.110596 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:07:08.110984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:08.628272 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:07:08.630092 [debug] [ThreadPool]: On list_petro: Close
[0m14:07:08.631081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:07:08.631685 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:07:08.639476 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:08.639904 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:07:08.640290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:08.641271 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:08.642979 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:08.643508 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:07:08.644144 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:08.644599 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:08.644965 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:07:08.645571 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:08.646504 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:08.646894 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:08.647254 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:08.647802 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:08.648196 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:07:08.649547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:07:08.655425 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:08.655830 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:07:08.656188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:08.656818 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:08.657202 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:08.657623 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:07:08.667269 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:08.668728 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:07:08.669999 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:07:08.670417 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:07:08.672787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01073768-e423-42e5-80ff-47b6b3474888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9141b4d4c0>]}
[0m14:07:08.673324 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:08.673738 [debug] [MainThread]: On master: BEGIN
[0m14:07:08.674099 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:08.674714 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:08.675105 [debug] [MainThread]: On master: COMMIT
[0m14:07:08.675496 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:08.675853 [debug] [MainThread]: On master: COMMIT
[0m14:07:08.676382 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:08.676790 [debug] [MainThread]: On master: Close
[0m14:07:08.677305 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:07:08.677821 [info ] [MainThread]: 
[0m14:07:08.696014 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:07:08.696650 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:07:08.697299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:07:08.697763 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:07:08.724753 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:07:08.725537 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:07:08.760972 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:07:08.761756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:16.821575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:16.822147 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:07:16.822923 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:16.823380 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:16.823858 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:07:16.824617 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:16.827953 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:16.828417 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:07:16.829117 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:16.846058 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:16.846560 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:16.846988 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:16.849100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:16.855030 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:16.855502 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:07:16.856724 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:16.859251 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:07:16.860888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01073768-e423-42e5-80ff-47b6b3474888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91090091c0>]}
[0m14:07:16.861656 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.16s]
[0m14:07:16.862445 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:07:16.863505 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:07:16.864074 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:07:16.864700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:07:16.865136 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:07:16.870272 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:07:16.870974 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:07:16.908454 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:16.909030 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250731140716902283"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:07:16.909524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:16.918869 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:16.926998 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:16.927484 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:07:16.928154 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:16.928626 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:16.929049 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250731140716902283'
      
      
      order by ordinal_position

  
[0m14:07:16.931626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:16.937048 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:16.937529 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:16.940393 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:16.948427 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:16.948896 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:16.951654 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:16.970093 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:07:16.970840 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:16.971292 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250731140716902283"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250731140716902283"
    )
  
[0m14:07:17.018843 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:17.021021 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:17.021484 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:17.021903 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:17.029595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:17.030552 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:07:17.032041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01073768-e423-42e5-80ff-47b6b3474888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9108ff30e0>]}
[0m14:07:17.032777 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:07:17.033520 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:07:17.034884 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:17.035290 [debug] [MainThread]: On master: BEGIN
[0m14:07:17.035708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:17.036388 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:17.036809 [debug] [MainThread]: On master: COMMIT
[0m14:07:17.037170 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:17.037554 [debug] [MainThread]: On master: COMMIT
[0m14:07:17.038073 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:17.038492 [debug] [MainThread]: On master: Close
[0m14:07:17.039097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:17.039496 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:07:17.039903 [info ] [MainThread]: 
[0m14:07:17.040383 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.97 seconds (8.97s).
[0m14:07:17.041346 [debug] [MainThread]: Command end result
[0m14:07:17.067651 [info ] [MainThread]: 
[0m14:07:17.068291 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:17.068824 [info ] [MainThread]: 
[0m14:07:17.069346 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:07:17.070430 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.020698, "process_user_time": 5.242536, "process_kernel_time": 0.311388, "process_mem_max_rss": "302420", "process_in_blocks": "1200", "process_out_blocks": "100088"}
[0m14:07:17.070997 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:17.070890 after 11.02 seconds
[0m14:07:17.071463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914bad38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9147e41b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9147946000>]}
[0m14:07:17.071895 [debug] [MainThread]: Flushing usage events
[0m14:07:19.012137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49b876120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49ae30410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49ae33380>]}


============================== 14:07:19.015431 | e5766f9e-cbfb-4693-bdd2-5ecbc25fdeb2 ==============================
[0m14:07:19.015431 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:19.016083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:07:19.124083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5766f9e-cbfb-4693-bdd2-5ecbc25fdeb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49cb26f30>]}
[0m14:07:19.142697 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18022235, "process_user_time": 1.350588, "process_kernel_time": 0.121872, "process_mem_max_rss": "100448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:07:19.143243 [debug] [MainThread]: Command `dbt clean` succeeded at 14:07:19.143139 after 0.18 seconds
[0m14:07:19.143712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49ac74740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49bcd1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49ac1dfa0>]}
[0m14:07:19.144136 [debug] [MainThread]: Flushing usage events
[0m22:06:56.997156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6bc092e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6bb769ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6bb7490a0>]}


============================== 22:06:57.018113 | 1ddf2232-d0bb-4f1c-9790-3e48597dc398 ==============================
[0m22:06:57.018113 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:57.018850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:57.175272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ddf2232-d0bb-4f1c-9790-3e48597dc398', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6bb3d4bc0>]}
[0m22:06:57.191635 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-9zn9a4ez'
[0m22:06:57.192171 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:57.260197 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:57.260857 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:57.273144 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:57.276997 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:57.409284 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:57.409905 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:57.410524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1ddf2232-d0bb-4f1c-9790-3e48597dc398', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6bb30c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6bb30c650>]}
[0m22:06:57.411021 [info ] [MainThread]: 
[0m22:06:57.411527 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:57.418299 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4723439, "process_user_time": 1.668838, "process_kernel_time": 0.15545, "process_mem_max_rss": "101304", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m22:06:57.418852 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:57.418748 after 0.47 seconds
[0m22:06:57.419319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6bb9db6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6bb40a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6bb409790>]}
[0m22:06:57.419733 [debug] [MainThread]: Flushing usage events
[0m22:06:59.200723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb421881c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4214cd9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4218bc050>]}


============================== 22:06:59.204619 | f6089c88-3157-4c9b-8e83-f31eb5b5fb2b ==============================
[0m22:06:59.204619 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:59.205338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:59.414386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6089c88-3157-4c9b-8e83-f31eb5b5fb2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb42145fb00>]}
[0m22:06:59.473492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6089c88-3157-4c9b-8e83-f31eb5b5fb2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb424c322a0>]}
[0m22:06:59.476236 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:59.509801 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:59.510603 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:59.511168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f6089c88-3157-4c9b-8e83-f31eb5b5fb2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb420e66cc0>]}
[0m22:07:00.815442 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:07:00.816148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f6089c88-3157-4c9b-8e83-f31eb5b5fb2b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb422a33fe0>]}
[0m22:07:01.065818 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:07:01.071616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6089c88-3157-4c9b-8e83-f31eb5b5fb2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb421fd1e80>]}
[0m22:07:01.179404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6089c88-3157-4c9b-8e83-f31eb5b5fb2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41c90acf0>]}
[0m22:07:01.180007 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:07:01.180516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6089c88-3157-4c9b-8e83-f31eb5b5fb2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41cb56f90>]}
[0m22:07:01.182488 [info ] [MainThread]: 
[0m22:07:01.183249 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:07:01.188173 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:07:01.223733 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:07:01.224237 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:07:01.224628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:02.754402 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m22:07:02.756406 [debug] [ThreadPool]: On list_petro: Close
[0m22:07:02.757640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:07:02.758410 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:07:02.767489 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:02.767928 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:07:02.768351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:02.769755 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:02.771177 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:02.771569 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:07:02.772136 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:02.772528 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:02.772894 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:07:02.773544 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:02.774486 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:02.774882 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:02.775278 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:02.775849 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:02.776289 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:07:02.777620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:07:02.783526 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:02.784036 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:07:02.784404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:02.785050 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:02.785439 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:02.785810 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:07:02.796045 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:02.797590 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:07:02.798859 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:07:02.799299 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:07:02.801516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6089c88-3157-4c9b-8e83-f31eb5b5fb2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb422bd5460>]}
[0m22:07:02.802057 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:02.802443 [debug] [MainThread]: On master: BEGIN
[0m22:07:02.802800 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:02.803469 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:02.803861 [debug] [MainThread]: On master: COMMIT
[0m22:07:02.804259 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:02.804623 [debug] [MainThread]: On master: COMMIT
[0m22:07:02.805159 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:02.805557 [debug] [MainThread]: On master: Close
[0m22:07:02.806131 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:07:02.806625 [info ] [MainThread]: 
[0m22:07:02.825533 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:07:02.826298 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:07:02.827046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:07:02.827517 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:07:02.855264 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:07:02.856172 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:07:02.892454 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:07:02.893321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:10.303587 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:10.304140 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:10.304850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:10.305316 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:10.305738 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:10.306501 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:10.309644 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:10.310111 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:10.310783 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:10.327811 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:10.328292 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:10.328713 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:10.330516 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:10.336333 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:10.336784 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:10.338155 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:10.340561 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:10.342154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6089c88-3157-4c9b-8e83-f31eb5b5fb2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3dfde8170>]}
[0m22:07:10.342832 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.51s]
[0m22:07:10.343593 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:10.344590 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:10.345171 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:10.345745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:10.346199 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:10.351107 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:10.351769 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:10.388184 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:10.388724 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250731220710382088"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:10.389215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:10.397440 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:10.405356 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:10.405916 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:10.406647 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:10.407131 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:10.407558 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250731220710382088'
      
      
      order by ordinal_position

  
[0m22:07:10.409831 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:10.415202 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:10.415662 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:10.417963 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:10.425659 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:10.426130 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:10.428210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:10.446468 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:10.447183 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:10.447637 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250731220710382088"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250731220710382088"
    )
  
[0m22:07:10.495675 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:10.497717 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:10.498184 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:10.498597 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:10.506272 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:10.507231 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:10.508781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6089c88-3157-4c9b-8e83-f31eb5b5fb2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3dfa9af30>]}
[0m22:07:10.509472 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:07:10.510224 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:10.511559 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:10.511992 [debug] [MainThread]: On master: BEGIN
[0m22:07:10.512386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:10.513081 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:10.513479 [debug] [MainThread]: On master: COMMIT
[0m22:07:10.513847 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:10.514239 [debug] [MainThread]: On master: COMMIT
[0m22:07:10.514776 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:10.515211 [debug] [MainThread]: On master: Close
[0m22:07:10.515825 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:10.516241 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:10.516649 [info ] [MainThread]: 
[0m22:07:10.517136 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.33 seconds (9.33s).
[0m22:07:10.518128 [debug] [MainThread]: Command end result
[0m22:07:10.545736 [info ] [MainThread]: 
[0m22:07:10.546460 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:10.546931 [info ] [MainThread]: 
[0m22:07:10.547499 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:10.548491 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.3997755, "process_user_time": 6.331936, "process_kernel_time": 0.294508, "process_mem_max_rss": "341808", "process_in_blocks": "1200", "process_out_blocks": "100136"}
[0m22:07:10.549068 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:10.548934 after 11.40 seconds
[0m22:07:10.549522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb421881c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41c866840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4212e6060>]}
[0m22:07:10.549961 [debug] [MainThread]: Flushing usage events
[0m22:07:12.491902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee82745730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee82111eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee823e0f20>]}


============================== 22:07:12.495168 | 3ff112bc-e594-4ad4-b48d-a71ba6aeadcf ==============================
[0m22:07:12.495168 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:12.495801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:07:12.606495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ff112bc-e594-4ad4-b48d-a71ba6aeadcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee832dd730>]}
[0m22:07:12.624851 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18272984, "process_user_time": 1.359131, "process_kernel_time": 0.135913, "process_mem_max_rss": "100580", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:07:12.625424 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:12.625319 after 0.18 seconds
[0m22:07:12.625849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee82253d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee824e1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee81f14080>]}
[0m22:07:12.626307 [debug] [MainThread]: Flushing usage events
[0m06:03:39.001483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52317a4f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5231c36570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5231c34e60>]}


============================== 06:03:39.017318 | 4e21c4d9-ae25-4de5-b853-dfac43df82e8 ==============================
[0m06:03:39.017318 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:39.018004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:39.303834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e21c4d9-ae25-4de5-b853-dfac43df82e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52314113a0>]}
[0m06:03:39.319591 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-w318dxem'
[0m06:03:39.320076 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:03:39.470278 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:03:39.471048 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:03:39.506078 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:03:39.510006 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:03:39.719125 [info ] [MainThread]: Installed from version 1.2.0
[0m06:03:39.719720 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:03:39.720255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4e21c4d9-ae25-4de5-b853-dfac43df82e8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52314116d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52327db7d0>]}
[0m06:03:39.720741 [info ] [MainThread]: 
[0m06:03:39.721208 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:03:39.726743 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7752481, "process_user_time": 1.578071, "process_kernel_time": 0.129923, "process_mem_max_rss": "101360", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m06:03:39.727289 [debug] [MainThread]: Command `dbt deps` succeeded at 06:03:39.727186 after 0.78 seconds
[0m06:03:39.727760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52328d94f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52316f9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5231771700>]}
[0m06:03:39.728180 [debug] [MainThread]: Flushing usage events
[0m06:03:41.548037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad581c4e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad581c6240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad581c5250>]}


============================== 06:03:41.551151 | ae2430e5-ea09-4b98-8646-fa22c88c135d ==============================
[0m06:03:41.551151 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:41.551797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:41.751898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae2430e5-ea09-4b98-8646-fa22c88c135d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad581c5250>]}
[0m06:03:41.810714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae2430e5-ea09-4b98-8646-fa22c88c135d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad588d8770>]}
[0m06:03:41.813253 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:03:41.841358 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:03:41.842084 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:03:41.842624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ae2430e5-ea09-4b98-8646-fa22c88c135d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad57569df0>]}
[0m06:03:43.137246 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:03:43.137910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ae2430e5-ea09-4b98-8646-fa22c88c135d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad57801550>]}
[0m06:03:43.374012 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:03:43.379534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae2430e5-ea09-4b98-8646-fa22c88c135d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5758cbc0>]}
[0m06:03:43.477308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae2430e5-ea09-4b98-8646-fa22c88c135d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad53362330>]}
[0m06:03:43.477815 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:03:43.478327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae2430e5-ea09-4b98-8646-fa22c88c135d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad533cc290>]}
[0m06:03:43.480128 [info ] [MainThread]: 
[0m06:03:43.480853 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:03:43.485577 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:03:43.520349 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:03:43.520840 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:03:43.521220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:44.002132 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:44.004107 [debug] [ThreadPool]: On list_petro: Close
[0m06:03:44.005302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:03:44.006025 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:03:44.015720 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:44.016280 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:03:44.016844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:44.017992 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:44.019291 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:44.019693 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:03:44.020233 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:44.020637 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:44.020996 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:03:44.021562 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:44.022473 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:44.022858 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:44.023212 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:44.023752 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:44.024141 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:03:44.025331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:03:44.031025 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:44.031455 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:03:44.031821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:44.032427 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:44.032811 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:44.033176 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:03:44.042937 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:44.044349 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:03:44.045603 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:03:44.045995 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:03:44.048086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae2430e5-ea09-4b98-8646-fa22c88c135d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad51e50e30>]}
[0m06:03:44.048613 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:44.048985 [debug] [MainThread]: On master: BEGIN
[0m06:03:44.049337 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:44.050032 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:44.050442 [debug] [MainThread]: On master: COMMIT
[0m06:03:44.050854 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:44.051259 [debug] [MainThread]: On master: COMMIT
[0m06:03:44.051797 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:44.052175 [debug] [MainThread]: On master: Close
[0m06:03:44.052730 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:03:44.053197 [info ] [MainThread]: 
[0m06:03:44.068768 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:03:44.069356 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:03:44.070038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:03:44.070488 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:03:44.097230 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:03:44.097991 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:03:44.133171 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:03:44.133924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:55.700935 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:55.701459 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:55.702088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:55.702557 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:55.702973 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:55.703670 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:55.706549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:55.706983 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:55.707913 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:55.724474 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:55.724927 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:55.725340 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:55.727134 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:55.732781 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:55.733227 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:55.734529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:55.736887 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:55.738456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae2430e5-ea09-4b98-8646-fa22c88c135d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad19291f10>]}
[0m06:03:55.739130 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.67s]
[0m06:03:55.739957 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:55.740750 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:55.741302 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:55.742073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:55.742565 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:55.747446 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:55.748087 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:55.783681 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:55.784164 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250801060355777683"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:55.784637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:55.792349 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:55.799786 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:55.800238 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:55.800858 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:55.801287 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:55.801744 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250801060355777683'
      
      
      order by ordinal_position

  
[0m06:03:55.803850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:55.808927 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:55.809473 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:55.811597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:55.819212 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:55.819699 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:55.822057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:55.840206 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:55.840947 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:55.841409 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250801060355777683"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250801060355777683"
    )
  
[0m06:03:55.888699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:55.890692 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:55.891133 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:55.891563 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:55.900132 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:55.901113 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:55.902584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae2430e5-ea09-4b98-8646-fa22c88c135d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad1915f1a0>]}
[0m06:03:55.903250 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:03:55.903997 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:55.905465 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:55.905873 [debug] [MainThread]: On master: BEGIN
[0m06:03:55.906241 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:55.906956 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:55.907347 [debug] [MainThread]: On master: COMMIT
[0m06:03:55.907769 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:55.908129 [debug] [MainThread]: On master: COMMIT
[0m06:03:55.908716 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:55.909117 [debug] [MainThread]: On master: Close
[0m06:03:55.909797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:55.910161 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:55.910587 [info ] [MainThread]: 
[0m06:03:55.911094 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.43 seconds (12.43s).
[0m06:03:55.912099 [debug] [MainThread]: Command end result
[0m06:03:55.938331 [info ] [MainThread]: 
[0m06:03:55.938955 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:55.939485 [info ] [MainThread]: 
[0m06:03:55.940005 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:55.941009 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.442383, "process_user_time": 5.131325, "process_kernel_time": 0.258469, "process_mem_max_rss": "314856", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:03:55.941578 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:55.941473 after 14.44 seconds
[0m06:03:55.942008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad575e7170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad576da960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad57b763f0>]}
[0m06:03:55.942443 [debug] [MainThread]: Flushing usage events
[0m06:03:58.476156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78efa89910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f04b8bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f04baff0>]}


============================== 06:03:58.479281 | 7704c68e-378a-4271-a426-391edbad8720 ==============================
[0m06:03:58.479281 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:58.479943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:03:58.588068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7704c68e-378a-4271-a426-391edbad8720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ef9be270>]}
[0m06:03:58.605804 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17902687, "process_user_time": 1.355592, "process_kernel_time": 0.115879, "process_mem_max_rss": "100480", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:03:58.606348 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:58.606242 after 0.18 seconds
[0m06:03:58.606806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f05f47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f0bcf440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f0bcd1f0>]}
[0m06:03:58.607215 [debug] [MainThread]: Flushing usage events
[0m14:07:14.886347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fa2a15160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fa2c7b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fa3481580>]}


============================== 14:07:14.894726 | 0281da41-df72-4b94-b9a7-eaa1d2cf6d3a ==============================
[0m14:07:14.894726 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:14.895422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:15.046382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0281da41-df72-4b94-b9a7-eaa1d2cf6d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fa2691610>]}
[0m14:07:15.060792 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-pwthf_w3'
[0m14:07:15.061243 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:07:15.162585 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:07:15.163288 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:07:15.173684 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:07:15.177623 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:07:15.232930 [info ] [MainThread]: Installed from version 1.2.0
[0m14:07:15.233479 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:07:15.234005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0281da41-df72-4b94-b9a7-eaa1d2cf6d3a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fa2583740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fa25838f0>]}
[0m14:07:15.234461 [info ] [MainThread]: 
[0m14:07:15.234952 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:07:15.240935 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40409943, "process_user_time": 1.531207, "process_kernel_time": 0.149508, "process_mem_max_rss": "101736", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m14:07:15.241490 [debug] [MainThread]: Command `dbt deps` succeeded at 14:07:15.241385 after 0.40 seconds
[0m14:07:15.241900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fa2c9c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fa2691610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fa3a55130>]}
[0m14:07:15.242462 [debug] [MainThread]: Flushing usage events
[0m14:07:16.837342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed40297c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed4ae4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed4ae5580>]}


============================== 14:07:16.840419 | d9461353-7cbf-47fb-a839-36e16d8e13b8 ==============================
[0m14:07:16.840419 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:16.841089 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:17.041200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9461353-7cbf-47fb-a839-36e16d8e13b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed1c3af30>]}
[0m14:07:17.099502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9461353-7cbf-47fb-a839-36e16d8e13b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed1ef73e0>]}
[0m14:07:17.101968 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:07:17.126003 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:07:17.126714 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:07:17.127243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd9461353-7cbf-47fb-a839-36e16d8e13b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed1d4ebd0>]}
[0m14:07:18.421392 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:07:18.421983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd9461353-7cbf-47fb-a839-36e16d8e13b8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ecdde1e80>]}
[0m14:07:18.663080 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:07:18.668562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9461353-7cbf-47fb-a839-36e16d8e13b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed2a19f70>]}
[0m14:07:18.933601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9461353-7cbf-47fb-a839-36e16d8e13b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ecdb20bc0>]}
[0m14:07:18.934409 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:07:18.935064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9461353-7cbf-47fb-a839-36e16d8e13b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ecdbe04d0>]}
[0m14:07:18.937574 [info ] [MainThread]: 
[0m14:07:18.938282 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:07:18.942924 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:07:18.980016 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:07:18.980548 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:07:18.981130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:19.783296 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:07:19.784881 [debug] [ThreadPool]: On list_petro: Close
[0m14:07:19.785967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:07:19.786746 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:07:19.795412 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:19.795831 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:07:19.796204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:19.797079 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:19.798378 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:19.798761 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:07:19.799310 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:19.799686 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:19.800047 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:07:19.800637 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:19.801554 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:19.801943 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:19.802326 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:19.802869 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:19.803281 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:07:19.804488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:07:19.810056 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:19.810563 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:07:19.810923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:19.811540 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:19.811927 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:19.812320 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:07:19.821860 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:19.823333 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:07:19.824582 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:07:19.824974 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:07:19.827312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9461353-7cbf-47fb-a839-36e16d8e13b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ecc5540e0>]}
[0m14:07:19.827798 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:19.828171 [debug] [MainThread]: On master: BEGIN
[0m14:07:19.828571 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:19.829166 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:19.829589 [debug] [MainThread]: On master: COMMIT
[0m14:07:19.829948 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:19.830320 [debug] [MainThread]: On master: COMMIT
[0m14:07:19.830830 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:19.831231 [debug] [MainThread]: On master: Close
[0m14:07:19.831763 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:07:19.832254 [info ] [MainThread]: 
[0m14:07:19.850133 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:07:19.850741 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:07:19.851342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:07:19.851782 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:07:19.878415 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:07:19.879139 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:07:19.914246 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:07:19.914962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:27.667347 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:27.667830 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:07:27.668463 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:27.668911 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:27.669355 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:07:27.670029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:27.672947 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:27.673440 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:07:27.674102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:27.691028 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:27.691513 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:27.691935 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:27.693448 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:27.699106 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:27.699577 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:07:27.700687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:27.703045 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:07:27.704605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9461353-7cbf-47fb-a839-36e16d8e13b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed3c666c0>]}
[0m14:07:27.705304 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.85s]
[0m14:07:27.706069 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:07:27.707045 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:07:27.707629 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:07:27.708223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:07:27.708672 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:07:27.713566 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:07:27.714187 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:07:27.750172 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:27.750672 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250801140727744178"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:07:27.751119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:27.758705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:27.766186 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:27.766671 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:07:27.767324 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:27.767760 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:27.768176 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250801140727744178'
      
      
      order by ordinal_position

  
[0m14:07:27.770299 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:27.775354 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:27.775810 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:27.778525 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:27.786133 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:27.786614 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:27.788645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:27.806741 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:07:27.807405 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:27.807858 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250801140727744178"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250801140727744178"
    )
  
[0m14:07:27.858030 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:27.860003 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:27.860464 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:27.860873 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:27.867761 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:27.868660 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:07:27.869997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9461353-7cbf-47fb-a839-36e16d8e13b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e8fa34a70>]}
[0m14:07:27.870678 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:07:27.871418 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:07:27.873057 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:27.873490 [debug] [MainThread]: On master: BEGIN
[0m14:07:27.873862 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:27.874493 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:27.874887 [debug] [MainThread]: On master: COMMIT
[0m14:07:27.875279 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:27.875642 [debug] [MainThread]: On master: COMMIT
[0m14:07:27.876140 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:27.876556 [debug] [MainThread]: On master: Close
[0m14:07:27.877124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:27.877538 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:07:27.877929 [info ] [MainThread]: 
[0m14:07:27.878424 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.94 seconds (8.94s).
[0m14:07:27.879379 [debug] [MainThread]: Command end result
[0m14:07:27.904870 [info ] [MainThread]: 
[0m14:07:27.905446 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:27.905917 [info ] [MainThread]: 
[0m14:07:27.906418 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:07:27.907394 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.118778, "process_user_time": 5.401057, "process_kernel_time": 0.294948, "process_mem_max_rss": "303500", "process_in_blocks": "1200", "process_out_blocks": "100096"}
[0m14:07:27.907919 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:27.907819 after 11.12 seconds
[0m14:07:27.908361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed20b3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed304aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed2369160>]}
[0m14:07:27.908775 [debug] [MainThread]: Flushing usage events
[0m14:07:29.649808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fecad5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe9f53650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fea9bc1d0>]}


============================== 14:07:29.652822 | f2772653-ae03-4380-8c3d-06068402cc18 ==============================
[0m14:07:29.652822 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:29.653468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:29.761421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2772653-ae03-4380-8c3d-06068402cc18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fea3b0fe0>]}
[0m14:07:29.778865 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17785393, "process_user_time": 1.289615, "process_kernel_time": 0.140957, "process_mem_max_rss": "100600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:07:29.779407 [debug] [MainThread]: Command `dbt clean` succeeded at 14:07:29.779301 after 0.18 seconds
[0m14:07:29.779814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fea242150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe9f53650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe9f1acf0>]}
[0m14:07:29.780244 [debug] [MainThread]: Flushing usage events
[0m22:06:48.190107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf23342c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf0d50d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf0d52870>]}


============================== 22:06:48.206685 | 316d0df3-4143-455d-91c9-36ff0211853e ==============================
[0m22:06:48.206685 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:48.207376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:48.349312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '316d0df3-4143-455d-91c9-36ff0211853e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf066c620>]}
[0m22:06:48.366172 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-e_wc00sm'
[0m22:06:48.366649 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:48.431206 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:48.431810 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:48.442345 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:48.446140 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:48.656679 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:48.657243 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:48.657759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '316d0df3-4143-455d-91c9-36ff0211853e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf13f81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf0276150>]}
[0m22:06:48.658224 [info ] [MainThread]: 
[0m22:06:48.658695 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:48.664582 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5237624, "process_user_time": 1.553409, "process_kernel_time": 0.140489, "process_mem_max_rss": "101632", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m22:06:48.665169 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:48.665061 after 0.52 seconds
[0m22:06:48.665593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf022d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf104bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf021c140>]}
[0m22:06:48.666057 [debug] [MainThread]: Flushing usage events
[0m22:06:50.501573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc4c06f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc50b6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc54596a0>]}


============================== 22:06:50.504710 | dc29b235-fa0e-4dbe-bcb3-ad874da65fd6 ==============================
[0m22:06:50.504710 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:50.505436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:50.707091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc29b235-fa0e-4dbe-bcb3-ad874da65fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc4456a80>]}
[0m22:06:50.765286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc29b235-fa0e-4dbe-bcb3-ad874da65fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc4c4a840>]}
[0m22:06:50.767920 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:50.802083 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:50.802759 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:50.803295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dc29b235-fa0e-4dbe-bcb3-ad874da65fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc0506e40>]}
[0m22:06:52.078554 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:52.079250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dc29b235-fa0e-4dbe-bcb3-ad874da65fd6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc03d8230>]}
[0m22:06:52.311608 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:52.316932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc29b235-fa0e-4dbe-bcb3-ad874da65fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc0262b40>]}
[0m22:06:52.415375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc29b235-fa0e-4dbe-bcb3-ad874da65fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc02e8e00>]}
[0m22:06:52.415900 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:52.416388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc29b235-fa0e-4dbe-bcb3-ad874da65fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc02bb290>]}
[0m22:06:52.418188 [info ] [MainThread]: 
[0m22:06:52.418853 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:52.423416 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:52.457692 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:52.458141 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:52.458524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:53.055552 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:53.057458 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:53.058530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:53.059203 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:53.067398 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:53.067832 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:53.068246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:53.069267 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:53.070615 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:53.071022 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:53.071626 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:53.072046 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:53.072435 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:53.073029 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:53.073960 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:53.074350 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:53.074713 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:53.075284 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:53.075673 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:53.077132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:53.083027 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:53.083425 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:53.083785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:53.084416 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:53.084801 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:53.085212 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:53.095467 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:53.096926 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:53.098182 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:53.098568 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:53.100776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc29b235-fa0e-4dbe-bcb3-ad874da65fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dbec626c0>]}
[0m22:06:53.101287 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:53.101660 [debug] [MainThread]: On master: BEGIN
[0m22:06:53.102030 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:53.102617 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:53.103052 [debug] [MainThread]: On master: COMMIT
[0m22:06:53.103420 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:53.103773 [debug] [MainThread]: On master: COMMIT
[0m22:06:53.104343 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:53.104723 [debug] [MainThread]: On master: Close
[0m22:06:53.105256 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:53.105734 [info ] [MainThread]: 
[0m22:06:53.120998 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:53.121571 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:53.122203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:53.122636 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:53.149112 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:53.149835 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:53.184902 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:53.185608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:04.599941 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:04.600427 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:04.601079 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:04.601529 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:04.601984 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:04.602714 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:04.605595 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:04.606054 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:04.606718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:04.623245 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:04.623704 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:04.624148 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:04.626117 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:04.631720 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:04.632214 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:04.634230 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:04.636550 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:04.638076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc29b235-fa0e-4dbe-bcb3-ad874da65fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d9025c950>]}
[0m22:07:04.638744 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.52s]
[0m22:07:04.639512 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:04.640478 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:04.641047 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:04.641631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:04.642088 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:04.646857 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:04.647493 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:04.683050 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:04.683533 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250801220704677011"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:04.684013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:04.691780 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:04.699210 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:04.699658 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:04.700265 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:04.700690 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:04.701129 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250801220704677011'
      
      
      order by ordinal_position

  
[0m22:07:04.703272 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:04.708313 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:04.708765 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:04.711425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:04.718983 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:04.719432 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:04.721988 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:04.739978 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:04.740647 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:04.741114 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250801220704677011"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250801220704677011"
    )
  
[0m22:07:04.791961 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:04.793958 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:04.794399 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:04.794806 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:04.802099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:04.802998 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:04.804409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc29b235-fa0e-4dbe-bcb3-ad874da65fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d85aa90a0>]}
[0m22:07:04.805104 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:07:04.805842 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:04.807213 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:04.807616 [debug] [MainThread]: On master: BEGIN
[0m22:07:04.808027 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:04.808682 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:04.809110 [debug] [MainThread]: On master: COMMIT
[0m22:07:04.809478 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:04.809832 [debug] [MainThread]: On master: COMMIT
[0m22:07:04.810396 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:04.810782 [debug] [MainThread]: On master: Close
[0m22:07:04.811433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:04.811802 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:04.812231 [info ] [MainThread]: 
[0m22:07:04.812710 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.39 seconds (12.39s).
[0m22:07:04.813704 [debug] [MainThread]: Command end result
[0m22:07:04.839282 [info ] [MainThread]: 
[0m22:07:04.839893 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:04.840399 [info ] [MainThread]: 
[0m22:07:04.840956 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:04.841951 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.389234, "process_user_time": 5.190641, "process_kernel_time": 0.297265, "process_mem_max_rss": "307928", "process_in_blocks": "1200", "process_out_blocks": "100136"}
[0m22:07:04.842483 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:04.842382 after 14.39 seconds
[0m22:07:04.842928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc4c07710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc05bafc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d90535370>]}
[0m22:07:04.843352 [debug] [MainThread]: Flushing usage events
[0m22:07:06.879482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7716a984a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771615b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7715d60ad0>]}


============================== 22:07:06.882577 | 15f486ff-0a83-4704-a8c8-1e4da39baee5 ==============================
[0m22:07:06.882577 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:06.883221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:07:06.991017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15f486ff-0a83-4704-a8c8-1e4da39baee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7716ed1160>]}
[0m22:07:07.008902 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17820835, "process_user_time": 1.320291, "process_kernel_time": 0.110024, "process_mem_max_rss": "100744", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:07:07.009430 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:07.009328 after 0.18 seconds
[0m22:07:07.009861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77188f0bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77160a97c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7716ed1160>]}
[0m22:07:07.010303 [debug] [MainThread]: Flushing usage events
[0m06:02:21.172149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd4d043b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd5766630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd57658e0>]}


============================== 06:02:21.189109 | 9c4bec57-96c6-45d9-b7d4-737001c32e3b ==============================
[0m06:02:21.189109 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:21.189773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:21.324658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c4bec57-96c6-45d9-b7d4-737001c32e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd5910c20>]}
[0m06:02:21.338956 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-45rzwr9a'
[0m06:02:21.339390 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:21.450393 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:21.451005 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:21.500028 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:21.503739 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:21.693368 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:21.693905 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:21.694456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9c4bec57-96c6-45d9-b7d4-737001c32e3b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd46ac2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd468ef30>]}
[0m06:02:21.694904 [info ] [MainThread]: 
[0m06:02:21.695402 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:21.701790 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.57865006, "process_user_time": 1.547682, "process_kernel_time": 0.127808, "process_mem_max_rss": "101524", "process_in_blocks": "8480", "process_out_blocks": "5168"}
[0m06:02:21.702350 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:21.702250 after 0.58 seconds
[0m06:02:21.702755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd8f638f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd47ceea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd4dd9700>]}
[0m06:02:21.703183 [debug] [MainThread]: Flushing usage events
[0m06:02:23.356774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb535ec6e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53547b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb535479cd0>]}


============================== 06:02:23.359795 | 2a1f3e51-e11d-463d-9662-31c7182c2ca1 ==============================
[0m06:02:23.359795 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:23.360490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:23.560557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a1f3e51-e11d-463d-9662-31c7182c2ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb535251a90>]}
[0m06:02:23.619202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a1f3e51-e11d-463d-9662-31c7182c2ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5352ddee0>]}
[0m06:02:23.621656 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:23.652434 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:23.653140 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:23.653655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2a1f3e51-e11d-463d-9662-31c7182c2ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5353f7080>]}
[0m06:02:24.931690 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:24.932285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2a1f3e51-e11d-463d-9662-31c7182c2ca1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb531048200>]}
[0m06:02:25.154781 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:25.160051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a1f3e51-e11d-463d-9662-31c7182c2ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5310afec0>]}
[0m06:02:25.259623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a1f3e51-e11d-463d-9662-31c7182c2ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb531016db0>]}
[0m06:02:25.260127 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:25.260589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a1f3e51-e11d-463d-9662-31c7182c2ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53104a870>]}
[0m06:02:25.262378 [info ] [MainThread]: 
[0m06:02:25.263061 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:25.267653 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:25.301610 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:25.302057 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:25.302443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:25.765504 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.767167 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:25.768180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:25.768723 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:25.776227 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:25.776644 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:25.777046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:25.778086 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.779409 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:25.779796 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:25.780382 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.780761 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:25.781156 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:25.781719 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.782639 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:25.783065 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:25.783429 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:25.783966 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.784357 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:25.785586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:25.791179 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:25.791662 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:25.792062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:25.792668 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.793084 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:25.793464 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:25.803037 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.804473 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:25.805697 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:25.806114 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:25.808437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a1f3e51-e11d-463d-9662-31c7182c2ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5311e5ca0>]}
[0m06:02:25.808950 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.809333 [debug] [MainThread]: On master: BEGIN
[0m06:02:25.809686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:25.810301 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.810688 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.811082 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.811439 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.812017 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.812407 [debug] [MainThread]: On master: Close
[0m06:02:25.812939 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:25.813394 [info ] [MainThread]: 
[0m06:02:25.828684 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:25.829276 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:25.829822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:25.830298 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:25.856893 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:25.857627 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:25.892771 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:25.893505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:34.462190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.462677 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:34.463368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.463800 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.464249 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:34.464967 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.467792 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.468252 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:34.468931 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.485447 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:34.485924 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.486348 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:34.487903 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.493532 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.494009 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:34.495118 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.497429 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:34.498980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a1f3e51-e11d-463d-9662-31c7182c2ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f2e62810>]}
[0m06:02:34.499650 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.67s]
[0m06:02:34.500517 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:34.501641 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:34.502491 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:34.503344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:34.504034 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:34.509733 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:34.510423 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:34.548815 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.549392 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250802060234542295"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:34.549889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:34.558222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.566259 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.566881 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:34.567520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.567986 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.568417 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250802060234542295'
      
      
      order by ordinal_position

  
[0m06:02:34.571304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.576440 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.576934 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:34.579578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.587153 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.587611 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:34.590259 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.612133 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:34.612789 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.613276 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250802060234542295"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250802060234542295"
    )
  
[0m06:02:34.663669 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.665652 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:34.666115 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.666527 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:34.896729 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.897648 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:34.899013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a1f3e51-e11d-463d-9662-31c7182c2ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f3193770>]}
[0m06:02:34.899670 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.40s]
[0m06:02:34.900475 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:34.901945 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:34.902350 [debug] [MainThread]: On master: BEGIN
[0m06:02:34.902715 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:34.903403 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:34.903790 [debug] [MainThread]: On master: COMMIT
[0m06:02:34.904195 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:34.904555 [debug] [MainThread]: On master: COMMIT
[0m06:02:34.905104 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:34.905489 [debug] [MainThread]: On master: Close
[0m06:02:34.906118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:34.906490 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:34.906909 [info ] [MainThread]: 
[0m06:02:34.907419 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.64 seconds (9.64s).
[0m06:02:34.908419 [debug] [MainThread]: Command end result
[0m06:02:34.933876 [info ] [MainThread]: 
[0m06:02:34.934472 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:34.935001 [info ] [MainThread]: 
[0m06:02:34.935514 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:34.936482 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.628842, "process_user_time": 5.256034, "process_kernel_time": 0.266153, "process_mem_max_rss": "336736", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m06:02:34.937052 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:34.936945 after 11.63 seconds
[0m06:02:34.937485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5357e0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f35f0230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53104ad80>]}
[0m06:02:34.937926 [debug] [MainThread]: Flushing usage events
[0m06:02:36.780529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56e0869d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56dfd7db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56dfd7db80>]}


============================== 06:02:36.783536 | fdd9fc12-1d34-4908-9913-7efb721cfa27 ==============================
[0m06:02:36.783536 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:36.784152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:36.890572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdd9fc12-1d34-4908-9913-7efb721cfa27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56dfdb4f80>]}
[0m06:02:36.907778 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17578563, "process_user_time": 1.304948, "process_kernel_time": 0.109995, "process_mem_max_rss": "100808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:36.908298 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:36.908198 after 0.18 seconds
[0m06:02:36.908699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56dfdb4f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56e01711f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56e0172c00>]}
[0m06:02:36.909129 [debug] [MainThread]: Flushing usage events
[0m14:05:27.175180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93eb404a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93d37ba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93c9e3740>]}


============================== 14:05:27.191791 | 247c678f-ff37-4cd0-b9be-190bc53af094 ==============================
[0m14:05:27.191791 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:27.192491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:27.336690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '247c678f-ff37-4cd0-b9be-190bc53af094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93e73db20>]}
[0m14:05:27.351340 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hh__j_72'
[0m14:05:27.351783 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:27.464590 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:27.465218 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:27.475539 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:27.479320 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:27.538833 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:27.539398 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:27.539934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '247c678f-ff37-4cd0-b9be-190bc53af094', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93c884290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93ca015b0>]}
[0m14:05:27.540391 [info ] [MainThread]: 
[0m14:05:27.540875 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:27.546685 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42113718, "process_user_time": 1.573743, "process_kernel_time": 0.136064, "process_mem_max_rss": "101848", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m14:05:27.547249 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:27.547144 after 0.42 seconds
[0m14:05:27.547675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93d855a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93c79c260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93c79c440>]}
[0m14:05:27.548098 [debug] [MainThread]: Flushing usage events
[0m14:05:29.150546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c09e6e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3be91a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bea486e0>]}


============================== 14:05:29.153581 | 4731c44b-e2ff-4771-bfd1-0879aa1a676f ==============================
[0m14:05:29.153581 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:29.154207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:29.355241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4731c44b-e2ff-4771-bfd1-0879aa1a676f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3be4899a0>]}
[0m14:05:29.413436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4731c44b-e2ff-4771-bfd1-0879aa1a676f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3be426840>]}
[0m14:05:29.415964 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:05:29.444532 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:29.445229 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:29.445733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4731c44b-e2ff-4771-bfd1-0879aa1a676f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3be427800>]}
[0m14:05:30.729427 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:30.730060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4731c44b-e2ff-4771-bfd1-0879aa1a676f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ba0789b0>]}
[0m14:05:30.957989 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:30.963441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4731c44b-e2ff-4771-bfd1-0879aa1a676f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c0207c50>]}
[0m14:05:31.063534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4731c44b-e2ff-4771-bfd1-0879aa1a676f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ba107350>]}
[0m14:05:31.064039 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:05:31.064563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4731c44b-e2ff-4771-bfd1-0879aa1a676f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ba06e420>]}
[0m14:05:31.066419 [info ] [MainThread]: 
[0m14:05:31.067141 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:31.071832 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:31.106573 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:31.107008 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:31.107420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:31.435617 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.437282 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:31.438321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:31.438931 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:31.446552 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:31.446968 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:31.447368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:31.448325 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.449673 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:31.450059 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:31.450693 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.451066 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:31.451452 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:31.452051 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.452999 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:31.453402 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:31.453758 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:31.454272 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.454664 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:31.455899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:31.461725 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:31.462139 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:31.462518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:31.463131 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.463515 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:31.463887 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:31.473261 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.474694 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:31.475936 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:31.476351 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:31.478457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4731c44b-e2ff-4771-bfd1-0879aa1a676f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c03a5340>]}
[0m14:05:31.478951 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:31.479370 [debug] [MainThread]: On master: BEGIN
[0m14:05:31.479725 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:31.480310 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:31.480696 [debug] [MainThread]: On master: COMMIT
[0m14:05:31.481056 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:31.481443 [debug] [MainThread]: On master: COMMIT
[0m14:05:31.481958 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:31.482370 [debug] [MainThread]: On master: Close
[0m14:05:31.482881 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:31.483402 [info ] [MainThread]: 
[0m14:05:31.499547 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:31.500152 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:31.500777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:31.501226 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:31.527898 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:31.528651 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:31.563931 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:31.564665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:39.190375 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.190854 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:39.191498 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.191934 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.192379 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:39.193108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.195999 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.196461 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:39.197179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.213893 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:39.214369 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.214783 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:39.217782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.223558 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.224008 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:05:39.226780 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.229124 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:39.230639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4731c44b-e2ff-4771-bfd1-0879aa1a676f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37bf87200>]}
[0m14:05:39.231333 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.73s]
[0m14:05:39.232174 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:39.233070 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:39.233732 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:39.234369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:39.234799 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:39.239588 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:39.240220 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:39.276574 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.277047 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250802140539270523"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:39.277521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:39.285050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.292446 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.292889 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:39.293510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.293939 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.294378 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250802140539270523'
      
      
      order by ordinal_position

  
[0m14:05:39.296383 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.301406 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.301854 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:39.303968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.311490 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.311941 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:39.314292 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.332544 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:39.333206 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.333652 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250802140539270523"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250802140539270523"
    )
  
[0m14:05:39.380907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.382894 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:39.383363 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.383774 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:39.391587 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.392477 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:39.393931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4731c44b-e2ff-4771-bfd1-0879aa1a676f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3802399a0>]}
[0m14:05:39.394615 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:05:39.395426 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:39.396791 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.397221 [debug] [MainThread]: On master: BEGIN
[0m14:05:39.397586 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:39.398220 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.398608 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.398974 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.399373 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.399889 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.400312 [debug] [MainThread]: On master: Close
[0m14:05:39.400933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:39.401344 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:39.401737 [info ] [MainThread]: 
[0m14:05:39.402249 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.33 seconds (8.33s).
[0m14:05:39.403240 [debug] [MainThread]: Command end result
[0m14:05:39.429008 [info ] [MainThread]: 
[0m14:05:39.429629 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:39.430166 [info ] [MainThread]: 
[0m14:05:39.430674 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:39.431649 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.3299675, "process_user_time": 4.912791, "process_kernel_time": 0.279272, "process_mem_max_rss": "340776", "process_in_blocks": "1200", "process_out_blocks": "100096"}
[0m14:05:39.432205 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:39.432099 after 10.33 seconds
[0m14:05:39.432631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3be6cd5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ba107ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bea4abd0>]}
[0m14:05:39.433046 [debug] [MainThread]: Flushing usage events
[0m14:05:41.210043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56ded64c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56ddffa180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56e0aed250>]}


============================== 14:05:41.213089 | 94299461-e43c-47fe-abed-d3874ccf8f29 ==============================
[0m14:05:41.213089 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:41.213724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:41.322124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94299461-e43c-47fe-abed-d3874ccf8f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56de36fd10>]}
[0m14:05:41.339755 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17886703, "process_user_time": 1.325079, "process_kernel_time": 0.115919, "process_mem_max_rss": "100904", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:41.340324 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:41.340214 after 0.18 seconds
[0m14:05:41.340740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56de2425a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56ddd83080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56df0d1010>]}
[0m14:05:41.341171 [debug] [MainThread]: Flushing usage events
[0m22:06:16.262241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faef3e11070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faef40821e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faef6b686e0>]}


============================== 22:06:16.282153 | 8b3ba9a9-da3f-4ec5-8b9f-18893fffb6c8 ==============================
[0m22:06:16.282153 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:16.282837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:16.429927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b3ba9a9-da3f-4ec5-8b9f-18893fffb6c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faef3bf8920>]}
[0m22:06:16.445389 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6wl2mbfj'
[0m22:06:16.445875 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:16.565674 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:16.566428 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:16.621181 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:16.625208 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:16.760354 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:16.760938 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:16.761534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8b3ba9a9-da3f-4ec5-8b9f-18893fffb6c8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faef4ddfda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faef4ddf3e0>]}
[0m22:06:16.762024 [info ] [MainThread]: 
[0m22:06:16.762537 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:16.770437 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.55763745, "process_user_time": 1.597493, "process_kernel_time": 0.150669, "process_mem_max_rss": "101260", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m22:06:16.770971 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:16.770870 after 0.56 seconds
[0m22:06:16.771404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faef45ab410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faef4dfcb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faef402b0e0>]}
[0m22:06:16.771807 [debug] [MainThread]: Flushing usage events
[0m22:06:18.324462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496852d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4966eb41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4966eb6060>]}


============================== 22:06:18.327706 | dfabd9c0-f5cb-457a-bcbe-69af28ca0498 ==============================
[0m22:06:18.327706 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:18.328378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:18.532254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfabd9c0-f5cb-457a-bcbe-69af28ca0498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49671169c0>]}
[0m22:06:18.591447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfabd9c0-f5cb-457a-bcbe-69af28ca0498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49662d5e20>]}
[0m22:06:18.594056 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:18.639957 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:18.640715 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:18.641246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dfabd9c0-f5cb-457a-bcbe-69af28ca0498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4962387f50>]}
[0m22:06:19.938620 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:19.939269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dfabd9c0-f5cb-457a-bcbe-69af28ca0498', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4966281b80>]}
[0m22:06:20.178632 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:20.184234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfabd9c0-f5cb-457a-bcbe-69af28ca0498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49670eeff0>]}
[0m22:06:20.288041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfabd9c0-f5cb-457a-bcbe-69af28ca0498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496201fbf0>]}
[0m22:06:20.288633 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:20.289142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfabd9c0-f5cb-457a-bcbe-69af28ca0498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496203dee0>]}
[0m22:06:20.291017 [info ] [MainThread]: 
[0m22:06:20.291751 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:20.296484 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:20.331394 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:20.331853 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:20.332254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:20.842987 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:20.844710 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:20.845645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:20.846285 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:20.854160 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:20.854663 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:20.855066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:20.856279 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:20.857767 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:20.858245 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:20.858876 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:20.859301 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:20.859716 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:20.860323 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:20.861351 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:20.861907 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:20.862366 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:20.862895 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:20.863383 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:20.864724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:20.870902 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:20.871327 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:20.871727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:20.872441 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:20.872847 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:20.873286 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:20.883774 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:20.885365 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:20.886667 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:20.887083 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:20.889591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfabd9c0-f5cb-457a-bcbe-69af28ca0498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496678c800>]}
[0m22:06:20.890212 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:20.890642 [debug] [MainThread]: On master: BEGIN
[0m22:06:20.891047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:20.891788 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:20.892224 [debug] [MainThread]: On master: COMMIT
[0m22:06:20.892605 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:20.892966 [debug] [MainThread]: On master: COMMIT
[0m22:06:20.893513 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:20.893899 [debug] [MainThread]: On master: Close
[0m22:06:20.894448 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:20.894942 [info ] [MainThread]: 
[0m22:06:20.929517 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:20.930182 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:20.930896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:20.931353 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:20.958656 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:20.959530 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:20.995223 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:20.996130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:30.114829 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.115379 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:30.116072 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.116540 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.116960 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:30.117736 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.120801 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.121259 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:30.121934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.138647 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:30.139144 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.139592 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:30.141559 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.147417 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.147866 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:30.149226 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.151696 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:30.153283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfabd9c0-f5cb-457a-bcbe-69af28ca0498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496816a750>]}
[0m22:06:30.153972 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.22s]
[0m22:06:30.154815 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:30.155744 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:30.156356 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:30.157068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:30.157541 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:30.162666 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:30.163351 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:30.199748 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.200301 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250802220630193704"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:30.200751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:30.209076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.216969 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.217447 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:30.218079 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.218534 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.218947 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250802220630193704'
      
      
      order by ordinal_position

  
[0m22:06:30.221156 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.226373 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.226847 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:30.229175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.236835 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.237310 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:30.239337 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.257586 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:30.258338 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.258789 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250802220630193704"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250802220630193704"
    )
  
[0m22:06:30.310136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.312181 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:30.312671 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.313083 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:30.321269 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.322162 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:30.323629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfabd9c0-f5cb-457a-bcbe-69af28ca0498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4923e755b0>]}
[0m22:06:30.324330 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:06:30.325048 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:30.326472 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:30.326895 [debug] [MainThread]: On master: BEGIN
[0m22:06:30.327304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:30.327939 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:30.328366 [debug] [MainThread]: On master: COMMIT
[0m22:06:30.328742 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:30.329102 [debug] [MainThread]: On master: COMMIT
[0m22:06:30.329667 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:30.330052 [debug] [MainThread]: On master: Close
[0m22:06:30.330718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:30.331084 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:30.331521 [info ] [MainThread]: 
[0m22:06:30.332027 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.04 seconds (10.04s).
[0m22:06:30.333018 [debug] [MainThread]: Command end result
[0m22:06:30.359034 [info ] [MainThread]: 
[0m22:06:30.359658 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:30.360165 [info ] [MainThread]: 
[0m22:06:30.360706 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:30.361681 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.086279, "process_user_time": 5.200837, "process_kernel_time": 0.293555, "process_mem_max_rss": "311328", "process_in_blocks": "1200", "process_out_blocks": "100136"}
[0m22:06:30.362266 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:30.362123 after 12.09 seconds
[0m22:06:30.362715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4966471a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4928731e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49293c7a40>]}
[0m22:06:30.363140 [debug] [MainThread]: Flushing usage events
[0m22:06:32.293171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb483f1f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb484449100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb483f1ddf0>]}


============================== 22:06:32.296288 | 42260874-2ed8-4f4c-a0b3-14b545d1b053 ==============================
[0m22:06:32.296288 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:32.296916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:32.403281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42260874-2ed8-4f4c-a0b3-14b545d1b053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb483a11970>]}
[0m22:06:32.420785 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17649245, "process_user_time": 1.330273, "process_kernel_time": 0.107941, "process_mem_max_rss": "100640", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:32.421334 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:32.421233 after 0.18 seconds
[0m22:06:32.421750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb483e32360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb483a11970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb486671790>]}
[0m22:06:32.422170 [debug] [MainThread]: Flushing usage events
[0m06:02:32.432639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcabe1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcccb53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bca2a5100>]}


============================== 06:02:32.447740 | ea224150-f88e-4aee-a0dd-0bd6a607c47b ==============================
[0m06:02:32.447740 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:32.448414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:32.584104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea224150-f88e-4aee-a0dd-0bd6a607c47b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc9f95730>]}
[0m06:02:32.598990 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-h496h688'
[0m06:02:32.599453 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:32.819849 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:32.820558 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:32.843016 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:32.846811 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:32.980388 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:32.980925 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:32.981479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ea224150-f88e-4aee-a0dd-0bd6a607c47b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc9e44950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc9e87ad0>]}
[0m06:02:32.981934 [info ] [MainThread]: 
[0m06:02:32.982426 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:32.987622 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6049957, "process_user_time": 1.574617, "process_kernel_time": 0.136053, "process_mem_max_rss": "101544", "process_in_blocks": "8480", "process_out_blocks": "5168"}
[0m06:02:32.988162 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:32.988060 after 0.61 seconds
[0m06:02:32.988630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcaf55fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bca0e7a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bca0e7500>]}
[0m06:02:32.989055 [debug] [MainThread]: Flushing usage events
[0m06:02:34.571608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ec6547a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ec5d1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ec5d1ee0>]}


============================== 06:02:34.574723 | a87ac8fe-747d-474a-8db1-dcd3bc9129b4 ==============================
[0m06:02:34.574723 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:34.575350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:34.780076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a87ac8fe-747d-474a-8db1-dcd3bc9129b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ec4d2b10>]}
[0m06:02:34.838934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a87ac8fe-747d-474a-8db1-dcd3bc9129b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97edff8800>]}
[0m06:02:34.841460 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:34.868309 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:34.869031 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:34.869553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a87ac8fe-747d-474a-8db1-dcd3bc9129b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ec4f19a0>]}
[0m06:02:36.157837 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:36.158486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a87ac8fe-747d-474a-8db1-dcd3bc9129b4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97e81ef500>]}
[0m06:02:36.385907 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:36.391412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a87ac8fe-747d-474a-8db1-dcd3bc9129b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ec58d610>]}
[0m06:02:36.486589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a87ac8fe-747d-474a-8db1-dcd3bc9129b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97e81ed160>]}
[0m06:02:36.487079 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:36.487585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a87ac8fe-747d-474a-8db1-dcd3bc9129b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ec34ae40>]}
[0m06:02:36.489387 [info ] [MainThread]: 
[0m06:02:36.490070 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:36.494707 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:36.529337 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:36.529787 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:36.530163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:36.857609 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.859283 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:36.860384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:36.861095 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:36.870316 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.870756 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:36.871128 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:36.872057 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.873386 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.873800 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:36.874329 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.874733 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.875095 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:36.875667 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.876583 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:36.876966 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.877328 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:36.877929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.878331 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:36.879611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:36.885365 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:36.885865 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:36.886222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:36.886823 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.887207 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:36.887623 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:36.897560 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.899004 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:36.900240 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:36.900665 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:36.902822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a87ac8fe-747d-474a-8db1-dcd3bc9129b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97e6b583b0>]}
[0m06:02:36.903327 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:36.903738 [debug] [MainThread]: On master: BEGIN
[0m06:02:36.904093 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:36.904709 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:36.905108 [debug] [MainThread]: On master: COMMIT
[0m06:02:36.905512 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:36.905878 [debug] [MainThread]: On master: COMMIT
[0m06:02:36.906389 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:36.906792 [debug] [MainThread]: On master: Close
[0m06:02:36.907313 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:36.907839 [info ] [MainThread]: 
[0m06:02:36.922499 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:36.923073 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:36.923655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:36.924085 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:36.950582 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:36.951316 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:36.986837 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:36.987590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:44.569263 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:44.569795 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:44.570474 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:44.570907 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:44.571318 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:44.572018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:44.574967 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:44.575436 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:44.576092 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:44.592851 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:44.593313 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:44.593757 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:44.595978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:44.601802 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:44.602252 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:44.603556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:44.605976 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:44.607531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a87ac8fe-747d-474a-8db1-dcd3bc9129b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ee2463f0>]}
[0m06:02:44.608216 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.68s]
[0m06:02:44.609058 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:44.609866 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:44.610537 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:44.611183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:44.611655 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:44.616609 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:44.617368 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:44.655933 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:44.656478 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250803060244648559"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:44.656936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:44.665758 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:44.673751 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:44.674212 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:44.674914 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:44.675344 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:44.675851 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250803060244648559'
      
      
      order by ordinal_position

  
[0m06:02:44.678027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:44.683305 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:44.683785 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:44.686772 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:44.694589 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:44.695056 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:44.697733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:44.716044 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:44.716788 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:44.717242 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250803060244648559"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250803060244648559"
    )
  
[0m06:02:44.764102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:44.766105 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:44.766566 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:44.766987 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:44.775105 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:44.776076 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:44.777529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a87ac8fe-747d-474a-8db1-dcd3bc9129b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97aded2a20>]}
[0m06:02:44.778194 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:02:44.779025 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:44.780373 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:44.780816 [debug] [MainThread]: On master: BEGIN
[0m06:02:44.781175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:44.781877 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:44.782271 [debug] [MainThread]: On master: COMMIT
[0m06:02:44.782678 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:44.783038 [debug] [MainThread]: On master: COMMIT
[0m06:02:44.783606 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:44.784003 [debug] [MainThread]: On master: Close
[0m06:02:44.784645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:44.785017 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:44.785435 [info ] [MainThread]: 
[0m06:02:44.785951 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.30 seconds (8.30s).
[0m06:02:44.786951 [debug] [MainThread]: Command end result
[0m06:02:44.812766 [info ] [MainThread]: 
[0m06:02:44.813425 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:44.813940 [info ] [MainThread]: 
[0m06:02:44.814478 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:44.815519 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.29323, "process_user_time": 4.985477, "process_kernel_time": 0.264662, "process_mem_max_rss": "344000", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:44.816064 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:44.815960 after 10.29 seconds
[0m06:02:44.816527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ec48a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97dc53a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ec94e990>]}
[0m06:02:44.816960 [debug] [MainThread]: Flushing usage events
[0m06:02:47.105698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3baa9e1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3baa9e1c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3baa9e1d60>]}


============================== 06:02:47.108822 | 82037613-2a5f-4435-ac2e-3ed5380cc2a9 ==============================
[0m06:02:47.108822 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:47.109524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:47.217840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82037613-2a5f-4435-ac2e-3ed5380cc2a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bab329bb0>]}
[0m06:02:47.236188 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18050174, "process_user_time": 1.33873, "process_kernel_time": 0.110977, "process_mem_max_rss": "100448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:47.236792 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:47.236687 after 0.18 seconds
[0m06:02:47.237221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3baac870b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3baa9e0140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3baa9e1c10>]}
[0m06:02:47.237668 [debug] [MainThread]: Flushing usage events
[0m14:05:23.501031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959cfea420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959a5e5100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95993fde80>]}


============================== 14:05:23.525700 | 14f8b12e-50b3-4571-8aa5-45ba7e765359 ==============================
[0m14:05:23.525700 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.526465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:23.742765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14f8b12e-50b3-4571-8aa5-45ba7e765359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95992313a0>]}
[0m14:05:23.759336 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-n0gzgnud'
[0m14:05:23.759885 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:23.890152 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:23.890959 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:23.903605 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:23.907715 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:24.258606 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:24.259200 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:24.259776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '14f8b12e-50b3-4571-8aa5-45ba7e765359', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9599255970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959a474320>]}
[0m14:05:24.260236 [info ] [MainThread]: 
[0m14:05:24.260747 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:24.266620 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.82042104, "process_user_time": 1.728549, "process_kernel_time": 0.142457, "process_mem_max_rss": "101644", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m14:05:24.267226 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:24.267111 after 0.82 seconds
[0m14:05:24.267700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95997d5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95993c3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95995a9bb0>]}
[0m14:05:24.268129 [debug] [MainThread]: Flushing usage events
[0m14:05:26.476418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa527e66cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa527a4bce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5288595e0>]}


============================== 14:05:26.479690 | b28af2ab-b959-406b-9836-e2f90b4b156c ==============================
[0m14:05:26.479690 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:26.480434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:26.698373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b28af2ab-b959-406b-9836-e2f90b4b156c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa523909a30>]}
[0m14:05:26.762596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b28af2ab-b959-406b-9836-e2f90b4b156c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa528bc9340>]}
[0m14:05:26.765556 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:05:26.795139 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:26.795990 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:26.796615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b28af2ab-b959-406b-9836-e2f90b4b156c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5299cc440>]}
[0m14:05:28.195959 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:28.196679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b28af2ab-b959-406b-9836-e2f90b4b156c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5238bfaa0>]}
[0m14:05:28.457657 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:28.463821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b28af2ab-b959-406b-9836-e2f90b4b156c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa527867170>]}
[0m14:05:28.580538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b28af2ab-b959-406b-9836-e2f90b4b156c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa52364eff0>]}
[0m14:05:28.581125 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:05:28.581657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b28af2ab-b959-406b-9836-e2f90b4b156c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5236ba390>]}
[0m14:05:28.583562 [info ] [MainThread]: 
[0m14:05:28.584249 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:28.589222 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:28.625492 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:28.626004 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:28.626444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:29.047330 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:29.049182 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:29.050209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:29.050786 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:29.058919 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:29.059457 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:29.059862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:29.061187 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:29.062706 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:29.063114 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:29.063738 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:29.064138 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:29.064565 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:29.065178 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:29.066148 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:29.066564 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:29.066936 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:29.067509 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:29.067918 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:29.069432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:29.075848 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:29.076342 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:29.076718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:29.077538 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:29.077932 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:29.078336 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:29.088599 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:29.090336 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:29.091672 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:29.092077 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:29.094456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b28af2ab-b959-406b-9836-e2f90b4b156c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa527af36e0>]}
[0m14:05:29.094987 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:29.095409 [debug] [MainThread]: On master: BEGIN
[0m14:05:29.095778 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:29.096547 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:29.096949 [debug] [MainThread]: On master: COMMIT
[0m14:05:29.097350 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:29.097718 [debug] [MainThread]: On master: COMMIT
[0m14:05:29.098322 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:29.098735 [debug] [MainThread]: On master: Close
[0m14:05:29.099329 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:29.099811 [info ] [MainThread]: 
[0m14:05:29.129896 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:29.130585 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:29.131219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:29.131684 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:29.159881 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:29.160809 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:29.197311 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:29.198252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:39.040176 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.040791 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:39.041690 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.042138 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.042595 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:39.043430 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.046842 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.047317 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:39.048081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.065692 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:39.066252 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.066703 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:39.068680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.075052 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.075586 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:05:39.076955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.079566 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:39.081193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b28af2ab-b959-406b-9836-e2f90b4b156c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e9573140>]}
[0m14:05:39.081953 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.95s]
[0m14:05:39.082729 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:39.083752 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:39.084326 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:39.084911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:39.085361 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:39.090803 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:39.091557 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:39.129473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.130090 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250803140539122990"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:39.130602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:39.139109 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.147630 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.148161 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:39.148978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.149443 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.149865 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250803140539122990'
      
      
      order by ordinal_position

  
[0m14:05:39.152631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.158434 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.158944 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:39.161530 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.169949 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.170498 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:39.173226 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.192265 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:39.193146 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.193666 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250803140539122990"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250803140539122990"
    )
  
[0m14:05:39.244671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.246752 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:39.247230 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.247681 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:39.255343 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.256451 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:39.258074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b28af2ab-b959-406b-9836-e2f90b4b156c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5236f17c0>]}
[0m14:05:39.258819 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:05:39.259622 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:39.261089 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.261545 [debug] [MainThread]: On master: BEGIN
[0m14:05:39.261934 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:39.262757 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.263162 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.263586 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.263949 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.264601 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.264994 [debug] [MainThread]: On master: Close
[0m14:05:39.265706 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:39.266076 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:39.266550 [info ] [MainThread]: 
[0m14:05:39.267050 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.68 seconds (10.68s).
[0m14:05:39.268017 [debug] [MainThread]: Command end result
[0m14:05:39.295655 [info ] [MainThread]: 
[0m14:05:39.296376 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:39.296860 [info ] [MainThread]: 
[0m14:05:39.297358 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:39.298409 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.874687, "process_user_time": 5.042138, "process_kernel_time": 0.284007, "process_mem_max_rss": "300248", "process_in_blocks": "1200", "process_out_blocks": "100096"}
[0m14:05:39.298976 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:39.298869 after 12.88 seconds
[0m14:05:39.299468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5296eae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa528d0ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e9764cb0>]}
[0m14:05:39.299922 [debug] [MainThread]: Flushing usage events
[0m14:05:41.693464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd52e5e4b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd52ebb06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd52e9bac60>]}


============================== 14:05:41.696860 | dfd8b63c-0279-49ce-885c-30b6b9519b24 ==============================
[0m14:05:41.696860 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:41.697548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:41.815195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfd8b63c-0279-49ce-885c-30b6b9519b24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd52e5032f0>]}
[0m14:05:41.834885 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.194153, "process_user_time": 1.476539, "process_kernel_time": 0.14086, "process_mem_max_rss": "100628", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:41.835527 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:41.835404 after 0.19 seconds
[0m14:05:41.835977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd52f87d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd52e36d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd52e36dee0>]}
[0m14:05:41.836450 [debug] [MainThread]: Flushing usage events
[0m22:06:43.997104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe163a44290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe161cb79e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe16384f0b0>]}


============================== 22:06:44.058156 | dcab65e3-a4c1-4c08-9449-d702c5d5dd80 ==============================
[0m22:06:44.058156 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:44.058814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:44.315290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcab65e3-a4c1-4c08-9449-d702c5d5dd80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe16290c950>]}
[0m22:06:44.330334 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-racs0z64'
[0m22:06:44.330789 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:48.803476 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:48.804172 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:48.997917 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:49.001788 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:49.359385 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:49.359946 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:49.360525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'dcab65e3-a4c1-4c08-9449-d702c5d5dd80', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1616f2cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1616f3ef0>]}
[0m22:06:49.360984 [info ] [MainThread]: 
[0m22:06:49.361503 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:49.398557 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 5.450966, "process_user_time": 1.585284, "process_kernel_time": 0.12518, "process_mem_max_rss": "101564", "process_in_blocks": "8480", "process_out_blocks": "5168"}
[0m22:06:49.399117 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:49.399011 after 5.45 seconds
[0m22:06:49.399569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1644e5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe161cdfe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1623ea3f0>]}
[0m22:06:49.399992 [debug] [MainThread]: Flushing usage events
[0m22:06:51.221068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1affdd2d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aff9e1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1affdd0d40>]}


============================== 22:06:51.224147 | 988d39b4-0abe-41c8-b938-d9d01fa8ad28 ==============================
[0m22:06:51.224147 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:51.224866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:51.429401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '988d39b4-0abe-41c8-b938-d9d01fa8ad28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aff2e23c0>]}
[0m22:06:51.489308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '988d39b4-0abe-41c8-b938-d9d01fa8ad28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aff048230>]}
[0m22:06:51.491889 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:51.561093 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:51.561812 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:51.562345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '988d39b4-0abe-41c8-b938-d9d01fa8ad28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aff06c380>]}
[0m22:06:52.863407 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:52.864052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '988d39b4-0abe-41c8-b938-d9d01fa8ad28', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1afac328a0>]}
[0m22:06:53.089429 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:53.094940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '988d39b4-0abe-41c8-b938-d9d01fa8ad28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b012572c0>]}
[0m22:06:53.231360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '988d39b4-0abe-41c8-b938-d9d01fa8ad28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1afaff58e0>]}
[0m22:06:53.231855 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:53.232392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '988d39b4-0abe-41c8-b938-d9d01fa8ad28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1afaf8aa20>]}
[0m22:06:53.234226 [info ] [MainThread]: 
[0m22:06:53.234920 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:53.239602 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:53.273703 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:53.274125 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:53.274528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:53.777748 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:53.779389 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:53.780435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:53.780981 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:53.788492 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:53.788910 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:53.789283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:53.790279 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:53.791634 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:53.792021 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:53.792602 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:53.792976 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:53.793366 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:53.793931 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:53.794849 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:53.795237 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:53.795635 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:53.796152 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:53.796565 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:53.797808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:53.803452 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:53.803934 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:53.804293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:53.804927 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:53.805309 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:53.805730 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:53.818508 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:53.819998 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:53.821238 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:53.821845 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:53.824969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '988d39b4-0abe-41c8-b938-d9d01fa8ad28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1afb0dc740>]}
[0m22:06:53.825722 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:53.826303 [debug] [MainThread]: On master: BEGIN
[0m22:06:53.826890 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:53.827743 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:53.828353 [debug] [MainThread]: On master: COMMIT
[0m22:06:53.828928 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:53.829511 [debug] [MainThread]: On master: COMMIT
[0m22:06:53.830299 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:53.830901 [debug] [MainThread]: On master: Close
[0m22:06:53.831674 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:53.832284 [info ] [MainThread]: 
[0m22:06:53.863191 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:53.863866 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:53.864654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:53.865134 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:53.896279 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:53.897073 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:53.932498 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:53.933221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:05.347845 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.348350 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:05.349001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.349466 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.349887 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:05.350631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.353531 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.354008 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:05.354700 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.371385 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:05.371844 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.372268 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:05.374367 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.380147 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:05.380620 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:05.382137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.384500 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:05.386038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '988d39b4-0abe-41c8-b938-d9d01fa8ad28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b010862d0>]}
[0m22:07:05.386731 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.52s]
[0m22:07:05.387502 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:05.388280 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:05.389020 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:05.389653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:05.390089 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:05.394971 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:05.395604 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:05.431752 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.432233 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250803220705425669"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:05.432711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:05.440671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.448118 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.448610 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:05.449219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.449677 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.450096 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250803220705425669'
      
      
      order by ordinal_position

  
[0m22:07:05.452435 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.457534 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.457990 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:05.460239 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.467839 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.468314 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:05.470396 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.488313 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:05.489003 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.489478 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250803220705425669"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250803220705425669"
    )
  
[0m22:07:05.539480 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.541465 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:05.541904 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:05.542313 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:05.549775 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:05.550664 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:05.552124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '988d39b4-0abe-41c8-b938-d9d01fa8ad28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ac0cf7500>]}
[0m22:07:05.552808 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:07:05.553625 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:05.555150 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:05.555587 [debug] [MainThread]: On master: BEGIN
[0m22:07:05.555971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:05.556625 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:05.557020 [debug] [MainThread]: On master: COMMIT
[0m22:07:05.557421 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:05.557777 [debug] [MainThread]: On master: COMMIT
[0m22:07:05.558293 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:05.558721 [debug] [MainThread]: On master: Close
[0m22:07:05.559375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:05.559742 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:05.560134 [info ] [MainThread]: 
[0m22:07:05.560654 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.33 seconds (12.33s).
[0m22:07:05.561646 [debug] [MainThread]: Command end result
[0m22:07:05.587347 [info ] [MainThread]: 
[0m22:07:05.587939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:05.588467 [info ] [MainThread]: 
[0m22:07:05.588983 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:05.589959 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.418256, "process_user_time": 5.137175, "process_kernel_time": 0.284732, "process_mem_max_rss": "308860", "process_in_blocks": "1200", "process_out_blocks": "100136"}
[0m22:07:05.590514 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:05.590411 after 14.42 seconds
[0m22:07:05.590939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aff3c6f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aff77e420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ac0e46db0>]}
[0m22:07:05.591379 [debug] [MainThread]: Flushing usage events
[0m22:07:07.624357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb189f359d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18a5a33e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18a5a04a0>]}


============================== 22:07:07.627359 | fc2cb654-9f87-4019-901e-2ab6ea991de9 ==============================
[0m22:07:07.627359 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:07.628036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:07:07.734947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc2cb654-9f87-4019-901e-2ab6ea991de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb187c6b740>]}
[0m22:07:07.752399 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17686822, "process_user_time": 1.33207, "process_kernel_time": 0.105926, "process_mem_max_rss": "100572", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:07.752972 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:07.752868 after 0.18 seconds
[0m22:07:07.753398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb187ee0f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb187ee0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb187cb5b20>]}
[0m22:07:07.753814 [debug] [MainThread]: Flushing usage events
[0m06:05:25.787755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa1e7c1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa1f8b0b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa1e7c1df0>]}


============================== 06:05:25.803387 | 43bf2dee-5019-42c4-a0cb-2bb57451ed80 ==============================
[0m06:05:25.803387 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:05:25.804149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:05:25.944798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43bf2dee-5019-42c4-a0cb-2bb57451ed80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa1f9f8a70>]}
[0m06:05:25.961313 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-bkt53hjv'
[0m06:05:25.961828 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:05:26.254327 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:05:26.255129 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:05:26.278335 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:05:26.282305 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:05:26.354899 [info ] [MainThread]: Installed from version 1.2.0
[0m06:05:26.355497 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:05:26.356029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '43bf2dee-5019-42c4-a0cb-2bb57451ed80', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa1e6b6fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa1e6b5340>]}
[0m06:05:26.356491 [info ] [MainThread]: 
[0m06:05:26.356959 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:05:26.361853 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.62473154, "process_user_time": 1.610455, "process_kernel_time": 0.143218, "process_mem_max_rss": "101268", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m06:05:26.362425 [debug] [MainThread]: Command `dbt deps` succeeded at 06:05:26.362319 after 0.63 seconds
[0m06:05:26.362843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa1ee5bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa20539c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa1e7c1ca0>]}
[0m06:05:26.363308 [debug] [MainThread]: Flushing usage events
[0m06:05:28.100195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c77e0d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c760894f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c777f9460>]}


============================== 06:05:28.103408 | abc4dad4-e32e-41cc-bfa1-cdfd62da706c ==============================
[0m06:05:28.103408 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:05:28.104079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:05:28.310106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abc4dad4-e32e-41cc-bfa1-cdfd62da706c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c75c79a30>]}
[0m06:05:28.368974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abc4dad4-e32e-41cc-bfa1-cdfd62da706c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c75b34080>]}
[0m06:05:28.371647 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:05:28.397711 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:05:28.398533 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:05:28.399106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'abc4dad4-e32e-41cc-bfa1-cdfd62da706c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c75b4f980>]}
[0m06:05:29.695355 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:05:29.695985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'abc4dad4-e32e-41cc-bfa1-cdfd62da706c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c75cc3b30>]}
[0m06:05:29.930225 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:05:29.935839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abc4dad4-e32e-41cc-bfa1-cdfd62da706c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c7194cbf0>]}
[0m06:05:30.032579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abc4dad4-e32e-41cc-bfa1-cdfd62da706c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c7197d2b0>]}
[0m06:05:30.033188 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:05:30.033683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abc4dad4-e32e-41cc-bfa1-cdfd62da706c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c7799a2d0>]}
[0m06:05:30.035525 [info ] [MainThread]: 
[0m06:05:30.036246 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:05:30.040990 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:05:30.076135 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:05:30.076619 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:05:30.077021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:05:30.425979 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:05:30.427812 [debug] [ThreadPool]: On list_petro: Close
[0m06:05:30.428926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:05:30.429584 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:05:30.438349 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:05:30.438862 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:05:30.439335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:05:30.440757 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:05:30.442180 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:05:30.442569 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:05:30.443162 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:05:30.443543 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:05:30.443906 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:05:30.444568 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:05:30.445514 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:05:30.445901 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:05:30.446306 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:05:30.446844 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:05:30.447274 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:05:30.448588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:05:30.454577 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:05:30.455098 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:05:30.455463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:05:30.456123 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:05:30.456511 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:05:30.456887 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:05:30.467054 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:05:30.468654 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:05:30.469940 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:05:30.470382 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:05:30.472741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abc4dad4-e32e-41cc-bfa1-cdfd62da706c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c719fdca0>]}
[0m06:05:30.473290 [debug] [MainThread]: Using duckdb connection "master"
[0m06:05:30.473672 [debug] [MainThread]: On master: BEGIN
[0m06:05:30.474047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:05:30.474703 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:05:30.475122 [debug] [MainThread]: On master: COMMIT
[0m06:05:30.475485 [debug] [MainThread]: Using duckdb connection "master"
[0m06:05:30.475836 [debug] [MainThread]: On master: COMMIT
[0m06:05:30.476412 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:05:30.476805 [debug] [MainThread]: On master: Close
[0m06:05:30.477444 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:05:30.477928 [info ] [MainThread]: 
[0m06:05:30.493632 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:05:30.494281 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:05:30.494867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:05:30.495330 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:05:30.522105 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:05:30.522913 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:05:30.558369 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:05:30.559203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:05:38.359512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:05:38.360059 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:05:38.360747 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:05:38.361203 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:05:38.361618 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:05:38.362356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:05:38.365420 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:05:38.365860 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:05:38.366548 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:05:38.383194 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:05:38.383653 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:05:38.384089 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:05:38.385497 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:05:38.391257 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:05:38.391711 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:05:38.393457 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:05:38.395873 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:05:38.397456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc4dad4-e32e-41cc-bfa1-cdfd62da706c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c77a4a120>]}
[0m06:05:38.398166 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.90s]
[0m06:05:38.398918 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:05:38.399772 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:05:38.400514 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:05:38.401194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:05:38.401663 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:05:38.406751 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:05:38.407473 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:05:38.444024 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:05:38.444564 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250804060538437913"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:05:38.445043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:05:38.453182 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:05:38.460960 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:05:38.461442 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:05:38.462088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:05:38.462534 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:05:38.462951 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250804060538437913'
      
      
      order by ordinal_position

  
[0m06:05:38.465181 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:05:38.470608 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:05:38.471099 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:05:38.473334 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:05:38.481330 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:05:38.481805 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:05:38.484543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:05:38.505418 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:05:38.506531 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:05:38.507283 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250804060538437913"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250804060538437913"
    )
  
[0m06:05:38.566309 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:05:38.568325 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:05:38.568768 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:05:38.569204 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:05:38.577940 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:05:38.578914 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:05:38.580471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc4dad4-e32e-41cc-bfa1-cdfd62da706c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c338d8b60>]}
[0m06:05:38.581160 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m06:05:38.581878 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:05:38.583613 [debug] [MainThread]: Using duckdb connection "master"
[0m06:05:38.584059 [debug] [MainThread]: On master: BEGIN
[0m06:05:38.584440 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:05:38.585089 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:05:38.585485 [debug] [MainThread]: On master: COMMIT
[0m06:05:38.585850 [debug] [MainThread]: Using duckdb connection "master"
[0m06:05:38.586277 [debug] [MainThread]: On master: COMMIT
[0m06:05:38.586805 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:05:38.587227 [debug] [MainThread]: On master: Close
[0m06:05:38.587802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:05:38.588196 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:05:38.588593 [info ] [MainThread]: 
[0m06:05:38.589072 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.55 seconds (8.55s).
[0m06:05:38.589968 [debug] [MainThread]: Command end result
[0m06:05:38.615277 [info ] [MainThread]: 
[0m06:05:38.615821 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:05:38.616291 [info ] [MainThread]: 
[0m06:05:38.616752 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:05:38.617687 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.567281, "process_user_time": 5.086588, "process_kernel_time": 0.290318, "process_mem_max_rss": "308456", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:05:38.618277 [debug] [MainThread]: Command `dbt run` succeeded at 06:05:38.618163 after 10.57 seconds
[0m06:05:38.618699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c77e0d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c7194fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c77aa8f20>]}
[0m06:05:38.619139 [debug] [MainThread]: Flushing usage events
[0m06:05:40.504633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734a257f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734a27db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734a27f470>]}


============================== 06:05:40.507794 | e93122b9-6e96-4e0f-863e-e9240bc05198 ==============================
[0m06:05:40.507794 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:05:40.508471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:05:40.617847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e93122b9-6e96-4e0f-863e-e9240bc05198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734af9c440>]}
[0m06:05:40.635702 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1801123, "process_user_time": 1.35535, "process_kernel_time": 0.099952, "process_mem_max_rss": "100980", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:05:40.636299 [debug] [MainThread]: Command `dbt clean` succeeded at 06:05:40.636196 after 0.18 seconds
[0m06:05:40.636722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734ac58140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734a1fe8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734af9c440>]}
[0m06:05:40.637158 [debug] [MainThread]: Flushing usage events
[0m14:08:58.898364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed9764bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed9baba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed97640e0>]}


============================== 14:08:58.965049 | 494325c1-23c3-4b2a-8f61-770755c504ae ==============================
[0m14:08:58.965049 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:08:58.965777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:59.122726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '494325c1-23c3-4b2a-8f61-770755c504ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed9be94c0>]}
[0m14:08:59.138320 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-romk3dsz'
[0m14:08:59.138792 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:08:59.224912 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:08:59.225612 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:08:59.275685 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:08:59.279815 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:08:59.468312 [info ] [MainThread]: Installed from version 1.2.0
[0m14:08:59.468917 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:08:59.469465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '494325c1-23c3-4b2a-8f61-770755c504ae', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eda8f83b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed961e3f0>]}
[0m14:08:59.469911 [info ] [MainThread]: 
[0m14:08:59.470409 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:08:59.489031 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6407904, "process_user_time": 1.589881, "process_kernel_time": 0.137508, "process_mem_max_rss": "101496", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m14:08:59.489706 [debug] [MainThread]: Command `dbt deps` succeeded at 14:08:59.489601 after 0.64 seconds
[0m14:08:59.490128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed9dc5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed9d9e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed969da90>]}
[0m14:08:59.490579 [debug] [MainThread]: Flushing usage events
[0m14:09:01.177314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdcd71ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdf6d9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdcdd45f0>]}


============================== 14:09:01.180442 | 38286e49-0b96-42fe-859a-9f4964ce601f ==============================
[0m14:09:01.180442 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:09:01.181116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:09:01.383015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38286e49-0b96-42fe-859a-9f4964ce601f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdcb5aa20>]}
[0m14:09:01.442100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38286e49-0b96-42fe-859a-9f4964ce601f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdeaced80>]}
[0m14:09:01.444700 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:09:01.485215 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:09:01.485922 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:09:01.486436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '38286e49-0b96-42fe-859a-9f4964ce601f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdca57b60>]}
[0m14:09:02.782165 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:09:02.782810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '38286e49-0b96-42fe-859a-9f4964ce601f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd8b910a0>]}
[0m14:09:03.009678 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:09:03.015239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38286e49-0b96-42fe-859a-9f4964ce601f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fddec8f20>]}
[0m14:09:03.117123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38286e49-0b96-42fe-859a-9f4964ce601f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd8973140>]}
[0m14:09:03.117689 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:09:03.118203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38286e49-0b96-42fe-859a-9f4964ce601f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd8a62510>]}
[0m14:09:03.120022 [info ] [MainThread]: 
[0m14:09:03.120779 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:09:03.125445 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:09:03.160858 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:09:03.161397 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:09:03.161785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:03.579619 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:03.581238 [debug] [ThreadPool]: On list_petro: Close
[0m14:09:03.582258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:09:03.582843 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:09:03.590316 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:09:03.590779 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:09:03.591162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:03.592214 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:03.593547 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:09:03.593937 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:09:03.594497 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:03.594874 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:09:03.595270 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:09:03.595854 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:03.596773 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:09:03.597157 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:09:03.597562 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:09:03.598086 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:03.598499 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:09:03.599739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:09:03.605570 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:09:03.606057 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:09:03.606471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:03.607076 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:03.607498 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:09:03.607868 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:09:03.617616 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:03.619052 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:09:03.620329 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:09:03.620721 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:09:03.623002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38286e49-0b96-42fe-859a-9f4964ce601f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd894d1f0>]}
[0m14:09:03.623526 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:03.623909 [debug] [MainThread]: On master: BEGIN
[0m14:09:03.624290 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:09:03.624903 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:03.625331 [debug] [MainThread]: On master: COMMIT
[0m14:09:03.625705 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:03.626074 [debug] [MainThread]: On master: COMMIT
[0m14:09:03.626639 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:03.627023 [debug] [MainThread]: On master: Close
[0m14:09:03.627596 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:09:03.628056 [info ] [MainThread]: 
[0m14:09:03.645420 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:09:03.646074 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:09:03.646712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:09:03.647154 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:09:03.674136 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:09:03.674961 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:09:03.710495 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:09:03.711274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:13.810801 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:13.811326 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:09:13.811987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:13.812451 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:13.812869 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:09:13.813615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:13.816523 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:13.816961 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:09:13.817697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:13.834365 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:13.834824 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:13.835288 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:13.837177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:13.842929 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:13.843406 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:09:13.844494 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:13.846896 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:09:13.848462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38286e49-0b96-42fe-859a-9f4964ce601f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f9a8df050>]}
[0m14:09:13.849150 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.20s]
[0m14:09:13.849939 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:09:13.850873 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:09:13.851533 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:09:13.852128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:09:13.852597 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:09:13.857419 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:09:13.858056 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:09:13.894226 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:13.894742 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250804140913888202"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:09:13.895206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:13.903240 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:13.910948 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:13.911415 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:09:13.912052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:13.912523 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:13.912946 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250804140913888202'
      
      
      order by ordinal_position

  
[0m14:09:13.915109 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:13.920256 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:13.920708 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:13.923588 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:13.931240 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:13.931700 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:13.934380 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:13.952463 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:09:13.953150 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:13.953626 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250804140913888202"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250804140913888202"
    )
  
[0m14:09:14.004386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:14.006404 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:14.006842 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:14.007271 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:14.014879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:14.015801 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:09:14.017316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38286e49-0b96-42fe-859a-9f4964ce601f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f9a89ca10>]}
[0m14:09:14.018003 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:09:14.018761 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:09:14.020313 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:14.020725 [debug] [MainThread]: On master: BEGIN
[0m14:09:14.021105 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:14.021845 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:14.022267 [debug] [MainThread]: On master: COMMIT
[0m14:09:14.022643 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:14.023012 [debug] [MainThread]: On master: COMMIT
[0m14:09:14.023607 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:14.023997 [debug] [MainThread]: On master: Close
[0m14:09:14.024663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:14.025028 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:09:14.025455 [info ] [MainThread]: 
[0m14:09:14.025920 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.90 seconds (10.90s).
[0m14:09:14.026850 [debug] [MainThread]: Command end result
[0m14:09:14.053063 [info ] [MainThread]: 
[0m14:09:14.053659 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:09:14.054114 [info ] [MainThread]: 
[0m14:09:14.054599 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:09:14.055543 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.927943, "process_user_time": 5.042042, "process_kernel_time": 0.275111, "process_mem_max_rss": "345448", "process_in_blocks": "1200", "process_out_blocks": "100096"}
[0m14:09:14.056088 [debug] [MainThread]: Command `dbt run` succeeded at 14:09:14.055985 after 12.93 seconds
[0m14:09:14.056556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdf627110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f9a92ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdd166cf0>]}
[0m14:09:14.056985 [debug] [MainThread]: Flushing usage events
[0m14:09:16.479661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e3a607a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e2d69e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e2d69ee0>]}


============================== 14:09:16.482743 | 046ff622-aee8-4ee1-90c0-d9be50395b41 ==============================
[0m14:09:16.482743 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:09:16.483368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:09:16.590938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '046ff622-aee8-4ee1-90c0-d9be50395b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e3d4b2f0>]}
[0m14:09:16.608525 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17815894, "process_user_time": 1.331648, "process_kernel_time": 0.120968, "process_mem_max_rss": "101024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:09:16.609051 [debug] [MainThread]: Command `dbt clean` succeeded at 14:09:16.608950 after 0.18 seconds
[0m14:09:16.609501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e2d69cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e2b77ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e2b76c90>]}
[0m14:09:16.609896 [debug] [MainThread]: Flushing usage events
[0m22:07:01.113781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118de955b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118dd11820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118d7e6960>]}


============================== 22:07:01.130533 | 4efbf9d9-0839-4715-96a6-510f7579c47f ==============================
[0m22:07:01.130533 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:01.131313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:01.246928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4efbf9d9-0839-4715-96a6-510f7579c47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118da5f7a0>]}
[0m22:07:01.263853 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-m_6rd77k'
[0m22:07:01.264392 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:07:01.419494 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:07:01.420452 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:07:01.454218 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:07:01.458455 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:07:01.687623 [info ] [MainThread]: Installed from version 1.2.0
[0m22:07:01.688267 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:07:01.688822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4efbf9d9-0839-4715-96a6-510f7579c47f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118e5fc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118d150dd0>]}
[0m22:07:01.689272 [info ] [MainThread]: 
[0m22:07:01.689762 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:07:01.691347 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.62879145, "process_user_time": 1.647584, "process_kernel_time": 0.157533, "process_mem_max_rss": "101448", "process_in_blocks": "8480", "process_out_blocks": "5168"}
[0m22:07:01.691916 [debug] [MainThread]: Command `dbt deps` succeeded at 22:07:01.691811 after 0.63 seconds
[0m22:07:01.692345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118d82c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118d7e7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118dcc73b0>]}
[0m22:07:01.692800 [debug] [MainThread]: Flushing usage events
[0m22:07:03.630980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd87da7bc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd87eba4a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd87eb76de0>]}


============================== 22:07:03.634224 | df332d22-17c9-460b-a45c-a12f19091a97 ==============================
[0m22:07:03.634224 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:03.634930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:03.850864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df332d22-17c9-460b-a45c-a12f19091a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd87d84cc50>]}
[0m22:07:03.911595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df332d22-17c9-460b-a45c-a12f19091a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd87d8dd5e0>]}
[0m22:07:03.914421 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:07:03.942787 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:07:03.943590 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:07:03.944149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'df332d22-17c9-460b-a45c-a12f19091a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd87eb76de0>]}
[0m22:07:05.260930 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:07:05.261627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'df332d22-17c9-460b-a45c-a12f19091a97', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8798bef90>]}
[0m22:07:05.512898 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:07:05.518697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df332d22-17c9-460b-a45c-a12f19091a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd87966d370>]}
[0m22:07:05.605439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df332d22-17c9-460b-a45c-a12f19091a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8796f1f40>]}
[0m22:07:05.606055 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:07:05.606522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df332d22-17c9-460b-a45c-a12f19091a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8797ea5a0>]}
[0m22:07:05.608434 [info ] [MainThread]: 
[0m22:07:05.609169 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:07:05.614020 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:07:05.650406 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:07:05.650955 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:07:05.651358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:06.083652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:06.085570 [debug] [ThreadPool]: On list_petro: Close
[0m22:07:06.086967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:07:06.087760 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:07:06.099032 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:06.099667 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:07:06.100336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:06.102350 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:06.104057 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:06.104532 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:07:06.105277 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:06.105710 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:06.106120 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:07:06.106805 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:06.107772 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:06.108171 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:06.108533 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:06.109126 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:06.109524 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:07:06.110917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:07:06.117090 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:06.117525 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:07:06.117921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:06.118767 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:06.119160 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:06.119538 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:07:06.135388 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:06.137082 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:07:06.138421 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:07:06.138856 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:07:06.141356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df332d22-17c9-460b-a45c-a12f19091a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8796c0c80>]}
[0m22:07:06.141950 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:06.142336 [debug] [MainThread]: On master: BEGIN
[0m22:07:06.142695 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:06.143405 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:06.143825 [debug] [MainThread]: On master: COMMIT
[0m22:07:06.144194 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:06.144555 [debug] [MainThread]: On master: COMMIT
[0m22:07:06.145125 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:06.145514 [debug] [MainThread]: On master: Close
[0m22:07:06.146098 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:07:06.146581 [info ] [MainThread]: 
[0m22:07:06.158600 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:07:06.159265 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:07:06.159912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:07:06.160353 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:07:06.187805 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:07:06.188762 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:07:06.224957 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:07:06.225912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:17.033695 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:17.034228 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:17.034944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:17.035379 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:17.035819 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:17.036522 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:17.039540 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:17.040011 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:17.040666 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:17.057559 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:17.058134 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:17.058568 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:17.060541 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:17.067803 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:17.068351 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:17.069919 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:17.072464 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:17.074121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df332d22-17c9-460b-a45c-a12f19091a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83b2adbe0>]}
[0m22:07:17.074892 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.91s]
[0m22:07:17.075668 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:17.076654 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:17.077344 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:17.078039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:17.078494 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:17.083841 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:17.084512 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:17.121828 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:17.122418 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250804220717115501"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:17.122898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:17.131482 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:17.139984 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:17.140496 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:17.141265 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:17.141705 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:17.142164 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250804220717115501'
      
      
      order by ordinal_position

  
[0m22:07:17.144515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:17.150284 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:17.150777 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:17.153515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:17.161878 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:17.162418 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:17.165342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:17.184299 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:17.185210 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:17.185683 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250804220717115501"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250804220717115501"
    )
  
[0m22:07:17.237394 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:17.239451 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:17.239933 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:17.240348 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:17.248730 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:17.249782 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:17.251364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df332d22-17c9-460b-a45c-a12f19091a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83b301010>]}
[0m22:07:17.252062 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:07:17.252889 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:17.254248 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:17.254655 [debug] [MainThread]: On master: BEGIN
[0m22:07:17.255071 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:17.255821 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:17.256222 [debug] [MainThread]: On master: COMMIT
[0m22:07:17.256587 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:17.256978 [debug] [MainThread]: On master: COMMIT
[0m22:07:17.257541 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:17.257966 [debug] [MainThread]: On master: Close
[0m22:07:17.258578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:17.258982 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:17.259384 [info ] [MainThread]: 
[0m22:07:17.259931 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.65 seconds (11.65s).
[0m22:07:17.260959 [debug] [MainThread]: Command end result
[0m22:07:17.287653 [info ] [MainThread]: 
[0m22:07:17.288358 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:17.288896 [info ] [MainThread]: 
[0m22:07:17.289421 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:17.290488 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.709832, "process_user_time": 4.887417, "process_kernel_time": 0.293746, "process_mem_max_rss": "309712", "process_in_blocks": "1200", "process_out_blocks": "100120"}
[0m22:07:17.291070 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:17.290963 after 13.71 seconds
[0m22:07:17.291516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd880615370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd87d84f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd87de6e090>]}
[0m22:07:17.291976 [debug] [MainThread]: Flushing usage events
[0m22:07:19.564254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde330f9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde334411f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde330f95b0>]}


============================== 22:07:19.567594 | 920f3f9a-45df-4871-83bf-7157be5f40fd ==============================
[0m22:07:19.567594 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:19.568299 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:19.679317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '920f3f9a-45df-4871-83bf-7157be5f40fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde33ebaff0>]}
[0m22:07:19.698181 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18479922, "process_user_time": 1.408325, "process_kernel_time": 0.109947, "process_mem_max_rss": "100788", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:19.698775 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:19.698636 after 0.19 seconds
[0m22:07:19.699236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde33abee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde330b68a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde32e64d70>]}
[0m22:07:19.699682 [debug] [MainThread]: Flushing usage events
[0m06:03:30.242963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1330bf6000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13312b0b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1330bf5d90>]}


============================== 06:03:30.260781 | 5d10d8a6-25da-497f-b93f-2ea93849ba17 ==============================
[0m06:03:30.260781 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:30.261426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:30.371764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d10d8a6-25da-497f-b93f-2ea93849ba17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1330a2b920>]}
[0m06:03:30.386657 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_b08x0fy'
[0m06:03:30.387104 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:03:30.556398 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:03:30.557044 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:03:30.568673 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:03:30.572459 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:03:30.631759 [info ] [MainThread]: Installed from version 1.2.0
[0m06:03:30.632292 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:03:30.632817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5d10d8a6-25da-497f-b93f-2ea93849ba17', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1330c3a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1330c3a6c0>]}
[0m06:03:30.633249 [info ] [MainThread]: 
[0m06:03:30.633720 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:03:30.640745 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44695002, "process_user_time": 1.569221, "process_kernel_time": 0.137843, "process_mem_max_rss": "101664", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m06:03:30.641301 [debug] [MainThread]: Command `dbt deps` succeeded at 06:03:30.641178 after 0.45 seconds
[0m06:03:30.641727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13351bb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13308f7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1330b9f6e0>]}
[0m06:03:30.642135 [debug] [MainThread]: Flushing usage events
[0m06:03:32.346960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84684b9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8466968770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84665c4230>]}


============================== 06:03:32.350103 | be032f9c-15a6-4978-ace2-cc36aea97df6 ==============================
[0m06:03:32.350103 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:32.350758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:32.553642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be032f9c-15a6-4978-ace2-cc36aea97df6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f846584a690>]}
[0m06:03:32.612322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be032f9c-15a6-4978-ace2-cc36aea97df6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84678c1130>]}
[0m06:03:32.615011 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:03:32.646567 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:03:32.647323 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:03:32.647841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'be032f9c-15a6-4978-ace2-cc36aea97df6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8465843470>]}
[0m06:03:33.935925 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:03:33.936598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'be032f9c-15a6-4978-ace2-cc36aea97df6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84619aebd0>]}
[0m06:03:34.168817 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:03:34.174483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be032f9c-15a6-4978-ace2-cc36aea97df6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84677b22d0>]}
[0m06:03:34.276123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be032f9c-15a6-4978-ace2-cc36aea97df6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84617f9400>]}
[0m06:03:34.276721 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:03:34.277237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be032f9c-15a6-4978-ace2-cc36aea97df6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84617eb620>]}
[0m06:03:34.279109 [info ] [MainThread]: 
[0m06:03:34.279822 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:03:34.284544 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:03:34.319819 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:03:34.320298 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:03:34.320700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:34.863796 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:03:34.865964 [debug] [ThreadPool]: On list_petro: Close
[0m06:03:34.867065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:03:34.867754 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:03:34.876710 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:34.877203 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:03:34.877675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:34.879073 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:34.880446 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:34.880833 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:03:34.881456 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:34.881839 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:34.882198 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:03:34.882813 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:34.883742 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:34.884134 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:34.884530 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:34.885072 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:34.885503 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:03:34.886827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:03:34.892640 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:34.893131 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:03:34.893516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:34.894124 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:34.894540 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:34.894910 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:03:34.904752 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:34.906201 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:03:34.907447 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:03:34.907838 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:03:34.910027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be032f9c-15a6-4978-ace2-cc36aea97df6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8465b81790>]}
[0m06:03:34.910570 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:34.910946 [debug] [MainThread]: On master: BEGIN
[0m06:03:34.911318 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:34.911915 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:34.912325 [debug] [MainThread]: On master: COMMIT
[0m06:03:34.912699 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:34.913057 [debug] [MainThread]: On master: COMMIT
[0m06:03:34.913586 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:34.913969 [debug] [MainThread]: On master: Close
[0m06:03:34.914525 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:03:34.914990 [info ] [MainThread]: 
[0m06:03:34.931717 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:03:34.932345 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:03:34.932957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:03:34.933418 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:03:34.960611 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:03:34.961484 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:03:34.997070 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:03:34.997863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:41.702286 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:41.702795 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:41.703448 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:41.703885 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:41.704339 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:41.705050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:41.707995 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:41.708455 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:41.709118 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:41.725773 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:41.726229 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:41.726678 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:41.727985 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:41.733571 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:41.734023 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:41.735280 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:41.737616 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:41.739152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be032f9c-15a6-4978-ace2-cc36aea97df6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8423621f10>]}
[0m06:03:41.739844 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.81s]
[0m06:03:41.740727 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:41.741666 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:41.742213 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:41.742886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:41.743338 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:41.748281 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:41.748932 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:41.784959 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:41.785480 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250805060341778714"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:41.785942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:41.793964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:41.801804 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:41.802283 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:41.802978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:41.803439 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:41.803856 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250805060341778714'
      
      
      order by ordinal_position

  
[0m06:03:41.805973 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:41.811122 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:41.811600 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:41.813647 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:41.821277 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:41.821748 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:41.824808 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:41.843041 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:41.843792 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:41.844241 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250805060341778714"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250805060341778714"
    )
  
[0m06:03:41.891080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:41.893098 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:41.893587 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:41.893999 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:41.902042 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:41.902999 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:41.904478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be032f9c-15a6-4978-ace2-cc36aea97df6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8423623290>]}
[0m06:03:41.905156 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:03:41.906035 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:41.907452 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:41.907861 [debug] [MainThread]: On master: BEGIN
[0m06:03:41.908227 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:41.908920 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:41.909344 [debug] [MainThread]: On master: COMMIT
[0m06:03:41.909716 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:41.910070 [debug] [MainThread]: On master: COMMIT
[0m06:03:41.910621 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:41.911017 [debug] [MainThread]: On master: Close
[0m06:03:41.911657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:41.912020 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:41.912438 [info ] [MainThread]: 
[0m06:03:41.912941 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.63 seconds (7.63s).
[0m06:03:41.913944 [debug] [MainThread]: Command end result
[0m06:03:41.939566 [info ] [MainThread]: 
[0m06:03:41.940177 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:41.940716 [info ] [MainThread]: 
[0m06:03:41.941236 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:41.942239 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.644609, "process_user_time": 5.194647, "process_kernel_time": 0.271451, "process_mem_max_rss": "309124", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:03:41.942801 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:41.942700 after 9.65 seconds
[0m06:03:41.943225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8465ad8560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f846196c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8465f764b0>]}
[0m06:03:41.943676 [debug] [MainThread]: Flushing usage events
[0m06:03:44.244577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59944d2f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59932f1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59907fdca0>]}


============================== 06:03:44.247720 | 04b703ee-85fc-4cdc-90f0-097ccb832f0f ==============================
[0m06:03:44.247720 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:44.248404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:44.356947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04b703ee-85fc-4cdc-90f0-097ccb832f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5990d153d0>]}
[0m06:03:44.375094 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17985557, "process_user_time": 1.353016, "process_kernel_time": 0.101075, "process_mem_max_rss": "100852", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:03:44.375666 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:44.375562 after 0.18 seconds
[0m06:03:44.376095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59907fd5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f599499aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5990d153d0>]}
[0m06:03:44.376541 [debug] [MainThread]: Flushing usage events
[0m14:09:24.669724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81575ba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8142aae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa813d81bb0>]}


============================== 14:09:24.706899 | be8a7b0d-6423-4368-8585-3374eeabb058 ==============================
[0m14:09:24.706899 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:09:24.707569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:09:24.954031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be8a7b0d-6423-4368-8585-3374eeabb058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa813d0fef0>]}
[0m14:09:24.969766 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-y0w90wl8'
[0m14:09:24.970236 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:09:25.152156 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:09:25.152884 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:09:25.191955 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:09:25.195795 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:09:25.268608 [info ] [MainThread]: Installed from version 1.2.0
[0m14:09:25.269157 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:09:25.269686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'be8a7b0d-6423-4368-8585-3374eeabb058', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa813d81bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81376c290>]}
[0m14:09:25.270128 [info ] [MainThread]: 
[0m14:09:25.270639 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:09:25.276374 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6560518, "process_user_time": 1.577185, "process_kernel_time": 0.144566, "process_mem_max_rss": "101336", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m14:09:25.276935 [debug] [MainThread]: Command `dbt deps` succeeded at 14:09:25.276833 after 0.66 seconds
[0m14:09:25.277348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8143a7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81369c2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81369c0b0>]}
[0m14:09:25.277779 [debug] [MainThread]: Flushing usage events
[0m14:09:26.861825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfd2eb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfcde0ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfdcb69c0>]}


============================== 14:09:26.864970 | fdc1b84c-75f3-4672-8f20-ad0a6d7771c1 ==============================
[0m14:09:26.864970 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:09:26.865678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:09:27.070055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdc1b84c-75f3-4672-8f20-ad0a6d7771c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfcb64380>]}
[0m14:09:27.128776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdc1b84c-75f3-4672-8f20-ad0a6d7771c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c004ec9e0>]}
[0m14:09:27.131446 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:09:27.162920 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:09:27.163643 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:09:27.164159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fdc1b84c-75f3-4672-8f20-ad0a6d7771c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfca45940>]}
[0m14:09:28.460448 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:09:28.461120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fdc1b84c-75f3-4672-8f20-ad0a6d7771c1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf8ad04a0>]}
[0m14:09:28.701606 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:09:28.707634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdc1b84c-75f3-4672-8f20-ad0a6d7771c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfcb57ce0>]}
[0m14:09:28.809972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdc1b84c-75f3-4672-8f20-ad0a6d7771c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf89caab0>]}
[0m14:09:28.810569 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:09:28.811070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdc1b84c-75f3-4672-8f20-ad0a6d7771c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf8a2a510>]}
[0m14:09:28.813002 [info ] [MainThread]: 
[0m14:09:28.813761 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:09:28.818486 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:09:28.853598 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:09:28.854042 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:09:28.854420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:29.428353 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:09:29.430213 [debug] [ThreadPool]: On list_petro: Close
[0m14:09:29.431296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:09:29.431929 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:09:29.439377 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:09:29.439819 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:09:29.440196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:29.441329 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:29.442703 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:09:29.443093 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:09:29.443651 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:29.444037 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:09:29.444400 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:09:29.445017 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:29.445946 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:09:29.446337 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:09:29.446728 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:09:29.447260 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:29.447682 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:09:29.448935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:09:29.454835 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:09:29.455246 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:09:29.455636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:29.456302 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:29.456718 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:09:29.457103 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:09:29.466346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:29.467984 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:09:29.469300 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:09:29.469734 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:09:29.471985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdc1b84c-75f3-4672-8f20-ad0a6d7771c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf8a563f0>]}
[0m14:09:29.472527 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:29.472907 [debug] [MainThread]: On master: BEGIN
[0m14:09:29.473258 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:09:29.473899 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:29.474285 [debug] [MainThread]: On master: COMMIT
[0m14:09:29.474674 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:29.475025 [debug] [MainThread]: On master: COMMIT
[0m14:09:29.475563 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:29.475950 [debug] [MainThread]: On master: Close
[0m14:09:29.476507 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:09:29.476990 [info ] [MainThread]: 
[0m14:09:29.489023 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:09:29.489654 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:09:29.490299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:09:29.490756 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:09:29.517521 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:09:29.518347 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:09:29.555990 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:09:29.556912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:37.578683 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:37.579204 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:09:37.579892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:37.580335 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:37.580784 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:09:37.581561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:37.584558 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:37.584996 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:09:37.585664 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:37.602527 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:37.603004 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:37.603438 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:37.606172 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:37.612045 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:37.612524 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:09:37.613898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:37.616322 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:09:37.617905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdc1b84c-75f3-4672-8f20-ad0a6d7771c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbeea8650>]}
[0m14:09:37.618608 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.13s]
[0m14:09:37.619416 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:09:37.620418 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:09:37.620979 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:09:37.621628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:09:37.622063 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:09:37.627104 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:09:37.627779 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:09:37.663572 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:37.664082 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250805140937657550"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:09:37.664552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:37.672337 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:37.680226 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:37.680707 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:09:37.681352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:37.681810 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:37.682225 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250805140937657550'
      
      
      order by ordinal_position

  
[0m14:09:37.684370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:37.689567 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:37.690032 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:37.692146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:37.699770 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:37.700224 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:37.702267 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:37.720251 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:09:37.721041 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:37.721522 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250805140937657550"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250805140937657550"
    )
  
[0m14:09:37.773284 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:37.775308 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:37.775808 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:37.776218 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:37.784433 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:37.785385 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:09:37.786830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdc1b84c-75f3-4672-8f20-ad0a6d7771c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbe74bda0>]}
[0m14:09:37.787507 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:09:37.788304 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:09:37.789674 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:37.790088 [debug] [MainThread]: On master: BEGIN
[0m14:09:37.790487 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:37.791149 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:37.791585 [debug] [MainThread]: On master: COMMIT
[0m14:09:37.791957 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:37.792310 [debug] [MainThread]: On master: COMMIT
[0m14:09:37.792859 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:37.793247 [debug] [MainThread]: On master: Close
[0m14:09:37.793865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:37.794225 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:09:37.794650 [info ] [MainThread]: 
[0m14:09:37.795130 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.98 seconds (8.98s).
[0m14:09:37.796058 [debug] [MainThread]: Command end result
[0m14:09:37.822227 [info ] [MainThread]: 
[0m14:09:37.822826 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:09:37.823301 [info ] [MainThread]: 
[0m14:09:37.823803 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:09:37.824784 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.012242, "process_user_time": 4.720545, "process_kernel_time": 0.26253, "process_mem_max_rss": "318148", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m14:09:37.825324 [debug] [MainThread]: Command `dbt run` succeeded at 14:09:37.825223 after 11.01 seconds
[0m14:09:37.825783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfcdfd5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf7370740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bbf4c0740>]}
[0m14:09:37.826203 [debug] [MainThread]: Flushing usage events
[0m14:09:40.119093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b73a7b8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b73223d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b75131220>]}


============================== 14:09:40.122226 | 9f52cb93-a9b3-45d5-958a-b34bae6624a2 ==============================
[0m14:09:40.122226 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:09:40.122923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:09:40.230420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f52cb93-a9b3-45d5-958a-b34bae6624a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b7539ac30>]}
[0m14:09:40.248660 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17915387, "process_user_time": 1.348356, "process_kernel_time": 0.105949, "process_mem_max_rss": "100664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:09:40.249205 [debug] [MainThread]: Command `dbt clean` succeeded at 14:09:40.249101 after 0.18 seconds
[0m14:09:40.249683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b741128d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b741c8ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b733b1f40>]}
[0m14:09:40.250100 [debug] [MainThread]: Flushing usage events
[0m22:07:10.191747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540a0f57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540ab9fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540ab9c560>]}


============================== 22:07:10.208710 | 91d9f4ba-4a29-4e5a-8bf8-17c1e6798fbe ==============================
[0m22:07:10.208710 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:10.209413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:07:10.424138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91d9f4ba-4a29-4e5a-8bf8-17c1e6798fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540a0f78f0>]}
[0m22:07:10.439296 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-56xr2e6c'
[0m22:07:10.439763 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:07:10.671415 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:07:10.672068 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:07:10.701993 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:07:10.705867 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:07:10.815025 [info ] [MainThread]: Installed from version 1.2.0
[0m22:07:10.815522 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:07:10.816060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '91d9f4ba-4a29-4e5a-8bf8-17c1e6798fbe', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5409f52420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5409e43800>]}
[0m22:07:10.816497 [info ] [MainThread]: 
[0m22:07:10.816978 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:07:10.822450 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.67975783, "process_user_time": 1.573143, "process_kernel_time": 0.134182, "process_mem_max_rss": "101564", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m22:07:10.823007 [debug] [MainThread]: Command `dbt deps` succeeded at 22:07:10.822902 after 0.68 seconds
[0m22:07:10.823421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540a13c8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540a22a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5409e02420>]}
[0m22:07:10.823858 [debug] [MainThread]: Flushing usage events
[0m22:07:12.443414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b26cbedb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b268164b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b26817f80>]}


============================== 22:07:12.446533 | dd500136-09f6-4f34-9664-4432807b7e5f ==============================
[0m22:07:12.446533 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:12.447209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:07:12.651780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd500136-09f6-4f34-9664-4432807b7e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b261d0380>]}
[0m22:07:12.710948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd500136-09f6-4f34-9664-4432807b7e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b260b5fa0>]}
[0m22:07:12.713556 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:07:12.743543 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:07:12.744272 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:07:12.744781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dd500136-09f6-4f34-9664-4432807b7e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b2605db50>]}
[0m22:07:14.049981 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:07:14.050604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dd500136-09f6-4f34-9664-4432807b7e5f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b26279970>]}
[0m22:07:14.282979 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:07:14.288425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd500136-09f6-4f34-9664-4432807b7e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b21e6c5c0>]}
[0m22:07:14.388401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd500136-09f6-4f34-9664-4432807b7e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b21e53a70>]}
[0m22:07:14.388966 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:07:14.389466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd500136-09f6-4f34-9664-4432807b7e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b21ec3410>]}
[0m22:07:14.391338 [info ] [MainThread]: 
[0m22:07:14.392051 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:07:14.396920 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:07:14.431775 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:07:14.432240 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:07:14.432624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:14.959412 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:07:14.961639 [debug] [ThreadPool]: On list_petro: Close
[0m22:07:14.962868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:07:14.963647 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:07:14.971969 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:14.972392 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:07:14.972765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:14.973910 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:14.975226 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:14.975611 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:07:14.976170 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:14.976548 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:14.976941 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:07:14.977534 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:14.978454 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:14.978873 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:14.979241 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:14.979760 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:14.980178 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:07:14.981379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:07:14.987031 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:14.987525 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:07:14.987915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:14.988503 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:14.988910 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:14.989286 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:07:14.999378 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:15.000817 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:07:15.002062 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:07:15.002455 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:07:15.004697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd500136-09f6-4f34-9664-4432807b7e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b20945100>]}
[0m22:07:15.005236 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:15.005613 [debug] [MainThread]: On master: BEGIN
[0m22:07:15.006007 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:15.006589 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:15.006999 [debug] [MainThread]: On master: COMMIT
[0m22:07:15.007363 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:15.007729 [debug] [MainThread]: On master: COMMIT
[0m22:07:15.008269 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:15.008648 [debug] [MainThread]: On master: Close
[0m22:07:15.009197 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:07:15.009648 [info ] [MainThread]: 
[0m22:07:15.025268 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:07:15.025884 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:07:15.026452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:07:15.026900 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:07:15.053391 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:07:15.054168 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:07:15.089599 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:07:15.090372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:23.614200 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:23.614711 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:23.615370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:23.615880 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:23.616310 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:23.617023 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:23.619939 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:23.620380 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:23.621069 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:23.637884 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:23.638348 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:23.638766 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:23.640102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:23.645753 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:23.646234 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:23.647372 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:23.649755 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:23.651304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd500136-09f6-4f34-9664-4432807b7e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ae3ff18e0>]}
[0m22:07:23.651997 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.62s]
[0m22:07:23.652736 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:23.653568 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:23.654262 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:23.654994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:23.655436 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:23.660442 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:23.661110 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:23.696840 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:23.697321 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250805220723690802"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:23.697761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:23.705461 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:23.712970 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:23.713422 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:23.714034 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:23.714470 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:23.714908 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250805220723690802'
      
      
      order by ordinal_position

  
[0m22:07:23.717085 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:23.722161 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:23.722616 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:23.725617 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:23.733338 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:23.733798 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:23.736412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:23.754566 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:23.755296 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:23.755743 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250805220723690802"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250805220723690802"
    )
  
[0m22:07:23.805093 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:23.807084 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:23.807527 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:23.807963 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:23.816001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:23.816921 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:23.818316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd500136-09f6-4f34-9664-4432807b7e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ae3f83ad0>]}
[0m22:07:23.819005 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:07:23.819724 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:23.821382 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:23.821788 [debug] [MainThread]: On master: BEGIN
[0m22:07:23.822200 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:23.822880 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:23.823276 [debug] [MainThread]: On master: COMMIT
[0m22:07:23.823640 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:23.824031 [debug] [MainThread]: On master: COMMIT
[0m22:07:23.824558 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:23.824984 [debug] [MainThread]: On master: Close
[0m22:07:23.825549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:23.825934 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:23.826330 [info ] [MainThread]: 
[0m22:07:23.826817 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.43 seconds (9.43s).
[0m22:07:23.827814 [debug] [MainThread]: Command end result
[0m22:07:23.853393 [info ] [MainThread]: 
[0m22:07:23.854005 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:23.854517 [info ] [MainThread]: 
[0m22:07:23.855054 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:23.856083 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.462067, "process_user_time": 4.642279, "process_kernel_time": 0.297017, "process_mem_max_rss": "309340", "process_in_blocks": "1200", "process_out_blocks": "100128"}
[0m22:07:23.856655 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:23.856542 after 11.46 seconds
[0m22:07:23.857120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b26545d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b21e4b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b21e50320>]}
[0m22:07:23.857537 [debug] [MainThread]: Flushing usage events
[0m22:07:26.156299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa169058cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1692d5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa168607710>]}


============================== 22:07:26.159364 | a16d7797-e1be-4a77-8093-1c9708731a00 ==============================
[0m22:07:26.159364 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:26.160003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:07:26.268105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a16d7797-e1be-4a77-8093-1c9708731a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1693cb2f0>]}
[0m22:07:26.285916 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1789607, "process_user_time": 1.329264, "process_kernel_time": 0.109021, "process_mem_max_rss": "100648", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:07:26.286448 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:26.286346 after 0.18 seconds
[0m22:07:26.286894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa168664860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa168d93740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1682acd70>]}
[0m22:07:26.287310 [debug] [MainThread]: Flushing usage events
[0m06:03:30.617725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f389d76ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f389c46fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f389e53d5b0>]}


============================== 06:03:30.633402 | 4c6995c0-20a3-4d6a-90bd-e036a149c387 ==============================
[0m06:03:30.633402 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:30.634067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:03:30.815806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c6995c0-20a3-4d6a-90bd-e036a149c387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f389b945fa0>]}
[0m06:03:30.830378 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3s_712y8'
[0m06:03:30.830815 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:03:31.004023 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:03:31.004802 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:03:31.026684 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:03:31.030486 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:03:31.101707 [info ] [MainThread]: Installed from version 1.2.0
[0m06:03:31.102311 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:03:31.102836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4c6995c0-20a3-4d6a-90bd-e036a149c387', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f389b780620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f389b7801d0>]}
[0m06:03:31.103313 [info ] [MainThread]: 
[0m06:03:31.103793 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:03:31.109503 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.54089224, "process_user_time": 1.539044, "process_kernel_time": 0.14391, "process_mem_max_rss": "101376", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m06:03:31.110156 [debug] [MainThread]: Command `dbt deps` succeeded at 06:03:31.110049 after 0.54 seconds
[0m06:03:31.110635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f389e80fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f389e53d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f389b770920>]}
[0m06:03:31.111075 [debug] [MainThread]: Flushing usage events
[0m06:03:32.658932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db5e79a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db626ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db6191370>]}


============================== 06:03:32.661953 | 94340f80-f015-4a80-8791-c4490e01ee97 ==============================
[0m06:03:32.661953 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:32.662604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:03:32.863140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94340f80-f015-4a80-8791-c4490e01ee97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db5c4bb60>]}
[0m06:03:32.921911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94340f80-f015-4a80-8791-c4490e01ee97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db6268b60>]}
[0m06:03:32.924412 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:03:32.950507 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:03:32.951307 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:03:32.951861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '94340f80-f015-4a80-8791-c4490e01ee97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db5cb1df0>]}
[0m06:03:34.245090 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:03:34.245712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '94340f80-f015-4a80-8791-c4490e01ee97', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db1abd130>]}
[0m06:03:34.469032 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:03:34.474421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94340f80-f015-4a80-8791-c4490e01ee97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db5c800b0>]}
[0m06:03:34.600310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94340f80-f015-4a80-8791-c4490e01ee97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db1abc2f0>]}
[0m06:03:34.600839 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:03:34.601377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94340f80-f015-4a80-8791-c4490e01ee97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db1a42a80>]}
[0m06:03:34.603197 [info ] [MainThread]: 
[0m06:03:34.603925 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:03:34.608551 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:03:34.643828 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:03:34.644277 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:03:34.644670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:35.122348 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:35.123987 [debug] [ThreadPool]: On list_petro: Close
[0m06:03:35.125034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:03:35.125610 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:03:35.133031 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:35.133473 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:03:35.133852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:35.134771 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:35.136072 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:35.136484 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:03:35.137015 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:35.137416 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:35.137782 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:03:35.138369 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:35.139287 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:35.139668 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:35.140028 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:35.140629 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:35.141019 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:03:35.142284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:03:35.147926 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:35.148432 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:03:35.148795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:35.149392 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:35.149797 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:35.150169 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:03:35.160071 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:35.161546 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:03:35.162795 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:03:35.163191 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:03:35.165530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94340f80-f015-4a80-8791-c4490e01ee97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db7bd1100>]}
[0m06:03:35.166022 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:35.166435 [debug] [MainThread]: On master: BEGIN
[0m06:03:35.166788 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:35.167390 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:35.167782 [debug] [MainThread]: On master: COMMIT
[0m06:03:35.168145 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:35.168541 [debug] [MainThread]: On master: COMMIT
[0m06:03:35.169079 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:35.169495 [debug] [MainThread]: On master: Close
[0m06:03:35.170014 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:03:35.170514 [info ] [MainThread]: 
[0m06:03:35.184989 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:03:35.185582 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:03:35.186228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:03:35.186662 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:03:35.213295 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:03:35.214028 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:03:35.249145 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:03:35.249869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:43.345162 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:43.345679 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:43.346328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:43.346778 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:43.347190 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:43.347922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:43.350820 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:43.351280 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:43.351990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:43.368643 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:43.369102 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:43.369550 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:43.370606 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:43.376200 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:43.376670 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:43.377768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:43.380095 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:43.381642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94340f80-f015-4a80-8791-c4490e01ee97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db05c87a0>]}
[0m06:03:43.382350 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.19s]
[0m06:03:43.383178 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:43.384162 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:43.384749 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:43.385391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:43.385828 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:43.390735 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:43.391383 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:43.427199 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:43.427698 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250806060343421205"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:43.428147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:43.435563 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:43.442878 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:43.443349 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:43.443933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:43.444402 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:43.444825 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250806060343421205'
      
      
      order by ordinal_position

  
[0m06:03:43.447103 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:43.452134 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:43.452605 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:43.454707 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:43.462303 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:43.462756 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:43.464739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:43.482929 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:43.483590 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:43.484040 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250806060343421205"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250806060343421205"
    )
  
[0m06:03:43.533755 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:43.535754 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:43.536192 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:43.536634 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:43.544334 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:43.545267 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:43.546759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94340f80-f015-4a80-8791-c4490e01ee97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d73bcb800>]}
[0m06:03:43.547450 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:03:43.548183 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:43.549511 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:43.549914 [debug] [MainThread]: On master: BEGIN
[0m06:03:43.550329 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:43.550950 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:43.551383 [debug] [MainThread]: On master: COMMIT
[0m06:03:43.551760 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:43.552118 [debug] [MainThread]: On master: COMMIT
[0m06:03:43.552685 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:43.553069 [debug] [MainThread]: On master: Close
[0m06:03:43.553712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:43.554081 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:43.554518 [info ] [MainThread]: 
[0m06:03:43.555000 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.95 seconds (8.95s).
[0m06:03:43.555992 [debug] [MainThread]: Command end result
[0m06:03:43.581838 [info ] [MainThread]: 
[0m06:03:43.582449 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:43.582962 [info ] [MainThread]: 
[0m06:03:43.583496 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:43.584490 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.974174, "process_user_time": 5.093653, "process_kernel_time": 0.260931, "process_mem_max_rss": "315804", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:03:43.585038 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:43.584935 after 10.97 seconds
[0m06:03:43.585491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db5ef55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db5e79a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db626a9c0>]}
[0m06:03:43.585909 [debug] [MainThread]: Flushing usage events
[0m06:03:45.452568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e6f20da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e74a0e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e78f4ef0>]}


============================== 06:03:45.455674 | b7a0f122-09de-4a5e-95cd-ff0fed2b1e92 ==============================
[0m06:03:45.455674 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:45.456334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:45.563607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7a0f122-09de-4a5e-95cd-ff0fed2b1e92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e7fcd010>]}
[0m06:03:45.581004 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17729956, "process_user_time": 1.325196, "process_kernel_time": 0.107015, "process_mem_max_rss": "100660", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:03:45.581556 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:45.581453 after 0.18 seconds
[0m06:03:45.581968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e6d73320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e6f216d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e6e62cc0>]}
[0m06:03:45.582430 [debug] [MainThread]: Flushing usage events
[0m14:09:00.375310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc1a40500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbf939670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc24d9b80>]}


============================== 14:09:00.391688 | c0b77e6f-f9c1-4114-8246-19a4516d0c74 ==============================
[0m14:09:00.391688 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:09:00.392406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:09:00.504351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0b77e6f-f9c1-4114-8246-19a4516d0c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbffd5af0>]}
[0m14:09:00.519842 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fy3320k7'
[0m14:09:00.520370 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:09:00.676602 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:09:00.677386 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:09:00.716980 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:09:00.721031 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:09:00.898660 [info ] [MainThread]: Installed from version 1.2.0
[0m14:09:00.899299 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:09:00.899914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c0b77e6f-f9c1-4114-8246-19a4516d0c74', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbf799a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbf776f90>]}
[0m14:09:00.900409 [info ] [MainThread]: 
[0m14:09:00.900915 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:09:00.906360 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.581599, "process_user_time": 1.627781, "process_kernel_time": 0.14277, "process_mem_max_rss": "101756", "process_in_blocks": "8480", "process_out_blocks": "5168"}
[0m14:09:00.906925 [debug] [MainThread]: Command `dbt deps` succeeded at 14:09:00.906821 after 0.58 seconds
[0m14:09:00.907376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbfb17b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbfaee030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbf799a30>]}
[0m14:09:00.907811 [debug] [MainThread]: Flushing usage events
[0m14:09:02.668575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe337285970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe337285a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe337285a60>]}


============================== 14:09:02.671843 | bf47bda2-bc9b-4df7-9cb4-cd111d773c9b ==============================
[0m14:09:02.671843 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:09:02.672548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:09:02.877846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf47bda2-bc9b-4df7-9cb4-cd111d773c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33706cb90>]}
[0m14:09:02.936800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf47bda2-bc9b-4df7-9cb4-cd111d773c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3373055e0>]}
[0m14:09:02.939520 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:09:02.963945 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:09:02.964711 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:09:02.965246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf47bda2-bc9b-4df7-9cb4-cd111d773c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33317b4a0>]}
[0m14:09:04.270611 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:09:04.271275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bf47bda2-bc9b-4df7-9cb4-cd111d773c9b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe332d0f6e0>]}
[0m14:09:04.521363 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:09:04.527550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf47bda2-bc9b-4df7-9cb4-cd111d773c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe337090fb0>]}
[0m14:09:04.631758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf47bda2-bc9b-4df7-9cb4-cd111d773c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe332c6e2a0>]}
[0m14:09:04.632392 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:09:04.632928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf47bda2-bc9b-4df7-9cb4-cd111d773c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33779fbf0>]}
[0m14:09:04.634982 [info ] [MainThread]: 
[0m14:09:04.635760 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:09:04.640762 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:09:04.676412 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:09:04.676923 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:09:04.677336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:05.315362 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:09:05.317023 [debug] [ThreadPool]: On list_petro: Close
[0m14:09:05.318116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:09:05.318716 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:09:05.326306 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:09:05.326777 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:09:05.327178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:05.328637 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:05.330079 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:09:05.330494 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:09:05.331063 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:05.331473 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:09:05.331841 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:09:05.332441 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:05.333401 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:09:05.333798 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:09:05.334162 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:09:05.334736 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:05.335141 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:09:05.336549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:09:05.342682 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:09:05.343375 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:09:05.343750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:05.344546 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:05.344935 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:09:05.345367 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:09:05.355273 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:05.357020 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:09:05.358360 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:09:05.358766 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:09:05.361051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf47bda2-bc9b-4df7-9cb4-cd111d773c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe331b1ef90>]}
[0m14:09:05.361610 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:05.361991 [debug] [MainThread]: On master: BEGIN
[0m14:09:05.362375 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:09:05.363145 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:05.363580 [debug] [MainThread]: On master: COMMIT
[0m14:09:05.363946 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:05.364329 [debug] [MainThread]: On master: COMMIT
[0m14:09:05.364875 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:05.365297 [debug] [MainThread]: On master: Close
[0m14:09:05.365859 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:09:05.366342 [info ] [MainThread]: 
[0m14:09:05.382418 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:09:05.383099 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:09:05.383834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:09:05.384362 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:09:05.411936 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:09:05.412858 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:09:05.449231 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:09:05.450156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:15.099470 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:15.100009 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:09:15.100784 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:15.101251 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:15.101676 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:09:15.102484 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:15.105733 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:15.106180 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:09:15.106944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:15.123916 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:15.124478 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:15.124900 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:15.127346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:15.133395 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:15.133874 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:09:15.135273 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:15.137804 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:09:15.139427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf47bda2-bc9b-4df7-9cb4-cd111d773c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f8943410>]}
[0m14:09:15.140144 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.75s]
[0m14:09:15.140995 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:09:15.141877 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:09:15.142480 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:09:15.143151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:09:15.143618 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:09:15.148941 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:09:15.149916 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:09:15.187477 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:15.188069 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250806140915181221"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:09:15.188562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:15.196829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:15.205423 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:15.205950 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:09:15.206758 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:15.207213 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:15.207641 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250806140915181221'
      
      
      order by ordinal_position

  
[0m14:09:15.210031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:15.215886 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:15.216431 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:15.219082 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:15.227490 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:15.228038 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:15.231097 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:15.250210 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:09:15.251032 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:15.251523 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250806140915181221"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250806140915181221"
    )
  
[0m14:09:15.299529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:15.301567 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:15.302017 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:15.302456 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:15.309104 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:15.310216 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:09:15.311780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf47bda2-bc9b-4df7-9cb4-cd111d773c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3319b7800>]}
[0m14:09:15.312511 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:09:15.313263 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:09:15.314652 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:15.315059 [debug] [MainThread]: On master: BEGIN
[0m14:09:15.315469 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:15.316334 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:15.316772 [debug] [MainThread]: On master: COMMIT
[0m14:09:15.317270 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:15.317644 [debug] [MainThread]: On master: COMMIT
[0m14:09:15.318180 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:15.318764 [debug] [MainThread]: On master: Close
[0m14:09:15.319757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:15.320131 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:09:15.320599 [info ] [MainThread]: 
[0m14:09:15.321083 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.69 seconds (10.69s).
[0m14:09:15.322078 [debug] [MainThread]: Command end result
[0m14:09:15.350611 [info ] [MainThread]: 
[0m14:09:15.351497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:09:15.352046 [info ] [MainThread]: 
[0m14:09:15.352646 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:09:15.353743 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.735191, "process_user_time": 5.427675, "process_kernel_time": 0.276237, "process_mem_max_rss": "306476", "process_in_blocks": "1200", "process_out_blocks": "100088"}
[0m14:09:15.354346 [debug] [MainThread]: Command `dbt run` succeeded at 14:09:15.354234 after 12.74 seconds
[0m14:09:15.354799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3373055b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33805c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f9292d20>]}
[0m14:09:15.355257 [debug] [MainThread]: Flushing usage events
[0m14:09:17.331338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13f969e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1409763c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13f969d90>]}


============================== 14:09:17.334566 | e6dbc718-f3fa-40df-86e2-4cb668c7c3fa ==============================
[0m14:09:17.334566 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:09:17.335204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:09:17.444855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6dbc718-f3fa-40df-86e2-4cb668c7c3fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13fcbbd70>]}
[0m14:09:17.463162 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18179047, "process_user_time": 1.373242, "process_kernel_time": 0.110858, "process_mem_max_rss": "100624", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:09:17.463743 [debug] [MainThread]: Command `dbt clean` succeeded at 14:09:17.463639 after 0.18 seconds
[0m14:09:17.464180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13fecf0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13f8863f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe143796f60>]}
[0m14:09:17.464647 [debug] [MainThread]: Flushing usage events
[0m22:06:48.011956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c4944800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c6500b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c53ea840>]}


============================== 22:06:48.062407 | fda4055b-6768-4041-941e-a80ce94f0821 ==============================
[0m22:06:48.062407 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:48.063138 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:48.238795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fda4055b-6768-4041-941e-a80ce94f0821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c5908c50>]}
[0m22:06:48.255586 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2mygoec3'
[0m22:06:48.256103 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:48.503416 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:48.504260 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:48.515507 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:48.520105 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:48.571105 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:48.571667 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:48.572283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fda4055b-6768-4041-941e-a80ce94f0821', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c558c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c4737c50>]}
[0m22:06:48.572744 [info ] [MainThread]: 
[0m22:06:48.573275 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:48.580027 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.61823577, "process_user_time": 1.656183, "process_kernel_time": 0.140015, "process_mem_max_rss": "101372", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m22:06:48.580653 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:48.580551 after 0.62 seconds
[0m22:06:48.581133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c57ebe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c4a77290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c5465340>]}
[0m22:06:48.581586 [debug] [MainThread]: Flushing usage events
[0m22:06:50.291188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc928d15af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9294dcc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc92b5592e0>]}


============================== 22:06:50.294579 | 722cd74f-22f0-4ab0-8349-81d00992c418 ==============================
[0m22:06:50.294579 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:50.295242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:50.504379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '722cd74f-22f0-4ab0-8349-81d00992c418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc92cf638f0>]}
[0m22:06:50.564174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '722cd74f-22f0-4ab0-8349-81d00992c418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc92884ec00>]}
[0m22:06:50.566896 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:50.704166 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:50.704994 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:50.705517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '722cd74f-22f0-4ab0-8349-81d00992c418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9286a7b60>]}
[0m22:06:52.002373 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:52.003064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '722cd74f-22f0-4ab0-8349-81d00992c418', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc92440fad0>]}
[0m22:06:52.250523 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:52.256484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '722cd74f-22f0-4ab0-8349-81d00992c418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc928a71df0>]}
[0m22:06:52.361028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '722cd74f-22f0-4ab0-8349-81d00992c418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9243f3c50>]}
[0m22:06:52.361700 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:52.362307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '722cd74f-22f0-4ab0-8349-81d00992c418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9243f3710>]}
[0m22:06:52.364272 [info ] [MainThread]: 
[0m22:06:52.365054 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:52.369917 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:52.407898 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:52.408408 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:52.408803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:52.915647 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:52.917945 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:52.919181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:52.919925 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:52.930218 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:52.930791 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:52.931331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:52.932588 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:52.934227 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:52.934616 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:52.935203 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:52.935580 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:52.935938 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:52.936561 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:52.937492 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:52.937878 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:52.938314 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:52.938848 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:52.939276 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:52.940609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:52.946447 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:52.946844 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:52.947236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:52.947826 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:52.948241 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:52.948616 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:52.958596 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:52.960241 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:52.961532 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:52.961925 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:52.964340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '722cd74f-22f0-4ab0-8349-81d00992c418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc924341ca0>]}
[0m22:06:52.964913 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:52.965325 [debug] [MainThread]: On master: BEGIN
[0m22:06:52.965678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:52.966372 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:52.966827 [debug] [MainThread]: On master: COMMIT
[0m22:06:52.967229 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:52.967585 [debug] [MainThread]: On master: COMMIT
[0m22:06:52.968117 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:52.968504 [debug] [MainThread]: On master: Close
[0m22:06:52.969054 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:52.969534 [info ] [MainThread]: 
[0m22:06:52.993444 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:52.994193 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:52.994926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:52.995420 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:53.022456 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:53.023266 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:53.058406 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:53.059175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:00.756019 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:00.756572 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:00.757285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.757732 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:00.758182 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:00.758950 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.761982 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:00.762445 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:00.763126 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.780004 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:00.780498 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:00.780919 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:00.782960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.788799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:00.789283 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:00.790424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.792851 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:00.794467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722cd74f-22f0-4ab0-8349-81d00992c418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc92a67a450>]}
[0m22:07:00.795192 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.80s]
[0m22:07:00.795951 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:00.796812 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:00.797471 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:00.798148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:00.798598 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:00.803586 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:00.804410 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:00.841179 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:00.841732 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250806220700835027"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:00.842230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:00.850887 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.859399 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:00.859873 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:00.860615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.861108 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:00.861542 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250806220700835027'
      
      
      order by ordinal_position

  
[0m22:07:00.863859 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.869177 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:00.869645 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:00.871749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.879448 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:00.879919 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:00.882673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.901129 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:00.901856 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:00.902338 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250806220700835027"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250806220700835027"
    )
  
[0m22:07:00.954883 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.956967 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:00.957434 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:00.957853 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:00.965369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:00.966348 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:00.967884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722cd74f-22f0-4ab0-8349-81d00992c418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ea5015e0>]}
[0m22:07:00.968594 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:07:00.969345 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:00.971220 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:00.971632 [debug] [MainThread]: On master: BEGIN
[0m22:07:00.971998 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:00.972752 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:00.973189 [debug] [MainThread]: On master: COMMIT
[0m22:07:00.973556 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:00.973909 [debug] [MainThread]: On master: COMMIT
[0m22:07:00.974465 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:00.974853 [debug] [MainThread]: On master: Close
[0m22:07:00.975464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:00.975835 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:00.976280 [info ] [MainThread]: 
[0m22:07:00.976767 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.61 seconds (8.61s).
[0m22:07:00.977734 [debug] [MainThread]: Command end result
[0m22:07:01.004183 [info ] [MainThread]: 
[0m22:07:01.004776 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:01.005273 [info ] [MainThread]: 
[0m22:07:01.005761 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:01.006757 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.765577, "process_user_time": 5.302059, "process_kernel_time": 0.306234, "process_mem_max_rss": "308608", "process_in_blocks": "1200", "process_out_blocks": "100136"}
[0m22:07:01.007347 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:01.007242 after 10.77 seconds
[0m22:07:01.007786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc928a2d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc928cc1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc928dee480>]}
[0m22:07:01.008240 [debug] [MainThread]: Flushing usage events
[0m22:07:02.910782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe5dc833e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe5db24ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe5fe51340>]}


============================== 22:07:02.914266 | aa9c3cfa-2ece-4ecd-946e-cbfbf9c7f84c ==============================
[0m22:07:02.914266 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:02.914935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:07:03.023733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa9c3cfa-2ece-4ecd-946e-cbfbf9c7f84c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe5d2384a0>]}
[0m22:07:03.042703 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18186516, "process_user_time": 1.381308, "process_kernel_time": 0.116941, "process_mem_max_rss": "100516", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:07:03.043321 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:03.043215 after 0.18 seconds
[0m22:07:03.043751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe5d65ce60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe5d2867e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe61196f60>]}
[0m22:07:03.044230 [debug] [MainThread]: Flushing usage events
[0m06:03:09.498838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76463a7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7645ab20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76463a65d0>]}


============================== 06:03:09.516837 | 692c5d5b-bef3-4954-bb09-b8b4098a5f3f ==============================
[0m06:03:09.516837 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:09.517526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:03:09.655752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '692c5d5b-bef3-4954-bb09-b8b4098a5f3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764573b2f0>]}
[0m06:03:09.670924 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-b78e0ato'
[0m06:03:09.671406 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:03:09.784635 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:03:09.785270 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:03:09.809615 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:03:09.813434 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:03:09.884868 [info ] [MainThread]: Installed from version 1.2.0
[0m06:03:09.885427 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:03:09.885968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '692c5d5b-bef3-4954-bb09-b8b4098a5f3f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764560b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764573aae0>]}
[0m06:03:09.886437 [info ] [MainThread]: 
[0m06:03:09.886934 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:03:09.892668 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44310704, "process_user_time": 1.554727, "process_kernel_time": 0.148355, "process_mem_max_rss": "101788", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m06:03:09.893241 [debug] [MainThread]: Command `dbt deps` succeeded at 06:03:09.893101 after 0.44 seconds
[0m06:03:09.893662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76458c9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7645ab20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76456fc3e0>]}
[0m06:03:09.894069 [debug] [MainThread]: Flushing usage events
[0m06:03:11.454386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7591d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f77931400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f759b8b60>]}


============================== 06:03:11.457472 | e3964e9e-8c1b-491b-8cd5-d61f49c1bc1d ==============================
[0m06:03:11.457472 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:11.458095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:11.660688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3964e9e-8c1b-491b-8cd5-d61f49c1bc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f75835550>]}
[0m06:03:11.719038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3964e9e-8c1b-491b-8cd5-d61f49c1bc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f757148c0>]}
[0m06:03:11.721576 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:03:11.779738 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:03:11.780456 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:03:11.780960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e3964e9e-8c1b-491b-8cd5-d61f49c1bc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f71797980>]}
[0m06:03:13.068380 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:03:13.069042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e3964e9e-8c1b-491b-8cd5-d61f49c1bc1d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f775cccb0>]}
[0m06:03:13.294293 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:03:13.299771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3964e9e-8c1b-491b-8cd5-d61f49c1bc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7698c9e0>]}
[0m06:03:13.398411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3964e9e-8c1b-491b-8cd5-d61f49c1bc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f71258a70>]}
[0m06:03:13.398913 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:03:13.399400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3964e9e-8c1b-491b-8cd5-d61f49c1bc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f715322a0>]}
[0m06:03:13.401213 [info ] [MainThread]: 
[0m06:03:13.401877 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:03:13.406545 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:03:13.441246 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:03:13.441678 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:03:13.442060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:13.946595 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:03:13.948226 [debug] [ThreadPool]: On list_petro: Close
[0m06:03:13.949246 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:03:13.949789 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:03:13.957246 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:13.957664 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:03:13.958040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:13.958938 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:13.960265 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:13.960651 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:03:13.961249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:13.961636 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:13.962000 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:03:13.962601 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:13.963534 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:13.963920 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:13.964328 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:13.964850 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:13.965282 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:03:13.966538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:03:13.972190 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:13.972674 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:03:13.973042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:13.973699 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:13.974084 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:13.974484 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:03:13.984274 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:13.985703 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:03:13.986918 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:03:13.987338 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:03:13.989557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3964e9e-8c1b-491b-8cd5-d61f49c1bc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f769c8fb0>]}
[0m06:03:13.990049 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:13.990457 [debug] [MainThread]: On master: BEGIN
[0m06:03:13.990812 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:13.991433 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:13.991824 [debug] [MainThread]: On master: COMMIT
[0m06:03:13.992230 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:13.992588 [debug] [MainThread]: On master: COMMIT
[0m06:03:13.993094 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:13.993499 [debug] [MainThread]: On master: Close
[0m06:03:13.994015 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:03:13.994500 [info ] [MainThread]: 
[0m06:03:14.009687 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:03:14.010283 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:03:14.010910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:03:14.011376 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:03:14.038198 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:03:14.038927 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:03:14.074222 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:03:14.074954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:22.489617 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:22.490102 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:22.491002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:22.492228 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:22.492654 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:22.493417 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:22.496354 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:22.496796 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:22.497471 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:22.514263 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:22.514731 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:22.515173 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:22.516469 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:22.522078 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:22.522566 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:22.523824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:22.526190 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:22.527719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3964e9e-8c1b-491b-8cd5-d61f49c1bc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7756a3f0>]}
[0m06:03:22.528416 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.52s]
[0m06:03:22.529180 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:22.529991 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:22.530750 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:22.531409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:22.531887 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:22.536821 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:22.537493 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:22.574636 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:22.575161 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250807060322568261"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:22.575643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:22.585598 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:22.594397 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:22.594846 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:22.595490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:22.595925 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:22.596375 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250807060322568261'
      
      
      order by ordinal_position

  
[0m06:03:22.599048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:22.604181 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:22.604642 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:22.606683 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:22.614320 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:22.614777 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:22.617445 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:22.635620 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:22.636339 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:22.636794 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250807060322568261"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250807060322568261"
    )
  
[0m06:03:22.688008 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:22.690044 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:22.690512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:22.690923 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:22.698096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:22.699012 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:22.700428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3964e9e-8c1b-491b-8cd5-d61f49c1bc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f700181d0>]}
[0m06:03:22.701102 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:03:22.701892 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:22.703521 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:22.703934 [debug] [MainThread]: On master: BEGIN
[0m06:03:22.704348 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:22.705005 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:22.705433 [debug] [MainThread]: On master: COMMIT
[0m06:03:22.705803 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:22.706201 [debug] [MainThread]: On master: COMMIT
[0m06:03:22.706734 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:22.707118 [debug] [MainThread]: On master: Close
[0m06:03:22.707740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:22.708106 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:22.708576 [info ] [MainThread]: 
[0m06:03:22.709033 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.31 seconds (9.31s).
[0m06:03:22.709942 [debug] [MainThread]: Command end result
[0m06:03:22.735852 [info ] [MainThread]: 
[0m06:03:22.736416 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:22.736865 [info ] [MainThread]: 
[0m06:03:22.737336 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:22.738311 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.332874, "process_user_time": 5.070006, "process_kernel_time": 0.314876, "process_mem_max_rss": "335896", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:03:22.738853 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:22.738752 after 11.33 seconds
[0m06:03:22.739312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f77974f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f3eb8da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f713059d0>]}
[0m06:03:22.739730 [debug] [MainThread]: Flushing usage events
[0m06:03:24.425228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd14a6d3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd14a7ed490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd147c71a30>]}


============================== 06:03:24.428333 | ec5ff2d4-f8f2-420c-8c2e-01a526a7bd84 ==============================
[0m06:03:24.428333 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:24.428964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:24.536153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec5ff2d4-f8f2-420c-8c2e-01a526a7bd84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1489c30b0>]}
[0m06:03:24.553567 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17704445, "process_user_time": 1.341438, "process_kernel_time": 0.103956, "process_mem_max_rss": "100524", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:03:24.554086 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:24.553987 after 0.18 seconds
[0m06:03:24.554540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd148064ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd147bc63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd147a5ddc0>]}
[0m06:03:24.554947 [debug] [MainThread]: Flushing usage events
[0m14:08:29.166212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae773b9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7630bc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae75655fd0>]}


============================== 14:08:29.182365 | 65533da4-3d71-44ef-ae6d-6db020622d7b ==============================
[0m14:08:29.182365 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:08:29.183058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:29.317786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65533da4-3d71-44ef-ae6d-6db020622d7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae75808aa0>]}
[0m14:08:29.333201 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nnzx7nfd'
[0m14:08:29.333677 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:08:29.442403 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:08:29.443176 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:08:29.466059 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:08:29.469847 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:08:29.542276 [info ] [MainThread]: Installed from version 1.2.0
[0m14:08:29.542883 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:08:29.543442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '65533da4-3d71-44ef-ae6d-6db020622d7b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7467d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae74547aa0>]}
[0m14:08:29.543955 [info ] [MainThread]: 
[0m14:08:29.544450 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:08:29.550465 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43408662, "process_user_time": 1.566534, "process_kernel_time": 0.138489, "process_mem_max_rss": "101564", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m14:08:29.551035 [debug] [MainThread]: Command `dbt deps` succeeded at 14:08:29.550930 after 0.43 seconds
[0m14:08:29.551456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae74502960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae747f7500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae74842270>]}
[0m14:08:29.551892 [debug] [MainThread]: Flushing usage events
[0m14:08:31.147159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d52e6f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d6315100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d6292a80>]}


============================== 14:08:31.150361 | 83ea2f1b-5c2b-495e-9c53-1a4d910226ec ==============================
[0m14:08:31.150361 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:08:31.151056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:31.353052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83ea2f1b-5c2b-495e-9c53-1a4d910226ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d532c2c0>]}
[0m14:08:31.412032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83ea2f1b-5c2b-495e-9c53-1a4d910226ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d5177980>]}
[0m14:08:31.414572 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:08:31.442917 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:08:31.443636 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:08:31.444159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '83ea2f1b-5c2b-495e-9c53-1a4d910226ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d5072c60>]}
[0m14:08:32.731651 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:08:32.732297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '83ea2f1b-5c2b-495e-9c53-1a4d910226ec', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d10bef90>]}
[0m14:08:32.968966 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:08:32.974680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83ea2f1b-5c2b-495e-9c53-1a4d910226ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d0f69460>]}
[0m14:08:33.076896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83ea2f1b-5c2b-495e-9c53-1a4d910226ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d0fbb1d0>]}
[0m14:08:33.077459 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:08:33.077945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83ea2f1b-5c2b-495e-9c53-1a4d910226ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d10dbd70>]}
[0m14:08:33.079789 [info ] [MainThread]: 
[0m14:08:33.080481 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:08:33.085196 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:08:33.120316 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:08:33.120850 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:08:33.121252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:33.474160 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:33.475863 [debug] [ThreadPool]: On list_petro: Close
[0m14:08:33.476893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:08:33.477428 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:08:33.485404 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:08:33.485895 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:08:33.486275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:33.487431 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:33.489107 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:08:33.489576 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:08:33.490166 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:33.490541 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:08:33.490949 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:08:33.491564 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:33.492490 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:08:33.492899 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:08:33.493259 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:08:33.493794 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:33.494201 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:08:33.495481 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:08:33.501974 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:08:33.502386 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:08:33.502803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:33.503469 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:33.503899 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:08:33.504268 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:08:33.514107 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:33.515727 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:08:33.516986 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:08:33.517382 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:08:33.519672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83ea2f1b-5c2b-495e-9c53-1a4d910226ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d64d4e90>]}
[0m14:08:33.520181 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:33.520568 [debug] [MainThread]: On master: BEGIN
[0m14:08:33.520973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:33.521654 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:08:33.522052 [debug] [MainThread]: On master: COMMIT
[0m14:08:33.522424 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:33.522831 [debug] [MainThread]: On master: COMMIT
[0m14:08:33.523378 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:08:33.523804 [debug] [MainThread]: On master: Close
[0m14:08:33.524338 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:08:33.524864 [info ] [MainThread]: 
[0m14:08:33.541298 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:08:33.542016 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:08:33.542725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:08:33.543174 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:08:33.570280 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:08:33.571119 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:08:33.607271 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:08:33.608165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:40.758880 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:08:40.759378 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:08:40.760073 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:40.760514 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:08:40.760963 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:08:40.761699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:40.764651 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:08:40.765088 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:08:40.765761 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:40.782336 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:08:40.782807 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:08:40.783220 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:08:40.785708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:40.791302 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:08:40.791767 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:08:40.793081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:40.795399 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:08:40.796943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83ea2f1b-5c2b-495e-9c53-1a4d910226ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d0f79b80>]}
[0m14:08:40.797623 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.25s]
[0m14:08:40.798357 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:08:40.799192 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:08:40.799787 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:08:40.800409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:08:40.801062 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:08:40.805941 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:08:40.806578 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:08:40.842402 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:40.842903 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250807140840836408"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:08:40.843343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:40.851076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:40.858505 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:40.858970 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:08:40.859564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:40.860013 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:40.860428 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250807140840836408'
      
      
      order by ordinal_position

  
[0m14:08:40.862687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:40.867774 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:40.868227 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:08:40.870606 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:40.878108 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:40.878564 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:08:40.880657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:40.898467 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:08:40.899165 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:40.899634 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250807140840836408"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250807140840836408"
    )
  
[0m14:08:40.948292 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:40.950279 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:08:40.950734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:40.951140 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:08:40.957823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:40.958725 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:08:40.960190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83ea2f1b-5c2b-495e-9c53-1a4d910226ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe39e7e9520>]}
[0m14:08:40.960869 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:08:40.961575 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:08:40.963217 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:40.963661 [debug] [MainThread]: On master: BEGIN
[0m14:08:40.964041 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:08:40.964703 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:08:40.965100 [debug] [MainThread]: On master: COMMIT
[0m14:08:40.965464 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:40.965862 [debug] [MainThread]: On master: COMMIT
[0m14:08:40.966378 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:08:40.966812 [debug] [MainThread]: On master: Close
[0m14:08:40.967374 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:40.967764 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:08:40.968156 [info ] [MainThread]: 
[0m14:08:40.968622 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.89 seconds (7.89s).
[0m14:08:40.969503 [debug] [MainThread]: Command end result
[0m14:08:40.994779 [info ] [MainThread]: 
[0m14:08:40.995313 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:08:40.995770 [info ] [MainThread]: 
[0m14:08:40.996223 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:08:40.997121 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.899162, "process_user_time": 4.98859, "process_kernel_time": 0.279033, "process_mem_max_rss": "311984", "process_in_blocks": "1200", "process_out_blocks": "100096"}
[0m14:08:40.997684 [debug] [MainThread]: Command `dbt run` succeeded at 14:08:40.997543 after 9.90 seconds
[0m14:08:40.998115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d540dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d540e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d578a4b0>]}
[0m14:08:40.998530 [debug] [MainThread]: Flushing usage events
[0m14:08:42.684055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b5d60620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b5d606b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b5d60590>]}


============================== 14:08:42.687198 | 030d7a5c-e6cc-4e2e-a33e-7063d631c8f5 ==============================
[0m14:08:42.687198 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:08:42.687836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:42.796539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '030d7a5c-e6cc-4e2e-a33e-7063d631c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b550d730>]}
[0m14:08:42.815495 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18076587, "process_user_time": 1.320333, "process_kernel_time": 0.112942, "process_mem_max_rss": "100712", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:08:42.816116 [debug] [MainThread]: Command `dbt clean` succeeded at 14:08:42.815977 after 0.18 seconds
[0m14:08:42.816626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b5215a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b5e30140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b4eb1fd0>]}
[0m14:08:42.817077 [debug] [MainThread]: Flushing usage events
[0m22:06:55.991095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2906bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a276d33e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2723fb90>]}


============================== 22:06:56.008183 | 31c42de7-1ac2-423c-b088-346de6e9693a ==============================
[0m22:06:56.008183 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:56.008836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:56.147201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31c42de7-1ac2-423c-b088-346de6e9693a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a27067740>]}
[0m22:06:56.162274 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-gfxfucv6'
[0m22:06:56.162766 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:56.275025 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:56.275629 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:56.297972 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:56.301749 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:56.373618 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:56.374119 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:56.374608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '31c42de7-1ac2-423c-b088-346de6e9693a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2723f680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a283eb800>]}
[0m22:06:56.375053 [info ] [MainThread]: 
[0m22:06:56.375517 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:56.380961 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44180793, "process_user_time": 1.581174, "process_kernel_time": 0.141015, "process_mem_max_rss": "101520", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m22:06:56.381487 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:56.381387 after 0.44 seconds
[0m22:06:56.381930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a27ce59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a27b607a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a26f46090>]}
[0m22:06:56.382335 [debug] [MainThread]: Flushing usage events
[0m22:06:58.077851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f82c3440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f8733a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f794c500>]}


============================== 22:06:58.080987 | d5094d0a-71d5-413d-b92f-0b61519b6abd ==============================
[0m22:06:58.080987 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:58.081686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:58.284694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5094d0a-71d5-413d-b92f-0b61519b6abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f955f410>]}
[0m22:06:58.347522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5094d0a-71d5-413d-b92f-0b61519b6abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f95c0fb0>]}
[0m22:06:58.350148 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:58.374847 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:58.375569 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:58.376119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd5094d0a-71d5-413d-b92f-0b61519b6abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f3710350>]}
[0m22:06:59.748397 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:59.749082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd5094d0a-71d5-413d-b92f-0b61519b6abd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f36aa000>]}
[0m22:06:59.988678 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:59.994361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5094d0a-71d5-413d-b92f-0b61519b6abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f34946b0>]}
[0m22:07:00.097800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5094d0a-71d5-413d-b92f-0b61519b6abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f34e4650>]}
[0m22:07:00.098330 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:07:00.098865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5094d0a-71d5-413d-b92f-0b61519b6abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f3550830>]}
[0m22:07:00.100740 [info ] [MainThread]: 
[0m22:07:00.101446 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:07:00.106141 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:07:00.140404 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:07:00.140864 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:07:00.141258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:00.642774 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:07:00.645021 [debug] [ThreadPool]: On list_petro: Close
[0m22:07:00.646321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:07:00.647117 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:07:00.655771 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:00.656187 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:07:00.656563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:00.657582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:00.658908 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:00.659298 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:07:00.659906 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:00.660290 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:00.660671 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:07:00.661247 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:00.662172 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:00.662565 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:00.662966 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:00.663489 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:00.663900 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:07:00.665105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:07:00.670763 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:00.671251 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:07:00.671612 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:00.672221 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:00.672606 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:00.673007 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:07:00.683200 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:00.684627 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:07:00.685879 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:07:00.686272 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:07:00.688468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5094d0a-71d5-413d-b92f-0b61519b6abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f95c1220>]}
[0m22:07:00.689002 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:00.689382 [debug] [MainThread]: On master: BEGIN
[0m22:07:00.689777 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:00.690352 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:00.690765 [debug] [MainThread]: On master: COMMIT
[0m22:07:00.691132 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:00.691484 [debug] [MainThread]: On master: COMMIT
[0m22:07:00.692029 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:00.692411 [debug] [MainThread]: On master: Close
[0m22:07:00.692962 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:07:00.693438 [info ] [MainThread]: 
[0m22:07:00.712224 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:07:00.712831 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:07:00.713450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:07:00.713915 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:07:00.740755 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:07:00.741485 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:07:00.777059 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:07:00.777804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:08.947264 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:08.947785 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:08.948414 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.948889 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:08.949319 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:08.950065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.952961 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:08.953404 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:08.954090 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.970838 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:08.971293 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:08.971728 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:08.973603 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.979248 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:08.979768 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:08.980921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:08.983312 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:08.984918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5094d0a-71d5-413d-b92f-0b61519b6abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0b9320cb0>]}
[0m22:07:08.985621 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.27s]
[0m22:07:08.986492 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:08.987488 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:08.988071 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:08.988716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:08.989151 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:08.994027 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:08.994672 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:09.030591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:09.031091 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250807220709024580"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:09.031547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:09.039248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:09.046578 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:09.047062 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:09.047659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:09.048097 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:09.048521 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250807220709024580'
      
      
      order by ordinal_position

  
[0m22:07:09.051020 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:09.056085 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:09.056541 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:09.058613 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:09.066252 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:09.066749 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:09.069424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:09.087752 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:09.088416 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:09.088893 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250807220709024580"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250807220709024580"
    )
  
[0m22:07:09.136417 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:09.138441 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:09.138909 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:09.139321 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:09.146386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:09.147305 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:09.148876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5094d0a-71d5-413d-b92f-0b61519b6abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0b9370d10>]}
[0m22:07:09.149563 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:07:09.150404 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:09.151990 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:09.152395 [debug] [MainThread]: On master: BEGIN
[0m22:07:09.152807 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:09.153447 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:09.153883 [debug] [MainThread]: On master: COMMIT
[0m22:07:09.154251 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:09.154608 [debug] [MainThread]: On master: COMMIT
[0m22:07:09.155173 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:09.155557 [debug] [MainThread]: On master: Close
[0m22:07:09.156203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:09.156574 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:09.157019 [info ] [MainThread]: 
[0m22:07:09.157532 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.06 seconds (9.06s).
[0m22:07:09.158559 [debug] [MainThread]: Command end result
[0m22:07:09.185112 [info ] [MainThread]: 
[0m22:07:09.185758 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:09.186269 [info ] [MainThread]: 
[0m22:07:09.186800 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:09.187795 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.16193, "process_user_time": 5.314019, "process_kernel_time": 0.255056, "process_mem_max_rss": "311508", "process_in_blocks": "1200", "process_out_blocks": "100136"}
[0m22:07:09.188336 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:09.188234 after 11.16 seconds
[0m22:07:09.188803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0fbdbb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f1f32f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f35e6cc0>]}
[0m22:07:09.189234 [debug] [MainThread]: Flushing usage events
[0m22:07:10.962176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb64a39010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb63f50d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb6432ee10>]}


============================== 22:07:10.965368 | 62699682-10d7-4832-9431-25796f150d96 ==============================
[0m22:07:10.965368 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:10.966081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:07:11.079589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62699682-10d7-4832-9431-25796f150d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb63e3b2f0>]}
[0m22:07:11.097721 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18723586, "process_user_time": 1.38698, "process_kernel_time": 0.100998, "process_mem_max_rss": "100636", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:11.098272 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:11.098164 after 0.19 seconds
[0m22:07:11.098723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb681bb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb63cce3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb64c33260>]}
[0m22:07:11.099159 [debug] [MainThread]: Flushing usage events
[0m06:03:12.392423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91a7bdd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91a7bf800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91a7bdee0>]}


============================== 06:03:12.410914 | aa581690-4a90-4625-a033-1e880d785122 ==============================
[0m06:03:12.410914 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:12.411547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:03:12.619749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa581690-4a90-4625-a033-1e880d785122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91a60df10>]}
[0m06:03:12.635690 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r_zemrjx'
[0m06:03:12.636177 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:03:12.949936 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:03:12.950742 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:03:13.004879 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:03:13.008823 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:03:13.142183 [info ] [MainThread]: Installed from version 1.2.0
[0m06:03:13.142772 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:03:13.143290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'aa581690-4a90-4625-a033-1e880d785122', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91a6b1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91a6b0e60>]}
[0m06:03:13.143793 [info ] [MainThread]: 
[0m06:03:13.144269 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:03:13.157108 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8148473, "process_user_time": 1.615576, "process_kernel_time": 0.137303, "process_mem_max_rss": "101404", "process_in_blocks": "8480", "process_out_blocks": "5168"}
[0m06:03:13.157711 [debug] [MainThread]: Command `dbt deps` succeeded at 06:03:13.157565 after 0.82 seconds
[0m06:03:13.158154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91aa95940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91a5101d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91a8d4860>]}
[0m06:03:13.158568 [debug] [MainThread]: Flushing usage events
[0m06:03:14.934099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1437cfc530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1436bbdc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1436bbd790>]}


============================== 06:03:14.937269 | 3e85c44f-4e89-4e29-98f7-60b9494eded6 ==============================
[0m06:03:14.937269 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:14.937969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:03:15.143231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e85c44f-4e89-4e29-98f7-60b9494eded6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1436c24470>]}
[0m06:03:15.203217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e85c44f-4e89-4e29-98f7-60b9494eded6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14379c0320>]}
[0m06:03:15.206094 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:03:15.240970 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:03:15.241778 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:03:15.242314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3e85c44f-4e89-4e29-98f7-60b9494eded6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1432b9fe00>]}
[0m06:03:16.549920 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:03:16.550616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3e85c44f-4e89-4e29-98f7-60b9494eded6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1432be94f0>]}
[0m06:03:16.794459 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:03:16.800245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e85c44f-4e89-4e29-98f7-60b9494eded6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1436a90500>]}
[0m06:03:16.905783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e85c44f-4e89-4e29-98f7-60b9494eded6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1432679490>]}
[0m06:03:16.906400 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:03:16.906936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e85c44f-4e89-4e29-98f7-60b9494eded6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14326741a0>]}
[0m06:03:16.908938 [info ] [MainThread]: 
[0m06:03:16.909670 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:03:16.914519 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:03:16.950402 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:03:16.950935 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:03:16.951317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:17.419697 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:17.423326 [debug] [ThreadPool]: On list_petro: Close
[0m06:03:17.425241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:03:17.426510 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:03:17.434194 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:17.434621 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:03:17.435026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:17.436222 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:17.437579 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:17.437995 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:03:17.438555 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:17.438975 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:17.439344 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:03:17.439929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:17.440887 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:17.441271 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:17.441649 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:17.442217 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:17.442605 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:03:17.443969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:03:17.449923 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:17.450435 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:03:17.450828 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:17.451479 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:17.451895 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:17.452275 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:03:17.462274 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:17.463860 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:03:17.465176 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:03:17.465564 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:03:17.467996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e85c44f-4e89-4e29-98f7-60b9494eded6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1432689430>]}
[0m06:03:17.468515 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:17.468948 [debug] [MainThread]: On master: BEGIN
[0m06:03:17.469312 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:17.470004 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:17.470397 [debug] [MainThread]: On master: COMMIT
[0m06:03:17.470807 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:17.471164 [debug] [MainThread]: On master: COMMIT
[0m06:03:17.471797 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:17.472191 [debug] [MainThread]: On master: Close
[0m06:03:17.472786 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:03:17.473279 [info ] [MainThread]: 
[0m06:03:17.490863 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:03:17.491509 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:03:17.492252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:03:17.492728 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:03:17.520523 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:03:17.521425 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:03:17.557746 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:03:17.558702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:25.343378 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:25.343965 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:25.344751 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:25.345197 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:25.345613 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:25.346396 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:25.349504 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:25.349997 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:25.350726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:25.367713 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:25.368188 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:25.368622 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:25.377751 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:25.385900 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:25.386382 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:25.442457 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:25.446567 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:25.449294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e85c44f-4e89-4e29-98f7-60b9494eded6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1431424c80>]}
[0m06:03:25.450359 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.96s]
[0m06:03:25.451453 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:25.452794 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:25.453559 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:25.454331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:25.455023 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:25.461301 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:25.462003 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:25.499471 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:25.500053 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250808060325493197"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:25.500506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:25.508828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:25.517001 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:25.517501 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:25.518211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:25.518678 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:25.519185 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250808060325493197'
      
      
      order by ordinal_position

  
[0m06:03:25.521666 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:25.527202 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:25.527725 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:25.530028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:25.538160 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:25.538659 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:25.541075 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:25.560211 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:25.561065 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:25.561563 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250808060325493197"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250808060325493197"
    )
  
[0m06:03:25.619023 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:25.621142 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:25.621650 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:25.622089 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:25.633941 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:25.635054 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:25.636717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e85c44f-4e89-4e29-98f7-60b9494eded6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f867f710>]}
[0m06:03:25.637436 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m06:03:25.638265 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:25.639991 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:25.640416 [debug] [MainThread]: On master: BEGIN
[0m06:03:25.640833 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:25.641514 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:25.641945 [debug] [MainThread]: On master: COMMIT
[0m06:03:25.642323 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:25.642712 [debug] [MainThread]: On master: COMMIT
[0m06:03:25.643242 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:25.643653 [debug] [MainThread]: On master: Close
[0m06:03:25.644234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:25.644606 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:25.645070 [info ] [MainThread]: 
[0m06:03:25.645587 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.74 seconds (8.74s).
[0m06:03:25.646623 [debug] [MainThread]: Command end result
[0m06:03:25.687938 [info ] [MainThread]: 
[0m06:03:25.688759 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:25.689289 [info ] [MainThread]: 
[0m06:03:25.689812 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:25.690854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.806348, "process_user_time": 5.261686, "process_kernel_time": 0.274557, "process_mem_max_rss": "305604", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m06:03:25.691407 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:25.691301 after 10.81 seconds
[0m06:03:25.691881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14326696d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1436bdffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1436c86240>]}
[0m06:03:25.692325 [debug] [MainThread]: Flushing usage events
[0m06:03:28.008549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe07d156ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe07d1567e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe07d154830>]}


============================== 06:03:28.011871 | c8a8e661-77f9-4962-99d7-7fa663193782 ==============================
[0m06:03:28.011871 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:28.012569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:03:28.122040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8a8e661-77f9-4962-99d7-7fa663193782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe07c779a30>]}
[0m06:03:28.142067 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18338224, "process_user_time": 1.364514, "process_kernel_time": 0.116872, "process_mem_max_rss": "100796", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:03:28.142616 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:28.142514 after 0.18 seconds
[0m06:03:28.143083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe07ca41f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe07d8d36b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe07c779a30>]}
[0m06:03:28.143507 [debug] [MainThread]: Flushing usage events
[0m14:07:25.764445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed2886d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed2a9ed400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed28ac3f20>]}


============================== 14:07:25.779616 | d4983fd1-72e9-44ca-8da1-513e95ec6d1d ==============================
[0m14:07:25.779616 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:25.780273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:07:25.927754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4983fd1-72e9-44ca-8da1-513e95ec6d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed27c6b2f0>]}
[0m14:07:25.942548 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-uyd1_unv'
[0m14:07:25.942995 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:07:26.091407 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:07:26.092111 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:07:26.108529 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:07:26.112311 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:07:26.333931 [info ] [MainThread]: Installed from version 1.2.0
[0m14:07:26.334462 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:07:26.334958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd4983fd1-72e9-44ca-8da1-513e95ec6d1d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed28ffc3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed27b3e3f0>]}
[0m14:07:26.335424 [info ] [MainThread]: 
[0m14:07:26.335885 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:07:26.340841 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.62615967, "process_user_time": 1.574985, "process_kernel_time": 0.131499, "process_mem_max_rss": "101536", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m14:07:26.341393 [debug] [MainThread]: Command `dbt deps` succeeded at 14:07:26.341290 after 0.63 seconds
[0m14:07:26.341809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed27e378c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed27e20260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed27e23e30>]}
[0m14:07:26.342255 [debug] [MainThread]: Flushing usage events
[0m14:07:28.083875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44f8094f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44f41ba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44f5bef90>]}


============================== 14:07:28.086952 | 85d888cf-a0b0-4dd7-b2ac-3c6c04902736 ==============================
[0m14:07:28.086952 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:28.087611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:28.289112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85d888cf-a0b0-4dd7-b2ac-3c6c04902736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44f05aab0>]}
[0m14:07:28.348315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85d888cf-a0b0-4dd7-b2ac-3c6c04902736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44f2d5af0>]}
[0m14:07:28.350874 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:07:28.380563 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:07:28.381306 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:07:28.381818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '85d888cf-a0b0-4dd7-b2ac-3c6c04902736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44f0443b0>]}
[0m14:07:29.666733 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:07:29.667351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '85d888cf-a0b0-4dd7-b2ac-3c6c04902736', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44ae4a4b0>]}
[0m14:07:29.895179 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:07:29.900601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85d888cf-a0b0-4dd7-b2ac-3c6c04902736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4503c9e50>]}
[0m14:07:30.003126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85d888cf-a0b0-4dd7-b2ac-3c6c04902736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44aedb680>]}
[0m14:07:30.003672 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:07:30.004161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85d888cf-a0b0-4dd7-b2ac-3c6c04902736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44aecd010>]}
[0m14:07:30.005964 [info ] [MainThread]: 
[0m14:07:30.006656 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:07:30.011304 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:07:30.046080 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:07:30.046534 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:07:30.046917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:30.390541 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:30.392961 [debug] [ThreadPool]: On list_petro: Close
[0m14:07:30.394442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:07:30.395284 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:07:30.407182 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:30.407781 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:07:30.408391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:30.409389 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:30.410728 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:30.411152 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:07:30.411711 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:30.412116 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:30.412495 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:07:30.413056 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:30.413992 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:30.414410 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:30.414773 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:30.415358 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:30.415750 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:07:30.416994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:07:30.422734 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:30.423233 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:07:30.423597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:30.424184 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:30.424566 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:30.424929 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:07:30.434657 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:30.436142 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:07:30.437379 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:07:30.437769 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:07:30.439908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85d888cf-a0b0-4dd7-b2ac-3c6c04902736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44f078e60>]}
[0m14:07:30.440437 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:30.440816 [debug] [MainThread]: On master: BEGIN
[0m14:07:30.441206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:30.441827 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:30.442248 [debug] [MainThread]: On master: COMMIT
[0m14:07:30.442614 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:30.442964 [debug] [MainThread]: On master: COMMIT
[0m14:07:30.443509 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:30.443893 [debug] [MainThread]: On master: Close
[0m14:07:30.444428 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:07:30.444917 [info ] [MainThread]: 
[0m14:07:30.460143 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:07:30.460725 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:07:30.461372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:07:30.461811 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:07:30.488718 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:07:30.489510 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:07:30.525034 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:07:30.525797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:40.370674 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:40.371177 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:07:40.371804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:40.372281 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:40.372703 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:07:40.373416 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:40.376392 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:40.376832 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:07:40.377544 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:40.394134 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:40.394599 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:40.395023 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:40.396330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:40.401969 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:40.402438 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:07:40.403598 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:40.405904 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:07:40.407441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85d888cf-a0b0-4dd7-b2ac-3c6c04902736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe450f62870>]}
[0m14:07:40.408130 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.95s]
[0m14:07:40.408953 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:07:40.409760 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:07:40.410474 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:07:40.411117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:07:40.411565 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:07:40.416432 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:07:40.417052 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:07:40.453030 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:40.453531 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250808140740447018"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:07:40.453984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:40.461534 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:40.468985 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:40.469450 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:07:40.470026 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:40.470479 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:40.470894 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250808140740447018'
      
      
      order by ordinal_position

  
[0m14:07:40.473673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:40.478718 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:40.479190 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:40.481315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:40.488938 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:40.489409 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:40.491386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:40.509481 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:07:40.510146 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:40.510602 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250808140740447018"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250808140740447018"
    )
  
[0m14:07:40.559279 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:40.561271 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:40.561714 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:40.562152 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:40.569293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:40.570204 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:07:40.571675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85d888cf-a0b0-4dd7-b2ac-3c6c04902736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe410db8ad0>]}
[0m14:07:40.572366 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:07:40.573081 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:07:40.574674 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:40.575112 [debug] [MainThread]: On master: BEGIN
[0m14:07:40.575500 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:40.576141 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:40.576561 [debug] [MainThread]: On master: COMMIT
[0m14:07:40.576927 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:40.577346 [debug] [MainThread]: On master: COMMIT
[0m14:07:40.577871 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:40.578304 [debug] [MainThread]: On master: Close
[0m14:07:40.578902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:40.579295 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:07:40.579697 [info ] [MainThread]: 
[0m14:07:40.580226 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.57 seconds (10.57s).
[0m14:07:40.581267 [debug] [MainThread]: Command end result
[0m14:07:40.606852 [info ] [MainThread]: 
[0m14:07:40.607457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:40.607965 [info ] [MainThread]: 
[0m14:07:40.608503 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:07:40.609477 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.574663, "process_user_time": 4.926042, "process_kernel_time": 0.303694, "process_mem_max_rss": "307532", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m14:07:40.610011 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:40.609909 after 12.58 seconds
[0m14:07:40.610468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44f84d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe451d20d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44f666150>]}
[0m14:07:40.610890 [debug] [MainThread]: Flushing usage events
[0m14:07:42.549751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856796ee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8566c806e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8566c12a80>]}


============================== 14:07:42.552772 | 33439200-4456-42f9-98c6-6b3828808adb ==============================
[0m14:07:42.552772 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:42.553424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:07:42.660501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33439200-4456-42f9-98c6-6b3828808adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8566845a00>]}
[0m14:07:42.677745 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17699516, "process_user_time": 1.336894, "process_kernel_time": 0.108909, "process_mem_max_rss": "100556", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:07:42.678280 [debug] [MainThread]: Command `dbt clean` succeeded at 14:07:42.678172 after 0.18 seconds
[0m14:07:42.678683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8566983d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856668b080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8566688c20>]}
[0m14:07:42.679081 [debug] [MainThread]: Flushing usage events
[0m22:06:28.792641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37ce006e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37f5cd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37ca2de50>]}


============================== 22:06:28.808486 | 420be068-7b13-4dd9-99ca-9fa85ae389c4 ==============================
[0m22:06:28.808486 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:28.809171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:28.947182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '420be068-7b13-4dd9-99ca-9fa85ae389c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37dba9580>]}
[0m22:06:28.961616 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vekye82o'
[0m22:06:28.962055 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:29.008768 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:29.009397 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:29.020586 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:29.024348 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:29.252165 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:29.252729 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:29.253283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '420be068-7b13-4dd9-99ca-9fa85ae389c4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37ce21220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37c777ad0>]}
[0m22:06:29.253747 [info ] [MainThread]: 
[0m22:06:29.254341 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:29.259423 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.51682913, "process_user_time": 1.564367, "process_kernel_time": 0.14794, "process_mem_max_rss": "101328", "process_in_blocks": "8480", "process_out_blocks": "5176"}
[0m22:06:29.259980 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:29.259875 after 0.52 seconds
[0m22:06:29.260392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37ca770b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff380fbb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37dba9580>]}
[0m22:06:29.260817 [debug] [MainThread]: Flushing usage events
[0m22:06:31.179857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f403b4ed610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40394e05f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f403aa3d6d0>]}


============================== 22:06:31.182953 | 26385df6-88f2-454d-a0cd-3decd6dccc47 ==============================
[0m22:06:31.182953 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:31.183563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:31.386248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26385df6-88f2-454d-a0cd-3decd6dccc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4038a01f70>]}
[0m22:06:31.445170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26385df6-88f2-454d-a0cd-3decd6dccc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4039addf10>]}
[0m22:06:31.447733 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:31.484543 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:31.485247 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:31.485774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '26385df6-88f2-454d-a0cd-3decd6dccc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40386bfb30>]}
[0m22:06:32.774154 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:32.774779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '26385df6-88f2-454d-a0cd-3decd6dccc47', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4034524080>]}
[0m22:06:33.010822 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:33.016119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26385df6-88f2-454d-a0cd-3decd6dccc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4034524080>]}
[0m22:06:33.112885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26385df6-88f2-454d-a0cd-3decd6dccc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4034561c10>]}
[0m22:06:33.113374 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:33.113878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26385df6-88f2-454d-a0cd-3decd6dccc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40345fb170>]}
[0m22:06:33.115650 [info ] [MainThread]: 
[0m22:06:33.116306 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:33.120941 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:33.155181 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:33.155624 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:33.156009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:33.717500 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:33.719132 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:33.720057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:33.720630 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:33.728189 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:33.728647 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:33.729042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:33.729960 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:33.731286 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:33.731693 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:33.732274 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:33.732693 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:33.733061 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:33.733654 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:33.734557 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:33.734964 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:33.735327 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:33.735868 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:33.736260 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:33.737506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:33.743361 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:33.743783 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:33.744146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:33.744774 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:33.745164 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:33.745540 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:33.755096 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:33.756533 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:33.757894 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:33.758295 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:33.760466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26385df6-88f2-454d-a0cd-3decd6dccc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40345cb6b0>]}
[0m22:06:33.761019 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:33.761394 [debug] [MainThread]: On master: BEGIN
[0m22:06:33.761789 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:33.762385 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:33.762813 [debug] [MainThread]: On master: COMMIT
[0m22:06:33.763181 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:33.763531 [debug] [MainThread]: On master: COMMIT
[0m22:06:33.764075 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:33.764454 [debug] [MainThread]: On master: Close
[0m22:06:33.765121 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:33.765633 [info ] [MainThread]: 
[0m22:06:33.781699 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:33.782273 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:33.782911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:33.783345 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:33.810049 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:33.810790 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:33.846133 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:33.846891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:43.140855 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:43.141336 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:43.141999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:43.142434 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:43.142888 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:43.143565 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:43.146429 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:43.146891 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:43.147551 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:43.164276 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:43.164750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:43.165166 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:43.166844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:43.172477 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:43.172943 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:43.173982 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:43.176332 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:43.177872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26385df6-88f2-454d-a0cd-3decd6dccc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f403a67e420>]}
[0m22:06:43.178549 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.39s]
[0m22:06:43.179452 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:43.180470 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:43.181052 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:43.181704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:43.182150 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:43.187066 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:43.187702 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:43.223548 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:43.224056 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250808220643217507"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:43.224507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:43.232108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:43.239464 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:43.239932 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:43.240518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:43.240972 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:43.241393 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250808220643217507'
      
      
      order by ordinal_position

  
[0m22:06:43.243777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:43.248823 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:43.249280 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:43.251355 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:43.258931 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:43.259385 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:43.262353 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:43.280397 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:43.281091 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:43.281537 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250808220643217507"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250808220643217507"
    )
  
[0m22:06:43.332712 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:43.334690 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:43.335130 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:43.335539 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:43.342018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:43.342930 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:43.344420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26385df6-88f2-454d-a0cd-3decd6dccc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4033002f90>]}
[0m22:06:43.345117 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:06:43.345932 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:43.347295 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:43.347756 [debug] [MainThread]: On master: BEGIN
[0m22:06:43.348142 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:43.348801 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:43.349196 [debug] [MainThread]: On master: COMMIT
[0m22:06:43.349562 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:43.349965 [debug] [MainThread]: On master: COMMIT
[0m22:06:43.350483 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:43.350909 [debug] [MainThread]: On master: Close
[0m22:06:43.351496 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:43.351902 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:43.352297 [info ] [MainThread]: 
[0m22:06:43.352788 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m22:06:43.353716 [debug] [MainThread]: Command end result
[0m22:06:43.379114 [info ] [MainThread]: 
[0m22:06:43.379679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:43.380142 [info ] [MainThread]: 
[0m22:06:43.380624 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:43.381525 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.251058, "process_user_time": 4.639696, "process_kernel_time": 0.273512, "process_mem_max_rss": "308916", "process_in_blocks": "1200", "process_out_blocks": "100136"}
[0m22:06:43.382095 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:43.381991 after 12.25 seconds
[0m22:06:43.382521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4038a535c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4038fd9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40389835f0>]}
[0m22:06:43.382964 [debug] [MainThread]: Flushing usage events
[0m22:06:45.308775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3deb9202f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dec2baed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dec2bb1d0>]}


============================== 22:06:45.311820 | cc5434b5-18c0-480f-8193-703b6c2ac671 ==============================
[0m22:06:45.311820 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:45.312455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:45.420771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc5434b5-18c0-480f-8193-703b6c2ac671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3deb6c81d0>]}
[0m22:06:45.438099 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17897367, "process_user_time": 1.329648, "process_kernel_time": 0.105971, "process_mem_max_rss": "100624", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:45.438637 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:45.438511 after 0.18 seconds
[0m22:06:45.439050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dec2f7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3deb8800b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3deb75a060>]}
[0m22:06:45.439465 [debug] [MainThread]: Flushing usage events
[0m06:02:14.171680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa138cefe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa13a9011c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa139866090>]}


============================== 06:02:14.186255 | 4fdae674-e467-4961-852c-e1a38f01d71c ==============================
[0m06:02:14.186255 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.186890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.316074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fdae674-e467-4961-852c-e1a38f01d71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa139d08bc0>]}
[0m06:02:14.331413 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ecl2ek7b'
[0m06:02:14.331885 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:14.470640 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:14.471362 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:14.503399 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:14.507307 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:14.841887 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:14.842496 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:14.843030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4fdae674-e467-4961-852c-e1a38f01d71c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa138a80440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa139867bc0>]}
[0m06:02:14.843518 [info ] [MainThread]: 
[0m06:02:14.843993 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:14.852250 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7299936, "process_user_time": 1.582314, "process_kernel_time": 0.13938, "process_mem_max_rss": "101872", "process_in_blocks": "8504", "process_out_blocks": "5168"}
[0m06:02:14.852807 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:14.852702 after 0.73 seconds
[0m06:02:14.853254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1391878c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa13998c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa138b3bf80>]}
[0m06:02:14.853685 [debug] [MainThread]: Flushing usage events
[0m06:02:16.668360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9ef74830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9ee9cc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9ec57320>]}


============================== 06:02:16.671633 | 20341a67-2c90-4aee-9702-3bd09e7acec1 ==============================
[0m06:02:16.671633 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:16.672339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:16.878995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20341a67-2c90-4aee-9702-3bd09e7acec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9e833680>]}
[0m06:02:16.937732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20341a67-2c90-4aee-9702-3bd09e7acec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9ea0e3f0>]}
[0m06:02:16.940458 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:16.998302 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:16.999004 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:16.999531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '20341a67-2c90-4aee-9702-3bd09e7acec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9e956ff0>]}
[0m06:02:18.279643 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:18.280346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '20341a67-2c90-4aee-9702-3bd09e7acec1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9eb21550>]}
[0m06:02:18.523037 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:18.528471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20341a67-2c90-4aee-9702-3bd09e7acec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa2d01cd0>]}
[0m06:02:18.617523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20341a67-2c90-4aee-9702-3bd09e7acec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a75f590>]}
[0m06:02:18.618065 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:18.618566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20341a67-2c90-4aee-9702-3bd09e7acec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a7fe5d0>]}
[0m06:02:18.620402 [info ] [MainThread]: 
[0m06:02:18.621115 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:18.625751 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:18.661510 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:18.661939 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:18.662347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:19.198562 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:19.200169 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:19.201083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:19.201760 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:19.210538 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.211011 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:19.211550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:19.212848 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.214262 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.214656 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:19.215246 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.215616 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.215969 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:19.216553 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.217485 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:19.217893 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.218428 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:19.218972 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.219385 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:19.220600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:19.226222 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:19.226693 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:19.227040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:19.227641 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.228070 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:19.228467 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:19.238532 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.239945 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:19.241150 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:19.241558 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:19.243738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20341a67-2c90-4aee-9702-3bd09e7acec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a7cd730>]}
[0m06:02:19.244266 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.244659 [debug] [MainThread]: On master: BEGIN
[0m06:02:19.245011 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:19.245628 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.246029 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.246418 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.246774 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.247298 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.247681 [debug] [MainThread]: On master: Close
[0m06:02:19.248192 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:19.248699 [info ] [MainThread]: 
[0m06:02:19.265031 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:19.265661 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:19.266261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:19.266700 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:19.304291 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:19.305533 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:19.343637 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:19.344494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:28.669007 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.669533 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:28.670176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.670639 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.671049 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:28.671793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.674701 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.675137 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:28.675823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.692568 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:28.693019 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.693462 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:28.694902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.700541 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.700988 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:28.702124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.704471 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:28.706029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20341a67-2c90-4aee-9702-3bd09e7acec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a60506de0>]}
[0m06:02:28.706732 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.44s]
[0m06:02:28.707485 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:28.708448 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:28.708986 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:28.709590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:28.710016 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:28.714896 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:28.715570 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:28.752496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.753061 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250809060228746257"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:28.753540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:28.761663 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.769525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.769984 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:28.770645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.771075 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.771532 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250809060228746257'
      
      
      order by ordinal_position

  
[0m06:02:28.773641 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.778760 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.779224 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:28.781560 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.789152 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.789625 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:28.791746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.809828 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:28.810537 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.810977 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250809060228746257"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250809060228746257"
    )
  
[0m06:02:28.859102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.861163 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:28.861623 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.862030 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:28.869439 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.870418 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:28.871968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20341a67-2c90-4aee-9702-3bd09e7acec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a992d33e0>]}
[0m06:02:28.872662 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:28.873404 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:28.874748 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:28.875147 [debug] [MainThread]: On master: BEGIN
[0m06:02:28.875554 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:28.876242 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:28.876639 [debug] [MainThread]: On master: COMMIT
[0m06:02:28.877002 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:28.877391 [debug] [MainThread]: On master: COMMIT
[0m06:02:28.877936 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:28.878354 [debug] [MainThread]: On master: Close
[0m06:02:28.878937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:28.879343 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:28.879738 [info ] [MainThread]: 
[0m06:02:28.880180 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.26 seconds (10.26s).
[0m06:02:28.881126 [debug] [MainThread]: Command end result
[0m06:02:28.907333 [info ] [MainThread]: 
[0m06:02:28.907913 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:28.908384 [info ] [MainThread]: 
[0m06:02:28.908833 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:28.909757 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.290485, "process_user_time": 5.188121, "process_kernel_time": 0.272689, "process_mem_max_rss": "310476", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:28.910321 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:28.910180 after 12.29 seconds
[0m06:02:28.910755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9f403da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a895460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a91fcd760>]}
[0m06:02:28.911190 [debug] [MainThread]: Flushing usage events
[0m06:02:30.882931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f580c02d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f580a239160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f580a9b7c80>]}


============================== 06:02:30.885978 | f72f1229-1bae-492e-8b8e-246ff7e445da ==============================
[0m06:02:30.885978 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:30.886624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:30.998653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f72f1229-1bae-492e-8b8e-246ff7e445da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f580bc67290>]}
[0m06:02:31.016162 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18217783, "process_user_time": 1.316686, "process_kernel_time": 0.119971, "process_mem_max_rss": "100568", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:31.016704 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:31.016604 after 0.18 seconds
[0m06:02:31.017119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f580a3df0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f580bc67290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5809dbc7d0>]}
[0m06:02:31.017554 [debug] [MainThread]: Flushing usage events
[0m14:05:17.156134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8cfb9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8d4067e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8d407470>]}


============================== 14:05:17.221817 | 5f2543a2-f5ee-4610-b19f-deeeb648ace4 ==============================
[0m14:05:17.221817 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:17.222492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:17.338626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f2543a2-f5ee-4610-b19f-deeeb648ace4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8cde7da0>]}
[0m14:05:17.353603 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0g_61ypi'
[0m14:05:17.354089 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:17.528104 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:17.528821 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:17.542324 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:17.546238 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:17.681718 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:17.682313 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:17.682826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5f2543a2-f5ee-4610-b19f-deeeb648ace4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8cf5f440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8cdd51f0>]}
[0m14:05:17.683306 [info ] [MainThread]: 
[0m14:05:17.683782 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:17.691541 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5846087, "process_user_time": 1.574282, "process_kernel_time": 0.150644, "process_mem_max_rss": "101592", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m14:05:17.692124 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:17.692012 after 0.59 seconds
[0m14:05:17.692546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8cf78800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8ce0a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8ce095b0>]}
[0m14:05:17.692980 [debug] [MainThread]: Flushing usage events
[0m14:05:19.307808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09ab01b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09ab74fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09ab74d100>]}


============================== 14:05:19.310953 | b904033e-4ab6-457d-8084-e0da4f58fd82 ==============================
[0m14:05:19.310953 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:19.311586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:19.518546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b904033e-4ab6-457d-8084-e0da4f58fd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09aac44da0>]}
[0m14:05:19.577595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b904033e-4ab6-457d-8084-e0da4f58fd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09aebaae70>]}
[0m14:05:19.580270 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:05:19.608037 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:19.608777 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:19.609298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b904033e-4ab6-457d-8084-e0da4f58fd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09a6daa1b0>]}
[0m14:05:20.880450 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:20.881114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b904033e-4ab6-457d-8084-e0da4f58fd82', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09a6ab4830>]}
[0m14:05:21.120684 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:21.126148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b904033e-4ab6-457d-8084-e0da4f58fd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09abfc8410>]}
[0m14:05:21.229091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b904033e-4ab6-457d-8084-e0da4f58fd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09a6a26ba0>]}
[0m14:05:21.229649 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:05:21.230128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b904033e-4ab6-457d-8084-e0da4f58fd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09a6a4ccb0>]}
[0m14:05:21.231956 [info ] [MainThread]: 
[0m14:05:21.232641 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:21.237334 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:21.272742 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:21.273264 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:21.273676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:21.627410 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.629356 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:21.630514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:21.631198 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:21.639892 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.640357 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:21.640735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:21.641909 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.643246 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.643633 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:21.644264 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.644650 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.645055 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:21.645656 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.646591 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:21.647001 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.647363 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:21.647980 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.648440 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:21.649791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:21.655636 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:21.656153 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:21.656511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:21.657145 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.657527 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:21.657915 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:21.667588 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.669132 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:21.670402 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:21.670804 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:21.673238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b904033e-4ab6-457d-8084-e0da4f58fd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09a6a3c2f0>]}
[0m14:05:21.673741 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.674154 [debug] [MainThread]: On master: BEGIN
[0m14:05:21.674515 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:21.675205 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.675606 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.676007 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.676371 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.676908 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.677305 [debug] [MainThread]: On master: Close
[0m14:05:21.677833 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:21.678349 [info ] [MainThread]: 
[0m14:05:21.719074 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:21.719707 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:21.720378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:21.720813 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:21.747768 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:21.748612 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:21.784591 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:21.785432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:29.971648 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:29.972203 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:29.972892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:29.973331 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:29.973740 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:29.974480 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:29.977401 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:29.977838 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:29.978561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:29.995247 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:29.995732 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:29.996207 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:29.997420 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.003171 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.003623 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:05:30.004850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.007254 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:30.008793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b904033e-4ab6-457d-8084-e0da4f58fd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09a6ad1b80>]}
[0m14:05:30.009494 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.29s]
[0m14:05:30.010278 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:30.011314 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:30.011888 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:30.012552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:30.013007 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:30.017889 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:30.018542 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:30.054640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.055187 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250809140530048518"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:30.055641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:30.063902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.071630 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.072112 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:30.072802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.073267 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.073687 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250809140530048518'
      
      
      order by ordinal_position

  
[0m14:05:30.075806 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.081066 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.081516 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.084373 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.091953 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.092411 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.094576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.112833 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:30.113551 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.114022 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250809140530048518"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250809140530048518"
    )
  
[0m14:05:30.161849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.163944 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.164430 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.164849 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.172292 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.173245 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:30.175016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b904033e-4ab6-457d-8084-e0da4f58fd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096c6b7950>]}
[0m14:05:30.175731 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:05:30.176529 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:30.178081 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:30.178489 [debug] [MainThread]: On master: BEGIN
[0m14:05:30.178852 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:30.179551 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:30.179988 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.180360 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:30.180715 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.181297 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:30.181687 [debug] [MainThread]: On master: Close
[0m14:05:30.182337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:30.182702 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:30.183124 [info ] [MainThread]: 
[0m14:05:30.183585 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.95 seconds (8.95s).
[0m14:05:30.184529 [debug] [MainThread]: Command end result
[0m14:05:30.210531 [info ] [MainThread]: 
[0m14:05:30.211121 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:30.211577 [info ] [MainThread]: 
[0m14:05:30.212090 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:30.213056 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.954295, "process_user_time": 4.991785, "process_kernel_time": 0.276264, "process_mem_max_rss": "343340", "process_in_blocks": "1200", "process_out_blocks": "100096"}
[0m14:05:30.213596 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:30.213491 after 10.95 seconds
[0m14:05:30.214071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09ab4070b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096c72f6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096d7c9760>]}
[0m14:05:30.214500 [debug] [MainThread]: Flushing usage events
[0m14:05:32.096642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1acd3b8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1accf5ba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1acd3b83e0>]}


============================== 14:05:32.099714 | 0a44105e-d8e2-4dfd-9d9e-d93d654d2c2f ==============================
[0m14:05:32.099714 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:32.100351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:32.212498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a44105e-d8e2-4dfd-9d9e-d93d654d2c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1acc9632f0>]}
[0m14:05:32.230204 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18260202, "process_user_time": 1.363873, "process_kernel_time": 0.102915, "process_mem_max_rss": "100544", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:32.230738 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:32.230636 after 0.18 seconds
[0m14:05:32.231183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1acca655b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1acc936f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1acc963c50>]}
[0m14:05:32.231599 [debug] [MainThread]: Flushing usage events
[0m22:06:25.616266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0715e67e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe073749490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0715e5400>]}


============================== 22:06:25.633105 | 3351e35a-b57c-4330-ab26-2475534f61bb ==============================
[0m22:06:25.633105 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:25.633814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:25.764576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3351e35a-b57c-4330-ab26-2475534f61bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0709a7fe0>]}
[0m22:06:25.780826 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tp65_ex1'
[0m22:06:25.781356 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:25.798572 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:25.799406 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:25.816375 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:25.820597 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:26.030596 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:26.031261 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:26.031896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3351e35a-b57c-4330-ab26-2475534f61bb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe07195e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe07100d400>]}
[0m22:06:26.032364 [info ] [MainThread]: 
[0m22:06:26.032894 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:26.068268 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.50336146, "process_user_time": 1.655291, "process_kernel_time": 0.156405, "process_mem_max_rss": "101352", "process_in_blocks": "8496", "process_out_blocks": "5168"}
[0m22:06:26.069114 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:26.068998 after 0.50 seconds
[0m22:06:26.069601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0715e5ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0708e8800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe070a0aa80>]}
[0m22:06:26.070102 [debug] [MainThread]: Flushing usage events
[0m22:06:28.015079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d60703b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d6f59bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d6ab4260>]}


============================== 22:06:28.018278 | 54e3f7cd-ed73-4986-b44c-2c71aaee25f1 ==============================
[0m22:06:28.018278 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:28.018983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:28.232181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54e3f7cd-ed73-4986-b44c-2c71aaee25f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d64acf50>]}
[0m22:06:28.293109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54e3f7cd-ed73-4986-b44c-2c71aaee25f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d6a4c1d0>]}
[0m22:06:28.295896 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:28.355832 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:28.356612 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:28.357164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '54e3f7cd-ed73-4986-b44c-2c71aaee25f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d1f775c0>]}
[0m22:06:29.707819 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:29.708452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '54e3f7cd-ed73-4986-b44c-2c71aaee25f1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d1e68fe0>]}
[0m22:06:29.974393 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:29.980459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54e3f7cd-ed73-4986-b44c-2c71aaee25f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d643a510>]}
[0m22:06:30.143944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54e3f7cd-ed73-4986-b44c-2c71aaee25f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d1cb7860>]}
[0m22:06:30.144547 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:30.145078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54e3f7cd-ed73-4986-b44c-2c71aaee25f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d1c43440>]}
[0m22:06:30.147082 [info ] [MainThread]: 
[0m22:06:30.147844 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:30.152941 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:30.189062 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:30.189594 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:30.190034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:30.640455 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.642635 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:30.644022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:30.644789 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:30.652890 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:30.653323 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:30.653737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:30.655025 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.656432 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:30.656840 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:30.657514 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.657943 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:30.658315 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:30.658929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.659885 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:30.660298 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:30.660684 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:30.661292 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.661709 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:30.663089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:30.669398 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:30.669864 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:30.670231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:30.670906 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.671298 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:30.671705 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:30.681756 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.683350 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:30.684644 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:30.685091 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:30.687514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54e3f7cd-ed73-4986-b44c-2c71aaee25f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d1c4eab0>]}
[0m22:06:30.688098 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:30.688481 [debug] [MainThread]: On master: BEGIN
[0m22:06:30.688863 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:30.689541 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:30.689980 [debug] [MainThread]: On master: COMMIT
[0m22:06:30.690350 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:30.690743 [debug] [MainThread]: On master: COMMIT
[0m22:06:30.691275 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:30.691683 [debug] [MainThread]: On master: Close
[0m22:06:30.692226 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:30.692750 [info ] [MainThread]: 
[0m22:06:30.733685 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:30.734367 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:30.735085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:30.735534 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:30.763242 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:30.764132 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:30.800465 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:30.801418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:41.219574 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:41.220141 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:41.220932 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.221379 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:41.221845 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:41.222623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.225808 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:41.226256 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:41.226962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.244514 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:41.245076 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:41.245503 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:41.246994 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.253134 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:41.253607 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:41.255137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.257686 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:41.259311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54e3f7cd-ed73-4986-b44c-2c71aaee25f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa59396a690>]}
[0m22:06:41.260058 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.52s]
[0m22:06:41.260846 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:41.261745 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:41.262437 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:41.263199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:41.263744 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:41.269064 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:41.269788 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:41.308442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:41.309046 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250809220641301914"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:41.309499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:41.318372 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.326916 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:41.327424 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:41.328169 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.328613 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:41.329079 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250809220641301914'
      
      
      order by ordinal_position

  
[0m22:06:41.331436 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.337092 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:41.337572 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:41.340781 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.348970 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:41.349445 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:41.351962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.370704 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:41.371506 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:41.371989 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250809220641301914"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250809220641301914"
    )
  
[0m22:06:41.424377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.426422 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:41.426899 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:41.427324 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:41.434982 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.436064 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:41.437750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54e3f7cd-ed73-4986-b44c-2c71aaee25f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5981309b0>]}
[0m22:06:41.438452 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:06:41.439209 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:41.440587 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:41.441039 [debug] [MainThread]: On master: BEGIN
[0m22:06:41.441411 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:41.442166 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:41.442568 [debug] [MainThread]: On master: COMMIT
[0m22:06:41.442989 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:41.443350 [debug] [MainThread]: On master: COMMIT
[0m22:06:41.443925 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:41.444320 [debug] [MainThread]: On master: Close
[0m22:06:41.444956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:41.445339 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:41.445786 [info ] [MainThread]: 
[0m22:06:41.446267 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.30 seconds (11.30s).
[0m22:06:41.447250 [debug] [MainThread]: Command end result
[0m22:06:41.474327 [info ] [MainThread]: 
[0m22:06:41.475021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:41.475516 [info ] [MainThread]: 
[0m22:06:41.476033 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:41.477109 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.512593, "process_user_time": 5.336331, "process_kernel_time": 0.306536, "process_mem_max_rss": "310376", "process_in_blocks": "1200", "process_out_blocks": "100136"}
[0m22:06:41.477701 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:41.477568 after 13.51 seconds
[0m22:06:41.478158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d64ac860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d1c20710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d01bba70>]}
[0m22:06:41.478589 [debug] [MainThread]: Flushing usage events
[0m22:06:43.648333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68814b9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687e8d1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687e8d1b20>]}


============================== 22:06:43.651717 | 9f18afe6-9e34-4adf-bcec-6724de767fe8 ==============================
[0m22:06:43.651717 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:43.652379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:43.768151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f18afe6-9e34-4adf-bcec-6724de767fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687e805b50>]}
[0m22:06:43.786530 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19010493, "process_user_time": 1.407119, "process_kernel_time": 0.113928, "process_mem_max_rss": "100660", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:43.787107 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:43.787002 after 0.19 seconds
[0m22:06:43.787542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687e70e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687f353b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687eccd1f0>]}
[0m22:06:43.787997 [debug] [MainThread]: Flushing usage events
[0m06:02:18.890746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c9d55af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c9d08ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c969f650>]}


============================== 06:02:18.898707 | a6e82927-5e15-44da-bbd4-be437e70b878 ==============================
[0m06:02:18.898707 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:18.899364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:19.039296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6e82927-5e15-44da-bbd4-be437e70b878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ca24a330>]}
[0m06:02:19.054277 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-67p3g7tm'
[0m06:02:19.054719 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:19.267087 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:19.267815 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:19.324949 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:19.328793 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:19.462780 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:19.463377 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:19.463895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a6e82927-5e15-44da-bbd4-be437e70b878', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c91f8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c948fb90>]}
[0m06:02:19.464372 [info ] [MainThread]: 
[0m06:02:19.464847 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:19.474954 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.633485, "process_user_time": 1.566589, "process_kernel_time": 0.134911, "process_mem_max_rss": "101484", "process_in_blocks": "8512", "process_out_blocks": "5176"}
[0m06:02:19.475520 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:19.475418 after 0.63 seconds
[0m06:02:19.475939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c9d55af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ca24a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c98ab770>]}
[0m06:02:19.476388 [debug] [MainThread]: Flushing usage events
[0m06:02:21.170690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b237a4c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b2429eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b23b78b00>]}


============================== 06:02:21.173747 | a3a3c7ee-0c56-4581-8ae4-5fdd62a14951 ==============================
[0m06:02:21.173747 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:21.174429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:21.381222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3a3c7ee-0c56-4581-8ae4-5fdd62a14951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b23b79160>]}
[0m06:02:21.440918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3a3c7ee-0c56-4581-8ae4-5fdd62a14951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b236e2c30>]}
[0m06:02:21.443524 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:21.486214 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:21.486906 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:21.487453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a3a3c7ee-0c56-4581-8ae4-5fdd62a14951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b2346fe00>]}
[0m06:02:22.771864 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:22.772572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a3a3c7ee-0c56-4581-8ae4-5fdd62a14951', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b237418e0>]}
[0m06:02:23.015337 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:23.020851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3a3c7ee-0c56-4581-8ae4-5fdd62a14951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b253177a0>]}
[0m06:02:23.112944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3a3c7ee-0c56-4581-8ae4-5fdd62a14951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1f360770>]}
[0m06:02:23.113511 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:23.114009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3a3c7ee-0c56-4581-8ae4-5fdd62a14951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1f3bf3b0>]}
[0m06:02:23.116105 [info ] [MainThread]: 
[0m06:02:23.117160 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:23.123276 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:23.157905 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:23.158372 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:23.158771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:23.625030 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.627046 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:23.628267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:23.628939 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:23.637632 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:23.638234 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:23.638797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:23.639870 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.641449 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:23.641926 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:23.642641 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.643024 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:23.643442 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:23.644058 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.645231 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:23.645754 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:23.646204 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:23.646790 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.647226 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:23.648532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:23.654455 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:23.654865 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:23.655251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:23.655852 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.656279 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:23.656654 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:23.666063 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.667524 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:23.668754 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:23.669169 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:23.671480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3a3c7ee-0c56-4581-8ae4-5fdd62a14951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1f3b04a0>]}
[0m06:02:23.671967 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.672394 [debug] [MainThread]: On master: BEGIN
[0m06:02:23.672759 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:23.673373 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.673766 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.674156 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.674519 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.675076 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.675494 [debug] [MainThread]: On master: Close
[0m06:02:23.676007 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:23.676544 [info ] [MainThread]: 
[0m06:02:23.705258 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:23.705848 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:23.706480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:23.706915 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:23.733843 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:23.734609 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:23.770076 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:23.770823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:31.106909 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:31.107425 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:31.108094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:31.108593 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:31.109020 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:31.109758 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:31.112659 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:31.113104 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:31.113795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:31.130641 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:31.131101 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:31.131556 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:31.133837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:31.139670 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:31.140141 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:31.141939 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:31.144292 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:31.145832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a3c7ee-0c56-4581-8ae4-5fdd62a14951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1ded00e0>]}
[0m06:02:31.146531 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.44s]
[0m06:02:31.147307 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:31.148287 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:31.148845 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:31.149424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:31.149865 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:31.154735 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:31.155389 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:31.191583 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:31.192073 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250810060231185442"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:31.192554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:31.200501 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:31.208038 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:31.208511 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:31.209099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:31.209554 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:31.209982 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250810060231185442'
      
      
      order by ordinal_position

  
[0m06:02:31.212129 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:31.217168 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:31.217624 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:31.220085 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:31.227690 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:31.228177 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:31.230295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:31.248591 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:31.249271 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:31.249722 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250810060231185442"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250810060231185442"
    )
  
[0m06:02:31.300429 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:31.302400 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:31.302846 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:31.303283 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:31.310665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:31.311579 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:31.313003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a3c7ee-0c56-4581-8ae4-5fdd62a14951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae51f2450>]}
[0m06:02:31.313700 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:31.314466 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:31.315769 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:31.316222 [debug] [MainThread]: On master: BEGIN
[0m06:02:31.316598 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:31.317259 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:31.317659 [debug] [MainThread]: On master: COMMIT
[0m06:02:31.318023 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:31.318424 [debug] [MainThread]: On master: COMMIT
[0m06:02:31.318953 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:31.319389 [debug] [MainThread]: On master: Close
[0m06:02:31.319978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:31.320392 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:31.320785 [info ] [MainThread]: 
[0m06:02:31.321305 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.20 seconds (8.20s).
[0m06:02:31.322311 [debug] [MainThread]: Command end result
[0m06:02:31.347990 [info ] [MainThread]: 
[0m06:02:31.348604 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:31.349133 [info ] [MainThread]: 
[0m06:02:31.349652 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:31.350617 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.229462, "process_user_time": 5.128797, "process_kernel_time": 0.266249, "process_mem_max_rss": "339344", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:31.351186 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:31.351048 after 10.23 seconds
[0m06:02:31.351625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b23b78bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1f357ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b0477f9b0>]}
[0m06:02:31.352045 [debug] [MainThread]: Flushing usage events
[0m06:02:33.170705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f62f30380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f62b59370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f629be120>]}


============================== 06:02:33.173768 | c8742372-032e-468e-a966-94ad320b8afe ==============================
[0m06:02:33.173768 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:33.174468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:33.286829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8742372-032e-468e-a966-94ad320b8afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f61c15880>]}
[0m06:02:33.304487 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18254322, "process_user_time": 1.319704, "process_kernel_time": 0.116973, "process_mem_max_rss": "100680", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:33.305016 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:33.304912 after 0.18 seconds
[0m06:02:33.305457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f620decf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f62c09160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f6203a270>]}
[0m06:02:33.305870 [debug] [MainThread]: Flushing usage events
[0m14:05:27.512685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f5c7bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f84018e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f62d45f0>]}


============================== 14:05:27.544856 | 12dd3f87-d88e-4cb2-8b0b-787933ac984f ==============================
[0m14:05:27.544856 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:27.545665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:27.700526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12dd3f87-d88e-4cb2-8b0b-787933ac984f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f596ddf0>]}
[0m14:05:27.716705 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_ahv9rka'
[0m14:05:27.717249 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:27.819827 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:27.820606 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:27.832346 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:27.836269 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:27.887510 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:27.888170 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:27.888724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '12dd3f87-d88e-4cb2-8b0b-787933ac984f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f5883770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f5598860>]}
[0m14:05:27.889219 [info ] [MainThread]: 
[0m14:05:27.889694 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:27.927809 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46581742, "process_user_time": 1.651211, "process_kernel_time": 0.150836, "process_mem_max_rss": "101700", "process_in_blocks": "8496", "process_out_blocks": "5176"}
[0m14:05:27.928544 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:27.928433 after 0.47 seconds
[0m14:05:27.929018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f62d57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f5a0fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f615c140>]}
[0m14:05:27.929486 [debug] [MainThread]: Flushing usage events
[0m14:05:29.593503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d0ab9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d0456e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d0455730>]}


============================== 14:05:29.596714 | 338bfe58-ec92-4434-9de9-3f13ba1e0491 ==============================
[0m14:05:29.596714 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:29.597415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:29.810119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '338bfe58-ec92-4434-9de9-3f13ba1e0491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9cffa2db0>]}
[0m14:05:29.870813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '338bfe58-ec92-4434-9de9-3f13ba1e0491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d2357a40>]}
[0m14:05:29.873725 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:05:29.987992 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:29.988752 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:29.989323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '338bfe58-ec92-4434-9de9-3f13ba1e0491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9cff9a510>]}
[0m14:05:31.294977 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:31.295704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '338bfe58-ec92-4434-9de9-3f13ba1e0491', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9cbe918e0>]}
[0m14:05:31.552936 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:31.558629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '338bfe58-ec92-4434-9de9-3f13ba1e0491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d2e0f0b0>]}
[0m14:05:31.663522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '338bfe58-ec92-4434-9de9-3f13ba1e0491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9cfeeb980>]}
[0m14:05:31.664180 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:05:31.664711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '338bfe58-ec92-4434-9de9-3f13ba1e0491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d1c2fbf0>]}
[0m14:05:31.666707 [info ] [MainThread]: 
[0m14:05:31.667472 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:31.672639 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:31.708782 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:31.709314 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:31.709703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:32.212506 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:32.214491 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:32.215737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:32.216450 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:32.224255 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:32.224700 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:32.225107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:32.226246 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.227628 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:32.228045 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:32.228613 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.229056 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:32.229438 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:32.230031 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.230990 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:32.231401 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:32.231779 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:32.232333 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.232736 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:32.234099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:32.240050 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:32.240543 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:32.240945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:32.241594 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.242004 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:32.242377 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:32.252242 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.253829 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:32.255143 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:32.255548 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:32.257754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '338bfe58-ec92-4434-9de9-3f13ba1e0491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9cba65700>]}
[0m14:05:32.258321 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:32.258719 [debug] [MainThread]: On master: BEGIN
[0m14:05:32.259131 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:32.259790 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:32.260210 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.260597 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:32.260973 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.261503 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:32.261896 [debug] [MainThread]: On master: Close
[0m14:05:32.262462 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:32.263007 [info ] [MainThread]: 
[0m14:05:32.313420 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:32.314154 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:32.314844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:32.315331 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:32.343174 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:32.344094 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:32.380457 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:32.381416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:39.468521 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.469074 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:39.469779 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.470249 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.470677 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:39.471491 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.474563 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.475061 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:39.475756 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.492764 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:39.493260 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.493726 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:39.495851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.501735 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.502256 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:05:39.503952 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.506375 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:39.507968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '338bfe58-ec92-4434-9de9-3f13ba1e0491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d1d6e4e0>]}
[0m14:05:39.508660 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.19s]
[0m14:05:39.509421 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:39.510409 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:39.511046 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:39.511695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:39.512161 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:39.517174 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:39.517847 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:39.554765 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.555355 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250810140539548561"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:39.555806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:39.564041 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.572184 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.572677 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:39.573400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.573868 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.574333 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250810140539548561'
      
      
      order by ordinal_position

  
[0m14:05:39.576699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.582262 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.582730 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:39.585281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.593590 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.594117 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:39.596589 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.615448 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:39.616267 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.616763 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250810140539548561"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250810140539548561"
    )
  
[0m14:05:39.671360 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.673505 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:39.674080 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.674753 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:39.682313 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.683377 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:39.685153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '338bfe58-ec92-4434-9de9-3f13ba1e0491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9cbb0dca0>]}
[0m14:05:39.685887 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:05:39.686701 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:39.688227 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.688647 [debug] [MainThread]: On master: BEGIN
[0m14:05:39.689064 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:39.689802 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.690233 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.690614 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.691013 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.691602 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.692039 [debug] [MainThread]: On master: Close
[0m14:05:39.692664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:39.693059 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:39.693465 [info ] [MainThread]: 
[0m14:05:39.693985 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.03 seconds (8.03s).
[0m14:05:39.694968 [debug] [MainThread]: Command end result
[0m14:05:39.722486 [info ] [MainThread]: 
[0m14:05:39.723232 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:39.723766 [info ] [MainThread]: 
[0m14:05:39.724310 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:39.725389 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.182493, "process_user_time": 5.320294, "process_kernel_time": 0.290016, "process_mem_max_rss": "311120", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m14:05:39.725972 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:39.725835 after 10.18 seconds
[0m14:05:39.726432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d065af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9cba3fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d1cee5a0>]}
[0m14:05:39.726872 [debug] [MainThread]: Flushing usage events
[0m14:05:41.654362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6428037080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6426881160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6426883950>]}


============================== 14:05:41.657600 | ac8508b7-4397-4834-80a5-e51caf7b0cfe ==============================
[0m14:05:41.657600 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:41.658259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:41.776067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac8508b7-4397-4834-80a5-e51caf7b0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64268db2f0>]}
[0m14:05:41.794707 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19092001, "process_user_time": 1.394571, "process_kernel_time": 0.109966, "process_mem_max_rss": "100676", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:41.795303 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:41.795194 after 0.19 seconds
[0m14:05:41.795773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6428127e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6425c30380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f642567b200>]}
[0m14:05:41.796242 [debug] [MainThread]: Flushing usage events
[0m22:06:18.535685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f525b419010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f525b3a1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f525b6303b0>]}


============================== 22:06:18.552023 | f14ef5c1-e336-4fbe-9608-ae9278ebbb43 ==============================
[0m22:06:18.552023 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:18.552728 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:18.668085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f14ef5c1-e336-4fbe-9608-ae9278ebbb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f525b8bae10>]}
[0m22:06:18.682798 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xvqa0gny'
[0m22:06:18.683255 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:18.970758 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:18.971394 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:18.993941 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:18.997696 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:19.067333 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:19.067860 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:19.068440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f14ef5c1-e336-4fbe-9608-ae9278ebbb43', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f525af78a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f525af87b90>]}
[0m22:06:19.068881 [info ] [MainThread]: 
[0m22:06:19.069411 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:19.074559 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.58827305, "process_user_time": 1.571911, "process_kernel_time": 0.136731, "process_mem_max_rss": "101436", "process_in_blocks": "8496", "process_out_blocks": "5168"}
[0m22:06:19.075118 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:19.075013 after 0.59 seconds
[0m22:06:19.075543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f525bf12870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f525b613d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f525b8b8ec0>]}
[0m22:06:19.075999 [debug] [MainThread]: Flushing usage events
[0m22:06:20.762391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3551ac0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3551ac2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3551ac2a20>]}


============================== 22:06:20.765432 | a4db0f01-0a64-4d9b-8cd9-93f0500e7736 ==============================
[0m22:06:20.765432 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:20.766076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:20.971014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4db0f01-0a64-4d9b-8cd9-93f0500e7736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3550e74650>]}
[0m22:06:21.029568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4db0f01-0a64-4d9b-8cd9-93f0500e7736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355100f200>]}
[0m22:06:21.032095 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:21.055192 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:21.055863 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:21.056397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a4db0f01-0a64-4d9b-8cd9-93f0500e7736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355193c440>]}
[0m22:06:22.393997 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:22.394646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a4db0f01-0a64-4d9b-8cd9-93f0500e7736', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3550e83110>]}
[0m22:06:22.633903 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:22.639510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4db0f01-0a64-4d9b-8cd9-93f0500e7736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35521d47a0>]}
[0m22:06:22.725517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4db0f01-0a64-4d9b-8cd9-93f0500e7736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f354cc409b0>]}
[0m22:06:22.726028 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:22.726546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4db0f01-0a64-4d9b-8cd9-93f0500e7736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f354cc732c0>]}
[0m22:06:22.728345 [info ] [MainThread]: 
[0m22:06:22.729041 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:22.733616 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:22.767956 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:22.768391 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:22.768779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:23.260270 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:23.261985 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:23.263040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:23.263599 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:23.271539 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:23.271976 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:23.272362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:23.273312 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:23.275120 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:23.275660 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:23.276367 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:23.276803 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:23.277211 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:23.277819 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:23.278750 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:23.279162 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:23.279522 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:23.280061 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:23.280458 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:23.281685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:23.287469 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:23.287986 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:23.288355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:23.288963 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:23.289351 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:23.289725 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:23.299350 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:23.300784 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:23.302061 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:23.302456 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:23.304563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4db0f01-0a64-4d9b-8cd9-93f0500e7736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f354ccec920>]}
[0m22:06:23.305087 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:23.305470 [debug] [MainThread]: On master: BEGIN
[0m22:06:23.305822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:23.306443 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:23.306830 [debug] [MainThread]: On master: COMMIT
[0m22:06:23.307234 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:23.307594 [debug] [MainThread]: On master: COMMIT
[0m22:06:23.308139 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:23.308527 [debug] [MainThread]: On master: Close
[0m22:06:23.309067 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:23.309531 [info ] [MainThread]: 
[0m22:06:23.334797 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:23.335388 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:23.335965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:23.336403 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:23.362987 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:23.363712 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:23.400831 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:23.401589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:31.585006 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:31.585503 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:31.586145 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.586586 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:31.587025 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:31.587801 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.590739 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:31.591200 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:31.591862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.609027 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:31.609507 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:31.609959 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:31.611716 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.617400 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:31.617875 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:31.619137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.621593 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:31.623209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4db0f01-0a64-4d9b-8cd9-93f0500e7736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f354b7c0320>]}
[0m22:06:31.623942 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.29s]
[0m22:06:31.624793 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:31.625799 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:31.626390 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:31.627002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:31.627442 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:31.632309 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:31.632953 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:31.669777 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.670298 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250810220631663365"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:31.670785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:31.678347 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.685687 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.686165 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:31.686749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.687212 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.687635 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250810220631663365'
      
      
      order by ordinal_position

  
[0m22:06:31.689721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.694774 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.695249 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:31.697649 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.705296 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.705753 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:31.708477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.726734 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:31.727431 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.727885 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250810220631663365"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250810220631663365"
    )
  
[0m22:06:31.778241 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.780305 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:31.780788 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.781235 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:31.789287 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.790209 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:31.791727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4db0f01-0a64-4d9b-8cd9-93f0500e7736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350e626a50>]}
[0m22:06:31.792435 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:06:31.793293 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:31.794875 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.795321 [debug] [MainThread]: On master: BEGIN
[0m22:06:31.795701 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:31.796372 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.796763 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.797166 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.797526 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.798070 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.798460 [debug] [MainThread]: On master: Close
[0m22:06:31.799078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:31.799446 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:31.799847 [info ] [MainThread]: 
[0m22:06:31.800463 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.07 seconds (9.07s).
[0m22:06:31.801560 [debug] [MainThread]: Command end result
[0m22:06:31.827332 [info ] [MainThread]: 
[0m22:06:31.827874 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:31.828351 [info ] [MainThread]: 
[0m22:06:31.828812 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:31.829732 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.116461, "process_user_time": 5.178404, "process_kernel_time": 0.290134, "process_mem_max_rss": "311820", "process_in_blocks": "1200", "process_out_blocks": "100128"}
[0m22:06:31.830293 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:31.830189 after 11.12 seconds
[0m22:06:31.830714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355311d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35193dc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350eb743e0>]}
[0m22:06:31.831187 [debug] [MainThread]: Flushing usage events
[0m22:06:33.625443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f91cb6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9124b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f91d14fb0>]}


============================== 22:06:33.628520 | 47c1f9eb-0910-49bd-99e2-0f3daa155c3e ==============================
[0m22:06:33.628520 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:33.629199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:33.741955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47c1f9eb-0910-49bd-99e2-0f3daa155c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9239c2c0>]}
[0m22:06:33.759488 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1832453, "process_user_time": 1.333878, "process_kernel_time": 0.10499, "process_mem_max_rss": "100776", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:33.760034 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:33.759898 after 0.18 seconds
[0m22:06:33.760448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f91cb6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f91665a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f91271ca0>]}
[0m22:06:33.760858 [debug] [MainThread]: Flushing usage events
[0m06:02:46.705700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dcc0eccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dcbce92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dcbce9040>]}


============================== 06:02:46.720541 | 101d2c39-bc79-4eb1-a5c5-10770b7f641d ==============================
[0m06:02:46.720541 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:46.721183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:46.851082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '101d2c39-bc79-4eb1-a5c5-10770b7f641d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dccdda240>]}
[0m06:02:46.866356 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ixxocbeo'
[0m06:02:46.866813 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:47.028562 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:47.029343 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:47.040948 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:47.044790 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:47.096636 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:47.097456 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:47.098198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '101d2c39-bc79-4eb1-a5c5-10770b7f641d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dcc2c7bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dcbaf1610>]}
[0m06:02:47.098880 [info ] [MainThread]: 
[0m06:02:47.099560 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:47.150569 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49454662, "process_user_time": 1.594345, "process_kernel_time": 0.140413, "process_mem_max_rss": "101436", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m06:02:47.151230 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:47.151093 after 0.50 seconds
[0m06:02:47.151668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dcca49a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dcbb1b080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dcbb1b9e0>]}
[0m06:02:47.152097 [debug] [MainThread]: Flushing usage events
[0m06:02:48.816414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a88b9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a62433b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a613dc40>]}


============================== 06:02:48.819504 | 09f674bb-e05a-4588-9db2-964ebc02b6b1 ==============================
[0m06:02:48.819504 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:48.820196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:49.025362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09f674bb-e05a-4588-9db2-964ebc02b6b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a60beea0>]}
[0m06:02:49.084252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09f674bb-e05a-4588-9db2-964ebc02b6b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a6575370>]}
[0m06:02:49.086977 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:49.113812 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:49.114573 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:49.115087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '09f674bb-e05a-4588-9db2-964ebc02b6b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a5eb02c0>]}
[0m06:02:50.405819 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:50.406570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '09f674bb-e05a-4588-9db2-964ebc02b6b1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a5e06840>]}
[0m06:02:50.648786 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:50.654426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09f674bb-e05a-4588-9db2-964ebc02b6b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a7d63aa0>]}
[0m06:02:50.743623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09f674bb-e05a-4588-9db2-964ebc02b6b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a1d8b740>]}
[0m06:02:50.744206 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:50.744715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09f674bb-e05a-4588-9db2-964ebc02b6b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a1dee720>]}
[0m06:02:50.746564 [info ] [MainThread]: 
[0m06:02:50.747298 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:50.752035 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:50.786823 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:50.787282 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:50.787672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:51.243478 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:51.245238 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:51.246347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:51.247031 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:51.256976 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:51.257610 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:51.258216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:51.259462 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:51.261386 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:51.261984 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:51.262818 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:51.263361 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:51.263902 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:51.264598 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:51.265680 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:51.266075 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:51.266468 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:51.267002 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:51.267433 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:51.268691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:51.274401 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:51.274886 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:51.275267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:51.275919 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:51.276328 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:51.276702 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:51.286238 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:51.287702 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:51.288932 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:51.289358 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:51.291490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09f674bb-e05a-4588-9db2-964ebc02b6b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a0764800>]}
[0m06:02:51.291999 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:51.292429 [debug] [MainThread]: On master: BEGIN
[0m06:02:51.292787 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:51.293399 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:51.293791 [debug] [MainThread]: On master: COMMIT
[0m06:02:51.294195 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:51.294559 [debug] [MainThread]: On master: COMMIT
[0m06:02:51.295101 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:51.295513 [debug] [MainThread]: On master: Close
[0m06:02:51.296035 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:51.296558 [info ] [MainThread]: 
[0m06:02:51.311707 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:51.312349 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:51.313015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:51.313494 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:51.341090 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:51.341996 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:51.377827 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:51.378704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:58.284575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:58.285074 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:58.285759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.286225 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:58.286657 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:58.287410 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.290345 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:58.290785 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:58.291468 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.308096 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:58.308583 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:58.308999 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:58.310861 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.316487 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:58.316937 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:58.318691 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.321012 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:58.322560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09f674bb-e05a-4588-9db2-964ebc02b6b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a7e3a660>]}
[0m06:02:58.323260 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.01s]
[0m06:02:58.324026 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:58.325027 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:58.325698 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:58.326306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:58.326744 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:58.331580 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:58.332224 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:58.368489 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:58.369041 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250811060258362417"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:58.369530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:58.377603 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.385409 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:58.385861 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:58.386496 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.386929 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:58.387375 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250811060258362417'
      
      
      order by ordinal_position

  
[0m06:02:58.390234 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.395414 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:58.395872 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:58.398595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.406282 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:58.406743 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:58.409359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.427508 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:58.428243 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:58.428713 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250811060258362417"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250811060258362417"
    )
  
[0m06:02:58.478992 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.480975 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:58.481443 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:58.481862 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:58.489105 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.490000 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:58.491512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09f674bb-e05a-4588-9db2-964ebc02b6b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0068132f30>]}
[0m06:02:58.492199 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:02:58.492998 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:58.494334 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:58.494735 [debug] [MainThread]: On master: BEGIN
[0m06:02:58.495099 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:58.495786 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:58.496208 [debug] [MainThread]: On master: COMMIT
[0m06:02:58.496583 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:58.496948 [debug] [MainThread]: On master: COMMIT
[0m06:02:58.497507 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:58.497894 [debug] [MainThread]: On master: Close
[0m06:02:58.498504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:58.498878 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:58.499294 [info ] [MainThread]: 
[0m06:02:58.499803 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.75 seconds (7.75s).
[0m06:02:58.500806 [debug] [MainThread]: Command end result
[0m06:02:58.526400 [info ] [MainThread]: 
[0m06:02:58.526992 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:58.527524 [info ] [MainThread]: 
[0m06:02:58.528041 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:58.529040 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.7616625, "process_user_time": 5.162454, "process_kernel_time": 0.275543, "process_mem_max_rss": "310572", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:58.529606 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:58.529504 after 9.76 seconds
[0m06:02:58.530038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a69e4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a1e0ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a1d8b0b0>]}
[0m06:02:58.530491 [debug] [MainThread]: Flushing usage events
[0m06:03:00.358399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc43411f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc433e5b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc43411f170>]}


============================== 06:03:00.361553 | 6832ae6f-c456-4ae6-bb2b-ec7896de3ce6 ==============================
[0m06:03:00.361553 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:00.362243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:03:00.475307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6832ae6f-c456-4ae6-bb2b-ec7896de3ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc433db7a40>]}
[0m06:03:00.493608 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18453787, "process_user_time": 1.354093, "process_kernel_time": 0.111925, "process_mem_max_rss": "100724", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:03:00.494168 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:00.494044 after 0.19 seconds
[0m06:03:00.494598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc43496b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc433c2c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc433c2eba0>]}
[0m06:03:00.495013 [debug] [MainThread]: Flushing usage events
[0m14:07:05.038274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c518d60f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c51891c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c51891dc0>]}


============================== 14:07:05.056848 | 7412a39d-5aa6-4bc4-aa3c-92f8dea59cda ==============================
[0m14:07:05.056848 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:05.057521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:05.192545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7412a39d-5aa6-4bc4-aa3c-92f8dea59cda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c52910860>]}
[0m14:07:05.208809 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-186zhrzu'
[0m14:07:05.209332 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:07:05.283074 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:07:05.283823 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:07:05.296595 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:07:05.300473 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:07:05.445975 [info ] [MainThread]: Installed from version 1.2.0
[0m14:07:05.446610 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:07:05.447138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7412a39d-5aa6-4bc4-aa3c-92f8dea59cda', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c516af170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c51eefbc0>]}
[0m14:07:05.447622 [info ] [MainThread]: 
[0m14:07:05.448093 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:07:05.460239 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4714479, "process_user_time": 1.572612, "process_kernel_time": 0.140965, "process_mem_max_rss": "101788", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m14:07:05.460805 [debug] [MainThread]: Command `dbt deps` succeeded at 14:07:05.460700 after 0.47 seconds
[0m14:07:05.461260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c55ed38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5158b080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5187b260>]}
[0m14:07:05.461690 [debug] [MainThread]: Flushing usage events
[0m14:07:07.037483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4fa72b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4fa72ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf500c00b0>]}


============================== 14:07:07.040599 | d05d61cd-1c41-4548-8d6c-03a9cf8b0d94 ==============================
[0m14:07:07.040599 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:07.041278 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:07.248364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd05d61cd-1c41-4548-8d6c-03a9cf8b0d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4f5b6150>]}
[0m14:07:07.307636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd05d61cd-1c41-4548-8d6c-03a9cf8b0d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf5058e930>]}
[0m14:07:07.310422 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:07:07.341899 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:07:07.342704 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:07:07.343242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd05d61cd-1c41-4548-8d6c-03a9cf8b0d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4b5336b0>]}
[0m14:07:08.625501 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:07:08.626207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd05d61cd-1c41-4548-8d6c-03a9cf8b0d94', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4b367380>]}
[0m14:07:08.871528 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:07:08.877253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd05d61cd-1c41-4548-8d6c-03a9cf8b0d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4b28a0f0>]}
[0m14:07:08.982579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd05d61cd-1c41-4548-8d6c-03a9cf8b0d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4b282900>]}
[0m14:07:08.983135 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:07:08.983614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd05d61cd-1c41-4548-8d6c-03a9cf8b0d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4b2fa420>]}
[0m14:07:08.985437 [info ] [MainThread]: 
[0m14:07:08.986110 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:07:08.990762 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:07:09.025708 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:07:09.026215 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:07:09.026605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:09.501302 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:09.503082 [debug] [ThreadPool]: On list_petro: Close
[0m14:07:09.504186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:07:09.504885 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:07:09.513523 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:09.513934 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:07:09.514400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:09.515353 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:09.516652 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:09.517034 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:07:09.517595 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:09.517969 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:09.518359 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:07:09.518934 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:09.519865 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:09.520272 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:07:09.520636 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:07:09.521197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:09.521593 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:07:09.522869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:07:09.528634 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:09.529035 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:07:09.529417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:09.530035 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:09.530444 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:07:09.530814 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:07:09.540764 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:09.542303 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:07:09.543557 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:07:09.543947 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:07:09.546359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd05d61cd-1c41-4548-8d6c-03a9cf8b0d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4b2f86e0>]}
[0m14:07:09.546860 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:09.547282 [debug] [MainThread]: On master: BEGIN
[0m14:07:09.547638 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:09.548262 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:09.548651 [debug] [MainThread]: On master: COMMIT
[0m14:07:09.549012 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:09.549390 [debug] [MainThread]: On master: COMMIT
[0m14:07:09.549920 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:09.550348 [debug] [MainThread]: On master: Close
[0m14:07:09.550863 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:07:09.551368 [info ] [MainThread]: 
[0m14:07:09.567791 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:07:09.568439 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:07:09.569089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:07:09.569549 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:07:09.596979 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:07:09.597815 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:07:09.633282 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:07:09.634106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:19.202009 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:19.202531 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:07:19.203156 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:19.203608 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:19.204017 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:07:19.204714 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:19.207683 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:19.208116 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:07:19.208783 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:19.225125 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:19.225619 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:19.226032 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:19.227310 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:19.232966 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:19.233438 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:07:19.234656 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:19.237003 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:07:19.238554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd05d61cd-1c41-4548-8d6c-03a9cf8b0d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf12362660>]}
[0m14:07:19.239245 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.67s]
[0m14:07:19.239985 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:07:19.240806 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:07:19.241378 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:07:19.242020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:07:19.242682 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:07:19.247578 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:07:19.248252 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:07:19.284558 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:19.285088 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250811140719278531"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:07:19.285560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:19.293630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:19.301326 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:19.301772 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:07:19.302404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:19.302837 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:19.303271 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250811140719278531'
      
      
      order by ordinal_position

  
[0m14:07:19.305505 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:19.310696 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:19.311144 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:19.313354 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:19.320981 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:19.321446 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:19.324477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:19.342288 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:07:19.342971 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:19.343439 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250811140719278531"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250811140719278531"
    )
  
[0m14:07:19.407132 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:19.409215 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:19.409670 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:19.410117 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:19.422485 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:19.423590 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:07:19.425418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd05d61cd-1c41-4548-8d6c-03a9cf8b0d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf125c3dd0>]}
[0m14:07:19.426089 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m14:07:19.426827 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:07:19.428400 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:19.428816 [debug] [MainThread]: On master: BEGIN
[0m14:07:19.429216 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:19.429904 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:19.430337 [debug] [MainThread]: On master: COMMIT
[0m14:07:19.430705 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:19.431058 [debug] [MainThread]: On master: COMMIT
[0m14:07:19.431640 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:19.432022 [debug] [MainThread]: On master: Close
[0m14:07:19.432637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:19.433004 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:07:19.433442 [info ] [MainThread]: 
[0m14:07:19.433945 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.45 seconds (10.45s).
[0m14:07:19.434978 [debug] [MainThread]: Command end result
[0m14:07:19.460965 [info ] [MainThread]: 
[0m14:07:19.461601 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:19.462102 [info ] [MainThread]: 
[0m14:07:19.462632 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:07:19.463635 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.475291, "process_user_time": 5.148825, "process_kernel_time": 0.287492, "process_mem_max_rss": "309468", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m14:07:19.464200 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:19.464074 after 12.48 seconds
[0m14:07:19.464641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4f5d4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf49c72570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4fa720f0>]}
[0m14:07:19.465053 [debug] [MainThread]: Flushing usage events
[0m14:07:21.362646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f939e835ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f939ede6540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f939e835bb0>]}


============================== 14:07:21.365845 | 3e4cc91a-a410-4ec2-ad87-12fcc02de4b5 ==============================
[0m14:07:21.365845 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:21.366521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:21.479759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e4cc91a-a410-4ec2-ad87-12fcc02de4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f939e872f30>]}
[0m14:07:21.497929 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18453164, "process_user_time": 1.361157, "process_kernel_time": 0.11193, "process_mem_max_rss": "100636", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:07:21.498511 [debug] [MainThread]: Command `dbt clean` succeeded at 14:07:21.498404 after 0.19 seconds
[0m14:07:21.498932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f939ebfd730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f939e872f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f939e643ec0>]}
[0m14:07:21.499396 [debug] [MainThread]: Flushing usage events
[0m22:06:26.786113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e94ac9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e94c60fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e955e5850>]}


============================== 22:06:26.802623 | 7845d640-f8c3-4e3d-8ed9-f1fedef8599e ==============================
[0m22:06:26.802623 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:26.803336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:26.936259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7845d640-f8c3-4e3d-8ed9-f1fedef8599e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e95b0cb90>]}
[0m22:06:26.951859 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-9n621rxz'
[0m22:06:26.952347 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:27.199701 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:27.200462 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:27.214547 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:27.218480 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:27.277645 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:27.278191 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:27.278709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7845d640-f8c3-4e3d-8ed9-f1fedef8599e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e947c85f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e947d1cd0>]}
[0m22:06:27.279175 [info ] [MainThread]: 
[0m22:06:27.279647 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:27.281564 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.54459244, "process_user_time": 1.592389, "process_kernel_time": 0.144216, "process_mem_max_rss": "101684", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m22:06:27.282133 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:27.282029 after 0.55 seconds
[0m22:06:27.282559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e955e7c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e9557d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e94c81700>]}
[0m22:06:27.282987 [debug] [MainThread]: Flushing usage events
[0m22:06:28.894955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b42e75a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b45065b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b4340e930>]}


============================== 22:06:28.898105 | 7dc224d4-3952-4584-ad39-e9870757c343 ==============================
[0m22:06:28.898105 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:28.898784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:29.106942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dc224d4-3952-4584-ad39-e9870757c343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b42c5d730>]}
[0m22:06:29.166337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dc224d4-3952-4584-ad39-e9870757c343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b43fce060>]}
[0m22:06:29.169160 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:29.186110 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:29.186845 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:29.187367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7dc224d4-3952-4584-ad39-e9870757c343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b3ed085c0>]}
[0m22:06:30.484330 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:30.485049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7dc224d4-3952-4584-ad39-e9870757c343', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b3eda8350>]}
[0m22:06:30.737644 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:30.743403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dc224d4-3952-4584-ad39-e9870757c343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b42c6ec30>]}
[0m22:06:30.830394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dc224d4-3952-4584-ad39-e9870757c343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b3eaad3a0>]}
[0m22:06:30.830986 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:30.831483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dc224d4-3952-4584-ad39-e9870757c343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b3ea3d430>]}
[0m22:06:30.833383 [info ] [MainThread]: 
[0m22:06:30.834130 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:30.838773 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:30.873870 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:30.874389 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:30.874789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:31.366177 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.367861 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:31.368937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:31.369488 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:31.376965 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.377384 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:31.377762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:31.378708 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.380067 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.380457 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:31.381014 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.381399 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.381763 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:31.382366 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.383323 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:31.383713 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.384130 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:31.384676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.385107 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:31.386429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:31.392288 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:31.392781 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:31.393173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:31.393790 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.394201 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:31.394575 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:31.404522 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.406027 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:31.407272 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:31.407662 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:31.410087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dc224d4-3952-4584-ad39-e9870757c343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b3ea1b740>]}
[0m22:06:31.410598 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.411029 [debug] [MainThread]: On master: BEGIN
[0m22:06:31.411394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:31.412047 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.412443 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.412836 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.413207 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.413750 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.414192 [debug] [MainThread]: On master: Close
[0m22:06:31.414754 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:31.415292 [info ] [MainThread]: 
[0m22:06:31.427224 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:31.427884 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:31.428570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:31.429030 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:31.456413 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:31.457296 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:31.493050 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:31.493972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:39.197383 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:39.197966 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:39.198797 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.199274 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:39.199700 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:39.200521 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.203783 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:39.204253 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:39.205051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.222082 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:39.222649 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:39.223126 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:39.225241 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.231472 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:39.231992 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:39.233493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.236094 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:39.237754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dc224d4-3952-4584-ad39-e9870757c343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b44b6e270>]}
[0m22:06:39.238518 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.81s]
[0m22:06:39.239322 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:39.240208 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:39.241063 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:39.241830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:39.242297 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:39.247865 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:39.248564 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:39.285714 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:39.286353 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250811220639279445"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:39.286830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:39.294971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.303717 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:39.304301 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:39.305132 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.305572 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:39.306026 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250811220639279445'
      
      
      order by ordinal_position

  
[0m22:06:39.308644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.314497 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:39.315011 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:39.317306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.325334 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:39.325834 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:39.328768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.347779 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:39.348669 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:39.349215 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250811220639279445"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250811220639279445"
    )
  
[0m22:06:39.403724 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.405923 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:39.406454 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:39.406941 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:39.414620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.415731 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:39.417361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dc224d4-3952-4584-ad39-e9870757c343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b051a8b90>]}
[0m22:06:39.418120 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m22:06:39.418983 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:39.420624 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:39.421124 [debug] [MainThread]: On master: BEGIN
[0m22:06:39.421543 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:39.422401 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:39.422832 [debug] [MainThread]: On master: COMMIT
[0m22:06:39.423228 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:39.423620 [debug] [MainThread]: On master: COMMIT
[0m22:06:39.424225 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:39.424644 [debug] [MainThread]: On master: Close
[0m22:06:39.425457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:39.425902 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:39.426342 [info ] [MainThread]: 
[0m22:06:39.426848 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.59 seconds (8.59s).
[0m22:06:39.427852 [debug] [MainThread]: Command end result
[0m22:06:39.455124 [info ] [MainThread]: 
[0m22:06:39.455794 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:39.456314 [info ] [MainThread]: 
[0m22:06:39.456840 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:39.457920 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.6143675, "process_user_time": 5.210513, "process_kernel_time": 0.308852, "process_mem_max_rss": "309688", "process_in_blocks": "1200", "process_out_blocks": "100136"}
[0m22:06:39.458473 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:39.458365 after 10.62 seconds
[0m22:06:39.458941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b434264b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b4313c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b3eaae1b0>]}
[0m22:06:39.459382 [debug] [MainThread]: Flushing usage events
[0m22:06:41.374672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c7f9b0e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c7f64da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c7f64f5c0>]}


============================== 22:06:41.377935 | 6f887418-db12-4f7d-8f9d-1b44ffbe73e4 ==============================
[0m22:06:41.377935 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:41.378623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:41.491358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f887418-db12-4f7d-8f9d-1b44ffbe73e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c7fdd7440>]}
[0m22:06:41.510419 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18479575, "process_user_time": 1.374679, "process_kernel_time": 0.123881, "process_mem_max_rss": "100676", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:41.510993 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:41.510886 after 0.19 seconds
[0m22:06:41.511439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c80947470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c7ec795b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c7eb915e0>]}
[0m22:06:41.511896 [debug] [MainThread]: Flushing usage events
[0m06:02:25.554130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca787688c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7876bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca78768890>]}


============================== 06:02:25.570600 | 6779ab79-5397-41f9-8d66-7e351c26c55d ==============================
[0m06:02:25.570600 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.571255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:25.748461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6779ab79-5397-41f9-8d66-7e351c26c55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca785c7f80>]}
[0m06:02:25.763904 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wd86rarq'
[0m06:02:25.764357 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:25.884701 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:25.885449 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:25.907403 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:25.911250 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:25.990758 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:25.991297 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:25.991827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6779ab79-5397-41f9-8d66-7e351c26c55d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca784d84d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca784fc590>]}
[0m06:02:25.992282 [info ] [MainThread]: 
[0m06:02:25.992752 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:26.002563 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49761462, "process_user_time": 1.557036, "process_kernel_time": 0.147003, "process_mem_max_rss": "101440", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m06:02:26.003131 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:26.003027 after 0.50 seconds
[0m06:02:26.003561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca78bf3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca785fa750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca785fa030>]}
[0m06:02:26.004058 [debug] [MainThread]: Flushing usage events
[0m06:02:27.516134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e74279940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e75df3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e742799d0>]}


============================== 06:02:27.519269 | c8896228-33fc-4c58-810a-7144f3023b8a ==============================
[0m06:02:27.519269 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:27.519968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.725413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8896228-33fc-4c58-810a-7144f3023b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7012f9b0>]}
[0m06:02:27.783752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8896228-33fc-4c58-810a-7144f3023b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e75fcd070>]}
[0m06:02:27.786428 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:27.883938 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:27.884697 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:27.885239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c8896228-33fc-4c58-810a-7144f3023b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e70109b50>]}
[0m06:02:29.174778 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:29.175495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c8896228-33fc-4c58-810a-7144f3023b8a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e700698e0>]}
[0m06:02:29.418339 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:29.423788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8896228-33fc-4c58-810a-7144f3023b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e74c52fc0>]}
[0m06:02:29.565017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8896228-33fc-4c58-810a-7144f3023b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e6fe9a570>]}
[0m06:02:29.565576 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:29.566136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8896228-33fc-4c58-810a-7144f3023b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7418d880>]}
[0m06:02:29.567983 [info ] [MainThread]: 
[0m06:02:29.568705 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:29.573464 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:29.608356 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:29.608782 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:29.609189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:30.147034 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:30.148643 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:30.149599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:30.150177 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:30.157607 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:30.158051 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:30.158429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:30.159331 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:30.160628 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:30.161035 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:30.161581 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:30.162168 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:30.162674 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:30.163384 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:30.164312 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:30.164711 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:30.165147 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:30.165679 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:30.166102 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:30.167318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:30.173028 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:30.173435 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:30.173798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:30.174421 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:30.174839 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:30.175225 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:30.184850 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:30.186301 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:30.187555 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:30.187978 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:30.190193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8896228-33fc-4c58-810a-7144f3023b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e75fcd2e0>]}
[0m06:02:30.190737 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.191159 [debug] [MainThread]: On master: BEGIN
[0m06:02:30.191519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:30.192136 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.192530 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.192925 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.193290 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.193799 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.194208 [debug] [MainThread]: On master: Close
[0m06:02:30.194726 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:30.195245 [info ] [MainThread]: 
[0m06:02:30.210414 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:30.211025 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:30.211652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:30.212112 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:30.238940 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:30.239674 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:30.274743 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:30.275645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:04:50.179479 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:04:50.179993 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:04:50.180659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:50.181119 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:04:50.181534 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:04:50.182235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:50.185101 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:04:50.185535 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:04:50.186198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:50.202537 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:04:50.203007 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:04:50.203422 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:04:50.204668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:50.210216 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:04:50.210657 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:04:50.212265 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:50.214581 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:04:50.216087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8896228-33fc-4c58-810a-7144f3023b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e35c3d730>]}
[0m06:04:50.216752 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 140.00s]
[0m06:04:50.217586 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:04:50.218509 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:04:50.219186 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:04:50.219846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:04:50.220286 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:04:50.225093 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:04:50.225724 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:04:50.261613 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:50.262147 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250812060450255582"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:04:50.262597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:04:50.270400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:50.277905 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:50.278349 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:04:50.279034 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:50.279465 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:50.279918 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250812060450255582'
      
      
      order by ordinal_position

  
[0m06:04:50.281995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:50.287038 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:50.287491 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:04:50.289527 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:50.297012 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:50.297467 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:04:50.299518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:50.317526 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:04:50.318278 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:50.318755 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250812060450255582"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250812060450255582"
    )
  
[0m06:04:50.368880 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:50.370928 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:04:50.371368 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:50.371779 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:04:50.378172 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:50.379099 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:04:50.380641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8896228-33fc-4c58-810a-7144f3023b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e35d833b0>]}
[0m06:04:50.381332 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:04:50.382150 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:04:50.383550 [debug] [MainThread]: Using duckdb connection "master"
[0m06:04:50.383986 [debug] [MainThread]: On master: BEGIN
[0m06:04:50.384355 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:04:50.385029 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:04:50.385425 [debug] [MainThread]: On master: COMMIT
[0m06:04:50.385788 [debug] [MainThread]: Using duckdb connection "master"
[0m06:04:50.386198 [debug] [MainThread]: On master: COMMIT
[0m06:04:50.386705 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:04:50.387132 [debug] [MainThread]: On master: Close
[0m06:04:50.387671 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:04:50.388062 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:04:50.388458 [info ] [MainThread]: 
[0m06:04:50.388990 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 2 minutes and 20.82 seconds (140.82s).
[0m06:04:50.390006 [debug] [MainThread]: Command end result
[0m06:04:50.415793 [info ] [MainThread]: 
[0m06:04:50.416433 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:04:50.416967 [info ] [MainThread]: 
[0m06:04:50.417480 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:04:50.418477 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 142.95178, "process_user_time": 5.213008, "process_kernel_time": 0.268154, "process_mem_max_rss": "314668", "process_in_blocks": "1200", "process_out_blocks": "100032"}
[0m06:04:50.419051 [debug] [MainThread]: Command `dbt run` succeeded at 06:04:50.418944 after 142.95 seconds
[0m06:04:50.419489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7434b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e750d6ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7466a180>]}
[0m06:04:50.419939 [debug] [MainThread]: Flushing usage events
[0m06:04:52.374154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f74646ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f74249850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f74249a60>]}


============================== 06:04:52.377235 | ba7a519f-02e7-468a-955c-ab7ba0176a95 ==============================
[0m06:04:52.377235 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:04:52.377897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:04:52.489663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba7a519f-02e7-468a-955c-ab7ba0176a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f75f23650>]}
[0m06:04:52.511519 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1851242, "process_user_time": 1.352689, "process_kernel_time": 0.103052, "process_mem_max_rss": "100376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:04:52.513013 [debug] [MainThread]: Command `dbt clean` succeeded at 06:04:52.512900 after 0.19 seconds
[0m06:04:52.513475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f76d89970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f75de07a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7419d2b0>]}
[0m06:04:52.514144 [debug] [MainThread]: Flushing usage events
[0m14:06:22.054720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a6858a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a68938f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a6858a420>]}


============================== 14:06:22.071162 | ac1a4c7e-1c56-4015-bfa9-f0c493db420f ==============================
[0m14:06:22.071162 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:22.071853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:06:22.199966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac1a4c7e-1c56-4015-bfa9-f0c493db420f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a6836bf20>]}
[0m14:06:22.215883 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-9xuosipa'
[0m14:06:22.216407 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:22.443566 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:22.444306 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:22.454977 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:22.458831 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:22.511203 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:22.511760 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:06:22.512332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ac1a4c7e-1c56-4015-bfa9-f0c493db420f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a682a81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a68248bc0>]}
[0m14:06:22.512790 [info ] [MainThread]: 
[0m14:06:22.513285 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:22.518948 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5149807, "process_user_time": 1.610045, "process_kernel_time": 0.135666, "process_mem_max_rss": "101612", "process_in_blocks": "8496", "process_out_blocks": "5168"}
[0m14:06:22.519518 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:22.519413 after 0.52 seconds
[0m14:06:22.519948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a6cb638f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a6891be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a6b0d5790>]}
[0m14:06:22.520435 [debug] [MainThread]: Flushing usage events
[0m14:06:24.131049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61cd1cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61cd8887d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61cd8889b0>]}


============================== 14:06:24.134294 | 8a8ae98c-5992-4e1b-9bfc-37614063fee5 ==============================
[0m14:06:24.134294 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:24.134981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:24.345673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a8ae98c-5992-4e1b-9bfc-37614063fee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61cc5cacc0>]}
[0m14:06:24.405399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a8ae98c-5992-4e1b-9bfc-37614063fee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61cd888b30>]}
[0m14:06:24.408133 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:06:24.432161 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:24.432887 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:24.433449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8a8ae98c-5992-4e1b-9bfc-37614063fee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61ccbf7b30>]}
[0m14:06:25.737854 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:25.738518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8a8ae98c-5992-4e1b-9bfc-37614063fee5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61c8340560>]}
[0m14:06:25.993745 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:25.999449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a8ae98c-5992-4e1b-9bfc-37614063fee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61c838a960>]}
[0m14:06:26.107935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a8ae98c-5992-4e1b-9bfc-37614063fee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61c8354f20>]}
[0m14:06:26.108549 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:06:26.109057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a8ae98c-5992-4e1b-9bfc-37614063fee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61c83f0a10>]}
[0m14:06:26.110994 [info ] [MainThread]: 
[0m14:06:26.111733 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:26.116601 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:26.153172 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:26.153716 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:26.154170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:26.892276 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:06:26.894301 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:26.895503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:26.896202 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:26.905524 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:26.905998 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:26.906405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:26.907569 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:26.909815 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:26.910515 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:26.911452 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:26.912080 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:26.912705 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:26.913586 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:26.914555 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:26.914957 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:26.915357 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:26.915910 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:26.916351 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:26.917671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:26.923690 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:26.924207 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:26.924571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:26.925217 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:26.925609 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:26.925980 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:26.936052 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:26.937765 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:26.939156 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:26.939562 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:26.942059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a8ae98c-5992-4e1b-9bfc-37614063fee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61ce4dd280>]}
[0m14:06:26.942584 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:26.942968 [debug] [MainThread]: On master: BEGIN
[0m14:06:26.943356 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:26.944062 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:26.944590 [debug] [MainThread]: On master: COMMIT
[0m14:06:26.945051 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:26.945419 [debug] [MainThread]: On master: COMMIT
[0m14:06:26.946021 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:26.946441 [debug] [MainThread]: On master: Close
[0m14:06:26.946999 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:26.947524 [info ] [MainThread]: 
[0m14:06:26.968999 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:26.969689 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:26.970381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:26.970826 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:26.998293 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:26.999136 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:27.034891 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:27.035704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:33.418767 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:33.419313 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:33.420035 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:33.420479 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:33.420894 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:33.421667 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:33.424613 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:33.425109 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:33.425849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:33.442910 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:33.443430 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:33.443864 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:33.446447 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:33.452424 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:33.452884 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:33.454306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:33.456724 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:33.458321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8ae98c-5992-4e1b-9bfc-37614063fee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61ce4823f0>]}
[0m14:06:33.459041 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.49s]
[0m14:06:33.459815 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:33.460652 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:33.461223 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:33.461981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:33.462456 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:33.467446 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:33.468147 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:33.505030 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:33.505589 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250812140633498826"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:33.506061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:33.513974 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:33.521834 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:33.522325 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:33.522967 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:33.523476 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:33.523904 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250812140633498826'
      
      
      order by ordinal_position

  
[0m14:06:33.526110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:33.531404 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:33.531862 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:33.534037 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:33.541798 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:33.542277 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:33.544445 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:33.562698 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:33.563422 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:33.563886 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250812140633498826"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250812140633498826"
    )
  
[0m14:06:33.612687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:33.614698 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:33.615158 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:33.615569 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:33.622771 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:33.623715 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:33.625363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8ae98c-5992-4e1b-9bfc-37614063fee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f618ef10920>]}
[0m14:06:33.626084 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:06:33.626806 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:33.628578 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:33.628990 [debug] [MainThread]: On master: BEGIN
[0m14:06:33.629411 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:33.630114 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:33.630509 [debug] [MainThread]: On master: COMMIT
[0m14:06:33.630871 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:33.631258 [debug] [MainThread]: On master: COMMIT
[0m14:06:33.631778 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:33.632201 [debug] [MainThread]: On master: Close
[0m14:06:33.632777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:33.633169 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:33.633562 [info ] [MainThread]: 
[0m14:06:33.634080 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.52 seconds (7.52s).
[0m14:06:33.635088 [debug] [MainThread]: Command end result
[0m14:06:33.660815 [info ] [MainThread]: 
[0m14:06:33.661465 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:33.661980 [info ] [MainThread]: 
[0m14:06:33.662522 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:33.663525 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.582955, "process_user_time": 5.501449, "process_kernel_time": 0.286439, "process_mem_max_rss": "311632", "process_in_blocks": "1200", "process_out_blocks": "100096"}
[0m14:06:33.664100 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:33.663966 after 9.58 seconds
[0m14:06:33.664540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61cc7f8380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61cc74d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61ccbf6420>]}
[0m14:06:33.664960 [debug] [MainThread]: Flushing usage events
[0m14:06:35.502936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc58f7800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc5755fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc5509eb0>]}


============================== 14:06:35.506236 | c916912b-e224-44f7-a2b1-df4d38134ed1 ==============================
[0m14:06:35.506236 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:35.506888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:35.621147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c916912b-e224-44f7-a2b1-df4d38134ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc58c9160>]}
[0m14:06:35.639575 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18648247, "process_user_time": 1.393027, "process_kernel_time": 0.100929, "process_mem_max_rss": "100620", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:35.640145 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:35.640037 after 0.19 seconds
[0m14:06:35.640575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc5884860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc57def00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc922ea20>]}
[0m14:06:35.640992 [debug] [MainThread]: Flushing usage events
[0m22:06:32.136957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cda5eef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cd9ae10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cd996a660>]}


============================== 22:06:32.152995 | 9e43590c-5990-4f48-8402-01d74c5805eb ==============================
[0m22:06:32.152995 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:32.153642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:32.296923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e43590c-5990-4f48-8402-01d74c5805eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cda4c7d70>]}
[0m22:06:32.311135 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xdd90tnd'
[0m22:06:32.311586 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:32.375123 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:32.375745 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:32.399069 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:32.402838 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:32.473906 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:32.474461 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:32.474983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9e43590c-5990-4f48-8402-01d74c5805eb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cda4174a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cda900110>]}
[0m22:06:32.475436 [info ] [MainThread]: 
[0m22:06:32.475939 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:32.481343 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.39341772, "process_user_time": 1.548161, "process_kernel_time": 0.136837, "process_mem_max_rss": "101380", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m22:06:32.481866 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:32.481766 after 0.39 seconds
[0m22:06:32.482304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cd996a660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cda4c7d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cd994f6e0>]}
[0m22:06:32.482713 [debug] [MainThread]: Flushing usage events
[0m22:06:34.019675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f002bfdcf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f002ae77ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f002b00ddf0>]}


============================== 22:06:34.022736 | 0bb4a0ee-5237-488d-a93d-131d9b0c972a ==============================
[0m22:06:34.022736 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:34.023431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:34.232564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bb4a0ee-5237-488d-a93d-131d9b0c972a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f002b5c73b0>]}
[0m22:06:34.291518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bb4a0ee-5237-488d-a93d-131d9b0c972a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f002a3c55e0>]}
[0m22:06:34.294062 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:34.317766 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:34.318484 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:34.319005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0bb4a0ee-5237-488d-a93d-131d9b0c972a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00263b4d40>]}
[0m22:06:35.614963 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:35.615620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0bb4a0ee-5237-488d-a93d-131d9b0c972a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0026241c40>]}
[0m22:06:35.853462 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:35.858864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bb4a0ee-5237-488d-a93d-131d9b0c972a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f002a240980>]}
[0m22:06:35.939998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bb4a0ee-5237-488d-a93d-131d9b0c972a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0026066930>]}
[0m22:06:35.940499 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:35.941006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bb4a0ee-5237-488d-a93d-131d9b0c972a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f002aa07aa0>]}
[0m22:06:35.942862 [info ] [MainThread]: 
[0m22:06:35.943560 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:35.948191 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:35.982922 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:35.983387 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:35.983779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:36.321361 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:36.323270 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:36.324443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:36.325093 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:36.332968 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:36.333429 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:36.333813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:36.334769 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:36.336105 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:36.336518 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:36.337057 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:36.337463 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:36.337824 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:36.338394 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:36.339315 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:36.339713 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:36.340076 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:36.340629 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:36.341024 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:36.342293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:36.348022 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:36.348546 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:36.348906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:36.349517 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:36.349907 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:36.350307 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:36.360004 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:36.361466 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:36.362691 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:36.363093 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:36.365342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bb4a0ee-5237-488d-a93d-131d9b0c972a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f002c1b9520>]}
[0m22:06:36.365830 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:36.366232 [debug] [MainThread]: On master: BEGIN
[0m22:06:36.366597 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:36.367200 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:36.367597 [debug] [MainThread]: On master: COMMIT
[0m22:06:36.367963 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:36.368343 [debug] [MainThread]: On master: COMMIT
[0m22:06:36.368858 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:36.369263 [debug] [MainThread]: On master: Close
[0m22:06:36.369776 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:36.370249 [info ] [MainThread]: 
[0m22:06:36.380919 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:36.381543 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:36.382097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:36.382559 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:36.409335 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:36.410109 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:36.445599 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:36.446343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:43.994454 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:43.994939 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:43.995639 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:43.996077 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:43.996523 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:43.997275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:44.000155 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:44.000617 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:44.001287 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:44.017925 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:44.018415 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:44.018835 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:44.020688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:44.026315 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:44.026765 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:44.027827 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:44.030195 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:44.031720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bb4a0ee-5237-488d-a93d-131d9b0c972a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0024b394c0>]}
[0m22:06:44.032416 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.65s]
[0m22:06:44.033249 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:44.034061 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:44.034649 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:44.035300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:44.035929 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:44.040789 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:44.041425 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:44.077214 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:44.077695 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250812220644071243"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:44.078146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:44.085844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:44.093335 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:44.093781 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:44.094379 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:44.094811 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:44.095252 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250812220644071243'
      
      
      order by ordinal_position

  
[0m22:06:44.097372 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:44.102442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:44.102895 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:44.104944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:44.112481 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:44.112938 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:44.115554 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:44.133683 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:44.134354 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:44.134808 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250812220644071243"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250812220644071243"
    )
  
[0m22:06:44.185029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:44.187040 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:44.187501 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:44.187909 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:44.195739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:44.196653 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:44.198094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bb4a0ee-5237-488d-a93d-131d9b0c972a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effec8a8230>]}
[0m22:06:44.198780 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:06:44.199517 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:44.200831 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:44.201267 [debug] [MainThread]: On master: BEGIN
[0m22:06:44.201644 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:44.202310 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:44.202705 [debug] [MainThread]: On master: COMMIT
[0m22:06:44.203066 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:44.203467 [debug] [MainThread]: On master: COMMIT
[0m22:06:44.203995 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:44.204437 [debug] [MainThread]: On master: Close
[0m22:06:44.205020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:44.205423 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:44.205816 [info ] [MainThread]: 
[0m22:06:44.206313 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.26 seconds (8.26s).
[0m22:06:44.207287 [debug] [MainThread]: Command end result
[0m22:06:44.232784 [info ] [MainThread]: 
[0m22:06:44.233372 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:44.233841 [info ] [MainThread]: 
[0m22:06:44.234342 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:44.235340 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.264761, "process_user_time": 4.633643, "process_kernel_time": 0.282955, "process_mem_max_rss": "313772", "process_in_blocks": "1200", "process_out_blocks": "100136"}
[0m22:06:44.235877 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:44.235776 after 10.27 seconds
[0m22:06:44.236341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f002e12ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0024116060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f002a862960>]}
[0m22:06:44.236760 [debug] [MainThread]: Flushing usage events
[0m22:06:46.045054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c0b791f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c0cb6b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c02759d0>]}


============================== 22:06:46.048253 | 00ec9b30-fdb3-4a6f-9421-0fa6ebb51ccb ==============================
[0m22:06:46.048253 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:46.048925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:46.164757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00ec9b30-fdb3-4a6f-9421-0fa6ebb51ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c0cb6b10>]}
[0m22:06:46.182553 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20193565, "process_user_time": 1.336077, "process_kernel_time": 0.112922, "process_mem_max_rss": "100660", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:46.183085 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:46.182981 after 0.20 seconds
[0m22:06:46.183570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c0347320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c0cb6b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c084f410>]}
[0m22:06:46.183985 [debug] [MainThread]: Flushing usage events
[0m06:02:21.163289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5987e9b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5987e9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5987e8890>]}


============================== 06:02:21.172198 | d9b00786-00f1-4344-b1bd-e670f6bd2bfc ==============================
[0m06:02:21.172198 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:21.172924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:21.307994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9b00786-00f1-4344-b1bd-e670f6bd2bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd598206840>]}
[0m06:02:21.324046 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-35sffanm'
[0m06:02:21.324556 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:21.446813 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:21.447584 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:21.461573 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:21.465523 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:21.596850 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:21.597486 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:21.598091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd9b00786-00f1-4344-b1bd-e670f6bd2bfc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd597ae8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd597b0c560>]}
[0m06:02:21.598561 [info ] [MainThread]: 
[0m06:02:21.599083 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:21.605500 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4960373, "process_user_time": 1.611821, "process_kernel_time": 0.157373, "process_mem_max_rss": "101416", "process_in_blocks": "8512", "process_out_blocks": "5176"}
[0m06:02:21.606081 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:21.605974 after 0.50 seconds
[0m06:02:21.606504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd598253680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd598206840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd597aaf3e0>]}
[0m06:02:21.606949 [debug] [MainThread]: Flushing usage events
[0m06:02:23.373562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7024849970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7024c65730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7024875a30>]}


============================== 06:02:23.376792 | 70819f1f-d531-47ff-be0c-212d123f491f ==============================
[0m06:02:23.376792 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:23.377466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:23.587098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70819f1f-d531-47ff-be0c-212d123f491f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7024655700>]}
[0m06:02:23.646567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70819f1f-d531-47ff-be0c-212d123f491f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7024b3dac0>]}
[0m06:02:23.649326 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:23.676986 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:23.677731 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:23.678236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '70819f1f-d531-47ff-be0c-212d123f491f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f702078ba40>]}
[0m06:02:24.963957 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:24.964601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '70819f1f-d531-47ff-be0c-212d123f491f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70246d7800>]}
[0m06:02:25.217458 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:25.223139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70819f1f-d531-47ff-be0c-212d123f491f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7024cd98e0>]}
[0m06:02:25.313923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70819f1f-d531-47ff-be0c-212d123f491f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7020449460>]}
[0m06:02:25.314516 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:25.315062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70819f1f-d531-47ff-be0c-212d123f491f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70204ef530>]}
[0m06:02:25.316993 [info ] [MainThread]: 
[0m06:02:25.317705 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:25.322460 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:25.358749 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:25.359273 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:25.359668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:25.656735 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.658622 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:25.659803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:25.660383 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:25.667905 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:25.668353 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:25.668749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:25.670385 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.671827 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:25.672219 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:25.672787 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.673168 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:25.673527 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:25.674154 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.675083 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:25.675477 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:25.675881 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:25.676420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.676845 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:25.678155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:25.684247 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:25.684655 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:25.685051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:25.685728 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.686121 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:25.686495 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:25.696100 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.697826 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:25.699112 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:25.699507 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:25.701847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70819f1f-d531-47ff-be0c-212d123f491f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701ef3ce90>]}
[0m06:02:25.702373 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.702785 [debug] [MainThread]: On master: BEGIN
[0m06:02:25.703146 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:25.703961 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.704360 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.704768 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.705148 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.705726 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.706128 [debug] [MainThread]: On master: Close
[0m06:02:25.706750 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:25.707225 [info ] [MainThread]: 
[0m06:02:25.724800 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:25.725495 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:25.726164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:25.726600 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:25.754362 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:25.755270 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:25.791599 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:25.792529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:37.252347 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:37.252919 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:37.253716 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.254167 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:37.254586 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:37.255373 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.258573 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:37.259036 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:37.259733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.276863 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:37.277423 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:37.277888 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:37.279933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.286212 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:37.286727 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:37.288093 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.290789 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:37.292405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70819f1f-d531-47ff-be0c-212d123f491f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fe630afc0>]}
[0m06:02:37.293126 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.57s]
[0m06:02:37.293981 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:37.294853 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:37.295524 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:37.296243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:37.296712 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:37.302374 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:37.303190 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:37.341838 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.342436 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250813060237335331"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:37.342918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:37.351239 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.359652 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.360199 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:37.360920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.361366 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.361802 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250813060237335331'
      
      
      order by ordinal_position

  
[0m06:02:37.364714 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.370390 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.370924 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:37.373368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.381627 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.382146 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:37.384541 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.403362 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:37.404230 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.404716 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250813060237335331"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250813060237335331"
    )
  
[0m06:02:37.455008 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.457021 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:37.457477 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.457923 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:37.465574 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.466625 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:37.468149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70819f1f-d531-47ff-be0c-212d123f491f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fe60d1a60>]}
[0m06:02:37.468845 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:02:37.469641 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:37.471122 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:37.471545 [debug] [MainThread]: On master: BEGIN
[0m06:02:37.471957 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:37.472706 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:37.473120 [debug] [MainThread]: On master: COMMIT
[0m06:02:37.473484 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:37.473877 [debug] [MainThread]: On master: COMMIT
[0m06:02:37.474467 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:37.474898 [debug] [MainThread]: On master: Close
[0m06:02:37.475521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:37.475941 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:37.476351 [info ] [MainThread]: 
[0m06:02:37.476851 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.16 seconds (12.16s).
[0m06:02:37.477868 [debug] [MainThread]: Command end result
[0m06:02:37.507078 [info ] [MainThread]: 
[0m06:02:37.507755 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:37.508237 [info ] [MainThread]: 
[0m06:02:37.508743 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:37.509808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.185762, "process_user_time": 4.770209, "process_kernel_time": 0.277302, "process_mem_max_rss": "309596", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:37.510357 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:37.510251 after 14.19 seconds
[0m06:02:37.510823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70255bf230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7025229790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7024c66390>]}
[0m06:02:37.511264 [debug] [MainThread]: Flushing usage events
[0m06:02:39.466478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f649e3e15e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64a0eece00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f649ef65e20>]}


============================== 06:02:39.469728 | 1e7909d9-66d2-46b1-a40d-5b6580ea7128 ==============================
[0m06:02:39.469728 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:39.470432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:39.601449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e7909d9-66d2-46b1-a40d-5b6580ea7128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f649f4d74d0>]}
[0m06:02:39.619840 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20316327, "process_user_time": 1.405865, "process_kernel_time": 0.10299, "process_mem_max_rss": "100620", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:39.620384 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:39.620283 after 0.20 seconds
[0m06:02:39.620831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f649e6cb380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f649f315a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f649e2b64e0>]}
[0m06:02:39.621252 [debug] [MainThread]: Flushing usage events
[0m14:06:54.548930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe15e536f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe15e515730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe161caab70>]}


============================== 14:06:54.563268 | b43bf73b-f1dd-4e0f-93e4-18d95163ce6c ==============================
[0m14:06:54.563268 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:54.563922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:54.694871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b43bf73b-f1dd-4e0f-93e4-18d95163ce6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe15e104770>]}
[0m14:06:54.710460 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q2wc067g'
[0m14:06:54.710964 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:54.765932 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:54.766722 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:54.776989 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:54.780931 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:54.995198 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:54.995798 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:06:54.996314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b43bf73b-f1dd-4e0f-93e4-18d95163ce6c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe15dea0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe15dea0530>]}
[0m14:06:54.996775 [info ] [MainThread]: 
[0m14:06:54.997249 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:55.004522 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5058657, "process_user_time": 1.608523, "process_kernel_time": 0.137386, "process_mem_max_rss": "101696", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m14:06:55.005073 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:55.004972 after 0.51 seconds
[0m14:06:55.005507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe15de457c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe15ea1b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe15e185e20>]}
[0m14:06:55.005918 [debug] [MainThread]: Flushing usage events
[0m14:06:56.801594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fcd07a900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fcc649880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fcc649970>]}


============================== 14:06:56.804714 | cb4d2f56-e17d-4df0-8e0a-dd597283432d ==============================
[0m14:06:56.804714 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:56.805399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:57.011917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb4d2f56-e17d-4df0-8e0a-dd597283432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fcc968fe0>]}
[0m14:06:57.070579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb4d2f56-e17d-4df0-8e0a-dd597283432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fcc43a9f0>]}
[0m14:06:57.073249 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:06:57.098806 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:57.099531 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:57.100035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cb4d2f56-e17d-4df0-8e0a-dd597283432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fcc419130>]}
[0m14:06:58.412261 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:58.412939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cb4d2f56-e17d-4df0-8e0a-dd597283432d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc8356b40>]}
[0m14:06:58.659205 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:58.664987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb4d2f56-e17d-4df0-8e0a-dd597283432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc80b78c0>]}
[0m14:06:58.758028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb4d2f56-e17d-4df0-8e0a-dd597283432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc8101d60>]}
[0m14:06:58.758970 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:06:58.759656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb4d2f56-e17d-4df0-8e0a-dd597283432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fcd16f320>]}
[0m14:06:58.762325 [info ] [MainThread]: 
[0m14:06:58.763346 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:58.768286 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:58.803669 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:58.804149 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:58.804568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:59.202886 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:59.205193 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:59.206598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:59.207347 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:59.215457 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:59.215897 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:59.216274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:59.217355 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:59.218721 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:59.219110 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:59.219721 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:59.220108 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:59.220475 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:59.221098 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:59.222029 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:59.222411 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:59.222807 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:59.223338 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:59.223759 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:59.224996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:59.230841 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:59.231237 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:59.231638 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:59.232237 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:59.232637 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:59.233005 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:59.242772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:59.244277 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:59.245545 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:59.245946 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:59.248232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb4d2f56-e17d-4df0-8e0a-dd597283432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fce37d2e0>]}
[0m14:06:59.248782 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:59.249167 [debug] [MainThread]: On master: BEGIN
[0m14:06:59.249551 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:59.250205 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:59.250632 [debug] [MainThread]: On master: COMMIT
[0m14:06:59.251002 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:59.251362 [debug] [MainThread]: On master: COMMIT
[0m14:06:59.251914 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:59.252305 [debug] [MainThread]: On master: Close
[0m14:06:59.252864 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:59.253356 [info ] [MainThread]: 
[0m14:06:59.268186 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:59.268843 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:59.269451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:59.269927 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:59.297411 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:59.298294 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:59.334626 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:59.335451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:08.363503 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:08.364035 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:07:08.364789 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:08.365233 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:08.365699 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:07:08.366475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:08.369555 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:08.369998 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:07:08.370693 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:08.387466 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:08.387985 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:08.388408 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:08.390329 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:08.396262 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:08.396739 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:07:08.397974 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:08.400389 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:07:08.401980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb4d2f56-e17d-4df0-8e0a-dd597283432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fce31e450>]}
[0m14:07:08.402681 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.13s]
[0m14:07:08.403437 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:07:08.404460 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:07:08.405035 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:07:08.405615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:07:08.406047 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:07:08.411074 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:07:08.411747 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:07:08.448325 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:08.448884 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250813140708442203"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:07:08.449337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:08.457696 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:08.465869 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:08.466339 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:07:08.467005 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:08.467456 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:08.467906 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250813140708442203'
      
      
      order by ordinal_position

  
[0m14:07:08.470172 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:08.475573 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:08.476073 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:08.478723 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:08.486546 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:08.487013 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:08.489135 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:08.507470 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:07:08.508254 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:08.508733 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250813140708442203"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250813140708442203"
    )
  
[0m14:07:08.560759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:08.562768 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:08.563242 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:08.563689 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:08.570710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:08.571636 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:07:08.573207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb4d2f56-e17d-4df0-8e0a-dd597283432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc8115cd0>]}
[0m14:07:08.573907 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:07:08.574656 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:07:08.576288 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:08.576754 [debug] [MainThread]: On master: BEGIN
[0m14:07:08.577127 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:08.577842 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:08.578245 [debug] [MainThread]: On master: COMMIT
[0m14:07:08.578651 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:08.579014 [debug] [MainThread]: On master: COMMIT
[0m14:07:08.579576 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:08.579981 [debug] [MainThread]: On master: Close
[0m14:07:08.580683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:08.581060 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:07:08.581465 [info ] [MainThread]: 
[0m14:07:08.582015 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.82 seconds (9.82s).
[0m14:07:08.583023 [debug] [MainThread]: Command end result
[0m14:07:08.609296 [info ] [MainThread]: 
[0m14:07:08.609989 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:08.610531 [info ] [MainThread]: 
[0m14:07:08.611070 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:07:08.612101 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.860166, "process_user_time": 5.148144, "process_kernel_time": 0.272901, "process_mem_max_rss": "345412", "process_in_blocks": "1200", "process_out_blocks": "100096"}
[0m14:07:08.612684 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:08.612571 after 11.86 seconds
[0m14:07:08.613140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fccb747a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f8e3c97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fcca429c0>]}
[0m14:07:08.613595 [debug] [MainThread]: Flushing usage events
[0m14:07:10.716230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78377b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc782c51130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc782a3c3b0>]}


============================== 14:07:10.719351 | 52b66419-300c-4a27-a53d-cb9fe58a135f ==============================
[0m14:07:10.719351 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:10.720019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:10.833106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52b66419-300c-4a27-a53d-cb9fe58a135f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7825f2d50>]}
[0m14:07:10.852534 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18596417, "process_user_time": 1.363141, "process_kernel_time": 0.09901, "process_mem_max_rss": "100624", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:07:10.853069 [debug] [MainThread]: Command `dbt clean` succeeded at 14:07:10.852968 after 0.19 seconds
[0m14:07:10.853519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7826471d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7824ae660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78436b5c0>]}
[0m14:07:10.853946 [debug] [MainThread]: Flushing usage events
[0m22:06:57.435492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f761f655460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f761cc5ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f761d0f4830>]}


============================== 22:06:57.455787 | 9e24eb53-b833-4595-a659-211220101cc8 ==============================
[0m22:06:57.455787 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:57.456451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:57.595269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e24eb53-b833-4595-a659-211220101cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f761ca532f0>]}
[0m22:06:57.610315 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-j8xt9e96'
[0m22:06:57.610786 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:57.787609 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:57.788342 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:57.803718 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:57.807552 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:57.861150 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:57.861654 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:57.862187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9e24eb53-b833-4595-a659-211220101cc8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f761ce8dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f761cc1d2b0>]}
[0m22:06:57.862647 [info ] [MainThread]: 
[0m22:06:57.863142 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:57.870540 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48471358, "process_user_time": 1.56904, "process_kernel_time": 0.141822, "process_mem_max_rss": "101732", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m22:06:57.871102 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:57.870997 after 0.49 seconds
[0m22:06:57.871522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f761da370b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f761c8d8290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f761cc92750>]}
[0m22:06:57.871949 [debug] [MainThread]: Flushing usage events
[0m22:06:59.406414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4da8d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4a361d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4a361cd0>]}


============================== 22:06:59.409539 | 45538746-0c58-4a87-9597-0a0460ad7a41 ==============================
[0m22:06:59.409539 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:59.410214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:59.617330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45538746-0c58-4a87-9597-0a0460ad7a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4a25eb70>]}
[0m22:06:59.676543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45538746-0c58-4a87-9597-0a0460ad7a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4a363440>]}
[0m22:06:59.679199 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:59.708214 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:59.708937 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:59.709452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '45538746-0c58-4a87-9597-0a0460ad7a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4ac29df0>]}
[0m22:07:00.996364 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:07:00.997019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '45538746-0c58-4a87-9597-0a0460ad7a41', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d45c6bef0>]}
[0m22:07:01.239136 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:07:01.244541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45538746-0c58-4a87-9597-0a0460ad7a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4a0d01a0>]}
[0m22:07:01.341071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45538746-0c58-4a87-9597-0a0460ad7a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d45c6a3f0>]}
[0m22:07:01.341598 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:07:01.342110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45538746-0c58-4a87-9597-0a0460ad7a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d45cd1b80>]}
[0m22:07:01.343939 [info ] [MainThread]: 
[0m22:07:01.344623 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:07:01.349335 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:07:01.383995 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:07:01.384474 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:07:01.384859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:01.685681 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:01.687402 [debug] [ThreadPool]: On list_petro: Close
[0m22:07:01.688430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:07:01.689074 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:07:01.697263 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:01.697779 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:07:01.698274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:01.699227 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:01.700760 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:01.701232 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:07:01.701856 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:01.702360 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:01.702793 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:07:01.703524 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:01.704594 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:01.705083 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:01.705496 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:01.706040 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:01.706449 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:07:01.707685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:07:01.713697 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:01.714119 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:07:01.714480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:01.715096 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:01.715484 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:01.715853 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:07:01.725846 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:01.727302 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:07:01.728544 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:07:01.728963 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:07:01.731261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45538746-0c58-4a87-9597-0a0460ad7a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d448441d0>]}
[0m22:07:01.731760 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:01.732177 [debug] [MainThread]: On master: BEGIN
[0m22:07:01.732538 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:01.733159 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:01.733553 [debug] [MainThread]: On master: COMMIT
[0m22:07:01.733947 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:01.734313 [debug] [MainThread]: On master: COMMIT
[0m22:07:01.734837 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:01.735270 [debug] [MainThread]: On master: Close
[0m22:07:01.735782 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:07:01.736264 [info ] [MainThread]: 
[0m22:07:01.748059 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:07:01.748638 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:07:01.749213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:07:01.749639 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:07:01.776683 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:07:01.777519 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:07:01.813431 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:07:01.814190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:09.128367 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:09.128883 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:09.129576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:09.130031 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:09.130451 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:09.131283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:09.134316 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:09.134755 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:09.135515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:09.152357 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:09.152874 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:09.153323 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:09.155597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:09.161470 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:09.161939 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:09.163581 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:09.166023 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:09.167580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45538746-0c58-4a87-9597-0a0460ad7a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4bf6e210>]}
[0m22:07:09.168281 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.42s]
[0m22:07:09.169042 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:09.169933 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:09.170699 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:09.171381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:09.171844 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:09.177073 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:09.177735 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:09.214356 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:09.214930 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250813220709208239"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:09.215400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:09.223631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:09.231628 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:09.232110 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:09.232759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:09.233216 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:09.233630 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250813220709208239'
      
      
      order by ordinal_position

  
[0m22:07:09.236285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:09.241519 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:09.241994 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:09.244237 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:09.252075 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:09.252539 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:09.254998 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:09.273484 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:09.274308 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:09.274777 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250813220709208239"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250813220709208239"
    )
  
[0m22:07:09.332518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:09.334671 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:09.335185 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:09.335623 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:09.344018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:09.344967 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:09.346455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45538746-0c58-4a87-9597-0a0460ad7a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0c0a0da0>]}
[0m22:07:09.347167 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m22:07:09.347894 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:09.349257 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:09.349694 [debug] [MainThread]: On master: BEGIN
[0m22:07:09.350137 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:09.350850 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:09.351298 [debug] [MainThread]: On master: COMMIT
[0m22:07:09.351704 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:09.352124 [debug] [MainThread]: On master: COMMIT
[0m22:07:09.352696 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:09.353157 [debug] [MainThread]: On master: Close
[0m22:07:09.353829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:09.354273 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:09.354726 [info ] [MainThread]: 
[0m22:07:09.355277 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.01 seconds (8.01s).
[0m22:07:09.356361 [debug] [MainThread]: Command end result
[0m22:07:09.383939 [info ] [MainThread]: 
[0m22:07:09.384638 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:09.385232 [info ] [MainThread]: 
[0m22:07:09.385787 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:09.386901 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.030215, "process_user_time": 4.96939, "process_kernel_time": 0.289614, "process_mem_max_rss": "308876", "process_in_blocks": "1200", "process_out_blocks": "100104"}
[0m22:07:09.387516 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:09.387403 after 10.03 seconds
[0m22:07:09.388013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4b377890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4acb41d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4a6ddeb0>]}
[0m22:07:09.388485 [debug] [MainThread]: Flushing usage events
[0m22:07:11.219537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201c1c8230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201c004fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201b830cb0>]}


============================== 22:07:11.222704 | 94f35cd4-b794-4e4a-a47c-0932464cb76b ==============================
[0m22:07:11.222704 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:11.223385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:07:11.337107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94f35cd4-b794-4e4a-a47c-0932464cb76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201b729730>]}
[0m22:07:11.355366 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18534684, "process_user_time": 1.374067, "process_kernel_time": 0.110924, "process_mem_max_rss": "100488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:11.355956 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:11.355827 after 0.19 seconds
[0m22:07:11.356398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201c5c63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201c1c8230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201c1c9f70>]}
[0m22:07:11.356822 [debug] [MainThread]: Flushing usage events
[0m06:02:27.098212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2154bfe000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2152431df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2152431d00>]}


============================== 06:02:27.116353 | 0bbf898a-b6ed-4a53-b65a-4be2e05ddd40 ==============================
[0m06:02:27.116353 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:27.116999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.245536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bbf898a-b6ed-4a53-b65a-4be2e05ddd40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2154139b50>]}
[0m06:02:27.260618 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qbempxwy'
[0m06:02:27.261105 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:27.331203 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:27.331867 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:27.343039 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:27.346792 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:27.550979 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:27.551604 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:27.552178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0bbf898a-b6ed-4a53-b65a-4be2e05ddd40', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f215217b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f215217ba10>]}
[0m06:02:27.552629 [info ] [MainThread]: 
[0m06:02:27.553131 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:27.559430 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5105788, "process_user_time": 1.546821, "process_kernel_time": 0.154582, "process_mem_max_rss": "101716", "process_in_blocks": "8512", "process_out_blocks": "5168"}
[0m06:02:27.560006 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:27.559901 after 0.51 seconds
[0m06:02:27.560446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2152ed31a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2152fc0920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21535df530>]}
[0m06:02:27.560891 [debug] [MainThread]: Flushing usage events
[0m06:02:29.318898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c3bc0da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c3b54260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c3b566f0>]}


============================== 06:02:29.322017 | 853e4607-f585-4f3f-89cd-70eb6524b863 ==============================
[0m06:02:29.322017 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:29.322701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:29.527019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '853e4607-f585-4f3f-89cd-70eb6524b863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c2fb8a40>]}
[0m06:02:29.585589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '853e4607-f585-4f3f-89cd-70eb6524b863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c2fe4dd0>]}
[0m06:02:29.588332 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:29.614852 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:29.615564 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:29.616120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '853e4607-f585-4f3f-89cd-70eb6524b863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c31b8d10>]}
[0m06:02:30.886689 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:30.887321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '853e4607-f585-4f3f-89cd-70eb6524b863', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27bee5b500>]}
[0m06:02:31.131990 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:31.137689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '853e4607-f585-4f3f-89cd-70eb6524b863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c3419e20>]}
[0m06:02:31.277237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '853e4607-f585-4f3f-89cd-70eb6524b863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27bed61430>]}
[0m06:02:31.277844 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:31.278349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '853e4607-f585-4f3f-89cd-70eb6524b863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27bea2cb90>]}
[0m06:02:31.280235 [info ] [MainThread]: 
[0m06:02:31.280977 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:31.285647 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:31.320719 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:31.321177 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:31.321553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:31.791820 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.793406 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:31.794409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:31.794985 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:31.802268 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.802678 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:31.803073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:31.804100 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.805433 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.805831 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:31.806369 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.806753 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.807163 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:31.807723 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.808634 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:31.809040 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.809408 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:31.809980 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.810492 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:31.811820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:31.817609 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:31.818126 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:31.818481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:31.819103 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.819486 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:31.819870 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:31.829509 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.831012 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:31.832260 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:31.832652 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:31.834769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '853e4607-f585-4f3f-89cd-70eb6524b863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27bd776630>]}
[0m06:02:31.835301 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:31.835673 [debug] [MainThread]: On master: BEGIN
[0m06:02:31.836059 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:31.836720 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:31.837166 [debug] [MainThread]: On master: COMMIT
[0m06:02:31.837531 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:31.837918 [debug] [MainThread]: On master: COMMIT
[0m06:02:31.838463 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:31.838874 [debug] [MainThread]: On master: Close
[0m06:02:31.839407 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:31.839889 [info ] [MainThread]: 
[0m06:02:31.860234 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:31.860845 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:31.861475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:31.861933 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:31.888480 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:31.889229 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:31.924149 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:31.924896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:41.425539 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:41.426053 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:41.426726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.427191 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:41.427608 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:41.428317 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.431218 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:41.431650 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:41.432336 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.449092 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:41.449558 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:41.450012 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:41.451096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.456767 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:41.457236 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:41.458369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.460739 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:41.462298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '853e4607-f585-4f3f-89cd-70eb6524b863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2785bff740>]}
[0m06:02:41.463006 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.60s]
[0m06:02:41.463769 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:41.464785 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:41.465361 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:41.465957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:41.466387 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:41.471296 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:41.471959 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:41.508036 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:41.508592 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250814060241501815"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:41.509073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:41.517729 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.526024 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:41.526498 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:41.527185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.527620 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:41.528065 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250814060241501815'
      
      
      order by ordinal_position

  
[0m06:02:41.530314 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.535605 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:41.536091 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:41.538333 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.546059 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:41.546513 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:41.548774 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.567028 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:41.567747 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:41.568224 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250814060241501815"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250814060241501815"
    )
  
[0m06:02:41.618194 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.620227 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:41.620675 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:41.621122 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:41.628294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.629218 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:41.630654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '853e4607-f585-4f3f-89cd-70eb6524b863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27849e6900>]}
[0m06:02:41.631360 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:41.632097 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:41.633406 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:41.633840 [debug] [MainThread]: On master: BEGIN
[0m06:02:41.634222 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:41.634891 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:41.635290 [debug] [MainThread]: On master: COMMIT
[0m06:02:41.635677 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:41.636077 [debug] [MainThread]: On master: COMMIT
[0m06:02:41.636589 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:41.637011 [debug] [MainThread]: On master: Close
[0m06:02:41.637625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:41.638030 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:41.638426 [info ] [MainThread]: 
[0m06:02:41.638941 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.36 seconds (10.36s).
[0m06:02:41.639901 [debug] [MainThread]: Command end result
[0m06:02:41.665627 [info ] [MainThread]: 
[0m06:02:41.666265 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:41.666752 [info ] [MainThread]: 
[0m06:02:41.667289 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:41.668266 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.398154, "process_user_time": 4.643775, "process_kernel_time": 0.286232, "process_mem_max_rss": "307080", "process_in_blocks": "1200", "process_out_blocks": "100096"}
[0m06:02:41.668848 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:41.668714 after 12.40 seconds
[0m06:02:41.669292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c3b566f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c2f76ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2785858b30>]}
[0m06:02:41.669717 [debug] [MainThread]: Flushing usage events
[0m06:02:43.724235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef86852810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef86250860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef87f314f0>]}


============================== 06:02:43.727381 | d6b509ab-2c8d-4624-924d-d6ad7a86e809 ==============================
[0m06:02:43.727381 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:43.728078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:43.840310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6b509ab-2c8d-4624-924d-d6ad7a86e809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef85cc7e90>]}
[0m06:02:43.858845 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18347327, "process_user_time": 1.341785, "process_kernel_time": 0.100058, "process_mem_max_rss": "100648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:43.859378 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:43.859277 after 0.18 seconds
[0m06:02:43.859833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8649f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef86023f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef85d128a0>]}
[0m06:02:43.860255 [debug] [MainThread]: Flushing usage events
[0m14:06:11.138249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f5610e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f5ed7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f5ed6510>]}


============================== 14:06:11.153945 | dc1b7996-4886-4499-82c7-93525bcafb4c ==============================
[0m14:06:11.153945 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:11.154627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:11.300996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc1b7996-4886-4499-82c7-93525bcafb4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f55e32f0>]}
[0m14:06:11.316692 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6l8ba6r4'
[0m14:06:11.317176 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:11.430099 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:11.430853 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:11.454268 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:11.458158 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:11.529654 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:11.530289 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:06:11.530913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'dc1b7996-4886-4499-82c7-93525bcafb4c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f53fb800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f542f4d0>]}
[0m14:06:11.531399 [info ] [MainThread]: 
[0m14:06:11.531867 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:11.548926 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46036375, "process_user_time": 1.559188, "process_kernel_time": 0.151115, "process_mem_max_rss": "101724", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m14:06:11.549553 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:11.549439 after 0.46 seconds
[0m14:06:11.549988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f5d354c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f70ee030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f5479eb0>]}
[0m14:06:11.550441 [debug] [MainThread]: Flushing usage events
[0m14:06:13.149629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f2561c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f324d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f06eb260>]}


============================== 14:06:13.152793 | 457956a3-cd07-49b0-83b2-a4ad186fdd4b ==============================
[0m14:06:13.152793 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:13.153462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:13.358202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '457956a3-cd07-49b0-83b2-a4ad186fdd4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f18bc890>]}
[0m14:06:13.419324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '457956a3-cd07-49b0-83b2-a4ad186fdd4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f17d1a30>]}
[0m14:06:13.422113 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:06:13.554098 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:13.554894 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:13.555455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '457956a3-cd07-49b0-83b2-a4ad186fdd4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec5021b0>]}
[0m14:06:14.845594 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:14.846289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '457956a3-cd07-49b0-83b2-a4ad186fdd4b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f17d0680>]}
[0m14:06:15.091245 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:15.096744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '457956a3-cd07-49b0-83b2-a4ad186fdd4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f1460650>]}
[0m14:06:15.196668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '457956a3-cd07-49b0-83b2-a4ad186fdd4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec03a570>]}
[0m14:06:15.197221 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:06:15.197701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '457956a3-cd07-49b0-83b2-a4ad186fdd4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec0fe9c0>]}
[0m14:06:15.199550 [info ] [MainThread]: 
[0m14:06:15.200232 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:15.204887 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:15.240037 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:15.240516 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:15.240902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:15.573025 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:15.574860 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:15.576045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:15.576701 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:15.585024 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:15.585463 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:15.585850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:15.587248 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:15.588617 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:15.589006 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:15.589642 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:15.590022 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:15.590413 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:15.590995 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:15.591940 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:15.592350 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:15.592718 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:15.593321 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:15.593725 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:15.594929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:15.600711 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:15.601112 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:15.601495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:15.602083 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:15.602484 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:15.602850 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:15.612498 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:15.613948 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:15.615179 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:15.615585 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:15.617692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '457956a3-cd07-49b0-83b2-a4ad186fdd4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec0fdf70>]}
[0m14:06:15.618211 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:15.618615 [debug] [MainThread]: On master: BEGIN
[0m14:06:15.618967 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:15.619575 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:15.619967 [debug] [MainThread]: On master: COMMIT
[0m14:06:15.620365 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:15.620740 [debug] [MainThread]: On master: COMMIT
[0m14:06:15.621282 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:15.621715 [debug] [MainThread]: On master: Close
[0m14:06:15.622233 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:15.622749 [info ] [MainThread]: 
[0m14:06:15.656945 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:15.657624 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:15.658286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:15.658773 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:15.685555 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:15.686319 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:15.721456 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:15.722203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:24.224513 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:24.225006 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:24.225664 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:24.226094 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:24.226533 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:24.227214 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:24.230110 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:24.230573 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:24.231224 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:24.247878 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:24.248357 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:24.248782 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:24.250682 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:24.256374 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:24.256828 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:24.258383 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:24.260717 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:24.262226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '457956a3-cd07-49b0-83b2-a4ad186fdd4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f139cda0>]}
[0m14:06:24.262921 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.60s]
[0m14:06:24.263691 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:24.264659 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:24.265200 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:24.265805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:24.266238 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:24.271125 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:24.271770 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:24.307100 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:24.307613 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250814140624301075"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:24.308071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:24.315835 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:24.323374 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:24.323834 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:24.324454 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:24.324899 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:24.325339 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250814140624301075'
      
      
      order by ordinal_position

  
[0m14:06:24.327402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:24.332440 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:24.332898 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:24.335014 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:24.342609 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:24.343065 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:24.345386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:24.363407 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:24.364076 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:24.364547 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250814140624301075"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250814140624301075"
    )
  
[0m14:06:24.413901 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:24.415915 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:24.416396 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:24.416815 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:24.423638 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:24.424548 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:24.426008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '457956a3-cd07-49b0-83b2-a4ad186fdd4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b1efd670>]}
[0m14:06:24.426711 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:06:24.427525 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:24.429081 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:24.429522 [debug] [MainThread]: On master: BEGIN
[0m14:06:24.429894 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:24.430564 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:24.430970 [debug] [MainThread]: On master: COMMIT
[0m14:06:24.431366 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:24.431733 [debug] [MainThread]: On master: COMMIT
[0m14:06:24.432248 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:24.432674 [debug] [MainThread]: On master: Close
[0m14:06:24.433244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:24.433640 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:24.434031 [info ] [MainThread]: 
[0m14:06:24.434531 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.23 seconds (9.23s).
[0m14:06:24.435493 [debug] [MainThread]: Command end result
[0m14:06:24.460964 [info ] [MainThread]: 
[0m14:06:24.461561 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:24.462043 [info ] [MainThread]: 
[0m14:06:24.462551 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:24.463532 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.362901, "process_user_time": 4.705224, "process_kernel_time": 0.259177, "process_mem_max_rss": "330560", "process_in_blocks": "1200", "process_out_blocks": "100088"}
[0m14:06:24.464078 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:24.463975 after 11.36 seconds
[0m14:06:24.464530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f1261250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f07c0fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f0ae6c30>]}
[0m14:06:24.464957 [debug] [MainThread]: Flushing usage events
[0m14:06:26.278456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a972d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a80b6870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a80efce0>]}


============================== 14:06:26.281495 | 60a81ce4-4f2a-471f-a193-f9e3796d55bd ==============================
[0m14:06:26.281495 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:26.282112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:26.393261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60a81ce4-4f2a-471f-a193-f9e3796d55bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a75a9970>]}
[0m14:06:26.410786 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1809863, "process_user_time": 1.32052, "process_kernel_time": 0.109042, "process_mem_max_rss": "100620", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:06:26.411366 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:26.411194 after 0.18 seconds
[0m14:06:26.411783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a7643800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a87c89b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a87c9010>]}
[0m14:06:26.412195 [debug] [MainThread]: Flushing usage events
